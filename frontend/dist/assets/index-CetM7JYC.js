function rye(e,t){for(var r=0;r<t.length;r++){const i=t[r];if(typeof i!="string"&&!Array.isArray(i)){for(const n in i)if(n!=="default"&&!(n in e)){const s=Object.getOwnPropertyDescriptor(i,n);s&&Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:()=>i[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var FE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function d0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var cR={exports:{}},_1={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nH;function iye(){if(nH)return _1;nH=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(i,n,s){var a=null;if(s!==void 0&&(a=""+s),n.key!==void 0&&(a=""+n.key),"key"in n){s={};for(var o in n)o!=="key"&&(s[o]=n[o])}else s=n;return n=s.ref,{$$typeof:e,type:i,key:a,ref:n!==void 0?n:null,props:s}}return _1.Fragment=t,_1.jsx=r,_1.jsxs=r,_1}var sH;function nye(){return sH||(sH=1,cR.exports=iye()),cR.exports}var h=nye(),uR={exports:{}},Ir={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aH;function sye(){if(aH)return Ir;aH=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function f(F){return F===null||typeof F!="object"?null:(F=d&&F[d]||F["@@iterator"],typeof F=="function"?F:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,y={};function x(F,$,se){this.props=F,this.context=$,this.refs=y,this.updater=se||m}x.prototype.isReactComponent={},x.prototype.setState=function(F,$){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,$,"setState")},x.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function w(){}w.prototype=x.prototype;function _(F,$,se){this.props=F,this.context=$,this.refs=y,this.updater=se||m}var S=_.prototype=new w;S.constructor=_,v(S,x.prototype),S.isPureReactComponent=!0;var P=Array.isArray,M={H:null,A:null,T:null,S:null,V:null},C=Object.prototype.hasOwnProperty;function T(F,$,se,H,ne,ce){return se=ce.ref,{$$typeof:e,type:F,key:$,ref:se!==void 0?se:null,props:ce}}function E(F,$){return T(F.type,$,void 0,void 0,void 0,F.props)}function N(F){return typeof F=="object"&&F!==null&&F.$$typeof===e}function D(F){var $={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(se){return $[se]})}var I=/\/+/g;function j(F,$){return typeof F=="object"&&F!==null&&F.key!=null?D(""+F.key):$.toString(36)}function L(){}function B(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(L,L):(F.status="pending",F.then(function($){F.status==="pending"&&(F.status="fulfilled",F.value=$)},function($){F.status==="pending"&&(F.status="rejected",F.reason=$)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function q(F,$,se,H,ne){var ce=typeof F;(ce==="undefined"||ce==="boolean")&&(F=null);var ie=!1;if(F===null)ie=!0;else switch(ce){case"bigint":case"string":case"number":ie=!0;break;case"object":switch(F.$$typeof){case e:case t:ie=!0;break;case u:return ie=F._init,q(ie(F._payload),$,se,H,ne)}}if(ie)return ne=ne(F),ie=H===""?"."+j(F,0):H,P(ne)?(se="",ie!=null&&(se=ie.replace(I,"$&/")+"/"),q(ne,$,se,"",function(fe){return fe})):ne!=null&&(N(ne)&&(ne=E(ne,se+(ne.key==null||F&&F.key===ne.key?"":(""+ne.key).replace(I,"$&/")+"/")+ie)),$.push(ne)),1;ie=0;var ae=H===""?".":H+":";if(P(F))for(var Z=0;Z<F.length;Z++)H=F[Z],ce=ae+j(H,Z),ie+=q(H,$,se,ce,ne);else if(Z=f(F),typeof Z=="function")for(F=Z.call(F),Z=0;!(H=F.next()).done;)H=H.value,ce=ae+j(H,Z++),ie+=q(H,$,se,ce,ne);else if(ce==="object"){if(typeof F.then=="function")return q(B(F),$,se,H,ne);throw $=String(F),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return ie}function G(F,$,se){if(F==null)return F;var H=[],ne=0;return q(F,H,"","",function(ce){return $.call(se,ce,ne++)}),H}function Y(F){if(F._status===-1){var $=F._result;$=$(),$.then(function(se){(F._status===0||F._status===-1)&&(F._status=1,F._result=se)},function(se){(F._status===0||F._status===-1)&&(F._status=2,F._result=se)}),F._status===-1&&(F._status=0,F._result=$)}if(F._status===1)return F._result.default;throw F._result}var X=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)};function re(){}return Ir.Children={map:G,forEach:function(F,$,se){G(F,function(){$.apply(this,arguments)},se)},count:function(F){var $=0;return G(F,function(){$++}),$},toArray:function(F){return G(F,function($){return $})||[]},only:function(F){if(!N(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},Ir.Component=x,Ir.Fragment=r,Ir.Profiler=n,Ir.PureComponent=_,Ir.StrictMode=i,Ir.Suspense=l,Ir.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Ir.__COMPILER_RUNTIME={__proto__:null,c:function(F){return M.H.useMemoCache(F)}},Ir.cache=function(F){return function(){return F.apply(null,arguments)}},Ir.cloneElement=function(F,$,se){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var H=v({},F.props),ne=F.key,ce=void 0;if($!=null)for(ie in $.ref!==void 0&&(ce=void 0),$.key!==void 0&&(ne=""+$.key),$)!C.call($,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&$.ref===void 0||(H[ie]=$[ie]);var ie=arguments.length-2;if(ie===1)H.children=se;else if(1<ie){for(var ae=Array(ie),Z=0;Z<ie;Z++)ae[Z]=arguments[Z+2];H.children=ae}return T(F.type,ne,void 0,void 0,ce,H)},Ir.createContext=function(F){return F={$$typeof:a,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:s,_context:F},F},Ir.createElement=function(F,$,se){var H,ne={},ce=null;if($!=null)for(H in $.key!==void 0&&(ce=""+$.key),$)C.call($,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(ne[H]=$[H]);var ie=arguments.length-2;if(ie===1)ne.children=se;else if(1<ie){for(var ae=Array(ie),Z=0;Z<ie;Z++)ae[Z]=arguments[Z+2];ne.children=ae}if(F&&F.defaultProps)for(H in ie=F.defaultProps,ie)ne[H]===void 0&&(ne[H]=ie[H]);return T(F,ce,void 0,void 0,null,ne)},Ir.createRef=function(){return{current:null}},Ir.forwardRef=function(F){return{$$typeof:o,render:F}},Ir.isValidElement=N,Ir.lazy=function(F){return{$$typeof:u,_payload:{_status:-1,_result:F},_init:Y}},Ir.memo=function(F,$){return{$$typeof:c,type:F,compare:$===void 0?null:$}},Ir.startTransition=function(F){var $=M.T,se={};M.T=se;try{var H=F(),ne=M.S;ne!==null&&ne(se,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(re,X)}catch(ce){X(ce)}finally{M.T=$}},Ir.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},Ir.use=function(F){return M.H.use(F)},Ir.useActionState=function(F,$,se){return M.H.useActionState(F,$,se)},Ir.useCallback=function(F,$){return M.H.useCallback(F,$)},Ir.useContext=function(F){return M.H.useContext(F)},Ir.useDebugValue=function(){},Ir.useDeferredValue=function(F,$){return M.H.useDeferredValue(F,$)},Ir.useEffect=function(F,$,se){var H=M.H;if(typeof se=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return H.useEffect(F,$)},Ir.useId=function(){return M.H.useId()},Ir.useImperativeHandle=function(F,$,se){return M.H.useImperativeHandle(F,$,se)},Ir.useInsertionEffect=function(F,$){return M.H.useInsertionEffect(F,$)},Ir.useLayoutEffect=function(F,$){return M.H.useLayoutEffect(F,$)},Ir.useMemo=function(F,$){return M.H.useMemo(F,$)},Ir.useOptimistic=function(F,$){return M.H.useOptimistic(F,$)},Ir.useReducer=function(F,$,se){return M.H.useReducer(F,$,se)},Ir.useRef=function(F){return M.H.useRef(F)},Ir.useState=function(F){return M.H.useState(F)},Ir.useSyncExternalStore=function(F,$,se){return M.H.useSyncExternalStore(F,$,se)},Ir.useTransition=function(){return M.H.useTransition()},Ir.version="19.1.0",Ir}var oH;function E_(){return oH||(oH=1,uR.exports=sye()),uR.exports}var O=E_();const Ot=d0(O),w6=rye({__proto__:null,default:Ot},[O]);var dR={exports:{}},S1={},hR={exports:{}},fR={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lH;function aye(){return lH||(lH=1,function(e){function t(G,Y){var X=G.length;G.push(Y);e:for(;0<X;){var re=X-1>>>1,F=G[re];if(0<n(F,Y))G[re]=Y,G[X]=F,X=re;else break e}}function r(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var Y=G[0],X=G.pop();if(X!==Y){G[0]=X;e:for(var re=0,F=G.length,$=F>>>1;re<$;){var se=2*(re+1)-1,H=G[se],ne=se+1,ce=G[ne];if(0>n(H,X))ne<F&&0>n(ce,H)?(G[re]=ce,G[ne]=X,re=ne):(G[re]=H,G[se]=X,re=se);else if(ne<F&&0>n(ce,X))G[re]=ce,G[ne]=X,re=ne;else break e}}return Y}function n(G,Y){var X=G.sortIndex-Y.sortIndex;return X!==0?X:G.id-Y.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,f=3,m=!1,v=!1,y=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function P(G){for(var Y=r(c);Y!==null;){if(Y.callback===null)i(c);else if(Y.startTime<=G)i(c),Y.sortIndex=Y.expirationTime,t(l,Y);else break;Y=r(c)}}function M(G){if(y=!1,P(G),!v)if(r(l)!==null)v=!0,C||(C=!0,j());else{var Y=r(c);Y!==null&&q(M,Y.startTime-G)}}var C=!1,T=-1,E=5,N=-1;function D(){return x?!0:!(e.unstable_now()-N<E)}function I(){if(x=!1,C){var G=e.unstable_now();N=G;var Y=!0;try{e:{v=!1,y&&(y=!1,_(T),T=-1),m=!0;var X=f;try{t:{for(P(G),d=r(l);d!==null&&!(d.expirationTime>G&&D());){var re=d.callback;if(typeof re=="function"){d.callback=null,f=d.priorityLevel;var F=re(d.expirationTime<=G);if(G=e.unstable_now(),typeof F=="function"){d.callback=F,P(G),Y=!0;break t}d===r(l)&&i(l),P(G)}else i(l);d=r(l)}if(d!==null)Y=!0;else{var $=r(c);$!==null&&q(M,$.startTime-G),Y=!1}}break e}finally{d=null,f=X,m=!1}Y=void 0}}finally{Y?j():C=!1}}}var j;if(typeof S=="function")j=function(){S(I)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,B=L.port2;L.port1.onmessage=I,j=function(){B.postMessage(null)}}else j=function(){w(I,0)};function q(G,Y){T=w(function(){G(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_next=function(G){switch(f){case 1:case 2:case 3:var Y=3;break;default:Y=f}var X=f;f=Y;try{return G()}finally{f=X}},e.unstable_requestPaint=function(){x=!0},e.unstable_runWithPriority=function(G,Y){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var X=f;f=G;try{return Y()}finally{f=X}},e.unstable_scheduleCallback=function(G,Y,X){var re=e.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?re+X:re):X=re,G){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=X+F,G={id:u++,callback:Y,priorityLevel:G,startTime:X,expirationTime:F,sortIndex:-1},X>re?(G.sortIndex=X,t(c,G),r(l)===null&&G===r(c)&&(y?(_(T),T=-1):y=!0,q(M,X-re))):(G.sortIndex=F,t(l,G),v||m||(v=!0,C||(C=!0,j()))),G},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(G){var Y=f;return function(){var X=f;f=Y;try{return G.apply(this,arguments)}finally{f=X}}}}(fR)),fR}var cH;function oye(){return cH||(cH=1,hR.exports=aye()),hR.exports}var pR={exports:{}},Ca={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uH;function lye(){if(uH)return Ca;uH=1;var e=E_();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var i={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function s(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Ca.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ca.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return s(l,c,null,u)},Ca.flushSync=function(l){var c=a.T,u=i.p;try{if(a.T=null,i.p=2,l)return l()}finally{a.T=c,i.p=u,i.d.f()}},Ca.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,i.d.C(l,c))},Ca.prefetchDNS=function(l){typeof l=="string"&&i.d.D(l)},Ca.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin),f=typeof c.integrity=="string"?c.integrity:void 0,m=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?i.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:f,fetchPriority:m}):u==="script"&&i.d.X(l,{crossOrigin:d,integrity:f,fetchPriority:m,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Ca.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);i.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&i.d.M(l)},Ca.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin);i.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Ca.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);i.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else i.d.m(l)},Ca.requestFormReset=function(l){i.d.r(l)},Ca.unstable_batchedUpdates=function(l,c){return l(c)},Ca.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},Ca.useFormStatus=function(){return a.H.useHostTransitionStatus()},Ca.version="19.1.0",Ca}var dH;function Kte(){if(dH)return pR.exports;dH=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),pR.exports=lye(),pR.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hH;function cye(){if(hH)return S1;hH=1;var e=oye(),t=E_(),r=Kte();function i(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function s(p){var g=p,b=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(b=g.return),p=g.return;while(p)}return g.tag===3?b:null}function a(p){if(p.tag===13){var g=p.memoizedState;if(g===null&&(p=p.alternate,p!==null&&(g=p.memoizedState)),g!==null)return g.dehydrated}return null}function o(p){if(s(p)!==p)throw Error(i(188))}function l(p){var g=p.alternate;if(!g){if(g=s(p),g===null)throw Error(i(188));return g!==p?null:p}for(var b=p,A=g;;){var R=b.return;if(R===null)break;var z=R.alternate;if(z===null){if(A=R.return,A!==null){b=A;continue}break}if(R.child===z.child){for(z=R.child;z;){if(z===b)return o(R),p;if(z===A)return o(R),g;z=z.sibling}throw Error(i(188))}if(b.return!==A.return)b=R,A=z;else{for(var Q=!1,le=R.child;le;){if(le===b){Q=!0,b=R,A=z;break}if(le===A){Q=!0,A=R,b=z;break}le=le.sibling}if(!Q){for(le=z.child;le;){if(le===b){Q=!0,b=z,A=R;break}if(le===A){Q=!0,A=z,b=R;break}le=le.sibling}if(!Q)throw Error(i(189))}}if(b.alternate!==A)throw Error(i(190))}if(b.tag!==3)throw Error(i(188));return b.stateNode.current===b?p:g}function c(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(g=c(p),g!==null)return g;p=p.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),S=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function j(p){return p===null||typeof p!="object"?null:(p=I&&p[I]||p["@@iterator"],typeof p=="function"?p:null)}var L=Symbol.for("react.client.reference");function B(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===L?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case v:return"Fragment";case x:return"Profiler";case y:return"StrictMode";case M:return"Suspense";case C:return"SuspenseList";case N:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case m:return"Portal";case S:return(p.displayName||"Context")+".Provider";case _:return(p._context.displayName||"Context")+".Consumer";case P:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case T:return g=p.displayName||null,g!==null?g:B(p.type)||"Memo";case E:g=p._payload,p=p._init;try{return B(p(g))}catch{}}return null}var q=Array.isArray,G=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},re=[],F=-1;function $(p){return{current:p}}function se(p){0>F||(p.current=re[F],re[F]=null,F--)}function H(p,g){F++,re[F]=p.current,p.current=g}var ne=$(null),ce=$(null),ie=$(null),ae=$(null);function Z(p,g){switch(H(ie,g),H(ce,p),H(ne,null),g.nodeType){case 9:case 11:p=(p=g.documentElement)&&(p=p.namespaceURI)?k7(p):0;break;default:if(p=g.tagName,g=g.namespaceURI)g=k7(g),p=R7(g,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}se(ne),H(ne,p)}function fe(){se(ne),se(ce),se(ie)}function he(p){p.memoizedState!==null&&H(ae,p);var g=ne.current,b=R7(g,p.type);g!==b&&(H(ce,p),H(ne,b))}function Ae(p){ce.current===p&&(se(ne),se(ce)),ae.current===p&&(se(ae),v1._currentValue=X)}var xe=Object.prototype.hasOwnProperty,Ee=e.unstable_scheduleCallback,Be=e.unstable_cancelCallback,$e=e.unstable_shouldYield,mt=e.unstable_requestPaint,dt=e.unstable_now,ct=e.unstable_getCurrentPriorityLevel,ut=e.unstable_ImmediatePriority,me=e.unstable_UserBlockingPriority,_e=e.unstable_NormalPriority,te=e.unstable_LowPriority,J=e.unstable_IdlePriority,ve=e.log,Me=e.unstable_setDisableYieldValue,W=null,Se=null;function ze(p){if(typeof ve=="function"&&Me(p),Se&&typeof Se.setStrictMode=="function")try{Se.setStrictMode(W,p)}catch{}}var Ue=Math.clz32?Math.clz32:We,Ne=Math.log,De=Math.LN2;function We(p){return p>>>=0,p===0?32:31-(Ne(p)/De|0)|0}var Je=256,et=4194304;function qe(p){var g=p&42;if(g!==0)return g;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function ft(p,g,b){var A=p.pendingLanes;if(A===0)return 0;var R=0,z=p.suspendedLanes,Q=p.pingedLanes;p=p.warmLanes;var le=A&134217727;return le!==0?(A=le&~z,A!==0?R=qe(A):(Q&=le,Q!==0?R=qe(Q):b||(b=le&~p,b!==0&&(R=qe(b))))):(le=A&~z,le!==0?R=qe(le):Q!==0?R=qe(Q):b||(b=A&~p,b!==0&&(R=qe(b)))),R===0?0:g!==0&&g!==R&&(g&z)===0&&(z=R&-R,b=g&-g,z>=b||z===32&&(b&4194048)!==0)?g:R}function kt(p,g){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&g)===0}function Mt(p,g){switch(p){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ye(){var p=Je;return Je<<=1,(Je&4194048)===0&&(Je=256),p}function He(){var p=et;return et<<=1,(et&62914560)===0&&(et=4194304),p}function tt(p){for(var g=[],b=0;31>b;b++)g.push(p);return g}function xt(p,g){p.pendingLanes|=g,g!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function Wt(p,g,b,A,R,z){var Q=p.pendingLanes;p.pendingLanes=b,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=b,p.entangledLanes&=b,p.errorRecoveryDisabledLanes&=b,p.shellSuspendCounter=0;var le=p.entanglements,we=p.expirationTimes,Le=p.hiddenUpdates;for(b=Q&~b;0<b;){var rt=31-Ue(b),at=1<<rt;le[rt]=0,we[rt]=-1;var Fe=Le[rt];if(Fe!==null)for(Le[rt]=null,rt=0;rt<Fe.length;rt++){var Ve=Fe[rt];Ve!==null&&(Ve.lane&=-536870913)}b&=~at}A!==0&&gr(p,A,0),z!==0&&R===0&&p.tag!==0&&(p.suspendedLanes|=z&~(Q&~g))}function gr(p,g,b){p.pendingLanes|=g,p.suspendedLanes&=~g;var A=31-Ue(g);p.entangledLanes|=g,p.entanglements[A]=p.entanglements[A]|1073741824|b&4194090}function Ui(p,g){var b=p.entangledLanes|=g;for(p=p.entanglements;b;){var A=31-Ue(b),R=1<<A;R&g|p[A]&g&&(p[A]|=g),b&=~R}}function Hi(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function Js(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function ei(){var p=Y.p;return p!==0?p:(p=window.event,p===void 0?32:Z7(p.type))}function Sa(p,g){var b=Y.p;try{return Y.p=p,g()}finally{Y.p=b}}var zr=Math.random().toString(36).slice(2),$i="__reactFiber$"+zr,ln="__reactProps$"+zr,Ea="__reactContainer$"+zr,Zl="__reactEvents$"+zr,pe="__reactListeners$"+zr,je="__reactHandles$"+zr,Ke="__reactResources$"+zr,ke="__reactMarker$"+zr;function Qe(p){delete p[$i],delete p[ln],delete p[Zl],delete p[pe],delete p[je]}function Tt(p){var g=p[$i];if(g)return g;for(var b=p.parentNode;b;){if(g=b[Ea]||b[$i]){if(b=g.alternate,g.child!==null||b!==null&&b.child!==null)for(p=L7(p);p!==null;){if(b=p[$i])return b;p=L7(p)}return g}p=b,b=p.parentNode}return null}function Gt(p){if(p=p[$i]||p[Ea]){var g=p.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return p}return null}function qt(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p.stateNode;throw Error(i(33))}function Dt(p){var g=p[Ke];return g||(g=p[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function er(p){p[ke]=!0}var wr=new Set,vr={};function Xt(p,g){Ci(p,g),Ci(p+"Capture",g)}function Ci(p,g){for(vr[p]=g,p=0;p<g.length;p++)wr.add(g[p])}var ea=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),mo={},gi={};function kr(p){return xe.call(gi,p)?!0:xe.call(mo,p)?!1:ea.test(p)?gi[p]=!0:(mo[p]=!0,!1)}function Yn(p,g,b){if(kr(g))if(b===null)p.removeAttribute(g);else{switch(typeof b){case"undefined":case"function":case"symbol":p.removeAttribute(g);return;case"boolean":var A=g.toLowerCase().slice(0,5);if(A!=="data-"&&A!=="aria-"){p.removeAttribute(g);return}}p.setAttribute(g,""+b)}}function ur(p,g,b){if(b===null)p.removeAttribute(g);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(g);return}p.setAttribute(g,""+b)}}function Gi(p,g,b,A){if(A===null)p.removeAttribute(b);else{switch(typeof A){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(b);return}p.setAttributeNS(g,b,""+A)}}var Wa,Bo;function Xn(p){if(Wa===void 0)try{throw Error()}catch(b){var g=b.stack.trim().match(/\n( *(at )?)/);Wa=g&&g[1]||"",Bo=-1<b.stack.indexOf(`
    at`)?" (<anonymous>)":-1<b.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wa+p+Bo}var ee=!1;function oe(p,g){if(!p||ee)return"";ee=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var A={DetermineComponentFrameRoot:function(){try{if(g){var at=function(){throw Error()};if(Object.defineProperty(at.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(at,[])}catch(Ve){var Fe=Ve}Reflect.construct(p,[],at)}else{try{at.call()}catch(Ve){Fe=Ve}p.call(at.prototype)}}else{try{throw Error()}catch(Ve){Fe=Ve}(at=p())&&typeof at.catch=="function"&&at.catch(function(){})}}catch(Ve){if(Ve&&Fe&&typeof Ve.stack=="string")return[Ve.stack,Fe.stack]}return[null,null]}};A.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var R=Object.getOwnPropertyDescriptor(A.DetermineComponentFrameRoot,"name");R&&R.configurable&&Object.defineProperty(A.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=A.DetermineComponentFrameRoot(),Q=z[0],le=z[1];if(Q&&le){var we=Q.split(`
`),Le=le.split(`
`);for(R=A=0;A<we.length&&!we[A].includes("DetermineComponentFrameRoot");)A++;for(;R<Le.length&&!Le[R].includes("DetermineComponentFrameRoot");)R++;if(A===we.length||R===Le.length)for(A=we.length-1,R=Le.length-1;1<=A&&0<=R&&we[A]!==Le[R];)R--;for(;1<=A&&0<=R;A--,R--)if(we[A]!==Le[R]){if(A!==1||R!==1)do if(A--,R--,0>R||we[A]!==Le[R]){var rt=`
`+we[A].replace(" at new "," at ");return p.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",p.displayName)),rt}while(1<=A&&0<=R);break}}}finally{ee=!1,Error.prepareStackTrace=b}return(b=p?p.displayName||p.name:"")?Xn(b):""}function be(p){switch(p.tag){case 26:case 27:case 5:return Xn(p.type);case 16:return Xn("Lazy");case 13:return Xn("Suspense");case 19:return Xn("SuspenseList");case 0:case 15:return oe(p.type,!1);case 11:return oe(p.type.render,!1);case 1:return oe(p.type,!0);case 31:return Xn("Activity");default:return""}}function de(p){try{var g="";do g+=be(p),p=p.return;while(p);return g}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}function Ce(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function ht(p){var g=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Fo(p){var g=ht(p)?"checked":"value",b=Object.getOwnPropertyDescriptor(p.constructor.prototype,g),A=""+p[g];if(!p.hasOwnProperty(g)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var R=b.get,z=b.set;return Object.defineProperty(p,g,{configurable:!0,get:function(){return R.call(this)},set:function(Q){A=""+Q,z.call(this,Q)}}),Object.defineProperty(p,g,{enumerable:b.enumerable}),{getValue:function(){return A},setValue:function(Q){A=""+Q},stopTracking:function(){p._valueTracker=null,delete p[g]}}}}function Kc(p){p._valueTracker||(p._valueTracker=Fo(p))}function Qc(p){if(!p)return!1;var g=p._valueTracker;if(!g)return!0;var b=g.getValue(),A="";return p&&(A=ht(p)?p.checked?"true":"false":p.value),p=A,p!==b?(g.setValue(p),!0):!1}function Jl(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var ef=/[\n"\\]/g;function cn(p){return p.replace(ef,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function Vo(p,g,b,A,R,z,Q,le){p.name="",Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?p.type=Q:p.removeAttribute("type"),g!=null?Q==="number"?(g===0&&p.value===""||p.value!=g)&&(p.value=""+Ce(g)):p.value!==""+Ce(g)&&(p.value=""+Ce(g)):Q!=="submit"&&Q!=="reset"||p.removeAttribute("value"),g!=null?tf(p,Q,Ce(g)):b!=null?tf(p,Q,Ce(b)):A!=null&&p.removeAttribute("value"),R==null&&z!=null&&(p.defaultChecked=!!z),R!=null&&(p.checked=R&&typeof R!="function"&&typeof R!="symbol"),le!=null&&typeof le!="function"&&typeof le!="symbol"&&typeof le!="boolean"?p.name=""+Ce(le):p.removeAttribute("name")}function um(p,g,b,A,R,z,Q,le){if(z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(p.type=z),g!=null||b!=null){if(!(z!=="submit"&&z!=="reset"||g!=null))return;b=b!=null?""+Ce(b):"",g=g!=null?""+Ce(g):b,le||g===p.value||(p.value=g),p.defaultValue=g}A=A??R,A=typeof A!="function"&&typeof A!="symbol"&&!!A,p.checked=le?p.checked:!!A,p.defaultChecked=!!A,Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"&&(p.name=Q)}function tf(p,g,b){g==="number"&&Jl(p.ownerDocument)===p||p.defaultValue===""+b||(p.defaultValue=""+b)}function vd(p,g,b,A){if(p=p.options,g){g={};for(var R=0;R<b.length;R++)g["$"+b[R]]=!0;for(b=0;b<p.length;b++)R=g.hasOwnProperty("$"+p[b].value),p[b].selected!==R&&(p[b].selected=R),R&&A&&(p[b].defaultSelected=!0)}else{for(b=""+Ce(b),g=null,R=0;R<p.length;R++){if(p[R].value===b){p[R].selected=!0,A&&(p[R].defaultSelected=!0);return}g!==null||p[R].disabled||(g=p[R])}g!==null&&(g.selected=!0)}}function Oi(p,g,b){if(g!=null&&(g=""+Ce(g),g!==p.value&&(p.value=g),b==null)){p.defaultValue!==g&&(p.defaultValue=g);return}p.defaultValue=b!=null?""+Ce(b):""}function dm(p,g,b,A){if(g==null){if(A!=null){if(b!=null)throw Error(i(92));if(q(A)){if(1<A.length)throw Error(i(93));A=A[0]}b=A}b==null&&(b=""),g=b}b=Ce(g),p.defaultValue=b,A=p.textContent,A===b&&A!==""&&A!==null&&(p.value=A)}function hl(p,g){if(g){var b=p.firstChild;if(b&&b===p.lastChild&&b.nodeType===3){b.nodeValue=g;return}}p.textContent=g}var hm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function AS(p,g,b){var A=g.indexOf("--")===0;b==null||typeof b=="boolean"||b===""?A?p.setProperty(g,""):g==="float"?p.cssFloat="":p[g]="":A?p.setProperty(g,b):typeof b!="number"||b===0||hm.has(g)?g==="float"?p.cssFloat=b:p[g]=(""+b).trim():p[g]=b+"px"}function Tb(p,g,b){if(g!=null&&typeof g!="object")throw Error(i(62));if(p=p.style,b!=null){for(var A in b)!b.hasOwnProperty(A)||g!=null&&g.hasOwnProperty(A)||(A.indexOf("--")===0?p.setProperty(A,""):A==="float"?p.cssFloat="":p[A]="");for(var R in g)A=g[R],g.hasOwnProperty(R)&&b[R]!==A&&AS(p,R,A)}else for(var z in g)g.hasOwnProperty(z)&&AS(p,z,g[z])}function Mb(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mN=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),gN=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function M0(p){return gN.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}var yd=null;function fl(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var xd=null,bd=null;function Pb(p){var g=Gt(p);if(g&&(p=g.stateNode)){var b=p[ln]||null;e:switch(p=g.stateNode,g.type){case"input":if(Vo(p,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name),g=b.name,b.type==="radio"&&g!=null){for(b=p;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll('input[name="'+cn(""+g)+'"][type="radio"]'),g=0;g<b.length;g++){var A=b[g];if(A!==p&&A.form===p.form){var R=A[ln]||null;if(!R)throw Error(i(90));Vo(A,R.value,R.defaultValue,R.defaultValue,R.checked,R.defaultChecked,R.type,R.name)}}for(g=0;g<b.length;g++)A=b[g],A.form===p.form&&Qc(A)}break e;case"textarea":Oi(p,b.value,b.defaultValue);break e;case"select":g=b.value,g!=null&&vd(p,!!b.multiple,g,!1)}}}var Zc=!1;function CS(p,g,b){if(Zc)return p(g,b);Zc=!0;try{var A=p(g);return A}finally{if(Zc=!1,(xd!==null||bd!==null)&&(xE(),xd&&(g=xd,p=bd,bd=xd=null,Pb(g),p)))for(g=0;g<p.length;g++)Pb(p[g])}}function fm(p,g){var b=p.stateNode;if(b===null)return null;var A=b[ln]||null;if(A===null)return null;b=A[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(p=p.type,A=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!A;break e;default:p=!1}if(p)return null;if(b&&typeof b!="function")throw Error(i(231,g,typeof b));return b}var ec=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pl=!1;if(ec)try{var pm={};Object.defineProperty(pm,"passive",{get:function(){pl=!0}}),window.addEventListener("test",pm,pm),window.removeEventListener("test",pm,pm)}catch{pl=!1}var Jc=null,rf=null,wd=null;function Db(){if(wd)return wd;var p,g=rf,b=g.length,A,R="value"in Jc?Jc.value:Jc.textContent,z=R.length;for(p=0;p<b&&g[p]===R[p];p++);var Q=b-p;for(A=1;A<=Q&&g[b-A]===R[z-A];A++);return wd=R.slice(p,1<A?1-A:void 0)}function eu(p){var g=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&g===13&&(p=13)):p=g,p===10&&(p=13),32<=p||p===13?p:0}function tu(){return!0}function Nb(){return!1}function ks(p){function g(b,A,R,z,Q){this._reactName=b,this._targetInst=R,this.type=A,this.nativeEvent=z,this.target=Q,this.currentTarget=null;for(var le in p)p.hasOwnProperty(le)&&(b=p[le],this[le]=b?b(z):z[le]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?tu:Nb,this.isPropagationStopped=Nb,this}return u(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=tu)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=tu)},persist:function(){},isPersistent:tu}),g}var wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},P0=ks(wi),mm=u({},wi,{view:0,detail:0}),TS=ks(mm),D0,N0,ru,gm=u({},mm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xm,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==ru&&(ru&&p.type==="mousemove"?(D0=p.screenX-ru.screenX,N0=p.screenY-ru.screenY):N0=D0=0,ru=p),D0)},movementY:function(p){return"movementY"in p?p.movementY:N0}}),ml=ks(gm),MS=u({},gm,{dataTransfer:0}),vN=ks(MS),vm=u({},mm,{relatedTarget:0}),k0=ks(vm),kb=u({},wi,{animationName:0,elapsedTime:0,pseudoElement:0}),R0=ks(kb),PS=u({},wi,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),I0=ks(PS),yN=u({},wi,{data:0}),Rb=ks(yN),ym={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},NS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ib(p){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(p):(p=NS[p])?!!g[p]:!1}function xm(){return Ib}var kS=u({},mm,{key:function(p){if(p.key){var g=ym[p.key]||p.key;if(g!=="Unidentified")return g}return p.type==="keypress"?(p=eu(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?DS[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xm,charCode:function(p){return p.type==="keypress"?eu(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?eu(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),O0=ks(kS),RS=u({},gm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ob=ks(RS),_d=u({},mm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xm}),IS=ks(_d),OS=u({},wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),jS=ks(OS),LS=u({},gm,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),j0=ks(LS),qa=u({},wi,{newState:0,oldState:0}),zS=ks(qa),BS=[9,13,27,32],iu=ec&&"CompositionEvent"in window,k=null;ec&&"documentMode"in document&&(k=document.documentMode);var U=ec&&"TextEvent"in window&&!k,K=ec&&(!iu||k&&8<k&&11>=k),ue=" ",Re=!1;function Ye(p,g){switch(p){case"keyup":return BS.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wt(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var ii=!1;function ps(p,g){switch(p){case"compositionend":return wt(g);case"keypress":return g.which!==32?null:(Re=!0,ue);case"textInput":return p=g.data,p===ue&&Re?null:p;default:return null}}function ni(p,g){if(ii)return p==="compositionend"||!iu&&Ye(p,g)?(p=Db(),wd=rf=Jc=null,ii=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return K&&g.locale!=="ko"?null:g.data;default:return null}}var Rs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ms(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g==="input"?!!Rs[p.type]:g==="textarea"}function Sd(p,g,b,A){xd?bd?bd.push(A):bd=[A]:xd=A,g=AE(g,"onChange"),0<g.length&&(b=new P0("onChange","change",null,b,A),p.push({event:b,listeners:g}))}var ta=null,nu=null;function jb(p){T7(p,0)}function FS(p){var g=qt(p);if(Qc(g))return p}function XU(p,g){if(p==="change")return g}var $U=!1;if(ec){var xN;if(ec){var bN="oninput"in document;if(!bN){var KU=document.createElement("div");KU.setAttribute("oninput","return;"),bN=typeof KU.oninput=="function"}xN=bN}else xN=!1;$U=xN&&(!document.documentMode||9<document.documentMode)}function QU(){ta&&(ta.detachEvent("onpropertychange",ZU),nu=ta=null)}function ZU(p){if(p.propertyName==="value"&&FS(nu)){var g=[];Sd(g,nu,p,fl(p)),CS(jb,g)}}function k0e(p,g,b){p==="focusin"?(QU(),ta=g,nu=b,ta.attachEvent("onpropertychange",ZU)):p==="focusout"&&QU()}function R0e(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return FS(nu)}function I0e(p,g){if(p==="click")return FS(g)}function O0e(p,g){if(p==="input"||p==="change")return FS(g)}function j0e(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var Uo=typeof Object.is=="function"?Object.is:j0e;function Lb(p,g){if(Uo(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var b=Object.keys(p),A=Object.keys(g);if(b.length!==A.length)return!1;for(A=0;A<b.length;A++){var R=b[A];if(!xe.call(g,R)||!Uo(p[R],g[R]))return!1}return!0}function JU(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function e8(p,g){var b=JU(p);p=0;for(var A;b;){if(b.nodeType===3){if(A=p+b.textContent.length,p<=g&&A>=g)return{node:b,offset:g-p};p=A}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=JU(b)}}function t8(p,g){return p&&g?p===g?!0:p&&p.nodeType===3?!1:g&&g.nodeType===3?t8(p,g.parentNode):"contains"in p?p.contains(g):p.compareDocumentPosition?!!(p.compareDocumentPosition(g)&16):!1:!1}function r8(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var g=Jl(p.document);g instanceof p.HTMLIFrameElement;){try{var b=typeof g.contentWindow.location.href=="string"}catch{b=!1}if(b)p=g.contentWindow;else break;g=Jl(p.document)}return g}function wN(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g&&(g==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||g==="textarea"||p.contentEditable==="true")}var L0e=ec&&"documentMode"in document&&11>=document.documentMode,L0=null,_N=null,zb=null,SN=!1;function i8(p,g,b){var A=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;SN||L0==null||L0!==Jl(A)||(A=L0,"selectionStart"in A&&wN(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),zb&&Lb(zb,A)||(zb=A,A=AE(_N,"onSelect"),0<A.length&&(g=new P0("onSelect","select",null,g,b),p.push({event:g,listeners:A}),g.target=L0)))}function bm(p,g){var b={};return b[p.toLowerCase()]=g.toLowerCase(),b["Webkit"+p]="webkit"+g,b["Moz"+p]="moz"+g,b}var z0={animationend:bm("Animation","AnimationEnd"),animationiteration:bm("Animation","AnimationIteration"),animationstart:bm("Animation","AnimationStart"),transitionrun:bm("Transition","TransitionRun"),transitionstart:bm("Transition","TransitionStart"),transitioncancel:bm("Transition","TransitionCancel"),transitionend:bm("Transition","TransitionEnd")},EN={},n8={};ec&&(n8=document.createElement("div").style,"AnimationEvent"in window||(delete z0.animationend.animation,delete z0.animationiteration.animation,delete z0.animationstart.animation),"TransitionEvent"in window||delete z0.transitionend.transition);function wm(p){if(EN[p])return EN[p];if(!z0[p])return p;var g=z0[p],b;for(b in g)if(g.hasOwnProperty(b)&&b in n8)return EN[p]=g[b];return p}var s8=wm("animationend"),a8=wm("animationiteration"),o8=wm("animationstart"),z0e=wm("transitionrun"),B0e=wm("transitionstart"),F0e=wm("transitioncancel"),l8=wm("transitionend"),c8=new Map,AN="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");AN.push("scrollEnd");function tc(p,g){c8.set(p,g),Xt(g,[p])}var u8=new WeakMap;function gl(p,g){if(typeof p=="object"&&p!==null){var b=u8.get(p);return b!==void 0?b:(g={value:p,source:g,stack:de(g)},u8.set(p,g),g)}return{value:p,source:g,stack:de(g)}}var vl=[],B0=0,CN=0;function VS(){for(var p=B0,g=CN=B0=0;g<p;){var b=vl[g];vl[g++]=null;var A=vl[g];vl[g++]=null;var R=vl[g];vl[g++]=null;var z=vl[g];if(vl[g++]=null,A!==null&&R!==null){var Q=A.pending;Q===null?R.next=R:(R.next=Q.next,Q.next=R),A.pending=R}z!==0&&d8(b,R,z)}}function US(p,g,b,A){vl[B0++]=p,vl[B0++]=g,vl[B0++]=b,vl[B0++]=A,CN|=A,p.lanes|=A,p=p.alternate,p!==null&&(p.lanes|=A)}function TN(p,g,b,A){return US(p,g,b,A),HS(p)}function F0(p,g){return US(p,null,null,g),HS(p)}function d8(p,g,b){p.lanes|=b;var A=p.alternate;A!==null&&(A.lanes|=b);for(var R=!1,z=p.return;z!==null;)z.childLanes|=b,A=z.alternate,A!==null&&(A.childLanes|=b),z.tag===22&&(p=z.stateNode,p===null||p._visibility&1||(R=!0)),p=z,z=z.return;return p.tag===3?(z=p.stateNode,R&&g!==null&&(R=31-Ue(b),p=z.hiddenUpdates,A=p[R],A===null?p[R]=[g]:A.push(g),g.lane=b|536870912),z):null}function HS(p){if(50<c1)throw c1=0,Rk=null,Error(i(185));for(var g=p.return;g!==null;)p=g,g=p.return;return p.tag===3?p.stateNode:null}var V0={};function V0e(p,g,b,A){this.tag=p,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ho(p,g,b,A){return new V0e(p,g,b,A)}function MN(p){return p=p.prototype,!(!p||!p.isReactComponent)}function Ed(p,g){var b=p.alternate;return b===null?(b=Ho(p.tag,g,p.key,p.mode),b.elementType=p.elementType,b.type=p.type,b.stateNode=p.stateNode,b.alternate=p,p.alternate=b):(b.pendingProps=g,b.type=p.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=p.flags&65011712,b.childLanes=p.childLanes,b.lanes=p.lanes,b.child=p.child,b.memoizedProps=p.memoizedProps,b.memoizedState=p.memoizedState,b.updateQueue=p.updateQueue,g=p.dependencies,b.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},b.sibling=p.sibling,b.index=p.index,b.ref=p.ref,b.refCleanup=p.refCleanup,b}function h8(p,g){p.flags&=65011714;var b=p.alternate;return b===null?(p.childLanes=0,p.lanes=g,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=b.childLanes,p.lanes=b.lanes,p.child=b.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=b.memoizedProps,p.memoizedState=b.memoizedState,p.updateQueue=b.updateQueue,p.type=b.type,g=b.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),p}function GS(p,g,b,A,R,z){var Q=0;if(A=p,typeof p=="function")MN(p)&&(Q=1);else if(typeof p=="string")Q=Hve(p,b,ne.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case N:return p=Ho(31,b,g,R),p.elementType=N,p.lanes=z,p;case v:return _m(b.children,R,z,g);case y:Q=8,R|=24;break;case x:return p=Ho(12,b,g,R|2),p.elementType=x,p.lanes=z,p;case M:return p=Ho(13,b,g,R),p.elementType=M,p.lanes=z,p;case C:return p=Ho(19,b,g,R),p.elementType=C,p.lanes=z,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case w:case S:Q=10;break e;case _:Q=9;break e;case P:Q=11;break e;case T:Q=14;break e;case E:Q=16,A=null;break e}Q=29,b=Error(i(130,p===null?"null":typeof p,"")),A=null}return g=Ho(Q,b,g,R),g.elementType=p,g.type=A,g.lanes=z,g}function _m(p,g,b,A){return p=Ho(7,p,A,g),p.lanes=b,p}function PN(p,g,b){return p=Ho(6,p,null,g),p.lanes=b,p}function DN(p,g,b){return g=Ho(4,p.children!==null?p.children:[],p.key,g),g.lanes=b,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}var U0=[],H0=0,WS=null,qS=0,yl=[],xl=0,Sm=null,Ad=1,Cd="";function Em(p,g){U0[H0++]=qS,U0[H0++]=WS,WS=p,qS=g}function f8(p,g,b){yl[xl++]=Ad,yl[xl++]=Cd,yl[xl++]=Sm,Sm=p;var A=Ad;p=Cd;var R=32-Ue(A)-1;A&=~(1<<R),b+=1;var z=32-Ue(g)+R;if(30<z){var Q=R-R%5;z=(A&(1<<Q)-1).toString(32),A>>=Q,R-=Q,Ad=1<<32-Ue(g)+R|b<<R|A,Cd=z+p}else Ad=1<<z|b<<R|A,Cd=p}function NN(p){p.return!==null&&(Em(p,1),f8(p,1,0))}function kN(p){for(;p===WS;)WS=U0[--H0],U0[H0]=null,qS=U0[--H0],U0[H0]=null;for(;p===Sm;)Sm=yl[--xl],yl[xl]=null,Cd=yl[--xl],yl[xl]=null,Ad=yl[--xl],yl[xl]=null}var Ya=null,_n=null,vi=!1,Am=null,su=!1,RN=Error(i(519));function Cm(p){var g=Error(i(418,""));throw Vb(gl(g,p)),RN}function p8(p){var g=p.stateNode,b=p.type,A=p.memoizedProps;switch(g[$i]=p,g[ln]=A,b){case"dialog":qr("cancel",g),qr("close",g);break;case"iframe":case"object":case"embed":qr("load",g);break;case"video":case"audio":for(b=0;b<d1.length;b++)qr(d1[b],g);break;case"source":qr("error",g);break;case"img":case"image":case"link":qr("error",g),qr("load",g);break;case"details":qr("toggle",g);break;case"input":qr("invalid",g),um(g,A.value,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name,!0),Kc(g);break;case"select":qr("invalid",g);break;case"textarea":qr("invalid",g),dm(g,A.value,A.defaultValue,A.children),Kc(g)}b=A.children,typeof b!="string"&&typeof b!="number"&&typeof b!="bigint"||g.textContent===""+b||A.suppressHydrationWarning===!0||N7(g.textContent,b)?(A.popover!=null&&(qr("beforetoggle",g),qr("toggle",g)),A.onScroll!=null&&qr("scroll",g),A.onScrollEnd!=null&&qr("scrollend",g),A.onClick!=null&&(g.onclick=CE),g=!0):g=!1,g||Cm(p)}function m8(p){for(Ya=p.return;Ya;)switch(Ya.tag){case 5:case 13:su=!1;return;case 27:case 3:su=!0;return;default:Ya=Ya.return}}function Bb(p){if(p!==Ya)return!1;if(!vi)return m8(p),vi=!0,!1;var g=p.tag,b;if((b=g!==3&&g!==27)&&((b=g===5)&&(b=p.type,b=!(b!=="form"&&b!=="button")||$k(p.type,p.memoizedProps)),b=!b),b&&_n&&Cm(p),m8(p),g===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));e:{for(p=p.nextSibling,g=0;p;){if(p.nodeType===8)if(b=p.data,b==="/$"){if(g===0){_n=ic(p.nextSibling);break e}g--}else b!=="$"&&b!=="$!"&&b!=="$?"||g++;p=p.nextSibling}_n=null}}else g===27?(g=_n,xf(p.type)?(p=Jk,Jk=null,_n=p):_n=g):_n=Ya?ic(p.stateNode.nextSibling):null;return!0}function Fb(){_n=Ya=null,vi=!1}function g8(){var p=Am;return p!==null&&(yo===null?yo=p:yo.push.apply(yo,p),Am=null),p}function Vb(p){Am===null?Am=[p]:Am.push(p)}var IN=$(null),Tm=null,Td=null;function nf(p,g,b){H(IN,g._currentValue),g._currentValue=b}function Md(p){p._currentValue=IN.current,se(IN)}function ON(p,g,b){for(;p!==null;){var A=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,A!==null&&(A.childLanes|=g)):A!==null&&(A.childLanes&g)!==g&&(A.childLanes|=g),p===b)break;p=p.return}}function jN(p,g,b,A){var R=p.child;for(R!==null&&(R.return=p);R!==null;){var z=R.dependencies;if(z!==null){var Q=R.child;z=z.firstContext;e:for(;z!==null;){var le=z;z=R;for(var we=0;we<g.length;we++)if(le.context===g[we]){z.lanes|=b,le=z.alternate,le!==null&&(le.lanes|=b),ON(z.return,b,p),A||(Q=null);break e}z=le.next}}else if(R.tag===18){if(Q=R.return,Q===null)throw Error(i(341));Q.lanes|=b,z=Q.alternate,z!==null&&(z.lanes|=b),ON(Q,b,p),Q=null}else Q=R.child;if(Q!==null)Q.return=R;else for(Q=R;Q!==null;){if(Q===p){Q=null;break}if(R=Q.sibling,R!==null){R.return=Q.return,Q=R;break}Q=Q.return}R=Q}}function Ub(p,g,b,A){p=null;for(var R=g,z=!1;R!==null;){if(!z){if((R.flags&524288)!==0)z=!0;else if((R.flags&262144)!==0)break}if(R.tag===10){var Q=R.alternate;if(Q===null)throw Error(i(387));if(Q=Q.memoizedProps,Q!==null){var le=R.type;Uo(R.pendingProps.value,Q.value)||(p!==null?p.push(le):p=[le])}}else if(R===ae.current){if(Q=R.alternate,Q===null)throw Error(i(387));Q.memoizedState.memoizedState!==R.memoizedState.memoizedState&&(p!==null?p.push(v1):p=[v1])}R=R.return}p!==null&&jN(g,p,b,A),g.flags|=262144}function YS(p){for(p=p.firstContext;p!==null;){if(!Uo(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function Mm(p){Tm=p,Td=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function Aa(p){return v8(Tm,p)}function XS(p,g){return Tm===null&&Mm(p),v8(p,g)}function v8(p,g){var b=g._currentValue;if(g={context:g,memoizedValue:b,next:null},Td===null){if(p===null)throw Error(i(308));Td=g,p.dependencies={lanes:0,firstContext:g},p.flags|=524288}else Td=Td.next=g;return b}var U0e=typeof AbortController<"u"?AbortController:function(){var p=[],g=this.signal={aborted:!1,addEventListener:function(b,A){p.push(A)}};this.abort=function(){g.aborted=!0,p.forEach(function(b){return b()})}},H0e=e.unstable_scheduleCallback,G0e=e.unstable_NormalPriority,gs={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function LN(){return{controller:new U0e,data:new Map,refCount:0}}function Hb(p){p.refCount--,p.refCount===0&&H0e(G0e,function(){p.controller.abort()})}var Gb=null,zN=0,G0=0,W0=null;function W0e(p,g){if(Gb===null){var b=Gb=[];zN=0,G0=Fk(),W0={status:"pending",value:void 0,then:function(A){b.push(A)}}}return zN++,g.then(y8,y8),g}function y8(){if(--zN===0&&Gb!==null){W0!==null&&(W0.status="fulfilled");var p=Gb;Gb=null,G0=0,W0=null;for(var g=0;g<p.length;g++)(0,p[g])()}}function q0e(p,g){var b=[],A={status:"pending",value:null,reason:null,then:function(R){b.push(R)}};return p.then(function(){A.status="fulfilled",A.value=g;for(var R=0;R<b.length;R++)(0,b[R])(g)},function(R){for(A.status="rejected",A.reason=R,R=0;R<b.length;R++)(0,b[R])(void 0)}),A}var x8=G.S;G.S=function(p,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&W0e(p,g),x8!==null&&x8(p,g)};var Pm=$(null);function BN(){var p=Pm.current;return p!==null?p:Ki.pooledCache}function $S(p,g){g===null?H(Pm,Pm.current):H(Pm,g.pool)}function b8(){var p=BN();return p===null?null:{parent:gs._currentValue,pool:p}}var Wb=Error(i(460)),w8=Error(i(474)),KS=Error(i(542)),FN={then:function(){}};function _8(p){return p=p.status,p==="fulfilled"||p==="rejected"}function QS(){}function S8(p,g,b){switch(b=p[b],b===void 0?p.push(g):b!==g&&(g.then(QS,QS),g=b),g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,A8(p),p;default:if(typeof g.status=="string")g.then(QS,QS);else{if(p=Ki,p!==null&&100<p.shellSuspendCounter)throw Error(i(482));p=g,p.status="pending",p.then(function(A){if(g.status==="pending"){var R=g;R.status="fulfilled",R.value=A}},function(A){if(g.status==="pending"){var R=g;R.status="rejected",R.reason=A}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,A8(p),p}throw qb=g,Wb}}var qb=null;function E8(){if(qb===null)throw Error(i(459));var p=qb;return qb=null,p}function A8(p){if(p===Wb||p===KS)throw Error(i(483))}var sf=!1;function VN(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function UN(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function af(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function of(p,g,b){var A=p.updateQueue;if(A===null)return null;if(A=A.shared,(Ti&2)!==0){var R=A.pending;return R===null?g.next=g:(g.next=R.next,R.next=g),A.pending=g,g=HS(p),d8(p,null,b),g}return US(p,A,g,b),HS(p)}function Yb(p,g,b){if(g=g.updateQueue,g!==null&&(g=g.shared,(b&4194048)!==0)){var A=g.lanes;A&=p.pendingLanes,b|=A,g.lanes=b,Ui(p,b)}}function HN(p,g){var b=p.updateQueue,A=p.alternate;if(A!==null&&(A=A.updateQueue,b===A)){var R=null,z=null;if(b=b.firstBaseUpdate,b!==null){do{var Q={lane:b.lane,tag:b.tag,payload:b.payload,callback:null,next:null};z===null?R=z=Q:z=z.next=Q,b=b.next}while(b!==null);z===null?R=z=g:z=z.next=g}else R=z=g;b={baseState:A.baseState,firstBaseUpdate:R,lastBaseUpdate:z,shared:A.shared,callbacks:A.callbacks},p.updateQueue=b;return}p=b.lastBaseUpdate,p===null?b.firstBaseUpdate=g:p.next=g,b.lastBaseUpdate=g}var GN=!1;function Xb(){if(GN){var p=W0;if(p!==null)throw p}}function $b(p,g,b,A){GN=!1;var R=p.updateQueue;sf=!1;var z=R.firstBaseUpdate,Q=R.lastBaseUpdate,le=R.shared.pending;if(le!==null){R.shared.pending=null;var we=le,Le=we.next;we.next=null,Q===null?z=Le:Q.next=Le,Q=we;var rt=p.alternate;rt!==null&&(rt=rt.updateQueue,le=rt.lastBaseUpdate,le!==Q&&(le===null?rt.firstBaseUpdate=Le:le.next=Le,rt.lastBaseUpdate=we))}if(z!==null){var at=R.baseState;Q=0,rt=Le=we=null,le=z;do{var Fe=le.lane&-536870913,Ve=Fe!==le.lane;if(Ve?(si&Fe)===Fe:(A&Fe)===Fe){Fe!==0&&Fe===G0&&(GN=!0),rt!==null&&(rt=rt.next={lane:0,tag:le.tag,payload:le.payload,callback:null,next:null});e:{var yr=p,dr=le;Fe=g;var zi=b;switch(dr.tag){case 1:if(yr=dr.payload,typeof yr=="function"){at=yr.call(zi,at,Fe);break e}at=yr;break e;case 3:yr.flags=yr.flags&-65537|128;case 0:if(yr=dr.payload,Fe=typeof yr=="function"?yr.call(zi,at,Fe):yr,Fe==null)break e;at=u({},at,Fe);break e;case 2:sf=!0}}Fe=le.callback,Fe!==null&&(p.flags|=64,Ve&&(p.flags|=8192),Ve=R.callbacks,Ve===null?R.callbacks=[Fe]:Ve.push(Fe))}else Ve={lane:Fe,tag:le.tag,payload:le.payload,callback:le.callback,next:null},rt===null?(Le=rt=Ve,we=at):rt=rt.next=Ve,Q|=Fe;if(le=le.next,le===null){if(le=R.shared.pending,le===null)break;Ve=le,le=Ve.next,Ve.next=null,R.lastBaseUpdate=Ve,R.shared.pending=null}}while(!0);rt===null&&(we=at),R.baseState=we,R.firstBaseUpdate=Le,R.lastBaseUpdate=rt,z===null&&(R.shared.lanes=0),mf|=Q,p.lanes=Q,p.memoizedState=at}}function C8(p,g){if(typeof p!="function")throw Error(i(191,p));p.call(g)}function T8(p,g){var b=p.callbacks;if(b!==null)for(p.callbacks=null,p=0;p<b.length;p++)C8(b[p],g)}var q0=$(null),ZS=$(0);function M8(p,g){p=Od,H(ZS,p),H(q0,g),Od=p|g.baseLanes}function WN(){H(ZS,Od),H(q0,q0.current)}function qN(){Od=ZS.current,se(q0),se(ZS)}var lf=0,Br=null,ji=null,$n=null,JS=!1,Y0=!1,Dm=!1,eE=0,Kb=0,X0=null,Y0e=0;function kn(){throw Error(i(321))}function YN(p,g){if(g===null)return!1;for(var b=0;b<g.length&&b<p.length;b++)if(!Uo(p[b],g[b]))return!1;return!0}function XN(p,g,b,A,R,z){return lf=z,Br=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,G.H=p===null||p.memoizedState===null?d9:h9,Dm=!1,z=b(A,R),Dm=!1,Y0&&(z=D8(g,b,A,R)),P8(p),z}function P8(p){G.H=aE;var g=ji!==null&&ji.next!==null;if(lf=0,$n=ji=Br=null,JS=!1,Kb=0,X0=null,g)throw Error(i(300));p===null||Is||(p=p.dependencies,p!==null&&YS(p)&&(Is=!0))}function D8(p,g,b,A){Br=p;var R=0;do{if(Y0&&(X0=null),Kb=0,Y0=!1,25<=R)throw Error(i(301));if(R+=1,$n=ji=null,p.updateQueue!=null){var z=p.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}G.H=eve,z=g(b,A)}while(Y0);return z}function X0e(){var p=G.H,g=p.useState()[0];return g=typeof g.then=="function"?Qb(g):g,p=p.useState()[0],(ji!==null?ji.memoizedState:null)!==p&&(Br.flags|=1024),g}function $N(){var p=eE!==0;return eE=0,p}function KN(p,g,b){g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~b}function QN(p){if(JS){for(p=p.memoizedState;p!==null;){var g=p.queue;g!==null&&(g.pending=null),p=p.next}JS=!1}lf=0,$n=ji=Br=null,Y0=!1,Kb=eE=0,X0=null}function go(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $n===null?Br.memoizedState=$n=p:$n=$n.next=p,$n}function Kn(){if(ji===null){var p=Br.alternate;p=p!==null?p.memoizedState:null}else p=ji.next;var g=$n===null?Br.memoizedState:$n.next;if(g!==null)$n=g,ji=p;else{if(p===null)throw Br.alternate===null?Error(i(467)):Error(i(310));ji=p,p={memoizedState:ji.memoizedState,baseState:ji.baseState,baseQueue:ji.baseQueue,queue:ji.queue,next:null},$n===null?Br.memoizedState=$n=p:$n=$n.next=p}return $n}function ZN(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Qb(p){var g=Kb;return Kb+=1,X0===null&&(X0=[]),p=S8(X0,p,g),g=Br,($n===null?g.memoizedState:$n.next)===null&&(g=g.alternate,G.H=g===null||g.memoizedState===null?d9:h9),p}function tE(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return Qb(p);if(p.$$typeof===S)return Aa(p)}throw Error(i(438,String(p)))}function JN(p){var g=null,b=Br.updateQueue;if(b!==null&&(g=b.memoCache),g==null){var A=Br.alternate;A!==null&&(A=A.updateQueue,A!==null&&(A=A.memoCache,A!=null&&(g={data:A.data.map(function(R){return R.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),b===null&&(b=ZN(),Br.updateQueue=b),b.memoCache=g,b=g.data[g.index],b===void 0)for(b=g.data[g.index]=Array(p),A=0;A<p;A++)b[A]=D;return g.index++,b}function Pd(p,g){return typeof g=="function"?g(p):g}function rE(p){var g=Kn();return ek(g,ji,p)}function ek(p,g,b){var A=p.queue;if(A===null)throw Error(i(311));A.lastRenderedReducer=b;var R=p.baseQueue,z=A.pending;if(z!==null){if(R!==null){var Q=R.next;R.next=z.next,z.next=Q}g.baseQueue=R=z,A.pending=null}if(z=p.baseState,R===null)p.memoizedState=z;else{g=R.next;var le=Q=null,we=null,Le=g,rt=!1;do{var at=Le.lane&-536870913;if(at!==Le.lane?(si&at)===at:(lf&at)===at){var Fe=Le.revertLane;if(Fe===0)we!==null&&(we=we.next={lane:0,revertLane:0,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),at===G0&&(rt=!0);else if((lf&Fe)===Fe){Le=Le.next,Fe===G0&&(rt=!0);continue}else at={lane:0,revertLane:Le.revertLane,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},we===null?(le=we=at,Q=z):we=we.next=at,Br.lanes|=Fe,mf|=Fe;at=Le.action,Dm&&b(z,at),z=Le.hasEagerState?Le.eagerState:b(z,at)}else Fe={lane:at,revertLane:Le.revertLane,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null},we===null?(le=we=Fe,Q=z):we=we.next=Fe,Br.lanes|=at,mf|=at;Le=Le.next}while(Le!==null&&Le!==g);if(we===null?Q=z:we.next=le,!Uo(z,p.memoizedState)&&(Is=!0,rt&&(b=W0,b!==null)))throw b;p.memoizedState=z,p.baseState=Q,p.baseQueue=we,A.lastRenderedState=z}return R===null&&(A.lanes=0),[p.memoizedState,A.dispatch]}function tk(p){var g=Kn(),b=g.queue;if(b===null)throw Error(i(311));b.lastRenderedReducer=p;var A=b.dispatch,R=b.pending,z=g.memoizedState;if(R!==null){b.pending=null;var Q=R=R.next;do z=p(z,Q.action),Q=Q.next;while(Q!==R);Uo(z,g.memoizedState)||(Is=!0),g.memoizedState=z,g.baseQueue===null&&(g.baseState=z),b.lastRenderedState=z}return[z,A]}function N8(p,g,b){var A=Br,R=Kn(),z=vi;if(z){if(b===void 0)throw Error(i(407));b=b()}else b=g();var Q=!Uo((ji||R).memoizedState,b);Q&&(R.memoizedState=b,Is=!0),R=R.queue;var le=I8.bind(null,A,R,p);if(Zb(2048,8,le,[p]),R.getSnapshot!==g||Q||$n!==null&&$n.memoizedState.tag&1){if(A.flags|=2048,$0(9,iE(),R8.bind(null,A,R,b,g),null),Ki===null)throw Error(i(349));z||(lf&124)!==0||k8(A,g,b)}return b}function k8(p,g,b){p.flags|=16384,p={getSnapshot:g,value:b},g=Br.updateQueue,g===null?(g=ZN(),Br.updateQueue=g,g.stores=[p]):(b=g.stores,b===null?g.stores=[p]:b.push(p))}function R8(p,g,b,A){g.value=b,g.getSnapshot=A,O8(g)&&j8(p)}function I8(p,g,b){return b(function(){O8(g)&&j8(p)})}function O8(p){var g=p.getSnapshot;p=p.value;try{var b=g();return!Uo(p,b)}catch{return!0}}function j8(p){var g=F0(p,2);g!==null&&Xo(g,p,2)}function rk(p){var g=go();if(typeof p=="function"){var b=p;if(p=b(),Dm){ze(!0);try{b()}finally{ze(!1)}}}return g.memoizedState=g.baseState=p,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pd,lastRenderedState:p},g}function L8(p,g,b,A){return p.baseState=b,ek(p,ji,typeof A=="function"?A:Pd)}function $0e(p,g,b,A,R){if(sE(p))throw Error(i(485));if(p=g.action,p!==null){var z={payload:R,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Q){z.listeners.push(Q)}};G.T!==null?b(!0):z.isTransition=!1,A(z),b=g.pending,b===null?(z.next=g.pending=z,z8(g,z)):(z.next=b.next,g.pending=b.next=z)}}function z8(p,g){var b=g.action,A=g.payload,R=p.state;if(g.isTransition){var z=G.T,Q={};G.T=Q;try{var le=b(R,A),we=G.S;we!==null&&we(Q,le),B8(p,g,le)}catch(Le){ik(p,g,Le)}finally{G.T=z}}else try{z=b(R,A),B8(p,g,z)}catch(Le){ik(p,g,Le)}}function B8(p,g,b){b!==null&&typeof b=="object"&&typeof b.then=="function"?b.then(function(A){F8(p,g,A)},function(A){return ik(p,g,A)}):F8(p,g,b)}function F8(p,g,b){g.status="fulfilled",g.value=b,V8(g),p.state=b,g=p.pending,g!==null&&(b=g.next,b===g?p.pending=null:(b=b.next,g.next=b,z8(p,b)))}function ik(p,g,b){var A=p.pending;if(p.pending=null,A!==null){A=A.next;do g.status="rejected",g.reason=b,V8(g),g=g.next;while(g!==A)}p.action=null}function V8(p){p=p.listeners;for(var g=0;g<p.length;g++)(0,p[g])()}function U8(p,g){return g}function H8(p,g){if(vi){var b=Ki.formState;if(b!==null){e:{var A=Br;if(vi){if(_n){t:{for(var R=_n,z=su;R.nodeType!==8;){if(!z){R=null;break t}if(R=ic(R.nextSibling),R===null){R=null;break t}}z=R.data,R=z==="F!"||z==="F"?R:null}if(R){_n=ic(R.nextSibling),A=R.data==="F!";break e}}Cm(A)}A=!1}A&&(g=b[0])}}return b=go(),b.memoizedState=b.baseState=g,A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:U8,lastRenderedState:g},b.queue=A,b=l9.bind(null,Br,A),A.dispatch=b,A=rk(!1),z=lk.bind(null,Br,!1,A.queue),A=go(),R={state:g,dispatch:null,action:p,pending:null},A.queue=R,b=$0e.bind(null,Br,R,z,b),R.dispatch=b,A.memoizedState=p,[g,b,!1]}function G8(p){var g=Kn();return W8(g,ji,p)}function W8(p,g,b){if(g=ek(p,g,U8)[0],p=rE(Pd)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var A=Qb(g)}catch(Q){throw Q===Wb?KS:Q}else A=g;g=Kn();var R=g.queue,z=R.dispatch;return b!==g.memoizedState&&(Br.flags|=2048,$0(9,iE(),K0e.bind(null,R,b),null)),[A,z,p]}function K0e(p,g){p.action=g}function q8(p){var g=Kn(),b=ji;if(b!==null)return W8(g,b,p);Kn(),g=g.memoizedState,b=Kn();var A=b.queue.dispatch;return b.memoizedState=p,[g,A,!1]}function $0(p,g,b,A){return p={tag:p,create:b,deps:A,inst:g,next:null},g=Br.updateQueue,g===null&&(g=ZN(),Br.updateQueue=g),b=g.lastEffect,b===null?g.lastEffect=p.next=p:(A=b.next,b.next=p,p.next=A,g.lastEffect=p),p}function iE(){return{destroy:void 0,resource:void 0}}function Y8(){return Kn().memoizedState}function nE(p,g,b,A){var R=go();A=A===void 0?null:A,Br.flags|=p,R.memoizedState=$0(1|g,iE(),b,A)}function Zb(p,g,b,A){var R=Kn();A=A===void 0?null:A;var z=R.memoizedState.inst;ji!==null&&A!==null&&YN(A,ji.memoizedState.deps)?R.memoizedState=$0(g,z,b,A):(Br.flags|=p,R.memoizedState=$0(1|g,z,b,A))}function X8(p,g){nE(8390656,8,p,g)}function $8(p,g){Zb(2048,8,p,g)}function K8(p,g){return Zb(4,2,p,g)}function Q8(p,g){return Zb(4,4,p,g)}function Z8(p,g){if(typeof g=="function"){p=p();var b=g(p);return function(){typeof b=="function"?b():g(null)}}if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function J8(p,g,b){b=b!=null?b.concat([p]):null,Zb(4,4,Z8.bind(null,g,p),b)}function nk(){}function e9(p,g){var b=Kn();g=g===void 0?null:g;var A=b.memoizedState;return g!==null&&YN(g,A[1])?A[0]:(b.memoizedState=[p,g],p)}function t9(p,g){var b=Kn();g=g===void 0?null:g;var A=b.memoizedState;if(g!==null&&YN(g,A[1]))return A[0];if(A=p(),Dm){ze(!0);try{p()}finally{ze(!1)}}return b.memoizedState=[A,g],A}function sk(p,g,b){return b===void 0||(lf&1073741824)!==0?p.memoizedState=g:(p.memoizedState=b,p=n7(),Br.lanes|=p,mf|=p,b)}function r9(p,g,b,A){return Uo(b,g)?b:q0.current!==null?(p=sk(p,b,A),Uo(p,g)||(Is=!0),p):(lf&42)===0?(Is=!0,p.memoizedState=b):(p=n7(),Br.lanes|=p,mf|=p,g)}function i9(p,g,b,A,R){var z=Y.p;Y.p=z!==0&&8>z?z:8;var Q=G.T,le={};G.T=le,lk(p,!1,g,b);try{var we=R(),Le=G.S;if(Le!==null&&Le(le,we),we!==null&&typeof we=="object"&&typeof we.then=="function"){var rt=q0e(we,A);Jb(p,g,rt,Yo(p))}else Jb(p,g,A,Yo(p))}catch(at){Jb(p,g,{then:function(){},status:"rejected",reason:at},Yo())}finally{Y.p=z,G.T=Q}}function Q0e(){}function ak(p,g,b,A){if(p.tag!==5)throw Error(i(476));var R=n9(p).queue;i9(p,R,g,X,b===null?Q0e:function(){return s9(p),b(A)})}function n9(p){var g=p.memoizedState;if(g!==null)return g;g={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pd,lastRenderedState:X},next:null};var b={};return g.next={memoizedState:b,baseState:b,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pd,lastRenderedState:b},next:null},p.memoizedState=g,p=p.alternate,p!==null&&(p.memoizedState=g),g}function s9(p){var g=n9(p).next.queue;Jb(p,g,{},Yo())}function ok(){return Aa(v1)}function a9(){return Kn().memoizedState}function o9(){return Kn().memoizedState}function Z0e(p){for(var g=p.return;g!==null;){switch(g.tag){case 24:case 3:var b=Yo();p=af(b);var A=of(g,p,b);A!==null&&(Xo(A,g,b),Yb(A,g,b)),g={cache:LN()},p.payload=g;return}g=g.return}}function J0e(p,g,b){var A=Yo();b={lane:A,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null},sE(p)?c9(g,b):(b=TN(p,g,b,A),b!==null&&(Xo(b,p,A),u9(b,g,A)))}function l9(p,g,b){var A=Yo();Jb(p,g,b,A)}function Jb(p,g,b,A){var R={lane:A,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null};if(sE(p))c9(g,R);else{var z=p.alternate;if(p.lanes===0&&(z===null||z.lanes===0)&&(z=g.lastRenderedReducer,z!==null))try{var Q=g.lastRenderedState,le=z(Q,b);if(R.hasEagerState=!0,R.eagerState=le,Uo(le,Q))return US(p,g,R,0),Ki===null&&VS(),!1}catch{}finally{}if(b=TN(p,g,R,A),b!==null)return Xo(b,p,A),u9(b,g,A),!0}return!1}function lk(p,g,b,A){if(A={lane:2,revertLane:Fk(),action:A,hasEagerState:!1,eagerState:null,next:null},sE(p)){if(g)throw Error(i(479))}else g=TN(p,b,A,2),g!==null&&Xo(g,p,2)}function sE(p){var g=p.alternate;return p===Br||g!==null&&g===Br}function c9(p,g){Y0=JS=!0;var b=p.pending;b===null?g.next=g:(g.next=b.next,b.next=g),p.pending=g}function u9(p,g,b){if((b&4194048)!==0){var A=g.lanes;A&=p.pendingLanes,b|=A,g.lanes=b,Ui(p,b)}}var aE={readContext:Aa,use:tE,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useLayoutEffect:kn,useInsertionEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useSyncExternalStore:kn,useId:kn,useHostTransitionStatus:kn,useFormState:kn,useActionState:kn,useOptimistic:kn,useMemoCache:kn,useCacheRefresh:kn},d9={readContext:Aa,use:tE,useCallback:function(p,g){return go().memoizedState=[p,g===void 0?null:g],p},useContext:Aa,useEffect:X8,useImperativeHandle:function(p,g,b){b=b!=null?b.concat([p]):null,nE(4194308,4,Z8.bind(null,g,p),b)},useLayoutEffect:function(p,g){return nE(4194308,4,p,g)},useInsertionEffect:function(p,g){nE(4,2,p,g)},useMemo:function(p,g){var b=go();g=g===void 0?null:g;var A=p();if(Dm){ze(!0);try{p()}finally{ze(!1)}}return b.memoizedState=[A,g],A},useReducer:function(p,g,b){var A=go();if(b!==void 0){var R=b(g);if(Dm){ze(!0);try{b(g)}finally{ze(!1)}}}else R=g;return A.memoizedState=A.baseState=R,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:R},A.queue=p,p=p.dispatch=J0e.bind(null,Br,p),[A.memoizedState,p]},useRef:function(p){var g=go();return p={current:p},g.memoizedState=p},useState:function(p){p=rk(p);var g=p.queue,b=l9.bind(null,Br,g);return g.dispatch=b,[p.memoizedState,b]},useDebugValue:nk,useDeferredValue:function(p,g){var b=go();return sk(b,p,g)},useTransition:function(){var p=rk(!1);return p=i9.bind(null,Br,p.queue,!0,!1),go().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,g,b){var A=Br,R=go();if(vi){if(b===void 0)throw Error(i(407));b=b()}else{if(b=g(),Ki===null)throw Error(i(349));(si&124)!==0||k8(A,g,b)}R.memoizedState=b;var z={value:b,getSnapshot:g};return R.queue=z,X8(I8.bind(null,A,z,p),[p]),A.flags|=2048,$0(9,iE(),R8.bind(null,A,z,b,g),null),b},useId:function(){var p=go(),g=Ki.identifierPrefix;if(vi){var b=Cd,A=Ad;b=(A&~(1<<32-Ue(A)-1)).toString(32)+b,g="«"+g+"R"+b,b=eE++,0<b&&(g+="H"+b.toString(32)),g+="»"}else b=Y0e++,g="«"+g+"r"+b.toString(32)+"»";return p.memoizedState=g},useHostTransitionStatus:ok,useFormState:H8,useActionState:H8,useOptimistic:function(p){var g=go();g.memoizedState=g.baseState=p;var b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=b,g=lk.bind(null,Br,!0,b),b.dispatch=g,[p,g]},useMemoCache:JN,useCacheRefresh:function(){return go().memoizedState=Z0e.bind(null,Br)}},h9={readContext:Aa,use:tE,useCallback:e9,useContext:Aa,useEffect:$8,useImperativeHandle:J8,useInsertionEffect:K8,useLayoutEffect:Q8,useMemo:t9,useReducer:rE,useRef:Y8,useState:function(){return rE(Pd)},useDebugValue:nk,useDeferredValue:function(p,g){var b=Kn();return r9(b,ji.memoizedState,p,g)},useTransition:function(){var p=rE(Pd)[0],g=Kn().memoizedState;return[typeof p=="boolean"?p:Qb(p),g]},useSyncExternalStore:N8,useId:a9,useHostTransitionStatus:ok,useFormState:G8,useActionState:G8,useOptimistic:function(p,g){var b=Kn();return L8(b,ji,p,g)},useMemoCache:JN,useCacheRefresh:o9},eve={readContext:Aa,use:tE,useCallback:e9,useContext:Aa,useEffect:$8,useImperativeHandle:J8,useInsertionEffect:K8,useLayoutEffect:Q8,useMemo:t9,useReducer:tk,useRef:Y8,useState:function(){return tk(Pd)},useDebugValue:nk,useDeferredValue:function(p,g){var b=Kn();return ji===null?sk(b,p,g):r9(b,ji.memoizedState,p,g)},useTransition:function(){var p=tk(Pd)[0],g=Kn().memoizedState;return[typeof p=="boolean"?p:Qb(p),g]},useSyncExternalStore:N8,useId:a9,useHostTransitionStatus:ok,useFormState:q8,useActionState:q8,useOptimistic:function(p,g){var b=Kn();return ji!==null?L8(b,ji,p,g):(b.baseState=p,[p,b.queue.dispatch])},useMemoCache:JN,useCacheRefresh:o9},K0=null,e1=0;function oE(p){var g=e1;return e1+=1,K0===null&&(K0=[]),S8(K0,p,g)}function t1(p,g){g=g.props.ref,p.ref=g!==void 0?g:null}function lE(p,g){throw g.$$typeof===d?Error(i(525)):(p=Object.prototype.toString.call(g),Error(i(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p)))}function f9(p){var g=p._init;return g(p._payload)}function p9(p){function g(Pe,Te){if(p){var Ie=Pe.deletions;Ie===null?(Pe.deletions=[Te],Pe.flags|=16):Ie.push(Te)}}function b(Pe,Te){if(!p)return null;for(;Te!==null;)g(Pe,Te),Te=Te.sibling;return null}function A(Pe){for(var Te=new Map;Pe!==null;)Pe.key!==null?Te.set(Pe.key,Pe):Te.set(Pe.index,Pe),Pe=Pe.sibling;return Te}function R(Pe,Te){return Pe=Ed(Pe,Te),Pe.index=0,Pe.sibling=null,Pe}function z(Pe,Te,Ie){return Pe.index=Ie,p?(Ie=Pe.alternate,Ie!==null?(Ie=Ie.index,Ie<Te?(Pe.flags|=67108866,Te):Ie):(Pe.flags|=67108866,Te)):(Pe.flags|=1048576,Te)}function Q(Pe){return p&&Pe.alternate===null&&(Pe.flags|=67108866),Pe}function le(Pe,Te,Ie,st){return Te===null||Te.tag!==6?(Te=PN(Ie,Pe.mode,st),Te.return=Pe,Te):(Te=R(Te,Ie),Te.return=Pe,Te)}function we(Pe,Te,Ie,st){var zt=Ie.type;return zt===v?rt(Pe,Te,Ie.props.children,st,Ie.key):Te!==null&&(Te.elementType===zt||typeof zt=="object"&&zt!==null&&zt.$$typeof===E&&f9(zt)===Te.type)?(Te=R(Te,Ie.props),t1(Te,Ie),Te.return=Pe,Te):(Te=GS(Ie.type,Ie.key,Ie.props,null,Pe.mode,st),t1(Te,Ie),Te.return=Pe,Te)}function Le(Pe,Te,Ie,st){return Te===null||Te.tag!==4||Te.stateNode.containerInfo!==Ie.containerInfo||Te.stateNode.implementation!==Ie.implementation?(Te=DN(Ie,Pe.mode,st),Te.return=Pe,Te):(Te=R(Te,Ie.children||[]),Te.return=Pe,Te)}function rt(Pe,Te,Ie,st,zt){return Te===null||Te.tag!==7?(Te=_m(Ie,Pe.mode,st,zt),Te.return=Pe,Te):(Te=R(Te,Ie),Te.return=Pe,Te)}function at(Pe,Te,Ie){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return Te=PN(""+Te,Pe.mode,Ie),Te.return=Pe,Te;if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case f:return Ie=GS(Te.type,Te.key,Te.props,null,Pe.mode,Ie),t1(Ie,Te),Ie.return=Pe,Ie;case m:return Te=DN(Te,Pe.mode,Ie),Te.return=Pe,Te;case E:var st=Te._init;return Te=st(Te._payload),at(Pe,Te,Ie)}if(q(Te)||j(Te))return Te=_m(Te,Pe.mode,Ie,null),Te.return=Pe,Te;if(typeof Te.then=="function")return at(Pe,oE(Te),Ie);if(Te.$$typeof===S)return at(Pe,XS(Pe,Te),Ie);lE(Pe,Te)}return null}function Fe(Pe,Te,Ie,st){var zt=Te!==null?Te.key:null;if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return zt!==null?null:le(Pe,Te,""+Ie,st);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case f:return Ie.key===zt?we(Pe,Te,Ie,st):null;case m:return Ie.key===zt?Le(Pe,Te,Ie,st):null;case E:return zt=Ie._init,Ie=zt(Ie._payload),Fe(Pe,Te,Ie,st)}if(q(Ie)||j(Ie))return zt!==null?null:rt(Pe,Te,Ie,st,null);if(typeof Ie.then=="function")return Fe(Pe,Te,oE(Ie),st);if(Ie.$$typeof===S)return Fe(Pe,Te,XS(Pe,Ie),st);lE(Pe,Ie)}return null}function Ve(Pe,Te,Ie,st,zt){if(typeof st=="string"&&st!==""||typeof st=="number"||typeof st=="bigint")return Pe=Pe.get(Ie)||null,le(Te,Pe,""+st,zt);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case f:return Pe=Pe.get(st.key===null?Ie:st.key)||null,we(Te,Pe,st,zt);case m:return Pe=Pe.get(st.key===null?Ie:st.key)||null,Le(Te,Pe,st,zt);case E:var Ur=st._init;return st=Ur(st._payload),Ve(Pe,Te,Ie,st,zt)}if(q(st)||j(st))return Pe=Pe.get(Ie)||null,rt(Te,Pe,st,zt,null);if(typeof st.then=="function")return Ve(Pe,Te,Ie,oE(st),zt);if(st.$$typeof===S)return Ve(Pe,Te,Ie,XS(Te,st),zt);lE(Te,st)}return null}function yr(Pe,Te,Ie,st){for(var zt=null,Ur=null,Yt=Te,pr=Te=0,js=null;Yt!==null&&pr<Ie.length;pr++){Yt.index>pr?(js=Yt,Yt=null):js=Yt.sibling;var fi=Fe(Pe,Yt,Ie[pr],st);if(fi===null){Yt===null&&(Yt=js);break}p&&Yt&&fi.alternate===null&&g(Pe,Yt),Te=z(fi,Te,pr),Ur===null?zt=fi:Ur.sibling=fi,Ur=fi,Yt=js}if(pr===Ie.length)return b(Pe,Yt),vi&&Em(Pe,pr),zt;if(Yt===null){for(;pr<Ie.length;pr++)Yt=at(Pe,Ie[pr],st),Yt!==null&&(Te=z(Yt,Te,pr),Ur===null?zt=Yt:Ur.sibling=Yt,Ur=Yt);return vi&&Em(Pe,pr),zt}for(Yt=A(Yt);pr<Ie.length;pr++)js=Ve(Yt,Pe,pr,Ie[pr],st),js!==null&&(p&&js.alternate!==null&&Yt.delete(js.key===null?pr:js.key),Te=z(js,Te,pr),Ur===null?zt=js:Ur.sibling=js,Ur=js);return p&&Yt.forEach(function(Ef){return g(Pe,Ef)}),vi&&Em(Pe,pr),zt}function dr(Pe,Te,Ie,st){if(Ie==null)throw Error(i(151));for(var zt=null,Ur=null,Yt=Te,pr=Te=0,js=null,fi=Ie.next();Yt!==null&&!fi.done;pr++,fi=Ie.next()){Yt.index>pr?(js=Yt,Yt=null):js=Yt.sibling;var Ef=Fe(Pe,Yt,fi.value,st);if(Ef===null){Yt===null&&(Yt=js);break}p&&Yt&&Ef.alternate===null&&g(Pe,Yt),Te=z(Ef,Te,pr),Ur===null?zt=Ef:Ur.sibling=Ef,Ur=Ef,Yt=js}if(fi.done)return b(Pe,Yt),vi&&Em(Pe,pr),zt;if(Yt===null){for(;!fi.done;pr++,fi=Ie.next())fi=at(Pe,fi.value,st),fi!==null&&(Te=z(fi,Te,pr),Ur===null?zt=fi:Ur.sibling=fi,Ur=fi);return vi&&Em(Pe,pr),zt}for(Yt=A(Yt);!fi.done;pr++,fi=Ie.next())fi=Ve(Yt,Pe,pr,fi.value,st),fi!==null&&(p&&fi.alternate!==null&&Yt.delete(fi.key===null?pr:fi.key),Te=z(fi,Te,pr),Ur===null?zt=fi:Ur.sibling=fi,Ur=fi);return p&&Yt.forEach(function(tye){return g(Pe,tye)}),vi&&Em(Pe,pr),zt}function zi(Pe,Te,Ie,st){if(typeof Ie=="object"&&Ie!==null&&Ie.type===v&&Ie.key===null&&(Ie=Ie.props.children),typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case f:e:{for(var zt=Ie.key;Te!==null;){if(Te.key===zt){if(zt=Ie.type,zt===v){if(Te.tag===7){b(Pe,Te.sibling),st=R(Te,Ie.props.children),st.return=Pe,Pe=st;break e}}else if(Te.elementType===zt||typeof zt=="object"&&zt!==null&&zt.$$typeof===E&&f9(zt)===Te.type){b(Pe,Te.sibling),st=R(Te,Ie.props),t1(st,Ie),st.return=Pe,Pe=st;break e}b(Pe,Te);break}else g(Pe,Te);Te=Te.sibling}Ie.type===v?(st=_m(Ie.props.children,Pe.mode,st,Ie.key),st.return=Pe,Pe=st):(st=GS(Ie.type,Ie.key,Ie.props,null,Pe.mode,st),t1(st,Ie),st.return=Pe,Pe=st)}return Q(Pe);case m:e:{for(zt=Ie.key;Te!==null;){if(Te.key===zt)if(Te.tag===4&&Te.stateNode.containerInfo===Ie.containerInfo&&Te.stateNode.implementation===Ie.implementation){b(Pe,Te.sibling),st=R(Te,Ie.children||[]),st.return=Pe,Pe=st;break e}else{b(Pe,Te);break}else g(Pe,Te);Te=Te.sibling}st=DN(Ie,Pe.mode,st),st.return=Pe,Pe=st}return Q(Pe);case E:return zt=Ie._init,Ie=zt(Ie._payload),zi(Pe,Te,Ie,st)}if(q(Ie))return yr(Pe,Te,Ie,st);if(j(Ie)){if(zt=j(Ie),typeof zt!="function")throw Error(i(150));return Ie=zt.call(Ie),dr(Pe,Te,Ie,st)}if(typeof Ie.then=="function")return zi(Pe,Te,oE(Ie),st);if(Ie.$$typeof===S)return zi(Pe,Te,XS(Pe,Ie),st);lE(Pe,Ie)}return typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint"?(Ie=""+Ie,Te!==null&&Te.tag===6?(b(Pe,Te.sibling),st=R(Te,Ie),st.return=Pe,Pe=st):(b(Pe,Te),st=PN(Ie,Pe.mode,st),st.return=Pe,Pe=st),Q(Pe)):b(Pe,Te)}return function(Pe,Te,Ie,st){try{e1=0;var zt=zi(Pe,Te,Ie,st);return K0=null,zt}catch(Yt){if(Yt===Wb||Yt===KS)throw Yt;var Ur=Ho(29,Yt,null,Pe.mode);return Ur.lanes=st,Ur.return=Pe,Ur}finally{}}}var Q0=p9(!0),m9=p9(!1),bl=$(null),au=null;function cf(p){var g=p.alternate;H(vs,vs.current&1),H(bl,p),au===null&&(g===null||q0.current!==null||g.memoizedState!==null)&&(au=p)}function g9(p){if(p.tag===22){if(H(vs,vs.current),H(bl,p),au===null){var g=p.alternate;g!==null&&g.memoizedState!==null&&(au=p)}}else uf()}function uf(){H(vs,vs.current),H(bl,bl.current)}function Dd(p){se(bl),au===p&&(au=null),se(vs)}var vs=$(0);function cE(p){for(var g=p;g!==null;){if(g.tag===13){var b=g.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||Zk(b)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function ck(p,g,b,A){g=p.memoizedState,b=b(A,g),b=b==null?g:u({},g,b),p.memoizedState=b,p.lanes===0&&(p.updateQueue.baseState=b)}var uk={enqueueSetState:function(p,g,b){p=p._reactInternals;var A=Yo(),R=af(A);R.payload=g,b!=null&&(R.callback=b),g=of(p,R,A),g!==null&&(Xo(g,p,A),Yb(g,p,A))},enqueueReplaceState:function(p,g,b){p=p._reactInternals;var A=Yo(),R=af(A);R.tag=1,R.payload=g,b!=null&&(R.callback=b),g=of(p,R,A),g!==null&&(Xo(g,p,A),Yb(g,p,A))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var b=Yo(),A=af(b);A.tag=2,g!=null&&(A.callback=g),g=of(p,A,b),g!==null&&(Xo(g,p,b),Yb(g,p,b))}};function v9(p,g,b,A,R,z,Q){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(A,z,Q):g.prototype&&g.prototype.isPureReactComponent?!Lb(b,A)||!Lb(R,z):!0}function y9(p,g,b,A){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(b,A),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(b,A),g.state!==p&&uk.enqueueReplaceState(g,g.state,null)}function Nm(p,g){var b=g;if("ref"in g){b={};for(var A in g)A!=="ref"&&(b[A]=g[A])}if(p=p.defaultProps){b===g&&(b=u({},b));for(var R in p)b[R]===void 0&&(b[R]=p[R])}return b}var uE=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",p);return}console.error(p)};function x9(p){uE(p)}function b9(p){console.error(p)}function w9(p){uE(p)}function dE(p,g){try{var b=p.onUncaughtError;b(g.value,{componentStack:g.stack})}catch(A){setTimeout(function(){throw A})}}function _9(p,g,b){try{var A=p.onCaughtError;A(b.value,{componentStack:b.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(R){setTimeout(function(){throw R})}}function dk(p,g,b){return b=af(b),b.tag=3,b.payload={element:null},b.callback=function(){dE(p,g)},b}function S9(p){return p=af(p),p.tag=3,p}function E9(p,g,b,A){var R=b.type.getDerivedStateFromError;if(typeof R=="function"){var z=A.value;p.payload=function(){return R(z)},p.callback=function(){_9(g,b,A)}}var Q=b.stateNode;Q!==null&&typeof Q.componentDidCatch=="function"&&(p.callback=function(){_9(g,b,A),typeof R!="function"&&(gf===null?gf=new Set([this]):gf.add(this));var le=A.stack;this.componentDidCatch(A.value,{componentStack:le!==null?le:""})})}function tve(p,g,b,A,R){if(b.flags|=32768,A!==null&&typeof A=="object"&&typeof A.then=="function"){if(g=b.alternate,g!==null&&Ub(g,b,R,!0),b=bl.current,b!==null){switch(b.tag){case 13:return au===null?Ok():b.alternate===null&&Sn===0&&(Sn=3),b.flags&=-257,b.flags|=65536,b.lanes=R,A===FN?b.flags|=16384:(g=b.updateQueue,g===null?b.updateQueue=new Set([A]):g.add(A),Lk(p,A,R)),!1;case 22:return b.flags|=65536,A===FN?b.flags|=16384:(g=b.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([A])},b.updateQueue=g):(b=g.retryQueue,b===null?g.retryQueue=new Set([A]):b.add(A)),Lk(p,A,R)),!1}throw Error(i(435,b.tag))}return Lk(p,A,R),Ok(),!1}if(vi)return g=bl.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=R,A!==RN&&(p=Error(i(422),{cause:A}),Vb(gl(p,b)))):(A!==RN&&(g=Error(i(423),{cause:A}),Vb(gl(g,b))),p=p.current.alternate,p.flags|=65536,R&=-R,p.lanes|=R,A=gl(A,b),R=dk(p.stateNode,A,R),HN(p,R),Sn!==4&&(Sn=2)),!1;var z=Error(i(520),{cause:A});if(z=gl(z,b),l1===null?l1=[z]:l1.push(z),Sn!==4&&(Sn=2),g===null)return!0;A=gl(A,b),b=g;do{switch(b.tag){case 3:return b.flags|=65536,p=R&-R,b.lanes|=p,p=dk(b.stateNode,A,p),HN(b,p),!1;case 1:if(g=b.type,z=b.stateNode,(b.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(gf===null||!gf.has(z))))return b.flags|=65536,R&=-R,b.lanes|=R,R=S9(R),E9(R,p,b,A),HN(b,R),!1}b=b.return}while(b!==null);return!1}var A9=Error(i(461)),Is=!1;function ra(p,g,b,A){g.child=p===null?m9(g,null,b,A):Q0(g,p.child,b,A)}function C9(p,g,b,A,R){b=b.render;var z=g.ref;if("ref"in A){var Q={};for(var le in A)le!=="ref"&&(Q[le]=A[le])}else Q=A;return Mm(g),A=XN(p,g,b,Q,z,R),le=$N(),p!==null&&!Is?(KN(p,g,R),Nd(p,g,R)):(vi&&le&&NN(g),g.flags|=1,ra(p,g,A,R),g.child)}function T9(p,g,b,A,R){if(p===null){var z=b.type;return typeof z=="function"&&!MN(z)&&z.defaultProps===void 0&&b.compare===null?(g.tag=15,g.type=z,M9(p,g,z,A,R)):(p=GS(b.type,null,A,g,g.mode,R),p.ref=g.ref,p.return=g,g.child=p)}if(z=p.child,!xk(p,R)){var Q=z.memoizedProps;if(b=b.compare,b=b!==null?b:Lb,b(Q,A)&&p.ref===g.ref)return Nd(p,g,R)}return g.flags|=1,p=Ed(z,A),p.ref=g.ref,p.return=g,g.child=p}function M9(p,g,b,A,R){if(p!==null){var z=p.memoizedProps;if(Lb(z,A)&&p.ref===g.ref)if(Is=!1,g.pendingProps=A=z,xk(p,R))(p.flags&131072)!==0&&(Is=!0);else return g.lanes=p.lanes,Nd(p,g,R)}return hk(p,g,b,A,R)}function P9(p,g,b){var A=g.pendingProps,R=A.children,z=p!==null?p.memoizedState:null;if(A.mode==="hidden"){if((g.flags&128)!==0){if(A=z!==null?z.baseLanes|b:b,p!==null){for(R=g.child=p.child,z=0;R!==null;)z=z|R.lanes|R.childLanes,R=R.sibling;g.childLanes=z&~A}else g.childLanes=0,g.child=null;return D9(p,g,A,b)}if((b&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},p!==null&&$S(g,z!==null?z.cachePool:null),z!==null?M8(g,z):WN(),g9(g);else return g.lanes=g.childLanes=536870912,D9(p,g,z!==null?z.baseLanes|b:b,b)}else z!==null?($S(g,z.cachePool),M8(g,z),uf(),g.memoizedState=null):(p!==null&&$S(g,null),WN(),uf());return ra(p,g,R,b),g.child}function D9(p,g,b,A){var R=BN();return R=R===null?null:{parent:gs._currentValue,pool:R},g.memoizedState={baseLanes:b,cachePool:R},p!==null&&$S(g,null),WN(),g9(g),p!==null&&Ub(p,g,A,!0),null}function hE(p,g){var b=g.ref;if(b===null)p!==null&&p.ref!==null&&(g.flags|=4194816);else{if(typeof b!="function"&&typeof b!="object")throw Error(i(284));(p===null||p.ref!==b)&&(g.flags|=4194816)}}function hk(p,g,b,A,R){return Mm(g),b=XN(p,g,b,A,void 0,R),A=$N(),p!==null&&!Is?(KN(p,g,R),Nd(p,g,R)):(vi&&A&&NN(g),g.flags|=1,ra(p,g,b,R),g.child)}function N9(p,g,b,A,R,z){return Mm(g),g.updateQueue=null,b=D8(g,A,b,R),P8(p),A=$N(),p!==null&&!Is?(KN(p,g,z),Nd(p,g,z)):(vi&&A&&NN(g),g.flags|=1,ra(p,g,b,z),g.child)}function k9(p,g,b,A,R){if(Mm(g),g.stateNode===null){var z=V0,Q=b.contextType;typeof Q=="object"&&Q!==null&&(z=Aa(Q)),z=new b(A,z),g.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=uk,g.stateNode=z,z._reactInternals=g,z=g.stateNode,z.props=A,z.state=g.memoizedState,z.refs={},VN(g),Q=b.contextType,z.context=typeof Q=="object"&&Q!==null?Aa(Q):V0,z.state=g.memoizedState,Q=b.getDerivedStateFromProps,typeof Q=="function"&&(ck(g,b,Q,A),z.state=g.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(Q=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),Q!==z.state&&uk.enqueueReplaceState(z,z.state,null),$b(g,A,z,R),Xb(),z.state=g.memoizedState),typeof z.componentDidMount=="function"&&(g.flags|=4194308),A=!0}else if(p===null){z=g.stateNode;var le=g.memoizedProps,we=Nm(b,le);z.props=we;var Le=z.context,rt=b.contextType;Q=V0,typeof rt=="object"&&rt!==null&&(Q=Aa(rt));var at=b.getDerivedStateFromProps;rt=typeof at=="function"||typeof z.getSnapshotBeforeUpdate=="function",le=g.pendingProps!==le,rt||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(le||Le!==Q)&&y9(g,z,A,Q),sf=!1;var Fe=g.memoizedState;z.state=Fe,$b(g,A,z,R),Xb(),Le=g.memoizedState,le||Fe!==Le||sf?(typeof at=="function"&&(ck(g,b,at,A),Le=g.memoizedState),(we=sf||v9(g,b,we,A,Fe,Le,Q))?(rt||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(g.flags|=4194308)):(typeof z.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=A,g.memoizedState=Le),z.props=A,z.state=Le,z.context=Q,A=we):(typeof z.componentDidMount=="function"&&(g.flags|=4194308),A=!1)}else{z=g.stateNode,UN(p,g),Q=g.memoizedProps,rt=Nm(b,Q),z.props=rt,at=g.pendingProps,Fe=z.context,Le=b.contextType,we=V0,typeof Le=="object"&&Le!==null&&(we=Aa(Le)),le=b.getDerivedStateFromProps,(Le=typeof le=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(Q!==at||Fe!==we)&&y9(g,z,A,we),sf=!1,Fe=g.memoizedState,z.state=Fe,$b(g,A,z,R),Xb();var Ve=g.memoizedState;Q!==at||Fe!==Ve||sf||p!==null&&p.dependencies!==null&&YS(p.dependencies)?(typeof le=="function"&&(ck(g,b,le,A),Ve=g.memoizedState),(rt=sf||v9(g,b,rt,A,Fe,Ve,we)||p!==null&&p.dependencies!==null&&YS(p.dependencies))?(Le||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(A,Ve,we),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(A,Ve,we)),typeof z.componentDidUpdate=="function"&&(g.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof z.componentDidUpdate!="function"||Q===p.memoizedProps&&Fe===p.memoizedState||(g.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||Q===p.memoizedProps&&Fe===p.memoizedState||(g.flags|=1024),g.memoizedProps=A,g.memoizedState=Ve),z.props=A,z.state=Ve,z.context=we,A=rt):(typeof z.componentDidUpdate!="function"||Q===p.memoizedProps&&Fe===p.memoizedState||(g.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||Q===p.memoizedProps&&Fe===p.memoizedState||(g.flags|=1024),A=!1)}return z=A,hE(p,g),A=(g.flags&128)!==0,z||A?(z=g.stateNode,b=A&&typeof b.getDerivedStateFromError!="function"?null:z.render(),g.flags|=1,p!==null&&A?(g.child=Q0(g,p.child,null,R),g.child=Q0(g,null,b,R)):ra(p,g,b,R),g.memoizedState=z.state,p=g.child):p=Nd(p,g,R),p}function R9(p,g,b,A){return Fb(),g.flags|=256,ra(p,g,b,A),g.child}var fk={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function pk(p){return{baseLanes:p,cachePool:b8()}}function mk(p,g,b){return p=p!==null?p.childLanes&~b:0,g&&(p|=wl),p}function I9(p,g,b){var A=g.pendingProps,R=!1,z=(g.flags&128)!==0,Q;if((Q=z)||(Q=p!==null&&p.memoizedState===null?!1:(vs.current&2)!==0),Q&&(R=!0,g.flags&=-129),Q=(g.flags&32)!==0,g.flags&=-33,p===null){if(vi){if(R?cf(g):uf(),vi){var le=_n,we;if(we=le){e:{for(we=le,le=su;we.nodeType!==8;){if(!le){le=null;break e}if(we=ic(we.nextSibling),we===null){le=null;break e}}le=we}le!==null?(g.memoizedState={dehydrated:le,treeContext:Sm!==null?{id:Ad,overflow:Cd}:null,retryLane:536870912,hydrationErrors:null},we=Ho(18,null,null,0),we.stateNode=le,we.return=g,g.child=we,Ya=g,_n=null,we=!0):we=!1}we||Cm(g)}if(le=g.memoizedState,le!==null&&(le=le.dehydrated,le!==null))return Zk(le)?g.lanes=32:g.lanes=536870912,null;Dd(g)}return le=A.children,A=A.fallback,R?(uf(),R=g.mode,le=fE({mode:"hidden",children:le},R),A=_m(A,R,b,null),le.return=g,A.return=g,le.sibling=A,g.child=le,R=g.child,R.memoizedState=pk(b),R.childLanes=mk(p,Q,b),g.memoizedState=fk,A):(cf(g),gk(g,le))}if(we=p.memoizedState,we!==null&&(le=we.dehydrated,le!==null)){if(z)g.flags&256?(cf(g),g.flags&=-257,g=vk(p,g,b)):g.memoizedState!==null?(uf(),g.child=p.child,g.flags|=128,g=null):(uf(),R=A.fallback,le=g.mode,A=fE({mode:"visible",children:A.children},le),R=_m(R,le,b,null),R.flags|=2,A.return=g,R.return=g,A.sibling=R,g.child=A,Q0(g,p.child,null,b),A=g.child,A.memoizedState=pk(b),A.childLanes=mk(p,Q,b),g.memoizedState=fk,g=R);else if(cf(g),Zk(le)){if(Q=le.nextSibling&&le.nextSibling.dataset,Q)var Le=Q.dgst;Q=Le,A=Error(i(419)),A.stack="",A.digest=Q,Vb({value:A,source:null,stack:null}),g=vk(p,g,b)}else if(Is||Ub(p,g,b,!1),Q=(b&p.childLanes)!==0,Is||Q){if(Q=Ki,Q!==null&&(A=b&-b,A=(A&42)!==0?1:Hi(A),A=(A&(Q.suspendedLanes|b))!==0?0:A,A!==0&&A!==we.retryLane))throw we.retryLane=A,F0(p,A),Xo(Q,p,A),A9;le.data==="$?"||Ok(),g=vk(p,g,b)}else le.data==="$?"?(g.flags|=192,g.child=p.child,g=null):(p=we.treeContext,_n=ic(le.nextSibling),Ya=g,vi=!0,Am=null,su=!1,p!==null&&(yl[xl++]=Ad,yl[xl++]=Cd,yl[xl++]=Sm,Ad=p.id,Cd=p.overflow,Sm=g),g=gk(g,A.children),g.flags|=4096);return g}return R?(uf(),R=A.fallback,le=g.mode,we=p.child,Le=we.sibling,A=Ed(we,{mode:"hidden",children:A.children}),A.subtreeFlags=we.subtreeFlags&65011712,Le!==null?R=Ed(Le,R):(R=_m(R,le,b,null),R.flags|=2),R.return=g,A.return=g,A.sibling=R,g.child=A,A=R,R=g.child,le=p.child.memoizedState,le===null?le=pk(b):(we=le.cachePool,we!==null?(Le=gs._currentValue,we=we.parent!==Le?{parent:Le,pool:Le}:we):we=b8(),le={baseLanes:le.baseLanes|b,cachePool:we}),R.memoizedState=le,R.childLanes=mk(p,Q,b),g.memoizedState=fk,A):(cf(g),b=p.child,p=b.sibling,b=Ed(b,{mode:"visible",children:A.children}),b.return=g,b.sibling=null,p!==null&&(Q=g.deletions,Q===null?(g.deletions=[p],g.flags|=16):Q.push(p)),g.child=b,g.memoizedState=null,b)}function gk(p,g){return g=fE({mode:"visible",children:g},p.mode),g.return=p,p.child=g}function fE(p,g){return p=Ho(22,p,null,g),p.lanes=0,p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},p}function vk(p,g,b){return Q0(g,p.child,null,b),p=gk(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function O9(p,g,b){p.lanes|=g;var A=p.alternate;A!==null&&(A.lanes|=g),ON(p.return,g,b)}function yk(p,g,b,A,R){var z=p.memoizedState;z===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:A,tail:b,tailMode:R}:(z.isBackwards=g,z.rendering=null,z.renderingStartTime=0,z.last=A,z.tail=b,z.tailMode=R)}function j9(p,g,b){var A=g.pendingProps,R=A.revealOrder,z=A.tail;if(ra(p,g,A.children,b),A=vs.current,(A&2)!==0)A=A&1|2,g.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&O9(p,b,g);else if(p.tag===19)O9(p,b,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}A&=1}switch(H(vs,A),R){case"forwards":for(b=g.child,R=null;b!==null;)p=b.alternate,p!==null&&cE(p)===null&&(R=b),b=b.sibling;b=R,b===null?(R=g.child,g.child=null):(R=b.sibling,b.sibling=null),yk(g,!1,R,b,z);break;case"backwards":for(b=null,R=g.child,g.child=null;R!==null;){if(p=R.alternate,p!==null&&cE(p)===null){g.child=R;break}p=R.sibling,R.sibling=b,b=R,R=p}yk(g,!0,b,null,z);break;case"together":yk(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Nd(p,g,b){if(p!==null&&(g.dependencies=p.dependencies),mf|=g.lanes,(b&g.childLanes)===0)if(p!==null){if(Ub(p,g,b,!1),(b&g.childLanes)===0)return null}else return null;if(p!==null&&g.child!==p.child)throw Error(i(153));if(g.child!==null){for(p=g.child,b=Ed(p,p.pendingProps),g.child=b,b.return=g;p.sibling!==null;)p=p.sibling,b=b.sibling=Ed(p,p.pendingProps),b.return=g;b.sibling=null}return g.child}function xk(p,g){return(p.lanes&g)!==0?!0:(p=p.dependencies,!!(p!==null&&YS(p)))}function rve(p,g,b){switch(g.tag){case 3:Z(g,g.stateNode.containerInfo),nf(g,gs,p.memoizedState.cache),Fb();break;case 27:case 5:he(g);break;case 4:Z(g,g.stateNode.containerInfo);break;case 10:nf(g,g.type,g.memoizedProps.value);break;case 13:var A=g.memoizedState;if(A!==null)return A.dehydrated!==null?(cf(g),g.flags|=128,null):(b&g.child.childLanes)!==0?I9(p,g,b):(cf(g),p=Nd(p,g,b),p!==null?p.sibling:null);cf(g);break;case 19:var R=(p.flags&128)!==0;if(A=(b&g.childLanes)!==0,A||(Ub(p,g,b,!1),A=(b&g.childLanes)!==0),R){if(A)return j9(p,g,b);g.flags|=128}if(R=g.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),H(vs,vs.current),A)break;return null;case 22:case 23:return g.lanes=0,P9(p,g,b);case 24:nf(g,gs,p.memoizedState.cache)}return Nd(p,g,b)}function L9(p,g,b){if(p!==null)if(p.memoizedProps!==g.pendingProps)Is=!0;else{if(!xk(p,b)&&(g.flags&128)===0)return Is=!1,rve(p,g,b);Is=(p.flags&131072)!==0}else Is=!1,vi&&(g.flags&1048576)!==0&&f8(g,qS,g.index);switch(g.lanes=0,g.tag){case 16:e:{p=g.pendingProps;var A=g.elementType,R=A._init;if(A=R(A._payload),g.type=A,typeof A=="function")MN(A)?(p=Nm(A,p),g.tag=1,g=k9(null,g,A,p,b)):(g.tag=0,g=hk(null,g,A,p,b));else{if(A!=null){if(R=A.$$typeof,R===P){g.tag=11,g=C9(null,g,A,p,b);break e}else if(R===T){g.tag=14,g=T9(null,g,A,p,b);break e}}throw g=B(A)||A,Error(i(306,g,""))}}return g;case 0:return hk(p,g,g.type,g.pendingProps,b);case 1:return A=g.type,R=Nm(A,g.pendingProps),k9(p,g,A,R,b);case 3:e:{if(Z(g,g.stateNode.containerInfo),p===null)throw Error(i(387));A=g.pendingProps;var z=g.memoizedState;R=z.element,UN(p,g),$b(g,A,null,b);var Q=g.memoizedState;if(A=Q.cache,nf(g,gs,A),A!==z.cache&&jN(g,[gs],b,!0),Xb(),A=Q.element,z.isDehydrated)if(z={element:A,isDehydrated:!1,cache:Q.cache},g.updateQueue.baseState=z,g.memoizedState=z,g.flags&256){g=R9(p,g,A,b);break e}else if(A!==R){R=gl(Error(i(424)),g),Vb(R),g=R9(p,g,A,b);break e}else{switch(p=g.stateNode.containerInfo,p.nodeType){case 9:p=p.body;break;default:p=p.nodeName==="HTML"?p.ownerDocument.body:p}for(_n=ic(p.firstChild),Ya=g,vi=!0,Am=null,su=!0,b=m9(g,null,A,b),g.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling}else{if(Fb(),A===R){g=Nd(p,g,b);break e}ra(p,g,A,b)}g=g.child}return g;case 26:return hE(p,g),p===null?(b=V7(g.type,null,g.pendingProps,null))?g.memoizedState=b:vi||(b=g.type,p=g.pendingProps,A=TE(ie.current).createElement(b),A[$i]=g,A[ln]=p,na(A,b,p),er(A),g.stateNode=A):g.memoizedState=V7(g.type,p.memoizedProps,g.pendingProps,p.memoizedState),null;case 27:return he(g),p===null&&vi&&(A=g.stateNode=z7(g.type,g.pendingProps,ie.current),Ya=g,su=!0,R=_n,xf(g.type)?(Jk=R,_n=ic(A.firstChild)):_n=R),ra(p,g,g.pendingProps.children,b),hE(p,g),p===null&&(g.flags|=4194304),g.child;case 5:return p===null&&vi&&((R=A=_n)&&(A=Dve(A,g.type,g.pendingProps,su),A!==null?(g.stateNode=A,Ya=g,_n=ic(A.firstChild),su=!1,R=!0):R=!1),R||Cm(g)),he(g),R=g.type,z=g.pendingProps,Q=p!==null?p.memoizedProps:null,A=z.children,$k(R,z)?A=null:Q!==null&&$k(R,Q)&&(g.flags|=32),g.memoizedState!==null&&(R=XN(p,g,X0e,null,null,b),v1._currentValue=R),hE(p,g),ra(p,g,A,b),g.child;case 6:return p===null&&vi&&((p=b=_n)&&(b=Nve(b,g.pendingProps,su),b!==null?(g.stateNode=b,Ya=g,_n=null,p=!0):p=!1),p||Cm(g)),null;case 13:return I9(p,g,b);case 4:return Z(g,g.stateNode.containerInfo),A=g.pendingProps,p===null?g.child=Q0(g,null,A,b):ra(p,g,A,b),g.child;case 11:return C9(p,g,g.type,g.pendingProps,b);case 7:return ra(p,g,g.pendingProps,b),g.child;case 8:return ra(p,g,g.pendingProps.children,b),g.child;case 12:return ra(p,g,g.pendingProps.children,b),g.child;case 10:return A=g.pendingProps,nf(g,g.type,A.value),ra(p,g,A.children,b),g.child;case 9:return R=g.type._context,A=g.pendingProps.children,Mm(g),R=Aa(R),A=A(R),g.flags|=1,ra(p,g,A,b),g.child;case 14:return T9(p,g,g.type,g.pendingProps,b);case 15:return M9(p,g,g.type,g.pendingProps,b);case 19:return j9(p,g,b);case 31:return A=g.pendingProps,b=g.mode,A={mode:A.mode,children:A.children},p===null?(b=fE(A,b),b.ref=g.ref,g.child=b,b.return=g,g=b):(b=Ed(p.child,A),b.ref=g.ref,g.child=b,b.return=g,g=b),g;case 22:return P9(p,g,b);case 24:return Mm(g),A=Aa(gs),p===null?(R=BN(),R===null&&(R=Ki,z=LN(),R.pooledCache=z,z.refCount++,z!==null&&(R.pooledCacheLanes|=b),R=z),g.memoizedState={parent:A,cache:R},VN(g),nf(g,gs,R)):((p.lanes&b)!==0&&(UN(p,g),$b(g,null,null,b),Xb()),R=p.memoizedState,z=g.memoizedState,R.parent!==A?(R={parent:A,cache:A},g.memoizedState=R,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=R),nf(g,gs,A)):(A=z.cache,nf(g,gs,A),A!==R.cache&&jN(g,[gs],b,!0))),ra(p,g,g.pendingProps.children,b),g.child;case 29:throw g.pendingProps}throw Error(i(156,g.tag))}function kd(p){p.flags|=4}function z9(p,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!q7(g)){if(g=bl.current,g!==null&&((si&4194048)===si?au!==null:(si&62914560)!==si&&(si&536870912)===0||g!==au))throw qb=FN,w8;p.flags|=8192}}function pE(p,g){g!==null&&(p.flags|=4),p.flags&16384&&(g=p.tag!==22?He():536870912,p.lanes|=g,tv|=g)}function r1(p,g){if(!vi)switch(p.tailMode){case"hidden":g=p.tail;for(var b=null;g!==null;)g.alternate!==null&&(b=g),g=g.sibling;b===null?p.tail=null:b.sibling=null;break;case"collapsed":b=p.tail;for(var A=null;b!==null;)b.alternate!==null&&(A=b),b=b.sibling;A===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:A.sibling=null}}function pn(p){var g=p.alternate!==null&&p.alternate.child===p.child,b=0,A=0;if(g)for(var R=p.child;R!==null;)b|=R.lanes|R.childLanes,A|=R.subtreeFlags&65011712,A|=R.flags&65011712,R.return=p,R=R.sibling;else for(R=p.child;R!==null;)b|=R.lanes|R.childLanes,A|=R.subtreeFlags,A|=R.flags,R.return=p,R=R.sibling;return p.subtreeFlags|=A,p.childLanes=b,g}function ive(p,g,b){var A=g.pendingProps;switch(kN(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pn(g),null;case 1:return pn(g),null;case 3:return b=g.stateNode,A=null,p!==null&&(A=p.memoizedState.cache),g.memoizedState.cache!==A&&(g.flags|=2048),Md(gs),fe(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(p===null||p.child===null)&&(Bb(g)?kd(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,g8())),pn(g),null;case 26:return b=g.memoizedState,p===null?(kd(g),b!==null?(pn(g),z9(g,b)):(pn(g),g.flags&=-16777217)):b?b!==p.memoizedState?(kd(g),pn(g),z9(g,b)):(pn(g),g.flags&=-16777217):(p.memoizedProps!==A&&kd(g),pn(g),g.flags&=-16777217),null;case 27:Ae(g),b=ie.current;var R=g.type;if(p!==null&&g.stateNode!=null)p.memoizedProps!==A&&kd(g);else{if(!A){if(g.stateNode===null)throw Error(i(166));return pn(g),null}p=ne.current,Bb(g)?p8(g):(p=z7(R,A,b),g.stateNode=p,kd(g))}return pn(g),null;case 5:if(Ae(g),b=g.type,p!==null&&g.stateNode!=null)p.memoizedProps!==A&&kd(g);else{if(!A){if(g.stateNode===null)throw Error(i(166));return pn(g),null}if(p=ne.current,Bb(g))p8(g);else{switch(R=TE(ie.current),p){case 1:p=R.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:p=R.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":p=R.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":p=R.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":p=R.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof A.is=="string"?R.createElement("select",{is:A.is}):R.createElement("select"),A.multiple?p.multiple=!0:A.size&&(p.size=A.size);break;default:p=typeof A.is=="string"?R.createElement(b,{is:A.is}):R.createElement(b)}}p[$i]=g,p[ln]=A;e:for(R=g.child;R!==null;){if(R.tag===5||R.tag===6)p.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===g)break e;for(;R.sibling===null;){if(R.return===null||R.return===g)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}g.stateNode=p;e:switch(na(p,b,A),b){case"button":case"input":case"select":case"textarea":p=!!A.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&kd(g)}}return pn(g),g.flags&=-16777217,null;case 6:if(p&&g.stateNode!=null)p.memoizedProps!==A&&kd(g);else{if(typeof A!="string"&&g.stateNode===null)throw Error(i(166));if(p=ie.current,Bb(g)){if(p=g.stateNode,b=g.memoizedProps,A=null,R=Ya,R!==null)switch(R.tag){case 27:case 5:A=R.memoizedProps}p[$i]=g,p=!!(p.nodeValue===b||A!==null&&A.suppressHydrationWarning===!0||N7(p.nodeValue,b)),p||Cm(g)}else p=TE(p).createTextNode(A),p[$i]=g,g.stateNode=p}return pn(g),null;case 13:if(A=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(R=Bb(g),A!==null&&A.dehydrated!==null){if(p===null){if(!R)throw Error(i(318));if(R=g.memoizedState,R=R!==null?R.dehydrated:null,!R)throw Error(i(317));R[$i]=g}else Fb(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;pn(g),R=!1}else R=g8(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=R),R=!0;if(!R)return g.flags&256?(Dd(g),g):(Dd(g),null)}if(Dd(g),(g.flags&128)!==0)return g.lanes=b,g;if(b=A!==null,p=p!==null&&p.memoizedState!==null,b){A=g.child,R=null,A.alternate!==null&&A.alternate.memoizedState!==null&&A.alternate.memoizedState.cachePool!==null&&(R=A.alternate.memoizedState.cachePool.pool);var z=null;A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(z=A.memoizedState.cachePool.pool),z!==R&&(A.flags|=2048)}return b!==p&&b&&(g.child.flags|=8192),pE(g,g.updateQueue),pn(g),null;case 4:return fe(),p===null&&Gk(g.stateNode.containerInfo),pn(g),null;case 10:return Md(g.type),pn(g),null;case 19:if(se(vs),R=g.memoizedState,R===null)return pn(g),null;if(A=(g.flags&128)!==0,z=R.rendering,z===null)if(A)r1(R,!1);else{if(Sn!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(z=cE(p),z!==null){for(g.flags|=128,r1(R,!1),p=z.updateQueue,g.updateQueue=p,pE(g,p),g.subtreeFlags=0,p=b,b=g.child;b!==null;)h8(b,p),b=b.sibling;return H(vs,vs.current&1|2),g.child}p=p.sibling}R.tail!==null&&dt()>vE&&(g.flags|=128,A=!0,r1(R,!1),g.lanes=4194304)}else{if(!A)if(p=cE(z),p!==null){if(g.flags|=128,A=!0,p=p.updateQueue,g.updateQueue=p,pE(g,p),r1(R,!0),R.tail===null&&R.tailMode==="hidden"&&!z.alternate&&!vi)return pn(g),null}else 2*dt()-R.renderingStartTime>vE&&b!==536870912&&(g.flags|=128,A=!0,r1(R,!1),g.lanes=4194304);R.isBackwards?(z.sibling=g.child,g.child=z):(p=R.last,p!==null?p.sibling=z:g.child=z,R.last=z)}return R.tail!==null?(g=R.tail,R.rendering=g,R.tail=g.sibling,R.renderingStartTime=dt(),g.sibling=null,p=vs.current,H(vs,A?p&1|2:p&1),g):(pn(g),null);case 22:case 23:return Dd(g),qN(),A=g.memoizedState!==null,p!==null?p.memoizedState!==null!==A&&(g.flags|=8192):A&&(g.flags|=8192),A?(b&536870912)!==0&&(g.flags&128)===0&&(pn(g),g.subtreeFlags&6&&(g.flags|=8192)):pn(g),b=g.updateQueue,b!==null&&pE(g,b.retryQueue),b=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(b=p.memoizedState.cachePool.pool),A=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(A=g.memoizedState.cachePool.pool),A!==b&&(g.flags|=2048),p!==null&&se(Pm),null;case 24:return b=null,p!==null&&(b=p.memoizedState.cache),g.memoizedState.cache!==b&&(g.flags|=2048),Md(gs),pn(g),null;case 25:return null;case 30:return null}throw Error(i(156,g.tag))}function nve(p,g){switch(kN(g),g.tag){case 1:return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return Md(gs),fe(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 26:case 27:case 5:return Ae(g),null;case 13:if(Dd(g),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(i(340));Fb()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return se(vs),null;case 4:return fe(),null;case 10:return Md(g.type),null;case 22:case 23:return Dd(g),qN(),p!==null&&se(Pm),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 24:return Md(gs),null;case 25:return null;default:return null}}function B9(p,g){switch(kN(g),g.tag){case 3:Md(gs),fe();break;case 26:case 27:case 5:Ae(g);break;case 4:fe();break;case 13:Dd(g);break;case 19:se(vs);break;case 10:Md(g.type);break;case 22:case 23:Dd(g),qN(),p!==null&&se(Pm);break;case 24:Md(gs)}}function i1(p,g){try{var b=g.updateQueue,A=b!==null?b.lastEffect:null;if(A!==null){var R=A.next;b=R;do{if((b.tag&p)===p){A=void 0;var z=b.create,Q=b.inst;A=z(),Q.destroy=A}b=b.next}while(b!==R)}}catch(le){Wi(g,g.return,le)}}function df(p,g,b){try{var A=g.updateQueue,R=A!==null?A.lastEffect:null;if(R!==null){var z=R.next;A=z;do{if((A.tag&p)===p){var Q=A.inst,le=Q.destroy;if(le!==void 0){Q.destroy=void 0,R=g;var we=b,Le=le;try{Le()}catch(rt){Wi(R,we,rt)}}}A=A.next}while(A!==z)}}catch(rt){Wi(g,g.return,rt)}}function F9(p){var g=p.updateQueue;if(g!==null){var b=p.stateNode;try{T8(g,b)}catch(A){Wi(p,p.return,A)}}}function V9(p,g,b){b.props=Nm(p.type,p.memoizedProps),b.state=p.memoizedState;try{b.componentWillUnmount()}catch(A){Wi(p,g,A)}}function n1(p,g){try{var b=p.ref;if(b!==null){switch(p.tag){case 26:case 27:case 5:var A=p.stateNode;break;case 30:A=p.stateNode;break;default:A=p.stateNode}typeof b=="function"?p.refCleanup=b(A):b.current=A}}catch(R){Wi(p,g,R)}}function ou(p,g){var b=p.ref,A=p.refCleanup;if(b!==null)if(typeof A=="function")try{A()}catch(R){Wi(p,g,R)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof b=="function")try{b(null)}catch(R){Wi(p,g,R)}else b.current=null}function U9(p){var g=p.type,b=p.memoizedProps,A=p.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":b.autoFocus&&A.focus();break e;case"img":b.src?A.src=b.src:b.srcSet&&(A.srcset=b.srcSet)}}catch(R){Wi(p,p.return,R)}}function bk(p,g,b){try{var A=p.stateNode;Ave(A,p.type,b,g),A[ln]=g}catch(R){Wi(p,p.return,R)}}function H9(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&xf(p.type)||p.tag===4}function wk(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||H9(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&xf(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function _k(p,g,b){var A=p.tag;if(A===5||A===6)p=p.stateNode,g?(b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b).insertBefore(p,g):(g=b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b,g.appendChild(p),b=b._reactRootContainer,b!=null||g.onclick!==null||(g.onclick=CE));else if(A!==4&&(A===27&&xf(p.type)&&(b=p.stateNode,g=null),p=p.child,p!==null))for(_k(p,g,b),p=p.sibling;p!==null;)_k(p,g,b),p=p.sibling}function mE(p,g,b){var A=p.tag;if(A===5||A===6)p=p.stateNode,g?b.insertBefore(p,g):b.appendChild(p);else if(A!==4&&(A===27&&xf(p.type)&&(b=p.stateNode),p=p.child,p!==null))for(mE(p,g,b),p=p.sibling;p!==null;)mE(p,g,b),p=p.sibling}function G9(p){var g=p.stateNode,b=p.memoizedProps;try{for(var A=p.type,R=g.attributes;R.length;)g.removeAttributeNode(R[0]);na(g,A,b),g[$i]=p,g[ln]=b}catch(z){Wi(p,p.return,z)}}var Rd=!1,Rn=!1,Sk=!1,W9=typeof WeakSet=="function"?WeakSet:Set,Os=null;function sve(p,g){if(p=p.containerInfo,Yk=RE,p=r8(p),wN(p)){if("selectionStart"in p)var b={start:p.selectionStart,end:p.selectionEnd};else e:{b=(b=p.ownerDocument)&&b.defaultView||window;var A=b.getSelection&&b.getSelection();if(A&&A.rangeCount!==0){b=A.anchorNode;var R=A.anchorOffset,z=A.focusNode;A=A.focusOffset;try{b.nodeType,z.nodeType}catch{b=null;break e}var Q=0,le=-1,we=-1,Le=0,rt=0,at=p,Fe=null;t:for(;;){for(var Ve;at!==b||R!==0&&at.nodeType!==3||(le=Q+R),at!==z||A!==0&&at.nodeType!==3||(we=Q+A),at.nodeType===3&&(Q+=at.nodeValue.length),(Ve=at.firstChild)!==null;)Fe=at,at=Ve;for(;;){if(at===p)break t;if(Fe===b&&++Le===R&&(le=Q),Fe===z&&++rt===A&&(we=Q),(Ve=at.nextSibling)!==null)break;at=Fe,Fe=at.parentNode}at=Ve}b=le===-1||we===-1?null:{start:le,end:we}}else b=null}b=b||{start:0,end:0}}else b=null;for(Xk={focusedElem:p,selectionRange:b},RE=!1,Os=g;Os!==null;)if(g=Os,p=g.child,(g.subtreeFlags&1024)!==0&&p!==null)p.return=g,Os=p;else for(;Os!==null;){switch(g=Os,z=g.alternate,p=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((p&1024)!==0&&z!==null){p=void 0,b=g,R=z.memoizedProps,z=z.memoizedState,A=b.stateNode;try{var yr=Nm(b.type,R,b.elementType===b.type);p=A.getSnapshotBeforeUpdate(yr,z),A.__reactInternalSnapshotBeforeUpdate=p}catch(dr){Wi(b,b.return,dr)}}break;case 3:if((p&1024)!==0){if(p=g.stateNode.containerInfo,b=p.nodeType,b===9)Qk(p);else if(b===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":Qk(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(i(163))}if(p=g.sibling,p!==null){p.return=g.return,Os=p;break}Os=g.return}}function q9(p,g,b){var A=b.flags;switch(b.tag){case 0:case 11:case 15:hf(p,b),A&4&&i1(5,b);break;case 1:if(hf(p,b),A&4)if(p=b.stateNode,g===null)try{p.componentDidMount()}catch(Q){Wi(b,b.return,Q)}else{var R=Nm(b.type,g.memoizedProps);g=g.memoizedState;try{p.componentDidUpdate(R,g,p.__reactInternalSnapshotBeforeUpdate)}catch(Q){Wi(b,b.return,Q)}}A&64&&F9(b),A&512&&n1(b,b.return);break;case 3:if(hf(p,b),A&64&&(p=b.updateQueue,p!==null)){if(g=null,b.child!==null)switch(b.child.tag){case 27:case 5:g=b.child.stateNode;break;case 1:g=b.child.stateNode}try{T8(p,g)}catch(Q){Wi(b,b.return,Q)}}break;case 27:g===null&&A&4&&G9(b);case 26:case 5:hf(p,b),g===null&&A&4&&U9(b),A&512&&n1(b,b.return);break;case 12:hf(p,b);break;case 13:hf(p,b),A&4&&$9(p,b),A&64&&(p=b.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(b=pve.bind(null,b),kve(p,b))));break;case 22:if(A=b.memoizedState!==null||Rd,!A){g=g!==null&&g.memoizedState!==null||Rn,R=Rd;var z=Rn;Rd=A,(Rn=g)&&!z?ff(p,b,(b.subtreeFlags&8772)!==0):hf(p,b),Rd=R,Rn=z}break;case 30:break;default:hf(p,b)}}function Y9(p){var g=p.alternate;g!==null&&(p.alternate=null,Y9(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&Qe(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var un=null,vo=!1;function Id(p,g,b){for(b=b.child;b!==null;)X9(p,g,b),b=b.sibling}function X9(p,g,b){if(Se&&typeof Se.onCommitFiberUnmount=="function")try{Se.onCommitFiberUnmount(W,b)}catch{}switch(b.tag){case 26:Rn||ou(b,g),Id(p,g,b),b.memoizedState?b.memoizedState.count--:b.stateNode&&(b=b.stateNode,b.parentNode.removeChild(b));break;case 27:Rn||ou(b,g);var A=un,R=vo;xf(b.type)&&(un=b.stateNode,vo=!1),Id(p,g,b),f1(b.stateNode),un=A,vo=R;break;case 5:Rn||ou(b,g);case 6:if(A=un,R=vo,un=null,Id(p,g,b),un=A,vo=R,un!==null)if(vo)try{(un.nodeType===9?un.body:un.nodeName==="HTML"?un.ownerDocument.body:un).removeChild(b.stateNode)}catch(z){Wi(b,g,z)}else try{un.removeChild(b.stateNode)}catch(z){Wi(b,g,z)}break;case 18:un!==null&&(vo?(p=un,j7(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,b.stateNode),w1(p)):j7(un,b.stateNode));break;case 4:A=un,R=vo,un=b.stateNode.containerInfo,vo=!0,Id(p,g,b),un=A,vo=R;break;case 0:case 11:case 14:case 15:Rn||df(2,b,g),Rn||df(4,b,g),Id(p,g,b);break;case 1:Rn||(ou(b,g),A=b.stateNode,typeof A.componentWillUnmount=="function"&&V9(b,g,A)),Id(p,g,b);break;case 21:Id(p,g,b);break;case 22:Rn=(A=Rn)||b.memoizedState!==null,Id(p,g,b),Rn=A;break;default:Id(p,g,b)}}function $9(p,g){if(g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{w1(p)}catch(b){Wi(g,g.return,b)}}function ave(p){switch(p.tag){case 13:case 19:var g=p.stateNode;return g===null&&(g=p.stateNode=new W9),g;case 22:return p=p.stateNode,g=p._retryCache,g===null&&(g=p._retryCache=new W9),g;default:throw Error(i(435,p.tag))}}function Ek(p,g){var b=ave(p);g.forEach(function(A){var R=mve.bind(null,p,A);b.has(A)||(b.add(A),A.then(R,R))})}function Go(p,g){var b=g.deletions;if(b!==null)for(var A=0;A<b.length;A++){var R=b[A],z=p,Q=g,le=Q;e:for(;le!==null;){switch(le.tag){case 27:if(xf(le.type)){un=le.stateNode,vo=!1;break e}break;case 5:un=le.stateNode,vo=!1;break e;case 3:case 4:un=le.stateNode.containerInfo,vo=!0;break e}le=le.return}if(un===null)throw Error(i(160));X9(z,Q,R),un=null,vo=!1,z=R.alternate,z!==null&&(z.return=null),R.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)K9(g,p),g=g.sibling}var rc=null;function K9(p,g){var b=p.alternate,A=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:Go(g,p),Wo(p),A&4&&(df(3,p,p.return),i1(3,p),df(5,p,p.return));break;case 1:Go(g,p),Wo(p),A&512&&(Rn||b===null||ou(b,b.return)),A&64&&Rd&&(p=p.updateQueue,p!==null&&(A=p.callbacks,A!==null&&(b=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=b===null?A:b.concat(A))));break;case 26:var R=rc;if(Go(g,p),Wo(p),A&512&&(Rn||b===null||ou(b,b.return)),A&4){var z=b!==null?b.memoizedState:null;if(A=p.memoizedState,b===null)if(A===null)if(p.stateNode===null){e:{A=p.type,b=p.memoizedProps,R=R.ownerDocument||R;t:switch(A){case"title":z=R.getElementsByTagName("title")[0],(!z||z[ke]||z[$i]||z.namespaceURI==="http://www.w3.org/2000/svg"||z.hasAttribute("itemprop"))&&(z=R.createElement(A),R.head.insertBefore(z,R.querySelector("head > title"))),na(z,A,b),z[$i]=p,er(z),A=z;break e;case"link":var Q=G7("link","href",R).get(A+(b.href||""));if(Q){for(var le=0;le<Q.length;le++)if(z=Q[le],z.getAttribute("href")===(b.href==null||b.href===""?null:b.href)&&z.getAttribute("rel")===(b.rel==null?null:b.rel)&&z.getAttribute("title")===(b.title==null?null:b.title)&&z.getAttribute("crossorigin")===(b.crossOrigin==null?null:b.crossOrigin)){Q.splice(le,1);break t}}z=R.createElement(A),na(z,A,b),R.head.appendChild(z);break;case"meta":if(Q=G7("meta","content",R).get(A+(b.content||""))){for(le=0;le<Q.length;le++)if(z=Q[le],z.getAttribute("content")===(b.content==null?null:""+b.content)&&z.getAttribute("name")===(b.name==null?null:b.name)&&z.getAttribute("property")===(b.property==null?null:b.property)&&z.getAttribute("http-equiv")===(b.httpEquiv==null?null:b.httpEquiv)&&z.getAttribute("charset")===(b.charSet==null?null:b.charSet)){Q.splice(le,1);break t}}z=R.createElement(A),na(z,A,b),R.head.appendChild(z);break;default:throw Error(i(468,A))}z[$i]=p,er(z),A=z}p.stateNode=A}else W7(R,p.type,p.stateNode);else p.stateNode=H7(R,A,p.memoizedProps);else z!==A?(z===null?b.stateNode!==null&&(b=b.stateNode,b.parentNode.removeChild(b)):z.count--,A===null?W7(R,p.type,p.stateNode):H7(R,A,p.memoizedProps)):A===null&&p.stateNode!==null&&bk(p,p.memoizedProps,b.memoizedProps)}break;case 27:Go(g,p),Wo(p),A&512&&(Rn||b===null||ou(b,b.return)),b!==null&&A&4&&bk(p,p.memoizedProps,b.memoizedProps);break;case 5:if(Go(g,p),Wo(p),A&512&&(Rn||b===null||ou(b,b.return)),p.flags&32){R=p.stateNode;try{hl(R,"")}catch(Ve){Wi(p,p.return,Ve)}}A&4&&p.stateNode!=null&&(R=p.memoizedProps,bk(p,R,b!==null?b.memoizedProps:R)),A&1024&&(Sk=!0);break;case 6:if(Go(g,p),Wo(p),A&4){if(p.stateNode===null)throw Error(i(162));A=p.memoizedProps,b=p.stateNode;try{b.nodeValue=A}catch(Ve){Wi(p,p.return,Ve)}}break;case 3:if(DE=null,R=rc,rc=ME(g.containerInfo),Go(g,p),rc=R,Wo(p),A&4&&b!==null&&b.memoizedState.isDehydrated)try{w1(g.containerInfo)}catch(Ve){Wi(p,p.return,Ve)}Sk&&(Sk=!1,Q9(p));break;case 4:A=rc,rc=ME(p.stateNode.containerInfo),Go(g,p),Wo(p),rc=A;break;case 12:Go(g,p),Wo(p);break;case 13:Go(g,p),Wo(p),p.child.flags&8192&&p.memoizedState!==null!=(b!==null&&b.memoizedState!==null)&&(Dk=dt()),A&4&&(A=p.updateQueue,A!==null&&(p.updateQueue=null,Ek(p,A)));break;case 22:R=p.memoizedState!==null;var we=b!==null&&b.memoizedState!==null,Le=Rd,rt=Rn;if(Rd=Le||R,Rn=rt||we,Go(g,p),Rn=rt,Rd=Le,Wo(p),A&8192)e:for(g=p.stateNode,g._visibility=R?g._visibility&-2:g._visibility|1,R&&(b===null||we||Rd||Rn||km(p)),b=null,g=p;;){if(g.tag===5||g.tag===26){if(b===null){we=b=g;try{if(z=we.stateNode,R)Q=z.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none";else{le=we.stateNode;var at=we.memoizedProps.style,Fe=at!=null&&at.hasOwnProperty("display")?at.display:null;le.style.display=Fe==null||typeof Fe=="boolean"?"":(""+Fe).trim()}}catch(Ve){Wi(we,we.return,Ve)}}}else if(g.tag===6){if(b===null){we=g;try{we.stateNode.nodeValue=R?"":we.memoizedProps}catch(Ve){Wi(we,we.return,Ve)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;b===g&&(b=null),g=g.return}b===g&&(b=null),g.sibling.return=g.return,g=g.sibling}A&4&&(A=p.updateQueue,A!==null&&(b=A.retryQueue,b!==null&&(A.retryQueue=null,Ek(p,b))));break;case 19:Go(g,p),Wo(p),A&4&&(A=p.updateQueue,A!==null&&(p.updateQueue=null,Ek(p,A)));break;case 30:break;case 21:break;default:Go(g,p),Wo(p)}}function Wo(p){var g=p.flags;if(g&2){try{for(var b,A=p.return;A!==null;){if(H9(A)){b=A;break}A=A.return}if(b==null)throw Error(i(160));switch(b.tag){case 27:var R=b.stateNode,z=wk(p);mE(p,z,R);break;case 5:var Q=b.stateNode;b.flags&32&&(hl(Q,""),b.flags&=-33);var le=wk(p);mE(p,le,Q);break;case 3:case 4:var we=b.stateNode.containerInfo,Le=wk(p);_k(p,Le,we);break;default:throw Error(i(161))}}catch(rt){Wi(p,p.return,rt)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function Q9(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var g=p;Q9(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),p=p.sibling}}function hf(p,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)q9(p,g.alternate,g),g=g.sibling}function km(p){for(p=p.child;p!==null;){var g=p;switch(g.tag){case 0:case 11:case 14:case 15:df(4,g,g.return),km(g);break;case 1:ou(g,g.return);var b=g.stateNode;typeof b.componentWillUnmount=="function"&&V9(g,g.return,b),km(g);break;case 27:f1(g.stateNode);case 26:case 5:ou(g,g.return),km(g);break;case 22:g.memoizedState===null&&km(g);break;case 30:km(g);break;default:km(g)}p=p.sibling}}function ff(p,g,b){for(b=b&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var A=g.alternate,R=p,z=g,Q=z.flags;switch(z.tag){case 0:case 11:case 15:ff(R,z,b),i1(4,z);break;case 1:if(ff(R,z,b),A=z,R=A.stateNode,typeof R.componentDidMount=="function")try{R.componentDidMount()}catch(Le){Wi(A,A.return,Le)}if(A=z,R=A.updateQueue,R!==null){var le=A.stateNode;try{var we=R.shared.hiddenCallbacks;if(we!==null)for(R.shared.hiddenCallbacks=null,R=0;R<we.length;R++)C8(we[R],le)}catch(Le){Wi(A,A.return,Le)}}b&&Q&64&&F9(z),n1(z,z.return);break;case 27:G9(z);case 26:case 5:ff(R,z,b),b&&A===null&&Q&4&&U9(z),n1(z,z.return);break;case 12:ff(R,z,b);break;case 13:ff(R,z,b),b&&Q&4&&$9(R,z);break;case 22:z.memoizedState===null&&ff(R,z,b),n1(z,z.return);break;case 30:break;default:ff(R,z,b)}g=g.sibling}}function Ak(p,g){var b=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(b=p.memoizedState.cachePool.pool),p=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(p=g.memoizedState.cachePool.pool),p!==b&&(p!=null&&p.refCount++,b!=null&&Hb(b))}function Ck(p,g){p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&Hb(p))}function lu(p,g,b,A){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)Z9(p,g,b,A),g=g.sibling}function Z9(p,g,b,A){var R=g.flags;switch(g.tag){case 0:case 11:case 15:lu(p,g,b,A),R&2048&&i1(9,g);break;case 1:lu(p,g,b,A);break;case 3:lu(p,g,b,A),R&2048&&(p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&Hb(p)));break;case 12:if(R&2048){lu(p,g,b,A),p=g.stateNode;try{var z=g.memoizedProps,Q=z.id,le=z.onPostCommit;typeof le=="function"&&le(Q,g.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(we){Wi(g,g.return,we)}}else lu(p,g,b,A);break;case 13:lu(p,g,b,A);break;case 23:break;case 22:z=g.stateNode,Q=g.alternate,g.memoizedState!==null?z._visibility&2?lu(p,g,b,A):s1(p,g):z._visibility&2?lu(p,g,b,A):(z._visibility|=2,Z0(p,g,b,A,(g.subtreeFlags&10256)!==0)),R&2048&&Ak(Q,g);break;case 24:lu(p,g,b,A),R&2048&&Ck(g.alternate,g);break;default:lu(p,g,b,A)}}function Z0(p,g,b,A,R){for(R=R&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var z=p,Q=g,le=b,we=A,Le=Q.flags;switch(Q.tag){case 0:case 11:case 15:Z0(z,Q,le,we,R),i1(8,Q);break;case 23:break;case 22:var rt=Q.stateNode;Q.memoizedState!==null?rt._visibility&2?Z0(z,Q,le,we,R):s1(z,Q):(rt._visibility|=2,Z0(z,Q,le,we,R)),R&&Le&2048&&Ak(Q.alternate,Q);break;case 24:Z0(z,Q,le,we,R),R&&Le&2048&&Ck(Q.alternate,Q);break;default:Z0(z,Q,le,we,R)}g=g.sibling}}function s1(p,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var b=p,A=g,R=A.flags;switch(A.tag){case 22:s1(b,A),R&2048&&Ak(A.alternate,A);break;case 24:s1(b,A),R&2048&&Ck(A.alternate,A);break;default:s1(b,A)}g=g.sibling}}var a1=8192;function J0(p){if(p.subtreeFlags&a1)for(p=p.child;p!==null;)J9(p),p=p.sibling}function J9(p){switch(p.tag){case 26:J0(p),p.flags&a1&&p.memoizedState!==null&&Wve(rc,p.memoizedState,p.memoizedProps);break;case 5:J0(p);break;case 3:case 4:var g=rc;rc=ME(p.stateNode.containerInfo),J0(p),rc=g;break;case 22:p.memoizedState===null&&(g=p.alternate,g!==null&&g.memoizedState!==null?(g=a1,a1=16777216,J0(p),a1=g):J0(p));break;default:J0(p)}}function e7(p){var g=p.alternate;if(g!==null&&(p=g.child,p!==null)){g.child=null;do g=p.sibling,p.sibling=null,p=g;while(p!==null)}}function o1(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var b=0;b<g.length;b++){var A=g[b];Os=A,r7(A,p)}e7(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)t7(p),p=p.sibling}function t7(p){switch(p.tag){case 0:case 11:case 15:o1(p),p.flags&2048&&df(9,p,p.return);break;case 3:o1(p);break;case 12:o1(p);break;case 22:var g=p.stateNode;p.memoizedState!==null&&g._visibility&2&&(p.return===null||p.return.tag!==13)?(g._visibility&=-3,gE(p)):o1(p);break;default:o1(p)}}function gE(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var b=0;b<g.length;b++){var A=g[b];Os=A,r7(A,p)}e7(p)}for(p=p.child;p!==null;){switch(g=p,g.tag){case 0:case 11:case 15:df(8,g,g.return),gE(g);break;case 22:b=g.stateNode,b._visibility&2&&(b._visibility&=-3,gE(g));break;default:gE(g)}p=p.sibling}}function r7(p,g){for(;Os!==null;){var b=Os;switch(b.tag){case 0:case 11:case 15:df(8,b,g);break;case 23:case 22:if(b.memoizedState!==null&&b.memoizedState.cachePool!==null){var A=b.memoizedState.cachePool.pool;A!=null&&A.refCount++}break;case 24:Hb(b.memoizedState.cache)}if(A=b.child,A!==null)A.return=b,Os=A;else e:for(b=p;Os!==null;){A=Os;var R=A.sibling,z=A.return;if(Y9(A),A===b){Os=null;break e}if(R!==null){R.return=z,Os=R;break e}Os=z}}}var ove={getCacheForType:function(p){var g=Aa(gs),b=g.data.get(p);return b===void 0&&(b=p(),g.data.set(p,b)),b}},lve=typeof WeakMap=="function"?WeakMap:Map,Ti=0,Ki=null,Wr=null,si=0,Mi=0,qo=null,pf=!1,ev=!1,Tk=!1,Od=0,Sn=0,mf=0,Rm=0,Mk=0,wl=0,tv=0,l1=null,yo=null,Pk=!1,Dk=0,vE=1/0,yE=null,gf=null,ia=0,vf=null,rv=null,iv=0,Nk=0,kk=null,i7=null,c1=0,Rk=null;function Yo(){if((Ti&2)!==0&&si!==0)return si&-si;if(G.T!==null){var p=G0;return p!==0?p:Fk()}return ei()}function n7(){wl===0&&(wl=(si&536870912)===0||vi?ye():536870912);var p=bl.current;return p!==null&&(p.flags|=32),wl}function Xo(p,g,b){(p===Ki&&(Mi===2||Mi===9)||p.cancelPendingCommit!==null)&&(nv(p,0),yf(p,si,wl,!1)),xt(p,b),((Ti&2)===0||p!==Ki)&&(p===Ki&&((Ti&2)===0&&(Rm|=b),Sn===4&&yf(p,si,wl,!1)),cu(p))}function s7(p,g,b){if((Ti&6)!==0)throw Error(i(327));var A=!b&&(g&124)===0&&(g&p.expiredLanes)===0||kt(p,g),R=A?dve(p,g):jk(p,g,!0),z=A;do{if(R===0){ev&&!A&&yf(p,g,0,!1);break}else{if(b=p.current.alternate,z&&!cve(b)){R=jk(p,g,!1),z=!1;continue}if(R===2){if(z=g,p.errorRecoveryDisabledLanes&z)var Q=0;else Q=p.pendingLanes&-536870913,Q=Q!==0?Q:Q&536870912?536870912:0;if(Q!==0){g=Q;e:{var le=p;R=l1;var we=le.current.memoizedState.isDehydrated;if(we&&(nv(le,Q).flags|=256),Q=jk(le,Q,!1),Q!==2){if(Tk&&!we){le.errorRecoveryDisabledLanes|=z,Rm|=z,R=4;break e}z=yo,yo=R,z!==null&&(yo===null?yo=z:yo.push.apply(yo,z))}R=Q}if(z=!1,R!==2)continue}}if(R===1){nv(p,0),yf(p,g,0,!0);break}e:{switch(A=p,z=R,z){case 0:case 1:throw Error(i(345));case 4:if((g&4194048)!==g)break;case 6:yf(A,g,wl,!pf);break e;case 2:yo=null;break;case 3:case 5:break;default:throw Error(i(329))}if((g&62914560)===g&&(R=Dk+300-dt(),10<R)){if(yf(A,g,wl,!pf),ft(A,0,!0)!==0)break e;A.timeoutHandle=I7(a7.bind(null,A,b,yo,yE,Pk,g,wl,Rm,tv,pf,z,2,-0,0),R);break e}a7(A,b,yo,yE,Pk,g,wl,Rm,tv,pf,z,0,-0,0)}}break}while(!0);cu(p)}function a7(p,g,b,A,R,z,Q,le,we,Le,rt,at,Fe,Ve){if(p.timeoutHandle=-1,at=g.subtreeFlags,(at&8192||(at&16785408)===16785408)&&(g1={stylesheets:null,count:0,unsuspend:Gve},J9(g),at=qve(),at!==null)){p.cancelPendingCommit=at(f7.bind(null,p,g,z,b,A,R,Q,le,we,rt,1,Fe,Ve)),yf(p,z,Q,!Le);return}f7(p,g,z,b,A,R,Q,le,we)}function cve(p){for(var g=p;;){var b=g.tag;if((b===0||b===11||b===15)&&g.flags&16384&&(b=g.updateQueue,b!==null&&(b=b.stores,b!==null)))for(var A=0;A<b.length;A++){var R=b[A],z=R.getSnapshot;R=R.value;try{if(!Uo(z(),R))return!1}catch{return!1}}if(b=g.child,g.subtreeFlags&16384&&b!==null)b.return=g,g=b;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function yf(p,g,b,A){g&=~Mk,g&=~Rm,p.suspendedLanes|=g,p.pingedLanes&=~g,A&&(p.warmLanes|=g),A=p.expirationTimes;for(var R=g;0<R;){var z=31-Ue(R),Q=1<<z;A[z]=-1,R&=~Q}b!==0&&gr(p,b,g)}function xE(){return(Ti&6)===0?(u1(0),!1):!0}function Ik(){if(Wr!==null){if(Mi===0)var p=Wr.return;else p=Wr,Td=Tm=null,QN(p),K0=null,e1=0,p=Wr;for(;p!==null;)B9(p.alternate,p),p=p.return;Wr=null}}function nv(p,g){var b=p.timeoutHandle;b!==-1&&(p.timeoutHandle=-1,Tve(b)),b=p.cancelPendingCommit,b!==null&&(p.cancelPendingCommit=null,b()),Ik(),Ki=p,Wr=b=Ed(p.current,null),si=g,Mi=0,qo=null,pf=!1,ev=kt(p,g),Tk=!1,tv=wl=Mk=Rm=mf=Sn=0,yo=l1=null,Pk=!1,(g&8)!==0&&(g|=g&32);var A=p.entangledLanes;if(A!==0)for(p=p.entanglements,A&=g;0<A;){var R=31-Ue(A),z=1<<R;g|=p[R],A&=~z}return Od=g,VS(),b}function o7(p,g){Br=null,G.H=aE,g===Wb||g===KS?(g=E8(),Mi=3):g===w8?(g=E8(),Mi=4):Mi=g===A9?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,qo=g,Wr===null&&(Sn=1,dE(p,gl(g,p.current)))}function l7(){var p=G.H;return G.H=aE,p===null?aE:p}function c7(){var p=G.A;return G.A=ove,p}function Ok(){Sn=4,pf||(si&4194048)!==si&&bl.current!==null||(ev=!0),(mf&134217727)===0&&(Rm&134217727)===0||Ki===null||yf(Ki,si,wl,!1)}function jk(p,g,b){var A=Ti;Ti|=2;var R=l7(),z=c7();(Ki!==p||si!==g)&&(yE=null,nv(p,g)),g=!1;var Q=Sn;e:do try{if(Mi!==0&&Wr!==null){var le=Wr,we=qo;switch(Mi){case 8:Ik(),Q=6;break e;case 3:case 2:case 9:case 6:bl.current===null&&(g=!0);var Le=Mi;if(Mi=0,qo=null,sv(p,le,we,Le),b&&ev){Q=0;break e}break;default:Le=Mi,Mi=0,qo=null,sv(p,le,we,Le)}}uve(),Q=Sn;break}catch(rt){o7(p,rt)}while(!0);return g&&p.shellSuspendCounter++,Td=Tm=null,Ti=A,G.H=R,G.A=z,Wr===null&&(Ki=null,si=0,VS()),Q}function uve(){for(;Wr!==null;)u7(Wr)}function dve(p,g){var b=Ti;Ti|=2;var A=l7(),R=c7();Ki!==p||si!==g?(yE=null,vE=dt()+500,nv(p,g)):ev=kt(p,g);e:do try{if(Mi!==0&&Wr!==null){g=Wr;var z=qo;t:switch(Mi){case 1:Mi=0,qo=null,sv(p,g,z,1);break;case 2:case 9:if(_8(z)){Mi=0,qo=null,d7(g);break}g=function(){Mi!==2&&Mi!==9||Ki!==p||(Mi=7),cu(p)},z.then(g,g);break e;case 3:Mi=7;break e;case 4:Mi=5;break e;case 7:_8(z)?(Mi=0,qo=null,d7(g)):(Mi=0,qo=null,sv(p,g,z,7));break;case 5:var Q=null;switch(Wr.tag){case 26:Q=Wr.memoizedState;case 5:case 27:var le=Wr;if(!Q||q7(Q)){Mi=0,qo=null;var we=le.sibling;if(we!==null)Wr=we;else{var Le=le.return;Le!==null?(Wr=Le,bE(Le)):Wr=null}break t}}Mi=0,qo=null,sv(p,g,z,5);break;case 6:Mi=0,qo=null,sv(p,g,z,6);break;case 8:Ik(),Sn=6;break e;default:throw Error(i(462))}}hve();break}catch(rt){o7(p,rt)}while(!0);return Td=Tm=null,G.H=A,G.A=R,Ti=b,Wr!==null?0:(Ki=null,si=0,VS(),Sn)}function hve(){for(;Wr!==null&&!$e();)u7(Wr)}function u7(p){var g=L9(p.alternate,p,Od);p.memoizedProps=p.pendingProps,g===null?bE(p):Wr=g}function d7(p){var g=p,b=g.alternate;switch(g.tag){case 15:case 0:g=N9(b,g,g.pendingProps,g.type,void 0,si);break;case 11:g=N9(b,g,g.pendingProps,g.type.render,g.ref,si);break;case 5:QN(g);default:B9(b,g),g=Wr=h8(g,Od),g=L9(b,g,Od)}p.memoizedProps=p.pendingProps,g===null?bE(p):Wr=g}function sv(p,g,b,A){Td=Tm=null,QN(g),K0=null,e1=0;var R=g.return;try{if(tve(p,R,g,b,si)){Sn=1,dE(p,gl(b,p.current)),Wr=null;return}}catch(z){if(R!==null)throw Wr=R,z;Sn=1,dE(p,gl(b,p.current)),Wr=null;return}g.flags&32768?(vi||A===1?p=!0:ev||(si&536870912)!==0?p=!1:(pf=p=!0,(A===2||A===9||A===3||A===6)&&(A=bl.current,A!==null&&A.tag===13&&(A.flags|=16384))),h7(g,p)):bE(g)}function bE(p){var g=p;do{if((g.flags&32768)!==0){h7(g,pf);return}p=g.return;var b=ive(g.alternate,g,Od);if(b!==null){Wr=b;return}if(g=g.sibling,g!==null){Wr=g;return}Wr=g=p}while(g!==null);Sn===0&&(Sn=5)}function h7(p,g){do{var b=nve(p.alternate,p);if(b!==null){b.flags&=32767,Wr=b;return}if(b=p.return,b!==null&&(b.flags|=32768,b.subtreeFlags=0,b.deletions=null),!g&&(p=p.sibling,p!==null)){Wr=p;return}Wr=p=b}while(p!==null);Sn=6,Wr=null}function f7(p,g,b,A,R,z,Q,le,we){p.cancelPendingCommit=null;do wE();while(ia!==0);if((Ti&6)!==0)throw Error(i(327));if(g!==null){if(g===p.current)throw Error(i(177));if(z=g.lanes|g.childLanes,z|=CN,Wt(p,b,z,Q,le,we),p===Ki&&(Wr=Ki=null,si=0),rv=g,vf=p,iv=b,Nk=z,kk=R,i7=A,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,gve(_e,function(){return y7(),null})):(p.callbackNode=null,p.callbackPriority=0),A=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||A){A=G.T,G.T=null,R=Y.p,Y.p=2,Q=Ti,Ti|=4;try{sve(p,g,b)}finally{Ti=Q,Y.p=R,G.T=A}}ia=1,p7(),m7(),g7()}}function p7(){if(ia===1){ia=0;var p=vf,g=rv,b=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||b){b=G.T,G.T=null;var A=Y.p;Y.p=2;var R=Ti;Ti|=4;try{K9(g,p);var z=Xk,Q=r8(p.containerInfo),le=z.focusedElem,we=z.selectionRange;if(Q!==le&&le&&le.ownerDocument&&t8(le.ownerDocument.documentElement,le)){if(we!==null&&wN(le)){var Le=we.start,rt=we.end;if(rt===void 0&&(rt=Le),"selectionStart"in le)le.selectionStart=Le,le.selectionEnd=Math.min(rt,le.value.length);else{var at=le.ownerDocument||document,Fe=at&&at.defaultView||window;if(Fe.getSelection){var Ve=Fe.getSelection(),yr=le.textContent.length,dr=Math.min(we.start,yr),zi=we.end===void 0?dr:Math.min(we.end,yr);!Ve.extend&&dr>zi&&(Q=zi,zi=dr,dr=Q);var Pe=e8(le,dr),Te=e8(le,zi);if(Pe&&Te&&(Ve.rangeCount!==1||Ve.anchorNode!==Pe.node||Ve.anchorOffset!==Pe.offset||Ve.focusNode!==Te.node||Ve.focusOffset!==Te.offset)){var Ie=at.createRange();Ie.setStart(Pe.node,Pe.offset),Ve.removeAllRanges(),dr>zi?(Ve.addRange(Ie),Ve.extend(Te.node,Te.offset)):(Ie.setEnd(Te.node,Te.offset),Ve.addRange(Ie))}}}}for(at=[],Ve=le;Ve=Ve.parentNode;)Ve.nodeType===1&&at.push({element:Ve,left:Ve.scrollLeft,top:Ve.scrollTop});for(typeof le.focus=="function"&&le.focus(),le=0;le<at.length;le++){var st=at[le];st.element.scrollLeft=st.left,st.element.scrollTop=st.top}}RE=!!Yk,Xk=Yk=null}finally{Ti=R,Y.p=A,G.T=b}}p.current=g,ia=2}}function m7(){if(ia===2){ia=0;var p=vf,g=rv,b=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||b){b=G.T,G.T=null;var A=Y.p;Y.p=2;var R=Ti;Ti|=4;try{q9(p,g.alternate,g)}finally{Ti=R,Y.p=A,G.T=b}}ia=3}}function g7(){if(ia===4||ia===3){ia=0,mt();var p=vf,g=rv,b=iv,A=i7;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?ia=5:(ia=0,rv=vf=null,v7(p,p.pendingLanes));var R=p.pendingLanes;if(R===0&&(gf=null),Js(b),g=g.stateNode,Se&&typeof Se.onCommitFiberRoot=="function")try{Se.onCommitFiberRoot(W,g,void 0,(g.current.flags&128)===128)}catch{}if(A!==null){g=G.T,R=Y.p,Y.p=2,G.T=null;try{for(var z=p.onRecoverableError,Q=0;Q<A.length;Q++){var le=A[Q];z(le.value,{componentStack:le.stack})}}finally{G.T=g,Y.p=R}}(iv&3)!==0&&wE(),cu(p),R=p.pendingLanes,(b&4194090)!==0&&(R&42)!==0?p===Rk?c1++:(c1=0,Rk=p):c1=0,u1(0)}}function v7(p,g){(p.pooledCacheLanes&=g)===0&&(g=p.pooledCache,g!=null&&(p.pooledCache=null,Hb(g)))}function wE(p){return p7(),m7(),g7(),y7()}function y7(){if(ia!==5)return!1;var p=vf,g=Nk;Nk=0;var b=Js(iv),A=G.T,R=Y.p;try{Y.p=32>b?32:b,G.T=null,b=kk,kk=null;var z=vf,Q=iv;if(ia=0,rv=vf=null,iv=0,(Ti&6)!==0)throw Error(i(331));var le=Ti;if(Ti|=4,t7(z.current),Z9(z,z.current,Q,b),Ti=le,u1(0,!1),Se&&typeof Se.onPostCommitFiberRoot=="function")try{Se.onPostCommitFiberRoot(W,z)}catch{}return!0}finally{Y.p=R,G.T=A,v7(p,g)}}function x7(p,g,b){g=gl(b,g),g=dk(p.stateNode,g,2),p=of(p,g,2),p!==null&&(xt(p,2),cu(p))}function Wi(p,g,b){if(p.tag===3)x7(p,p,b);else for(;g!==null;){if(g.tag===3){x7(g,p,b);break}else if(g.tag===1){var A=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(gf===null||!gf.has(A))){p=gl(b,p),b=S9(2),A=of(g,b,2),A!==null&&(E9(b,A,g,p),xt(A,2),cu(A));break}}g=g.return}}function Lk(p,g,b){var A=p.pingCache;if(A===null){A=p.pingCache=new lve;var R=new Set;A.set(g,R)}else R=A.get(g),R===void 0&&(R=new Set,A.set(g,R));R.has(b)||(Tk=!0,R.add(b),p=fve.bind(null,p,g,b),g.then(p,p))}function fve(p,g,b){var A=p.pingCache;A!==null&&A.delete(g),p.pingedLanes|=p.suspendedLanes&b,p.warmLanes&=~b,Ki===p&&(si&b)===b&&(Sn===4||Sn===3&&(si&62914560)===si&&300>dt()-Dk?(Ti&2)===0&&nv(p,0):Mk|=b,tv===si&&(tv=0)),cu(p)}function b7(p,g){g===0&&(g=He()),p=F0(p,g),p!==null&&(xt(p,g),cu(p))}function pve(p){var g=p.memoizedState,b=0;g!==null&&(b=g.retryLane),b7(p,b)}function mve(p,g){var b=0;switch(p.tag){case 13:var A=p.stateNode,R=p.memoizedState;R!==null&&(b=R.retryLane);break;case 19:A=p.stateNode;break;case 22:A=p.stateNode._retryCache;break;default:throw Error(i(314))}A!==null&&A.delete(g),b7(p,b)}function gve(p,g){return Ee(p,g)}var _E=null,av=null,zk=!1,SE=!1,Bk=!1,Im=0;function cu(p){p!==av&&p.next===null&&(av===null?_E=av=p:av=av.next=p),SE=!0,zk||(zk=!0,yve())}function u1(p,g){if(!Bk&&SE){Bk=!0;do for(var b=!1,A=_E;A!==null;){if(p!==0){var R=A.pendingLanes;if(R===0)var z=0;else{var Q=A.suspendedLanes,le=A.pingedLanes;z=(1<<31-Ue(42|p)+1)-1,z&=R&~(Q&~le),z=z&201326741?z&201326741|1:z?z|2:0}z!==0&&(b=!0,E7(A,z))}else z=si,z=ft(A,A===Ki?z:0,A.cancelPendingCommit!==null||A.timeoutHandle!==-1),(z&3)===0||kt(A,z)||(b=!0,E7(A,z));A=A.next}while(b);Bk=!1}}function vve(){w7()}function w7(){SE=zk=!1;var p=0;Im!==0&&(Cve()&&(p=Im),Im=0);for(var g=dt(),b=null,A=_E;A!==null;){var R=A.next,z=_7(A,g);z===0?(A.next=null,b===null?_E=R:b.next=R,R===null&&(av=b)):(b=A,(p!==0||(z&3)!==0)&&(SE=!0)),A=R}u1(p)}function _7(p,g){for(var b=p.suspendedLanes,A=p.pingedLanes,R=p.expirationTimes,z=p.pendingLanes&-62914561;0<z;){var Q=31-Ue(z),le=1<<Q,we=R[Q];we===-1?((le&b)===0||(le&A)!==0)&&(R[Q]=Mt(le,g)):we<=g&&(p.expiredLanes|=le),z&=~le}if(g=Ki,b=si,b=ft(p,p===g?b:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),A=p.callbackNode,b===0||p===g&&(Mi===2||Mi===9)||p.cancelPendingCommit!==null)return A!==null&&A!==null&&Be(A),p.callbackNode=null,p.callbackPriority=0;if((b&3)===0||kt(p,b)){if(g=b&-b,g===p.callbackPriority)return g;switch(A!==null&&Be(A),Js(b)){case 2:case 8:b=me;break;case 32:b=_e;break;case 268435456:b=J;break;default:b=_e}return A=S7.bind(null,p),b=Ee(b,A),p.callbackPriority=g,p.callbackNode=b,g}return A!==null&&A!==null&&Be(A),p.callbackPriority=2,p.callbackNode=null,2}function S7(p,g){if(ia!==0&&ia!==5)return p.callbackNode=null,p.callbackPriority=0,null;var b=p.callbackNode;if(wE()&&p.callbackNode!==b)return null;var A=si;return A=ft(p,p===Ki?A:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),A===0?null:(s7(p,A,g),_7(p,dt()),p.callbackNode!=null&&p.callbackNode===b?S7.bind(null,p):null)}function E7(p,g){if(wE())return null;s7(p,g,!0)}function yve(){Mve(function(){(Ti&6)!==0?Ee(ut,vve):w7()})}function Fk(){return Im===0&&(Im=ye()),Im}function A7(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:M0(""+p)}function C7(p,g){var b=g.ownerDocument.createElement("input");return b.name=g.name,b.value=g.value,p.id&&b.setAttribute("form",p.id),g.parentNode.insertBefore(b,g),p=new FormData(p),b.parentNode.removeChild(b),p}function xve(p,g,b,A,R){if(g==="submit"&&b&&b.stateNode===R){var z=A7((R[ln]||null).action),Q=A.submitter;Q&&(g=(g=Q[ln]||null)?A7(g.formAction):Q.getAttribute("formAction"),g!==null&&(z=g,Q=null));var le=new P0("action","action",null,A,R);p.push({event:le,listeners:[{instance:null,listener:function(){if(A.defaultPrevented){if(Im!==0){var we=Q?C7(R,Q):new FormData(R);ak(b,{pending:!0,data:we,method:R.method,action:z},null,we)}}else typeof z=="function"&&(le.preventDefault(),we=Q?C7(R,Q):new FormData(R),ak(b,{pending:!0,data:we,method:R.method,action:z},z,we))},currentTarget:R}]})}}for(var Vk=0;Vk<AN.length;Vk++){var Uk=AN[Vk],bve=Uk.toLowerCase(),wve=Uk[0].toUpperCase()+Uk.slice(1);tc(bve,"on"+wve)}tc(s8,"onAnimationEnd"),tc(a8,"onAnimationIteration"),tc(o8,"onAnimationStart"),tc("dblclick","onDoubleClick"),tc("focusin","onFocus"),tc("focusout","onBlur"),tc(z0e,"onTransitionRun"),tc(B0e,"onTransitionStart"),tc(F0e,"onTransitionCancel"),tc(l8,"onTransitionEnd"),Ci("onMouseEnter",["mouseout","mouseover"]),Ci("onMouseLeave",["mouseout","mouseover"]),Ci("onPointerEnter",["pointerout","pointerover"]),Ci("onPointerLeave",["pointerout","pointerover"]),Xt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var d1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_ve=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(d1));function T7(p,g){g=(g&4)!==0;for(var b=0;b<p.length;b++){var A=p[b],R=A.event;A=A.listeners;e:{var z=void 0;if(g)for(var Q=A.length-1;0<=Q;Q--){var le=A[Q],we=le.instance,Le=le.currentTarget;if(le=le.listener,we!==z&&R.isPropagationStopped())break e;z=le,R.currentTarget=Le;try{z(R)}catch(rt){uE(rt)}R.currentTarget=null,z=we}else for(Q=0;Q<A.length;Q++){if(le=A[Q],we=le.instance,Le=le.currentTarget,le=le.listener,we!==z&&R.isPropagationStopped())break e;z=le,R.currentTarget=Le;try{z(R)}catch(rt){uE(rt)}R.currentTarget=null,z=we}}}}function qr(p,g){var b=g[Zl];b===void 0&&(b=g[Zl]=new Set);var A=p+"__bubble";b.has(A)||(M7(g,p,2,!1),b.add(A))}function Hk(p,g,b){var A=0;g&&(A|=4),M7(b,p,A,g)}var EE="_reactListening"+Math.random().toString(36).slice(2);function Gk(p){if(!p[EE]){p[EE]=!0,wr.forEach(function(b){b!=="selectionchange"&&(_ve.has(b)||Hk(b,!1,p),Hk(b,!0,p))});var g=p.nodeType===9?p:p.ownerDocument;g===null||g[EE]||(g[EE]=!0,Hk("selectionchange",!1,g))}}function M7(p,g,b,A){switch(Z7(g)){case 2:var R=$ve;break;case 8:R=Kve;break;default:R=nR}b=R.bind(null,g,b,p),R=void 0,!pl||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(R=!0),A?R!==void 0?p.addEventListener(g,b,{capture:!0,passive:R}):p.addEventListener(g,b,!0):R!==void 0?p.addEventListener(g,b,{passive:R}):p.addEventListener(g,b,!1)}function Wk(p,g,b,A,R){var z=A;if((g&1)===0&&(g&2)===0&&A!==null)e:for(;;){if(A===null)return;var Q=A.tag;if(Q===3||Q===4){var le=A.stateNode.containerInfo;if(le===R)break;if(Q===4)for(Q=A.return;Q!==null;){var we=Q.tag;if((we===3||we===4)&&Q.stateNode.containerInfo===R)return;Q=Q.return}for(;le!==null;){if(Q=Tt(le),Q===null)return;if(we=Q.tag,we===5||we===6||we===26||we===27){A=z=Q;continue e}le=le.parentNode}}A=A.return}CS(function(){var Le=z,rt=fl(b),at=[];e:{var Fe=c8.get(p);if(Fe!==void 0){var Ve=P0,yr=p;switch(p){case"keypress":if(eu(b)===0)break e;case"keydown":case"keyup":Ve=O0;break;case"focusin":yr="focus",Ve=k0;break;case"focusout":yr="blur",Ve=k0;break;case"beforeblur":case"afterblur":Ve=k0;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ve=ml;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ve=vN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ve=IS;break;case s8:case a8:case o8:Ve=R0;break;case l8:Ve=jS;break;case"scroll":case"scrollend":Ve=TS;break;case"wheel":Ve=j0;break;case"copy":case"cut":case"paste":Ve=I0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ve=Ob;break;case"toggle":case"beforetoggle":Ve=zS}var dr=(g&4)!==0,zi=!dr&&(p==="scroll"||p==="scrollend"),Pe=dr?Fe!==null?Fe+"Capture":null:Fe;dr=[];for(var Te=Le,Ie;Te!==null;){var st=Te;if(Ie=st.stateNode,st=st.tag,st!==5&&st!==26&&st!==27||Ie===null||Pe===null||(st=fm(Te,Pe),st!=null&&dr.push(h1(Te,st,Ie))),zi)break;Te=Te.return}0<dr.length&&(Fe=new Ve(Fe,yr,null,b,rt),at.push({event:Fe,listeners:dr}))}}if((g&7)===0){e:{if(Fe=p==="mouseover"||p==="pointerover",Ve=p==="mouseout"||p==="pointerout",Fe&&b!==yd&&(yr=b.relatedTarget||b.fromElement)&&(Tt(yr)||yr[Ea]))break e;if((Ve||Fe)&&(Fe=rt.window===rt?rt:(Fe=rt.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,Ve?(yr=b.relatedTarget||b.toElement,Ve=Le,yr=yr?Tt(yr):null,yr!==null&&(zi=s(yr),dr=yr.tag,yr!==zi||dr!==5&&dr!==27&&dr!==6)&&(yr=null)):(Ve=null,yr=Le),Ve!==yr)){if(dr=ml,st="onMouseLeave",Pe="onMouseEnter",Te="mouse",(p==="pointerout"||p==="pointerover")&&(dr=Ob,st="onPointerLeave",Pe="onPointerEnter",Te="pointer"),zi=Ve==null?Fe:qt(Ve),Ie=yr==null?Fe:qt(yr),Fe=new dr(st,Te+"leave",Ve,b,rt),Fe.target=zi,Fe.relatedTarget=Ie,st=null,Tt(rt)===Le&&(dr=new dr(Pe,Te+"enter",yr,b,rt),dr.target=Ie,dr.relatedTarget=zi,st=dr),zi=st,Ve&&yr)t:{for(dr=Ve,Pe=yr,Te=0,Ie=dr;Ie;Ie=ov(Ie))Te++;for(Ie=0,st=Pe;st;st=ov(st))Ie++;for(;0<Te-Ie;)dr=ov(dr),Te--;for(;0<Ie-Te;)Pe=ov(Pe),Ie--;for(;Te--;){if(dr===Pe||Pe!==null&&dr===Pe.alternate)break t;dr=ov(dr),Pe=ov(Pe)}dr=null}else dr=null;Ve!==null&&P7(at,Fe,Ve,dr,!1),yr!==null&&zi!==null&&P7(at,zi,yr,dr,!0)}}e:{if(Fe=Le?qt(Le):window,Ve=Fe.nodeName&&Fe.nodeName.toLowerCase(),Ve==="select"||Ve==="input"&&Fe.type==="file")var zt=XU;else if(ms(Fe))if($U)zt=O0e;else{zt=R0e;var Ur=k0e}else Ve=Fe.nodeName,!Ve||Ve.toLowerCase()!=="input"||Fe.type!=="checkbox"&&Fe.type!=="radio"?Le&&Mb(Le.elementType)&&(zt=XU):zt=I0e;if(zt&&(zt=zt(p,Le))){Sd(at,zt,b,rt);break e}Ur&&Ur(p,Fe,Le),p==="focusout"&&Le&&Fe.type==="number"&&Le.memoizedProps.value!=null&&tf(Fe,"number",Fe.value)}switch(Ur=Le?qt(Le):window,p){case"focusin":(ms(Ur)||Ur.contentEditable==="true")&&(L0=Ur,_N=Le,zb=null);break;case"focusout":zb=_N=L0=null;break;case"mousedown":SN=!0;break;case"contextmenu":case"mouseup":case"dragend":SN=!1,i8(at,b,rt);break;case"selectionchange":if(L0e)break;case"keydown":case"keyup":i8(at,b,rt)}var Yt;if(iu)e:{switch(p){case"compositionstart":var pr="onCompositionStart";break e;case"compositionend":pr="onCompositionEnd";break e;case"compositionupdate":pr="onCompositionUpdate";break e}pr=void 0}else ii?Ye(p,b)&&(pr="onCompositionEnd"):p==="keydown"&&b.keyCode===229&&(pr="onCompositionStart");pr&&(K&&b.locale!=="ko"&&(ii||pr!=="onCompositionStart"?pr==="onCompositionEnd"&&ii&&(Yt=Db()):(Jc=rt,rf="value"in Jc?Jc.value:Jc.textContent,ii=!0)),Ur=AE(Le,pr),0<Ur.length&&(pr=new Rb(pr,p,null,b,rt),at.push({event:pr,listeners:Ur}),Yt?pr.data=Yt:(Yt=wt(b),Yt!==null&&(pr.data=Yt)))),(Yt=U?ps(p,b):ni(p,b))&&(pr=AE(Le,"onBeforeInput"),0<pr.length&&(Ur=new Rb("onBeforeInput","beforeinput",null,b,rt),at.push({event:Ur,listeners:pr}),Ur.data=Yt)),xve(at,p,Le,b,rt)}T7(at,g)})}function h1(p,g,b){return{instance:p,listener:g,currentTarget:b}}function AE(p,g){for(var b=g+"Capture",A=[];p!==null;){var R=p,z=R.stateNode;if(R=R.tag,R!==5&&R!==26&&R!==27||z===null||(R=fm(p,b),R!=null&&A.unshift(h1(p,R,z)),R=fm(p,g),R!=null&&A.push(h1(p,R,z))),p.tag===3)return A;p=p.return}return[]}function ov(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function P7(p,g,b,A,R){for(var z=g._reactName,Q=[];b!==null&&b!==A;){var le=b,we=le.alternate,Le=le.stateNode;if(le=le.tag,we!==null&&we===A)break;le!==5&&le!==26&&le!==27||Le===null||(we=Le,R?(Le=fm(b,z),Le!=null&&Q.unshift(h1(b,Le,we))):R||(Le=fm(b,z),Le!=null&&Q.push(h1(b,Le,we)))),b=b.return}Q.length!==0&&p.push({event:g,listeners:Q})}var Sve=/\r\n?/g,Eve=/\u0000|\uFFFD/g;function D7(p){return(typeof p=="string"?p:""+p).replace(Sve,`
`).replace(Eve,"")}function N7(p,g){return g=D7(g),D7(p)===g}function CE(){}function Li(p,g,b,A,R,z){switch(b){case"children":typeof A=="string"?g==="body"||g==="textarea"&&A===""||hl(p,A):(typeof A=="number"||typeof A=="bigint")&&g!=="body"&&hl(p,""+A);break;case"className":ur(p,"class",A);break;case"tabIndex":ur(p,"tabindex",A);break;case"dir":case"role":case"viewBox":case"width":case"height":ur(p,b,A);break;case"style":Tb(p,A,z);break;case"data":if(g!=="object"){ur(p,"data",A);break}case"src":case"href":if(A===""&&(g!=="a"||b!=="href")){p.removeAttribute(b);break}if(A==null||typeof A=="function"||typeof A=="symbol"||typeof A=="boolean"){p.removeAttribute(b);break}A=M0(""+A),p.setAttribute(b,A);break;case"action":case"formAction":if(typeof A=="function"){p.setAttribute(b,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof z=="function"&&(b==="formAction"?(g!=="input"&&Li(p,g,"name",R.name,R,null),Li(p,g,"formEncType",R.formEncType,R,null),Li(p,g,"formMethod",R.formMethod,R,null),Li(p,g,"formTarget",R.formTarget,R,null)):(Li(p,g,"encType",R.encType,R,null),Li(p,g,"method",R.method,R,null),Li(p,g,"target",R.target,R,null)));if(A==null||typeof A=="symbol"||typeof A=="boolean"){p.removeAttribute(b);break}A=M0(""+A),p.setAttribute(b,A);break;case"onClick":A!=null&&(p.onclick=CE);break;case"onScroll":A!=null&&qr("scroll",p);break;case"onScrollEnd":A!=null&&qr("scrollend",p);break;case"dangerouslySetInnerHTML":if(A!=null){if(typeof A!="object"||!("__html"in A))throw Error(i(61));if(b=A.__html,b!=null){if(R.children!=null)throw Error(i(60));p.innerHTML=b}}break;case"multiple":p.multiple=A&&typeof A!="function"&&typeof A!="symbol";break;case"muted":p.muted=A&&typeof A!="function"&&typeof A!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(A==null||typeof A=="function"||typeof A=="boolean"||typeof A=="symbol"){p.removeAttribute("xlink:href");break}b=M0(""+A),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",b);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":A!=null&&typeof A!="function"&&typeof A!="symbol"?p.setAttribute(b,""+A):p.removeAttribute(b);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":A&&typeof A!="function"&&typeof A!="symbol"?p.setAttribute(b,""):p.removeAttribute(b);break;case"capture":case"download":A===!0?p.setAttribute(b,""):A!==!1&&A!=null&&typeof A!="function"&&typeof A!="symbol"?p.setAttribute(b,A):p.removeAttribute(b);break;case"cols":case"rows":case"size":case"span":A!=null&&typeof A!="function"&&typeof A!="symbol"&&!isNaN(A)&&1<=A?p.setAttribute(b,A):p.removeAttribute(b);break;case"rowSpan":case"start":A==null||typeof A=="function"||typeof A=="symbol"||isNaN(A)?p.removeAttribute(b):p.setAttribute(b,A);break;case"popover":qr("beforetoggle",p),qr("toggle",p),Yn(p,"popover",A);break;case"xlinkActuate":Gi(p,"http://www.w3.org/1999/xlink","xlink:actuate",A);break;case"xlinkArcrole":Gi(p,"http://www.w3.org/1999/xlink","xlink:arcrole",A);break;case"xlinkRole":Gi(p,"http://www.w3.org/1999/xlink","xlink:role",A);break;case"xlinkShow":Gi(p,"http://www.w3.org/1999/xlink","xlink:show",A);break;case"xlinkTitle":Gi(p,"http://www.w3.org/1999/xlink","xlink:title",A);break;case"xlinkType":Gi(p,"http://www.w3.org/1999/xlink","xlink:type",A);break;case"xmlBase":Gi(p,"http://www.w3.org/XML/1998/namespace","xml:base",A);break;case"xmlLang":Gi(p,"http://www.w3.org/XML/1998/namespace","xml:lang",A);break;case"xmlSpace":Gi(p,"http://www.w3.org/XML/1998/namespace","xml:space",A);break;case"is":Yn(p,"is",A);break;case"innerText":case"textContent":break;default:(!(2<b.length)||b[0]!=="o"&&b[0]!=="O"||b[1]!=="n"&&b[1]!=="N")&&(b=mN.get(b)||b,Yn(p,b,A))}}function qk(p,g,b,A,R,z){switch(b){case"style":Tb(p,A,z);break;case"dangerouslySetInnerHTML":if(A!=null){if(typeof A!="object"||!("__html"in A))throw Error(i(61));if(b=A.__html,b!=null){if(R.children!=null)throw Error(i(60));p.innerHTML=b}}break;case"children":typeof A=="string"?hl(p,A):(typeof A=="number"||typeof A=="bigint")&&hl(p,""+A);break;case"onScroll":A!=null&&qr("scroll",p);break;case"onScrollEnd":A!=null&&qr("scrollend",p);break;case"onClick":A!=null&&(p.onclick=CE);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!vr.hasOwnProperty(b))e:{if(b[0]==="o"&&b[1]==="n"&&(R=b.endsWith("Capture"),g=b.slice(2,R?b.length-7:void 0),z=p[ln]||null,z=z!=null?z[b]:null,typeof z=="function"&&p.removeEventListener(g,z,R),typeof A=="function")){typeof z!="function"&&z!==null&&(b in p?p[b]=null:p.hasAttribute(b)&&p.removeAttribute(b)),p.addEventListener(g,A,R);break e}b in p?p[b]=A:A===!0?p.setAttribute(b,""):Yn(p,b,A)}}}function na(p,g,b){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qr("error",p),qr("load",p);var A=!1,R=!1,z;for(z in b)if(b.hasOwnProperty(z)){var Q=b[z];if(Q!=null)switch(z){case"src":A=!0;break;case"srcSet":R=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,g));default:Li(p,g,z,Q,b,null)}}R&&Li(p,g,"srcSet",b.srcSet,b,null),A&&Li(p,g,"src",b.src,b,null);return;case"input":qr("invalid",p);var le=z=Q=R=null,we=null,Le=null;for(A in b)if(b.hasOwnProperty(A)){var rt=b[A];if(rt!=null)switch(A){case"name":R=rt;break;case"type":Q=rt;break;case"checked":we=rt;break;case"defaultChecked":Le=rt;break;case"value":z=rt;break;case"defaultValue":le=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(i(137,g));break;default:Li(p,g,A,rt,b,null)}}um(p,z,le,we,Le,Q,R,!1),Kc(p);return;case"select":qr("invalid",p),A=Q=z=null;for(R in b)if(b.hasOwnProperty(R)&&(le=b[R],le!=null))switch(R){case"value":z=le;break;case"defaultValue":Q=le;break;case"multiple":A=le;default:Li(p,g,R,le,b,null)}g=z,b=Q,p.multiple=!!A,g!=null?vd(p,!!A,g,!1):b!=null&&vd(p,!!A,b,!0);return;case"textarea":qr("invalid",p),z=R=A=null;for(Q in b)if(b.hasOwnProperty(Q)&&(le=b[Q],le!=null))switch(Q){case"value":A=le;break;case"defaultValue":R=le;break;case"children":z=le;break;case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(91));break;default:Li(p,g,Q,le,b,null)}dm(p,A,R,z),Kc(p);return;case"option":for(we in b)if(b.hasOwnProperty(we)&&(A=b[we],A!=null))switch(we){case"selected":p.selected=A&&typeof A!="function"&&typeof A!="symbol";break;default:Li(p,g,we,A,b,null)}return;case"dialog":qr("beforetoggle",p),qr("toggle",p),qr("cancel",p),qr("close",p);break;case"iframe":case"object":qr("load",p);break;case"video":case"audio":for(A=0;A<d1.length;A++)qr(d1[A],p);break;case"image":qr("error",p),qr("load",p);break;case"details":qr("toggle",p);break;case"embed":case"source":case"link":qr("error",p),qr("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Le in b)if(b.hasOwnProperty(Le)&&(A=b[Le],A!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,g));default:Li(p,g,Le,A,b,null)}return;default:if(Mb(g)){for(rt in b)b.hasOwnProperty(rt)&&(A=b[rt],A!==void 0&&qk(p,g,rt,A,b,void 0));return}}for(le in b)b.hasOwnProperty(le)&&(A=b[le],A!=null&&Li(p,g,le,A,b,null))}function Ave(p,g,b,A){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var R=null,z=null,Q=null,le=null,we=null,Le=null,rt=null;for(Ve in b){var at=b[Ve];if(b.hasOwnProperty(Ve)&&at!=null)switch(Ve){case"checked":break;case"value":break;case"defaultValue":we=at;default:A.hasOwnProperty(Ve)||Li(p,g,Ve,null,A,at)}}for(var Fe in A){var Ve=A[Fe];if(at=b[Fe],A.hasOwnProperty(Fe)&&(Ve!=null||at!=null))switch(Fe){case"type":z=Ve;break;case"name":R=Ve;break;case"checked":Le=Ve;break;case"defaultChecked":rt=Ve;break;case"value":Q=Ve;break;case"defaultValue":le=Ve;break;case"children":case"dangerouslySetInnerHTML":if(Ve!=null)throw Error(i(137,g));break;default:Ve!==at&&Li(p,g,Fe,Ve,A,at)}}Vo(p,Q,le,we,Le,rt,z,R);return;case"select":Ve=Q=le=Fe=null;for(z in b)if(we=b[z],b.hasOwnProperty(z)&&we!=null)switch(z){case"value":break;case"multiple":Ve=we;default:A.hasOwnProperty(z)||Li(p,g,z,null,A,we)}for(R in A)if(z=A[R],we=b[R],A.hasOwnProperty(R)&&(z!=null||we!=null))switch(R){case"value":Fe=z;break;case"defaultValue":le=z;break;case"multiple":Q=z;default:z!==we&&Li(p,g,R,z,A,we)}g=le,b=Q,A=Ve,Fe!=null?vd(p,!!b,Fe,!1):!!A!=!!b&&(g!=null?vd(p,!!b,g,!0):vd(p,!!b,b?[]:"",!1));return;case"textarea":Ve=Fe=null;for(le in b)if(R=b[le],b.hasOwnProperty(le)&&R!=null&&!A.hasOwnProperty(le))switch(le){case"value":break;case"children":break;default:Li(p,g,le,null,A,R)}for(Q in A)if(R=A[Q],z=b[Q],A.hasOwnProperty(Q)&&(R!=null||z!=null))switch(Q){case"value":Fe=R;break;case"defaultValue":Ve=R;break;case"children":break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(i(91));break;default:R!==z&&Li(p,g,Q,R,A,z)}Oi(p,Fe,Ve);return;case"option":for(var yr in b)if(Fe=b[yr],b.hasOwnProperty(yr)&&Fe!=null&&!A.hasOwnProperty(yr))switch(yr){case"selected":p.selected=!1;break;default:Li(p,g,yr,null,A,Fe)}for(we in A)if(Fe=A[we],Ve=b[we],A.hasOwnProperty(we)&&Fe!==Ve&&(Fe!=null||Ve!=null))switch(we){case"selected":p.selected=Fe&&typeof Fe!="function"&&typeof Fe!="symbol";break;default:Li(p,g,we,Fe,A,Ve)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var dr in b)Fe=b[dr],b.hasOwnProperty(dr)&&Fe!=null&&!A.hasOwnProperty(dr)&&Li(p,g,dr,null,A,Fe);for(Le in A)if(Fe=A[Le],Ve=b[Le],A.hasOwnProperty(Le)&&Fe!==Ve&&(Fe!=null||Ve!=null))switch(Le){case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(i(137,g));break;default:Li(p,g,Le,Fe,A,Ve)}return;default:if(Mb(g)){for(var zi in b)Fe=b[zi],b.hasOwnProperty(zi)&&Fe!==void 0&&!A.hasOwnProperty(zi)&&qk(p,g,zi,void 0,A,Fe);for(rt in A)Fe=A[rt],Ve=b[rt],!A.hasOwnProperty(rt)||Fe===Ve||Fe===void 0&&Ve===void 0||qk(p,g,rt,Fe,A,Ve);return}}for(var Pe in b)Fe=b[Pe],b.hasOwnProperty(Pe)&&Fe!=null&&!A.hasOwnProperty(Pe)&&Li(p,g,Pe,null,A,Fe);for(at in A)Fe=A[at],Ve=b[at],!A.hasOwnProperty(at)||Fe===Ve||Fe==null&&Ve==null||Li(p,g,at,Fe,A,Ve)}var Yk=null,Xk=null;function TE(p){return p.nodeType===9?p:p.ownerDocument}function k7(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function R7(p,g){if(p===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&g==="foreignObject"?0:p}function $k(p,g){return p==="textarea"||p==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var Kk=null;function Cve(){var p=window.event;return p&&p.type==="popstate"?p===Kk?!1:(Kk=p,!0):(Kk=null,!1)}var I7=typeof setTimeout=="function"?setTimeout:void 0,Tve=typeof clearTimeout=="function"?clearTimeout:void 0,O7=typeof Promise=="function"?Promise:void 0,Mve=typeof queueMicrotask=="function"?queueMicrotask:typeof O7<"u"?function(p){return O7.resolve(null).then(p).catch(Pve)}:I7;function Pve(p){setTimeout(function(){throw p})}function xf(p){return p==="head"}function j7(p,g){var b=g,A=0,R=0;do{var z=b.nextSibling;if(p.removeChild(b),z&&z.nodeType===8)if(b=z.data,b==="/$"){if(0<A&&8>A){b=A;var Q=p.ownerDocument;if(b&1&&f1(Q.documentElement),b&2&&f1(Q.body),b&4)for(b=Q.head,f1(b),Q=b.firstChild;Q;){var le=Q.nextSibling,we=Q.nodeName;Q[ke]||we==="SCRIPT"||we==="STYLE"||we==="LINK"&&Q.rel.toLowerCase()==="stylesheet"||b.removeChild(Q),Q=le}}if(R===0){p.removeChild(z),w1(g);return}R--}else b==="$"||b==="$?"||b==="$!"?R++:A=b.charCodeAt(0)-48;else A=0;b=z}while(b);w1(g)}function Qk(p){var g=p.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var b=g;switch(g=g.nextSibling,b.nodeName){case"HTML":case"HEAD":case"BODY":Qk(b),Qe(b);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(b.rel.toLowerCase()==="stylesheet")continue}p.removeChild(b)}}function Dve(p,g,b,A){for(;p.nodeType===1;){var R=b;if(p.nodeName.toLowerCase()!==g.toLowerCase()){if(!A&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(A){if(!p[ke])switch(g){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(z=p.getAttribute("rel"),z==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(z!==R.rel||p.getAttribute("href")!==(R.href==null||R.href===""?null:R.href)||p.getAttribute("crossorigin")!==(R.crossOrigin==null?null:R.crossOrigin)||p.getAttribute("title")!==(R.title==null?null:R.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(z=p.getAttribute("src"),(z!==(R.src==null?null:R.src)||p.getAttribute("type")!==(R.type==null?null:R.type)||p.getAttribute("crossorigin")!==(R.crossOrigin==null?null:R.crossOrigin))&&z&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(g==="input"&&p.type==="hidden"){var z=R.name==null?null:""+R.name;if(R.type==="hidden"&&p.getAttribute("name")===z)return p}else return p;if(p=ic(p.nextSibling),p===null)break}return null}function Nve(p,g,b){if(g==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!b||(p=ic(p.nextSibling),p===null))return null;return p}function Zk(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState==="complete"}function kve(p,g){var b=p.ownerDocument;if(p.data!=="$?"||b.readyState==="complete")g();else{var A=function(){g(),b.removeEventListener("DOMContentLoaded",A)};b.addEventListener("DOMContentLoaded",A),p._reactRetry=A}}function ic(p){for(;p!=null;p=p.nextSibling){var g=p.nodeType;if(g===1||g===3)break;if(g===8){if(g=p.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return p}var Jk=null;function L7(p){p=p.previousSibling;for(var g=0;p;){if(p.nodeType===8){var b=p.data;if(b==="$"||b==="$!"||b==="$?"){if(g===0)return p;g--}else b==="/$"&&g++}p=p.previousSibling}return null}function z7(p,g,b){switch(g=TE(b),p){case"html":if(p=g.documentElement,!p)throw Error(i(452));return p;case"head":if(p=g.head,!p)throw Error(i(453));return p;case"body":if(p=g.body,!p)throw Error(i(454));return p;default:throw Error(i(451))}}function f1(p){for(var g=p.attributes;g.length;)p.removeAttributeNode(g[0]);Qe(p)}var _l=new Map,B7=new Set;function ME(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var jd=Y.d;Y.d={f:Rve,r:Ive,D:Ove,C:jve,L:Lve,m:zve,X:Fve,S:Bve,M:Vve};function Rve(){var p=jd.f(),g=xE();return p||g}function Ive(p){var g=Gt(p);g!==null&&g.tag===5&&g.type==="form"?s9(g):jd.r(p)}var lv=typeof document>"u"?null:document;function F7(p,g,b){var A=lv;if(A&&typeof g=="string"&&g){var R=cn(g);R='link[rel="'+p+'"][href="'+R+'"]',typeof b=="string"&&(R+='[crossorigin="'+b+'"]'),B7.has(R)||(B7.add(R),p={rel:p,crossOrigin:b,href:g},A.querySelector(R)===null&&(g=A.createElement("link"),na(g,"link",p),er(g),A.head.appendChild(g)))}}function Ove(p){jd.D(p),F7("dns-prefetch",p,null)}function jve(p,g){jd.C(p,g),F7("preconnect",p,g)}function Lve(p,g,b){jd.L(p,g,b);var A=lv;if(A&&p&&g){var R='link[rel="preload"][as="'+cn(g)+'"]';g==="image"&&b&&b.imageSrcSet?(R+='[imagesrcset="'+cn(b.imageSrcSet)+'"]',typeof b.imageSizes=="string"&&(R+='[imagesizes="'+cn(b.imageSizes)+'"]')):R+='[href="'+cn(p)+'"]';var z=R;switch(g){case"style":z=cv(p);break;case"script":z=uv(p)}_l.has(z)||(p=u({rel:"preload",href:g==="image"&&b&&b.imageSrcSet?void 0:p,as:g},b),_l.set(z,p),A.querySelector(R)!==null||g==="style"&&A.querySelector(p1(z))||g==="script"&&A.querySelector(m1(z))||(g=A.createElement("link"),na(g,"link",p),er(g),A.head.appendChild(g)))}}function zve(p,g){jd.m(p,g);var b=lv;if(b&&p){var A=g&&typeof g.as=="string"?g.as:"script",R='link[rel="modulepreload"][as="'+cn(A)+'"][href="'+cn(p)+'"]',z=R;switch(A){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":z=uv(p)}if(!_l.has(z)&&(p=u({rel:"modulepreload",href:p},g),_l.set(z,p),b.querySelector(R)===null)){switch(A){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(b.querySelector(m1(z)))return}A=b.createElement("link"),na(A,"link",p),er(A),b.head.appendChild(A)}}}function Bve(p,g,b){jd.S(p,g,b);var A=lv;if(A&&p){var R=Dt(A).hoistableStyles,z=cv(p);g=g||"default";var Q=R.get(z);if(!Q){var le={loading:0,preload:null};if(Q=A.querySelector(p1(z)))le.loading=5;else{p=u({rel:"stylesheet",href:p,"data-precedence":g},b),(b=_l.get(z))&&eR(p,b);var we=Q=A.createElement("link");er(we),na(we,"link",p),we._p=new Promise(function(Le,rt){we.onload=Le,we.onerror=rt}),we.addEventListener("load",function(){le.loading|=1}),we.addEventListener("error",function(){le.loading|=2}),le.loading|=4,PE(Q,g,A)}Q={type:"stylesheet",instance:Q,count:1,state:le},R.set(z,Q)}}}function Fve(p,g){jd.X(p,g);var b=lv;if(b&&p){var A=Dt(b).hoistableScripts,R=uv(p),z=A.get(R);z||(z=b.querySelector(m1(R)),z||(p=u({src:p,async:!0},g),(g=_l.get(R))&&tR(p,g),z=b.createElement("script"),er(z),na(z,"link",p),b.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},A.set(R,z))}}function Vve(p,g){jd.M(p,g);var b=lv;if(b&&p){var A=Dt(b).hoistableScripts,R=uv(p),z=A.get(R);z||(z=b.querySelector(m1(R)),z||(p=u({src:p,async:!0,type:"module"},g),(g=_l.get(R))&&tR(p,g),z=b.createElement("script"),er(z),na(z,"link",p),b.head.appendChild(z)),z={type:"script",instance:z,count:1,state:null},A.set(R,z))}}function V7(p,g,b,A){var R=(R=ie.current)?ME(R):null;if(!R)throw Error(i(446));switch(p){case"meta":case"title":return null;case"style":return typeof b.precedence=="string"&&typeof b.href=="string"?(g=cv(b.href),b=Dt(R).hoistableStyles,A=b.get(g),A||(A={type:"style",instance:null,count:0,state:null},b.set(g,A)),A):{type:"void",instance:null,count:0,state:null};case"link":if(b.rel==="stylesheet"&&typeof b.href=="string"&&typeof b.precedence=="string"){p=cv(b.href);var z=Dt(R).hoistableStyles,Q=z.get(p);if(Q||(R=R.ownerDocument||R,Q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},z.set(p,Q),(z=R.querySelector(p1(p)))&&!z._p&&(Q.instance=z,Q.state.loading=5),_l.has(p)||(b={rel:"preload",as:"style",href:b.href,crossOrigin:b.crossOrigin,integrity:b.integrity,media:b.media,hrefLang:b.hrefLang,referrerPolicy:b.referrerPolicy},_l.set(p,b),z||Uve(R,p,b,Q.state))),g&&A===null)throw Error(i(528,""));return Q}if(g&&A!==null)throw Error(i(529,""));return null;case"script":return g=b.async,b=b.src,typeof b=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=uv(b),b=Dt(R).hoistableScripts,A=b.get(g),A||(A={type:"script",instance:null,count:0,state:null},b.set(g,A)),A):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,p))}}function cv(p){return'href="'+cn(p)+'"'}function p1(p){return'link[rel="stylesheet"]['+p+"]"}function U7(p){return u({},p,{"data-precedence":p.precedence,precedence:null})}function Uve(p,g,b,A){p.querySelector('link[rel="preload"][as="style"]['+g+"]")?A.loading=1:(g=p.createElement("link"),A.preload=g,g.addEventListener("load",function(){return A.loading|=1}),g.addEventListener("error",function(){return A.loading|=2}),na(g,"link",b),er(g),p.head.appendChild(g))}function uv(p){return'[src="'+cn(p)+'"]'}function m1(p){return"script[async]"+p}function H7(p,g,b){if(g.count++,g.instance===null)switch(g.type){case"style":var A=p.querySelector('style[data-href~="'+cn(b.href)+'"]');if(A)return g.instance=A,er(A),A;var R=u({},b,{"data-href":b.href,"data-precedence":b.precedence,href:null,precedence:null});return A=(p.ownerDocument||p).createElement("style"),er(A),na(A,"style",R),PE(A,b.precedence,p),g.instance=A;case"stylesheet":R=cv(b.href);var z=p.querySelector(p1(R));if(z)return g.state.loading|=4,g.instance=z,er(z),z;A=U7(b),(R=_l.get(R))&&eR(A,R),z=(p.ownerDocument||p).createElement("link"),er(z);var Q=z;return Q._p=new Promise(function(le,we){Q.onload=le,Q.onerror=we}),na(z,"link",A),g.state.loading|=4,PE(z,b.precedence,p),g.instance=z;case"script":return z=uv(b.src),(R=p.querySelector(m1(z)))?(g.instance=R,er(R),R):(A=b,(R=_l.get(z))&&(A=u({},b),tR(A,R)),p=p.ownerDocument||p,R=p.createElement("script"),er(R),na(R,"link",A),p.head.appendChild(R),g.instance=R);case"void":return null;default:throw Error(i(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(A=g.instance,g.state.loading|=4,PE(A,b.precedence,p));return g.instance}function PE(p,g,b){for(var A=b.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),R=A.length?A[A.length-1]:null,z=R,Q=0;Q<A.length;Q++){var le=A[Q];if(le.dataset.precedence===g)z=le;else if(z!==R)break}z?z.parentNode.insertBefore(p,z.nextSibling):(g=b.nodeType===9?b.head:b,g.insertBefore(p,g.firstChild))}function eR(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.title==null&&(p.title=g.title)}function tR(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.integrity==null&&(p.integrity=g.integrity)}var DE=null;function G7(p,g,b){if(DE===null){var A=new Map,R=DE=new Map;R.set(b,A)}else R=DE,A=R.get(b),A||(A=new Map,R.set(b,A));if(A.has(p))return A;for(A.set(p,null),b=b.getElementsByTagName(p),R=0;R<b.length;R++){var z=b[R];if(!(z[ke]||z[$i]||p==="link"&&z.getAttribute("rel")==="stylesheet")&&z.namespaceURI!=="http://www.w3.org/2000/svg"){var Q=z.getAttribute(g)||"";Q=p+Q;var le=A.get(Q);le?le.push(z):A.set(Q,[z])}}return A}function W7(p,g,b){p=p.ownerDocument||p,p.head.insertBefore(b,g==="title"?p.querySelector("head > title"):null)}function Hve(p,g,b){if(b===1||g.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return p=g.disabled,typeof g.precedence=="string"&&p==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function q7(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}var g1=null;function Gve(){}function Wve(p,g,b){if(g1===null)throw Error(i(475));var A=g1;if(g.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var R=cv(b.href),z=p.querySelector(p1(R));if(z){p=z._p,p!==null&&typeof p=="object"&&typeof p.then=="function"&&(A.count++,A=NE.bind(A),p.then(A,A)),g.state.loading|=4,g.instance=z,er(z);return}z=p.ownerDocument||p,b=U7(b),(R=_l.get(R))&&eR(b,R),z=z.createElement("link"),er(z);var Q=z;Q._p=new Promise(function(le,we){Q.onload=le,Q.onerror=we}),na(z,"link",b),g.instance=z}A.stylesheets===null&&(A.stylesheets=new Map),A.stylesheets.set(g,p),(p=g.state.preload)&&(g.state.loading&3)===0&&(A.count++,g=NE.bind(A),p.addEventListener("load",g),p.addEventListener("error",g))}}function qve(){if(g1===null)throw Error(i(475));var p=g1;return p.stylesheets&&p.count===0&&rR(p,p.stylesheets),0<p.count?function(g){var b=setTimeout(function(){if(p.stylesheets&&rR(p,p.stylesheets),p.unsuspend){var A=p.unsuspend;p.unsuspend=null,A()}},6e4);return p.unsuspend=g,function(){p.unsuspend=null,clearTimeout(b)}}:null}function NE(){if(this.count--,this.count===0){if(this.stylesheets)rR(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var kE=null;function rR(p,g){p.stylesheets=null,p.unsuspend!==null&&(p.count++,kE=new Map,g.forEach(Yve,p),kE=null,NE.call(p))}function Yve(p,g){if(!(g.state.loading&4)){var b=kE.get(p);if(b)var A=b.get(null);else{b=new Map,kE.set(p,b);for(var R=p.querySelectorAll("link[data-precedence],style[data-precedence]"),z=0;z<R.length;z++){var Q=R[z];(Q.nodeName==="LINK"||Q.getAttribute("media")!=="not all")&&(b.set(Q.dataset.precedence,Q),A=Q)}A&&b.set(null,A)}R=g.instance,Q=R.getAttribute("data-precedence"),z=b.get(Q)||A,z===A&&b.set(null,R),b.set(Q,R),this.count++,A=NE.bind(this),R.addEventListener("load",A),R.addEventListener("error",A),z?z.parentNode.insertBefore(R,z.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(R,p.firstChild)),g.state.loading|=4}}var v1={$$typeof:S,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function Xve(p,g,b,A,R,z,Q,le){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=tt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tt(0),this.hiddenUpdates=tt(null),this.identifierPrefix=A,this.onUncaughtError=R,this.onCaughtError=z,this.onRecoverableError=Q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=le,this.incompleteTransitions=new Map}function Y7(p,g,b,A,R,z,Q,le,we,Le,rt,at){return p=new Xve(p,g,b,Q,le,we,Le,at),g=1,z===!0&&(g|=24),z=Ho(3,null,null,g),p.current=z,z.stateNode=p,g=LN(),g.refCount++,p.pooledCache=g,g.refCount++,z.memoizedState={element:A,isDehydrated:b,cache:g},VN(z),p}function X7(p){return p?(p=V0,p):V0}function $7(p,g,b,A,R,z){R=X7(R),A.context===null?A.context=R:A.pendingContext=R,A=af(g),A.payload={element:b},z=z===void 0?null:z,z!==null&&(A.callback=z),b=of(p,A,g),b!==null&&(Xo(b,p,g),Yb(b,p,g))}function K7(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var b=p.retryLane;p.retryLane=b!==0&&b<g?b:g}}function iR(p,g){K7(p,g),(p=p.alternate)&&K7(p,g)}function Q7(p){if(p.tag===13){var g=F0(p,67108864);g!==null&&Xo(g,p,67108864),iR(p,67108864)}}var RE=!0;function $ve(p,g,b,A){var R=G.T;G.T=null;var z=Y.p;try{Y.p=2,nR(p,g,b,A)}finally{Y.p=z,G.T=R}}function Kve(p,g,b,A){var R=G.T;G.T=null;var z=Y.p;try{Y.p=8,nR(p,g,b,A)}finally{Y.p=z,G.T=R}}function nR(p,g,b,A){if(RE){var R=sR(A);if(R===null)Wk(p,g,A,IE,b),J7(p,A);else if(Zve(R,p,g,b,A))A.stopPropagation();else if(J7(p,A),g&4&&-1<Qve.indexOf(p)){for(;R!==null;){var z=Gt(R);if(z!==null)switch(z.tag){case 3:if(z=z.stateNode,z.current.memoizedState.isDehydrated){var Q=qe(z.pendingLanes);if(Q!==0){var le=z;for(le.pendingLanes|=2,le.entangledLanes|=2;Q;){var we=1<<31-Ue(Q);le.entanglements[1]|=we,Q&=~we}cu(z),(Ti&6)===0&&(vE=dt()+500,u1(0))}}break;case 13:le=F0(z,2),le!==null&&Xo(le,z,2),xE(),iR(z,2)}if(z=sR(A),z===null&&Wk(p,g,A,IE,b),z===R)break;R=z}R!==null&&A.stopPropagation()}else Wk(p,g,A,null,b)}}function sR(p){return p=fl(p),aR(p)}var IE=null;function aR(p){if(IE=null,p=Tt(p),p!==null){var g=s(p);if(g===null)p=null;else{var b=g.tag;if(b===13){if(p=a(g),p!==null)return p;p=null}else if(b===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;p=null}else g!==p&&(p=null)}}return IE=p,null}function Z7(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ct()){case ut:return 2;case me:return 8;case _e:case te:return 32;case J:return 268435456;default:return 32}default:return 32}}var oR=!1,bf=null,wf=null,_f=null,y1=new Map,x1=new Map,Sf=[],Qve="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function J7(p,g){switch(p){case"focusin":case"focusout":bf=null;break;case"dragenter":case"dragleave":wf=null;break;case"mouseover":case"mouseout":_f=null;break;case"pointerover":case"pointerout":y1.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":x1.delete(g.pointerId)}}function b1(p,g,b,A,R,z){return p===null||p.nativeEvent!==z?(p={blockedOn:g,domEventName:b,eventSystemFlags:A,nativeEvent:z,targetContainers:[R]},g!==null&&(g=Gt(g),g!==null&&Q7(g)),p):(p.eventSystemFlags|=A,g=p.targetContainers,R!==null&&g.indexOf(R)===-1&&g.push(R),p)}function Zve(p,g,b,A,R){switch(g){case"focusin":return bf=b1(bf,p,g,b,A,R),!0;case"dragenter":return wf=b1(wf,p,g,b,A,R),!0;case"mouseover":return _f=b1(_f,p,g,b,A,R),!0;case"pointerover":var z=R.pointerId;return y1.set(z,b1(y1.get(z)||null,p,g,b,A,R)),!0;case"gotpointercapture":return z=R.pointerId,x1.set(z,b1(x1.get(z)||null,p,g,b,A,R)),!0}return!1}function eH(p){var g=Tt(p.target);if(g!==null){var b=s(g);if(b!==null){if(g=b.tag,g===13){if(g=a(b),g!==null){p.blockedOn=g,Sa(p.priority,function(){if(b.tag===13){var A=Yo();A=Hi(A);var R=F0(b,A);R!==null&&Xo(R,b,A),iR(b,A)}});return}}else if(g===3&&b.stateNode.current.memoizedState.isDehydrated){p.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}p.blockedOn=null}function OE(p){if(p.blockedOn!==null)return!1;for(var g=p.targetContainers;0<g.length;){var b=sR(p.nativeEvent);if(b===null){b=p.nativeEvent;var A=new b.constructor(b.type,b);yd=A,b.target.dispatchEvent(A),yd=null}else return g=Gt(b),g!==null&&Q7(g),p.blockedOn=b,!1;g.shift()}return!0}function tH(p,g,b){OE(p)&&b.delete(g)}function Jve(){oR=!1,bf!==null&&OE(bf)&&(bf=null),wf!==null&&OE(wf)&&(wf=null),_f!==null&&OE(_f)&&(_f=null),y1.forEach(tH),x1.forEach(tH)}function jE(p,g){p.blockedOn===g&&(p.blockedOn=null,oR||(oR=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Jve)))}var LE=null;function rH(p){LE!==p&&(LE=p,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){LE===p&&(LE=null);for(var g=0;g<p.length;g+=3){var b=p[g],A=p[g+1],R=p[g+2];if(typeof A!="function"){if(aR(A||b)===null)continue;break}var z=Gt(b);z!==null&&(p.splice(g,3),g-=3,ak(z,{pending:!0,data:R,method:b.method,action:A},A,R))}}))}function w1(p){function g(we){return jE(we,p)}bf!==null&&jE(bf,p),wf!==null&&jE(wf,p),_f!==null&&jE(_f,p),y1.forEach(g),x1.forEach(g);for(var b=0;b<Sf.length;b++){var A=Sf[b];A.blockedOn===p&&(A.blockedOn=null)}for(;0<Sf.length&&(b=Sf[0],b.blockedOn===null);)eH(b),b.blockedOn===null&&Sf.shift();if(b=(p.ownerDocument||p).$$reactFormReplay,b!=null)for(A=0;A<b.length;A+=3){var R=b[A],z=b[A+1],Q=R[ln]||null;if(typeof z=="function")Q||rH(b);else if(Q){var le=null;if(z&&z.hasAttribute("formAction")){if(R=z,Q=z[ln]||null)le=Q.formAction;else if(aR(R)!==null)continue}else le=Q.action;typeof le=="function"?b[A+1]=le:(b.splice(A,3),A-=3),rH(b)}}}function lR(p){this._internalRoot=p}zE.prototype.render=lR.prototype.render=function(p){var g=this._internalRoot;if(g===null)throw Error(i(409));var b=g.current,A=Yo();$7(b,A,p,g,null,null)},zE.prototype.unmount=lR.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var g=p.containerInfo;$7(p.current,2,null,p,null,null),xE(),g[Ea]=null}};function zE(p){this._internalRoot=p}zE.prototype.unstable_scheduleHydration=function(p){if(p){var g=ei();p={blockedOn:null,target:p,priority:g};for(var b=0;b<Sf.length&&g!==0&&g<Sf[b].priority;b++);Sf.splice(b,0,p),b===0&&eH(p)}};var iH=t.version;if(iH!=="19.1.0")throw Error(i(527,iH,"19.1.0"));Y.findDOMNode=function(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(i(188)):(p=Object.keys(p).join(","),Error(i(268,p)));return p=l(g),p=p!==null?c(p):null,p=p===null?null:p.stateNode,p};var eye={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var BE=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!BE.isDisabled&&BE.supportsFiber)try{W=BE.inject(eye),Se=BE}catch{}}return S1.createRoot=function(p,g){if(!n(p))throw Error(i(299));var b=!1,A="",R=x9,z=b9,Q=w9,le=null;return g!=null&&(g.unstable_strictMode===!0&&(b=!0),g.identifierPrefix!==void 0&&(A=g.identifierPrefix),g.onUncaughtError!==void 0&&(R=g.onUncaughtError),g.onCaughtError!==void 0&&(z=g.onCaughtError),g.onRecoverableError!==void 0&&(Q=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(le=g.unstable_transitionCallbacks)),g=Y7(p,1,!1,null,null,b,A,R,z,Q,le,null),p[Ea]=g.current,Gk(p),new lR(g)},S1.hydrateRoot=function(p,g,b){if(!n(p))throw Error(i(299));var A=!1,R="",z=x9,Q=b9,le=w9,we=null,Le=null;return b!=null&&(b.unstable_strictMode===!0&&(A=!0),b.identifierPrefix!==void 0&&(R=b.identifierPrefix),b.onUncaughtError!==void 0&&(z=b.onUncaughtError),b.onCaughtError!==void 0&&(Q=b.onCaughtError),b.onRecoverableError!==void 0&&(le=b.onRecoverableError),b.unstable_transitionCallbacks!==void 0&&(we=b.unstable_transitionCallbacks),b.formState!==void 0&&(Le=b.formState)),g=Y7(p,1,!0,g,b??null,A,R,z,Q,le,we,Le),g.context=X7(null),b=g.current,A=Yo(),A=Hi(A),R=af(A),R.callback=null,of(b,R,A),b=A,g.current.lanes=b,xt(g,b),cu(g),p[Ea]=g.current,Gk(p),new zE(g)},S1.version="19.1.0",S1}var fH;function uye(){if(fH)return dR.exports;fH=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),dR.exports=cye(),dR.exports}var dye=uye(),E1={},pH;function hye(){if(pH)return E1;pH=1,Object.defineProperty(E1,"__esModule",{value:!0}),E1.parse=a,E1.serialize=c;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,n=Object.prototype.toString,s=(()=>{const f=function(){};return f.prototype=Object.create(null),f})();function a(f,m){const v=new s,y=f.length;if(y<2)return v;const x=m?.decode||u;let w=0;do{const _=f.indexOf("=",w);if(_===-1)break;const S=f.indexOf(";",w),P=S===-1?y:S;if(_>P){w=f.lastIndexOf(";",_-1)+1;continue}const M=o(f,w,_),C=l(f,_,M),T=f.slice(M,C);if(v[T]===void 0){let E=o(f,_+1,P),N=l(f,P,E);const D=x(f.slice(E,N));v[T]=D}w=P+1}while(w<y);return v}function o(f,m,v){do{const y=f.charCodeAt(m);if(y!==32&&y!==9)return m}while(++m<v);return v}function l(f,m,v){for(;m>v;){const y=f.charCodeAt(--m);if(y!==32&&y!==9)return m+1}return v}function c(f,m,v){const y=v?.encode||encodeURIComponent;if(!e.test(f))throw new TypeError(`argument name is invalid: ${f}`);const x=y(m);if(!t.test(x))throw new TypeError(`argument val is invalid: ${m}`);let w=f+"="+x;if(!v)return w;if(v.maxAge!==void 0){if(!Number.isInteger(v.maxAge))throw new TypeError(`option maxAge is invalid: ${v.maxAge}`);w+="; Max-Age="+v.maxAge}if(v.domain){if(!r.test(v.domain))throw new TypeError(`option domain is invalid: ${v.domain}`);w+="; Domain="+v.domain}if(v.path){if(!i.test(v.path))throw new TypeError(`option path is invalid: ${v.path}`);w+="; Path="+v.path}if(v.expires){if(!d(v.expires)||!Number.isFinite(v.expires.valueOf()))throw new TypeError(`option expires is invalid: ${v.expires}`);w+="; Expires="+v.expires.toUTCString()}if(v.httpOnly&&(w+="; HttpOnly"),v.secure&&(w+="; Secure"),v.partitioned&&(w+="; Partitioned"),v.priority)switch(typeof v.priority=="string"?v.priority.toLowerCase():void 0){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${v.priority}`)}if(v.sameSite)switch(typeof v.sameSite=="string"?v.sameSite.toLowerCase():v.sameSite){case!0:case"strict":w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"none":w+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${v.sameSite}`)}return w}function u(f){if(f.indexOf("%")===-1)return f;try{return decodeURIComponent(f)}catch{return f}}function d(f){return n.call(f)==="[object Date]"}return E1}hye();var mH="popstate";function fye(e={}){function t(i,n){let{pathname:s,search:a,hash:o}=i.location;return uj("",{pathname:s,search:a,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(i,n){return typeof n=="string"?n:S2(n)}return mye(t,r,null,e)}function hn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Lc(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function pye(){return Math.random().toString(36).substring(2,10)}function gH(e,t){return{usr:e.state,key:e.key,idx:t}}function uj(e,t,r=null,i){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?zx(t):t,state:r,key:t&&t.key||i||pye()}}function S2({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function zx(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function mye(e,t,r,i={}){let{window:n=document.defaultView,v5Compat:s=!1}=i,a=n.history,o="POP",l=null,c=u();c==null&&(c=0,a.replaceState({...a.state,idx:c},""));function u(){return(a.state||{idx:null}).idx}function d(){o="POP";let x=u(),w=x==null?null:x-c;c=x,l&&l({action:o,location:y.location,delta:w})}function f(x,w){o="PUSH";let _=uj(y.location,x,w);c=u()+1;let S=gH(_,c),P=y.createHref(_);try{a.pushState(S,"",P)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;n.location.assign(P)}s&&l&&l({action:o,location:y.location,delta:1})}function m(x,w){o="REPLACE";let _=uj(y.location,x,w);c=u();let S=gH(_,c),P=y.createHref(_);a.replaceState(S,"",P),s&&l&&l({action:o,location:y.location,delta:0})}function v(x){return gye(x)}let y={get action(){return o},get location(){return e(n,a)},listen(x){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(mH,d),l=x,()=>{n.removeEventListener(mH,d),l=null}},createHref(x){return t(n,x)},createURL:v,encodeLocation(x){let w=v(x);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:f,replace:m,go(x){return a.go(x)}};return y}function gye(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),hn(r,"No window.location.(origin|href) available to create URL");let i=typeof e=="string"?e:S2(e);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=r+i),new URL(i,r)}function Qte(e,t,r="/"){return vye(e,t,r,!1)}function vye(e,t,r,i){let n=typeof t=="string"?zx(t):t,s=Nh(n.pathname||"/",r);if(s==null)return null;let a=Zte(e);yye(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=Pye(s);o=Tye(a[l],c,i)}return o}function Zte(e,t=[],r=[],i=""){let n=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(hn(l.relativePath.startsWith(i),`Absolute route path "${l.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(i.length));let c=Ah([i,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(hn(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),Zte(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:Aye(c,s.index),routesMeta:u})};return e.forEach((s,a)=>{if(s.path===""||!s.path?.includes("?"))n(s,a);else for(let o of Jte(s.path))n(s,a,o)}),t}function Jte(e){let t=e.split("/");if(t.length===0)return[];let[r,...i]=t,n=r.endsWith("?"),s=r.replace(/\?$/,"");if(i.length===0)return n?[s,""]:[s];let a=Jte(i.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),n&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function yye(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Cye(t.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}var xye=/^:[\w-]+$/,bye=3,wye=2,_ye=1,Sye=10,Eye=-2,vH=e=>e==="*";function Aye(e,t){let r=e.split("/"),i=r.length;return r.some(vH)&&(i+=Eye),t&&(i+=wye),r.filter(n=>!vH(n)).reduce((n,s)=>n+(xye.test(s)?bye:s===""?_ye:Sye),i)}function Cye(e,t){return e.length===t.length&&e.slice(0,-1).every((i,n)=>i===t[n])?e[e.length-1]-t[t.length-1]:0}function Tye(e,t,r=!1){let{routesMeta:i}=e,n={},s="/",a=[];for(let o=0;o<i.length;++o){let l=i[o],c=o===i.length-1,u=s==="/"?t:t.slice(s.length)||"/",d=YT({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!d&&c&&r&&!i[i.length-1].route.index&&(d=YT({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(n,d.params),a.push({params:n,pathname:Ah([s,d.pathname]),pathnameBase:Rye(Ah([s,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(s=Ah([s,d.pathnameBase]))}return a}function YT(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,i]=Mye(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let s=n[0],a=s.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:i.reduce((c,{paramName:u,isOptional:d},f)=>{if(u==="*"){let v=o[f]||"";a=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const m=o[f];return d&&!m?c[u]=void 0:c[u]=(m||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:a,pattern:e}}function Mye(e,t=!1,r=!0){Lc(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let i=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(i.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),i]}function Pye(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Lc(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Nh(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,i=e.charAt(r);return i&&i!=="/"?null:e.slice(r)||"/"}function Dye(e,t="/"){let{pathname:r,search:i="",hash:n=""}=typeof e=="string"?zx(e):e;return{pathname:r?r.startsWith("/")?r:Nye(r,t):t,search:Iye(i),hash:Oye(n)}}function Nye(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function mR(e,t,r,i){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function kye(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function _6(e){let t=kye(e);return t.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase)}function S6(e,t,r,i=!1){let n;typeof e=="string"?n=zx(e):(n={...e},hn(!n.pathname||!n.pathname.includes("?"),mR("?","pathname","search",n)),hn(!n.pathname||!n.pathname.includes("#"),mR("#","pathname","hash",n)),hn(!n.search||!n.search.includes("#"),mR("#","search","hash",n)));let s=e===""||n.pathname==="",a=s?"/":n.pathname,o;if(a==null)o=r;else{let d=t.length-1;if(!i&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;n.pathname=f.join("/")}o=d>=0?t[d]:"/"}let l=Dye(n,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var Ah=e=>e.join("/").replace(/\/\/+/g,"/"),Rye=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Iye=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Oye=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function jye(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var ere=["POST","PUT","PATCH","DELETE"];new Set(ere);var Lye=["GET",...ere];new Set(Lye);var Bx=O.createContext(null);Bx.displayName="DataRouter";var p3=O.createContext(null);p3.displayName="DataRouterState";var tre=O.createContext({isTransitioning:!1});tre.displayName="ViewTransition";var zye=O.createContext(new Map);zye.displayName="Fetchers";var Bye=O.createContext(null);Bye.displayName="Await";var Wc=O.createContext(null);Wc.displayName="Navigation";var A_=O.createContext(null);A_.displayName="Location";var Kl=O.createContext({outlet:null,matches:[],isDataRoute:!1});Kl.displayName="Route";var E6=O.createContext(null);E6.displayName="RouteError";function Fye(e,{relative:t}={}){hn(Fx(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:i}=O.useContext(Wc),{hash:n,pathname:s,search:a}=C_(e,{relative:t}),o=s;return r!=="/"&&(o=s==="/"?r:Ah([r,s])),i.createHref({pathname:o,search:a,hash:n})}function Fx(){return O.useContext(A_)!=null}function dd(){return hn(Fx(),"useLocation() may be used only in the context of a <Router> component."),O.useContext(A_).location}var rre="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ire(e){O.useContext(Wc).static||O.useLayoutEffect(e)}function fs(){let{isDataRoute:e}=O.useContext(Kl);return e?txe():Vye()}function Vye(){hn(Fx(),"useNavigate() may be used only in the context of a <Router> component.");let e=O.useContext(Bx),{basename:t,navigator:r}=O.useContext(Wc),{matches:i}=O.useContext(Kl),{pathname:n}=dd(),s=JSON.stringify(_6(i)),a=O.useRef(!1);return ire(()=>{a.current=!0}),O.useCallback((l,c={})=>{if(Lc(a.current,rre),!a.current)return;if(typeof l=="number"){r.go(l);return}let u=S6(l,JSON.parse(s),n,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Ah([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,s,n,e])}var Uye=O.createContext(null);function Hye(e){let t=O.useContext(Kl).outlet;return t&&O.createElement(Uye.Provider,{value:e},t)}function Qp(){let{matches:e}=O.useContext(Kl),t=e[e.length-1];return t?t.params:{}}function C_(e,{relative:t}={}){let{matches:r}=O.useContext(Kl),{pathname:i}=dd(),n=JSON.stringify(_6(r));return O.useMemo(()=>S6(e,JSON.parse(n),i,t==="path"),[e,n,i,t])}function Gye(e,t){return nre(e,t)}function nre(e,t,r,i){hn(Fx(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n}=O.useContext(Wc),{matches:s}=O.useContext(Kl),a=s[s.length-1],o=a?a.params:{},l=a?a.pathname:"/",c=a?a.pathnameBase:"/",u=a&&a.route;{let w=u&&u.path||"";sre(l,!u||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let d=dd(),f;if(t){let w=typeof t=="string"?zx(t):t;hn(c==="/"||w.pathname?.startsWith(c),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${w.pathname}" was given in the \`location\` prop.`),f=w}else f=d;let m=f.pathname||"/",v=m;if(c!=="/"){let w=c.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(w.length).join("/")}let y=Qte(e,{pathname:v});Lc(u||y!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Lc(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=$ye(y&&y.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Ah([c,n.encodeLocation?n.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:Ah([c,n.encodeLocation?n.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),s,r,i);return t&&x?O.createElement(A_.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},x):x}function Wye(){let e=exe(),t=jye(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},a=null;return console.error("Error handled by React Router default ErrorBoundary:",e),a=O.createElement(O.Fragment,null,O.createElement("p",null,"💿 Hey developer 👋"),O.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",O.createElement("code",{style:s},"ErrorBoundary")," or"," ",O.createElement("code",{style:s},"errorElement")," prop on your route.")),O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},t),r?O.createElement("pre",{style:n},r):null,a)}var qye=O.createElement(Wye,null),Yye=class extends O.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?O.createElement(Kl.Provider,{value:this.props.routeContext},O.createElement(E6.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Xye({routeContext:e,match:t,children:r}){let i=O.useContext(Bx);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),O.createElement(Kl.Provider,{value:e},r)}function $ye(e,t=[],r=null,i=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let n=e,s=r?.errors;if(s!=null){let l=n.findIndex(c=>c.route.id&&s?.[c.route.id]!==void 0);hn(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),n=n.slice(0,Math.min(n.length,l+1))}let a=!1,o=-1;if(r)for(let l=0;l<n.length;l++){let c=n[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(o=l),c.route.id){let{loaderData:u,errors:d}=r,f=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!d||d[c.route.id]===void 0);if(c.route.lazy||f){a=!0,o>=0?n=n.slice(0,o+1):n=[n[0]];break}}}return n.reduceRight((l,c,u)=>{let d,f=!1,m=null,v=null;r&&(d=s&&c.route.id?s[c.route.id]:void 0,m=c.route.errorElement||qye,a&&(o<0&&u===0?(sre("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,v=null):o===u&&(f=!0,v=c.route.hydrateFallbackElement||null)));let y=t.concat(n.slice(0,u+1)),x=()=>{let w;return d?w=m:f?w=v:c.route.Component?w=O.createElement(c.route.Component,null):c.route.element?w=c.route.element:w=l,O.createElement(Xye,{match:c,routeContext:{outlet:l,matches:y,isDataRoute:r!=null},children:w})};return r&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?O.createElement(Yye,{location:r.location,revalidation:r.revalidation,component:m,error:d,children:x(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):x()},null)}function A6(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Kye(e){let t=O.useContext(Bx);return hn(t,A6(e)),t}function Qye(e){let t=O.useContext(p3);return hn(t,A6(e)),t}function Zye(e){let t=O.useContext(Kl);return hn(t,A6(e)),t}function C6(e){let t=Zye(e),r=t.matches[t.matches.length-1];return hn(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function Jye(){return C6("useRouteId")}function exe(){let e=O.useContext(E6),t=Qye("useRouteError"),r=C6("useRouteError");return e!==void 0?e:t.errors?.[r]}function txe(){let{router:e}=Kye("useNavigate"),t=C6("useNavigate"),r=O.useRef(!1);return ire(()=>{r.current=!0}),O.useCallback(async(n,s={})=>{Lc(r.current,rre),r.current&&(typeof n=="number"?e.navigate(n):await e.navigate(n,{fromRouteId:t,...s}))},[e,t])}var yH={};function sre(e,t,r){!t&&!yH[e]&&(yH[e]=!0,Lc(!1,r))}O.memo(rxe);function rxe({routes:e,future:t,state:r}){return nre(e,void 0,r,t)}function dv({to:e,replace:t,state:r,relative:i}){hn(Fx(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=O.useContext(Wc);Lc(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=O.useContext(Kl),{pathname:a}=dd(),o=fs(),l=S6(e,_6(s),a,i==="path"),c=JSON.stringify(l);return O.useEffect(()=>{o(JSON.parse(c),{replace:t,state:r,relative:i})},[o,c,i,t,r]),null}function are(e){return Hye(e.context)}function oi(e){hn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ixe({basename:e="/",children:t=null,location:r,navigationType:i="POP",navigator:n,static:s=!1}){hn(!Fx(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=e.replace(/^\/*/,"/"),o=O.useMemo(()=>({basename:a,navigator:n,static:s,future:{}}),[a,n,s]);typeof r=="string"&&(r=zx(r));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:f="default"}=r,m=O.useMemo(()=>{let v=Nh(l,a);return v==null?null:{location:{pathname:v,search:c,hash:u,state:d,key:f},navigationType:i}},[a,l,c,u,d,f,i]);return Lc(m!=null,`<Router basename="${a}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:O.createElement(Wc.Provider,{value:o},O.createElement(A_.Provider,{children:t,value:m}))}function nxe({children:e,location:t}){return Gye(dj(e),t)}function dj(e,t=[]){let r=[];return O.Children.forEach(e,(i,n)=>{if(!O.isValidElement(i))return;let s=[...t,n];if(i.type===O.Fragment){r.push.apply(r,dj(i.props.children,s));return}hn(i.type===oi,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let a={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=dj(i.props.children,s)),r.push(a)}),r}var YC="get",XC="application/x-www-form-urlencoded";function m3(e){return e!=null&&typeof e.tagName=="string"}function sxe(e){return m3(e)&&e.tagName.toLowerCase()==="button"}function axe(e){return m3(e)&&e.tagName.toLowerCase()==="form"}function oxe(e){return m3(e)&&e.tagName.toLowerCase()==="input"}function lxe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function cxe(e,t){return e.button===0&&(!t||t==="_self")&&!lxe(e)}var VE=null;function uxe(){if(VE===null)try{new FormData(document.createElement("form"),0),VE=!1}catch{VE=!0}return VE}var dxe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function gR(e){return e!=null&&!dxe.has(e)?(Lc(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${XC}"`),null):e}function hxe(e,t){let r,i,n,s,a;if(axe(e)){let o=e.getAttribute("action");i=o?Nh(o,t):null,r=e.getAttribute("method")||YC,n=gR(e.getAttribute("enctype"))||XC,s=new FormData(e)}else if(sxe(e)||oxe(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||o.getAttribute("action");if(i=l?Nh(l,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||YC,n=gR(e.getAttribute("formenctype"))||gR(o.getAttribute("enctype"))||XC,s=new FormData(o,e),!uxe()){let{name:c,type:u,value:d}=e;if(u==="image"){let f=c?`${c}.`:"";s.append(`${f}x`,"0"),s.append(`${f}y`,"0")}else c&&s.append(c,d)}}else{if(m3(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=YC,i=null,n=XC,a=e}return s&&n==="text/plain"&&(a=s,s=void 0),{action:i,method:r.toLowerCase(),encType:n,formData:s,body:a}}function T6(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function fxe(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function pxe(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function mxe(e,t,r){let i=await Promise.all(e.map(async n=>{let s=t.routes[n.route.id];if(s){let a=await fxe(s,r);return a.links?a.links():[]}return[]}));return xxe(i.flat(1).filter(pxe).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function xH(e,t,r,i,n,s){let a=(l,c)=>r[c]?l.route.id!==r[c].route.id:!0,o=(l,c)=>r[c].pathname!==l.pathname||r[c].route.path?.endsWith("*")&&r[c].params["*"]!==l.params["*"];return s==="assets"?t.filter((l,c)=>a(l,c)||o(l,c)):s==="data"?t.filter((l,c)=>{let u=i.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(a(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let d=l.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function gxe(e,t,{includeHydrateFallback:r}={}){return vxe(e.map(i=>{let n=t.routes[i.route.id];if(!n)return[];let s=[n.module];return n.clientActionModule&&(s=s.concat(n.clientActionModule)),n.clientLoaderModule&&(s=s.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(s=s.concat(n.hydrateFallbackModule)),n.imports&&(s=s.concat(n.imports)),s}).flat(1))}function vxe(e){return[...new Set(e)]}function yxe(e){let t={},r=Object.keys(e).sort();for(let i of r)t[i]=e[i];return t}function xxe(e,t){let r=new Set;return new Set(t),e.reduce((i,n)=>{let s=JSON.stringify(yxe(n));return r.has(s)||(r.add(s),i.push({key:s,link:n})),i},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var bxe=new Set([100,101,204,205]);function wxe(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&Nh(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function ore(){let e=O.useContext(Bx);return T6(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function _xe(){let e=O.useContext(p3);return T6(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var M6=O.createContext(void 0);M6.displayName="FrameworkContext";function lre(){let e=O.useContext(M6);return T6(e,"You must render this element inside a <HydratedRouter> element"),e}function Sxe(e,t){let r=O.useContext(M6),[i,n]=O.useState(!1),[s,a]=O.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=t,f=O.useRef(null);O.useEffect(()=>{if(e==="render"&&a(!0),e==="viewport"){let y=w=>{w.forEach(_=>{a(_.isIntersecting)})},x=new IntersectionObserver(y,{threshold:.5});return f.current&&x.observe(f.current),()=>{x.disconnect()}}},[e]),O.useEffect(()=>{if(i){let y=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(y)}}},[i]);let m=()=>{n(!0)},v=()=>{n(!1),a(!1)};return r?e!=="intent"?[s,f,{}]:[s,f,{onFocus:A1(o,m),onBlur:A1(l,v),onMouseEnter:A1(c,m),onMouseLeave:A1(u,v),onTouchStart:A1(d,m)}]:[!1,f,{}]}function A1(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function Exe({page:e,...t}){let{router:r}=ore(),i=O.useMemo(()=>Qte(r.routes,e,r.basename),[r.routes,e,r.basename]);return i?O.createElement(Cxe,{page:e,matches:i,...t}):null}function Axe(e){let{manifest:t,routeModules:r}=lre(),[i,n]=O.useState([]);return O.useEffect(()=>{let s=!1;return mxe(e,t,r).then(a=>{s||n(a)}),()=>{s=!0}},[e,t,r]),i}function Cxe({page:e,matches:t,...r}){let i=dd(),{manifest:n,routeModules:s}=lre(),{basename:a}=ore(),{loaderData:o,matches:l}=_xe(),c=O.useMemo(()=>xH(e,t,l,n,i,"data"),[e,t,l,n,i]),u=O.useMemo(()=>xH(e,t,l,n,i,"assets"),[e,t,l,n,i]),d=O.useMemo(()=>{if(e===i.pathname+i.search+i.hash)return[];let v=new Set,y=!1;if(t.forEach(w=>{let _=n.routes[w.route.id];!_||!_.hasLoader||(!c.some(S=>S.route.id===w.route.id)&&w.route.id in o&&s[w.route.id]?.shouldRevalidate||_.hasClientLoader?y=!0:v.add(w.route.id))}),v.size===0)return[];let x=wxe(e,a);return y&&v.size>0&&x.searchParams.set("_routes",t.filter(w=>v.has(w.route.id)).map(w=>w.route.id).join(",")),[x.pathname+x.search]},[a,o,i,n,c,t,e,s]),f=O.useMemo(()=>gxe(u,n),[u,n]),m=Axe(u);return O.createElement(O.Fragment,null,d.map(v=>O.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...r})),f.map(v=>O.createElement("link",{key:v,rel:"modulepreload",href:v,...r})),m.map(({key:v,link:y})=>O.createElement("link",{key:v,...y})))}function Txe(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var cre=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{cre&&(window.__reactRouterVersion="7.6.3")}catch{}function Mxe({basename:e,children:t,window:r}){let i=O.useRef();i.current==null&&(i.current=fye({window:r,v5Compat:!0}));let n=i.current,[s,a]=O.useState({action:n.action,location:n.location}),o=O.useCallback(l=>{O.startTransition(()=>a(l))},[a]);return O.useLayoutEffect(()=>n.listen(o),[n,o]),O.createElement(ixe,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:n})}var ure=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hr=O.forwardRef(function({onClick:t,discover:r="render",prefetch:i="none",relative:n,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:u,viewTransition:d,...f},m){let{basename:v}=O.useContext(Wc),y=typeof c=="string"&&ure.test(c),x,w=!1;if(typeof c=="string"&&y&&(x=c,cre))try{let N=new URL(window.location.href),D=c.startsWith("//")?new URL(N.protocol+c):new URL(c),I=Nh(D.pathname,v);D.origin===N.origin&&I!=null?c=I+D.search+D.hash:w=!0}catch{Lc(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=Fye(c,{relative:n}),[S,P,M]=Sxe(i,f),C=Nxe(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:n,viewTransition:d});function T(N){t&&t(N),N.defaultPrevented||C(N)}let E=O.createElement("a",{...f,...M,href:x||_,onClick:w||s?t:T,ref:Txe(m,P),target:l,"data-discover":!y&&r==="render"?"true":void 0});return S&&!y?O.createElement(O.Fragment,null,E,O.createElement(Exe,{page:_})):E});hr.displayName="Link";var hj=O.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:i="",end:n=!1,style:s,to:a,viewTransition:o,children:l,...c},u){let d=C_(a,{relative:c.relative}),f=dd(),m=O.useContext(p3),{navigator:v,basename:y}=O.useContext(Wc),x=m!=null&&jxe(d)&&o===!0,w=v.encodeLocation?v.encodeLocation(d).pathname:d.pathname,_=f.pathname,S=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;r||(_=_.toLowerCase(),S=S?S.toLowerCase():null,w=w.toLowerCase()),S&&y&&(S=Nh(S,y)||S);const P=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let M=_===w||!n&&_.startsWith(w)&&_.charAt(P)==="/",C=S!=null&&(S===w||!n&&S.startsWith(w)&&S.charAt(w.length)==="/"),T={isActive:M,isPending:C,isTransitioning:x},E=M?t:void 0,N;typeof i=="function"?N=i(T):N=[i,M?"active":null,C?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let D=typeof s=="function"?s(T):s;return O.createElement(hr,{...c,"aria-current":E,className:N,ref:u,style:D,to:a,viewTransition:o},typeof l=="function"?l(T):l)});hj.displayName="NavLink";var Pxe=O.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:i,replace:n,state:s,method:a=YC,action:o,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,...f},m)=>{let v=Ixe(),y=Oxe(o,{relative:c}),x=a.toLowerCase()==="get"?"get":"post",w=typeof o=="string"&&ure.test(o),_=S=>{if(l&&l(S),S.defaultPrevented)return;S.preventDefault();let P=S.nativeEvent.submitter,M=P?.getAttribute("formmethod")||a;v(P||S.currentTarget,{fetcherKey:t,method:M,navigate:r,replace:n,state:s,relative:c,preventScrollReset:u,viewTransition:d})};return O.createElement("form",{ref:m,method:x,action:y,onSubmit:i?l:_,...f,"data-discover":!w&&e==="render"?"true":void 0})});Pxe.displayName="Form";function Dxe(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function dre(e){let t=O.useContext(Bx);return hn(t,Dxe(e)),t}function Nxe(e,{target:t,replace:r,state:i,preventScrollReset:n,relative:s,viewTransition:a}={}){let o=fs(),l=dd(),c=C_(e,{relative:s});return O.useCallback(u=>{if(cxe(u,t)){u.preventDefault();let d=r!==void 0?r:S2(l)===S2(c);o(e,{replace:d,state:i,preventScrollReset:n,relative:s,viewTransition:a})}},[l,o,c,r,i,t,e,n,s,a])}var kxe=0,Rxe=()=>`__${String(++kxe)}__`;function Ixe(){let{router:e}=dre("useSubmit"),{basename:t}=O.useContext(Wc),r=Jye();return O.useCallback(async(i,n={})=>{let{action:s,method:a,encType:o,formData:l,body:c}=hxe(i,t);if(n.navigate===!1){let u=n.fetcherKey||Rxe();await e.fetch(u,r,n.action||s,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||a,formEncType:n.encType||o,flushSync:n.flushSync})}else await e.navigate(n.action||s,{preventScrollReset:n.preventScrollReset,formData:l,body:c,formMethod:n.method||a,formEncType:n.encType||o,replace:n.replace,state:n.state,fromRouteId:r,flushSync:n.flushSync,viewTransition:n.viewTransition})},[e,t,r])}function Oxe(e,{relative:t}={}){let{basename:r}=O.useContext(Wc),i=O.useContext(Kl);hn(i,"useFormAction must be used inside a RouteContext");let[n]=i.matches.slice(-1),s={...C_(e||".",{relative:t})},a=dd();if(e==null){s.search=a.search;let o=new URLSearchParams(s.search),l=o.getAll("index");if(l.some(u=>u==="")){o.delete("index"),l.filter(d=>d).forEach(d=>o.append("index",d));let u=o.toString();s.search=u?`?${u}`:""}}return(!e||e===".")&&n.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:Ah([r,s.pathname])),S2(s)}function jxe(e,t={}){let r=O.useContext(tre);hn(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=dre("useViewTransitionState"),n=C_(e,{relative:t.relative});if(!r.isTransitioning)return!1;let s=Nh(r.currentLocation.pathname,i)||r.currentLocation.pathname,a=Nh(r.nextLocation.pathname,i)||r.nextLocation.pathname;return YT(n.pathname,a)!=null||YT(n.pathname,s)!=null}[...bxe];var vR={exports:{}},yR={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bH;function Lxe(){if(bH)return yR;bH=1;var e=E_();function t(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,n=e.useRef,s=e.useEffect,a=e.useMemo,o=e.useDebugValue;return yR.useSyncExternalStoreWithSelector=function(l,c,u,d,f){var m=n(null);if(m.current===null){var v={hasValue:!1,value:null};m.current=v}else v=m.current;m=a(function(){function x(M){if(!w){if(w=!0,_=M,M=d(M),f!==void 0&&v.hasValue){var C=v.value;if(f(C,M))return S=C}return S=M}if(C=S,r(_,M))return C;var T=d(M);return f!==void 0&&f(C,T)?(_=M,C):(_=M,S=T)}var w=!1,_,S,P=u===void 0?null:u;return[function(){return x(c())},P===null?void 0:function(){return x(P())}]},[c,u,d,f]);var y=i(l,m[0],m[1]);return s(function(){v.hasValue=!0,v.value=y},[y]),o(y),y},yR}var wH;function zxe(){return wH||(wH=1,vR.exports=Lxe()),vR.exports}var Bxe=zxe();function Fxe(e){e()}function Vxe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){Fxe(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let i=e;for(;i;)r.push(i),i=i.next;return r},subscribe(r){let i=!0;const n=t={callback:r,next:null,prev:t};return n.prev?n.prev.next=n:e=n,function(){!i||e===null||(i=!1,n.next?n.next.prev=n.prev:t=n.prev,n.prev?n.prev.next=n.next:e=n.next)}}}}var _H={notify(){},get:()=>[]};function Uxe(e,t){let r,i=_H,n=0,s=!1;function a(y){u();const x=i.subscribe(y);let w=!1;return()=>{w||(w=!0,x(),d())}}function o(){i.notify()}function l(){v.onStateChange&&v.onStateChange()}function c(){return s}function u(){n++,r||(r=e.subscribe(l),i=Vxe())}function d(){n--,r&&n===0&&(r(),r=void 0,i.clear(),i=_H)}function f(){s||(s=!0,u())}function m(){s&&(s=!1,d())}const v={addNestedSub:a,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:c,trySubscribe:f,tryUnsubscribe:m,getListeners:()=>i};return v}var Hxe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Gxe=Hxe(),Wxe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",qxe=Wxe(),Yxe=()=>Gxe||qxe?O.useLayoutEffect:O.useEffect,Xxe=Yxe(),$xe=Symbol.for("react-redux-context"),Kxe=typeof globalThis<"u"?globalThis:{};function Qxe(){if(!O.createContext)return{};const e=Kxe[$xe]??=new Map;let t=e.get(O.createContext);return t||(t=O.createContext(null),e.set(O.createContext,t)),t}var Rp=Qxe();function Zxe(e){const{children:t,context:r,serverState:i,store:n}=e,s=O.useMemo(()=>{const l=Uxe(n);return{store:n,subscription:l,getServerState:i?()=>i:void 0}},[n,i]),a=O.useMemo(()=>n.getState(),[n]);Xxe(()=>{const{subscription:l}=s;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),a!==n.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[s,a]);const o=r||Rp;return O.createElement(o.Provider,{value:s},t)}var Jxe=Zxe;function P6(e=Rp){return function(){return O.useContext(e)}}var hre=P6();function fre(e=Rp){const t=e===Rp?hre:P6(e),r=()=>{const{store:i}=t();return i};return Object.assign(r,{withTypes:()=>r}),r}var ebe=fre();function tbe(e=Rp){const t=e===Rp?ebe:fre(e),r=()=>t().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var g3=tbe(),rbe=(e,t)=>e===t;function ibe(e=Rp){const t=e===Rp?hre:P6(e),r=(i,n={})=>{const{equalityFn:s=rbe}=typeof n=="function"?{equalityFn:n}:n,a=t(),{store:o,subscription:l,getServerState:c}=a;O.useRef(!0);const u=O.useCallback({[i.name](f){return i(f)}}[i.name],[i]),d=Bxe.useSyncExternalStoreWithSelector(l.addNestedSub,o.getState,c||o.getState,u,s);return O.useDebugValue(d),d};return Object.assign(r,{withTypes:()=>r}),r}var ho=ibe();function la(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var nbe=typeof Symbol=="function"&&Symbol.observable||"@@observable",SH=nbe,xR=()=>Math.random().toString(36).substring(7).split("").join("."),sbe={INIT:`@@redux/INIT${xR()}`,REPLACE:`@@redux/REPLACE${xR()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${xR()}`},XT=sbe;function D6(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function pre(e,t,r){if(typeof e!="function")throw new Error(la(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(la(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(la(1));return r(pre)(e,t)}let i=e,n=t,s=new Map,a=s,o=0,l=!1;function c(){a===s&&(a=new Map,s.forEach((x,w)=>{a.set(w,x)}))}function u(){if(l)throw new Error(la(3));return n}function d(x){if(typeof x!="function")throw new Error(la(4));if(l)throw new Error(la(5));let w=!0;c();const _=o++;return a.set(_,x),function(){if(w){if(l)throw new Error(la(6));w=!1,c(),a.delete(_),s=null}}}function f(x){if(!D6(x))throw new Error(la(7));if(typeof x.type>"u")throw new Error(la(8));if(typeof x.type!="string")throw new Error(la(17));if(l)throw new Error(la(9));try{l=!0,n=i(n,x)}finally{l=!1}return(s=a).forEach(_=>{_()}),x}function m(x){if(typeof x!="function")throw new Error(la(10));i=x,f({type:XT.REPLACE})}function v(){const x=d;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(la(11));function _(){const P=w;P.next&&P.next(u())}return _(),{unsubscribe:x(_)}},[SH](){return this}}}return f({type:XT.INIT}),{dispatch:f,subscribe:d,getState:u,replaceReducer:m,[SH]:v}}function abe(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:XT.INIT})>"u")throw new Error(la(12));if(typeof r(void 0,{type:XT.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(la(13))})}function obe(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const a=t[s];typeof e[a]=="function"&&(r[a]=e[a])}const i=Object.keys(r);let n;try{abe(r)}catch(s){n=s}return function(a={},o){if(n)throw n;let l=!1;const c={};for(let u=0;u<i.length;u++){const d=i[u],f=r[d],m=a[d],v=f(m,o);if(typeof v>"u")throw o&&o.type,new Error(la(14));c[d]=v,l=l||v!==m}return l=l||i.length!==Object.keys(a).length,l?c:a}}function $T(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...i)=>t(r(...i)))}function lbe(...e){return t=>(r,i)=>{const n=t(r,i);let s=()=>{throw new Error(la(15))};const a={getState:n.getState,dispatch:(l,...c)=>s(l,...c)},o=e.map(l=>l(a));return s=$T(...o)(n.dispatch),{...n,dispatch:s}}}function cbe(e){return D6(e)&&"type"in e&&typeof e.type=="string"}var mre=Symbol.for("immer-nothing"),EH=Symbol.for("immer-draftable"),ll=Symbol.for("immer-state");function vc(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ix=Object.getPrototypeOf;function Bg(e){return!!e&&!!e[ll]}function kh(e){return e?gre(e)||Array.isArray(e)||!!e[EH]||!!e.constructor?.[EH]||y3(e)||x3(e):!1}var ube=Object.prototype.constructor.toString();function gre(e){if(!e||typeof e!="object")return!1;const t=ix(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===ube}function KT(e,t){v3(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,i)=>t(i,r,e))}function v3(e){const t=e[ll];return t?t.type_:Array.isArray(e)?1:y3(e)?2:x3(e)?3:0}function fj(e,t){return v3(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function vre(e,t,r){const i=v3(e);i===2?e.set(t,r):i===3?e.add(r):e[t]=r}function dbe(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function y3(e){return e instanceof Map}function x3(e){return e instanceof Set}function Xm(e){return e.copy_||e.base_}function pj(e,t){if(y3(e))return new Map(e);if(x3(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=gre(e);if(t===!0||t==="class_only"&&!r){const i=Object.getOwnPropertyDescriptors(e);delete i[ll];let n=Reflect.ownKeys(i);for(let s=0;s<n.length;s++){const a=n[s],o=i[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(i[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(ix(e),i)}else{const i=ix(e);if(i!==null&&r)return{...e};const n=Object.create(i);return Object.assign(n,e)}}function N6(e,t=!1){return b3(e)||Bg(e)||!kh(e)||(v3(e)>1&&(e.set=e.add=e.clear=e.delete=hbe),Object.freeze(e),t&&Object.entries(e).forEach(([r,i])=>N6(i,!0))),e}function hbe(){vc(2)}function b3(e){return Object.isFrozen(e)}var fbe={};function Fg(e){const t=fbe[e];return t||vc(0,e),t}var E2;function yre(){return E2}function pbe(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function AH(e,t){t&&(Fg("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function mj(e){gj(e),e.drafts_.forEach(mbe),e.drafts_=null}function gj(e){e===E2&&(E2=e.parent_)}function CH(e){return E2=pbe(E2,e)}function mbe(e){const t=e[ll];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function TH(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ll].modified_&&(mj(t),vc(4)),kh(e)&&(e=QT(t,e),t.parent_||ZT(t,e)),t.patches_&&Fg("Patches").generateReplacementPatches_(r[ll].base_,e,t.patches_,t.inversePatches_)):e=QT(t,r,[]),mj(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==mre?e:void 0}function QT(e,t,r){if(b3(t))return t;const i=t[ll];if(!i)return KT(t,(n,s)=>MH(e,i,t,n,s,r)),t;if(i.scope_!==e)return t;if(!i.modified_)return ZT(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const n=i.copy_;let s=n,a=!1;i.type_===3&&(s=new Set(n),n.clear(),a=!0),KT(s,(o,l)=>MH(e,i,n,o,l,r,a)),ZT(e,n,!1),r&&e.patches_&&Fg("Patches").generatePatches_(i,r,e.patches_,e.inversePatches_)}return i.copy_}function MH(e,t,r,i,n,s,a){if(Bg(n)){const o=s&&t&&t.type_!==3&&!fj(t.assigned_,i)?s.concat(i):void 0,l=QT(e,n,o);if(vre(r,i,l),Bg(l))e.canAutoFreeze_=!1;else return}else a&&r.add(n);if(kh(n)&&!b3(n)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;QT(e,n),(!t||!t.scope_.parent_)&&typeof i!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,i)&&ZT(e,n)}}function ZT(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&N6(t,r)}function gbe(e,t){const r=Array.isArray(e),i={type_:r?1:0,scope_:t?t.scope_:yre(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=i,s=k6;r&&(n=[i],s=A2);const{revoke:a,proxy:o}=Proxy.revocable(n,s);return i.draft_=o,i.revoke_=a,o}var k6={get(e,t){if(t===ll)return e;const r=Xm(e);if(!fj(r,t))return vbe(e,r,t);const i=r[t];return e.finalized_||!kh(i)?i:i===bR(e.base_,t)?(wR(e),e.copy_[t]=yj(i,e)):i},has(e,t){return t in Xm(e)},ownKeys(e){return Reflect.ownKeys(Xm(e))},set(e,t,r){const i=xre(Xm(e),t);if(i?.set)return i.set.call(e.draft_,r),!0;if(!e.modified_){const n=bR(Xm(e),t),s=n?.[ll];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(dbe(r,n)&&(r!==void 0||fj(e.base_,t)))return!0;wR(e),vj(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return bR(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,wR(e),vj(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Xm(e),i=Reflect.getOwnPropertyDescriptor(r,t);return i&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:i.enumerable,value:r[t]}},defineProperty(){vc(11)},getPrototypeOf(e){return ix(e.base_)},setPrototypeOf(){vc(12)}},A2={};KT(k6,(e,t)=>{A2[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});A2.deleteProperty=function(e,t){return A2.set.call(this,e,t,void 0)};A2.set=function(e,t,r){return k6.set.call(this,e[0],t,r,e[0])};function bR(e,t){const r=e[ll];return(r?Xm(r):e)[t]}function vbe(e,t,r){const i=xre(t,r);return i?"value"in i?i.value:i.get?.call(e.draft_):void 0}function xre(e,t){if(!(t in e))return;let r=ix(e);for(;r;){const i=Object.getOwnPropertyDescriptor(r,t);if(i)return i;r=ix(r)}}function vj(e){e.modified_||(e.modified_=!0,e.parent_&&vj(e.parent_))}function wR(e){e.copy_||(e.copy_=pj(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var ybe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,i)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const a=this;return function(l=s,...c){return a.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&vc(6),i!==void 0&&typeof i!="function"&&vc(7);let n;if(kh(t)){const s=CH(this),a=yj(t,void 0);let o=!0;try{n=r(a),o=!1}finally{o?mj(s):gj(s)}return AH(s,i),TH(n,s)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===mre&&(n=void 0),this.autoFreeze_&&N6(n,!0),i){const s=[],a=[];Fg("Patches").generateReplacementPatches_(t,n,s,a),i(s,a)}return n}else vc(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,l=>t(l,...o));let i,n;return[this.produce(t,r,(a,o)=>{i=a,n=o}),i,n]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){kh(e)||vc(8),Bg(e)&&(e=xbe(e));const t=CH(this),r=yj(e,void 0);return r[ll].isManual_=!0,gj(t),r}finishDraft(e,t){const r=e&&e[ll];(!r||!r.isManual_)&&vc(9);const{scope_:i}=r;return AH(i,t),TH(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));const i=Fg("Patches").applyPatches_;return Bg(e)?i(e,t):this.produce(e,n=>i(n,t))}};function yj(e,t){const r=y3(e)?Fg("MapSet").proxyMap_(e,t):x3(e)?Fg("MapSet").proxySet_(e,t):gbe(e,t);return(t?t.scope_:yre()).drafts_.push(r),r}function xbe(e){return Bg(e)||vc(10,e),bre(e)}function bre(e){if(!kh(e)||b3(e))return e;const t=e[ll];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=pj(e,t.scope_.immer_.useStrictShallowCopy_)}else r=pj(e,!0);return KT(r,(i,n)=>{vre(r,i,bre(n))}),t&&(t.finalized_=!1),r}var cl=new ybe,wre=cl.produce;cl.produceWithPatches.bind(cl);cl.setAutoFreeze.bind(cl);cl.setUseStrictShallowCopy.bind(cl);cl.applyPatches.bind(cl);cl.createDraft.bind(cl);cl.finishDraft.bind(cl);function _re(e){return({dispatch:r,getState:i})=>n=>s=>typeof s=="function"?s(r,i,e):n(s)}var bbe=_re(),wbe=_re,_be=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?$T:$T.apply(null,arguments)},Sbe=e=>e&&typeof e.match=="function";function Fw(e,t){function r(...i){if(t){let n=t(...i);if(!n)throw new Error(Ch(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:i[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=i=>cbe(i)&&i.type===e,r}var Sre=class mw extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,mw.prototype)}static get[Symbol.species](){return mw}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new mw(...t[0].concat(this)):new mw(...t.concat(this))}};function PH(e){return kh(e)?wre(e,()=>{}):e}function UE(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Ebe(e){return typeof e=="boolean"}var Abe=()=>function(t){const{thunk:r=!0,immutableCheck:i=!0,serializableCheck:n=!0,actionCreatorCheck:s=!0}=t??{};let a=new Sre;return r&&(Ebe(r)?a.push(bbe):a.push(wbe(r.extraArgument))),a},Cbe="RTK_autoBatch",DH=e=>t=>{setTimeout(t,e)},Tbe=(e={type:"raf"})=>t=>(...r)=>{const i=t(...r);let n=!0,s=!1,a=!1;const o=new Set,l=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:DH(10):e.type==="callback"?e.queueNotification:DH(e.timeout),c=()=>{a=!1,s&&(s=!1,o.forEach(u=>u()))};return Object.assign({},i,{subscribe(u){const d=()=>n&&u(),f=i.subscribe(d);return o.add(u),()=>{f(),o.delete(u)}},dispatch(u){try{return n=!u?.meta?.[Cbe],s=!n,s&&(a||(a=!0,l(c))),i.dispatch(u)}finally{n=!0}}})},Mbe=e=>function(r){const{autoBatch:i=!0}=r??{};let n=new Sre(e);return i&&n.push(Tbe(typeof i=="object"?i:void 0)),n};function Pbe(e){const t=Abe(),{reducer:r=void 0,middleware:i,devTools:n=!0,preloadedState:s=void 0,enhancers:a=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(D6(r))o=obe(r);else throw new Error(Ch(1));let l;typeof i=="function"?l=i(t):l=t();let c=$T;n&&(c=_be({trace:!1,...typeof n=="object"&&n}));const u=lbe(...l),d=Mbe(u);let f=typeof a=="function"?a(d):d();const m=c(...f);return pre(o,s,m)}function Ere(e){const t={},r=[];let i;const n={addCase(s,a){const o=typeof s=="string"?s:s.type;if(!o)throw new Error(Ch(28));if(o in t)throw new Error(Ch(29));return t[o]=a,n},addMatcher(s,a){return r.push({matcher:s,reducer:a}),n},addDefaultCase(s){return i=s,n}};return e(n),[t,r,i]}function Dbe(e){return typeof e=="function"}function Nbe(e,t){let[r,i,n]=Ere(t),s;if(Dbe(e))s=()=>PH(e());else{const o=PH(e);s=()=>o}function a(o=s(),l){let c=[r[l.type],...i.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[n]),c.reduce((u,d)=>{if(d)if(Bg(u)){const m=d(u,l);return m===void 0?u:m}else{if(kh(u))return wre(u,f=>d(f,l));{const f=d(u,l);if(f===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return u},o)}return a.getInitialState=s,a}var kbe=(e,t)=>Sbe(e)?e.match(t):e(t);function Rbe(...e){return t=>e.some(r=>kbe(r,t))}var Ibe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Obe=(e=21)=>{let t="",r=e;for(;r--;)t+=Ibe[Math.random()*64|0];return t},jbe=["name","message","stack","code"],_R=class{constructor(e,t){this.payload=e,this.meta=t}_type},NH=class{constructor(e,t){this.payload=e,this.meta=t}_type},Lbe=e=>{if(typeof e=="object"&&e!==null){const t={};for(const r of jbe)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},kH="External signal was aborted",Vx=(()=>{function e(t,r,i){const n=Fw(t+"/fulfilled",(l,c,u,d)=>({payload:l,meta:{...d||{},arg:u,requestId:c,requestStatus:"fulfilled"}})),s=Fw(t+"/pending",(l,c,u)=>({payload:void 0,meta:{...u||{},arg:c,requestId:l,requestStatus:"pending"}})),a=Fw(t+"/rejected",(l,c,u,d,f)=>({payload:d,error:(i&&i.serializeError||Lbe)(l||"Rejected"),meta:{...f||{},arg:u,requestId:c,rejectedWithValue:!!d,requestStatus:"rejected",aborted:l?.name==="AbortError",condition:l?.name==="ConditionError"}}));function o(l,{signal:c}={}){return(u,d,f)=>{const m=i?.idGenerator?i.idGenerator(l):Obe(),v=new AbortController;let y,x;function w(S){x=S,v.abort()}c&&(c.aborted?w(kH):c.addEventListener("abort",()=>w(kH),{once:!0}));const _=async function(){let S;try{let M=i?.condition?.(l,{getState:d,extra:f});if(Bbe(M)&&(M=await M),M===!1||v.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const C=new Promise((T,E)=>{y=()=>{E({name:"AbortError",message:x||"Aborted"})},v.signal.addEventListener("abort",y)});u(s(m,l,i?.getPendingMeta?.({requestId:m,arg:l},{getState:d,extra:f}))),S=await Promise.race([C,Promise.resolve(r(l,{dispatch:u,getState:d,extra:f,requestId:m,signal:v.signal,abort:w,rejectWithValue:(T,E)=>new _R(T,E),fulfillWithValue:(T,E)=>new NH(T,E)})).then(T=>{if(T instanceof _R)throw T;return T instanceof NH?n(T.payload,m,l,T.meta):n(T,m,l)})])}catch(M){S=M instanceof _R?a(null,m,l,M.payload,M.meta):a(M,m,l)}finally{y&&v.signal.removeEventListener("abort",y)}return i&&!i.dispatchConditionRejection&&a.match(S)&&S.meta.condition||u(S),S}();return Object.assign(_,{abort:w,requestId:m,arg:l,unwrap(){return _.then(zbe)}})}}return Object.assign(o,{pending:s,rejected:a,fulfilled:n,settled:Rbe(a,n),typePrefix:t})}return e.withTypes=()=>e,e})();function zbe(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function Bbe(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var Fbe=Symbol.for("rtk-slice-createasyncthunk");function Vbe(e,t){return`${e}/${t}`}function Ube({creators:e}={}){const t=e?.asyncThunk?.[Fbe];return function(i){const{name:n,reducerPath:s=n}=i;if(!n)throw new Error(Ch(11));const a=(typeof i.reducers=="function"?i.reducers(Wbe()):i.reducers)||{},o=Object.keys(a),l={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(S,P){const M=typeof S=="string"?S:S.type;if(!M)throw new Error(Ch(12));if(M in l.sliceCaseReducersByType)throw new Error(Ch(13));return l.sliceCaseReducersByType[M]=P,c},addMatcher(S,P){return l.sliceMatchers.push({matcher:S,reducer:P}),c},exposeAction(S,P){return l.actionCreators[S]=P,c},exposeCaseReducer(S,P){return l.sliceCaseReducersByName[S]=P,c}};o.forEach(S=>{const P=a[S],M={reducerName:S,type:Vbe(n,S),createNotation:typeof i.reducers=="function"};Ybe(P)?$be(M,P,c,t):qbe(M,P,c)});function u(){const[S={},P=[],M=void 0]=typeof i.extraReducers=="function"?Ere(i.extraReducers):[i.extraReducers],C={...S,...l.sliceCaseReducersByType};return Nbe(i.initialState,T=>{for(let E in C)T.addCase(E,C[E]);for(let E of l.sliceMatchers)T.addMatcher(E.matcher,E.reducer);for(let E of P)T.addMatcher(E.matcher,E.reducer);M&&T.addDefaultCase(M)})}const d=S=>S,f=new Map,m=new WeakMap;let v;function y(S,P){return v||(v=u()),v(S,P)}function x(){return v||(v=u()),v.getInitialState()}function w(S,P=!1){function M(T){let E=T[S];return typeof E>"u"&&P&&(E=UE(m,M,x)),E}function C(T=d){const E=UE(f,P,()=>new WeakMap);return UE(E,T,()=>{const N={};for(const[D,I]of Object.entries(i.selectors??{}))N[D]=Hbe(I,T,()=>UE(m,T,x),P);return N})}return{reducerPath:S,getSelectors:C,get selectors(){return C(M)},selectSlice:M}}const _={name:n,reducer:y,actions:l.actionCreators,caseReducers:l.sliceCaseReducersByName,getInitialState:x,...w(s),injectInto(S,{reducerPath:P,...M}={}){const C=P??s;return S.inject({reducerPath:C,reducer:y},M),{..._,...w(C,!0)}}};return _}}function Hbe(e,t,r,i){function n(s,...a){let o=t(s);return typeof o>"u"&&i&&(o=r()),e(o,...a)}return n.unwrapped=e,n}var Gbe=Ube();function Wbe(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function qbe({type:e,reducerName:t,createNotation:r},i,n){let s,a;if("reducer"in i){if(r&&!Xbe(i))throw new Error(Ch(17));s=i.reducer,a=i.prepare}else s=i;n.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,a?Fw(e,a):Fw(e))}function Ybe(e){return e._reducerDefinitionType==="asyncThunk"}function Xbe(e){return e._reducerDefinitionType==="reducerWithPrepare"}function $be({type:e,reducerName:t},r,i,n){if(!n)throw new Error(Ch(18));const{payloadCreator:s,fulfilled:a,pending:o,rejected:l,settled:c,options:u}=r,d=n(e,s,u);i.exposeAction(t,d),a&&i.addCase(d.fulfilled,a),o&&i.addCase(d.pending,o),l&&i.addCase(d.rejected,l),c&&i.addMatcher(d.settled,c),i.exposeCaseReducer(t,{fulfilled:a||HE,pending:o||HE,rejected:l||HE,settled:c||HE})}function HE(){}function Ch(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}function Are(e,t){return function(){return e.apply(t,arguments)}}const{toString:Kbe}=Object.prototype,{getPrototypeOf:R6}=Object,{iterator:w3,toStringTag:Cre}=Symbol,_3=(e=>t=>{const r=Kbe.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),qc=e=>(e=e.toLowerCase(),t=>_3(t)===e),S3=e=>t=>typeof t===e,{isArray:Ux}=Array,C2=S3("undefined");function T_(e){return e!==null&&!C2(e)&&e.constructor!==null&&!C2(e.constructor)&&No(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Tre=qc("ArrayBuffer");function Qbe(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Tre(e.buffer),t}const Zbe=S3("string"),No=S3("function"),Mre=S3("number"),M_=e=>e!==null&&typeof e=="object",Jbe=e=>e===!0||e===!1,$C=e=>{if(_3(e)!=="object")return!1;const t=R6(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Cre in e)&&!(w3 in e)},e1e=e=>{if(!M_(e)||T_(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},t1e=qc("Date"),r1e=qc("File"),i1e=qc("Blob"),n1e=qc("FileList"),s1e=e=>M_(e)&&No(e.pipe),a1e=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||No(e.append)&&((t=_3(e))==="formdata"||t==="object"&&No(e.toString)&&e.toString()==="[object FormData]"))},o1e=qc("URLSearchParams"),[l1e,c1e,u1e,d1e]=["ReadableStream","Request","Response","Headers"].map(qc),h1e=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function P_(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let i,n;if(typeof e!="object"&&(e=[e]),Ux(e))for(i=0,n=e.length;i<n;i++)t.call(null,e[i],i,e);else{if(T_(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),a=s.length;let o;for(i=0;i<a;i++)o=s[i],t.call(null,e[o],o,e)}}function Pre(e,t){if(T_(e))return null;t=t.toLowerCase();const r=Object.keys(e);let i=r.length,n;for(;i-- >0;)if(n=r[i],t===n.toLowerCase())return n;return null}const cg=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Dre=e=>!C2(e)&&e!==cg;function xj(){const{caseless:e}=Dre(this)&&this||{},t={},r=(i,n)=>{const s=e&&Pre(t,n)||n;$C(t[s])&&$C(i)?t[s]=xj(t[s],i):$C(i)?t[s]=xj({},i):Ux(i)?t[s]=i.slice():t[s]=i};for(let i=0,n=arguments.length;i<n;i++)arguments[i]&&P_(arguments[i],r);return t}const f1e=(e,t,r,{allOwnKeys:i}={})=>(P_(t,(n,s)=>{r&&No(n)?e[s]=Are(n,r):e[s]=n},{allOwnKeys:i}),e),p1e=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),m1e=(e,t,r,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},g1e=(e,t,r,i)=>{let n,s,a;const o={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),s=n.length;s-- >0;)a=n[s],(!i||i(a,e,t))&&!o[a]&&(t[a]=e[a],o[a]=!0);e=r!==!1&&R6(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},v1e=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const i=e.indexOf(t,r);return i!==-1&&i===r},y1e=e=>{if(!e)return null;if(Ux(e))return e;let t=e.length;if(!Mre(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},x1e=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&R6(Uint8Array)),b1e=(e,t)=>{const i=(e&&e[w3]).call(e);let n;for(;(n=i.next())&&!n.done;){const s=n.value;t.call(e,s[0],s[1])}},w1e=(e,t)=>{let r;const i=[];for(;(r=e.exec(t))!==null;)i.push(r);return i},_1e=qc("HTMLFormElement"),S1e=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,n){return i.toUpperCase()+n}),RH=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),E1e=qc("RegExp"),Nre=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),i={};P_(r,(n,s)=>{let a;(a=t(n,s,e))!==!1&&(i[s]=a||n)}),Object.defineProperties(e,i)},A1e=e=>{Nre(e,(t,r)=>{if(No(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const i=e[r];if(No(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},C1e=(e,t)=>{const r={},i=n=>{n.forEach(s=>{r[s]=!0})};return Ux(e)?i(e):i(String(e).split(t)),r},T1e=()=>{},M1e=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function P1e(e){return!!(e&&No(e.append)&&e[Cre]==="FormData"&&e[w3])}const D1e=e=>{const t=new Array(10),r=(i,n)=>{if(M_(i)){if(t.indexOf(i)>=0)return;if(T_(i))return i;if(!("toJSON"in i)){t[n]=i;const s=Ux(i)?[]:{};return P_(i,(a,o)=>{const l=r(a,n+1);!C2(l)&&(s[o]=l)}),t[n]=void 0,s}}return i};return r(e,0)},N1e=qc("AsyncFunction"),k1e=e=>e&&(M_(e)||No(e))&&No(e.then)&&No(e.catch),kre=((e,t)=>e?setImmediate:t?((r,i)=>(cg.addEventListener("message",({source:n,data:s})=>{n===cg&&s===r&&i.length&&i.shift()()},!1),n=>{i.push(n),cg.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",No(cg.postMessage)),R1e=typeof queueMicrotask<"u"?queueMicrotask.bind(cg):typeof process<"u"&&process.nextTick||kre,I1e=e=>e!=null&&No(e[w3]),Xe={isArray:Ux,isArrayBuffer:Tre,isBuffer:T_,isFormData:a1e,isArrayBufferView:Qbe,isString:Zbe,isNumber:Mre,isBoolean:Jbe,isObject:M_,isPlainObject:$C,isEmptyObject:e1e,isReadableStream:l1e,isRequest:c1e,isResponse:u1e,isHeaders:d1e,isUndefined:C2,isDate:t1e,isFile:r1e,isBlob:i1e,isRegExp:E1e,isFunction:No,isStream:s1e,isURLSearchParams:o1e,isTypedArray:x1e,isFileList:n1e,forEach:P_,merge:xj,extend:f1e,trim:h1e,stripBOM:p1e,inherits:m1e,toFlatObject:g1e,kindOf:_3,kindOfTest:qc,endsWith:v1e,toArray:y1e,forEachEntry:b1e,matchAll:w1e,isHTMLForm:_1e,hasOwnProperty:RH,hasOwnProp:RH,reduceDescriptors:Nre,freezeMethods:A1e,toObjectSet:C1e,toCamelCase:S1e,noop:T1e,toFiniteNumber:M1e,findKey:Pre,global:cg,isContextDefined:Dre,isSpecCompliantForm:P1e,toJSONObject:D1e,isAsyncFn:N1e,isThenable:k1e,setImmediate:kre,asap:R1e,isIterable:I1e};function Rr(e,t,r,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),i&&(this.request=i),n&&(this.response=n,this.status=n.status?n.status:null)}Xe.inherits(Rr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Xe.toJSONObject(this.config),code:this.code,status:this.status}}});const Rre=Rr.prototype,Ire={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ire[e]={value:e}});Object.defineProperties(Rr,Ire);Object.defineProperty(Rre,"isAxiosError",{value:!0});Rr.from=(e,t,r,i,n,s)=>{const a=Object.create(Rre);return Xe.toFlatObject(e,a,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),Rr.call(a,e.message,t,r,i,n),a.cause=e,a.name=e.name,s&&Object.assign(a,s),a};const O1e=null;function bj(e){return Xe.isPlainObject(e)||Xe.isArray(e)}function Ore(e){return Xe.endsWith(e,"[]")?e.slice(0,-2):e}function IH(e,t,r){return e?e.concat(t).map(function(n,s){return n=Ore(n),!r&&s?"["+n+"]":n}).join(r?".":""):t}function j1e(e){return Xe.isArray(e)&&!e.some(bj)}const L1e=Xe.toFlatObject(Xe,{},null,function(t){return/^is[A-Z]/.test(t)});function E3(e,t,r){if(!Xe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Xe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,x){return!Xe.isUndefined(x[y])});const i=r.metaTokens,n=r.visitor||u,s=r.dots,a=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&Xe.isSpecCompliantForm(t);if(!Xe.isFunction(n))throw new TypeError("visitor must be a function");function c(v){if(v===null)return"";if(Xe.isDate(v))return v.toISOString();if(Xe.isBoolean(v))return v.toString();if(!l&&Xe.isBlob(v))throw new Rr("Blob is not supported. Use a Buffer instead.");return Xe.isArrayBuffer(v)||Xe.isTypedArray(v)?l&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function u(v,y,x){let w=v;if(v&&!x&&typeof v=="object"){if(Xe.endsWith(y,"{}"))y=i?y:y.slice(0,-2),v=JSON.stringify(v);else if(Xe.isArray(v)&&j1e(v)||(Xe.isFileList(v)||Xe.endsWith(y,"[]"))&&(w=Xe.toArray(v)))return y=Ore(y),w.forEach(function(S,P){!(Xe.isUndefined(S)||S===null)&&t.append(a===!0?IH([y],P,s):a===null?y:y+"[]",c(S))}),!1}return bj(v)?!0:(t.append(IH(x,y,s),c(v)),!1)}const d=[],f=Object.assign(L1e,{defaultVisitor:u,convertValue:c,isVisitable:bj});function m(v,y){if(!Xe.isUndefined(v)){if(d.indexOf(v)!==-1)throw Error("Circular reference detected in "+y.join("."));d.push(v),Xe.forEach(v,function(w,_){(!(Xe.isUndefined(w)||w===null)&&n.call(t,w,Xe.isString(_)?_.trim():_,y,f))===!0&&m(w,y?y.concat(_):[_])}),d.pop()}}if(!Xe.isObject(e))throw new TypeError("data must be an object");return m(e),t}function OH(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function I6(e,t){this._pairs=[],e&&E3(e,this,t)}const jre=I6.prototype;jre.append=function(t,r){this._pairs.push([t,r])};jre.toString=function(t){const r=t?function(i){return t.call(this,i,OH)}:OH;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function z1e(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Lre(e,t,r){if(!t)return e;const i=r&&r.encode||z1e;Xe.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let s;if(n?s=n(t,r):s=Xe.isURLSearchParams(t)?t.toString():new I6(t,r).toString(i),s){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class jH{constructor(){this.handlers=[]}use(t,r,i){return this.handlers.push({fulfilled:t,rejected:r,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Xe.forEach(this.handlers,function(i){i!==null&&t(i)})}}const zre={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},B1e=typeof URLSearchParams<"u"?URLSearchParams:I6,F1e=typeof FormData<"u"?FormData:null,V1e=typeof Blob<"u"?Blob:null,U1e={isBrowser:!0,classes:{URLSearchParams:B1e,FormData:F1e,Blob:V1e},protocols:["http","https","file","blob","url","data"]},O6=typeof window<"u"&&typeof document<"u",wj=typeof navigator=="object"&&navigator||void 0,H1e=O6&&(!wj||["ReactNative","NativeScript","NS"].indexOf(wj.product)<0),G1e=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",W1e=O6&&window.location.href||"http://localhost",q1e=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:O6,hasStandardBrowserEnv:H1e,hasStandardBrowserWebWorkerEnv:G1e,navigator:wj,origin:W1e},Symbol.toStringTag,{value:"Module"})),Oa={...q1e,...U1e};function Y1e(e,t){return E3(e,new Oa.classes.URLSearchParams,{visitor:function(r,i,n,s){return Oa.isNode&&Xe.isBuffer(r)?(this.append(i,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function X1e(e){return Xe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function $1e(e){const t={},r=Object.keys(e);let i;const n=r.length;let s;for(i=0;i<n;i++)s=r[i],t[s]=e[s];return t}function Bre(e){function t(r,i,n,s){let a=r[s++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),l=s>=r.length;return a=!a&&Xe.isArray(n)?n.length:a,l?(Xe.hasOwnProp(n,a)?n[a]=[n[a],i]:n[a]=i,!o):((!n[a]||!Xe.isObject(n[a]))&&(n[a]=[]),t(r,i,n[a],s)&&Xe.isArray(n[a])&&(n[a]=$1e(n[a])),!o)}if(Xe.isFormData(e)&&Xe.isFunction(e.entries)){const r={};return Xe.forEachEntry(e,(i,n)=>{t(X1e(i),n,r,0)}),r}return null}function K1e(e,t,r){if(Xe.isString(e))try{return(t||JSON.parse)(e),Xe.trim(e)}catch(i){if(i.name!=="SyntaxError")throw i}return(r||JSON.stringify)(e)}const D_={transitional:zre,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const i=r.getContentType()||"",n=i.indexOf("application/json")>-1,s=Xe.isObject(t);if(s&&Xe.isHTMLForm(t)&&(t=new FormData(t)),Xe.isFormData(t))return n?JSON.stringify(Bre(t)):t;if(Xe.isArrayBuffer(t)||Xe.isBuffer(t)||Xe.isStream(t)||Xe.isFile(t)||Xe.isBlob(t)||Xe.isReadableStream(t))return t;if(Xe.isArrayBufferView(t))return t.buffer;if(Xe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return Y1e(t,this.formSerializer).toString();if((o=Xe.isFileList(t))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return E3(o?{"files[]":t}:t,l&&new l,this.formSerializer)}}return s||n?(r.setContentType("application/json",!1),K1e(t)):t}],transformResponse:[function(t){const r=this.transitional||D_.transitional,i=r&&r.forcedJSONParsing,n=this.responseType==="json";if(Xe.isResponse(t)||Xe.isReadableStream(t))return t;if(t&&Xe.isString(t)&&(i&&!this.responseType||n)){const a=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(o){if(a)throw o.name==="SyntaxError"?Rr.from(o,Rr.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Oa.classes.FormData,Blob:Oa.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Xe.forEach(["delete","get","head","post","put","patch"],e=>{D_.headers[e]={}});const Q1e=Xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Z1e=e=>{const t={};let r,i,n;return e&&e.split(`
`).forEach(function(a){n=a.indexOf(":"),r=a.substring(0,n).trim().toLowerCase(),i=a.substring(n+1).trim(),!(!r||t[r]&&Q1e[r])&&(r==="set-cookie"?t[r]?t[r].push(i):t[r]=[i]:t[r]=t[r]?t[r]+", "+i:i)}),t},LH=Symbol("internals");function C1(e){return e&&String(e).trim().toLowerCase()}function KC(e){return e===!1||e==null?e:Xe.isArray(e)?e.map(KC):String(e)}function J1e(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=r.exec(e);)t[i[1]]=i[2];return t}const ewe=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function SR(e,t,r,i,n){if(Xe.isFunction(i))return i.call(this,t,r);if(n&&(t=r),!!Xe.isString(t)){if(Xe.isString(i))return t.indexOf(i)!==-1;if(Xe.isRegExp(i))return i.test(t)}}function twe(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,i)=>r.toUpperCase()+i)}function rwe(e,t){const r=Xe.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+r,{value:function(n,s,a){return this[i].call(this,t,n,s,a)},configurable:!0})})}let ko=class{constructor(t){t&&this.set(t)}set(t,r,i){const n=this;function s(o,l,c){const u=C1(l);if(!u)throw new Error("header name must be a non-empty string");const d=Xe.findKey(n,u);(!d||n[d]===void 0||c===!0||c===void 0&&n[d]!==!1)&&(n[d||l]=KC(o))}const a=(o,l)=>Xe.forEach(o,(c,u)=>s(c,u,l));if(Xe.isPlainObject(t)||t instanceof this.constructor)a(t,r);else if(Xe.isString(t)&&(t=t.trim())&&!ewe(t))a(Z1e(t),r);else if(Xe.isObject(t)&&Xe.isIterable(t)){let o={},l,c;for(const u of t){if(!Xe.isArray(u))throw TypeError("Object iterator must return a key-value pair");o[c=u[0]]=(l=o[c])?Xe.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}a(o,r)}else t!=null&&s(r,t,i);return this}get(t,r){if(t=C1(t),t){const i=Xe.findKey(this,t);if(i){const n=this[i];if(!r)return n;if(r===!0)return J1e(n);if(Xe.isFunction(r))return r.call(this,n,i);if(Xe.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=C1(t),t){const i=Xe.findKey(this,t);return!!(i&&this[i]!==void 0&&(!r||SR(this,this[i],i,r)))}return!1}delete(t,r){const i=this;let n=!1;function s(a){if(a=C1(a),a){const o=Xe.findKey(i,a);o&&(!r||SR(i,i[o],o,r))&&(delete i[o],n=!0)}}return Xe.isArray(t)?t.forEach(s):s(t),n}clear(t){const r=Object.keys(this);let i=r.length,n=!1;for(;i--;){const s=r[i];(!t||SR(this,this[s],s,t,!0))&&(delete this[s],n=!0)}return n}normalize(t){const r=this,i={};return Xe.forEach(this,(n,s)=>{const a=Xe.findKey(i,s);if(a){r[a]=KC(n),delete r[s];return}const o=t?twe(s):String(s).trim();o!==s&&delete r[s],r[o]=KC(n),i[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Xe.forEach(this,(i,n)=>{i!=null&&i!==!1&&(r[n]=t&&Xe.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const i=new this(t);return r.forEach(n=>i.set(n)),i}static accessor(t){const i=(this[LH]=this[LH]={accessors:{}}).accessors,n=this.prototype;function s(a){const o=C1(a);i[o]||(rwe(n,a),i[o]=!0)}return Xe.isArray(t)?t.forEach(s):s(t),this}};ko.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Xe.reduceDescriptors(ko.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(i){this[r]=i}}});Xe.freezeMethods(ko);function ER(e,t){const r=this||D_,i=t||r,n=ko.from(i.headers);let s=i.data;return Xe.forEach(e,function(o){s=o.call(r,s,n.normalize(),t?t.status:void 0)}),n.normalize(),s}function Fre(e){return!!(e&&e.__CANCEL__)}function Hx(e,t,r){Rr.call(this,e??"canceled",Rr.ERR_CANCELED,t,r),this.name="CanceledError"}Xe.inherits(Hx,Rr,{__CANCEL__:!0});function Vre(e,t,r){const i=r.config.validateStatus;!r.status||!i||i(r.status)?e(r):t(new Rr("Request failed with status code "+r.status,[Rr.ERR_BAD_REQUEST,Rr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function iwe(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function nwe(e,t){e=e||10;const r=new Array(e),i=new Array(e);let n=0,s=0,a;return t=t!==void 0?t:1e3,function(l){const c=Date.now(),u=i[s];a||(a=c),r[n]=l,i[n]=c;let d=s,f=0;for(;d!==n;)f+=r[d++],d=d%e;if(n=(n+1)%e,n===s&&(s=(s+1)%e),c-a<t)return;const m=u&&c-u;return m?Math.round(f*1e3/m):void 0}}function swe(e,t){let r=0,i=1e3/t,n,s;const a=(c,u=Date.now())=>{r=u,n=null,s&&(clearTimeout(s),s=null),e(...c)};return[(...c)=>{const u=Date.now(),d=u-r;d>=i?a(c,u):(n=c,s||(s=setTimeout(()=>{s=null,a(n)},i-d)))},()=>n&&a(n)]}const JT=(e,t,r=3)=>{let i=0;const n=nwe(50,250);return swe(s=>{const a=s.loaded,o=s.lengthComputable?s.total:void 0,l=a-i,c=n(l),u=a<=o;i=a;const d={loaded:a,total:o,progress:o?a/o:void 0,bytes:l,rate:c||void 0,estimated:c&&o&&u?(o-a)/c:void 0,event:s,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(d)},r)},zH=(e,t)=>{const r=e!=null;return[i=>t[0]({lengthComputable:r,total:e,loaded:i}),t[1]]},BH=e=>(...t)=>Xe.asap(()=>e(...t)),awe=Oa.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Oa.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Oa.origin),Oa.navigator&&/(msie|trident)/i.test(Oa.navigator.userAgent)):()=>!0,owe=Oa.hasStandardBrowserEnv?{write(e,t,r,i,n,s){const a=[e+"="+encodeURIComponent(t)];Xe.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),Xe.isString(i)&&a.push("path="+i),Xe.isString(n)&&a.push("domain="+n),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function lwe(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function cwe(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Ure(e,t,r){let i=!lwe(t);return e&&(i||r==!1)?cwe(e,t):t}const FH=e=>e instanceof ko?{...e}:e;function Vg(e,t){t=t||{};const r={};function i(c,u,d,f){return Xe.isPlainObject(c)&&Xe.isPlainObject(u)?Xe.merge.call({caseless:f},c,u):Xe.isPlainObject(u)?Xe.merge({},u):Xe.isArray(u)?u.slice():u}function n(c,u,d,f){if(Xe.isUndefined(u)){if(!Xe.isUndefined(c))return i(void 0,c,d,f)}else return i(c,u,d,f)}function s(c,u){if(!Xe.isUndefined(u))return i(void 0,u)}function a(c,u){if(Xe.isUndefined(u)){if(!Xe.isUndefined(c))return i(void 0,c)}else return i(void 0,u)}function o(c,u,d){if(d in t)return i(c,u);if(d in e)return i(void 0,c)}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(c,u,d)=>n(FH(c),FH(u),d,!0)};return Xe.forEach(Object.keys({...e,...t}),function(u){const d=l[u]||n,f=d(e[u],t[u],u);Xe.isUndefined(f)&&d!==o||(r[u]=f)}),r}const Hre=e=>{const t=Vg({},e);let{data:r,withXSRFToken:i,xsrfHeaderName:n,xsrfCookieName:s,headers:a,auth:o}=t;t.headers=a=ko.from(a),t.url=Lre(Ure(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let l;if(Xe.isFormData(r)){if(Oa.hasStandardBrowserEnv||Oa.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((l=a.getContentType())!==!1){const[c,...u]=l?l.split(";").map(d=>d.trim()).filter(Boolean):[];a.setContentType([c||"multipart/form-data",...u].join("; "))}}if(Oa.hasStandardBrowserEnv&&(i&&Xe.isFunction(i)&&(i=i(t)),i||i!==!1&&awe(t.url))){const c=n&&s&&owe.read(s);c&&a.set(n,c)}return t},uwe=typeof XMLHttpRequest<"u",dwe=uwe&&function(e){return new Promise(function(r,i){const n=Hre(e);let s=n.data;const a=ko.from(n.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:c}=n,u,d,f,m,v;function y(){m&&m(),v&&v(),n.cancelToken&&n.cancelToken.unsubscribe(u),n.signal&&n.signal.removeEventListener("abort",u)}let x=new XMLHttpRequest;x.open(n.method.toUpperCase(),n.url,!0),x.timeout=n.timeout;function w(){if(!x)return;const S=ko.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),M={data:!o||o==="text"||o==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:S,config:e,request:x};Vre(function(T){r(T),y()},function(T){i(T),y()},M),x=null}"onloadend"in x?x.onloadend=w:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(w)},x.onabort=function(){x&&(i(new Rr("Request aborted",Rr.ECONNABORTED,e,x)),x=null)},x.onerror=function(){i(new Rr("Network Error",Rr.ERR_NETWORK,e,x)),x=null},x.ontimeout=function(){let P=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const M=n.transitional||zre;n.timeoutErrorMessage&&(P=n.timeoutErrorMessage),i(new Rr(P,M.clarifyTimeoutError?Rr.ETIMEDOUT:Rr.ECONNABORTED,e,x)),x=null},s===void 0&&a.setContentType(null),"setRequestHeader"in x&&Xe.forEach(a.toJSON(),function(P,M){x.setRequestHeader(M,P)}),Xe.isUndefined(n.withCredentials)||(x.withCredentials=!!n.withCredentials),o&&o!=="json"&&(x.responseType=n.responseType),c&&([f,v]=JT(c,!0),x.addEventListener("progress",f)),l&&x.upload&&([d,m]=JT(l),x.upload.addEventListener("progress",d),x.upload.addEventListener("loadend",m)),(n.cancelToken||n.signal)&&(u=S=>{x&&(i(!S||S.type?new Hx(null,e,x):S),x.abort(),x=null)},n.cancelToken&&n.cancelToken.subscribe(u),n.signal&&(n.signal.aborted?u():n.signal.addEventListener("abort",u)));const _=iwe(n.url);if(_&&Oa.protocols.indexOf(_)===-1){i(new Rr("Unsupported protocol "+_+":",Rr.ERR_BAD_REQUEST,e));return}x.send(s||null)})},hwe=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let i=new AbortController,n;const s=function(c){if(!n){n=!0,o();const u=c instanceof Error?c:this.reason;i.abort(u instanceof Rr?u:new Hx(u instanceof Error?u.message:u))}};let a=t&&setTimeout(()=>{a=null,s(new Rr(`timeout ${t} of ms exceeded`,Rr.ETIMEDOUT))},t);const o=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),e=null)};e.forEach(c=>c.addEventListener("abort",s));const{signal:l}=i;return l.unsubscribe=()=>Xe.asap(o),l}},fwe=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let i=0,n;for(;i<r;)n=i+t,yield e.slice(i,n),i=n},pwe=async function*(e,t){for await(const r of mwe(e))yield*fwe(r,t)},mwe=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:i}=await t.read();if(r)break;yield i}}finally{await t.cancel()}},VH=(e,t,r,i)=>{const n=pwe(e,t);let s=0,a,o=l=>{a||(a=!0,i&&i(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await n.next();if(c){o(),l.close();return}let d=u.byteLength;if(r){let f=s+=d;r(f)}l.enqueue(new Uint8Array(u))}catch(c){throw o(c),c}},cancel(l){return o(l),n.return()}},{highWaterMark:2})},A3=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Gre=A3&&typeof ReadableStream=="function",gwe=A3&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Wre=(e,...t)=>{try{return!!e(...t)}catch{return!1}},vwe=Gre&&Wre(()=>{let e=!1;const t=new Request(Oa.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),UH=64*1024,_j=Gre&&Wre(()=>Xe.isReadableStream(new Response("").body)),eM={stream:_j&&(e=>e.body)};A3&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!eM[t]&&(eM[t]=Xe.isFunction(e[t])?r=>r[t]():(r,i)=>{throw new Rr(`Response type '${t}' is not supported`,Rr.ERR_NOT_SUPPORT,i)})})})(new Response);const ywe=async e=>{if(e==null)return 0;if(Xe.isBlob(e))return e.size;if(Xe.isSpecCompliantForm(e))return(await new Request(Oa.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Xe.isArrayBufferView(e)||Xe.isArrayBuffer(e))return e.byteLength;if(Xe.isURLSearchParams(e)&&(e=e+""),Xe.isString(e))return(await gwe(e)).byteLength},xwe=async(e,t)=>{const r=Xe.toFiniteNumber(e.getContentLength());return r??ywe(t)},bwe=A3&&(async e=>{let{url:t,method:r,data:i,signal:n,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:f}=Hre(e);c=c?(c+"").toLowerCase():"text";let m=hwe([n,s&&s.toAbortSignal()],a),v;const y=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let x;try{if(l&&vwe&&r!=="get"&&r!=="head"&&(x=await xwe(u,i))!==0){let M=new Request(t,{method:"POST",body:i,duplex:"half"}),C;if(Xe.isFormData(i)&&(C=M.headers.get("content-type"))&&u.setContentType(C),M.body){const[T,E]=zH(x,JT(BH(l)));i=VH(M.body,UH,T,E)}}Xe.isString(d)||(d=d?"include":"omit");const w="credentials"in Request.prototype;v=new Request(t,{...f,signal:m,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:i,duplex:"half",credentials:w?d:void 0});let _=await fetch(v,f);const S=_j&&(c==="stream"||c==="response");if(_j&&(o||S&&y)){const M={};["status","statusText","headers"].forEach(N=>{M[N]=_[N]});const C=Xe.toFiniteNumber(_.headers.get("content-length")),[T,E]=o&&zH(C,JT(BH(o),!0))||[];_=new Response(VH(_.body,UH,T,()=>{E&&E(),y&&y()}),M)}c=c||"text";let P=await eM[Xe.findKey(eM,c)||"text"](_,e);return!S&&y&&y(),await new Promise((M,C)=>{Vre(M,C,{data:P,headers:ko.from(_.headers),status:_.status,statusText:_.statusText,config:e,request:v})})}catch(w){throw y&&y(),w&&w.name==="TypeError"&&/Load failed|fetch/i.test(w.message)?Object.assign(new Rr("Network Error",Rr.ERR_NETWORK,e,v),{cause:w.cause||w}):Rr.from(w,w&&w.code,e,v)}}),Sj={http:O1e,xhr:dwe,fetch:bwe};Xe.forEach(Sj,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const HH=e=>`- ${e}`,wwe=e=>Xe.isFunction(e)||e===null||e===!1,qre={getAdapter:e=>{e=Xe.isArray(e)?e:[e];const{length:t}=e;let r,i;const n={};for(let s=0;s<t;s++){r=e[s];let a;if(i=r,!wwe(r)&&(i=Sj[(a=String(r)).toLowerCase()],i===void 0))throw new Rr(`Unknown adapter '${a}'`);if(i)break;n[a||"#"+s]=i}if(!i){const s=Object.entries(n).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=t?s.length>1?`since :
`+s.map(HH).join(`
`):" "+HH(s[0]):"as no adapter specified";throw new Rr("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return i},adapters:Sj};function AR(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Hx(null,e)}function GH(e){return AR(e),e.headers=ko.from(e.headers),e.data=ER.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),qre.getAdapter(e.adapter||D_.adapter)(e).then(function(i){return AR(e),i.data=ER.call(e,e.transformResponse,i),i.headers=ko.from(i.headers),i},function(i){return Fre(i)||(AR(e),i&&i.response&&(i.response.data=ER.call(e,e.transformResponse,i.response),i.response.headers=ko.from(i.response.headers))),Promise.reject(i)})}const Yre="1.11.0",C3={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{C3[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}});const WH={};C3.transitional=function(t,r,i){function n(s,a){return"[Axios v"+Yre+"] Transitional option '"+s+"'"+a+(i?". "+i:"")}return(s,a,o)=>{if(t===!1)throw new Rr(n(a," has been removed"+(r?" in "+r:"")),Rr.ERR_DEPRECATED);return r&&!WH[a]&&(WH[a]=!0,console.warn(n(a," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,a,o):!0}};C3.spelling=function(t){return(r,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function _we(e,t,r){if(typeof e!="object")throw new Rr("options must be an object",Rr.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let n=i.length;for(;n-- >0;){const s=i[n],a=t[s];if(a){const o=e[s],l=o===void 0||a(o,s,e);if(l!==!0)throw new Rr("option "+s+" must be "+l,Rr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Rr("Unknown option "+s,Rr.ERR_BAD_OPTION)}}const QC={assertOptions:_we,validators:C3},uu=QC.validators;let Eg=class{constructor(t){this.defaults=t||{},this.interceptors={request:new jH,response:new jH}}async request(t,r){try{return await this._request(t,r)}catch(i){if(i instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const s=n.stack?n.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Vg(this.defaults,r);const{transitional:i,paramsSerializer:n,headers:s}=r;i!==void 0&&QC.assertOptions(i,{silentJSONParsing:uu.transitional(uu.boolean),forcedJSONParsing:uu.transitional(uu.boolean),clarifyTimeoutError:uu.transitional(uu.boolean)},!1),n!=null&&(Xe.isFunction(n)?r.paramsSerializer={serialize:n}:QC.assertOptions(n,{encode:uu.function,serialize:uu.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),QC.assertOptions(r,{baseUrl:uu.spelling("baseURL"),withXsrfToken:uu.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let a=s&&Xe.merge(s.common,s[r.method]);s&&Xe.forEach(["delete","get","head","post","put","patch","common"],v=>{delete s[v]}),r.headers=ko.concat(a,s);const o=[];let l=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(l=l&&y.synchronous,o.unshift(y.fulfilled,y.rejected))});const c=[];this.interceptors.response.forEach(function(y){c.push(y.fulfilled,y.rejected)});let u,d=0,f;if(!l){const v=[GH.bind(this),void 0];for(v.unshift(...o),v.push(...c),f=v.length,u=Promise.resolve(r);d<f;)u=u.then(v[d++],v[d++]);return u}f=o.length;let m=r;for(d=0;d<f;){const v=o[d++],y=o[d++];try{m=v(m)}catch(x){y.call(this,x);break}}try{u=GH.call(this,m)}catch(v){return Promise.reject(v)}for(d=0,f=c.length;d<f;)u=u.then(c[d++],c[d++]);return u}getUri(t){t=Vg(this.defaults,t);const r=Ure(t.baseURL,t.url,t.allowAbsoluteUrls);return Lre(r,t.params,t.paramsSerializer)}};Xe.forEach(["delete","get","head","options"],function(t){Eg.prototype[t]=function(r,i){return this.request(Vg(i||{},{method:t,url:r,data:(i||{}).data}))}});Xe.forEach(["post","put","patch"],function(t){function r(i){return function(s,a,o){return this.request(Vg(o||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}Eg.prototype[t]=r(),Eg.prototype[t+"Form"]=r(!0)});let Swe=class Xre{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const i=this;this.promise.then(n=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](n);i._listeners=null}),this.promise.then=n=>{let s;const a=new Promise(o=>{i.subscribe(o),s=o}).then(n);return a.cancel=function(){i.unsubscribe(s)},a},t(function(s,a,o){i.reason||(i.reason=new Hx(s,a,o),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=i=>{t.abort(i)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Xre(function(n){t=n}),cancel:t}}};function Ewe(e){return function(r){return e.apply(null,r)}}function Awe(e){return Xe.isObject(e)&&e.isAxiosError===!0}const Ej={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ej).forEach(([e,t])=>{Ej[t]=e});function $re(e){const t=new Eg(e),r=Are(Eg.prototype.request,t);return Xe.extend(r,Eg.prototype,t,{allOwnKeys:!0}),Xe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return $re(Vg(e,n))},r}const xn=$re(D_);xn.Axios=Eg;xn.CanceledError=Hx;xn.CancelToken=Swe;xn.isCancel=Fre;xn.VERSION=Yre;xn.toFormData=E3;xn.AxiosError=Rr;xn.Cancel=xn.CanceledError;xn.all=function(t){return Promise.all(t)};xn.spread=Ewe;xn.isAxiosError=Awe;xn.mergeConfig=Vg;xn.AxiosHeaders=ko;xn.formToJSON=e=>Bre(Xe.isHTMLForm(e)?new FormData(e):e);xn.getAdapter=qre.getAdapter;xn.HttpStatusCode=Ej;xn.default=xn;const{Axios:HSt,AxiosError:GSt,CanceledError:WSt,isCancel:qSt,CancelToken:YSt,VERSION:XSt,all:$St,Cancel:KSt,isAxiosError:QSt,spread:ZSt,toFormData:JSt,AxiosHeaders:eEt,HttpStatusCode:tEt,formToJSON:rEt,getAdapter:iEt,mergeConfig:nEt}=xn,jt=xn.create({baseURL:"/api",withCredentials:!0,headers:{"Content-Type":"application/json"}}),ZC=Vx("auth/register",async(e,{rejectWithValue:t})=>{try{return(await jt.post("/user/register",e)).data.user}catch(r){return t(r)}}),Vw=Vx("auth/socialLogin",async(e,{rejectWithValue:t})=>{try{return(await jt.post("/user/socialLogin",{idToken:e},{withCredentials:!0})).data.user}catch(r){return t(r.response.data)}}),JC=Vx("auth/login",async(e,{rejectWithValue:t})=>{try{return(await jt.post("/user/login",e,{withCredentials:!0})).data.user}catch(r){return t(r)}}),Dy=Vx("auth/check",async(e,{rejectWithValue:t})=>{try{return(await jt.get("/user/check",{withCredentials:!0})).data.user}catch(r){return r.response?.status===401||r.response?.status===403?t({message:"Unauthorized",forceLogout:!0}):t({message:"Server error",forceLogout:!1})}}),eT=Vx("auth/logout",async(e,{rejectWithValue:t})=>{try{return(await jt.post("/user/logout")).data.message}catch(r){return t(r)}}),tT=Vx("auth/delete",async(e,{rejectWithValue:t})=>{try{return console.log("hi"),(await jt.delete("/user/deleteProfile")).data.message}catch(r){return t(r)}}),Cwe=Gbe({name:"auth",initialState:{user:null,is_authenticated:!1,loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(ZC.pending,t=>{t.loading=!0,t.error=null}).addCase(ZC.fulfilled,(t,r)=>{t.loading=!1,t.is_authenticated=!!r.payload,t.user=r.payload}).addCase(ZC.rejected,(t,r)=>{t.loading=!1,t.error=r.payload?.message||"Something went wrong",t.is_authenticated=!1,t.user=null}).addCase(JC.pending,t=>{t.loading=!0,t.error=null}).addCase(JC.fulfilled,(t,r)=>{t.loading=!1,t.is_authenticated=!!r.payload,t.user=r.payload}).addCase(JC.rejected,(t,r)=>{t.loading=!1,t.error=r.payload?.message||"Something went wrong",t.is_authenticated=!1,t.user=null}).addCase(Dy.pending,t=>{t.loading=!0,t.error=null}).addCase(Dy.fulfilled,(t,r)=>{t.loading=!1,t.is_authenticated=!!r.payload,t.user=r.payload}).addCase(Dy.rejected,(t,r)=>{t.loading=!1,t.error=r.payload?.message||"Something went wrong",r.payload?.forceLogout&&(t.is_authenticated=!1,t.user=null)}).addCase(eT.pending,t=>{t.loading=!0,t.error=null}).addCase(eT.fulfilled,(t,r)=>{t.loading=!1,t.is_authenticated=!!r.payload,t.user=null}).addCase(eT.rejected,(t,r)=>{t.loading=!1,t.error=r.payload?.message||"Something went wrong",t.is_authenticated=!1,t.user=null}).addCase(Vw.pending,t=>{t.loading=!0,t.error=null}).addCase(Vw.fulfilled,(t,r)=>{t.loading=!1,t.is_authenticated=!!r.payload,t.user=r.payload}).addCase(Vw.rejected,(t,r)=>{t.loading=!1,t.error=r.payload?.message||"Something went wrong",t.is_authenticated=!1,t.user=null}).addCase(tT.pending,t=>{t.loading=!0,t.error=null}).addCase(tT.fulfilled,(t,r)=>{t.loading=!1,t.is_authenticated=!!r.payload,t.user=r.payload}).addCase(tT.rejected,(t,r)=>{t.loading=!1,t.error=r.payload?.message||"Something went wrong",t.is_authenticated=!1,t.user=null})}}),Twe=Cwe.reducer,Mwe=Pbe({reducer:{auth:Twe}}),Pwe="modulepreload",Dwe=function(e){return"/"+e},qH={},Zp=function(t,r,i){let n=Promise.resolve();if(r&&r.length>0){let l=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");n=l(r.map(c=>{if(c=Dwe(c),c in qH)return;qH[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Pwe,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((m,v)=>{f.addEventListener("load",m),f.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};var Nwe=Object.create,T3=Object.defineProperty,kwe=Object.getOwnPropertyDescriptor,Rwe=Object.getOwnPropertyNames,Iwe=Object.getPrototypeOf,Owe=Object.prototype.hasOwnProperty,jwe=(e,t,r)=>t in e?T3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h0=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Lwe=(e,t)=>{for(var r in t)T3(e,r,{get:t[r],enumerable:!0})},zwe=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Rwe(t))!Owe.call(e,n)&&n!==r&&T3(e,n,{get:()=>t[n],enumerable:!(i=kwe(t,n))||i.enumerable});return e},Jp=(e,t,r)=>(r=e!=null?Nwe(Iwe(e)):{},zwe(t||!e||!e.__esModule?T3(r,"default",{value:e,enumerable:!0}):r,e)),gw=(e,t,r)=>(jwe(e,typeof t!="symbol"?t+"":t,r),r),Bwe=h0((e,t)=>{(function(r,i){typeof e=="object"?t.exports=i():typeof define=="function"&&define.amd?define(i):r.Alea=i()})(e,function(){return r.importState=function(n){var s=new r;return s.importState(n),s},r;function r(){return function(n){var s=0,a=0,o=0,l=1;n.length==0&&(n=[+new Date]);var c=i();s=c(" "),a=c(" "),o=c(" ");for(var u=0;u<n.length;u++)s-=c(n[u]),s<0&&(s+=1),a-=c(n[u]),a<0&&(a+=1),o-=c(n[u]),o<0&&(o+=1);c=null;var d=function(){var f=2091639*s+l*23283064365386963e-26;return s=a,a=o,o=f-(l=f|0)};return d.next=d,d.uint32=function(){return d()*4294967296},d.fract53=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.version="Alea 0.9",d.args=n,d.exportState=function(){return[s,a,o,l]},d.importState=function(f){s=+f[0]||0,a=+f[1]||0,o=+f[2]||0,l=+f[3]||0},d}(Array.prototype.slice.call(arguments))}function i(){var n=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){n+=a.charCodeAt(o);var l=.02519603282416938*n;n=l>>>0,l-=n,l*=n,n=l>>>0,l-=n,n+=l*4294967296}return(n>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),Kre=h0((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?i(e):typeof define=="function"&&define.amd?define(["exports"],i):i((r=typeof globalThis<"u"?globalThis:r||self).SVDJS={})})(e,function(r){r.SVD=function(i,n,s,a,o){if(n=n===void 0||n,s=s===void 0||s,o=1e-64/(a=a||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,c,u,d,f,m,v,y,x,w,_,S,P=i[0].length,M=i.length;if(M<P)throw new TypeError("Invalid matrix: m < n");for(var C=[],T=[],E=[],N=n==="f"?M:P,D=w=v=0;D<M;D++)T[D]=new Array(N).fill(0);for(D=0;D<P;D++)E[D]=new Array(P).fill(0);var I,j=new Array(P).fill(0);for(D=0;D<M;D++)for(l=0;l<P;l++)T[D][l]=i[D][l];for(D=0;D<P;D++){for(C[D]=v,x=0,u=D+1,l=D;l<M;l++)x+=Math.pow(T[l][D],2);if(x<o)v=0;else for(y=(m=T[D][D])*(v=m<0?Math.sqrt(x):-Math.sqrt(x))-x,T[D][D]=m-v,l=u;l<P;l++){for(x=0,c=D;c<M;c++)x+=T[c][D]*T[c][l];for(m=x/y,c=D;c<M;c++)T[c][l]=T[c][l]+m*T[c][D]}for(j[D]=v,x=0,l=u;l<P;l++)x+=Math.pow(T[D][l],2);if(x<o)v=0;else{for(y=(m=T[D][D+1])*(v=m<0?Math.sqrt(x):-Math.sqrt(x))-x,T[D][D+1]=m-v,l=u;l<P;l++)C[l]=T[D][l]/y;for(l=u;l<M;l++){for(x=0,c=u;c<P;c++)x+=T[l][c]*T[D][c];for(c=u;c<P;c++)T[l][c]=T[l][c]+x*C[c]}}w<(_=Math.abs(j[D])+Math.abs(C[D]))&&(w=_)}if(s)for(D=P-1;0<=D;D--){if(v!==0){for(y=T[D][D+1]*v,l=u;l<P;l++)E[l][D]=T[D][l]/y;for(l=u;l<P;l++){for(x=0,c=u;c<P;c++)x+=T[D][c]*E[c][l];for(c=u;c<P;c++)E[c][l]=E[c][l]+x*E[c][D]}}for(l=u;l<P;l++)E[D][l]=0,E[l][D]=0;E[D][D]=1,v=C[D],u=D}if(n){if(n==="f")for(D=P;D<M;D++){for(l=P;l<M;l++)T[D][l]=0;T[D][D]=1}for(D=P-1;0<=D;D--){for(u=D+1,v=j[D],l=u;l<N;l++)T[D][l]=0;if(v!==0){for(y=T[D][D]*v,l=u;l<N;l++){for(x=0,c=u;c<M;c++)x+=T[c][D]*T[c][l];for(m=x/y,c=D;c<M;c++)T[c][l]=T[c][l]+m*T[c][D]}for(l=D;l<M;l++)T[l][D]=T[l][D]/v}else for(l=D;l<M;l++)T[l][D]=0;T[D][D]=T[D][D]+1}}for(a*=w,c=P-1;0<=c;c--)for(var L=0;L<50;L++){for(I=!1,u=c;0<=u;u--){if(Math.abs(C[u])<=a){I=!0;break}if(Math.abs(j[u-1])<=a)break}if(!I){for(f=0,d=u-(x=1),D=u;D<c+1&&(m=x*C[D],C[D]=f*C[D],!(Math.abs(m)<=a));D++)if(v=j[D],j[D]=Math.sqrt(m*m+v*v),f=v/(y=j[D]),x=-m/y,n)for(l=0;l<M;l++)_=T[l][d],S=T[l][D],T[l][d]=_*f+S*x,T[l][D]=-_*x+S*f}if(S=j[c],u===c){if(S<0&&(j[c]=-S,s))for(l=0;l<P;l++)E[l][c]=-E[l][c];break}for(w=j[u],m=(((_=j[c-1])-S)*(_+S)+((v=C[c-1])-(y=C[c]))*(v+y))/(2*y*_),v=Math.sqrt(m*m+1),m=((w-S)*(w+S)+y*(_/(m<0?m-v:m+v)-y))/w,D=u+(x=f=1);D<c+1;D++){if(v=C[D],_=j[D],y=x*v,v*=f,S=Math.sqrt(m*m+y*y),m=w*(f=m/(C[D-1]=S))+v*(x=y/S),v=-w*x+v*f,y=_*x,_*=f,s)for(l=0;l<P;l++)w=E[l][D-1],S=E[l][D],E[l][D-1]=w*f+S*x,E[l][D]=-w*x+S*f;if(S=Math.sqrt(m*m+y*y),m=(f=m/(j[D-1]=S))*v+(x=y/S)*_,w=-x*v+f*_,n)for(l=0;l<M;l++)_=T[l][D-1],S=T[l][D],T[l][D-1]=_*f+S*x,T[l][D]=-_*x+S*f}C[u]=0,C[c]=m,j[c]=w}for(D=0;D<P;D++)j[D]<a&&(j[D]=0);return{u:T,q:j,v:E}},r.VERSION="1.1.1",Object.defineProperty(r,"__esModule",{value:!0})})}),Fwe=h0((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;function r(i){if(i===null||i===!0||i===!1)return NaN;var n=Number(i);return isNaN(n)?n:n<0?Math.ceil(n):Math.floor(n)}t.exports=e.default}),Vwe=h0((e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;function r(i){var n=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return n.setUTCFullYear(i.getFullYear()),i.getTime()-n.getTime()}t.exports=e.default}),Uwe=h0((e,t)=>{function r(s,a){function o(){this.constructor=s}o.prototype=a.prototype,s.prototype=new o}function i(s,a,o,l){this.message=s,this.expected=a,this.found=o,this.location=l,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,i)}r(i,Error),i.buildMessage=function(s,a){var o={literal:function(v){return'"'+c(v.text)+'"'},class:function(v){var y="",x;for(x=0;x<v.parts.length;x++)y+=v.parts[x]instanceof Array?u(v.parts[x][0])+"-"+u(v.parts[x][1]):u(v.parts[x]);return"["+(v.inverted?"^":"")+y+"]"},any:function(v){return"any character"},end:function(v){return"end of input"},other:function(v){return v.description}};function l(v){return v.charCodeAt(0).toString(16).toUpperCase()}function c(v){return v.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(y){return"\\x0"+l(y)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(y){return"\\x"+l(y)})}function u(v){return v.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(y){return"\\x0"+l(y)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(y){return"\\x"+l(y)})}function d(v){return o[v.type](v)}function f(v){var y=new Array(v.length),x,w;for(x=0;x<v.length;x++)y[x]=d(v[x]);if(y.sort(),y.length>0){for(x=1,w=1;x<y.length;x++)y[x-1]!==y[x]&&(y[w]=y[x],w++);y.length=w}switch(y.length){case 1:return y[0];case 2:return y[0]+" or "+y[1];default:return y.slice(0,-1).join(", ")+", or "+y[y.length-1]}}function m(v){return v?'"'+c(v)+'"':"end of input"}return"Expected "+f(s)+" but "+m(a)+" found."};function n(s,a){a=a!==void 0?a:{};var o={},l={svg_path:Mt},c=Mt,u=function(ee){if(!ee)return[];for(var oe=[],be=0;be<ee.length;be++)oe=oe.concat.apply(oe,ee[be]);var de=oe[0];return de&&de.code=="m"&&(delete de.relative,de.code="M"),oe},d=function(ee,oe){return Gi(ee,oe)},f=/^[Mm]/,m=We(["M","m"],!1,!1),v=function(ee,oe,be){var de=Xn(ee,[oe]);return be&&(de=de.concat(Xn(ee=="M"?"L":"l",be[1]))),de},y=/^[Zz]/,x=We(["Z","z"],!1,!1),w=function(){return Xn("Z")},_=/^[Ll]/,S=We(["L","l"],!1,!1),P=function(ee,oe){return Xn(ee,oe)},M=/^[Hh]/,C=We(["H","h"],!1,!1),T=function(ee,oe){return Xn(ee,oe.map(function(be){return{x:be}}))},E=/^[Vv]/,N=We(["V","v"],!1,!1),D=function(ee,oe){return Xn(ee,oe.map(function(be){return{y:be}}))},I=/^[Cc]/,j=We(["C","c"],!1,!1),L=function(ee,oe,be){return{x1:ee.x,y1:ee.y,x2:oe.x,y2:oe.y,x:be.x,y:be.y}},B=/^[Ss]/,q=We(["S","s"],!1,!1),G=function(ee,oe){return{x2:ee.x,y2:ee.y,x:oe.x,y:oe.y}},Y=/^[Qq]/,X=We(["Q","q"],!1,!1),re=function(ee,oe){return{x1:ee.x,y1:ee.y,x:oe.x,y:oe.y}},F=/^[Tt]/,$=We(["T","t"],!1,!1),se=/^[Aa]/,H=We(["A","a"],!1,!1),ne=function(ee,oe,be,de,Ce,ht){return{rx:ee,ry:oe,xAxisRotation:be,largeArc:de,sweep:Ce,x:ht.x,y:ht.y}},ce=function(ee,oe){return{x:ee,y:oe}},ie=function(ee){return ee*1},ae=function(ee){return ee.join("")*1},Z=/^[01]/,fe=We(["0","1"],!1,!1),he=function(ee){return ee=="1"},Ae=function(){return""},xe=",",Ee=De(",",!1),Be=function(ee){return ee.join("")},$e=".",mt=De(".",!1),dt=/^[eE]/,ct=We(["e","E"],!1,!1),ut=/^[+\-]/,me=We(["+","-"],!1,!1),_e=/^[0-9]/,te=We([["0","9"]],!1,!1),J=function(ee){return ee.join("")},ve=/^[ \t\n\r]/,Me=We([" ","	",`
`,"\r"],!1,!1),W=0,Se=[{line:1,column:1}],ze=0,Ue=[],Ne;if("startRule"in a){if(!(a.startRule in l))throw new Error(`Can't start parsing from rule "`+a.startRule+'".');c=l[a.startRule]}function De(ee,oe){return{type:"literal",text:ee,ignoreCase:oe}}function We(ee,oe,be){return{type:"class",parts:ee,inverted:oe,ignoreCase:be}}function Je(){return{type:"end"}}function et(ee){var oe=Se[ee],be;if(oe)return oe;for(be=ee-1;!Se[be];)be--;for(oe=Se[be],oe={line:oe.line,column:oe.column};be<ee;)s.charCodeAt(be)===10?(oe.line++,oe.column=1):oe.column++,be++;return Se[ee]=oe,oe}function qe(ee,oe){var be=et(ee),de=et(oe);return{start:{offset:ee,line:be.line,column:be.column},end:{offset:oe,line:de.line,column:de.column}}}function ft(ee){W<ze||(W>ze&&(ze=W,Ue=[]),Ue.push(ee))}function kt(ee,oe,be){return new i(i.buildMessage(ee,oe),ee,oe,be)}function Mt(){var ee,oe,be,de,Ce;for(ee=W,oe=[],be=ur();be!==o;)oe.push(be),be=ur();if(oe!==o)if(be=ye(),be===o&&(be=null),be!==o){for(de=[],Ce=ur();Ce!==o;)de.push(Ce),Ce=ur();de!==o?(oe=u(be),ee=oe):(W=ee,ee=o)}else W=ee,ee=o;else W=ee,ee=o;return ee}function ye(){var ee,oe,be,de,Ce,ht;if(ee=W,oe=He(),oe!==o){for(be=[],de=W,Ce=[],ht=ur();ht!==o;)Ce.push(ht),ht=ur();for(Ce!==o?(ht=He(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);de!==o;){for(be.push(de),de=W,Ce=[],ht=ur();ht!==o;)Ce.push(ht),ht=ur();Ce!==o?(ht=He(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o)}be!==o?(oe=d(oe,be),ee=oe):(W=ee,ee=o)}else W=ee,ee=o;return ee}function He(){var ee,oe,be,de,Ce,ht;if(ee=W,oe=xt(),oe!==o){for(be=[],de=W,Ce=[],ht=ur();ht!==o;)Ce.push(ht),ht=ur();for(Ce!==o?(ht=tt(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);de!==o;){for(be.push(de),de=W,Ce=[],ht=ur();ht!==o;)Ce.push(ht),ht=ur();Ce!==o?(ht=tt(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o)}be!==o?(oe=d(oe,be),ee=oe):(W=ee,ee=o)}else W=ee,ee=o;return ee}function tt(){var ee;return ee=Wt(),ee===o&&(ee=gr(),ee===o&&(ee=Hi(),ee===o&&(ee=ei(),ee===o&&(ee=Sa(),ee===o&&(ee=ln(),ee===o&&(ee=pe(),ee===o&&(ee=ke(),ee===o&&(ee=Tt())))))))),ee}function xt(){var ee,oe,be,de,Ce,ht,Fo;if(ee=W,f.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(m)),oe!==o){for(be=[],de=ur();de!==o;)be.push(de),de=ur();be!==o?(de=Dt(),de!==o?(Ce=W,ht=Xt(),ht===o&&(ht=null),ht!==o?(Fo=Ui(),Fo!==o?(ht=[ht,Fo],Ce=ht):(W=Ce,Ce=o)):(W=Ce,Ce=o),Ce===o&&(Ce=null),Ce!==o?(oe=v(oe,de,Ce),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Wt(){var ee,oe;return ee=W,y.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(x)),oe!==o&&(oe=w()),ee=oe,ee}function gr(){var ee,oe,be,de;if(ee=W,_.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(S)),oe!==o){for(be=[],de=ur();de!==o;)be.push(de),de=ur();be!==o?(de=Ui(),de!==o?(oe=P(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Ui(){var ee,oe,be,de,Ce,ht;if(ee=W,oe=Dt(),oe!==o){for(be=[],de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=Dt(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);de!==o;)be.push(de),de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=Dt(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);be!==o?(oe=d(oe,be),ee=oe):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Hi(){var ee,oe,be,de;if(ee=W,M.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(C)),oe!==o){for(be=[],de=ur();de!==o;)be.push(de),de=ur();be!==o?(de=Js(),de!==o?(oe=T(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Js(){var ee,oe,be,de,Ce,ht;if(ee=W,oe=wr(),oe!==o){for(be=[],de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=wr(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);de!==o;)be.push(de),de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=wr(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);be!==o?(oe=d(oe,be),ee=oe):(W=ee,ee=o)}else W=ee,ee=o;return ee}function ei(){var ee,oe,be,de;if(ee=W,E.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(N)),oe!==o){for(be=[],de=ur();de!==o;)be.push(de),de=ur();be!==o?(de=Js(),de!==o?(oe=D(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Sa(){var ee,oe,be,de;if(ee=W,I.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(j)),oe!==o){for(be=[],de=ur();de!==o;)be.push(de),de=ur();be!==o?(de=zr(),de!==o?(oe=P(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)}else W=ee,ee=o;return ee}function zr(){var ee,oe,be,de,Ce,ht;if(ee=W,oe=$i(),oe!==o){for(be=[],de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=$i(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);de!==o;)be.push(de),de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=$i(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);be!==o?(oe=d(oe,be),ee=oe):(W=ee,ee=o)}else W=ee,ee=o;return ee}function $i(){var ee,oe,be,de,Ce,ht;return ee=W,oe=Dt(),oe!==o?(be=Xt(),be===o&&(be=null),be!==o?(de=Dt(),de!==o?(Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=Dt(),ht!==o?(oe=L(oe,de,ht),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o),ee}function ln(){var ee,oe,be,de;if(ee=W,B.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(q)),oe!==o){for(be=[],de=ur();de!==o;)be.push(de),de=ur();be!==o?(de=Ea(),de!==o?(oe=P(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Ea(){var ee,oe,be,de,Ce,ht;if(ee=W,oe=Zl(),oe!==o){for(be=[],de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=Zl(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);de!==o;)be.push(de),de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=Zl(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);be!==o?(oe=d(oe,be),ee=oe):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Zl(){var ee,oe,be,de;return ee=W,oe=Dt(),oe!==o?(be=Xt(),be===o&&(be=null),be!==o?(de=Dt(),de!==o?(oe=G(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o),ee}function pe(){var ee,oe,be,de;if(ee=W,Y.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(X)),oe!==o){for(be=[],de=ur();de!==o;)be.push(de),de=ur();be!==o?(de=je(),de!==o?(oe=P(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)}else W=ee,ee=o;return ee}function je(){var ee,oe,be,de,Ce,ht;if(ee=W,oe=Ke(),oe!==o){for(be=[],de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=Ke(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);de!==o;)be.push(de),de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=Ke(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);be!==o?(oe=d(oe,be),ee=oe):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Ke(){var ee,oe,be,de;return ee=W,oe=Dt(),oe!==o?(be=Xt(),be===o&&(be=null),be!==o?(de=Dt(),de!==o?(oe=re(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o),ee}function ke(){var ee,oe,be,de;if(ee=W,F.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft($)),oe!==o){for(be=[],de=ur();de!==o;)be.push(de),de=ur();be!==o?(de=Qe(),de!==o?(oe=P(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Qe(){var ee,oe,be,de,Ce,ht;if(ee=W,oe=Dt(),oe!==o){for(be=[],de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=Dt(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);de!==o;)be.push(de),de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=Dt(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);be!==o?(oe=d(oe,be),ee=oe):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Tt(){var ee,oe,be,de;if(ee=W,se.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(H)),oe!==o){for(be=[],de=ur();de!==o;)be.push(de),de=ur();be!==o?(de=Gt(),de!==o?(oe=P(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)}else W=ee,ee=o;return ee}function Gt(){var ee,oe,be,de,Ce,ht;if(ee=W,oe=qt(),oe!==o){for(be=[],de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=qt(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);de!==o;)be.push(de),de=W,Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=qt(),ht!==o?(Ce=[Ce,ht],de=Ce):(W=de,de=o)):(W=de,de=o);be!==o?(oe=d(oe,be),ee=oe):(W=ee,ee=o)}else W=ee,ee=o;return ee}function qt(){var ee,oe,be,de,Ce,ht,Fo,Kc,Qc,Jl,ef,cn;return ee=W,oe=er(),oe!==o?(be=Xt(),be===o&&(be=null),be!==o?(de=er(),de!==o?(Ce=Xt(),Ce===o&&(Ce=null),Ce!==o?(ht=wr(),ht!==o?(Fo=Xt(),Fo!==o?(Kc=vr(),Kc!==o?(Qc=Xt(),Qc===o&&(Qc=null),Qc!==o?(Jl=vr(),Jl!==o?(ef=Xt(),ef===o&&(ef=null),ef!==o?(cn=Dt(),cn!==o?(oe=ne(oe,de,ht,Kc,Jl,cn),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o),ee}function Dt(){var ee,oe,be,de;return ee=W,oe=wr(),oe!==o?(be=Xt(),be===o&&(be=null),be!==o?(de=wr(),de!==o?(oe=ce(oe,de),ee=oe):(W=ee,ee=o)):(W=ee,ee=o)):(W=ee,ee=o),ee}function er(){var ee,oe;return ee=W,oe=ea(),oe===o&&(oe=Yn()),oe!==o&&(oe=ie(oe)),ee=oe,ee}function wr(){var ee,oe,be,de;return ee=W,oe=W,be=kr(),be===o&&(be=null),be!==o?(de=ea(),de!==o?(be=[be,de],oe=be):(W=oe,oe=o)):(W=oe,oe=o),oe===o&&(oe=W,be=kr(),be===o&&(be=null),be!==o?(de=Yn(),de!==o?(be=[be,de],oe=be):(W=oe,oe=o)):(W=oe,oe=o)),oe!==o&&(oe=ae(oe)),ee=oe,ee}function vr(){var ee,oe;return ee=W,Z.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(fe)),oe!==o&&(oe=he(oe)),ee=oe,ee}function Xt(){var ee,oe,be,de,Ce;if(ee=W,oe=[],be=ur(),be!==o)for(;be!==o;)oe.push(be),be=ur();else oe=o;if(oe!==o)if(be=Ci(),be===o&&(be=null),be!==o){for(de=[],Ce=ur();Ce!==o;)de.push(Ce),Ce=ur();de!==o?(oe=[oe,be,de],ee=oe):(W=ee,ee=o)}else W=ee,ee=o;else W=ee,ee=o;if(ee===o){if(ee=W,oe=W,be=Ci(),be!==o){for(de=[],Ce=ur();Ce!==o;)de.push(Ce),Ce=ur();de!==o?(be=[be,de],oe=be):(W=oe,oe=o)}else W=oe,oe=o;oe!==o&&(oe=Ae()),ee=oe}return ee}function Ci(){var ee;return s.charCodeAt(W)===44?(ee=xe,W++):(ee=o,ft(Ee)),ee}function ea(){var ee,oe,be,de;return ee=W,oe=W,be=mo(),be!==o?(de=gi(),de===o&&(de=null),de!==o?(be=[be,de],oe=be):(W=oe,oe=o)):(W=oe,oe=o),oe===o&&(oe=W,be=Yn(),be!==o?(de=gi(),de!==o?(be=[be,de],oe=be):(W=oe,oe=o)):(W=oe,oe=o)),oe!==o&&(oe=Be(oe)),ee=oe,ee}function mo(){var ee,oe,be,de,Ce;return ee=W,oe=W,be=Yn(),be===o&&(be=null),be!==o?(s.charCodeAt(W)===46?(de=$e,W++):(de=o,ft(mt)),de!==o?(Ce=Yn(),Ce!==o?(be=[be,de,Ce],oe=be):(W=oe,oe=o)):(W=oe,oe=o)):(W=oe,oe=o),oe===o&&(oe=W,be=Yn(),be!==o?(s.charCodeAt(W)===46?(de=$e,W++):(de=o,ft(mt)),de!==o?(be=[be,de],oe=be):(W=oe,oe=o)):(W=oe,oe=o)),oe!==o&&(oe=Be(oe)),ee=oe,ee}function gi(){var ee,oe,be,de,Ce;return ee=W,oe=W,dt.test(s.charAt(W))?(be=s.charAt(W),W++):(be=o,ft(ct)),be!==o?(de=kr(),de===o&&(de=null),de!==o?(Ce=Yn(),Ce!==o?(be=[be,de,Ce],oe=be):(W=oe,oe=o)):(W=oe,oe=o)):(W=oe,oe=o),oe!==o&&(oe=Be(oe)),ee=oe,ee}function kr(){var ee;return ut.test(s.charAt(W))?(ee=s.charAt(W),W++):(ee=o,ft(me)),ee}function Yn(){var ee,oe,be;if(ee=W,oe=[],_e.test(s.charAt(W))?(be=s.charAt(W),W++):(be=o,ft(te)),be!==o)for(;be!==o;)oe.push(be),_e.test(s.charAt(W))?(be=s.charAt(W),W++):(be=o,ft(te));else oe=o;return oe!==o&&(oe=J(oe)),ee=oe,ee}function ur(){var ee,oe;return ee=W,ve.test(s.charAt(W))?(oe=s.charAt(W),W++):(oe=o,ft(Me)),oe!==o&&(oe=Ae()),ee=oe,ee}function Gi(ee,oe){if(!oe)return[ee];for(var be=[ee],de=0,Ce=oe.length;de<Ce;de++)be[de+1]=oe[de][1];return be}var Wa={m:"moveto",l:"lineto",h:"horizontal lineto",v:"vertical lineto",c:"curveto",s:"smooth curveto",q:"quadratic curveto",t:"smooth quadratic curveto",a:"elliptical arc",z:"closepath"};for(var Bo in Wa)Wa[Bo.toUpperCase()]=Wa[Bo];function Xn(ee,oe){oe||(oe=[{}]);for(var be=oe.length;be--;){var de={code:ee,command:Wa[ee]};ee==ee.toLowerCase()&&(de.relative=!0);for(var Ce in oe[be])de[Ce]=oe[be][Ce];oe[be]=de}return oe}if(Ne=c(),Ne!==o&&W===s.length)return Ne;throw Ne!==o&&W<s.length&&ft(Je()),kt(Ue,ze<s.length?s.charAt(ze):null,ze<s.length?qe(ze,ze+1):qe(ze,ze))}t.exports={SyntaxError:i,parse:n}}),Qre=h0((e,t)=>{var r=Uwe().parse;r.parseSVG=r,r.makeAbsolute=i,t.exports=r;function i(n){var s,a={x:0,y:0},o={x:"x0",y:"y0",x1:"x0",y1:"y0",x2:"x0",y2:"y0"};return n.forEach(function(l){l.command==="moveto"&&(s=l),l.x0=a.x,l.y0=a.y;for(var c in o)c in l&&(l[c]+=l.relative?l[o[c]]:0);"x"in l||(l.x=a.x),"y"in l||(l.y=a.y),l.relative=!1,l.code=l.code.toUpperCase(),l.command=="closepath"&&(l.x=s.x,l.y=s.y),a=l}),n}}),Hwe=h0((e,t)=>{t.exports=function(r,i){for(var n=r.split("."),s=i.split("."),a=0;a<3;a++){var o=Number(n[a]),l=Number(s[a]);if(o>l)return 1;if(l>o)return-1;if(!isNaN(o)&&isNaN(l))return 1;if(isNaN(o)&&!isNaN(l))return-1}return 0}}),Gx="149",Sl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Gwe=0,YH=1,Wwe=2,j6=1,qwe=2,vw=3,zc=0,Ys=1,La=2,cs=0,Ag=1,XH=2,$H=3,KH=4,Ywe=5,Jv=100,Xwe=101,$we=102,QH=103,ZH=104,Kwe=200,Qwe=201,Zwe=202,Jwe=203,Zre=204,Jre=205,e2e=206,t2e=207,r2e=208,i2e=209,n2e=210,s2e=0,a2e=1,o2e=2,Aj=3,l2e=4,c2e=5,u2e=6,d2e=7,eie=0,h2e=1,f2e=2,zu=0,p2e=1,m2e=2,g2e=3,v2e=4,y2e=5,tie=300,Ug=301,Hg=302,Cj=303,Tj=304,N_=306,fh=1e3,an=1001,Mj=1002,jr=1003,JH=1004,CR=1005,Pr=1006,x2e=1007,nx=1008,Fa=1009,b2e=1010,w2e=1011,rie=1012,_2e=1013,ph=1014,Ni=1015,Rh=1016,S2e=1017,E2e=1018,Cg=1020,A2e=1021,dn=1023,C2e=1024,T2e=1025,Tg=1026,Gg=1027,rT=1028,M2e=1029,tM=1030,P2e=1031,iie=1033,TR=33776,MR=33777,PR=33778,DR=33779,eG=35840,tG=35841,rG=35842,iG=35843,D2e=36196,nG=37492,sG=37496,aG=37808,oG=37809,lG=37810,cG=37811,uG=37812,dG=37813,hG=37814,fG=37815,pG=37816,mG=37817,gG=37818,vG=37819,yG=37820,xG=37821,NR=36492,N2e=36283,bG=36284,wG=36285,_G=36286,nie=2200,sie=2201,L6=2202,rM=2300,iM=2301,kR=2302,py=2400,my=2401,nM=2402,z6=2500,k2e=2501,Bc=3e3,Ar=3001,Kh=3200,aie=3201,R2e=0,I2e=1,Au="srgb",sM="srgb-linear",RR=7680,O2e=519,Pj=35044,j2e=35048,Dj="300 es",Nj=1035,wa=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let i=0,n=r.length;i<n;i++)r[i].call(this,e);e.target=null}}},Ta=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],SG=1234567,Uw=Math.PI/180,T2=180/Math.PI;function Gl(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Ta[e&255]+Ta[e>>8&255]+Ta[e>>16&255]+Ta[e>>24&255]+"-"+Ta[t&255]+Ta[t>>8&255]+"-"+Ta[t>>16&15|64]+Ta[t>>24&255]+"-"+Ta[r&63|128]+Ta[r>>8&255]+"-"+Ta[r>>16&255]+Ta[r>>24&255]+Ta[i&255]+Ta[i>>8&255]+Ta[i>>16&255]+Ta[i>>24&255]).toLowerCase()}function ns(e,t,r){return Math.max(t,Math.min(r,e))}function B6(e,t){return(e%t+t)%t}function L2e(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)}function z2e(e,t,r){return e!==t?(r-e)/(t-e):0}function Hw(e,t,r){return(1-r)*e+r*t}function B2e(e,t,r,i){return Hw(e,t,1-Math.exp(-r*i))}function F2e(e,t=1){return t-Math.abs(B6(e,t*2)-t)}function V2e(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))}function U2e(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(e*6-15)+10))}function H2e(e,t){return e+Math.floor(Math.random()*(t-e+1))}function G2e(e,t){return e+Math.random()*(t-e)}function W2e(e){return e*(.5-Math.random())}function q2e(e){e!==void 0&&(SG=e);let t=SG+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function Y2e(e){return e*Uw}function X2e(e){return e*T2}function kj(e){return(e&e-1)===0&&e!==0}function oie(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function aM(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function $2e(e,t,r,i,n){let s=Math.cos,a=Math.sin,o=s(r/2),l=a(r/2),c=s((t+i)/2),u=a((t+i)/2),d=s((t-i)/2),f=a((t-i)/2),m=s((i-t)/2),v=a((i-t)/2);switch(n){case"XYX":e.set(o*u,l*d,l*f,o*c);break;case"YZY":e.set(l*f,o*u,l*d,o*c);break;case"ZXZ":e.set(l*d,l*f,o*u,o*c);break;case"XZX":e.set(o*u,l*v,l*m,o*c);break;case"YXY":e.set(l*m,o*u,l*v,o*c);break;case"ZYZ":e.set(l*v,l*m,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function mh(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function qi(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var Ct=Object.freeze({__proto__:null,DEG2RAD:Uw,RAD2DEG:T2,ceilPowerOfTwo:oie,clamp:ns,damp:B2e,degToRad:Y2e,denormalize:mh,euclideanModulo:B6,floorPowerOfTwo:aM,generateUUID:Gl,inverseLerp:z2e,isPowerOfTwo:kj,lerp:Hw,mapLinear:L2e,normalize:qi,pingpong:F2e,radToDeg:X2e,randFloat:G2e,randFloatSpread:W2e,randInt:H2e,seededRandom:q2e,setQuaternionFromProperEuler:$2e,smootherstep:U2e,smoothstep:V2e}),ge=class{constructor(t=0,r=0){ge.prototype.isVector2=!0,this.x=t,this.y=r}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,r){return this.x=t,this.y=r,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this}addScaledVector(t,r){return this.x+=t.x*r,this.y+=t.y*r,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){let r=this.x,i=this.y,n=t.elements;return this.x=n[0]*r+n[3]*i+n[6],this.y=n[1]*r+n[4]*i+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this}clampScalar(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this}clampLength(t,r){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let r=this.x-t.x,i=this.y-t.y;return r*r+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this}lerpVectors(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,r=0){return this.x=t[r],this.y=t[r+1],this}toArray(t=[],r=0){return t[r]=this.x,t[r+1]=this.y,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this}rotateAround(t,r){let i=Math.cos(r),n=Math.sin(r),s=this.x-t.x,a=this.y-t.y;return this.x=s*i-a*n+t.x,this.y=s*n+a*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},as=class{constructor(){as.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,n,s,a,o,l){let c=this.elements;return c[0]=e,c[1]=i,c[2]=a,c[3]=t,c[4]=n,c[5]=o,c[6]=r,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],a=r[3],o=r[6],l=r[1],c=r[4],u=r[7],d=r[2],f=r[5],m=r[8],v=i[0],y=i[3],x=i[6],w=i[1],_=i[4],S=i[7],P=i[2],M=i[5],C=i[8];return n[0]=s*v+a*w+o*P,n[3]=s*y+a*_+o*M,n[6]=s*x+a*S+o*C,n[1]=l*v+c*w+u*P,n[4]=l*y+c*_+u*M,n[7]=l*x+c*S+u*C,n[2]=d*v+f*w+m*P,n[5]=d*y+f*_+m*M,n[8]=d*x+f*S+m*C,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-r*n*c+r*a*o+i*n*l-i*s*o}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=c*s-a*l,d=a*o-c*n,f=l*n-s*o,m=t*u+r*d+i*f;if(m===0)return this.set(0,0,0,0,0,0,0,0,0);let v=1/m;return e[0]=u*v,e[1]=(i*l-c*r)*v,e[2]=(a*r-i*s)*v,e[3]=d*v,e[4]=(c*t-i*o)*v,e[5]=(i*n-a*t)*v,e[6]=f*v,e[7]=(r*o-l*t)*v,e[8]=(s*t-r*n)*v,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,s,a){let o=Math.cos(n),l=Math.sin(n);return this.set(r*o,r*l,-r*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(IR.makeScale(e,t)),this}rotate(e){return this.premultiply(IR.makeRotation(-e)),this}translate(e,t){return this.premultiply(IR.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}},IR=new as;function lie(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var K2e={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function GE(e,t){return new K2e[e](t)}function M2(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Q2e(e,t,r){return new Promise(function(i,n){function s(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:n();break;case e.TIMEOUT_EXPIRED:setTimeout(s,r);break;default:i()}}setTimeout(s,r)})}function Mg(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function iT(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var OR={[Au]:{[sM]:Mg},[sM]:{[Au]:iT}},Xa={legacyMode:!0,get workingColorSpace(){return sM},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,r){if(this.legacyMode||t===r||!t||!r)return e;if(OR[t]&&OR[t][r]!==void 0){let i=OR[t][r];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},cie={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ys={r:0,g:0,b:0},nc={h:0,s:0,l:0},WE={h:0,s:0,l:0};function jR(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*6*(2/3-r):e}function qE(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var Zt=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Au){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Xa.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Xa.workingColorSpace){return this.r=e,this.g=t,this.b=r,Xa.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Xa.workingColorSpace){if(e=B6(e,1),t=ns(t,0,1),r=ns(r,0,1),t===0)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+t):r+t-r*t,s=2*r-n;this.r=jR(s,n,e+1/3),this.g=jR(s,n,e),this.b=jR(s,n,e-1/3)}return Xa.toWorkingColorSpace(this,i),this}setStyle(e,t=Au){function r(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let n,s=i[1],a=i[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,Xa.toWorkingColorSpace(this,t),r(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,Xa.toWorkingColorSpace(this,t),r(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){let o=parseFloat(n[1])/360,l=parseFloat(n[2])/100,c=parseFloat(n[3])/100;return r(n[4]),this.setHSL(o,l,c,t)}break}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){let n=i[1],s=n.length;if(s===3)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,Xa.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,Xa.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Au){let r=cie[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Mg(e.r),this.g=Mg(e.g),this.b=Mg(e.b),this}copyLinearToSRGB(e){return this.r=iT(e.r),this.g=iT(e.g),this.b=iT(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Au){return Xa.fromWorkingColorSpace(qE(this,ys),e),ns(ys.r*255,0,255)<<16^ns(ys.g*255,0,255)<<8^ns(ys.b*255,0,255)<<0}getHexString(e=Au){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Xa.workingColorSpace){Xa.fromWorkingColorSpace(qE(this,ys),t);let r=ys.r,i=ys.g,n=ys.b,s=Math.max(r,i,n),a=Math.min(r,i,n),o,l,c=(a+s)/2;if(a===s)o=0,l=0;else{let u=s-a;switch(l=c<=.5?u/(s+a):u/(2-s-a),s){case r:o=(i-n)/u+(i<n?6:0);break;case i:o=(n-r)/u+2;break;case n:o=(r-i)/u+4;break}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e,t=Xa.workingColorSpace){return Xa.fromWorkingColorSpace(qE(this,ys),t),e.r=ys.r,e.g=ys.g,e.b=ys.b,e}getStyle(e=Au){return Xa.fromWorkingColorSpace(qE(this,ys),e),e!==Au?`color(${e} ${ys.r} ${ys.g} ${ys.b})`:`rgb(${ys.r*255|0},${ys.g*255|0},${ys.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(nc),nc.h+=e,nc.s+=t,nc.l+=r,this.setHSL(nc.h,nc.s,nc.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(nc),e.getHSL(WE);let r=Hw(nc.h,WE.h,t),i=Hw(nc.s,WE.s,t),n=Hw(nc.l,WE.l,t);return this.setHSL(r,i,n),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Zt.NAMES=cie;var hv,uie=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{hv===void 0&&(hv=M2("canvas")),hv.width=e.width,hv.height=e.height;let r=hv.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=hv}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=M2("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let i=r.getImageData(0,0,e.width,e.height),n=i.data;for(let s=0;s<n.length;s++)n[s]=Mg(n[s]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Mg(t[r]/255)*255):t[r]=Mg(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},die=class{constructor(e=null){this.isSource=!0,this.uuid=Gl(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let n;if(Array.isArray(i)){n=[];for(let s=0,a=i.length;s<a;s++)i[s].isDataTexture?n.push(LR(i[s].image)):n.push(LR(i[s]))}else n=LR(i);r.url=n}return t||(e.images[this.uuid]=r),r}};function LR(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?uie.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Z2e=0,yn=class extends wa{constructor(e=yn.DEFAULT_IMAGE,t=yn.DEFAULT_MAPPING,r=an,i=an,n=Pr,s=nx,a=dn,o=Fa,l=yn.DEFAULT_ANISOTROPY,c=Bc){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Z2e++}),this.uuid=Gl(),this.name="",this.source=new die(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new ge(0,0),this.repeat=new ge(1,1),this.center=new ge(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new as,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==tie)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case fh:e.x=e.x-Math.floor(e.x);break;case an:e.x=e.x<0?0:1;break;case Mj:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case fh:e.y=e.y-Math.floor(e.y);break;case an:e.y=e.y<0?0:1;break;case Mj:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};yn.DEFAULT_IMAGE=null;yn.DEFAULT_MAPPING=tie;yn.DEFAULT_ANISOTROPY=1;var fr=class{constructor(e=0,t=0,r=0,i=1){fr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*t+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*t+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*t+s[7]*r+s[11]*i+s[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n,s=e.elements,a=s[0],o=s[4],l=s[8],c=s[1],u=s[5],d=s[9],f=s[2],m=s[6],v=s[10];if(Math.abs(o-c)<.01&&Math.abs(l-f)<.01&&Math.abs(d-m)<.01){if(Math.abs(o+c)<.1&&Math.abs(l+f)<.1&&Math.abs(d+m)<.1&&Math.abs(a+u+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let x=(a+1)/2,w=(u+1)/2,_=(v+1)/2,S=(o+c)/4,P=(l+f)/4,M=(d+m)/4;return x>w&&x>_?x<.01?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(x),i=S/r,n=P/r):w>_?w<.01?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(w),r=S/i,n=M/i):_<.01?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(_),r=P/n,i=M/n),this.set(r,i,n,t),this}let y=Math.sqrt((m-d)*(m-d)+(l-f)*(l-f)+(c-o)*(c-o));return Math.abs(y)<.001&&(y=1),this.x=(m-d)/y,this.y=(l-f)/y,this.z=(c-o)/y,this.w=Math.acos((a+u+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Zr=class extends wa{constructor(t=1,r=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=r,this.depth=1,this.scissor=new fr(0,0,t,r),this.scissorTest=!1,this.viewport=new fr(0,0,t,r);let n={width:t,height:r,depth:1};this.texture=new yn(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Pr,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(t,r,i=1){(this.width!==t||this.height!==r||this.depth!==i)&&(this.width=t,this.height=r,this.depth=i,this.texture.image.width=t,this.texture.image.height=r,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,t,r),this.scissor.set(0,0,t,r)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;let r=Object.assign({},t.texture.image);return this.texture.source=new die(r),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},hie=class extends yn{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=jr,this.minFilter=jr,this.wrapR=an,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},J2e=class extends yn{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=jr,this.minFilter=jr,this.wrapR=an,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},fie=class extends Zr{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;let n=this.texture;this.texture=[];for(let s=0;s<r;s++)this.texture[s]=n.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,n=this.texture.length;i<n;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},ar=class{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,n,s,a){let o=r[i+0],l=r[i+1],c=r[i+2],u=r[i+3],d=n[s+0],f=n[s+1],m=n[s+2],v=n[s+3];if(a===0){e[t+0]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u;return}if(a===1){e[t+0]=d,e[t+1]=f,e[t+2]=m,e[t+3]=v;return}if(u!==v||o!==d||l!==f||c!==m){let y=1-a,x=o*d+l*f+c*m+u*v,w=x>=0?1:-1,_=1-x*x;if(_>Number.EPSILON){let P=Math.sqrt(_),M=Math.atan2(P,x*w);y=Math.sin(y*M)/P,a=Math.sin(a*M)/P}let S=a*w;if(o=o*y+d*S,l=l*y+f*S,c=c*y+m*S,u=u*y+v*S,y===1-a){let P=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=P,l*=P,c*=P,u*=P}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,i,n,s){let a=r[i],o=r[i+1],l=r[i+2],c=r[i+3],u=n[s],d=n[s+1],f=n[s+2],m=n[s+3];return e[t]=a*m+c*u+o*f-l*d,e[t+1]=o*m+c*d+l*u-a*f,e[t+2]=l*m+c*f+a*d-o*u,e[t+3]=c*m-a*u-o*d-l*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let r=e._x,i=e._y,n=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(r/2),c=a(i/2),u=a(n/2),d=o(r/2),f=o(i/2),m=o(n/2);switch(s){case"XYZ":this._x=d*c*u+l*f*m,this._y=l*f*u-d*c*m,this._z=l*c*m+d*f*u,this._w=l*c*u-d*f*m;break;case"YXZ":this._x=d*c*u+l*f*m,this._y=l*f*u-d*c*m,this._z=l*c*m-d*f*u,this._w=l*c*u+d*f*m;break;case"ZXY":this._x=d*c*u-l*f*m,this._y=l*f*u+d*c*m,this._z=l*c*m+d*f*u,this._w=l*c*u-d*f*m;break;case"ZYX":this._x=d*c*u-l*f*m,this._y=l*f*u+d*c*m,this._z=l*c*m-d*f*u,this._w=l*c*u+d*f*m;break;case"YZX":this._x=d*c*u+l*f*m,this._y=l*f*u+d*c*m,this._z=l*c*m-d*f*u,this._w=l*c*u-d*f*m;break;case"XZY":this._x=d*c*u-l*f*m,this._y=l*f*u-d*c*m,this._z=l*c*m+d*f*u,this._w=l*c*u+d*f*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],i=t[4],n=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],u=t[10],d=r+a+u;if(d>0){let f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(c-o)*f,this._y=(n-l)*f,this._z=(s-i)*f}else if(r>a&&r>u){let f=2*Math.sqrt(1+r-a-u);this._w=(c-o)/f,this._x=.25*f,this._y=(i+s)/f,this._z=(n+l)/f}else if(a>u){let f=2*Math.sqrt(1+a-r-u);this._w=(n-l)/f,this._x=(i+s)/f,this._y=.25*f,this._z=(o+c)/f}else{let f=2*Math.sqrt(1+u-r-a);this._w=(s-i)/f,this._x=(n+l)/f,this._y=(o+c)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ns(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,i=e._y,n=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=r*c+s*a+i*l-n*o,this._y=i*c+s*o+n*a-r*l,this._z=n*c+s*l+r*o-i*a,this._w=s*c-r*a-i*o-n*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,i=this._y,n=this._z,s=this._w,a=s*e._w+r*e._x+i*e._y+n*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;let o=1-a*a;if(o<=Number.EPSILON){let f=1-t;return this._w=f*s+t*this._w,this._x=f*r+t*this._x,this._y=f*i+t*this._y,this._z=f*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,d=Math.sin(t*c)/l;return this._w=s*u+this._w*d,this._x=r*u+this._x*d,this._y=i*u+this._y*d,this._z=n*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(n),r*Math.cos(n),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},V=class{constructor(t=0,r=0,i=0){V.prototype.isVector3=!0,this.x=t,this.y=r,this.z=i}set(t,r,i){return i===void 0&&(i=this.z),this.x=t,this.y=r,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this}addScaledVector(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,r){return this.x=t.x*r.x,this.y=t.y*r.y,this.z=t.z*r.z,this}applyEuler(t){return this.applyQuaternion(EG.setFromEuler(t))}applyAxisAngle(t,r){return this.applyQuaternion(EG.setFromAxisAngle(t,r))}applyMatrix3(t){let r=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*r+s[3]*i+s[6]*n,this.y=s[1]*r+s[4]*i+s[7]*n,this.z=s[2]*r+s[5]*i+s[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){let r=this.x,i=this.y,n=this.z,s=t.elements,a=1/(s[3]*r+s[7]*i+s[11]*n+s[15]);return this.x=(s[0]*r+s[4]*i+s[8]*n+s[12])*a,this.y=(s[1]*r+s[5]*i+s[9]*n+s[13])*a,this.z=(s[2]*r+s[6]*i+s[10]*n+s[14])*a,this}applyQuaternion(t){let r=this.x,i=this.y,n=this.z,s=t.x,a=t.y,o=t.z,l=t.w,c=l*r+a*n-o*i,u=l*i+o*r-s*n,d=l*n+s*i-a*r,f=-s*r-a*i-o*n;return this.x=c*l+f*-s+u*-o-d*-a,this.y=u*l+f*-a+d*-s-c*-o,this.z=d*l+f*-o+c*-a-u*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){let r=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*r+s[4]*i+s[8]*n,this.y=s[1]*r+s[5]*i+s[9]*n,this.z=s[2]*r+s[6]*i+s[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this}clampScalar(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this}clampLength(t,r){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this}lerpVectors(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this.z=t.z+(r.z-t.z)*i,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,r){let i=t.x,n=t.y,s=t.z,a=r.x,o=r.y,l=r.z;return this.x=n*l-s*o,this.y=s*a-i*l,this.z=i*o-n*a,this}projectOnVector(t){let r=t.lengthSq();if(r===0)return this.set(0,0,0);let i=t.dot(this)/r;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return zR.copy(this).projectOnVector(t),this.sub(zR)}reflect(t){return this.sub(zR.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){let r=Math.sqrt(this.lengthSq()*t.lengthSq());if(r===0)return Math.PI/2;let i=this.dot(t)/r;return Math.acos(ns(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let r=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return r*r+i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,r,i){let n=Math.sin(r)*t;return this.x=n*Math.sin(i),this.y=Math.cos(r)*t,this.z=n*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,r,i){return this.x=t*Math.sin(r),this.y=i,this.z=t*Math.cos(r),this}setFromMatrixPosition(t){let r=t.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this}setFromMatrixScale(t){let r=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=r,this.y=i,this.z=n,this}setFromMatrixColumn(t,r){return this.fromArray(t.elements,r*4)}setFromMatrix3Column(t,r){return this.fromArray(t.elements,r*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,r=0){return this.x=t[r],this.y=t[r+1],this.z=t[r+2],this}toArray(t=[],r=0){return t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let t=(Math.random()-.5)*2,r=Math.random()*Math.PI*2,i=Math.sqrt(1-t**2);return this.x=i*Math.cos(r),this.y=i*Math.sin(r),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},zR=new V,EG=new ar,Wn=class{constructor(t=new V(1/0,1/0,1/0),r=new V(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=r}set(t,r){return this.min.copy(t),this.max.copy(r),this}setFromArray(t){let r=1/0,i=1/0,n=1/0,s=-1/0,a=-1/0,o=-1/0;for(let l=0,c=t.length;l<c;l+=3){let u=t[l],d=t[l+1],f=t[l+2];u<r&&(r=u),d<i&&(i=d),f<n&&(n=f),u>s&&(s=u),d>a&&(a=d),f>o&&(o=f)}return this.min.set(r,i,n),this.max.set(s,a,o),this}setFromBufferAttribute(t){let r=1/0,i=1/0,n=1/0,s=-1/0,a=-1/0,o=-1/0;for(let l=0,c=t.count;l<c;l++){let u=t.getX(l),d=t.getY(l),f=t.getZ(l);u<r&&(r=u),d<i&&(i=d),f<n&&(n=f),u>s&&(s=u),d>a&&(a=d),f>o&&(o=f)}return this.min.set(r,i,n),this.max.set(s,a,o),this}setFromPoints(t){this.makeEmpty();for(let r=0,i=t.length;r<i;r++)this.expandByPoint(t[r]);return this}setFromCenterAndSize(t,r){let i=Om.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,r=!1){return this.makeEmpty(),this.expandByObject(t,r)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,r=!1){t.updateWorldMatrix(!1,!1);let i=t.geometry;if(i!==void 0)if(r&&i.attributes!=null&&i.attributes.position!==void 0){let s=i.attributes.position;for(let a=0,o=s.count;a<o;a++)Om.fromBufferAttribute(s,a).applyMatrix4(t.matrixWorld),this.expandByPoint(Om)}else i.boundingBox===null&&i.computeBoundingBox(),BR.copy(i.boundingBox),BR.applyMatrix4(t.matrixWorld),this.union(BR);let n=t.children;for(let s=0,a=n.length;s<a;s++)this.expandByObject(n[s],r);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,r){return r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Om),Om.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let r,i;return t.normal.x>0?(r=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(r=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(r+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(r+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(r+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(r+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),r<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(T1),YE.subVectors(this.max,T1),fv.subVectors(t.a,T1),pv.subVectors(t.b,T1),mv.subVectors(t.c,T1),Af.subVectors(pv,fv),Cf.subVectors(mv,pv),jm.subVectors(fv,mv);let r=[0,-Af.z,Af.y,0,-Cf.z,Cf.y,0,-jm.z,jm.y,Af.z,0,-Af.x,Cf.z,0,-Cf.x,jm.z,0,-jm.x,-Af.y,Af.x,0,-Cf.y,Cf.x,0,-jm.y,jm.x,0];return!FR(r,fv,pv,mv,YE)||(r=[1,0,0,0,1,0,0,0,1],!FR(r,fv,pv,mv,YE))?!1:(XE.crossVectors(Af,Cf),r=[XE.x,XE.y,XE.z],FR(r,fv,pv,mv,YE))}clampPoint(t,r){return r.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Om.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(Om).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Ld[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ld[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ld[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ld[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ld[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ld[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ld[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ld[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ld),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},Ld=[new V,new V,new V,new V,new V,new V,new V,new V],Om=new V,BR=new Wn,fv=new V,pv=new V,mv=new V,Af=new V,Cf=new V,jm=new V,T1=new V,YE=new V,XE=new V,Lm=new V;function FR(e,t,r,i,n){for(let s=0,a=e.length-3;s<=a;s+=3){Lm.fromArray(e,s);let o=n.x*Math.abs(Lm.x)+n.y*Math.abs(Lm.y)+n.z*Math.abs(Lm.z),l=t.dot(Lm),c=r.dot(Lm),u=i.dot(Lm);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}var e_e=new Wn,M1=new V,VR=new V,Oo=class{constructor(e=new V,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):e_e.setFromPoints(e).getCenter(r);let i=0;for(let n=0,s=e.length;n<s;n++)i=Math.max(i,r.distanceToSquared(e[n]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;M1.subVectors(e,this.center);let t=M1.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(M1,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(VR.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(M1.copy(e.center).add(VR)),this.expandByPoint(M1.copy(e.center).sub(VR))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},zd=new V,UR=new V,$E=new V,Tf=new V,HR=new V,KE=new V,GR=new V,Wx=class{constructor(e=new V,t=new V(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,zd)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=zd.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(zd.copy(this.direction).multiplyScalar(t).add(this.origin),zd.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){UR.copy(e).add(t).multiplyScalar(.5),$E.copy(t).sub(e).normalize(),Tf.copy(this.origin).sub(UR);let n=e.distanceTo(t)*.5,s=-this.direction.dot($E),a=Tf.dot(this.direction),o=-Tf.dot($E),l=Tf.lengthSq(),c=Math.abs(1-s*s),u,d,f,m;if(c>0)if(u=s*o-a,d=s*a-o,m=n*c,u>=0)if(d>=-m)if(d<=m){let v=1/c;u*=v,d*=v,f=u*(u+s*d+2*a)+d*(s*u+d+2*o)+l}else d=n,u=Math.max(0,-(s*d+a)),f=-u*u+d*(d+2*o)+l;else d=-n,u=Math.max(0,-(s*d+a)),f=-u*u+d*(d+2*o)+l;else d<=-m?(u=Math.max(0,-(-s*n+a)),d=u>0?-n:Math.min(Math.max(-n,-o),n),f=-u*u+d*(d+2*o)+l):d<=m?(u=0,d=Math.min(Math.max(-n,-o),n),f=d*(d+2*o)+l):(u=Math.max(0,-(s*n+a)),d=u>0?n:Math.min(Math.max(-n,-o),n),f=-u*u+d*(d+2*o)+l);else d=s>0?-n:n,u=Math.max(0,-(s*d+a)),f=-u*u+d*(d+2*o)+l;return r&&r.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy($E).multiplyScalar(d).add(UR),f}intersectSphere(e,t){zd.subVectors(e.center,this.origin);let r=zd.dot(this.direction),i=zd.dot(zd)-r*r,n=e.radius*e.radius;if(i>n)return null;let s=Math.sqrt(n-i),a=r-s,o=r+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,n,s,a,o,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,d=this.origin;return l>=0?(r=(e.min.x-d.x)*l,i=(e.max.x-d.x)*l):(r=(e.max.x-d.x)*l,i=(e.min.x-d.x)*l),c>=0?(n=(e.min.y-d.y)*c,s=(e.max.y-d.y)*c):(n=(e.max.y-d.y)*c,s=(e.min.y-d.y)*c),r>s||n>i||((n>r||isNaN(r))&&(r=n),(s<i||isNaN(i))&&(i=s),u>=0?(a=(e.min.z-d.z)*u,o=(e.max.z-d.z)*u):(a=(e.max.z-d.z)*u,o=(e.min.z-d.z)*u),r>o||a>i)||((a>r||r!==r)&&(r=a),(o<i||i!==i)&&(i=o),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,zd)!==null}intersectTriangle(e,t,r,i,n){HR.subVectors(t,e),KE.subVectors(r,e),GR.crossVectors(HR,KE);let s=this.direction.dot(GR),a;if(s>0){if(i)return null;a=1}else if(s<0)a=-1,s=-s;else return null;Tf.subVectors(this.origin,e);let o=a*this.direction.dot(KE.crossVectors(Tf,KE));if(o<0)return null;let l=a*this.direction.dot(HR.cross(Tf));if(l<0||o+l>s)return null;let c=-a*Tf.dot(GR);return c<0?null:this.at(c/s,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},ot=class{constructor(){ot.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(t,r,i,n,s,a,o,l,c,u,d,f,m,v,y,x){let w=this.elements;return w[0]=t,w[4]=r,w[8]=i,w[12]=n,w[1]=s,w[5]=a,w[9]=o,w[13]=l,w[2]=c,w[6]=u,w[10]=d,w[14]=f,w[3]=m,w[7]=v,w[11]=y,w[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ot().fromArray(this.elements)}copy(t){let r=this.elements,i=t.elements;return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],this}copyPosition(t){let r=this.elements,i=t.elements;return r[12]=i[12],r[13]=i[13],r[14]=i[14],this}setFromMatrix3(t){let r=t.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractBasis(t,r,i){return t.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,r,i){return this.set(t.x,r.x,i.x,0,t.y,r.y,i.y,0,t.z,r.z,i.z,0,0,0,0,1),this}extractRotation(t){let r=this.elements,i=t.elements,n=1/gv.setFromMatrixColumn(t,0).length(),s=1/gv.setFromMatrixColumn(t,1).length(),a=1/gv.setFromMatrixColumn(t,2).length();return r[0]=i[0]*n,r[1]=i[1]*n,r[2]=i[2]*n,r[3]=0,r[4]=i[4]*s,r[5]=i[5]*s,r[6]=i[6]*s,r[7]=0,r[8]=i[8]*a,r[9]=i[9]*a,r[10]=i[10]*a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(t){let r=this.elements,i=t.x,n=t.y,s=t.z,a=Math.cos(i),o=Math.sin(i),l=Math.cos(n),c=Math.sin(n),u=Math.cos(s),d=Math.sin(s);if(t.order==="XYZ"){let f=a*u,m=a*d,v=o*u,y=o*d;r[0]=l*u,r[4]=-l*d,r[8]=c,r[1]=m+v*c,r[5]=f-y*c,r[9]=-o*l,r[2]=y-f*c,r[6]=v+m*c,r[10]=a*l}else if(t.order==="YXZ"){let f=l*u,m=l*d,v=c*u,y=c*d;r[0]=f+y*o,r[4]=v*o-m,r[8]=a*c,r[1]=a*d,r[5]=a*u,r[9]=-o,r[2]=m*o-v,r[6]=y+f*o,r[10]=a*l}else if(t.order==="ZXY"){let f=l*u,m=l*d,v=c*u,y=c*d;r[0]=f-y*o,r[4]=-a*d,r[8]=v+m*o,r[1]=m+v*o,r[5]=a*u,r[9]=y-f*o,r[2]=-a*c,r[6]=o,r[10]=a*l}else if(t.order==="ZYX"){let f=a*u,m=a*d,v=o*u,y=o*d;r[0]=l*u,r[4]=v*c-m,r[8]=f*c+y,r[1]=l*d,r[5]=y*c+f,r[9]=m*c-v,r[2]=-c,r[6]=o*l,r[10]=a*l}else if(t.order==="YZX"){let f=a*l,m=a*c,v=o*l,y=o*c;r[0]=l*u,r[4]=y-f*d,r[8]=v*d+m,r[1]=d,r[5]=a*u,r[9]=-o*u,r[2]=-c*u,r[6]=m*d+v,r[10]=f-y*d}else if(t.order==="XZY"){let f=a*l,m=a*c,v=o*l,y=o*c;r[0]=l*u,r[4]=-d,r[8]=c*u,r[1]=f*d+y,r[5]=a*u,r[9]=m*d-v,r[2]=v*d-m,r[6]=o*u,r[10]=y*d+f}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(t){return this.compose(t_e,t,r_e)}lookAt(t,r,i){let n=this.elements;return $o.subVectors(t,r),$o.lengthSq()===0&&($o.z=1),$o.normalize(),Mf.crossVectors(i,$o),Mf.lengthSq()===0&&(Math.abs(i.z)===1?$o.x+=1e-4:$o.z+=1e-4,$o.normalize(),Mf.crossVectors(i,$o)),Mf.normalize(),QE.crossVectors($o,Mf),n[0]=Mf.x,n[4]=QE.x,n[8]=$o.x,n[1]=Mf.y,n[5]=QE.y,n[9]=$o.y,n[2]=Mf.z,n[6]=QE.z,n[10]=$o.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,r){let i=t.elements,n=r.elements,s=this.elements,a=i[0],o=i[4],l=i[8],c=i[12],u=i[1],d=i[5],f=i[9],m=i[13],v=i[2],y=i[6],x=i[10],w=i[14],_=i[3],S=i[7],P=i[11],M=i[15],C=n[0],T=n[4],E=n[8],N=n[12],D=n[1],I=n[5],j=n[9],L=n[13],B=n[2],q=n[6],G=n[10],Y=n[14],X=n[3],re=n[7],F=n[11],$=n[15];return s[0]=a*C+o*D+l*B+c*X,s[4]=a*T+o*I+l*q+c*re,s[8]=a*E+o*j+l*G+c*F,s[12]=a*N+o*L+l*Y+c*$,s[1]=u*C+d*D+f*B+m*X,s[5]=u*T+d*I+f*q+m*re,s[9]=u*E+d*j+f*G+m*F,s[13]=u*N+d*L+f*Y+m*$,s[2]=v*C+y*D+x*B+w*X,s[6]=v*T+y*I+x*q+w*re,s[10]=v*E+y*j+x*G+w*F,s[14]=v*N+y*L+x*Y+w*$,s[3]=_*C+S*D+P*B+M*X,s[7]=_*T+S*I+P*q+M*re,s[11]=_*E+S*j+P*G+M*F,s[15]=_*N+S*L+P*Y+M*$,this}multiplyScalar(t){let r=this.elements;return r[0]*=t,r[4]*=t,r[8]*=t,r[12]*=t,r[1]*=t,r[5]*=t,r[9]*=t,r[13]*=t,r[2]*=t,r[6]*=t,r[10]*=t,r[14]*=t,r[3]*=t,r[7]*=t,r[11]*=t,r[15]*=t,this}determinant(){let t=this.elements,r=t[0],i=t[4],n=t[8],s=t[12],a=t[1],o=t[5],l=t[9],c=t[13],u=t[2],d=t[6],f=t[10],m=t[14],v=t[3],y=t[7],x=t[11],w=t[15];return v*(+s*l*d-n*c*d-s*o*f+i*c*f+n*o*m-i*l*m)+y*(+r*l*m-r*c*f+s*a*f-n*a*m+n*c*u-s*l*u)+x*(+r*c*d-r*o*m-s*a*d+i*a*m+s*o*u-i*c*u)+w*(-n*o*u-r*l*d+r*o*f+n*a*d-i*a*f+i*l*u)}transpose(){let t=this.elements,r;return r=t[1],t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,this}setPosition(t,r,i){let n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=r,n[14]=i),this}invert(){let t=this.elements,r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=t[8],d=t[9],f=t[10],m=t[11],v=t[12],y=t[13],x=t[14],w=t[15],_=d*x*c-y*f*c+y*l*m-o*x*m-d*l*w+o*f*w,S=v*f*c-u*x*c-v*l*m+a*x*m+u*l*w-a*f*w,P=u*y*c-v*d*c+v*o*m-a*y*m-u*o*w+a*d*w,M=v*d*l-u*y*l-v*o*f+a*y*f+u*o*x-a*d*x,C=r*_+i*S+n*P+s*M;if(C===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let T=1/C;return t[0]=_*T,t[1]=(y*f*s-d*x*s-y*n*m+i*x*m+d*n*w-i*f*w)*T,t[2]=(o*x*s-y*l*s+y*n*c-i*x*c-o*n*w+i*l*w)*T,t[3]=(d*l*s-o*f*s-d*n*c+i*f*c+o*n*m-i*l*m)*T,t[4]=S*T,t[5]=(u*x*s-v*f*s+v*n*m-r*x*m-u*n*w+r*f*w)*T,t[6]=(v*l*s-a*x*s-v*n*c+r*x*c+a*n*w-r*l*w)*T,t[7]=(a*f*s-u*l*s+u*n*c-r*f*c-a*n*m+r*l*m)*T,t[8]=P*T,t[9]=(v*d*s-u*y*s-v*i*m+r*y*m+u*i*w-r*d*w)*T,t[10]=(a*y*s-v*o*s+v*i*c-r*y*c-a*i*w+r*o*w)*T,t[11]=(u*o*s-a*d*s-u*i*c+r*d*c+a*i*m-r*o*m)*T,t[12]=M*T,t[13]=(u*y*n-v*d*n+v*i*f-r*y*f-u*i*x+r*d*x)*T,t[14]=(v*o*n-a*y*n-v*i*l+r*y*l+a*i*x-r*o*x)*T,t[15]=(a*d*n-u*o*n+u*i*l-r*d*l-a*i*f+r*o*f)*T,this}scale(t){let r=this.elements,i=t.x,n=t.y,s=t.z;return r[0]*=i,r[4]*=n,r[8]*=s,r[1]*=i,r[5]*=n,r[9]*=s,r[2]*=i,r[6]*=n,r[10]*=s,r[3]*=i,r[7]*=n,r[11]*=s,this}getMaxScaleOnAxis(){let t=this.elements,r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(r,i,n))}makeTranslation(t,r,i){return this.set(1,0,0,t,0,1,0,r,0,0,1,i,0,0,0,1),this}makeRotationX(t){let r=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,r,-i,0,0,i,r,0,0,0,0,1),this}makeRotationY(t){let r=Math.cos(t),i=Math.sin(t);return this.set(r,0,i,0,0,1,0,0,-i,0,r,0,0,0,0,1),this}makeRotationZ(t){let r=Math.cos(t),i=Math.sin(t);return this.set(r,-i,0,0,i,r,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,r){let i=Math.cos(r),n=Math.sin(r),s=1-i,a=t.x,o=t.y,l=t.z,c=s*a,u=s*o;return this.set(c*a+i,c*o-n*l,c*l+n*o,0,c*o+n*l,u*o+i,u*l-n*a,0,c*l-n*o,u*l+n*a,s*l*l+i,0,0,0,0,1),this}makeScale(t,r,i){return this.set(t,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,r,i,n,s,a){return this.set(1,i,s,0,t,1,a,0,r,n,1,0,0,0,0,1),this}compose(t,r,i){let n=this.elements,s=r._x,a=r._y,o=r._z,l=r._w,c=s+s,u=a+a,d=o+o,f=s*c,m=s*u,v=s*d,y=a*u,x=a*d,w=o*d,_=l*c,S=l*u,P=l*d,M=i.x,C=i.y,T=i.z;return n[0]=(1-(y+w))*M,n[1]=(m+P)*M,n[2]=(v-S)*M,n[3]=0,n[4]=(m-P)*C,n[5]=(1-(f+w))*C,n[6]=(x+_)*C,n[7]=0,n[8]=(v+S)*T,n[9]=(x-_)*T,n[10]=(1-(f+y))*T,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,r,i){let n=this.elements,s=gv.set(n[0],n[1],n[2]).length(),a=gv.set(n[4],n[5],n[6]).length(),o=gv.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),t.x=n[12],t.y=n[13],t.z=n[14],sc.copy(this);let l=1/s,c=1/a,u=1/o;return sc.elements[0]*=l,sc.elements[1]*=l,sc.elements[2]*=l,sc.elements[4]*=c,sc.elements[5]*=c,sc.elements[6]*=c,sc.elements[8]*=u,sc.elements[9]*=u,sc.elements[10]*=u,r.setFromRotationMatrix(sc),i.x=s,i.y=a,i.z=o,this}makePerspective(t,r,i,n,s,a){let o=this.elements,l=2*s/(r-t),c=2*s/(i-n),u=(r+t)/(r-t),d=(i+n)/(i-n),f=-(a+s)/(a-s),m=-2*a*s/(a-s);return o[0]=l,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=c,o[9]=d,o[13]=0,o[2]=0,o[6]=0,o[10]=f,o[14]=m,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,r,i,n,s,a){let o=this.elements,l=1/(r-t),c=1/(i-n),u=1/(a-s),d=(r+t)*l,f=(i+n)*c,m=(a+s)*u;return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-d,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-f,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-m,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){let r=this.elements,i=t.elements;for(let n=0;n<16;n++)if(r[n]!==i[n])return!1;return!0}fromArray(t,r=0){for(let i=0;i<16;i++)this.elements[i]=t[i+r];return this}toArray(t=[],r=0){let i=this.elements;return t[r]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=i[3],t[r+4]=i[4],t[r+5]=i[5],t[r+6]=i[6],t[r+7]=i[7],t[r+8]=i[8],t[r+9]=i[9],t[r+10]=i[10],t[r+11]=i[11],t[r+12]=i[12],t[r+13]=i[13],t[r+14]=i[14],t[r+15]=i[15],t}},gv=new V,sc=new ot,t_e=new V(0,0,0),r_e=new V(1,1,1),Mf=new V,QE=new V,$o=new V,AG=new ot,CG=new ar,Es=class{constructor(e=0,t=0,r=0,i=Es.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let i=e.elements,n=i[0],s=i[4],a=i[8],o=i[1],l=i[5],c=i[9],u=i[2],d=i[6],f=i[10];switch(t){case"XYZ":this._y=Math.asin(ns(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-ns(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,n),this._z=0);break;case"ZXY":this._x=Math.asin(ns(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,f),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,n));break;case"ZYX":this._y=Math.asin(-ns(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(ns(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,n)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-ns(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-c,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return AG.makeRotationFromQuaternion(e),this.setFromRotationMatrix(AG,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return CG.setFromEuler(this),this.setFromQuaternion(CG,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Es.DEFAULT_ORDER="XYZ";var F6=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},i_e=0,TG=new V,vv=new ar,Bd=new ot,ZE=new V,P1=new V,n_e=new V,s_e=new ar,MG=new V(1,0,0),PG=new V(0,1,0),DG=new V(0,0,1),a_e={type:"added"},NG={type:"removed"},Ei=class extends wa{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:i_e++}),this.uuid=Gl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ei.DEFAULT_UP.clone();let t=new V,r=new Es,i=new ar,n=new V(1,1,1);function s(){i.setFromEuler(r,!1)}function a(){r.setFromQuaternion(i,void 0,!1)}r._onChange(s),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new ot},normalMatrix:{value:new as}}),this.matrix=new ot,this.matrixWorld=new ot,this.matrixAutoUpdate=Ei.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Ei.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new F6,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,r){this.quaternion.setFromAxisAngle(t,r)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,r){return vv.setFromAxisAngle(t,r),this.quaternion.multiply(vv),this}rotateOnWorldAxis(t,r){return vv.setFromAxisAngle(t,r),this.quaternion.premultiply(vv),this}rotateX(t){return this.rotateOnAxis(MG,t)}rotateY(t){return this.rotateOnAxis(PG,t)}rotateZ(t){return this.rotateOnAxis(DG,t)}translateOnAxis(t,r){return TG.copy(t).applyQuaternion(this.quaternion),this.position.add(TG.multiplyScalar(r)),this}translateX(t){return this.translateOnAxis(MG,t)}translateY(t){return this.translateOnAxis(PG,t)}translateZ(t){return this.translateOnAxis(DG,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Bd.copy(this.matrixWorld).invert())}lookAt(t,r,i){t.isVector3?ZE.copy(t):ZE.set(t,r,i);let n=this.parent;this.updateWorldMatrix(!0,!1),P1.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Bd.lookAt(P1,ZE,this.up):Bd.lookAt(ZE,P1,this.up),this.quaternion.setFromRotationMatrix(Bd),n&&(Bd.extractRotation(n.matrixWorld),vv.setFromRotationMatrix(Bd),this.quaternion.premultiply(vv.invert()))}add(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(a_e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let r=this.children.indexOf(t);return r!==-1&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(NG)),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){let r=this.children[t];r.parent=null,r.dispatchEvent(NG)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Bd.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Bd.multiply(t.parent.matrixWorld)),t.applyMatrix4(Bd),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,r){if(this[t]===r)return this;for(let i=0,n=this.children.length;i<n;i++){let s=this.children[i].getObjectByProperty(t,r);if(s!==void 0)return s}}getObjectsByProperty(t,r){let i=[];this[t]===r&&i.push(this);for(let n=0,s=this.children.length;n<s;n++){let a=this.children[n].getObjectsByProperty(t,r);a.length>0&&(i=i.concat(a))}return i}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(P1,t,n_e),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(P1,s_e,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let r=this.matrixWorld.elements;return t.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(t){t(this);let r=this.children;for(let i=0,n=r.length;i<n;i++)r[i].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let r=this.children;for(let i=0,n=r.length;i<n;i++)r[i].traverseVisible(t)}traverseAncestors(t){let r=this.parent;r!==null&&(t(r),r.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let r=this.children;for(let i=0,n=r.length;i<n;i++){let s=r[i];(s.matrixWorldAutoUpdate===!0||t===!0)&&s.updateMatrixWorld(t)}}updateWorldMatrix(t,r){let i=this.parent;if(t===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),r===!0){let n=this.children;for(let s=0,a=n.length;s<a;s++){let o=n[s];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(t){let r=t===void 0||typeof t=="string",i={};r&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=s(t.geometries,this.geometry);let o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){let l=o.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){let d=l[c];s(t.shapes,d)}else s(t.shapes,l)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(s(t.materials,this.material[l]));n.material=o}else n.material=s(t.materials,this.material);if(this.children.length>0){n.children=[];for(let o=0;o<this.children.length;o++)n.children.push(this.children[o].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(let o=0;o<this.animations.length;o++){let l=this.animations[o];n.animations.push(s(t.animations,l))}}if(r){let o=a(t.geometries),l=a(t.materials),c=a(t.textures),u=a(t.images),d=a(t.shapes),f=a(t.skeletons),m=a(t.animations),v=a(t.nodes);o.length>0&&(i.geometries=o),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),d.length>0&&(i.shapes=d),f.length>0&&(i.skeletons=f),m.length>0&&(i.animations=m),v.length>0&&(i.nodes=v)}return i.object=n,i;function a(o){let l=[];for(let c in o){let u=o[c];delete u.metadata,l.push(u)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,r=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),r===!0)for(let i=0;i<t.children.length;i++){let n=t.children[i];this.add(n.clone())}return this}};Ei.DEFAULT_UP=new V(0,1,0);Ei.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ei.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var ac=new V,Fd=new V,WR=new V,Vd=new V,yv=new V,xv=new V,kG=new V,qR=new V,YR=new V,XR=new V,fa=class{constructor(e=new V,t=new V,r=new V){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),ac.subVectors(e,t),i.cross(ac);let n=i.lengthSq();return n>0?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}static getBarycoord(e,t,r,i,n){ac.subVectors(i,t),Fd.subVectors(r,t),WR.subVectors(e,t);let s=ac.dot(ac),a=ac.dot(Fd),o=ac.dot(WR),l=Fd.dot(Fd),c=Fd.dot(WR),u=s*l-a*a;if(u===0)return n.set(-2,-1,-1);let d=1/u,f=(l*o-a*c)*d,m=(s*c-a*o)*d;return n.set(1-f-m,m,f)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Vd),Vd.x>=0&&Vd.y>=0&&Vd.x+Vd.y<=1}static getUV(e,t,r,i,n,s,a,o){return this.getBarycoord(e,t,r,i,Vd),o.set(0,0),o.addScaledVector(n,Vd.x),o.addScaledVector(s,Vd.y),o.addScaledVector(a,Vd.z),o}static isFrontFacing(e,t,r,i){return ac.subVectors(r,t),Fd.subVectors(e,t),ac.cross(Fd).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ac.subVectors(this.c,this.b),Fd.subVectors(this.a,this.b),ac.cross(Fd).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return fa.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return fa.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,n){return fa.getUV(e,this.a,this.b,this.c,t,r,i,n)}containsPoint(e){return fa.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return fa.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,i=this.b,n=this.c,s,a;yv.subVectors(i,r),xv.subVectors(n,r),qR.subVectors(e,r);let o=yv.dot(qR),l=xv.dot(qR);if(o<=0&&l<=0)return t.copy(r);YR.subVectors(e,i);let c=yv.dot(YR),u=xv.dot(YR);if(c>=0&&u<=c)return t.copy(i);let d=o*u-c*l;if(d<=0&&o>=0&&c<=0)return s=o/(o-c),t.copy(r).addScaledVector(yv,s);XR.subVectors(e,n);let f=yv.dot(XR),m=xv.dot(XR);if(m>=0&&f<=m)return t.copy(n);let v=f*l-o*m;if(v<=0&&l>=0&&m<=0)return a=l/(l-m),t.copy(r).addScaledVector(xv,a);let y=c*m-f*u;if(y<=0&&u-c>=0&&f-m>=0)return kG.subVectors(n,i),a=(u-c)/(u-c+(f-m)),t.copy(i).addScaledVector(kG,a);let x=1/(y+v+d);return s=v*x,a=d*x,t.copy(r).addScaledVector(yv,s).addScaledVector(xv,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},o_e=0,k_=class extends wa{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:o_e++}),this.uuid=Gl(),this.name="",this.type="Material",this.blending=Ag,this.side=zc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Zre,this.blendDst=Jre,this.blendEquation=Jv,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Aj,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=O2e,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=RR,this.stencilZFail=RR,this.stencilZPass=RR,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Ag&&(r.blending=this.blending),this.side!==zc&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(r.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(n){let s=[];for(let a in n){let o=n[a];delete o.metadata,s.push(o)}return s}if(t){let n=i(e.textures),s=i(e.images);n.length>0&&(r.textures=n),s.length>0&&(r.images=s)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let i=t.length;r=new Array(i);for(let n=0;n!==i;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},Ih=class extends k_{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Zt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=eie,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}},Qn=new V,JE=new ge,Jt=class{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=Pj,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)JE.fromBufferAttribute(this,t),JE.applyMatrix3(e),this.setXY(t,JE.x,JE.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Qn.fromBufferAttribute(this,t),Qn.applyMatrix3(e),this.setXYZ(t,Qn.x,Qn.y,Qn.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Qn.fromBufferAttribute(this,t),Qn.applyMatrix4(e),this.setXYZ(t,Qn.x,Qn.y,Qn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Qn.fromBufferAttribute(this,t),Qn.applyNormalMatrix(e),this.setXYZ(t,Qn.x,Qn.y,Qn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Qn.fromBufferAttribute(this,t),Qn.transformDirection(e),this.setXYZ(t,Qn.x,Qn.y,Qn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=mh(t,this.array)),t}setX(e,t){return this.normalized&&(t=qi(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=mh(t,this.array)),t}setY(e,t){return this.normalized&&(t=qi(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=mh(t,this.array)),t}setZ(e,t){return this.normalized&&(t=qi(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=mh(t,this.array)),t}setW(e,t){return this.normalized&&(t=qi(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=qi(t,this.array),r=qi(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=qi(t,this.array),r=qi(r,this.array),i=qi(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e*=this.itemSize,this.normalized&&(t=qi(t,this.array),r=qi(r,this.array),i=qi(i,this.array),n=qi(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Pj&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},pie=class extends Jt{constructor(e,t,r){super(new Uint16Array(e),t,r)}},Ny=class extends Jt{constructor(e,t,r){super(new Uint32Array(e),t,r)}},At=class extends Jt{constructor(t,r,i){super(new Float32Array(t),r,i)}},l_e=0,El=new ot,$R=new Ei,bv=new V,Ko=new Wn,D1=new Wn,Ls=new V,Lt=class extends wa{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:l_e++}),this.uuid=Gl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(lie(t)?Ny:pie)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,r){return this.attributes[t]=r,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,r,i=0){this.groups.push({start:t,count:r,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,r){this.drawRange.start=t,this.drawRange.count=r}applyMatrix4(t){let r=this.attributes.position;r!==void 0&&(r.applyMatrix4(t),r.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let s=new as().getNormalMatrix(t);i.applyNormalMatrix(s),i.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(t),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return El.makeRotationFromQuaternion(t),this.applyMatrix4(El),this}rotateX(t){return El.makeRotationX(t),this.applyMatrix4(El),this}rotateY(t){return El.makeRotationY(t),this.applyMatrix4(El),this}rotateZ(t){return El.makeRotationZ(t),this.applyMatrix4(El),this}translate(t,r,i){return El.makeTranslation(t,r,i),this.applyMatrix4(El),this}scale(t,r,i){return El.makeScale(t,r,i),this.applyMatrix4(El),this}lookAt(t){return $R.lookAt(t),$R.updateMatrix(),this.applyMatrix4($R.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(bv).negate(),this.translate(bv.x,bv.y,bv.z),this}setFromPoints(t){let r=[];for(let i=0,n=t.length;i<n;i++){let s=t[i];r.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new At(r,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Wn);let t=this.attributes.position,r=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new V(-1/0,-1/0,-1/0),new V(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),r)for(let i=0,n=r.length;i<n;i++){let s=r[i];Ko.setFromBufferAttribute(s),this.morphTargetsRelative?(Ls.addVectors(this.boundingBox.min,Ko.min),this.boundingBox.expandByPoint(Ls),Ls.addVectors(this.boundingBox.max,Ko.max),this.boundingBox.expandByPoint(Ls)):(this.boundingBox.expandByPoint(Ko.min),this.boundingBox.expandByPoint(Ko.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Oo);let t=this.attributes.position,r=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new V,1/0);return}if(t){let i=this.boundingSphere.center;if(Ko.setFromBufferAttribute(t),r)for(let s=0,a=r.length;s<a;s++){let o=r[s];D1.setFromBufferAttribute(o),this.morphTargetsRelative?(Ls.addVectors(Ko.min,D1.min),Ko.expandByPoint(Ls),Ls.addVectors(Ko.max,D1.max),Ko.expandByPoint(Ls)):(Ko.expandByPoint(D1.min),Ko.expandByPoint(D1.max))}Ko.getCenter(i);let n=0;for(let s=0,a=t.count;s<a;s++)Ls.fromBufferAttribute(t,s),n=Math.max(n,i.distanceToSquared(Ls));if(r)for(let s=0,a=r.length;s<a;s++){let o=r[s],l=this.morphTargetsRelative;for(let c=0,u=o.count;c<u;c++)Ls.fromBufferAttribute(o,c),l&&(bv.fromBufferAttribute(t,c),Ls.add(bv)),n=Math.max(n,i.distanceToSquared(Ls))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let t=this.index,r=this.attributes;if(t===null||r.position===void 0||r.normal===void 0||r.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=t.array,n=r.position.array,s=r.normal.array,a=r.uv.array,o=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Jt(new Float32Array(4*o),4));let l=this.getAttribute("tangent").array,c=[],u=[];for(let D=0;D<o;D++)c[D]=new V,u[D]=new V;let d=new V,f=new V,m=new V,v=new ge,y=new ge,x=new ge,w=new V,_=new V;function S(D,I,j){d.fromArray(n,D*3),f.fromArray(n,I*3),m.fromArray(n,j*3),v.fromArray(a,D*2),y.fromArray(a,I*2),x.fromArray(a,j*2),f.sub(d),m.sub(d),y.sub(v),x.sub(v);let L=1/(y.x*x.y-x.x*y.y);!isFinite(L)||(w.copy(f).multiplyScalar(x.y).addScaledVector(m,-y.y).multiplyScalar(L),_.copy(m).multiplyScalar(y.x).addScaledVector(f,-x.x).multiplyScalar(L),c[D].add(w),c[I].add(w),c[j].add(w),u[D].add(_),u[I].add(_),u[j].add(_))}let P=this.groups;P.length===0&&(P=[{start:0,count:i.length}]);for(let D=0,I=P.length;D<I;++D){let j=P[D],L=j.start,B=j.count;for(let q=L,G=L+B;q<G;q+=3)S(i[q+0],i[q+1],i[q+2])}let M=new V,C=new V,T=new V,E=new V;function N(D){T.fromArray(s,D*3),E.copy(T);let I=c[D];M.copy(I),M.sub(T.multiplyScalar(T.dot(I))).normalize(),C.crossVectors(E,I);let j=C.dot(u[D])<0?-1:1;l[D*4]=M.x,l[D*4+1]=M.y,l[D*4+2]=M.z,l[D*4+3]=j}for(let D=0,I=P.length;D<I;++D){let j=P[D],L=j.start,B=j.count;for(let q=L,G=L+B;q<G;q+=3)N(i[q+0]),N(i[q+1]),N(i[q+2])}}computeVertexNormals(){let t=this.index,r=this.getAttribute("position");if(r!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Jt(new Float32Array(r.count*3),3),this.setAttribute("normal",i);else for(let f=0,m=i.count;f<m;f++)i.setXYZ(f,0,0,0);let n=new V,s=new V,a=new V,o=new V,l=new V,c=new V,u=new V,d=new V;if(t)for(let f=0,m=t.count;f<m;f+=3){let v=t.getX(f+0),y=t.getX(f+1),x=t.getX(f+2);n.fromBufferAttribute(r,v),s.fromBufferAttribute(r,y),a.fromBufferAttribute(r,x),u.subVectors(a,s),d.subVectors(n,s),u.cross(d),o.fromBufferAttribute(i,v),l.fromBufferAttribute(i,y),c.fromBufferAttribute(i,x),o.add(u),l.add(u),c.add(u),i.setXYZ(v,o.x,o.y,o.z),i.setXYZ(y,l.x,l.y,l.z),i.setXYZ(x,c.x,c.y,c.z)}else for(let f=0,m=r.count;f<m;f+=3)n.fromBufferAttribute(r,f+0),s.fromBufferAttribute(r,f+1),a.fromBufferAttribute(r,f+2),u.subVectors(a,s),d.subVectors(n,s),u.cross(d),i.setXYZ(f+0,u.x,u.y,u.z),i.setXYZ(f+1,u.x,u.y,u.z),i.setXYZ(f+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let t=this.attributes.normal;for(let r=0,i=t.count;r<i;r++)Ls.fromBufferAttribute(t,r),Ls.normalize(),t.setXYZ(r,Ls.x,Ls.y,Ls.z)}toNonIndexed(){function t(o,l){let c=o.array,u=o.itemSize,d=o.normalized,f=new c.constructor(l.length*u),m=0,v=0;for(let y=0,x=l.length;y<x;y++){o.isInterleavedBufferAttribute?m=l[y]*o.data.stride+o.offset:m=l[y]*u;for(let w=0;w<u;w++)f[v++]=c[m++]}return new Jt(f,u,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let r=new Lt,i=this.index.array,n=this.attributes;for(let o in n){let l=n[o],c=t(l,i);r.setAttribute(o,c)}let s=this.morphAttributes;for(let o in s){let l=[],c=s[o];for(let u=0,d=c.length;u<d;u++){let f=c[u],m=t(f,i);l.push(m)}r.morphAttributes[o]=l}r.morphTargetsRelative=this.morphTargetsRelative;let a=this.groups;for(let o=0,l=a.length;o<l;o++){let c=a[o];r.addGroup(c.start,c.count,c.materialIndex)}return r}toJSON(){let t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let c in l)l[c]!==void 0&&(t[c]=l[c]);return t}t.data={attributes:{}};let r=this.index;r!==null&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});let i=this.attributes;for(let l in i){let c=i[l];t.data.attributes[l]=c.toJSON(t.data)}let n={},s=!1;for(let l in this.morphAttributes){let c=this.morphAttributes[l],u=[];for(let d=0,f=c.length;d<f;d++){let m=c[d];u.push(m.toJSON(t.data))}u.length>0&&(n[l]=u,s=!0)}s&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));let o=this.boundingSphere;return o!==null&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let r={};this.name=t.name;let i=t.index;i!==null&&this.setIndex(i.clone(r));let n=t.attributes;for(let c in n){let u=n[c];this.setAttribute(c,u.clone(r))}let s=t.morphAttributes;for(let c in s){let u=[],d=s[c];for(let f=0,m=d.length;f<m;f++)u.push(d[f].clone(r));this.morphAttributes[c]=u}this.morphTargetsRelative=t.morphTargetsRelative;let a=t.groups;for(let c=0,u=a.length;c<u;c++){let d=a[c];this.addGroup(d.start,d.count,d.materialIndex)}let o=t.boundingBox;o!==null&&(this.boundingBox=o.clone());let l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,t.parameters!==void 0&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},RG=new ot,wv=new Wx,KR=new Oo,N1=new V,k1=new V,R1=new V,QR=new V,eA=new V,tA=new ge,rA=new ge,iA=new ge,ZR=new V,nA=new V,Yi=class extends Ei{constructor(t=new Lt,r=new Ih){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=r,this.updateMorphTargets()}copy(t,r){return super.copy(t,r),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){let i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,s=i.length;n<s;n++){let a=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=n}}}}getVertexPosition(t,r){let i=this.geometry,n=i.attributes.position,s=i.morphAttributes.position,a=i.morphTargetsRelative;r.fromBufferAttribute(n,t);let o=this.morphTargetInfluences;if(s&&o){eA.set(0,0,0);for(let l=0,c=s.length;l<c;l++){let u=o[l],d=s[l];u!==0&&(QR.fromBufferAttribute(d,t),a?eA.addScaledVector(QR,u):eA.addScaledVector(QR.sub(r),u))}r.add(eA)}return this.isSkinnedMesh&&this.boneTransform(t,r),r}raycast(t,r){let i=this.geometry,n=this.material,s=this.matrixWorld;if(n===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),KR.copy(i.boundingSphere),KR.applyMatrix4(s),t.ray.intersectsSphere(KR)===!1)||(RG.copy(s).invert(),wv.copy(t.ray).applyMatrix4(RG),i.boundingBox!==null&&wv.intersectsBox(i.boundingBox)===!1))return;let a,o=i.index,l=i.attributes.position,c=i.attributes.uv,u=i.attributes.uv2,d=i.groups,f=i.drawRange;if(o!==null)if(Array.isArray(n))for(let m=0,v=d.length;m<v;m++){let y=d[m],x=n[y.materialIndex],w=Math.max(y.start,f.start),_=Math.min(o.count,Math.min(y.start+y.count,f.start+f.count));for(let S=w,P=_;S<P;S+=3){let M=o.getX(S),C=o.getX(S+1),T=o.getX(S+2);a=sA(this,x,t,wv,c,u,M,C,T),a&&(a.faceIndex=Math.floor(S/3),a.face.materialIndex=y.materialIndex,r.push(a))}}else{let m=Math.max(0,f.start),v=Math.min(o.count,f.start+f.count);for(let y=m,x=v;y<x;y+=3){let w=o.getX(y),_=o.getX(y+1),S=o.getX(y+2);a=sA(this,n,t,wv,c,u,w,_,S),a&&(a.faceIndex=Math.floor(y/3),r.push(a))}}else if(l!==void 0)if(Array.isArray(n))for(let m=0,v=d.length;m<v;m++){let y=d[m],x=n[y.materialIndex],w=Math.max(y.start,f.start),_=Math.min(l.count,Math.min(y.start+y.count,f.start+f.count));for(let S=w,P=_;S<P;S+=3){let M=S,C=S+1,T=S+2;a=sA(this,x,t,wv,c,u,M,C,T),a&&(a.faceIndex=Math.floor(S/3),a.face.materialIndex=y.materialIndex,r.push(a))}}else{let m=Math.max(0,f.start),v=Math.min(l.count,f.start+f.count);for(let y=m,x=v;y<x;y+=3){let w=y,_=y+1,S=y+2;a=sA(this,n,t,wv,c,u,w,_,S),a&&(a.faceIndex=Math.floor(y/3),r.push(a))}}}};function c_e(e,t,r,i,n,s,a,o){let l;if(t.side===Ys?l=i.intersectTriangle(a,s,n,!0,o):l=i.intersectTriangle(n,s,a,t.side===zc,o),l===null)return null;nA.copy(o),nA.applyMatrix4(e.matrixWorld);let c=r.ray.origin.distanceTo(nA);return c<r.near||c>r.far?null:{distance:c,point:nA.clone(),object:e}}function sA(e,t,r,i,n,s,a,o,l){e.getVertexPosition(a,N1),e.getVertexPosition(o,k1),e.getVertexPosition(l,R1);let c=c_e(e,t,r,i,N1,k1,R1,ZR);if(c){n&&(tA.fromBufferAttribute(n,a),rA.fromBufferAttribute(n,o),iA.fromBufferAttribute(n,l),c.uv=fa.getUV(ZR,N1,k1,R1,tA,rA,iA,new ge)),s&&(tA.fromBufferAttribute(s,a),rA.fromBufferAttribute(s,o),iA.fromBufferAttribute(s,l),c.uv2=fa.getUV(ZR,N1,k1,R1,tA,rA,iA,new ge));let u={a,b:o,c:l,normal:new V,materialIndex:0};fa.getNormal(N1,k1,R1,u.normal),c.face=u}return c}var Fc=class extends Lt{constructor(e=1,t=1,r=1,i=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:s};let a=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s);let o=[],l=[],c=[],u=[],d=0,f=0;m("z","y","x",-1,-1,r,t,e,s,n,0),m("z","y","x",1,-1,r,t,-e,s,n,1),m("x","z","y",1,1,e,r,t,i,s,2),m("x","z","y",1,-1,e,r,-t,i,s,3),m("x","y","z",1,-1,e,t,r,i,n,4),m("x","y","z",-1,-1,e,t,-r,i,n,5),this.setIndex(o),this.setAttribute("position",new At(l,3)),this.setAttribute("normal",new At(c,3)),this.setAttribute("uv",new At(u,2));function m(v,y,x,w,_,S,P,M,C,T,E){let N=S/C,D=P/T,I=S/2,j=P/2,L=M/2,B=C+1,q=T+1,G=0,Y=0,X=new V;for(let re=0;re<q;re++){let F=re*D-j;for(let $=0;$<B;$++){let se=$*N-I;X[v]=se*w,X[y]=F*_,X[x]=L,l.push(X.x,X.y,X.z),X[v]=0,X[y]=0,X[x]=M>0?1:-1,c.push(X.x,X.y,X.z),u.push($/C),u.push(1-re/T),G+=1}}for(let re=0;re<T;re++)for(let F=0;F<C;F++){let $=d+F+B*re,se=d+F+B*(re+1),H=d+(F+1)+B*(re+1),ne=d+(F+1)+B*re;o.push($,se,ne),o.push(se,H,ne),Y+=6}a.addGroup(f,Y,E),f+=Y,d+=G}}static fromJSON(e){return new Fc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function sx(e){let t={};for(let r in e){t[r]={};for(let i in e[r]){let n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}function Za(e){let t={};for(let r=0;r<e.length;r++){let i=sx(e[r]);for(let n in i)t[n]=i[n]}return t}function u_e(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}function mie(e){return e.getRenderTarget()===null&&e.outputEncoding===Ar?Au:sM}var qx={clone:sx,merge:Za},d_e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,h_e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Jr=class extends k_{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=d_e,this.fragmentShader=h_e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=sx(e.uniforms),this.uniformsGroups=u_e(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}},em=class extends Ei{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ot,this.projectionMatrix=new ot,this.projectionMatrixInverse=new ot}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Ra=class extends em{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=T2*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Uw*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return T2*2*Math.atan(Math.tan(Uw*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,n,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Uw*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i,s=this.view;if(this.view!==null&&this.view.enabled){let o=s.fullWidth,l=s.fullHeight;n+=s.offsetX*i/o,t-=s.offsetY*r/l,i*=s.width/o,r*=s.height/l}let a=this.filmOffset;a!==0&&(n+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},_v=-90,Sv=1,f_e=class extends Ei{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;let i=new Ra(_v,Sv,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let n=new Ra(_v,Sv,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(-1,0,0),this.add(n);let s=new Ra(_v,Sv,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let a=new Ra(_v,Sv,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);let o=new Ra(_v,Sv,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new Ra(_v,Sv,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[i,n,s,a,o,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,d=e.xr.enabled;e.toneMapping=zu,e.xr.enabled=!1;let f=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,o),r.texture.generateMipmaps=f,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=d,r.texture.needsPMREMUpdate=!0}},V6=class extends yn{constructor(e,t,r,i,n,s,a,o,l,c){e=e!==void 0?e:[],t=t!==void 0?t:Ug,super(e,t,r,i,n,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},p_e=class extends Zr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new V6(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Pr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Fc(5,5,5),n=new Jr({name:"CubemapFromEquirect",uniforms:sx(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Ys,blending:cs});n.uniforms.tEquirect.value=t;let s=new Yi(i,n),a=t.minFilter;return t.minFilter===nx&&(t.minFilter=Pr),new f_e(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,i){let n=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,r,i);e.setRenderTarget(n)}},JR=new V,m_e=new V,g_e=new as,So=class{constructor(e=new V(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let i=JR.subVectors(r,t).cross(m_e.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(JR),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:t.copy(r).multiplyScalar(n).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||g_e.getNormalMatrix(e),i=this.coplanarPoint(JR).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Ev=new Oo,aA=new V,U6=class{constructor(e=new So,t=new So,r=new So,i=new So,n=new So,s=new So){this.planes=[e,t,r,i,n,s]}set(e,t,r,i,n,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(n),a[5].copy(s),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,i=r[0],n=r[1],s=r[2],a=r[3],o=r[4],l=r[5],c=r[6],u=r[7],d=r[8],f=r[9],m=r[10],v=r[11],y=r[12],x=r[13],w=r[14],_=r[15];return t[0].setComponents(a-i,u-o,v-d,_-y).normalize(),t[1].setComponents(a+i,u+o,v+d,_+y).normalize(),t[2].setComponents(a+n,u+l,v+f,_+x).normalize(),t[3].setComponents(a-n,u-l,v-f,_-x).normalize(),t[4].setComponents(a-s,u-c,v-m,_-w).normalize(),t[5].setComponents(a+s,u+c,v+m,_+w).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Ev.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ev)}intersectsSprite(e){return Ev.center.set(0,0,0),Ev.radius=.7071067811865476,Ev.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ev)}intersectsSphere(e){let t=this.planes,r=e.center,i=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let i=t[r];if(aA.x=i.normal.x>0?e.max.x:e.min.x,aA.y=i.normal.y>0?e.max.y:e.min.y,aA.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(aA)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function gie(){let e=null,t=!1,r=null,i=null;function n(s,a){r(s,a),i=e.requestAnimationFrame(n)}return{start:function(){t!==!0&&r!==null&&(i=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(s){r=s},setContext:function(s){e=s}}}function v_e(e,t){let r=t.isWebGL2,i=new WeakMap;function n(c,u){let d=c.array,f=c.usage,m=e.createBuffer();e.bindBuffer(u,m),e.bufferData(u,d,f),c.onUploadCallback();let v;if(d instanceof Float32Array)v=5126;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(r)v=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else v=5123;else if(d instanceof Int16Array)v=5122;else if(d instanceof Uint32Array)v=5125;else if(d instanceof Int32Array)v=5124;else if(d instanceof Int8Array)v=5120;else if(d instanceof Uint8Array)v=5121;else if(d instanceof Uint8ClampedArray)v=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:m,type:v,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version}}function s(c,u,d){let f=u.array,m=u.updateRange;e.bindBuffer(d,c),m.count===-1?e.bufferSubData(d,0,f):(r?e.bufferSubData(d,m.offset*f.BYTES_PER_ELEMENT,f,m.offset,m.count):e.bufferSubData(d,m.offset*f.BYTES_PER_ELEMENT,f.subarray(m.offset,m.offset+m.count)),m.count=-1),u.onUploadCallback()}function a(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);let u=i.get(c);u&&(e.deleteBuffer(u.buffer),i.delete(c))}function l(c,u){if(c.isGLBufferAttribute){let f=i.get(c);(!f||f.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let d=i.get(c);d===void 0?i.set(c,n(c,u)):d.version<c.version&&(s(d.buffer,c,u),d.version=c.version)}return{get:a,remove:o,update:l}}var ed=class extends Lt{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};let n=e/2,s=t/2,a=Math.floor(r),o=Math.floor(i),l=a+1,c=o+1,u=e/a,d=t/o,f=[],m=[],v=[],y=[];for(let x=0;x<c;x++){let w=x*d-s;for(let _=0;_<l;_++){let S=_*u-n;m.push(S,-w,0),v.push(0,0,1),y.push(_/a),y.push(1-x/o)}}for(let x=0;x<o;x++)for(let w=0;w<a;w++){let _=w+l*x,S=w+l*(x+1),P=w+1+l*(x+1),M=w+1+l*x;f.push(_,S,M),f.push(S,P,M)}this.setIndex(f),this.setAttribute("position",new At(m,3)),this.setAttribute("normal",new At(v,3)),this.setAttribute("uv",new At(y,2))}static fromJSON(e){return new ed(e.width,e.height,e.widthSegments,e.heightSegments)}},y_e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,x_e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,b_e=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,w_e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,__e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,S_e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,E_e="vec3 transformed = vec3( position );",A_e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,C_e=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,T_e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,M_e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,P_e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,D_e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,N_e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,k_e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,R_e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,I_e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,O_e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,j_e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,L_e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,z_e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,B_e=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,F_e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,V_e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,U_e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,H_e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,G_e="gl_FragColor = linearToOutputTexel( gl_FragColor );",W_e=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,q_e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Y_e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,X_e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,$_e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,K_e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Q_e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Z_e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,J_e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,eSe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,tSe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,rSe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,iSe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,nSe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,sSe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,aSe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,oSe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,lSe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,cSe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,uSe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,dSe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,hSe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,fSe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,pSe=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,mSe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,gSe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,vSe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,ySe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,xSe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,bSe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,wSe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,_Se=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,SSe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,ESe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ASe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,CSe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,TSe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,MSe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,PSe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,DSe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,NSe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,kSe=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,RSe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,ISe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,OSe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,jSe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,LSe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,zSe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,BSe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,FSe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,VSe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,USe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,HSe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,GSe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,WSe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,qSe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,YSe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,XSe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,$Se=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,KSe=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,QSe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,ZSe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,JSe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,eEe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,tEe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,rEe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,iEe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,nEe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,sEe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,aEe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,oEe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,lEe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,cEe=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uEe=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,dEe=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,hEe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,fEe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,pEe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,mEe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,gEe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,vEe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,yEe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,xEe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,bEe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,wEe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,_Ee=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,SEe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,EEe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,AEe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,CEe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,TEe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,MEe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,PEe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,DEe=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,NEe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kEe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,REe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,IEe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,OEe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,jEe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,LEe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,zEe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,BEe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FEe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,VEe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,UEe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,HEe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GEe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,WEe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,qEe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YEe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,XEe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,$Ee=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Tr={alphamap_fragment:y_e,alphamap_pars_fragment:x_e,alphatest_fragment:b_e,alphatest_pars_fragment:w_e,aomap_fragment:__e,aomap_pars_fragment:S_e,begin_vertex:E_e,beginnormal_vertex:A_e,bsdfs:C_e,iridescence_fragment:T_e,bumpmap_pars_fragment:M_e,clipping_planes_fragment:P_e,clipping_planes_pars_fragment:D_e,clipping_planes_pars_vertex:N_e,clipping_planes_vertex:k_e,color_fragment:R_e,color_pars_fragment:I_e,color_pars_vertex:O_e,color_vertex:j_e,common:L_e,cube_uv_reflection_fragment:z_e,defaultnormal_vertex:B_e,displacementmap_pars_vertex:F_e,displacementmap_vertex:V_e,emissivemap_fragment:U_e,emissivemap_pars_fragment:H_e,encodings_fragment:G_e,encodings_pars_fragment:W_e,envmap_fragment:q_e,envmap_common_pars_fragment:Y_e,envmap_pars_fragment:X_e,envmap_pars_vertex:$_e,envmap_physical_pars_fragment:oSe,envmap_vertex:K_e,fog_vertex:Q_e,fog_pars_vertex:Z_e,fog_fragment:J_e,fog_pars_fragment:eSe,gradientmap_pars_fragment:tSe,lightmap_fragment:rSe,lightmap_pars_fragment:iSe,lights_lambert_fragment:nSe,lights_lambert_pars_fragment:sSe,lights_pars_begin:aSe,lights_toon_fragment:lSe,lights_toon_pars_fragment:cSe,lights_phong_fragment:uSe,lights_phong_pars_fragment:dSe,lights_physical_fragment:hSe,lights_physical_pars_fragment:fSe,lights_fragment_begin:pSe,lights_fragment_maps:mSe,lights_fragment_end:gSe,logdepthbuf_fragment:vSe,logdepthbuf_pars_fragment:ySe,logdepthbuf_pars_vertex:xSe,logdepthbuf_vertex:bSe,map_fragment:wSe,map_pars_fragment:_Se,map_particle_fragment:SSe,map_particle_pars_fragment:ESe,metalnessmap_fragment:ASe,metalnessmap_pars_fragment:CSe,morphcolor_vertex:TSe,morphnormal_vertex:MSe,morphtarget_pars_vertex:PSe,morphtarget_vertex:DSe,normal_fragment_begin:NSe,normal_fragment_maps:kSe,normal_pars_fragment:RSe,normal_pars_vertex:ISe,normal_vertex:OSe,normalmap_pars_fragment:jSe,clearcoat_normal_fragment_begin:LSe,clearcoat_normal_fragment_maps:zSe,clearcoat_pars_fragment:BSe,iridescence_pars_fragment:FSe,output_fragment:VSe,packing:USe,premultiplied_alpha_fragment:HSe,project_vertex:GSe,dithering_fragment:WSe,dithering_pars_fragment:qSe,roughnessmap_fragment:YSe,roughnessmap_pars_fragment:XSe,shadowmap_pars_fragment:$Se,shadowmap_pars_vertex:KSe,shadowmap_vertex:QSe,shadowmask_pars_fragment:ZSe,skinbase_vertex:JSe,skinning_pars_vertex:eEe,skinning_vertex:tEe,skinnormal_vertex:rEe,specularmap_fragment:iEe,specularmap_pars_fragment:nEe,tonemapping_fragment:sEe,tonemapping_pars_fragment:aEe,transmission_fragment:oEe,transmission_pars_fragment:lEe,uv_pars_fragment:cEe,uv_pars_vertex:uEe,uv_vertex:dEe,uv2_pars_fragment:hEe,uv2_pars_vertex:fEe,uv2_vertex:pEe,worldpos_vertex:mEe,background_vert:gEe,background_frag:vEe,backgroundCube_vert:yEe,backgroundCube_frag:xEe,cube_vert:bEe,cube_frag:wEe,depth_vert:_Ee,depth_frag:SEe,distanceRGBA_vert:EEe,distanceRGBA_frag:AEe,equirect_vert:CEe,equirect_frag:TEe,linedashed_vert:MEe,linedashed_frag:PEe,meshbasic_vert:DEe,meshbasic_frag:NEe,meshlambert_vert:kEe,meshlambert_frag:REe,meshmatcap_vert:IEe,meshmatcap_frag:OEe,meshnormal_vert:jEe,meshnormal_frag:LEe,meshphong_vert:zEe,meshphong_frag:BEe,meshphysical_vert:FEe,meshphysical_frag:VEe,meshtoon_vert:UEe,meshtoon_frag:HEe,points_vert:GEe,points_frag:WEe,shadow_vert:qEe,shadow_frag:YEe,sprite_vert:XEe,sprite_frag:$Ee},bt={common:{diffuse:{value:new Zt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new as},uv2Transform:{value:new as},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ge(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Zt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Zt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new as}},sprite:{diffuse:{value:new Zt(16777215)},opacity:{value:1},center:{value:new ge(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new as}}},Mu={basic:{uniforms:Za([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.fog]),vertexShader:Tr.meshbasic_vert,fragmentShader:Tr.meshbasic_frag},lambert:{uniforms:Za([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,bt.lights,{emissive:{value:new Zt(0)}}]),vertexShader:Tr.meshlambert_vert,fragmentShader:Tr.meshlambert_frag},phong:{uniforms:Za([bt.common,bt.specularmap,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,bt.lights,{emissive:{value:new Zt(0)},specular:{value:new Zt(1118481)},shininess:{value:30}}]),vertexShader:Tr.meshphong_vert,fragmentShader:Tr.meshphong_frag},standard:{uniforms:Za([bt.common,bt.envmap,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.roughnessmap,bt.metalnessmap,bt.fog,bt.lights,{emissive:{value:new Zt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Tr.meshphysical_vert,fragmentShader:Tr.meshphysical_frag},toon:{uniforms:Za([bt.common,bt.aomap,bt.lightmap,bt.emissivemap,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.gradientmap,bt.fog,bt.lights,{emissive:{value:new Zt(0)}}]),vertexShader:Tr.meshtoon_vert,fragmentShader:Tr.meshtoon_frag},matcap:{uniforms:Za([bt.common,bt.bumpmap,bt.normalmap,bt.displacementmap,bt.fog,{matcap:{value:null}}]),vertexShader:Tr.meshmatcap_vert,fragmentShader:Tr.meshmatcap_frag},points:{uniforms:Za([bt.points,bt.fog]),vertexShader:Tr.points_vert,fragmentShader:Tr.points_frag},dashed:{uniforms:Za([bt.common,bt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Tr.linedashed_vert,fragmentShader:Tr.linedashed_frag},depth:{uniforms:Za([bt.common,bt.displacementmap]),vertexShader:Tr.depth_vert,fragmentShader:Tr.depth_frag},normal:{uniforms:Za([bt.common,bt.bumpmap,bt.normalmap,bt.displacementmap,{opacity:{value:1}}]),vertexShader:Tr.meshnormal_vert,fragmentShader:Tr.meshnormal_frag},sprite:{uniforms:Za([bt.sprite,bt.fog]),vertexShader:Tr.sprite_vert,fragmentShader:Tr.sprite_frag},background:{uniforms:{uvTransform:{value:new as},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Tr.background_vert,fragmentShader:Tr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Tr.backgroundCube_vert,fragmentShader:Tr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Tr.cube_vert,fragmentShader:Tr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Tr.equirect_vert,fragmentShader:Tr.equirect_frag},distanceRGBA:{uniforms:Za([bt.common,bt.displacementmap,{referencePosition:{value:new V},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Tr.distanceRGBA_vert,fragmentShader:Tr.distanceRGBA_frag},shadow:{uniforms:Za([bt.lights,bt.fog,{color:{value:new Zt(0)},opacity:{value:1}}]),vertexShader:Tr.shadow_vert,fragmentShader:Tr.shadow_frag}};Mu.physical={uniforms:Za([Mu.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ge(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Zt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ge},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Zt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Zt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Tr.meshphysical_vert,fragmentShader:Tr.meshphysical_frag};var oA={r:0,b:0,g:0};function KEe(e,t,r,i,n,s,a){let o=new Zt(0),l=s===!0?0:1,c,u,d=null,f=0,m=null;function v(x,w){let _=!1,S=w.isScene===!0?w.background:null;S&&S.isTexture&&(S=(w.backgroundBlurriness>0?r:t).get(S));let P=e.xr,M=P.getSession&&P.getSession();M&&M.environmentBlendMode==="additive"&&(S=null),S===null?y(o,l):S&&S.isColor&&(y(S,1),_=!0),(e.autoClear||_)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),S&&(S.isCubeTexture||S.mapping===N_)?(u===void 0&&(u=new Yi(new Fc(1,1,1),new Jr({name:"BackgroundCubeMaterial",uniforms:sx(Mu.backgroundCube.uniforms),vertexShader:Mu.backgroundCube.vertexShader,fragmentShader:Mu.backgroundCube.fragmentShader,side:Ys,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(C,T,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(u)),u.material.uniforms.envMap.value=S,u.material.uniforms.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,u.material.toneMapped=S.encoding!==Ar,(d!==S||f!==S.version||m!==e.toneMapping)&&(u.material.needsUpdate=!0,d=S,f=S.version,m=e.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null)):S&&S.isTexture&&(c===void 0&&(c=new Yi(new ed(2,2),new Jr({name:"BackgroundMaterial",uniforms:sx(Mu.background.uniforms),vertexShader:Mu.background.vertexShader,fragmentShader:Mu.background.fragmentShader,side:zc,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(c)),c.material.uniforms.t2D.value=S,c.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,c.material.toneMapped=S.encoding!==Ar,S.matrixAutoUpdate===!0&&S.updateMatrix(),c.material.uniforms.uvTransform.value.copy(S.matrix),(d!==S||f!==S.version||m!==e.toneMapping)&&(c.material.needsUpdate=!0,d=S,f=S.version,m=e.toneMapping),c.layers.enableAll(),x.unshift(c,c.geometry,c.material,0,0,null))}function y(x,w){x.getRGB(oA,mie(e)),i.buffers.color.setClear(oA.r,oA.g,oA.b,w,a)}return{getClearColor:function(){return o},setClearColor:function(x,w=1){o.set(x),l=w,y(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,y(o,l)},render:v}}function QEe(e,t,r,i){let n=e.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),a=i.isWebGL2||s!==null,o={},l=x(null),c=l,u=!1;function d(B,q,G,Y,X){let re=!1;if(a){let F=y(Y,G,q);c!==F&&(c=F,m(c.object)),re=w(B,Y,G,X),re&&_(B,Y,G,X)}else{let F=q.wireframe===!0;(c.geometry!==Y.id||c.program!==G.id||c.wireframe!==F)&&(c.geometry=Y.id,c.program=G.id,c.wireframe=F,re=!0)}X!==null&&r.update(X,34963),(re||u)&&(u=!1,E(B,q,G,Y),X!==null&&e.bindBuffer(34963,r.get(X).buffer))}function f(){return i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function m(B){return i.isWebGL2?e.bindVertexArray(B):s.bindVertexArrayOES(B)}function v(B){return i.isWebGL2?e.deleteVertexArray(B):s.deleteVertexArrayOES(B)}function y(B,q,G){let Y=G.wireframe===!0,X=o[B.id];X===void 0&&(X={},o[B.id]=X);let re=X[q.id];re===void 0&&(re={},X[q.id]=re);let F=re[Y];return F===void 0&&(F=x(f()),re[Y]=F),F}function x(B){let q=[],G=[],Y=[];for(let X=0;X<n;X++)q[X]=0,G[X]=0,Y[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:q,enabledAttributes:G,attributeDivisors:Y,object:B,attributes:{},index:null}}function w(B,q,G,Y){let X=c.attributes,re=q.attributes,F=0,$=G.getAttributes();for(let se in $)if($[se].location>=0){let H=X[se],ne=re[se];if(ne===void 0&&(se==="instanceMatrix"&&B.instanceMatrix&&(ne=B.instanceMatrix),se==="instanceColor"&&B.instanceColor&&(ne=B.instanceColor)),H===void 0||H.attribute!==ne||ne&&H.data!==ne.data)return!0;F++}return c.attributesNum!==F||c.index!==Y}function _(B,q,G,Y){let X={},re=q.attributes,F=0,$=G.getAttributes();for(let se in $)if($[se].location>=0){let H=re[se];H===void 0&&(se==="instanceMatrix"&&B.instanceMatrix&&(H=B.instanceMatrix),se==="instanceColor"&&B.instanceColor&&(H=B.instanceColor));let ne={};ne.attribute=H,H&&H.data&&(ne.data=H.data),X[se]=ne,F++}c.attributes=X,c.attributesNum=F,c.index=Y}function S(){let B=c.newAttributes;for(let q=0,G=B.length;q<G;q++)B[q]=0}function P(B){M(B,0)}function M(B,q){let G=c.newAttributes,Y=c.enabledAttributes,X=c.attributeDivisors;G[B]=1,Y[B]===0&&(e.enableVertexAttribArray(B),Y[B]=1),X[B]!==q&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](B,q),X[B]=q)}function C(){let B=c.newAttributes,q=c.enabledAttributes;for(let G=0,Y=q.length;G<Y;G++)q[G]!==B[G]&&(e.disableVertexAttribArray(G),q[G]=0)}function T(B,q,G,Y,X,re){i.isWebGL2===!0&&(G===5124||G===5125)?e.vertexAttribIPointer(B,q,G,X,re):e.vertexAttribPointer(B,q,G,Y,X,re)}function E(B,q,G,Y){if(i.isWebGL2===!1&&(B.isInstancedMesh||Y.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;S();let X=Y.attributes,re=G.getAttributes(),F=q.defaultAttributeValues;for(let $ in re){let se=re[$];if(se.location>=0){let H=X[$];if(H===void 0&&($==="instanceMatrix"&&B.instanceMatrix&&(H=B.instanceMatrix),$==="instanceColor"&&B.instanceColor&&(H=B.instanceColor)),H!==void 0){let ne=H.normalized,ce=H.itemSize,ie=r.get(H);if(ie===void 0)continue;let ae=ie.buffer,Z=ie.type,fe=ie.bytesPerElement;if(H.isInterleavedBufferAttribute){let he=H.data,Ae=he.stride,xe=H.offset;if(he.isInstancedInterleavedBuffer){for(let Ee=0;Ee<se.locationSize;Ee++)M(se.location+Ee,he.meshPerAttribute);B.isInstancedMesh!==!0&&Y._maxInstanceCount===void 0&&(Y._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let Ee=0;Ee<se.locationSize;Ee++)P(se.location+Ee);e.bindBuffer(34962,ae);for(let Ee=0;Ee<se.locationSize;Ee++)T(se.location+Ee,ce/se.locationSize,Z,ne,Ae*fe,(xe+ce/se.locationSize*Ee)*fe)}else{if(H.isInstancedBufferAttribute){for(let he=0;he<se.locationSize;he++)M(se.location+he,H.meshPerAttribute);B.isInstancedMesh!==!0&&Y._maxInstanceCount===void 0&&(Y._maxInstanceCount=H.meshPerAttribute*H.count)}else for(let he=0;he<se.locationSize;he++)P(se.location+he);e.bindBuffer(34962,ae);for(let he=0;he<se.locationSize;he++)T(se.location+he,ce/se.locationSize,Z,ne,ce*fe,ce/se.locationSize*he*fe)}}else if(F!==void 0){let ne=F[$];if(ne!==void 0)switch(ne.length){case 2:e.vertexAttrib2fv(se.location,ne);break;case 3:e.vertexAttrib3fv(se.location,ne);break;case 4:e.vertexAttrib4fv(se.location,ne);break;default:e.vertexAttrib1fv(se.location,ne)}}}}C()}function N(){j();for(let B in o){let q=o[B];for(let G in q){let Y=q[G];for(let X in Y)v(Y[X].object),delete Y[X];delete q[G]}delete o[B]}}function D(B){if(o[B.id]===void 0)return;let q=o[B.id];for(let G in q){let Y=q[G];for(let X in Y)v(Y[X].object),delete Y[X];delete q[G]}delete o[B.id]}function I(B){for(let q in o){let G=o[q];if(G[B.id]===void 0)continue;let Y=G[B.id];for(let X in Y)v(Y[X].object),delete Y[X];delete G[B.id]}}function j(){L(),u=!0,c!==l&&(c=l,m(c.object))}function L(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:d,reset:j,resetDefaultState:L,dispose:N,releaseStatesOfGeometry:D,releaseStatesOfProgram:I,initAttributes:S,enableAttribute:P,disableUnusedAttributes:C}}function ZEe(e,t,r,i){let n=i.isWebGL2,s;function a(c){s=c}function o(c,u){e.drawArrays(s,c,u),r.update(u,s,1)}function l(c,u,d){if(d===0)return;let f,m;if(n)f=e,m="drawArraysInstanced";else if(f=t.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",f===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[m](s,c,u,d),r.update(u,s,d)}this.setMode=a,this.render=o,this.renderInstances=l}function JEe(e,t,r){let i;function n(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){let T=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(T){if(T==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return T==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,o=r.precision!==void 0?r.precision:"highp",l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);let c=a||t.has("WEBGL_draw_buffers"),u=r.logarithmicDepthBuffer===!0,d=e.getParameter(34930),f=e.getParameter(35660),m=e.getParameter(3379),v=e.getParameter(34076),y=e.getParameter(34921),x=e.getParameter(36347),w=e.getParameter(36348),_=e.getParameter(36349),S=f>0,P=a||t.has("OES_texture_float"),M=S&&P,C=a?e.getParameter(36183):0;return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:n,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:f,maxTextureSize:m,maxCubemapSize:v,maxAttributes:y,maxVertexUniforms:x,maxVaryings:w,maxFragmentUniforms:_,vertexTextures:S,floatFragmentTextures:P,floatVertexTextures:M,maxSamples:C}}function eAe(e){let t=this,r=null,i=0,n=!1,s=!1,a=new So,o=new as,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,f){let m=d.length!==0||f||i!==0||n;return n=f,i=d.length,m},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,f){r=u(d,f,0)},this.setState=function(d,f,m){let v=d.clippingPlanes,y=d.clipIntersection,x=d.clipShadows,w=e.get(d);if(!n||v===null||v.length===0||s&&!x)s?u(null):c();else{let _=s?0:i,S=_*4,P=w.clippingState||null;l.value=P,P=u(v,f,S,m);for(let M=0;M!==S;++M)P[M]=r[M];w.clippingState=P,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=_}};function c(){l.value!==r&&(l.value=r,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function u(d,f,m,v){let y=d!==null?d.length:0,x=null;if(y!==0){if(x=l.value,v!==!0||x===null){let w=m+y*4,_=f.matrixWorldInverse;o.getNormalMatrix(_),(x===null||x.length<w)&&(x=new Float32Array(w));for(let S=0,P=m;S!==y;++S,P+=4)a.copy(d[S]).applyMatrix4(_,o),a.normal.toArray(x,P),x[P+3]=a.constant}l.value=x,l.needsUpdate=!0}return t.numPlanes=y,t.numIntersection=0,x}}function tAe(e){let t=new WeakMap;function r(a,o){return o===Cj?a.mapping=Ug:o===Tj&&(a.mapping=Hg),a}function i(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){let o=a.mapping;if(o===Cj||o===Tj)if(t.has(a)){let l=t.get(a).texture;return r(l,a.mapping)}else{let l=a.image;if(l&&l.height>0){let c=new p_e(l.height/2);return c.fromEquirectangularTexture(e,a),t.set(a,c),a.addEventListener("dispose",n),r(c.texture,a.mapping)}else return null}}return a}function n(a){let o=a.target;o.removeEventListener("dispose",n);let l=t.get(o);l!==void 0&&(t.delete(o),l.dispose())}function s(){t=new WeakMap}return{get:i,dispose:s}}var M3=class extends em{constructor(e=-1,t=1,r=1,i=-1,n=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,n,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=r-e,s=r+e,a=i+t,o=i-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,s=n+l*this.view.width,a-=c*this.view.offsetY,o=a-c*this.view.height}this.projectionMatrix.makeOrthographic(n,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},gy=4,IG=[.125,.215,.35,.446,.526,.582],ig=20,e4=new M3,OG=new Zt,t4=null,$m=(1+Math.sqrt(5))/2,Av=1/$m,jG=[new V(1,1,1),new V(-1,1,1),new V(1,1,-1),new V(-1,1,-1),new V(0,$m,Av),new V(0,$m,-Av),new V(Av,0,$m),new V(-Av,0,$m),new V($m,Av,0),new V(-$m,Av,0)],LG=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){t4=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,r,i,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=FG(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=BG(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(t4),e.scissorTest=!1,lA(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ug||e.mapping===Hg?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),t4=this._renderer.getRenderTarget();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Pr,minFilter:Pr,generateMipmaps:!1,type:Rh,format:dn,encoding:Bc,depthBuffer:!1},i=zG(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=zG(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=rAe(n)),this._blurMaterial=iAe(n,e,t)}return i}_compileMaterial(e){let t=new Yi(this._lodPlanes[0],e);this._renderer.compile(t,e4)}_sceneToCubeUV(e,t,r,i){let n=new Ra(90,1,t,r),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor(OG),o.toneMapping=zu,o.autoClear=!1;let u=new Ih({name:"PMREM.Background",side:Ys,depthWrite:!1,depthTest:!1}),d=new Yi(new Fc,u),f=!1,m=e.background;m?m.isColor&&(u.color.copy(m),e.background=null,f=!0):(u.color.copy(OG),f=!0);for(let v=0;v<6;v++){let y=v%3;y===0?(n.up.set(0,s[v],0),n.lookAt(a[v],0,0)):y===1?(n.up.set(0,0,s[v]),n.lookAt(0,a[v],0)):(n.up.set(0,s[v],0),n.lookAt(0,0,a[v]));let x=this._cubeSize;lA(i,y*x,v>2?x:0,x,x),o.setRenderTarget(i),f&&o.render(d,n),o.render(e,n)}d.geometry.dispose(),d.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=m}_textureToCubeUV(e,t){let r=this._renderer,i=e.mapping===Ug||e.mapping===Hg;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=FG()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=BG());let n=i?this._cubemapMaterial:this._equirectMaterial,s=new Yi(this._lodPlanes[0],n),a=n.uniforms;a.envMap.value=e;let o=this._cubeSize;lA(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(s,e4)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let n=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=jG[(i-1)%jG.length];this._blur(e,i-1,i,n,s)}t.autoClear=r}_blur(e,t,r,i,n){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,i,"latitudinal",n),this._halfBlur(s,e,r,r,i,"longitudinal",n)}_halfBlur(e,t,r,i,n,s,a){let o=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,u=new Yi(this._lodPlanes[i],l),d=l.uniforms,f=this._sizeLods[r]-1,m=isFinite(n)?Math.PI/(2*f):2*Math.PI/(2*ig-1),v=n/m,y=isFinite(n)?1+Math.floor(c*v):ig;y>ig&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${ig}`);let x=[],w=0;for(let C=0;C<ig;++C){let T=C/v,E=Math.exp(-T*T/2);x.push(E),C===0?w+=E:C<y&&(w+=2*E)}for(let C=0;C<x.length;C++)x[C]=x[C]/w;d.envMap.value=e.texture,d.samples.value=y,d.weights.value=x,d.latitudinal.value=s==="latitudinal",a&&(d.poleAxis.value=a);let{_lodMax:_}=this;d.dTheta.value=m,d.mipInt.value=_-r;let S=this._sizeLods[i],P=3*S*(i>_-gy?i-_+gy:0),M=4*(this._cubeSize-S);lA(t,P,M,3*S,2*S),o.setRenderTarget(t),o.render(u,e4)}};function rAe(e){let t=[],r=[],i=[],n=e,s=e-gy+1+IG.length;for(let a=0;a<s;a++){let o=Math.pow(2,n);r.push(o);let l=1/o;a>e-gy?l=IG[a-e+gy-1]:a===0&&(l=0),i.push(l);let c=1/(o-2),u=-c,d=1+c,f=[u,u,d,u,d,d,u,u,d,d,u,d],m=6,v=6,y=3,x=2,w=1,_=new Float32Array(y*v*m),S=new Float32Array(x*v*m),P=new Float32Array(w*v*m);for(let C=0;C<m;C++){let T=C%3*2/3-1,E=C>2?0:-1,N=[T,E,0,T+2/3,E,0,T+2/3,E+1,0,T,E,0,T+2/3,E+1,0,T,E+1,0];_.set(N,y*v*C),S.set(f,x*v*C);let D=[C,C,C,C,C,C];P.set(D,w*v*C)}let M=new Lt;M.setAttribute("position",new Jt(_,y)),M.setAttribute("uv",new Jt(S,x)),M.setAttribute("faceIndex",new Jt(P,w)),t.push(M),n>gy&&n--}return{lodPlanes:t,sizeLods:r,sigmas:i}}function zG(e,t,r){let i=new Zr(e,t,r);return i.texture.mapping=N_,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function lA(e,t,r,i,n){e.viewport.set(t,r,i,n),e.scissor.set(t,r,i,n)}function iAe(e,t,r){let i=new Float32Array(ig),n=new V(0,1,0);return new Jr({name:"SphericalGaussianBlur",defines:{n:ig,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:H6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:cs,depthTest:!1,depthWrite:!1})}function BG(){return new Jr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:H6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:cs,depthTest:!1,depthWrite:!1})}function FG(){return new Jr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:H6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:cs,depthTest:!1,depthWrite:!1})}function H6(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function nAe(e){let t=new WeakMap,r=null;function i(o){if(o&&o.isTexture){let l=o.mapping,c=l===Cj||l===Tj,u=l===Ug||l===Hg;if(c||u)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let d=t.get(o);return r===null&&(r=new LG(e)),d=c?r.fromEquirectangular(o,d):r.fromCubemap(o,d),t.set(o,d),d.texture}else{if(t.has(o))return t.get(o).texture;{let d=o.image;if(c&&d&&d.height>0||u&&d&&n(d)){r===null&&(r=new LG(e));let f=c?r.fromEquirectangular(o):r.fromCubemap(o);return t.set(o,f),o.addEventListener("dispose",s),f.texture}else return null}}}return o}function n(o){let l=0,c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){let l=o.target;l.removeEventListener("dispose",s);let c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function a(){t=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:i,dispose:a}}function sAe(e){let t={};function r(i){if(t[i]!==void 0)return t[i];let n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}return{has:function(i){return r(i)!==null},init:function(i){i.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(i){let n=r(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function aAe(e,t,r,i){let n={},s=new WeakMap;function a(d){let f=d.target;f.index!==null&&t.remove(f.index);for(let v in f.attributes)t.remove(f.attributes[v]);f.removeEventListener("dispose",a),delete n[f.id];let m=s.get(f);m&&(t.remove(m),s.delete(f)),i.releaseStatesOfGeometry(f),f.isInstancedBufferGeometry===!0&&delete f._maxInstanceCount,r.memory.geometries--}function o(d,f){return n[f.id]===!0||(f.addEventListener("dispose",a),n[f.id]=!0,r.memory.geometries++),f}function l(d){let f=d.attributes;for(let v in f)t.update(f[v],34962);let m=d.morphAttributes;for(let v in m){let y=m[v];for(let x=0,w=y.length;x<w;x++)t.update(y[x],34962)}}function c(d){let f=[],m=d.index,v=d.attributes.position,y=0;if(m!==null){let _=m.array;y=m.version;for(let S=0,P=_.length;S<P;S+=3){let M=_[S+0],C=_[S+1],T=_[S+2];f.push(M,C,C,T,T,M)}}else{let _=v.array;y=v.version;for(let S=0,P=_.length/3-1;S<P;S+=3){let M=S+0,C=S+1,T=S+2;f.push(M,C,C,T,T,M)}}let x=new(lie(f)?Ny:pie)(f,1);x.version=y;let w=s.get(d);w&&t.remove(w),s.set(d,x)}function u(d){let f=s.get(d);if(f){let m=d.index;m!==null&&f.version<m.version&&c(d)}else c(d);return s.get(d)}return{get:o,update:l,getWireframeAttribute:u}}function oAe(e,t,r,i){let n=i.isWebGL2,s;function a(f){s=f}let o,l;function c(f){o=f.type,l=f.bytesPerElement}function u(f,m){e.drawElements(s,m,o,f*l),r.update(m,s,1)}function d(f,m,v){if(v===0)return;let y,x;if(n)y=e,x="drawElementsInstanced";else if(y=t.get("ANGLE_instanced_arrays"),x="drawElementsInstancedANGLE",y===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[x](s,m,o,f*l,v),r.update(m,s,v)}this.setMode=a,this.setIndex=c,this.render=u,this.renderInstances=d}function lAe(e){let t={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(r.calls++,a){case 4:r.triangles+=o*(s/3);break;case 1:r.lines+=o*(s/2);break;case 3:r.lines+=o*(s-1);break;case 2:r.lines+=o*s;break;case 0:r.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function n(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:t,render:r,programs:null,autoReset:!0,reset:n,update:i}}function cAe(e,t){return e[0]-t[0]}function uAe(e,t){return Math.abs(t[1])-Math.abs(e[1])}function dAe(e,t,r){let i={},n=new Float32Array(8),s=new WeakMap,a=new fr,o=[];for(let c=0;c<8;c++)o[c]=[c,0];function l(c,u,d,f){let m=c.morphTargetInfluences;if(t.isWebGL2===!0){let v=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,y=v!==void 0?v.length:0,x=s.get(u);if(x===void 0||x.count!==y){let S=function(){B.dispose(),s.delete(u),u.removeEventListener("dispose",S)};x!==void 0&&x.texture.dispose();let P=u.morphAttributes.position!==void 0,M=u.morphAttributes.normal!==void 0,C=u.morphAttributes.color!==void 0,T=u.morphAttributes.position||[],E=u.morphAttributes.normal||[],N=u.morphAttributes.color||[],D=0;P===!0&&(D=1),M===!0&&(D=2),C===!0&&(D=3);let I=u.attributes.position.count*D,j=1;I>t.maxTextureSize&&(j=Math.ceil(I/t.maxTextureSize),I=t.maxTextureSize);let L=new Float32Array(I*j*4*y),B=new hie(L,I,j,y);B.type=Ni,B.needsUpdate=!0;let q=D*4;for(let G=0;G<y;G++){let Y=T[G],X=E[G],re=N[G],F=I*j*4*G;for(let $=0;$<Y.count;$++){let se=$*q;P===!0&&(a.fromBufferAttribute(Y,$),L[F+se+0]=a.x,L[F+se+1]=a.y,L[F+se+2]=a.z,L[F+se+3]=0),M===!0&&(a.fromBufferAttribute(X,$),L[F+se+4]=a.x,L[F+se+5]=a.y,L[F+se+6]=a.z,L[F+se+7]=0),C===!0&&(a.fromBufferAttribute(re,$),L[F+se+8]=a.x,L[F+se+9]=a.y,L[F+se+10]=a.z,L[F+se+11]=re.itemSize===4?a.w:1)}}x={count:y,texture:B,size:new ge(I,j)},s.set(u,x),u.addEventListener("dispose",S)}let w=0;for(let S=0;S<m.length;S++)w+=m[S];let _=u.morphTargetsRelative?1:1-w;f.getUniforms().setValue(e,"morphTargetBaseInfluence",_),f.getUniforms().setValue(e,"morphTargetInfluences",m),f.getUniforms().setValue(e,"morphTargetsTexture",x.texture,r),f.getUniforms().setValue(e,"morphTargetsTextureSize",x.size)}else{let v=m===void 0?0:m.length,y=i[u.id];if(y===void 0||y.length!==v){y=[];for(let P=0;P<v;P++)y[P]=[P,0];i[u.id]=y}for(let P=0;P<v;P++){let M=y[P];M[0]=P,M[1]=m[P]}y.sort(uAe);for(let P=0;P<8;P++)P<v&&y[P][1]?(o[P][0]=y[P][0],o[P][1]=y[P][1]):(o[P][0]=Number.MAX_SAFE_INTEGER,o[P][1]=0);o.sort(cAe);let x=u.morphAttributes.position,w=u.morphAttributes.normal,_=0;for(let P=0;P<8;P++){let M=o[P],C=M[0],T=M[1];C!==Number.MAX_SAFE_INTEGER&&T?(x&&u.getAttribute("morphTarget"+P)!==x[C]&&u.setAttribute("morphTarget"+P,x[C]),w&&u.getAttribute("morphNormal"+P)!==w[C]&&u.setAttribute("morphNormal"+P,w[C]),n[P]=T,_+=T):(x&&u.hasAttribute("morphTarget"+P)===!0&&u.deleteAttribute("morphTarget"+P),w&&u.hasAttribute("morphNormal"+P)===!0&&u.deleteAttribute("morphNormal"+P),n[P]=0)}let S=u.morphTargetsRelative?1:1-_;f.getUniforms().setValue(e,"morphTargetBaseInfluence",S),f.getUniforms().setValue(e,"morphTargetInfluences",n)}}return{update:l}}function hAe(e,t,r,i){let n=new WeakMap;function s(l){let c=i.render.frame,u=l.geometry,d=t.get(l,u);return n.get(d)!==c&&(t.update(d),n.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.update(l.instanceMatrix,34962),l.instanceColor!==null&&r.update(l.instanceColor,34962)),d}function a(){n=new WeakMap}function o(l){let c=l.target;c.removeEventListener("dispose",o),r.remove(c.instanceMatrix),c.instanceColor!==null&&r.remove(c.instanceColor)}return{update:s,dispose:a}}var vie=new yn,yie=new hie,xie=new J2e,bie=new V6,VG=[],UG=[],HG=new Float32Array(16),GG=new Float32Array(9),WG=new Float32Array(4);function Yx(e,t,r){let i=e[0];if(i==null||i<=0||i>0)return e;let n=t*r,s=VG[n];if(s===void 0&&(s=new Float32Array(n),VG[n]=s),t!==0){i.toArray(s,0);for(let a=1,o=0;a!==t;++a)o+=r,e[a].toArray(s,o)}return s}function Ps(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function Ds(e,t){for(let r=0,i=t.length;r<i;r++)e[r]=t[r]}function P3(e,t){let r=UG[t];r===void 0&&(r=new Int32Array(t),UG[t]=r);for(let i=0;i!==t;++i)r[i]=e.allocateTextureUnit();return r}function fAe(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function pAe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Ps(r,t))return;e.uniform2fv(this.addr,t),Ds(r,t)}}function mAe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(t.r!==void 0)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(Ps(r,t))return;e.uniform3fv(this.addr,t),Ds(r,t)}}function gAe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Ps(r,t))return;e.uniform4fv(this.addr,t),Ds(r,t)}}function vAe(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Ps(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Ds(r,t)}else{if(Ps(r,i))return;WG.set(i),e.uniformMatrix2fv(this.addr,!1,WG),Ds(r,i)}}function yAe(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Ps(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Ds(r,t)}else{if(Ps(r,i))return;GG.set(i),e.uniformMatrix3fv(this.addr,!1,GG),Ds(r,i)}}function xAe(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Ps(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Ds(r,t)}else{if(Ps(r,i))return;HG.set(i),e.uniformMatrix4fv(this.addr,!1,HG),Ds(r,i)}}function bAe(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function wAe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Ps(r,t))return;e.uniform2iv(this.addr,t),Ds(r,t)}}function _Ae(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Ps(r,t))return;e.uniform3iv(this.addr,t),Ds(r,t)}}function SAe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Ps(r,t))return;e.uniform4iv(this.addr,t),Ds(r,t)}}function EAe(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function AAe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Ps(r,t))return;e.uniform2uiv(this.addr,t),Ds(r,t)}}function CAe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(Ps(r,t))return;e.uniform3uiv(this.addr,t),Ds(r,t)}}function TAe(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Ps(r,t))return;e.uniform4uiv(this.addr,t),Ds(r,t)}}function MAe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2D(t||vie,n)}function PAe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(t||xie,n)}function DAe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(t||bie,n)}function NAe(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(t||yie,n)}function kAe(e){switch(e){case 5126:return fAe;case 35664:return pAe;case 35665:return mAe;case 35666:return gAe;case 35674:return vAe;case 35675:return yAe;case 35676:return xAe;case 5124:case 35670:return bAe;case 35667:case 35671:return wAe;case 35668:case 35672:return _Ae;case 35669:case 35673:return SAe;case 5125:return EAe;case 36294:return AAe;case 36295:return CAe;case 36296:return TAe;case 35678:case 36198:case 36298:case 36306:case 35682:return MAe;case 35679:case 36299:case 36307:return PAe;case 35680:case 36300:case 36308:case 36293:return DAe;case 36289:case 36303:case 36311:case 36292:return NAe}}function RAe(e,t){e.uniform1fv(this.addr,t)}function IAe(e,t){let r=Yx(t,this.size,2);e.uniform2fv(this.addr,r)}function OAe(e,t){let r=Yx(t,this.size,3);e.uniform3fv(this.addr,r)}function jAe(e,t){let r=Yx(t,this.size,4);e.uniform4fv(this.addr,r)}function LAe(e,t){let r=Yx(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function zAe(e,t){let r=Yx(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function BAe(e,t){let r=Yx(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function FAe(e,t){e.uniform1iv(this.addr,t)}function VAe(e,t){e.uniform2iv(this.addr,t)}function UAe(e,t){e.uniform3iv(this.addr,t)}function HAe(e,t){e.uniform4iv(this.addr,t)}function GAe(e,t){e.uniform1uiv(this.addr,t)}function WAe(e,t){e.uniform2uiv(this.addr,t)}function qAe(e,t){e.uniform3uiv(this.addr,t)}function YAe(e,t){e.uniform4uiv(this.addr,t)}function XAe(e,t,r){let i=this.cache,n=t.length,s=P3(r,n);Ps(i,s)||(e.uniform1iv(this.addr,s),Ds(i,s));for(let a=0;a!==n;++a)r.setTexture2D(t[a]||vie,s[a])}function $Ae(e,t,r){let i=this.cache,n=t.length,s=P3(r,n);Ps(i,s)||(e.uniform1iv(this.addr,s),Ds(i,s));for(let a=0;a!==n;++a)r.setTexture3D(t[a]||xie,s[a])}function KAe(e,t,r){let i=this.cache,n=t.length,s=P3(r,n);Ps(i,s)||(e.uniform1iv(this.addr,s),Ds(i,s));for(let a=0;a!==n;++a)r.setTextureCube(t[a]||bie,s[a])}function QAe(e,t,r){let i=this.cache,n=t.length,s=P3(r,n);Ps(i,s)||(e.uniform1iv(this.addr,s),Ds(i,s));for(let a=0;a!==n;++a)r.setTexture2DArray(t[a]||yie,s[a])}function ZAe(e){switch(e){case 5126:return RAe;case 35664:return IAe;case 35665:return OAe;case 35666:return jAe;case 35674:return LAe;case 35675:return zAe;case 35676:return BAe;case 5124:case 35670:return FAe;case 35667:case 35671:return VAe;case 35668:case 35672:return UAe;case 35669:case 35673:return HAe;case 5125:return GAe;case 36294:return WAe;case 36295:return qAe;case 36296:return YAe;case 35678:case 36198:case 36298:case 36306:case 35682:return XAe;case 35679:case 36299:case 36307:return $Ae;case 35680:case 36300:case 36308:case 36293:return KAe;case 36289:case 36303:case 36311:case 36292:return QAe}}var JAe=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=kAe(t.type)}},eCe=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=ZAe(t.type)}},tCe=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){if(t===void 0)return;let i=this.seq;for(let n=0,s=i.length;n!==s;++n){let a=i[n];a.setValue(e,t[a.id],r)}}},r4=/(\w+)(\])?(\[|\.)?/g;function qG(e,t){e.seq.push(t),e.map[t.id]=t}function rCe(e,t,r){let i=e.name,n=i.length;for(r4.lastIndex=0;;){let s=r4.exec(i),a=r4.lastIndex,o=s[1],l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===n){qG(r,c===void 0?new JAe(o,e,t):new eCe(o,e,t));break}else{let u=r.map[o];u===void 0&&(u=new tCe(o),qG(r,u)),r=u}}}var nT=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){let n=e.getActiveUniform(t,i),s=e.getUniformLocation(t,n.name);rCe(n,s,this)}}setValue(e,t,r,i){let n=this.map[t];n!==void 0&&n.setValue(e,r,i)}setOptional(e,t,r){let i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let n=0,s=t.length;n!==s;++n){let a=t[n],o=r[a.id];o.needsUpdate!==!1&&a.setValue(e,o.value,i)}}static seqWithValue(e,t){let r=[];for(let i=0,n=e.length;i!==n;++i){let s=e[i];s.id in t&&r.push(s)}return r}};function YG(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}var iCe=0;function nCe(e,t){let r=e.split(`
`),i=[],n=Math.max(t-6,0),s=Math.min(t+6,r.length);for(let a=n;a<s;a++){let o=a+1;i.push(`${o===t?">":" "} ${o}: ${r[a]}`)}return i.join(`
`)}function sCe(e){switch(e){case Bc:return["Linear","( value )"];case Ar:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function XG(e,t,r){let i=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();if(i&&n==="")return"";let s=/ERROR: 0:(\d+)/.exec(n);if(s){let a=parseInt(s[1]);return r.toUpperCase()+`

`+n+`

`+nCe(e.getShaderSource(t),a)}else return n}function aCe(e,t){let r=sCe(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function oCe(e,t){let r;switch(t){case p2e:r="Linear";break;case m2e:r="Reinhard";break;case g2e:r="OptimizedCineon";break;case v2e:r="ACESFilmic";break;case y2e:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function lCe(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(yw).join(`
`)}function cCe(e){let t=[];for(let r in e){let i=e[r];i!==!1&&t.push("#define "+r+" "+i)}return t.join(`
`)}function uCe(e,t){let r={},i=e.getProgramParameter(t,35721);for(let n=0;n<i;n++){let s=e.getActiveAttrib(t,n),a=s.name,o=1;s.type===35674&&(o=2),s.type===35675&&(o=3),s.type===35676&&(o=4),r[a]={type:s.type,location:e.getAttribLocation(t,a),locationSize:o}}return r}function yw(e){return e!==""}function $G(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function KG(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var dCe=/^[ \t]*#include +<([\w\d./]+)>/gm;function Rj(e){return e.replace(dCe,hCe)}function hCe(e,t){let r=Tr[t];if(r===void 0)throw new Error("Can not resolve #include <"+t+">");return Rj(r)}var fCe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function QG(e){return e.replace(fCe,pCe)}function pCe(e,t,r,i){let n="";for(let s=parseInt(t);s<parseInt(r);s++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function ZG(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function mCe(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===j6?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===qwe?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===vw&&(t="SHADOWMAP_TYPE_VSM"),t}function gCe(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Ug:case Hg:t="ENVMAP_TYPE_CUBE";break;case N_:t="ENVMAP_TYPE_CUBE_UV";break}return t}function vCe(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Hg:t="ENVMAP_MODE_REFRACTION";break}return t}function yCe(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case eie:t="ENVMAP_BLENDING_MULTIPLY";break;case h2e:t="ENVMAP_BLENDING_MIX";break;case f2e:t="ENVMAP_BLENDING_ADD";break}return t}function xCe(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let r=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:i,maxMip:r}}function bCe(e,t,r,i){let n=e.getContext(),s=r.defines,a=r.vertexShader,o=r.fragmentShader,l=mCe(r),c=gCe(r),u=vCe(r),d=yCe(r),f=xCe(r),m=r.isWebGL2?"":lCe(r),v=cCe(s),y=n.createProgram(),x,w,_=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(x=[v].filter(yw).join(`
`),x.length>0&&(x+=`
`),w=[m,v].filter(yw).join(`
`),w.length>0&&(w+=`
`)):(x=[ZG(r),"#define SHADER_NAME "+r.shaderName,v,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(yw).join(`
`),w=[m,ZG(r),"#define SHADER_NAME "+r.shaderName,v,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+u:"",r.envMap?"#define "+d:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==zu?"#define TONE_MAPPING":"",r.toneMapping!==zu?Tr.tonemapping_pars_fragment:"",r.toneMapping!==zu?oCe("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",Tr.encodings_pars_fragment,aCe("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(yw).join(`
`)),a=Rj(a),a=$G(a,r),a=KG(a,r),o=Rj(o),o=$G(o,r),o=KG(o,r),a=QG(a),o=QG(o),r.isWebGL2&&r.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,x=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+x,w=["#define varying in",r.glslVersion===Dj?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===Dj?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);let S=_+x+a,P=_+w+o,M=YG(n,35633,S),C=YG(n,35632,P);if(n.attachShader(y,M),n.attachShader(y,C),r.index0AttributeName!==void 0?n.bindAttribLocation(y,0,r.index0AttributeName):r.morphTargets===!0&&n.bindAttribLocation(y,0,"position"),n.linkProgram(y),e.debug.checkShaderErrors){let N=n.getProgramInfoLog(y).trim(),D=n.getShaderInfoLog(M).trim(),I=n.getShaderInfoLog(C).trim(),j=!0,L=!0;if(n.getProgramParameter(y,35714)===!1){j=!1;let B=XG(n,M,"vertex"),q=XG(n,C,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(y,35715)+`

Program Info Log: `+N+`
`+B+`
`+q)}else N!==""?console.warn("THREE.WebGLProgram: Program Info Log:",N):(D===""||I==="")&&(L=!1);L&&(this.diagnostics={runnable:j,programLog:N,vertexShader:{log:D,prefix:x},fragmentShader:{log:I,prefix:w}})}n.deleteShader(M),n.deleteShader(C);let T;this.getUniforms=function(){return T===void 0&&(T=new nT(n,y)),T};let E;return this.getAttributes=function(){return E===void 0&&(E=uCe(n,y)),E},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(y),this.program=void 0},this.name=r.shaderName,this.id=iCe++,this.cacheKey=t,this.usedTimes=1,this.program=y,this.vertexShader=M,this.fragmentShader=C,this}var wCe=0,_Ce=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(n)===!1&&(s.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return r===void 0&&(r=new SCe(e),t.set(e,r)),r}},SCe=class{constructor(e){this.id=wCe++,this.code=e,this.usedTimes=0}};function ECe(e,t,r,i,n,s,a){let o=new F6,l=new _Ce,c=[],u=n.isWebGL2,d=n.logarithmicDepthBuffer,f=n.vertexTextures,m=n.precision,v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(E,N,D,I,j){let L=I.fog,B=j.geometry,q=E.isMeshStandardMaterial?I.environment:null,G=(E.isMeshStandardMaterial?r:t).get(E.envMap||q),Y=G&&G.mapping===N_?G.image.height:null,X=v[E.type];E.precision!==null&&(m=n.getMaxPrecision(E.precision),m!==E.precision&&console.warn("THREE.WebGLProgram.getParameters:",E.precision,"not supported, using",m,"instead."));let re=B.morphAttributes.position||B.morphAttributes.normal||B.morphAttributes.color,F=re!==void 0?re.length:0,$=0;B.morphAttributes.position!==void 0&&($=1),B.morphAttributes.normal!==void 0&&($=2),B.morphAttributes.color!==void 0&&($=3);let se,H,ne,ce;if(X){let he=Mu[X];se=he.vertexShader,H=he.fragmentShader}else se=E.vertexShader,H=E.fragmentShader,l.update(E),ne=l.getVertexShaderID(E),ce=l.getFragmentShaderID(E);let ie=e.getRenderTarget(),ae=E.alphaTest>0,Z=E.clearcoat>0,fe=E.iridescence>0;return{isWebGL2:u,shaderID:X,shaderName:E.type,vertexShader:se,fragmentShader:H,defines:E.defines,customVertexShaderID:ne,customFragmentShaderID:ce,isRawShaderMaterial:E.isRawShaderMaterial===!0,glslVersion:E.glslVersion,precision:m,instancing:j.isInstancedMesh===!0,instancingColor:j.isInstancedMesh===!0&&j.instanceColor!==null,supportsVertexTextures:f,outputEncoding:ie===null?e.outputEncoding:ie.isXRRenderTarget===!0?ie.texture.encoding:Bc,map:!!E.map,matcap:!!E.matcap,envMap:!!G,envMapMode:G&&G.mapping,envMapCubeUVHeight:Y,lightMap:!!E.lightMap,aoMap:!!E.aoMap,emissiveMap:!!E.emissiveMap,bumpMap:!!E.bumpMap,normalMap:!!E.normalMap,objectSpaceNormalMap:E.normalMapType===I2e,tangentSpaceNormalMap:E.normalMapType===R2e,decodeVideoTexture:!!E.map&&E.map.isVideoTexture===!0&&E.map.encoding===Ar,clearcoat:Z,clearcoatMap:Z&&!!E.clearcoatMap,clearcoatRoughnessMap:Z&&!!E.clearcoatRoughnessMap,clearcoatNormalMap:Z&&!!E.clearcoatNormalMap,iridescence:fe,iridescenceMap:fe&&!!E.iridescenceMap,iridescenceThicknessMap:fe&&!!E.iridescenceThicknessMap,displacementMap:!!E.displacementMap,roughnessMap:!!E.roughnessMap,metalnessMap:!!E.metalnessMap,specularMap:!!E.specularMap,specularIntensityMap:!!E.specularIntensityMap,specularColorMap:!!E.specularColorMap,opaque:E.transparent===!1&&E.blending===Ag,alphaMap:!!E.alphaMap,alphaTest:ae,gradientMap:!!E.gradientMap,sheen:E.sheen>0,sheenColorMap:!!E.sheenColorMap,sheenRoughnessMap:!!E.sheenRoughnessMap,transmission:E.transmission>0,transmissionMap:!!E.transmissionMap,thicknessMap:!!E.thicknessMap,combine:E.combine,vertexTangents:!!E.normalMap&&!!B.attributes.tangent,vertexColors:E.vertexColors,vertexAlphas:E.vertexColors===!0&&!!B.attributes.color&&B.attributes.color.itemSize===4,vertexUvs:!!E.map||!!E.bumpMap||!!E.normalMap||!!E.specularMap||!!E.alphaMap||!!E.emissiveMap||!!E.roughnessMap||!!E.metalnessMap||!!E.clearcoatMap||!!E.clearcoatRoughnessMap||!!E.clearcoatNormalMap||!!E.iridescenceMap||!!E.iridescenceThicknessMap||!!E.displacementMap||!!E.transmissionMap||!!E.thicknessMap||!!E.specularIntensityMap||!!E.specularColorMap||!!E.sheenColorMap||!!E.sheenRoughnessMap,uvsVertexOnly:!(E.map||E.bumpMap||E.normalMap||E.specularMap||E.alphaMap||E.emissiveMap||E.roughnessMap||E.metalnessMap||E.clearcoatNormalMap||E.iridescenceMap||E.iridescenceThicknessMap||E.transmission>0||E.transmissionMap||E.thicknessMap||E.specularIntensityMap||E.specularColorMap||E.sheen>0||E.sheenColorMap||E.sheenRoughnessMap)&&!!E.displacementMap,fog:!!L,useFog:E.fog===!0,fogExp2:L&&L.isFogExp2,flatShading:!!E.flatShading,sizeAttenuation:E.sizeAttenuation,logarithmicDepthBuffer:d,skinning:j.isSkinnedMesh===!0,morphTargets:B.morphAttributes.position!==void 0,morphNormals:B.morphAttributes.normal!==void 0,morphColors:B.morphAttributes.color!==void 0,morphTargetsCount:F,morphTextureStride:$,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numSpotLightMaps:N.spotLightMap.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numSpotLightShadowsWithMaps:N.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:E.dithering,shadowMapEnabled:e.shadowMap.enabled&&D.length>0,shadowMapType:e.shadowMap.type,toneMapping:E.toneMapped?e.toneMapping:zu,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:E.premultipliedAlpha,doubleSided:E.side===La,flipSided:E.side===Ys,useDepthPacking:!!E.depthPacking,depthPacking:E.depthPacking||0,index0AttributeName:E.index0AttributeName,extensionDerivatives:E.extensions&&E.extensions.derivatives,extensionFragDepth:E.extensions&&E.extensions.fragDepth,extensionDrawBuffers:E.extensions&&E.extensions.drawBuffers,extensionShaderTextureLOD:E.extensions&&E.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:E.customProgramCacheKey()}}function x(E){let N=[];if(E.shaderID?N.push(E.shaderID):(N.push(E.customVertexShaderID),N.push(E.customFragmentShaderID)),E.defines!==void 0)for(let D in E.defines)N.push(D),N.push(E.defines[D]);return E.isRawShaderMaterial===!1&&(w(N,E),_(N,E),N.push(e.outputEncoding)),N.push(E.customProgramCacheKey),N.join()}function w(E,N){E.push(N.precision),E.push(N.outputEncoding),E.push(N.envMapMode),E.push(N.envMapCubeUVHeight),E.push(N.combine),E.push(N.vertexUvs),E.push(N.fogExp2),E.push(N.sizeAttenuation),E.push(N.morphTargetsCount),E.push(N.morphAttributeCount),E.push(N.numDirLights),E.push(N.numPointLights),E.push(N.numSpotLights),E.push(N.numSpotLightMaps),E.push(N.numHemiLights),E.push(N.numRectAreaLights),E.push(N.numDirLightShadows),E.push(N.numPointLightShadows),E.push(N.numSpotLightShadows),E.push(N.numSpotLightShadowsWithMaps),E.push(N.shadowMapType),E.push(N.toneMapping),E.push(N.numClippingPlanes),E.push(N.numClipIntersection),E.push(N.depthPacking)}function _(E,N){o.disableAll(),N.isWebGL2&&o.enable(0),N.supportsVertexTextures&&o.enable(1),N.instancing&&o.enable(2),N.instancingColor&&o.enable(3),N.map&&o.enable(4),N.matcap&&o.enable(5),N.envMap&&o.enable(6),N.lightMap&&o.enable(7),N.aoMap&&o.enable(8),N.emissiveMap&&o.enable(9),N.bumpMap&&o.enable(10),N.normalMap&&o.enable(11),N.objectSpaceNormalMap&&o.enable(12),N.tangentSpaceNormalMap&&o.enable(13),N.clearcoat&&o.enable(14),N.clearcoatMap&&o.enable(15),N.clearcoatRoughnessMap&&o.enable(16),N.clearcoatNormalMap&&o.enable(17),N.iridescence&&o.enable(18),N.iridescenceMap&&o.enable(19),N.iridescenceThicknessMap&&o.enable(20),N.displacementMap&&o.enable(21),N.specularMap&&o.enable(22),N.roughnessMap&&o.enable(23),N.metalnessMap&&o.enable(24),N.gradientMap&&o.enable(25),N.alphaMap&&o.enable(26),N.alphaTest&&o.enable(27),N.vertexColors&&o.enable(28),N.vertexAlphas&&o.enable(29),N.vertexUvs&&o.enable(30),N.vertexTangents&&o.enable(31),N.uvsVertexOnly&&o.enable(32),E.push(o.mask),o.disableAll(),N.fog&&o.enable(0),N.useFog&&o.enable(1),N.flatShading&&o.enable(2),N.logarithmicDepthBuffer&&o.enable(3),N.skinning&&o.enable(4),N.morphTargets&&o.enable(5),N.morphNormals&&o.enable(6),N.morphColors&&o.enable(7),N.premultipliedAlpha&&o.enable(8),N.shadowMapEnabled&&o.enable(9),N.physicallyCorrectLights&&o.enable(10),N.doubleSided&&o.enable(11),N.flipSided&&o.enable(12),N.useDepthPacking&&o.enable(13),N.dithering&&o.enable(14),N.specularIntensityMap&&o.enable(15),N.specularColorMap&&o.enable(16),N.transmission&&o.enable(17),N.transmissionMap&&o.enable(18),N.thicknessMap&&o.enable(19),N.sheen&&o.enable(20),N.sheenColorMap&&o.enable(21),N.sheenRoughnessMap&&o.enable(22),N.decodeVideoTexture&&o.enable(23),N.opaque&&o.enable(24),E.push(o.mask)}function S(E){let N=v[E.type],D;if(N){let I=Mu[N];D=qx.clone(I.uniforms)}else D=E.uniforms;return D}function P(E,N){let D;for(let I=0,j=c.length;I<j;I++){let L=c[I];if(L.cacheKey===N){D=L,++D.usedTimes;break}}return D===void 0&&(D=new bCe(e,N,E,s),c.push(D)),D}function M(E){if(--E.usedTimes===0){let N=c.indexOf(E);c[N]=c[c.length-1],c.pop(),E.destroy()}}function C(E){l.remove(E)}function T(){l.dispose()}return{getParameters:y,getProgramCacheKey:x,getUniforms:S,acquireProgram:P,releaseProgram:M,releaseShaderCache:C,programs:c,dispose:T}}function ACe(){let e=new WeakMap;function t(s){let a=e.get(s);return a===void 0&&(a={},e.set(s,a)),a}function r(s){e.delete(s)}function i(s,a,o){e.get(s)[a]=o}function n(){e=new WeakMap}return{get:t,remove:r,update:i,dispose:n}}function CCe(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function JG(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function eW(){let e=[],t=0,r=[],i=[],n=[];function s(){t=0,r.length=0,i.length=0,n.length=0}function a(d,f,m,v,y,x){let w=e[t];return w===void 0?(w={id:d.id,object:d,geometry:f,material:m,groupOrder:v,renderOrder:d.renderOrder,z:y,group:x},e[t]=w):(w.id=d.id,w.object=d,w.geometry=f,w.material=m,w.groupOrder=v,w.renderOrder=d.renderOrder,w.z=y,w.group=x),t++,w}function o(d,f,m,v,y,x){let w=a(d,f,m,v,y,x);m.transmission>0?i.push(w):m.transparent===!0?n.push(w):r.push(w)}function l(d,f,m,v,y,x){let w=a(d,f,m,v,y,x);m.transmission>0?i.unshift(w):m.transparent===!0?n.unshift(w):r.unshift(w)}function c(d,f){r.length>1&&r.sort(d||CCe),i.length>1&&i.sort(f||JG),n.length>1&&n.sort(f||JG)}function u(){for(let d=t,f=e.length;d<f;d++){let m=e[d];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:r,transmissive:i,transparent:n,init:s,push:o,unshift:l,finish:u,sort:c}}function TCe(){let e=new WeakMap;function t(i,n){let s=e.get(i),a;return s===void 0?(a=new eW,e.set(i,[a])):n>=s.length?(a=new eW,s.push(a)):a=s[n],a}function r(){e=new WeakMap}return{get:t,dispose:r}}function MCe(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new V,color:new Zt};break;case"SpotLight":r={position:new V,direction:new V,color:new Zt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new V,color:new Zt,distance:0,decay:0};break;case"HemisphereLight":r={direction:new V,skyColor:new Zt,groundColor:new Zt};break;case"RectAreaLight":r={color:new Zt,position:new V,halfWidth:new V,halfHeight:new V};break}return e[t.id]=r,r}}}function PCe(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ge,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=r,r}}}var DCe=0;function NCe(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function kCe(e,t){let r=new MCe,i=PCe(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)n.probe.push(new V);let s=new V,a=new ot,o=new ot;function l(u,d){let f=0,m=0,v=0;for(let I=0;I<9;I++)n.probe[I].set(0,0,0);let y=0,x=0,w=0,_=0,S=0,P=0,M=0,C=0,T=0,E=0;u.sort(NCe);let N=d!==!0?Math.PI:1;for(let I=0,j=u.length;I<j;I++){let L=u[I],B=L.color,q=L.intensity,G=L.distance,Y=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)f+=B.r*q*N,m+=B.g*q*N,v+=B.b*q*N;else if(L.isLightProbe)for(let X=0;X<9;X++)n.probe[X].addScaledVector(L.sh.coefficients[X],q);else if(L.isDirectionalLight){let X=r.get(L);if(X.color.copy(L.color).multiplyScalar(L.intensity*N),L.castShadow){let re=L.shadow,F=i.get(L);F.shadowBias=re.bias,F.shadowNormalBias=re.normalBias,F.shadowRadius=re.radius,F.shadowMapSize=re.mapSize,n.directionalShadow[y]=F,n.directionalShadowMap[y]=Y,n.directionalShadowMatrix[y]=L.shadow.matrix,P++}n.directional[y]=X,y++}else if(L.isSpotLight){let X=r.get(L);X.position.setFromMatrixPosition(L.matrixWorld),X.color.copy(B).multiplyScalar(q*N),X.distance=G,X.coneCos=Math.cos(L.angle),X.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),X.decay=L.decay,n.spot[w]=X;let re=L.shadow;if(L.map&&(n.spotLightMap[T]=L.map,T++,re.updateMatrices(L),L.castShadow&&E++),n.spotLightMatrix[w]=re.matrix,L.castShadow){let F=i.get(L);F.shadowBias=re.bias,F.shadowNormalBias=re.normalBias,F.shadowRadius=re.radius,F.shadowMapSize=re.mapSize,n.spotShadow[w]=F,n.spotShadowMap[w]=Y,C++}w++}else if(L.isRectAreaLight){let X=r.get(L);X.color.copy(B).multiplyScalar(q),X.halfWidth.set(L.width*.5,0,0),X.halfHeight.set(0,L.height*.5,0),n.rectArea[_]=X,_++}else if(L.isPointLight){let X=r.get(L);if(X.color.copy(L.color).multiplyScalar(L.intensity*N),X.distance=L.distance,X.decay=L.decay,L.castShadow){let re=L.shadow,F=i.get(L);F.shadowBias=re.bias,F.shadowNormalBias=re.normalBias,F.shadowRadius=re.radius,F.shadowMapSize=re.mapSize,F.shadowCameraNear=re.camera.near,F.shadowCameraFar=re.camera.far,n.pointShadow[x]=F,n.pointShadowMap[x]=Y,n.pointShadowMatrix[x]=L.shadow.matrix,M++}n.point[x]=X,x++}else if(L.isHemisphereLight){let X=r.get(L);X.skyColor.copy(L.color).multiplyScalar(q*N),X.groundColor.copy(L.groundColor).multiplyScalar(q*N),n.hemi[S]=X,S++}}_>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=bt.LTC_FLOAT_1,n.rectAreaLTC2=bt.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=bt.LTC_HALF_1,n.rectAreaLTC2=bt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=f,n.ambient[1]=m,n.ambient[2]=v;let D=n.hash;(D.directionalLength!==y||D.pointLength!==x||D.spotLength!==w||D.rectAreaLength!==_||D.hemiLength!==S||D.numDirectionalShadows!==P||D.numPointShadows!==M||D.numSpotShadows!==C||D.numSpotMaps!==T)&&(n.directional.length=y,n.spot.length=w,n.rectArea.length=_,n.point.length=x,n.hemi.length=S,n.directionalShadow.length=P,n.directionalShadowMap.length=P,n.pointShadow.length=M,n.pointShadowMap.length=M,n.spotShadow.length=C,n.spotShadowMap.length=C,n.directionalShadowMatrix.length=P,n.pointShadowMatrix.length=M,n.spotLightMatrix.length=C+T-E,n.spotLightMap.length=T,n.numSpotLightShadowsWithMaps=E,D.directionalLength=y,D.pointLength=x,D.spotLength=w,D.rectAreaLength=_,D.hemiLength=S,D.numDirectionalShadows=P,D.numPointShadows=M,D.numSpotShadows=C,D.numSpotMaps=T,n.version=DCe++)}function c(u,d){let f=0,m=0,v=0,y=0,x=0,w=d.matrixWorldInverse;for(let _=0,S=u.length;_<S;_++){let P=u[_];if(P.isDirectionalLight){let M=n.directional[f];M.direction.setFromMatrixPosition(P.matrixWorld),s.setFromMatrixPosition(P.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(w),f++}else if(P.isSpotLight){let M=n.spot[v];M.position.setFromMatrixPosition(P.matrixWorld),M.position.applyMatrix4(w),M.direction.setFromMatrixPosition(P.matrixWorld),s.setFromMatrixPosition(P.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(w),v++}else if(P.isRectAreaLight){let M=n.rectArea[y];M.position.setFromMatrixPosition(P.matrixWorld),M.position.applyMatrix4(w),o.identity(),a.copy(P.matrixWorld),a.premultiply(w),o.extractRotation(a),M.halfWidth.set(P.width*.5,0,0),M.halfHeight.set(0,P.height*.5,0),M.halfWidth.applyMatrix4(o),M.halfHeight.applyMatrix4(o),y++}else if(P.isPointLight){let M=n.point[m];M.position.setFromMatrixPosition(P.matrixWorld),M.position.applyMatrix4(w),m++}else if(P.isHemisphereLight){let M=n.hemi[x];M.direction.setFromMatrixPosition(P.matrixWorld),M.direction.transformDirection(w),x++}}}return{setup:l,setupView:c,state:n}}function tW(e,t){let r=new kCe(e,t),i=[],n=[];function s(){i.length=0,n.length=0}function a(u){i.push(u)}function o(u){n.push(u)}function l(u){r.setup(i,u)}function c(u){r.setupView(i,u)}return{init:s,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:l,setupLightsView:c,pushLight:a,pushShadow:o}}function RCe(e,t){let r=new WeakMap;function i(s,a=0){let o=r.get(s),l;return o===void 0?(l=new tW(e,t),r.set(s,[l])):a>=o.length?(l=new tW(e,t),o.push(l)):l=o[a],l}function n(){r=new WeakMap}return{get:i,dispose:n}}var wie=class extends k_{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Kh,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},ICe=class extends k_{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new V,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},OCe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,jCe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function LCe(e,t,r){let i=new U6,n=new ge,s=new ge,a=new fr,o=new wie({depthPacking:aie}),l=new ICe,c={},u=r.maxTextureSize,d={[zc]:Ys,[Ys]:zc,[La]:La},f=new Jr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ge},radius:{value:4}},vertexShader:OCe,fragmentShader:jCe}),m=f.clone();m.defines.HORIZONTAL_PASS=1;let v=new Lt;v.setAttribute("position",new Jt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let y=new Yi(v,f),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=j6,this.render=function(P,M,C){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||P.length===0)return;let T=e.getRenderTarget(),E=e.getActiveCubeFace(),N=e.getActiveMipmapLevel(),D=e.state;D.setBlending(cs),D.buffers.color.setClear(1,1,1,1),D.buffers.depth.setTest(!0),D.setScissorTest(!1);for(let I=0,j=P.length;I<j;I++){let L=P[I],B=L.shadow;if(B===void 0){console.warn("THREE.WebGLShadowMap:",L,"has no shadow.");continue}if(B.autoUpdate===!1&&B.needsUpdate===!1)continue;n.copy(B.mapSize);let q=B.getFrameExtents();if(n.multiply(q),s.copy(B.mapSize),(n.x>u||n.y>u)&&(n.x>u&&(s.x=Math.floor(u/q.x),n.x=s.x*q.x,B.mapSize.x=s.x),n.y>u&&(s.y=Math.floor(u/q.y),n.y=s.y*q.y,B.mapSize.y=s.y)),B.map===null){let Y=this.type!==vw?{minFilter:jr,magFilter:jr}:{};B.map=new Zr(n.x,n.y,Y),B.map.texture.name=L.name+".shadowMap",B.camera.updateProjectionMatrix()}e.setRenderTarget(B.map),e.clear();let G=B.getViewportCount();for(let Y=0;Y<G;Y++){let X=B.getViewport(Y);a.set(s.x*X.x,s.y*X.y,s.x*X.z,s.y*X.w),D.viewport(a),B.updateMatrices(L,Y),i=B.getFrustum(),S(M,C,B.camera,L,this.type)}B.isPointLightShadow!==!0&&this.type===vw&&w(B,C),B.needsUpdate=!1}x.needsUpdate=!1,e.setRenderTarget(T,E,N)};function w(P,M){let C=t.update(y);f.defines.VSM_SAMPLES!==P.blurSamples&&(f.defines.VSM_SAMPLES=P.blurSamples,m.defines.VSM_SAMPLES=P.blurSamples,f.needsUpdate=!0,m.needsUpdate=!0),P.mapPass===null&&(P.mapPass=new Zr(n.x,n.y)),f.uniforms.shadow_pass.value=P.map.texture,f.uniforms.resolution.value=P.mapSize,f.uniforms.radius.value=P.radius,e.setRenderTarget(P.mapPass),e.clear(),e.renderBufferDirect(M,null,C,f,y,null),m.uniforms.shadow_pass.value=P.mapPass.texture,m.uniforms.resolution.value=P.mapSize,m.uniforms.radius.value=P.radius,e.setRenderTarget(P.map),e.clear(),e.renderBufferDirect(M,null,C,m,y,null)}function _(P,M,C,T,E,N){let D=null,I=C.isPointLight===!0?P.customDistanceMaterial:P.customDepthMaterial;if(I!==void 0)D=I;else if(D=C.isPointLight===!0?l:o,e.localClippingEnabled&&M.clipShadows===!0&&Array.isArray(M.clippingPlanes)&&M.clippingPlanes.length!==0||M.displacementMap&&M.displacementScale!==0||M.alphaMap&&M.alphaTest>0||M.map&&M.alphaTest>0){let j=D.uuid,L=M.uuid,B=c[j];B===void 0&&(B={},c[j]=B);let q=B[L];q===void 0&&(q=D.clone(),B[L]=q),D=q}return D.visible=M.visible,D.wireframe=M.wireframe,N===vw?D.side=M.shadowSide!==null?M.shadowSide:M.side:D.side=M.shadowSide!==null?M.shadowSide:d[M.side],D.alphaMap=M.alphaMap,D.alphaTest=M.alphaTest,D.map=M.map,D.clipShadows=M.clipShadows,D.clippingPlanes=M.clippingPlanes,D.clipIntersection=M.clipIntersection,D.displacementMap=M.displacementMap,D.displacementScale=M.displacementScale,D.displacementBias=M.displacementBias,D.wireframeLinewidth=M.wireframeLinewidth,D.linewidth=M.linewidth,C.isPointLight===!0&&D.isMeshDistanceMaterial===!0&&(D.referencePosition.setFromMatrixPosition(C.matrixWorld),D.nearDistance=T,D.farDistance=E),D}function S(P,M,C,T,E){if(P.visible===!1)return;if(P.layers.test(M.layers)&&(P.isMesh||P.isLine||P.isPoints)&&(P.castShadow||P.receiveShadow&&E===vw)&&(!P.frustumCulled||i.intersectsObject(P))){P.modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,P.matrixWorld);let D=t.update(P),I=P.material;if(Array.isArray(I)){let j=D.groups;for(let L=0,B=j.length;L<B;L++){let q=j[L],G=I[q.materialIndex];if(G&&G.visible){let Y=_(P,G,T,C.near,C.far,E);e.renderBufferDirect(C,null,D,Y,P,q)}}}else if(I.visible){let j=_(P,I,T,C.near,C.far,E);e.renderBufferDirect(C,null,D,j,P,null)}}let N=P.children;for(let D=0,I=N.length;D<I;D++)S(N[D],M,C,T,E)}}function zCe(e,t,r){let i=r.isWebGL2;function n(){let ye=!1,He=new fr,tt=null,xt=new fr(0,0,0,0);return{setMask:function(Wt){tt!==Wt&&!ye&&(e.colorMask(Wt,Wt,Wt,Wt),tt=Wt)},setLocked:function(Wt){ye=Wt},setClear:function(Wt,gr,Ui,Hi,Js){Js===!0&&(Wt*=Hi,gr*=Hi,Ui*=Hi),He.set(Wt,gr,Ui,Hi),xt.equals(He)===!1&&(e.clearColor(Wt,gr,Ui,Hi),xt.copy(He))},reset:function(){ye=!1,tt=null,xt.set(-1,0,0,0)}}}function s(){let ye=!1,He=null,tt=null,xt=null;return{setTest:function(Wt){Wt?ae(2929):Z(2929)},setMask:function(Wt){He!==Wt&&!ye&&(e.depthMask(Wt),He=Wt)},setFunc:function(Wt){if(tt!==Wt){switch(Wt){case s2e:e.depthFunc(512);break;case a2e:e.depthFunc(519);break;case o2e:e.depthFunc(513);break;case Aj:e.depthFunc(515);break;case l2e:e.depthFunc(514);break;case c2e:e.depthFunc(518);break;case u2e:e.depthFunc(516);break;case d2e:e.depthFunc(517);break;default:e.depthFunc(515)}tt=Wt}},setLocked:function(Wt){ye=Wt},setClear:function(Wt){xt!==Wt&&(e.clearDepth(Wt),xt=Wt)},reset:function(){ye=!1,He=null,tt=null,xt=null}}}function a(){let ye=!1,He=null,tt=null,xt=null,Wt=null,gr=null,Ui=null,Hi=null,Js=null;return{setTest:function(ei){ye||(ei?ae(2960):Z(2960))},setMask:function(ei){He!==ei&&!ye&&(e.stencilMask(ei),He=ei)},setFunc:function(ei,Sa,zr){(tt!==ei||xt!==Sa||Wt!==zr)&&(e.stencilFunc(ei,Sa,zr),tt=ei,xt=Sa,Wt=zr)},setOp:function(ei,Sa,zr){(gr!==ei||Ui!==Sa||Hi!==zr)&&(e.stencilOp(ei,Sa,zr),gr=ei,Ui=Sa,Hi=zr)},setLocked:function(ei){ye=ei},setClear:function(ei){Js!==ei&&(e.clearStencil(ei),Js=ei)},reset:function(){ye=!1,He=null,tt=null,xt=null,Wt=null,gr=null,Ui=null,Hi=null,Js=null}}}let o=new n,l=new s,c=new a,u=new WeakMap,d=new WeakMap,f={},m={},v=new WeakMap,y=[],x=null,w=!1,_=null,S=null,P=null,M=null,C=null,T=null,E=null,N=!1,D=null,I=null,j=null,L=null,B=null,q=e.getParameter(35661),G=!1,Y=0,X=e.getParameter(7938);X.indexOf("WebGL")!==-1?(Y=parseFloat(/^WebGL (\d)/.exec(X)[1]),G=Y>=1):X.indexOf("OpenGL ES")!==-1&&(Y=parseFloat(/^OpenGL ES (\d)/.exec(X)[1]),G=Y>=2);let re=null,F={},$=e.getParameter(3088),se=e.getParameter(2978),H=new fr().fromArray($),ne=new fr().fromArray(se);function ce(ye,He,tt){let xt=new Uint8Array(4),Wt=e.createTexture();e.bindTexture(ye,Wt),e.texParameteri(ye,10241,9728),e.texParameteri(ye,10240,9728);for(let gr=0;gr<tt;gr++)e.texImage2D(He+gr,0,6408,1,1,0,6408,5121,xt);return Wt}let ie={};ie[3553]=ce(3553,3553,1),ie[34067]=ce(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ae(2929),l.setFunc(Aj),mt(!1),dt(YH),ae(2884),Be(cs);function ae(ye){f[ye]!==!0&&(e.enable(ye),f[ye]=!0)}function Z(ye){f[ye]!==!1&&(e.disable(ye),f[ye]=!1)}function fe(ye,He){return m[ye]!==He?(e.bindFramebuffer(ye,He),m[ye]=He,i&&(ye===36009&&(m[36160]=He),ye===36160&&(m[36009]=He)),!0):!1}function he(ye,He){let tt=y,xt=!1;if(ye)if(tt=v.get(He),tt===void 0&&(tt=[],v.set(He,tt)),ye.isWebGLMultipleRenderTargets){let Wt=ye.texture;if(tt.length!==Wt.length||tt[0]!==36064){for(let gr=0,Ui=Wt.length;gr<Ui;gr++)tt[gr]=36064+gr;tt.length=Wt.length,xt=!0}}else tt[0]!==36064&&(tt[0]=36064,xt=!0);else tt[0]!==1029&&(tt[0]=1029,xt=!0);xt&&(r.isWebGL2?e.drawBuffers(tt):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(tt))}function Ae(ye){return x!==ye?(e.useProgram(ye),x=ye,!0):!1}let xe={[Jv]:32774,[Xwe]:32778,[$we]:32779};if(i)xe[QH]=32775,xe[ZH]=32776;else{let ye=t.get("EXT_blend_minmax");ye!==null&&(xe[QH]=ye.MIN_EXT,xe[ZH]=ye.MAX_EXT)}let Ee={[Kwe]:0,[Qwe]:1,[Zwe]:768,[Zre]:770,[n2e]:776,[r2e]:774,[e2e]:772,[Jwe]:769,[Jre]:771,[i2e]:775,[t2e]:773};function Be(ye,He,tt,xt,Wt,gr,Ui,Hi){if(ye===cs){w===!0&&(Z(3042),w=!1);return}if(w===!1&&(ae(3042),w=!0),ye!==Ywe){if(ye!==_||Hi!==N){if((S!==Jv||C!==Jv)&&(e.blendEquation(32774),S=Jv,C=Jv),Hi)switch(ye){case Ag:e.blendFuncSeparate(1,771,1,771);break;case XH:e.blendFunc(1,1);break;case $H:e.blendFuncSeparate(0,769,0,1);break;case KH:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}else switch(ye){case Ag:e.blendFuncSeparate(770,771,1,771);break;case XH:e.blendFunc(770,1);break;case $H:e.blendFuncSeparate(0,769,0,1);break;case KH:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}P=null,M=null,T=null,E=null,_=ye,N=Hi}return}Wt=Wt||He,gr=gr||tt,Ui=Ui||xt,(He!==S||Wt!==C)&&(e.blendEquationSeparate(xe[He],xe[Wt]),S=He,C=Wt),(tt!==P||xt!==M||gr!==T||Ui!==E)&&(e.blendFuncSeparate(Ee[tt],Ee[xt],Ee[gr],Ee[Ui]),P=tt,M=xt,T=gr,E=Ui),_=ye,N=!1}function $e(ye,He){ye.side===La?Z(2884):ae(2884);let tt=ye.side===Ys;He&&(tt=!tt),mt(tt),ye.blending===Ag&&ye.transparent===!1?Be(cs):Be(ye.blending,ye.blendEquation,ye.blendSrc,ye.blendDst,ye.blendEquationAlpha,ye.blendSrcAlpha,ye.blendDstAlpha,ye.premultipliedAlpha),l.setFunc(ye.depthFunc),l.setTest(ye.depthTest),l.setMask(ye.depthWrite),o.setMask(ye.colorWrite);let xt=ye.stencilWrite;c.setTest(xt),xt&&(c.setMask(ye.stencilWriteMask),c.setFunc(ye.stencilFunc,ye.stencilRef,ye.stencilFuncMask),c.setOp(ye.stencilFail,ye.stencilZFail,ye.stencilZPass)),ut(ye.polygonOffset,ye.polygonOffsetFactor,ye.polygonOffsetUnits),ye.alphaToCoverage===!0?ae(32926):Z(32926)}function mt(ye){D!==ye&&(ye?e.frontFace(2304):e.frontFace(2305),D=ye)}function dt(ye){ye!==Gwe?(ae(2884),ye!==I&&(ye===YH?e.cullFace(1029):ye===Wwe?e.cullFace(1028):e.cullFace(1032))):Z(2884),I=ye}function ct(ye){ye!==j&&(G&&e.lineWidth(ye),j=ye)}function ut(ye,He,tt){ye?(ae(32823),(L!==He||B!==tt)&&(e.polygonOffset(He,tt),L=He,B=tt)):Z(32823)}function me(ye){ye?ae(3089):Z(3089)}function _e(ye){ye===void 0&&(ye=33984+q-1),re!==ye&&(e.activeTexture(ye),re=ye)}function te(ye,He,tt){tt===void 0&&(re===null?tt=33984+q-1:tt=re);let xt=F[tt];xt===void 0&&(xt={type:void 0,texture:void 0},F[tt]=xt),(xt.type!==ye||xt.texture!==He)&&(re!==tt&&(e.activeTexture(tt),re=tt),e.bindTexture(ye,He||ie[ye]),xt.type=ye,xt.texture=He)}function J(){let ye=F[re];ye!==void 0&&ye.type!==void 0&&(e.bindTexture(ye.type,null),ye.type=void 0,ye.texture=void 0)}function ve(){try{e.compressedTexImage2D.apply(e,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Me(){try{e.compressedTexImage3D.apply(e,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function W(){try{e.texSubImage2D.apply(e,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Se(){try{e.texSubImage3D.apply(e,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function ze(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Ue(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Ne(){try{e.texStorage2D.apply(e,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function De(){try{e.texStorage3D.apply(e,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function We(){try{e.texImage2D.apply(e,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Je(){try{e.texImage3D.apply(e,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function et(ye){H.equals(ye)===!1&&(e.scissor(ye.x,ye.y,ye.z,ye.w),H.copy(ye))}function qe(ye){ne.equals(ye)===!1&&(e.viewport(ye.x,ye.y,ye.z,ye.w),ne.copy(ye))}function ft(ye,He){let tt=d.get(He);tt===void 0&&(tt=new WeakMap,d.set(He,tt));let xt=tt.get(ye);xt===void 0&&(xt=e.getUniformBlockIndex(He,ye.name),tt.set(ye,xt))}function kt(ye,He){let tt=d.get(He).get(ye);u.get(He)!==tt&&(e.uniformBlockBinding(He,tt,ye.__bindingPointIndex),u.set(He,tt))}function Mt(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),i===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),f={},re=null,F={},m={},v=new WeakMap,y=[],x=null,w=!1,_=null,S=null,P=null,M=null,C=null,T=null,E=null,N=!1,D=null,I=null,j=null,L=null,B=null,H.set(0,0,e.canvas.width,e.canvas.height),ne.set(0,0,e.canvas.width,e.canvas.height),o.reset(),l.reset(),c.reset()}return{buffers:{color:o,depth:l,stencil:c},enable:ae,disable:Z,bindFramebuffer:fe,drawBuffers:he,useProgram:Ae,setBlending:Be,setMaterial:$e,setFlipSided:mt,setCullFace:dt,setLineWidth:ct,setPolygonOffset:ut,setScissorTest:me,activeTexture:_e,bindTexture:te,unbindTexture:J,compressedTexImage2D:ve,compressedTexImage3D:Me,texImage2D:We,texImage3D:Je,updateUBOMapping:ft,uniformBlockBinding:kt,texStorage2D:Ne,texStorage3D:De,texSubImage2D:W,texSubImage3D:Se,compressedTexSubImage2D:ze,compressedTexSubImage3D:Ue,scissor:et,viewport:qe,reset:Mt}}function BCe(e,t,r,i,n,s,a){let o=n.isWebGL2,l=n.maxTextures,c=n.maxCubemapSize,u=n.maxTextureSize,d=n.maxSamples,f=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,m=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),v=new WeakMap,y,x=new WeakMap,w=!1;try{w=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(te,J){return w?new OffscreenCanvas(te,J):M2("canvas")}function S(te,J,ve,Me){let W=1;if((te.width>Me||te.height>Me)&&(W=Me/Math.max(te.width,te.height)),W<1||J===!0)if(typeof HTMLImageElement<"u"&&te instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&te instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&te instanceof ImageBitmap){let Se=J?aM:Math.floor,ze=Se(W*te.width),Ue=Se(W*te.height);y===void 0&&(y=_(ze,Ue));let Ne=ve?_(ze,Ue):y;return Ne.width=ze,Ne.height=Ue,Ne.getContext("2d").drawImage(te,0,0,ze,Ue),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+te.width+"x"+te.height+") to ("+ze+"x"+Ue+")."),Ne}else return"data"in te&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+te.width+"x"+te.height+")."),te;return te}function P(te){return kj(te.width)&&kj(te.height)}function M(te){return o?!1:te.wrapS!==an||te.wrapT!==an||te.minFilter!==jr&&te.minFilter!==Pr}function C(te,J){return te.generateMipmaps&&J&&te.minFilter!==jr&&te.minFilter!==Pr}function T(te){e.generateMipmap(te)}function E(te,J,ve,Me,W=!1){if(o===!1)return J;if(te!==null){if(e[te]!==void 0)return e[te];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+te+"'")}let Se=J;return J===6403&&(ve===5126&&(Se=33326),ve===5131&&(Se=33325),ve===5121&&(Se=33321)),J===33319&&(ve===5126&&(Se=33328),ve===5131&&(Se=33327),ve===5121&&(Se=33323)),J===6408&&(ve===5126&&(Se=34836),ve===5131&&(Se=34842),ve===5121&&(Se=Me===Ar&&W===!1?35907:32856),ve===32819&&(Se=32854),ve===32820&&(Se=32855)),(Se===33325||Se===33326||Se===33327||Se===33328||Se===34842||Se===34836)&&t.get("EXT_color_buffer_float"),Se}function N(te,J,ve){return C(te,ve)===!0||te.isFramebufferTexture&&te.minFilter!==jr&&te.minFilter!==Pr?Math.log2(Math.max(J.width,J.height))+1:te.mipmaps!==void 0&&te.mipmaps.length>0?te.mipmaps.length:te.isCompressedTexture&&Array.isArray(te.image)?J.mipmaps.length:1}function D(te){return te===jr||te===JH||te===CR?9728:9729}function I(te){let J=te.target;J.removeEventListener("dispose",I),L(J),J.isVideoTexture&&v.delete(J)}function j(te){let J=te.target;J.removeEventListener("dispose",j),q(J)}function L(te){let J=i.get(te);if(J.__webglInit===void 0)return;let ve=te.source,Me=x.get(ve);if(Me){let W=Me[J.__cacheKey];W.usedTimes--,W.usedTimes===0&&B(te),Object.keys(Me).length===0&&x.delete(ve)}i.remove(te)}function B(te){let J=i.get(te);e.deleteTexture(J.__webglTexture);let ve=te.source,Me=x.get(ve);delete Me[J.__cacheKey],a.memory.textures--}function q(te){let J=te.texture,ve=i.get(te),Me=i.get(J);if(Me.__webglTexture!==void 0&&(e.deleteTexture(Me.__webglTexture),a.memory.textures--),te.depthTexture&&te.depthTexture.dispose(),te.isWebGLCubeRenderTarget)for(let W=0;W<6;W++)e.deleteFramebuffer(ve.__webglFramebuffer[W]),ve.__webglDepthbuffer&&e.deleteRenderbuffer(ve.__webglDepthbuffer[W]);else{if(e.deleteFramebuffer(ve.__webglFramebuffer),ve.__webglDepthbuffer&&e.deleteRenderbuffer(ve.__webglDepthbuffer),ve.__webglMultisampledFramebuffer&&e.deleteFramebuffer(ve.__webglMultisampledFramebuffer),ve.__webglColorRenderbuffer)for(let W=0;W<ve.__webglColorRenderbuffer.length;W++)ve.__webglColorRenderbuffer[W]&&e.deleteRenderbuffer(ve.__webglColorRenderbuffer[W]);ve.__webglDepthRenderbuffer&&e.deleteRenderbuffer(ve.__webglDepthRenderbuffer)}if(te.isWebGLMultipleRenderTargets)for(let W=0,Se=J.length;W<Se;W++){let ze=i.get(J[W]);ze.__webglTexture&&(e.deleteTexture(ze.__webglTexture),a.memory.textures--),i.remove(J[W])}i.remove(J),i.remove(te)}let G=0;function Y(){G=0}function X(){let te=G;return te>=l&&console.warn("THREE.WebGLTextures: Trying to use "+te+" texture units while this GPU supports only "+l),G+=1,te}function re(te){let J=[];return J.push(te.wrapS),J.push(te.wrapT),J.push(te.wrapR||0),J.push(te.magFilter),J.push(te.minFilter),J.push(te.anisotropy),J.push(te.internalFormat),J.push(te.format),J.push(te.type),J.push(te.generateMipmaps),J.push(te.premultiplyAlpha),J.push(te.flipY),J.push(te.unpackAlignment),J.push(te.encoding),J.join()}function F(te,J){let ve=i.get(te);if(te.isVideoTexture&&me(te),te.isRenderTargetTexture===!1&&te.version>0&&ve.__version!==te.version){let Me=te.image;if(Me===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Me.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Z(ve,te,J);return}}r.bindTexture(3553,ve.__webglTexture,33984+J)}function $(te,J){let ve=i.get(te);if(te.version>0&&ve.__version!==te.version){Z(ve,te,J);return}r.bindTexture(35866,ve.__webglTexture,33984+J)}function se(te,J){let ve=i.get(te);if(te.version>0&&ve.__version!==te.version){Z(ve,te,J);return}r.bindTexture(32879,ve.__webglTexture,33984+J)}function H(te,J){let ve=i.get(te);if(te.version>0&&ve.__version!==te.version){fe(ve,te,J);return}r.bindTexture(34067,ve.__webglTexture,33984+J)}let ne={[fh]:10497,[an]:33071,[Mj]:33648},ce={[jr]:9728,[JH]:9984,[CR]:9986,[Pr]:9729,[x2e]:9985,[nx]:9987};function ie(te,J,ve){if(ve?(e.texParameteri(te,10242,ne[J.wrapS]),e.texParameteri(te,10243,ne[J.wrapT]),(te===32879||te===35866)&&e.texParameteri(te,32882,ne[J.wrapR]),e.texParameteri(te,10240,ce[J.magFilter]),e.texParameteri(te,10241,ce[J.minFilter])):(e.texParameteri(te,10242,33071),e.texParameteri(te,10243,33071),(te===32879||te===35866)&&e.texParameteri(te,32882,33071),(J.wrapS!==an||J.wrapT!==an)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(te,10240,D(J.magFilter)),e.texParameteri(te,10241,D(J.minFilter)),J.minFilter!==jr&&J.minFilter!==Pr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let Me=t.get("EXT_texture_filter_anisotropic");if(J.magFilter===jr||J.minFilter!==CR&&J.minFilter!==nx||J.type===Ni&&t.has("OES_texture_float_linear")===!1||o===!1&&J.type===Rh&&t.has("OES_texture_half_float_linear")===!1)return;(J.anisotropy>1||i.get(J).__currentAnisotropy)&&(e.texParameterf(te,Me.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(J.anisotropy,n.getMaxAnisotropy())),i.get(J).__currentAnisotropy=J.anisotropy)}}function ae(te,J){let ve=!1;te.__webglInit===void 0&&(te.__webglInit=!0,J.addEventListener("dispose",I));let Me=J.source,W=x.get(Me);W===void 0&&(W={},x.set(Me,W));let Se=re(J);if(Se!==te.__cacheKey){W[Se]===void 0&&(W[Se]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,ve=!0),W[Se].usedTimes++;let ze=W[te.__cacheKey];ze!==void 0&&(W[te.__cacheKey].usedTimes--,ze.usedTimes===0&&B(J)),te.__cacheKey=Se,te.__webglTexture=W[Se].texture}return ve}function Z(te,J,ve){let Me=3553;(J.isDataArrayTexture||J.isCompressedArrayTexture)&&(Me=35866),J.isData3DTexture&&(Me=32879);let W=ae(te,J),Se=J.source;r.bindTexture(Me,te.__webglTexture,33984+ve);let ze=i.get(Se);if(Se.version!==ze.__version||W===!0){r.activeTexture(33984+ve),e.pixelStorei(37440,J.flipY),e.pixelStorei(37441,J.premultiplyAlpha),e.pixelStorei(3317,J.unpackAlignment),e.pixelStorei(37443,0);let Ue=M(J)&&P(J.image)===!1,Ne=S(J.image,Ue,!1,u);Ne=_e(J,Ne);let De=P(Ne)||o,We=s.convert(J.format,J.encoding),Je=s.convert(J.type),et=E(J.internalFormat,We,Je,J.encoding,J.isVideoTexture);ie(Me,J,De);let qe,ft=J.mipmaps,kt=o&&J.isVideoTexture!==!0,Mt=ze.__version===void 0||W===!0,ye=N(J,Ne,De);if(J.isDepthTexture)et=6402,o?J.type===Ni?et=36012:J.type===ph?et=33190:J.type===Cg?et=35056:et=33189:J.type===Ni&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),J.format===Tg&&et===6402&&J.type!==rie&&J.type!==ph&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),J.type=ph,Je=s.convert(J.type)),J.format===Gg&&et===6402&&(et=34041,J.type!==Cg&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),J.type=Cg,Je=s.convert(J.type))),Mt&&(kt?r.texStorage2D(3553,1,et,Ne.width,Ne.height):r.texImage2D(3553,0,et,Ne.width,Ne.height,0,We,Je,null));else if(J.isDataTexture)if(ft.length>0&&De){kt&&Mt&&r.texStorage2D(3553,ye,et,ft[0].width,ft[0].height);for(let He=0,tt=ft.length;He<tt;He++)qe=ft[He],kt?r.texSubImage2D(3553,He,0,0,qe.width,qe.height,We,Je,qe.data):r.texImage2D(3553,He,et,qe.width,qe.height,0,We,Je,qe.data);J.generateMipmaps=!1}else kt?(Mt&&r.texStorage2D(3553,ye,et,Ne.width,Ne.height),r.texSubImage2D(3553,0,0,0,Ne.width,Ne.height,We,Je,Ne.data)):r.texImage2D(3553,0,et,Ne.width,Ne.height,0,We,Je,Ne.data);else if(J.isCompressedTexture)if(J.isCompressedArrayTexture){kt&&Mt&&r.texStorage3D(35866,ye,et,ft[0].width,ft[0].height,Ne.depth);for(let He=0,tt=ft.length;He<tt;He++)qe=ft[He],J.format!==dn?We!==null?kt?r.compressedTexSubImage3D(35866,He,0,0,0,qe.width,qe.height,Ne.depth,We,qe.data,0,0):r.compressedTexImage3D(35866,He,et,qe.width,qe.height,Ne.depth,0,qe.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kt?r.texSubImage3D(35866,He,0,0,0,qe.width,qe.height,Ne.depth,We,Je,qe.data):r.texImage3D(35866,He,et,qe.width,qe.height,Ne.depth,0,We,Je,qe.data)}else{kt&&Mt&&r.texStorage2D(3553,ye,et,ft[0].width,ft[0].height);for(let He=0,tt=ft.length;He<tt;He++)qe=ft[He],J.format!==dn?We!==null?kt?r.compressedTexSubImage2D(3553,He,0,0,qe.width,qe.height,We,qe.data):r.compressedTexImage2D(3553,He,et,qe.width,qe.height,0,qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):kt?r.texSubImage2D(3553,He,0,0,qe.width,qe.height,We,Je,qe.data):r.texImage2D(3553,He,et,qe.width,qe.height,0,We,Je,qe.data)}else if(J.isDataArrayTexture)kt?(Mt&&r.texStorage3D(35866,ye,et,Ne.width,Ne.height,Ne.depth),r.texSubImage3D(35866,0,0,0,0,Ne.width,Ne.height,Ne.depth,We,Je,Ne.data)):r.texImage3D(35866,0,et,Ne.width,Ne.height,Ne.depth,0,We,Je,Ne.data);else if(J.isData3DTexture)kt?(Mt&&r.texStorage3D(32879,ye,et,Ne.width,Ne.height,Ne.depth),r.texSubImage3D(32879,0,0,0,0,Ne.width,Ne.height,Ne.depth,We,Je,Ne.data)):r.texImage3D(32879,0,et,Ne.width,Ne.height,Ne.depth,0,We,Je,Ne.data);else if(J.isFramebufferTexture){if(Mt)if(kt)r.texStorage2D(3553,ye,et,Ne.width,Ne.height);else{let He=Ne.width,tt=Ne.height;for(let xt=0;xt<ye;xt++)r.texImage2D(3553,xt,et,He,tt,0,We,Je,null),He>>=1,tt>>=1}}else if(ft.length>0&&De){kt&&Mt&&r.texStorage2D(3553,ye,et,ft[0].width,ft[0].height);for(let He=0,tt=ft.length;He<tt;He++)qe=ft[He],kt?r.texSubImage2D(3553,He,0,0,We,Je,qe):r.texImage2D(3553,He,et,We,Je,qe);J.generateMipmaps=!1}else kt?(Mt&&r.texStorage2D(3553,ye,et,Ne.width,Ne.height),r.texSubImage2D(3553,0,0,0,We,Je,Ne)):r.texImage2D(3553,0,et,We,Je,Ne);C(J,De)&&T(Me),ze.__version=Se.version,J.onUpdate&&J.onUpdate(J)}te.__version=J.version}function fe(te,J,ve){if(J.image.length!==6)return;let Me=ae(te,J),W=J.source;r.bindTexture(34067,te.__webglTexture,33984+ve);let Se=i.get(W);if(W.version!==Se.__version||Me===!0){r.activeTexture(33984+ve),e.pixelStorei(37440,J.flipY),e.pixelStorei(37441,J.premultiplyAlpha),e.pixelStorei(3317,J.unpackAlignment),e.pixelStorei(37443,0);let ze=J.isCompressedTexture||J.image[0].isCompressedTexture,Ue=J.image[0]&&J.image[0].isDataTexture,Ne=[];for(let He=0;He<6;He++)!ze&&!Ue?Ne[He]=S(J.image[He],!1,!0,c):Ne[He]=Ue?J.image[He].image:J.image[He],Ne[He]=_e(J,Ne[He]);let De=Ne[0],We=P(De)||o,Je=s.convert(J.format,J.encoding),et=s.convert(J.type),qe=E(J.internalFormat,Je,et,J.encoding),ft=o&&J.isVideoTexture!==!0,kt=Se.__version===void 0||Me===!0,Mt=N(J,De,We);ie(34067,J,We);let ye;if(ze){ft&&kt&&r.texStorage2D(34067,Mt,qe,De.width,De.height);for(let He=0;He<6;He++){ye=Ne[He].mipmaps;for(let tt=0;tt<ye.length;tt++){let xt=ye[tt];J.format!==dn?Je!==null?ft?r.compressedTexSubImage2D(34069+He,tt,0,0,xt.width,xt.height,Je,xt.data):r.compressedTexImage2D(34069+He,tt,qe,xt.width,xt.height,0,xt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ft?r.texSubImage2D(34069+He,tt,0,0,xt.width,xt.height,Je,et,xt.data):r.texImage2D(34069+He,tt,qe,xt.width,xt.height,0,Je,et,xt.data)}}}else{ye=J.mipmaps,ft&&kt&&(ye.length>0&&Mt++,r.texStorage2D(34067,Mt,qe,Ne[0].width,Ne[0].height));for(let He=0;He<6;He++)if(Ue){ft?r.texSubImage2D(34069+He,0,0,0,Ne[He].width,Ne[He].height,Je,et,Ne[He].data):r.texImage2D(34069+He,0,qe,Ne[He].width,Ne[He].height,0,Je,et,Ne[He].data);for(let tt=0;tt<ye.length;tt++){let xt=ye[tt].image[He].image;ft?r.texSubImage2D(34069+He,tt+1,0,0,xt.width,xt.height,Je,et,xt.data):r.texImage2D(34069+He,tt+1,qe,xt.width,xt.height,0,Je,et,xt.data)}}else{ft?r.texSubImage2D(34069+He,0,0,0,Je,et,Ne[He]):r.texImage2D(34069+He,0,qe,Je,et,Ne[He]);for(let tt=0;tt<ye.length;tt++){let xt=ye[tt];ft?r.texSubImage2D(34069+He,tt+1,0,0,Je,et,xt.image[He]):r.texImage2D(34069+He,tt+1,qe,Je,et,xt.image[He])}}}C(J,We)&&T(34067),Se.__version=W.version,J.onUpdate&&J.onUpdate(J)}te.__version=J.version}function he(te,J,ve,Me,W){let Se=s.convert(ve.format,ve.encoding),ze=s.convert(ve.type),Ue=E(ve.internalFormat,Se,ze,ve.encoding);i.get(J).__hasExternalTextures||(W===32879||W===35866?r.texImage3D(W,0,Ue,J.width,J.height,J.depth,0,Se,ze,null):r.texImage2D(W,0,Ue,J.width,J.height,0,Se,ze,null)),r.bindFramebuffer(36160,te),ut(J)?f.framebufferTexture2DMultisampleEXT(36160,Me,W,i.get(ve).__webglTexture,0,ct(J)):(W===3553||W>=34069&&W<=34074)&&e.framebufferTexture2D(36160,Me,W,i.get(ve).__webglTexture,0),r.bindFramebuffer(36160,null)}function Ae(te,J,ve){if(e.bindRenderbuffer(36161,te),J.depthBuffer&&!J.stencilBuffer){let Me=33189;if(ve||ut(J)){let W=J.depthTexture;W&&W.isDepthTexture&&(W.type===Ni?Me=36012:W.type===ph&&(Me=33190));let Se=ct(J);ut(J)?f.renderbufferStorageMultisampleEXT(36161,Se,Me,J.width,J.height):e.renderbufferStorageMultisample(36161,Se,Me,J.width,J.height)}else e.renderbufferStorage(36161,Me,J.width,J.height);e.framebufferRenderbuffer(36160,36096,36161,te)}else if(J.depthBuffer&&J.stencilBuffer){let Me=ct(J);ve&&ut(J)===!1?e.renderbufferStorageMultisample(36161,Me,35056,J.width,J.height):ut(J)?f.renderbufferStorageMultisampleEXT(36161,Me,35056,J.width,J.height):e.renderbufferStorage(36161,34041,J.width,J.height),e.framebufferRenderbuffer(36160,33306,36161,te)}else{let Me=J.isWebGLMultipleRenderTargets===!0?J.texture:[J.texture];for(let W=0;W<Me.length;W++){let Se=Me[W],ze=s.convert(Se.format,Se.encoding),Ue=s.convert(Se.type),Ne=E(Se.internalFormat,ze,Ue,Se.encoding),De=ct(J);ve&&ut(J)===!1?e.renderbufferStorageMultisample(36161,De,Ne,J.width,J.height):ut(J)?f.renderbufferStorageMultisampleEXT(36161,De,Ne,J.width,J.height):e.renderbufferStorage(36161,Ne,J.width,J.height)}}e.bindRenderbuffer(36161,null)}function xe(te,J){if(J&&J.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,te),!(J.depthTexture&&J.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(J.depthTexture).__webglTexture||J.depthTexture.image.width!==J.width||J.depthTexture.image.height!==J.height)&&(J.depthTexture.image.width=J.width,J.depthTexture.image.height=J.height,J.depthTexture.needsUpdate=!0),F(J.depthTexture,0);let ve=i.get(J.depthTexture).__webglTexture,Me=ct(J);if(J.depthTexture.format===Tg)ut(J)?f.framebufferTexture2DMultisampleEXT(36160,36096,3553,ve,0,Me):e.framebufferTexture2D(36160,36096,3553,ve,0);else if(J.depthTexture.format===Gg)ut(J)?f.framebufferTexture2DMultisampleEXT(36160,33306,3553,ve,0,Me):e.framebufferTexture2D(36160,33306,3553,ve,0);else throw new Error("Unknown depthTexture format")}function Ee(te){let J=i.get(te),ve=te.isWebGLCubeRenderTarget===!0;if(te.depthTexture&&!J.__autoAllocateDepthBuffer){if(ve)throw new Error("target.depthTexture not supported in Cube render targets");xe(J.__webglFramebuffer,te)}else if(ve){J.__webglDepthbuffer=[];for(let Me=0;Me<6;Me++)r.bindFramebuffer(36160,J.__webglFramebuffer[Me]),J.__webglDepthbuffer[Me]=e.createRenderbuffer(),Ae(J.__webglDepthbuffer[Me],te,!1)}else r.bindFramebuffer(36160,J.__webglFramebuffer),J.__webglDepthbuffer=e.createRenderbuffer(),Ae(J.__webglDepthbuffer,te,!1);r.bindFramebuffer(36160,null)}function Be(te,J,ve){let Me=i.get(te);J!==void 0&&he(Me.__webglFramebuffer,te,te.texture,36064,3553),ve!==void 0&&Ee(te)}function $e(te){let J=te.texture,ve=i.get(te),Me=i.get(J);te.addEventListener("dispose",j),te.isWebGLMultipleRenderTargets!==!0&&(Me.__webglTexture===void 0&&(Me.__webglTexture=e.createTexture()),Me.__version=J.version,a.memory.textures++);let W=te.isWebGLCubeRenderTarget===!0,Se=te.isWebGLMultipleRenderTargets===!0,ze=P(te)||o;if(W){ve.__webglFramebuffer=[];for(let Ue=0;Ue<6;Ue++)ve.__webglFramebuffer[Ue]=e.createFramebuffer()}else{if(ve.__webglFramebuffer=e.createFramebuffer(),Se)if(n.drawBuffers){let Ue=te.texture;for(let Ne=0,De=Ue.length;Ne<De;Ne++){let We=i.get(Ue[Ne]);We.__webglTexture===void 0&&(We.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&te.samples>0&&ut(te)===!1){let Ue=Se?J:[J];ve.__webglMultisampledFramebuffer=e.createFramebuffer(),ve.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,ve.__webglMultisampledFramebuffer);for(let Ne=0;Ne<Ue.length;Ne++){let De=Ue[Ne];ve.__webglColorRenderbuffer[Ne]=e.createRenderbuffer(),e.bindRenderbuffer(36161,ve.__webglColorRenderbuffer[Ne]);let We=s.convert(De.format,De.encoding),Je=s.convert(De.type),et=E(De.internalFormat,We,Je,De.encoding,te.isXRRenderTarget===!0),qe=ct(te);e.renderbufferStorageMultisample(36161,qe,et,te.width,te.height),e.framebufferRenderbuffer(36160,36064+Ne,36161,ve.__webglColorRenderbuffer[Ne])}e.bindRenderbuffer(36161,null),te.depthBuffer&&(ve.__webglDepthRenderbuffer=e.createRenderbuffer(),Ae(ve.__webglDepthRenderbuffer,te,!0)),r.bindFramebuffer(36160,null)}}if(W){r.bindTexture(34067,Me.__webglTexture),ie(34067,J,ze);for(let Ue=0;Ue<6;Ue++)he(ve.__webglFramebuffer[Ue],te,J,36064,34069+Ue);C(J,ze)&&T(34067),r.unbindTexture()}else if(Se){let Ue=te.texture;for(let Ne=0,De=Ue.length;Ne<De;Ne++){let We=Ue[Ne],Je=i.get(We);r.bindTexture(3553,Je.__webglTexture),ie(3553,We,ze),he(ve.__webglFramebuffer,te,We,36064+Ne,3553),C(We,ze)&&T(3553)}r.unbindTexture()}else{let Ue=3553;(te.isWebGL3DRenderTarget||te.isWebGLArrayRenderTarget)&&(o?Ue=te.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(Ue,Me.__webglTexture),ie(Ue,J,ze),he(ve.__webglFramebuffer,te,J,36064,Ue),C(J,ze)&&T(Ue),r.unbindTexture()}te.depthBuffer&&Ee(te)}function mt(te){let J=P(te)||o,ve=te.isWebGLMultipleRenderTargets===!0?te.texture:[te.texture];for(let Me=0,W=ve.length;Me<W;Me++){let Se=ve[Me];if(C(Se,J)){let ze=te.isWebGLCubeRenderTarget?34067:3553,Ue=i.get(Se).__webglTexture;r.bindTexture(ze,Ue),T(ze),r.unbindTexture()}}}function dt(te){if(o&&te.samples>0&&ut(te)===!1){let J=te.isWebGLMultipleRenderTargets?te.texture:[te.texture],ve=te.width,Me=te.height,W=16384,Se=[],ze=te.stencilBuffer?33306:36096,Ue=i.get(te),Ne=te.isWebGLMultipleRenderTargets===!0;if(Ne)for(let De=0;De<J.length;De++)r.bindFramebuffer(36160,Ue.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+De,36161,null),r.bindFramebuffer(36160,Ue.__webglFramebuffer),e.framebufferTexture2D(36009,36064+De,3553,null,0);r.bindFramebuffer(36008,Ue.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,Ue.__webglFramebuffer);for(let De=0;De<J.length;De++){Se.push(36064+De),te.depthBuffer&&Se.push(ze);let We=Ue.__ignoreDepthValues!==void 0?Ue.__ignoreDepthValues:!1;if(We===!1&&(te.depthBuffer&&(W|=256),te.stencilBuffer&&(W|=1024)),Ne&&e.framebufferRenderbuffer(36008,36064,36161,Ue.__webglColorRenderbuffer[De]),We===!0&&(e.invalidateFramebuffer(36008,[ze]),e.invalidateFramebuffer(36009,[ze])),Ne){let Je=i.get(J[De]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,Je,0)}e.blitFramebuffer(0,0,ve,Me,0,0,ve,Me,W,9728),m&&e.invalidateFramebuffer(36008,Se)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),Ne)for(let De=0;De<J.length;De++){r.bindFramebuffer(36160,Ue.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+De,36161,Ue.__webglColorRenderbuffer[De]);let We=i.get(J[De]).__webglTexture;r.bindFramebuffer(36160,Ue.__webglFramebuffer),e.framebufferTexture2D(36009,36064+De,3553,We,0)}r.bindFramebuffer(36009,Ue.__webglMultisampledFramebuffer)}}function ct(te){return Math.min(d,te.samples)}function ut(te){let J=i.get(te);return o&&te.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&J.__useRenderToTexture!==!1}function me(te){let J=a.render.frame;v.get(te)!==J&&(v.set(te,J),te.update())}function _e(te,J){let ve=te.encoding,Me=te.format,W=te.type;return te.isCompressedTexture===!0||te.isVideoTexture===!0||te.format===Nj||ve!==Bc&&(ve===Ar?o===!1?t.has("EXT_sRGB")===!0&&Me===dn?(te.format=Nj,te.minFilter=Pr,te.generateMipmaps=!1):J=uie.sRGBToLinear(J):(Me!==dn||W!==Fa)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ve)),J}this.allocateTextureUnit=X,this.resetTextureUnits=Y,this.setTexture2D=F,this.setTexture2DArray=$,this.setTexture3D=se,this.setTextureCube=H,this.rebindTextures=Be,this.setupRenderTarget=$e,this.updateRenderTargetMipmap=mt,this.updateMultisampleRenderTarget=dt,this.setupDepthRenderbuffer=Ee,this.setupFrameBufferTexture=he,this.useMultisampledRTT=ut}function FCe(e,t,r){let i=r.isWebGL2;function n(s,a=null){let o;if(s===Fa)return 5121;if(s===S2e)return 32819;if(s===E2e)return 32820;if(s===b2e)return 5120;if(s===w2e)return 5122;if(s===rie)return 5123;if(s===_2e)return 5124;if(s===ph)return 5125;if(s===Ni)return 5126;if(s===Rh)return i?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===A2e)return 6406;if(s===dn)return 6408;if(s===C2e)return 6409;if(s===T2e)return 6410;if(s===Tg)return 6402;if(s===Gg)return 34041;if(s===Nj)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===rT)return 6403;if(s===M2e)return 36244;if(s===tM)return 33319;if(s===P2e)return 33320;if(s===iie)return 36249;if(s===TR||s===MR||s===PR||s===DR)if(a===Ar)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===TR)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===MR)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===PR)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===DR)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===TR)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===MR)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===PR)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===DR)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===eG||s===tG||s===rG||s===iG)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===eG)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===tG)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===rG)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===iG)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===D2e)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===nG||s===sG)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(s===nG)return a===Ar?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===sG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===aG||s===oG||s===lG||s===cG||s===uG||s===dG||s===hG||s===fG||s===pG||s===mG||s===gG||s===vG||s===yG||s===xG)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(s===aG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===oG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===lG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===cG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===uG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===dG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===hG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===fG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===pG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===mG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===gG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===vG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===yG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===xG)return a===Ar?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===NR)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(s===NR)return a===Ar?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===N2e||s===bG||s===wG||s===_G)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(s===NR)return o.COMPRESSED_RED_RGTC1_EXT;if(s===bG)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===wG)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===_G)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Cg?i?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:n}}var VCe=class extends Ra{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},gh=class extends Ei{constructor(){super(),this.isGroup=!0,this.type="Group"}},UCe={type:"move"},i4=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new gh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new gh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new V,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new V),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new gh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new V,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new V),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,n=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){s=!0;for(let v of e.hand.values()){let y=t.getJointPose(v,r),x=this._getHandJoint(l,v);y!==null&&(x.matrix.fromArray(y.transform.matrix),x.matrix.decompose(x.position,x.rotation,x.scale),x.jointRadius=y.radius),x.visible=y!==null}let c=l.joints["index-finger-tip"],u=l.joints["thumb-tip"],d=c.position.distanceTo(u.position),f=.02,m=.005;l.inputState.pinching&&d>f+m?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=f-m&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else o!==null&&e.gripSpace&&(n=t.getPose(e.gripSpace,r),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&n!==null&&(i=n),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(UCe)))}return a!==null&&(a.visible=i!==null),o!==null&&(o.visible=n!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let r=new gh;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}},ax=class extends yn{constructor(e,t,r,i,n,s,a,o,l,c){if(c=c!==void 0?c:Tg,c!==Tg&&c!==Gg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===Tg&&(r=ph),r===void 0&&c===Gg&&(r=Cg),super(null,i,n,s,a,o,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:jr,this.minFilter=o!==void 0?o:jr,this.flipY=!1,this.generateMipmaps=!1}},HCe=class extends wa{constructor(e,t){super();let r=this,i=null,n=1,s=null,a="local-floor",o=1,l=null,c=null,u=null,d=null,f=null,m=null,v=t.getContextAttributes(),y=null,x=null,w=[],_=[],S=new Set,P=new Map,M=new Ra;M.layers.enable(1),M.viewport=new fr;let C=new Ra;C.layers.enable(2),C.viewport=new fr;let T=[M,C],E=new VCe;E.layers.enable(1),E.layers.enable(2);let N=null,D=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function($){let se=w[$];return se===void 0&&(se=new i4,w[$]=se),se.getTargetRaySpace()},this.getControllerGrip=function($){let se=w[$];return se===void 0&&(se=new i4,w[$]=se),se.getGripSpace()},this.getHand=function($){let se=w[$];return se===void 0&&(se=new i4,w[$]=se),se.getHandSpace()};function I($){let se=_.indexOf($.inputSource);if(se===-1)return;let H=w[se];H!==void 0&&H.dispatchEvent({type:$.type,data:$.inputSource})}function j(){i.removeEventListener("select",I),i.removeEventListener("selectstart",I),i.removeEventListener("selectend",I),i.removeEventListener("squeeze",I),i.removeEventListener("squeezestart",I),i.removeEventListener("squeezeend",I),i.removeEventListener("end",j),i.removeEventListener("inputsourceschange",L);for(let $=0;$<w.length;$++){let se=_[$];se!==null&&(_[$]=null,w[$].disconnect(se))}N=null,D=null,e.setRenderTarget(y),f=null,d=null,u=null,i=null,x=null,F.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function($){n=$,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function($){a=$,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function($){l=$},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return u},this.getFrame=function(){return m},this.getSession=function(){return i},this.setSession=async function($){if(i=$,i!==null){if(y=e.getRenderTarget(),i.addEventListener("select",I),i.addEventListener("selectstart",I),i.addEventListener("selectend",I),i.addEventListener("squeeze",I),i.addEventListener("squeezestart",I),i.addEventListener("squeezeend",I),i.addEventListener("end",j),i.addEventListener("inputsourceschange",L),v.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let se={antialias:i.renderState.layers===void 0?v.antialias:!0,alpha:v.alpha,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:n};f=new XRWebGLLayer(i,t,se),i.updateRenderState({baseLayer:f}),x=new Zr(f.framebufferWidth,f.framebufferHeight,{format:dn,type:Fa,encoding:e.outputEncoding,stencilBuffer:v.stencil})}else{let se=null,H=null,ne=null;v.depth&&(ne=v.stencil?35056:33190,se=v.stencil?Gg:Tg,H=v.stencil?Cg:ph);let ce={colorFormat:32856,depthFormat:ne,scaleFactor:n};u=new XRWebGLBinding(i,t),d=u.createProjectionLayer(ce),i.updateRenderState({layers:[d]}),x=new Zr(d.textureWidth,d.textureHeight,{format:dn,type:Fa,depthTexture:new ax(d.textureWidth,d.textureHeight,H,void 0,void 0,void 0,void 0,void 0,void 0,se),stencilBuffer:v.stencil,encoding:e.outputEncoding,samples:v.antialias?4:0});let ie=e.properties.get(x);ie.__ignoreDepthValues=d.ignoreDepthValues}x.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await i.requestReferenceSpace(a),F.setContext(i),F.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function L($){for(let se=0;se<$.removed.length;se++){let H=$.removed[se],ne=_.indexOf(H);ne>=0&&(_[ne]=null,w[ne].disconnect(H))}for(let se=0;se<$.added.length;se++){let H=$.added[se],ne=_.indexOf(H);if(ne===-1){for(let ie=0;ie<w.length;ie++)if(ie>=_.length){_.push(H),ne=ie;break}else if(_[ie]===null){_[ie]=H,ne=ie;break}if(ne===-1)break}let ce=w[ne];ce&&ce.connect(H)}}let B=new V,q=new V;function G($,se,H){B.setFromMatrixPosition(se.matrixWorld),q.setFromMatrixPosition(H.matrixWorld);let ne=B.distanceTo(q),ce=se.projectionMatrix.elements,ie=H.projectionMatrix.elements,ae=ce[14]/(ce[10]-1),Z=ce[14]/(ce[10]+1),fe=(ce[9]+1)/ce[5],he=(ce[9]-1)/ce[5],Ae=(ce[8]-1)/ce[0],xe=(ie[8]+1)/ie[0],Ee=ae*Ae,Be=ae*xe,$e=ne/(-Ae+xe),mt=$e*-Ae;se.matrixWorld.decompose($.position,$.quaternion,$.scale),$.translateX(mt),$.translateZ($e),$.matrixWorld.compose($.position,$.quaternion,$.scale),$.matrixWorldInverse.copy($.matrixWorld).invert();let dt=ae+$e,ct=Z+$e,ut=Ee-mt,me=Be+(ne-mt),_e=fe*Z/ct*dt,te=he*Z/ct*dt;$.projectionMatrix.makePerspective(ut,me,_e,te,dt,ct)}function Y($,se){se===null?$.matrixWorld.copy($.matrix):$.matrixWorld.multiplyMatrices(se.matrixWorld,$.matrix),$.matrixWorldInverse.copy($.matrixWorld).invert()}this.updateCamera=function($){if(i===null)return;E.near=C.near=M.near=$.near,E.far=C.far=M.far=$.far,(N!==E.near||D!==E.far)&&(i.updateRenderState({depthNear:E.near,depthFar:E.far}),N=E.near,D=E.far);let se=$.parent,H=E.cameras;Y(E,se);for(let ce=0;ce<H.length;ce++)Y(H[ce],se);E.matrixWorld.decompose(E.position,E.quaternion,E.scale),$.matrix.copy(E.matrix),$.matrix.decompose($.position,$.quaternion,$.scale);let ne=$.children;for(let ce=0,ie=ne.length;ce<ie;ce++)ne[ce].updateMatrixWorld(!0);H.length===2?G(E,M,C):E.projectionMatrix.copy(M.projectionMatrix)},this.getCamera=function(){return E},this.getFoveation=function(){if(!(d===null&&f===null))return o},this.setFoveation=function($){o=$,d!==null&&(d.fixedFoveation=$),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=$)},this.getPlanes=function(){return S};let X=null;function re($,se){if(c=se.getViewerPose(l||s),m=se,c!==null){let H=c.views;f!==null&&(e.setRenderTargetFramebuffer(x,f.framebuffer),e.setRenderTarget(x));let ne=!1;H.length!==E.cameras.length&&(E.cameras.length=0,ne=!0);for(let ce=0;ce<H.length;ce++){let ie=H[ce],ae=null;if(f!==null)ae=f.getViewport(ie);else{let fe=u.getViewSubImage(d,ie);ae=fe.viewport,ce===0&&(e.setRenderTargetTextures(x,fe.colorTexture,d.ignoreDepthValues?void 0:fe.depthStencilTexture),e.setRenderTarget(x))}let Z=T[ce];Z===void 0&&(Z=new Ra,Z.layers.enable(ce),Z.viewport=new fr,T[ce]=Z),Z.matrix.fromArray(ie.transform.matrix),Z.projectionMatrix.fromArray(ie.projectionMatrix),Z.viewport.set(ae.x,ae.y,ae.width,ae.height),ce===0&&E.matrix.copy(Z.matrix),ne===!0&&E.cameras.push(Z)}}for(let H=0;H<w.length;H++){let ne=_[H],ce=w[H];ne!==null&&ce!==void 0&&ce.update(ne,se,l||s)}if(X&&X($,se),se.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:se.detectedPlanes});let H=null;for(let ne of S)se.detectedPlanes.has(ne)||(H===null&&(H=[]),H.push(ne));if(H!==null)for(let ne of H)S.delete(ne),P.delete(ne),r.dispatchEvent({type:"planeremoved",data:ne});for(let ne of se.detectedPlanes)if(!S.has(ne))S.add(ne),P.set(ne,se.lastChangedTime),r.dispatchEvent({type:"planeadded",data:ne});else{let ce=P.get(ne);ne.lastChangedTime>ce&&(P.set(ne,ne.lastChangedTime),r.dispatchEvent({type:"planechanged",data:ne}))}}m=null}let F=new gie;F.setAnimationLoop(re),this.setAnimationLoop=function($){X=$},this.dispose=function(){}}};function GCe(e,t){function r(y,x){x.color.getRGB(y.fogColor.value,mie(e)),x.isFog?(y.fogNear.value=x.near,y.fogFar.value=x.far):x.isFogExp2&&(y.fogDensity.value=x.density)}function i(y,x,w,_,S){x.isMeshBasicMaterial||x.isMeshLambertMaterial?n(y,x):x.isMeshToonMaterial?(n(y,x),u(y,x)):x.isMeshPhongMaterial?(n(y,x),c(y,x)):x.isMeshStandardMaterial?(n(y,x),d(y,x),x.isMeshPhysicalMaterial&&f(y,x,S)):x.isMeshMatcapMaterial?(n(y,x),m(y,x)):x.isMeshDepthMaterial?n(y,x):x.isMeshDistanceMaterial?(n(y,x),v(y,x)):x.isMeshNormalMaterial?n(y,x):x.isLineBasicMaterial?(s(y,x),x.isLineDashedMaterial&&a(y,x)):x.isPointsMaterial?o(y,x,w,_):x.isSpriteMaterial?l(y,x):x.isShadowMaterial?(y.color.value.copy(x.color),y.opacity.value=x.opacity):x.isShaderMaterial&&(x.uniformsNeedUpdate=!1)}function n(y,x){y.opacity.value=x.opacity,x.color&&y.diffuse.value.copy(x.color),x.emissive&&y.emissive.value.copy(x.emissive).multiplyScalar(x.emissiveIntensity),x.map&&(y.map.value=x.map),x.alphaMap&&(y.alphaMap.value=x.alphaMap),x.bumpMap&&(y.bumpMap.value=x.bumpMap,y.bumpScale.value=x.bumpScale,x.side===Ys&&(y.bumpScale.value*=-1)),x.displacementMap&&(y.displacementMap.value=x.displacementMap,y.displacementScale.value=x.displacementScale,y.displacementBias.value=x.displacementBias),x.emissiveMap&&(y.emissiveMap.value=x.emissiveMap),x.normalMap&&(y.normalMap.value=x.normalMap,y.normalScale.value.copy(x.normalScale),x.side===Ys&&y.normalScale.value.negate()),x.specularMap&&(y.specularMap.value=x.specularMap),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest);let w=t.get(x).envMap;if(w&&(y.envMap.value=w,y.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=x.reflectivity,y.ior.value=x.ior,y.refractionRatio.value=x.refractionRatio),x.lightMap){y.lightMap.value=x.lightMap;let P=e.physicallyCorrectLights!==!0?Math.PI:1;y.lightMapIntensity.value=x.lightMapIntensity*P}x.aoMap&&(y.aoMap.value=x.aoMap,y.aoMapIntensity.value=x.aoMapIntensity);let _;x.map?_=x.map:x.specularMap?_=x.specularMap:x.displacementMap?_=x.displacementMap:x.normalMap?_=x.normalMap:x.bumpMap?_=x.bumpMap:x.roughnessMap?_=x.roughnessMap:x.metalnessMap?_=x.metalnessMap:x.alphaMap?_=x.alphaMap:x.emissiveMap?_=x.emissiveMap:x.clearcoatMap?_=x.clearcoatMap:x.clearcoatNormalMap?_=x.clearcoatNormalMap:x.clearcoatRoughnessMap?_=x.clearcoatRoughnessMap:x.iridescenceMap?_=x.iridescenceMap:x.iridescenceThicknessMap?_=x.iridescenceThicknessMap:x.specularIntensityMap?_=x.specularIntensityMap:x.specularColorMap?_=x.specularColorMap:x.transmissionMap?_=x.transmissionMap:x.thicknessMap?_=x.thicknessMap:x.sheenColorMap?_=x.sheenColorMap:x.sheenRoughnessMap&&(_=x.sheenRoughnessMap),_!==void 0&&(_.isWebGLRenderTarget&&(_=_.texture),_.matrixAutoUpdate===!0&&_.updateMatrix(),y.uvTransform.value.copy(_.matrix));let S;x.aoMap?S=x.aoMap:x.lightMap&&(S=x.lightMap),S!==void 0&&(S.isWebGLRenderTarget&&(S=S.texture),S.matrixAutoUpdate===!0&&S.updateMatrix(),y.uv2Transform.value.copy(S.matrix))}function s(y,x){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity}function a(y,x){y.dashSize.value=x.dashSize,y.totalSize.value=x.dashSize+x.gapSize,y.scale.value=x.scale}function o(y,x,w,_){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity,y.size.value=x.size*w,y.scale.value=_*.5,x.map&&(y.map.value=x.map),x.alphaMap&&(y.alphaMap.value=x.alphaMap),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest);let S;x.map?S=x.map:x.alphaMap&&(S=x.alphaMap),S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),y.uvTransform.value.copy(S.matrix))}function l(y,x){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity,y.rotation.value=x.rotation,x.map&&(y.map.value=x.map),x.alphaMap&&(y.alphaMap.value=x.alphaMap),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest);let w;x.map?w=x.map:x.alphaMap&&(w=x.alphaMap),w!==void 0&&(w.matrixAutoUpdate===!0&&w.updateMatrix(),y.uvTransform.value.copy(w.matrix))}function c(y,x){y.specular.value.copy(x.specular),y.shininess.value=Math.max(x.shininess,1e-4)}function u(y,x){x.gradientMap&&(y.gradientMap.value=x.gradientMap)}function d(y,x){y.roughness.value=x.roughness,y.metalness.value=x.metalness,x.roughnessMap&&(y.roughnessMap.value=x.roughnessMap),x.metalnessMap&&(y.metalnessMap.value=x.metalnessMap),t.get(x).envMap&&(y.envMapIntensity.value=x.envMapIntensity)}function f(y,x,w){y.ior.value=x.ior,x.sheen>0&&(y.sheenColor.value.copy(x.sheenColor).multiplyScalar(x.sheen),y.sheenRoughness.value=x.sheenRoughness,x.sheenColorMap&&(y.sheenColorMap.value=x.sheenColorMap),x.sheenRoughnessMap&&(y.sheenRoughnessMap.value=x.sheenRoughnessMap)),x.clearcoat>0&&(y.clearcoat.value=x.clearcoat,y.clearcoatRoughness.value=x.clearcoatRoughness,x.clearcoatMap&&(y.clearcoatMap.value=x.clearcoatMap),x.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=x.clearcoatRoughnessMap),x.clearcoatNormalMap&&(y.clearcoatNormalScale.value.copy(x.clearcoatNormalScale),y.clearcoatNormalMap.value=x.clearcoatNormalMap,x.side===Ys&&y.clearcoatNormalScale.value.negate())),x.iridescence>0&&(y.iridescence.value=x.iridescence,y.iridescenceIOR.value=x.iridescenceIOR,y.iridescenceThicknessMinimum.value=x.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=x.iridescenceThicknessRange[1],x.iridescenceMap&&(y.iridescenceMap.value=x.iridescenceMap),x.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=x.iridescenceThicknessMap)),x.transmission>0&&(y.transmission.value=x.transmission,y.transmissionSamplerMap.value=w.texture,y.transmissionSamplerSize.value.set(w.width,w.height),x.transmissionMap&&(y.transmissionMap.value=x.transmissionMap),y.thickness.value=x.thickness,x.thicknessMap&&(y.thicknessMap.value=x.thicknessMap),y.attenuationDistance.value=x.attenuationDistance,y.attenuationColor.value.copy(x.attenuationColor)),y.specularIntensity.value=x.specularIntensity,y.specularColor.value.copy(x.specularColor),x.specularIntensityMap&&(y.specularIntensityMap.value=x.specularIntensityMap),x.specularColorMap&&(y.specularColorMap.value=x.specularColorMap)}function m(y,x){x.matcap&&(y.matcap.value=x.matcap)}function v(y,x){y.referencePosition.value.copy(x.referencePosition),y.nearDistance.value=x.nearDistance,y.farDistance.value=x.farDistance}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function WCe(e,t,r,i){let n={},s={},a=[],o=r.isWebGL2?e.getParameter(35375):0;function l(_,S){let P=S.program;i.uniformBlockBinding(_,P)}function c(_,S){let P=n[_.id];P===void 0&&(v(_),P=u(_),n[_.id]=P,_.addEventListener("dispose",x));let M=S.program;i.updateUBOMapping(_,M);let C=t.render.frame;s[_.id]!==C&&(f(_),s[_.id]=C)}function u(_){let S=d();_.__bindingPointIndex=S;let P=e.createBuffer(),M=_.__size,C=_.usage;return e.bindBuffer(35345,P),e.bufferData(35345,M,C),e.bindBuffer(35345,null),e.bindBufferBase(35345,S,P),P}function d(){for(let _=0;_<o;_++)if(a.indexOf(_)===-1)return a.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function f(_){let S=n[_.id],P=_.uniforms,M=_.__cache;e.bindBuffer(35345,S);for(let C=0,T=P.length;C<T;C++){let E=P[C];if(m(E,C,M)===!0){let N=E.__offset,D=Array.isArray(E.value)?E.value:[E.value],I=0;for(let j=0;j<D.length;j++){let L=D[j],B=y(L);typeof L=="number"?(E.__data[0]=L,e.bufferSubData(35345,N+I,E.__data)):L.isMatrix3?(E.__data[0]=L.elements[0],E.__data[1]=L.elements[1],E.__data[2]=L.elements[2],E.__data[3]=L.elements[0],E.__data[4]=L.elements[3],E.__data[5]=L.elements[4],E.__data[6]=L.elements[5],E.__data[7]=L.elements[0],E.__data[8]=L.elements[6],E.__data[9]=L.elements[7],E.__data[10]=L.elements[8],E.__data[11]=L.elements[0]):(L.toArray(E.__data,I),I+=B.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,N,E.__data)}}e.bindBuffer(35345,null)}function m(_,S,P){let M=_.value;if(P[S]===void 0){if(typeof M=="number")P[S]=M;else{let C=Array.isArray(M)?M:[M],T=[];for(let E=0;E<C.length;E++)T.push(C[E].clone());P[S]=T}return!0}else if(typeof M=="number"){if(P[S]!==M)return P[S]=M,!0}else{let C=Array.isArray(P[S])?P[S]:[P[S]],T=Array.isArray(M)?M:[M];for(let E=0;E<C.length;E++){let N=C[E];if(N.equals(T[E])===!1)return N.copy(T[E]),!0}}return!1}function v(_){let S=_.uniforms,P=0,M=16,C=0;for(let T=0,E=S.length;T<E;T++){let N=S[T],D={boundary:0,storage:0},I=Array.isArray(N.value)?N.value:[N.value];for(let j=0,L=I.length;j<L;j++){let B=I[j],q=y(B);D.boundary+=q.boundary,D.storage+=q.storage}if(N.__data=new Float32Array(D.storage/Float32Array.BYTES_PER_ELEMENT),N.__offset=P,T>0){C=P%M;let j=M-C;C!==0&&j-D.boundary<0&&(P+=M-C,N.__offset=P)}P+=D.storage}return C=P%M,C>0&&(P+=M-C),_.__size=P,_.__cache={},this}function y(_){let S={boundary:0,storage:0};return typeof _=="number"?(S.boundary=4,S.storage=4):_.isVector2?(S.boundary=8,S.storage=8):_.isVector3||_.isColor?(S.boundary=16,S.storage=12):_.isVector4?(S.boundary=16,S.storage=16):_.isMatrix3?(S.boundary=48,S.storage=48):_.isMatrix4?(S.boundary=64,S.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),S}function x(_){let S=_.target;S.removeEventListener("dispose",x);let P=a.indexOf(S.__bindingPointIndex);a.splice(P,1),e.deleteBuffer(n[S.id]),delete n[S.id],delete s[S.id]}function w(){for(let _ in n)e.deleteBuffer(n[_]);a=[],n={},s={}}return{bind:l,update:c,dispose:w}}function qCe(){let e=M2("canvas");return e.style.display="block",e}function _ie(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:qCe(),r=e.context!==void 0?e.context:null,i=e.depth!==void 0?e.depth:!0,n=e.stencil!==void 0?e.stencil:!0,s=e.antialias!==void 0?e.antialias:!1,a=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,o=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,u;r!==null?u=r.getContextAttributes().alpha:u=e.alpha!==void 0?e.alpha:!1;let d=null,f=null,m=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Bc,this.physicallyCorrectLights=!1,this.toneMapping=zu,this.toneMappingExposure=1;let y=this,x=!1,w=0,_=0,S=null,P=-1,M=null,C=new fr,T=new fr,E=null,N=t.width,D=t.height,I=1,j=null,L=null,B=new fr(0,0,N,D),q=new fr(0,0,N,D),G=!1,Y=new U6,X=!1,re=!1,F=null,$=new ot,se=new ge,H=new V,ne={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ce(){return S===null?I:1}let ie=r;function ae(pe,je){for(let Ke=0;Ke<pe.length;Ke++){let ke=pe[Ke],Qe=t.getContext(ke,je);if(Qe!==null)return Qe}return null}try{let pe={alpha:!0,depth:i,stencil:n,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Gx}`),t.addEventListener("webglcontextlost",et,!1),t.addEventListener("webglcontextrestored",qe,!1),t.addEventListener("webglcontextcreationerror",ft,!1),ie===null){let je=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&je.shift(),ie=ae(je,pe),ie===null)throw ae(je)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ie.getShaderPrecisionFormat===void 0&&(ie.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(pe){throw console.error("THREE.WebGLRenderer: "+pe.message),pe}let Z,fe,he,Ae,xe,Ee,Be,$e,mt,dt,ct,ut,me,_e,te,J,ve,Me,W,Se,ze,Ue,Ne,De;function We(){Z=new sAe(ie),fe=new JEe(ie,Z,e),Z.init(fe),Ue=new FCe(ie,Z,fe),he=new zCe(ie,Z,fe),Ae=new lAe,xe=new ACe,Ee=new BCe(ie,Z,he,xe,fe,Ue,Ae),Be=new tAe(y),$e=new nAe(y),mt=new v_e(ie,fe),Ne=new QEe(ie,Z,mt,fe),dt=new aAe(ie,mt,Ae,Ne),ct=new hAe(ie,dt,mt,Ae),W=new dAe(ie,fe,Ee),J=new eAe(xe),ut=new ECe(y,Be,$e,Z,fe,Ne,J),me=new GCe(y,xe),_e=new TCe,te=new RCe(Z,fe),Me=new KEe(y,Be,$e,he,ct,u,a),ve=new LCe(y,ct,fe),De=new WCe(ie,Ae,fe,he),Se=new ZEe(ie,Z,Ae,fe),ze=new oAe(ie,Z,Ae,fe),Ae.programs=ut.programs,y.capabilities=fe,y.extensions=Z,y.properties=xe,y.renderLists=_e,y.shadowMap=ve,y.state=he,y.info=Ae}We();let Je=new HCe(y,ie);this.xr=Je,this.getContext=function(){return ie},this.getContextAttributes=function(){return ie.getContextAttributes()},this.forceContextLoss=function(){let pe=Z.get("WEBGL_lose_context");pe&&pe.loseContext()},this.forceContextRestore=function(){let pe=Z.get("WEBGL_lose_context");pe&&pe.restoreContext()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(pe){pe!==void 0&&(I=pe,this.setSize(N,D,!1))},this.getSize=function(pe){return pe.set(N,D)},this.setSize=function(pe,je,Ke){if(Je.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}N=pe,D=je,t.width=Math.floor(pe*I),t.height=Math.floor(je*I),Ke!==!1&&(t.style.width=pe+"px",t.style.height=je+"px"),this.setViewport(0,0,pe,je)},this.getDrawingBufferSize=function(pe){return pe.set(N*I,D*I).floor()},this.setDrawingBufferSize=function(pe,je,Ke){N=pe,D=je,I=Ke,t.width=Math.floor(pe*Ke),t.height=Math.floor(je*Ke),this.setViewport(0,0,pe,je)},this.getCurrentViewport=function(pe){return pe.copy(C)},this.getViewport=function(pe){return pe.copy(B)},this.setViewport=function(pe,je,Ke,ke){pe.isVector4?B.set(pe.x,pe.y,pe.z,pe.w):B.set(pe,je,Ke,ke),he.viewport(C.copy(B).multiplyScalar(I).floor())},this.getScissor=function(pe){return pe.copy(q)},this.setScissor=function(pe,je,Ke,ke){pe.isVector4?q.set(pe.x,pe.y,pe.z,pe.w):q.set(pe,je,Ke,ke),he.scissor(T.copy(q).multiplyScalar(I).floor())},this.getScissorTest=function(){return G},this.setScissorTest=function(pe){he.setScissorTest(G=pe)},this.setOpaqueSort=function(pe){j=pe},this.setTransparentSort=function(pe){L=pe},this.getClearColor=function(pe){return pe.copy(Me.getClearColor())},this.setClearColor=function(){Me.setClearColor.apply(Me,arguments)},this.getClearAlpha=function(){return Me.getClearAlpha()},this.setClearAlpha=function(){Me.setClearAlpha.apply(Me,arguments)},this.clear=function(pe=!0,je=!0,Ke=!0){let ke=0;pe&&(ke|=16384),je&&(ke|=256),Ke&&(ke|=1024),ie.clear(ke)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",et,!1),t.removeEventListener("webglcontextrestored",qe,!1),t.removeEventListener("webglcontextcreationerror",ft,!1),_e.dispose(),te.dispose(),xe.dispose(),Be.dispose(),$e.dispose(),ct.dispose(),Ne.dispose(),De.dispose(),ut.dispose(),Je.dispose(),Je.removeEventListener("sessionstart",xt),Je.removeEventListener("sessionend",Wt),F&&(F.dispose(),F=null),gr.stop()};function et(pe){pe.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function qe(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;let pe=Ae.autoReset,je=ve.enabled,Ke=ve.autoUpdate,ke=ve.needsUpdate,Qe=ve.type;We(),Ae.autoReset=pe,ve.enabled=je,ve.autoUpdate=Ke,ve.needsUpdate=ke,ve.type=Qe}function ft(pe){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",pe.statusMessage)}function kt(pe){let je=pe.target;je.removeEventListener("dispose",kt),Mt(je)}function Mt(pe){ye(pe),xe.remove(pe)}function ye(pe){let je=xe.get(pe).programs;je!==void 0&&(je.forEach(function(Ke){ut.releaseProgram(Ke)}),pe.isShaderMaterial&&ut.releaseShaderCache(pe))}this.renderBufferDirect=function(pe,je,Ke,ke,Qe,Tt){je===null&&(je=ne);let Gt=Qe.isMesh&&Qe.matrixWorld.determinant()<0,qt=ln(pe,je,Ke,ke,Qe);he.setMaterial(ke,Gt);let Dt=Ke.index,er=1;ke.wireframe===!0&&(Dt=dt.getWireframeAttribute(Ke),er=2);let wr=Ke.drawRange,vr=Ke.attributes.position,Xt=wr.start*er,Ci=(wr.start+wr.count)*er;Tt!==null&&(Xt=Math.max(Xt,Tt.start*er),Ci=Math.min(Ci,(Tt.start+Tt.count)*er)),Dt!==null?(Xt=Math.max(Xt,0),Ci=Math.min(Ci,Dt.count)):vr!=null&&(Xt=Math.max(Xt,0),Ci=Math.min(Ci,vr.count));let ea=Ci-Xt;if(ea<0||ea===1/0)return;Ne.setup(Qe,ke,qt,Ke,Dt);let mo,gi=Se;if(Dt!==null&&(mo=mt.get(Dt),gi=ze,gi.setIndex(mo)),Qe.isMesh)ke.wireframe===!0?(he.setLineWidth(ke.wireframeLinewidth*ce()),gi.setMode(1)):gi.setMode(4);else if(Qe.isLine){let kr=ke.linewidth;kr===void 0&&(kr=1),he.setLineWidth(kr*ce()),Qe.isLineSegments?gi.setMode(1):Qe.isLineLoop?gi.setMode(2):gi.setMode(3)}else Qe.isPoints?gi.setMode(0):Qe.isSprite&&gi.setMode(4);if(Qe.isInstancedMesh)gi.renderInstances(Xt,ea,Qe.count);else if(Ke.isInstancedBufferGeometry){let kr=Ke._maxInstanceCount!==void 0?Ke._maxInstanceCount:1/0,Yn=Math.min(Ke.instanceCount,kr);gi.renderInstances(Xt,ea,Yn)}else gi.render(Xt,ea)},this.compile=function(pe,je){function Ke(ke,Qe,Tt){ke.transparent===!0&&ke.side===La&&ke.forceSinglePass===!1?(ke.side=Ys,ke.needsUpdate=!0,zr(ke,Qe,Tt),ke.side=zc,ke.needsUpdate=!0,zr(ke,Qe,Tt),ke.side=La):zr(ke,Qe,Tt)}f=te.get(pe),f.init(),v.push(f),pe.traverseVisible(function(ke){ke.isLight&&ke.layers.test(je.layers)&&(f.pushLight(ke),ke.castShadow&&f.pushShadow(ke))}),f.setupLights(y.physicallyCorrectLights),pe.traverse(function(ke){let Qe=ke.material;if(Qe)if(Array.isArray(Qe))for(let Tt=0;Tt<Qe.length;Tt++){let Gt=Qe[Tt];Ke(Gt,pe,ke)}else Ke(Qe,pe,ke)}),v.pop(),f=null};let He=null;function tt(pe){He&&He(pe)}function xt(){gr.stop()}function Wt(){gr.start()}let gr=new gie;gr.setAnimationLoop(tt),typeof self<"u"&&gr.setContext(self),this.setAnimationLoop=function(pe){He=pe,Je.setAnimationLoop(pe),pe===null?gr.stop():gr.start()},Je.addEventListener("sessionstart",xt),Je.addEventListener("sessionend",Wt),this.render=function(pe,je){if(je!==void 0&&je.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(x===!0)return;pe.matrixWorldAutoUpdate===!0&&pe.updateMatrixWorld(),je.parent===null&&je.matrixWorldAutoUpdate===!0&&je.updateMatrixWorld(),Je.enabled===!0&&Je.isPresenting===!0&&(Je.cameraAutoUpdate===!0&&Je.updateCamera(je),je=Je.getCamera()),pe.isScene===!0&&pe.onBeforeRender(y,pe,je,S),f=te.get(pe,v.length),f.init(),v.push(f),$.multiplyMatrices(je.projectionMatrix,je.matrixWorldInverse),Y.setFromProjectionMatrix($),re=this.localClippingEnabled,X=J.init(this.clippingPlanes,re),d=_e.get(pe,m.length),d.init(),m.push(d),Ui(pe,je,0,y.sortObjects),d.finish(),y.sortObjects===!0&&d.sort(j,L),X===!0&&J.beginShadows();let Ke=f.state.shadowsArray;if(ve.render(Ke,pe,je),X===!0&&J.endShadows(),this.info.autoReset===!0&&this.info.reset(),Me.render(d,pe),f.setupLights(y.physicallyCorrectLights),je.isArrayCamera){let ke=je.cameras;for(let Qe=0,Tt=ke.length;Qe<Tt;Qe++){let Gt=ke[Qe];Hi(d,pe,Gt,Gt.viewport)}}else Hi(d,pe,je);S!==null&&(Ee.updateMultisampleRenderTarget(S),Ee.updateRenderTargetMipmap(S)),pe.isScene===!0&&pe.onAfterRender(y,pe,je),Ne.resetDefaultState(),P=-1,M=null,v.pop(),v.length>0?f=v[v.length-1]:f=null,m.pop(),m.length>0?d=m[m.length-1]:d=null};function Ui(pe,je,Ke,ke){if(pe.visible===!1)return;if(pe.layers.test(je.layers)){if(pe.isGroup)Ke=pe.renderOrder;else if(pe.isLOD)pe.autoUpdate===!0&&pe.update(je);else if(pe.isLight)f.pushLight(pe),pe.castShadow&&f.pushShadow(pe);else if(pe.isSprite){if(!pe.frustumCulled||Y.intersectsSprite(pe)){ke&&H.setFromMatrixPosition(pe.matrixWorld).applyMatrix4($);let Tt=ct.update(pe),Gt=pe.material;Gt.visible&&d.push(pe,Tt,Gt,Ke,H.z,null)}}else if((pe.isMesh||pe.isLine||pe.isPoints)&&(pe.isSkinnedMesh&&pe.skeleton.frame!==Ae.render.frame&&(pe.skeleton.update(),pe.skeleton.frame=Ae.render.frame),!pe.frustumCulled||Y.intersectsObject(pe))){ke&&H.setFromMatrixPosition(pe.matrixWorld).applyMatrix4($);let Tt=ct.update(pe),Gt=pe.material;if(Array.isArray(Gt)){let qt=Tt.groups;for(let Dt=0,er=qt.length;Dt<er;Dt++){let wr=qt[Dt],vr=Gt[wr.materialIndex];vr&&vr.visible&&d.push(pe,Tt,vr,Ke,H.z,wr)}}else Gt.visible&&d.push(pe,Tt,Gt,Ke,H.z,null)}}let Qe=pe.children;for(let Tt=0,Gt=Qe.length;Tt<Gt;Tt++)Ui(Qe[Tt],je,Ke,ke)}function Hi(pe,je,Ke,ke){let Qe=pe.opaque,Tt=pe.transmissive,Gt=pe.transparent;f.setupLightsView(Ke),X===!0&&J.setGlobalState(y.clippingPlanes,Ke),Tt.length>0&&Js(Qe,je,Ke),ke&&he.viewport(C.copy(ke)),Qe.length>0&&ei(Qe,je,Ke),Tt.length>0&&ei(Tt,je,Ke),Gt.length>0&&ei(Gt,je,Ke),he.buffers.depth.setTest(!0),he.buffers.depth.setMask(!0),he.buffers.color.setMask(!0),he.setPolygonOffset(!1)}function Js(pe,je,Ke){let ke=fe.isWebGL2;F===null&&(F=new Zr(1,1,{generateMipmaps:!0,type:Z.has("EXT_color_buffer_half_float")?Rh:Fa,minFilter:nx,samples:ke&&s===!0?4:0})),y.getDrawingBufferSize(se),ke?F.setSize(se.x,se.y):F.setSize(aM(se.x),aM(se.y));let Qe=y.getRenderTarget();y.setRenderTarget(F),y.clear();let Tt=y.toneMapping;y.toneMapping=zu,ei(pe,je,Ke),y.toneMapping=Tt,Ee.updateMultisampleRenderTarget(F),Ee.updateRenderTargetMipmap(F),y.setRenderTarget(Qe)}function ei(pe,je,Ke){let ke=je.isScene===!0?je.overrideMaterial:null;for(let Qe=0,Tt=pe.length;Qe<Tt;Qe++){let Gt=pe[Qe],qt=Gt.object,Dt=Gt.geometry,er=ke===null?Gt.material:ke,wr=Gt.group;qt.layers.test(Ke.layers)&&Sa(qt,je,Ke,Dt,er,wr)}}function Sa(pe,je,Ke,ke,Qe,Tt){pe.onBeforeRender(y,je,Ke,ke,Qe,Tt),pe.modelViewMatrix.multiplyMatrices(Ke.matrixWorldInverse,pe.matrixWorld),pe.normalMatrix.getNormalMatrix(pe.modelViewMatrix),Qe.onBeforeRender(y,je,Ke,ke,pe,Tt),Qe.transparent===!0&&Qe.side===La&&Qe.forceSinglePass===!1?(Qe.side=Ys,Qe.needsUpdate=!0,y.renderBufferDirect(Ke,je,ke,Qe,pe,Tt),Qe.side=zc,Qe.needsUpdate=!0,y.renderBufferDirect(Ke,je,ke,Qe,pe,Tt),Qe.side=La):y.renderBufferDirect(Ke,je,ke,Qe,pe,Tt),pe.onAfterRender(y,je,Ke,ke,Qe,Tt)}function zr(pe,je,Ke){je.isScene!==!0&&(je=ne);let ke=xe.get(pe),Qe=f.state.lights,Tt=f.state.shadowsArray,Gt=Qe.state.version,qt=ut.getParameters(pe,Qe.state,Tt,je,Ke),Dt=ut.getProgramCacheKey(qt),er=ke.programs;ke.environment=pe.isMeshStandardMaterial?je.environment:null,ke.fog=je.fog,ke.envMap=(pe.isMeshStandardMaterial?$e:Be).get(pe.envMap||ke.environment),er===void 0&&(pe.addEventListener("dispose",kt),er=new Map,ke.programs=er);let wr=er.get(Dt);if(wr!==void 0){if(ke.currentProgram===wr&&ke.lightsStateVersion===Gt)return $i(pe,qt),wr}else qt.uniforms=ut.getUniforms(pe),pe.onBuild(Ke,qt,y),pe.onBeforeCompile(qt,y),wr=ut.acquireProgram(qt,Dt),er.set(Dt,wr),ke.uniforms=qt.uniforms;let vr=ke.uniforms;(!pe.isShaderMaterial&&!pe.isRawShaderMaterial||pe.clipping===!0)&&(vr.clippingPlanes=J.uniform),$i(pe,qt),ke.needsLights=Zl(pe),ke.lightsStateVersion=Gt,ke.needsLights&&(vr.ambientLightColor.value=Qe.state.ambient,vr.lightProbe.value=Qe.state.probe,vr.directionalLights.value=Qe.state.directional,vr.directionalLightShadows.value=Qe.state.directionalShadow,vr.spotLights.value=Qe.state.spot,vr.spotLightShadows.value=Qe.state.spotShadow,vr.rectAreaLights.value=Qe.state.rectArea,vr.ltc_1.value=Qe.state.rectAreaLTC1,vr.ltc_2.value=Qe.state.rectAreaLTC2,vr.pointLights.value=Qe.state.point,vr.pointLightShadows.value=Qe.state.pointShadow,vr.hemisphereLights.value=Qe.state.hemi,vr.directionalShadowMap.value=Qe.state.directionalShadowMap,vr.directionalShadowMatrix.value=Qe.state.directionalShadowMatrix,vr.spotShadowMap.value=Qe.state.spotShadowMap,vr.spotLightMatrix.value=Qe.state.spotLightMatrix,vr.spotLightMap.value=Qe.state.spotLightMap,vr.pointShadowMap.value=Qe.state.pointShadowMap,vr.pointShadowMatrix.value=Qe.state.pointShadowMatrix);let Xt=wr.getUniforms(),Ci=nT.seqWithValue(Xt.seq,vr);return ke.currentProgram=wr,ke.uniformsList=Ci,wr}function $i(pe,je){let Ke=xe.get(pe);Ke.outputEncoding=je.outputEncoding,Ke.instancing=je.instancing,Ke.skinning=je.skinning,Ke.morphTargets=je.morphTargets,Ke.morphNormals=je.morphNormals,Ke.morphColors=je.morphColors,Ke.morphTargetsCount=je.morphTargetsCount,Ke.numClippingPlanes=je.numClippingPlanes,Ke.numIntersection=je.numClipIntersection,Ke.vertexAlphas=je.vertexAlphas,Ke.vertexTangents=je.vertexTangents,Ke.toneMapping=je.toneMapping}function ln(pe,je,Ke,ke,Qe){je.isScene!==!0&&(je=ne),Ee.resetTextureUnits();let Tt=je.fog,Gt=ke.isMeshStandardMaterial?je.environment:null,qt=S===null?y.outputEncoding:S.isXRRenderTarget===!0?S.texture.encoding:Bc,Dt=(ke.isMeshStandardMaterial?$e:Be).get(ke.envMap||Gt),er=ke.vertexColors===!0&&!!Ke.attributes.color&&Ke.attributes.color.itemSize===4,wr=!!ke.normalMap&&!!Ke.attributes.tangent,vr=!!Ke.morphAttributes.position,Xt=!!Ke.morphAttributes.normal,Ci=!!Ke.morphAttributes.color,ea=ke.toneMapped?y.toneMapping:zu,mo=Ke.morphAttributes.position||Ke.morphAttributes.normal||Ke.morphAttributes.color,gi=mo!==void 0?mo.length:0,kr=xe.get(ke),Yn=f.state.lights;if(X===!0&&(re===!0||pe!==M)){let de=pe===M&&ke.id===P;J.setState(ke,pe,de)}let ur=!1;ke.version===kr.__version?(kr.needsLights&&kr.lightsStateVersion!==Yn.state.version||kr.outputEncoding!==qt||Qe.isInstancedMesh&&kr.instancing===!1||!Qe.isInstancedMesh&&kr.instancing===!0||Qe.isSkinnedMesh&&kr.skinning===!1||!Qe.isSkinnedMesh&&kr.skinning===!0||kr.envMap!==Dt||ke.fog===!0&&kr.fog!==Tt||kr.numClippingPlanes!==void 0&&(kr.numClippingPlanes!==J.numPlanes||kr.numIntersection!==J.numIntersection)||kr.vertexAlphas!==er||kr.vertexTangents!==wr||kr.morphTargets!==vr||kr.morphNormals!==Xt||kr.morphColors!==Ci||kr.toneMapping!==ea||fe.isWebGL2===!0&&kr.morphTargetsCount!==gi)&&(ur=!0):(ur=!0,kr.__version=ke.version);let Gi=kr.currentProgram;ur===!0&&(Gi=zr(ke,je,Qe));let Wa=!1,Bo=!1,Xn=!1,ee=Gi.getUniforms(),oe=kr.uniforms;if(he.useProgram(Gi.program)&&(Wa=!0,Bo=!0,Xn=!0),ke.id!==P&&(P=ke.id,Bo=!0),Wa||M!==pe){if(ee.setValue(ie,"projectionMatrix",pe.projectionMatrix),fe.logarithmicDepthBuffer&&ee.setValue(ie,"logDepthBufFC",2/(Math.log(pe.far+1)/Math.LN2)),M!==pe&&(M=pe,Bo=!0,Xn=!0),ke.isShaderMaterial||ke.isMeshPhongMaterial||ke.isMeshToonMaterial||ke.isMeshStandardMaterial||ke.envMap){let de=ee.map.cameraPosition;de!==void 0&&de.setValue(ie,H.setFromMatrixPosition(pe.matrixWorld))}(ke.isMeshPhongMaterial||ke.isMeshToonMaterial||ke.isMeshLambertMaterial||ke.isMeshBasicMaterial||ke.isMeshStandardMaterial||ke.isShaderMaterial)&&ee.setValue(ie,"isOrthographic",pe.isOrthographicCamera===!0),(ke.isMeshPhongMaterial||ke.isMeshToonMaterial||ke.isMeshLambertMaterial||ke.isMeshBasicMaterial||ke.isMeshStandardMaterial||ke.isShaderMaterial||ke.isShadowMaterial||Qe.isSkinnedMesh)&&ee.setValue(ie,"viewMatrix",pe.matrixWorldInverse)}if(Qe.isSkinnedMesh){ee.setOptional(ie,Qe,"bindMatrix"),ee.setOptional(ie,Qe,"bindMatrixInverse");let de=Qe.skeleton;de&&(fe.floatVertexTextures?(de.boneTexture===null&&de.computeBoneTexture(),ee.setValue(ie,"boneTexture",de.boneTexture,Ee),ee.setValue(ie,"boneTextureSize",de.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let be=Ke.morphAttributes;if((be.position!==void 0||be.normal!==void 0||be.color!==void 0&&fe.isWebGL2===!0)&&W.update(Qe,Ke,ke,Gi),(Bo||kr.receiveShadow!==Qe.receiveShadow)&&(kr.receiveShadow=Qe.receiveShadow,ee.setValue(ie,"receiveShadow",Qe.receiveShadow)),ke.isMeshGouraudMaterial&&ke.envMap!==null&&(oe.envMap.value=Dt,oe.flipEnvMap.value=Dt.isCubeTexture&&Dt.isRenderTargetTexture===!1?-1:1),Bo&&(ee.setValue(ie,"toneMappingExposure",y.toneMappingExposure),kr.needsLights&&Ea(oe,Xn),Tt&&ke.fog===!0&&me.refreshFogUniforms(oe,Tt),me.refreshMaterialUniforms(oe,ke,I,D,F),nT.upload(ie,kr.uniformsList,oe,Ee)),ke.isShaderMaterial&&ke.uniformsNeedUpdate===!0&&(nT.upload(ie,kr.uniformsList,oe,Ee),ke.uniformsNeedUpdate=!1),ke.isSpriteMaterial&&ee.setValue(ie,"center",Qe.center),ee.setValue(ie,"modelViewMatrix",Qe.modelViewMatrix),ee.setValue(ie,"normalMatrix",Qe.normalMatrix),ee.setValue(ie,"modelMatrix",Qe.matrixWorld),Qe.previousModelViewMatrix&&ee.setValue(ie,"previousModelViewMatrix",Qe.previousModelViewMatrix),pe.previousProjectionMatrix&&ee.setValue(ie,"previousProjectionMatrix",pe.previousProjectionMatrix),ke.isShaderMaterial||ke.isRawShaderMaterial){let de=ke.uniformsGroups;for(let Ce=0,ht=de.length;Ce<ht;Ce++)if(fe.isWebGL2){let Fo=de[Ce];De.update(Fo,Gi),De.bind(Fo,Gi)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Gi}function Ea(pe,je){pe.ambientLightColor.needsUpdate=je,pe.lightProbe.needsUpdate=je,pe.directionalLights.needsUpdate=je,pe.directionalLightShadows.needsUpdate=je,pe.pointLights.needsUpdate=je,pe.pointLightShadows.needsUpdate=je,pe.spotLights.needsUpdate=je,pe.spotLightShadows.needsUpdate=je,pe.rectAreaLights.needsUpdate=je,pe.hemisphereLights.needsUpdate=je}function Zl(pe){return pe.isMeshLambertMaterial||pe.isMeshToonMaterial||pe.isMeshPhongMaterial||pe.isMeshStandardMaterial||pe.isShadowMaterial||pe.isShaderMaterial&&pe.lights===!0}this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(pe,je,Ke){xe.get(pe.texture).__webglTexture=je,xe.get(pe.depthTexture).__webglTexture=Ke;let ke=xe.get(pe);ke.__hasExternalTextures=!0,ke.__hasExternalTextures&&(ke.__autoAllocateDepthBuffer=Ke===void 0,ke.__autoAllocateDepthBuffer||Z.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ke.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(pe,je){let Ke=xe.get(pe);Ke.__webglFramebuffer=je,Ke.__useDefaultFramebuffer=je===void 0},this.setRenderTarget=function(pe,je=0,Ke=0){S=pe,w=je,_=Ke;let ke=!0,Qe=null,Tt=!1,Gt=!1;if(pe){let qt=xe.get(pe);qt.__useDefaultFramebuffer!==void 0?(he.bindFramebuffer(36160,null),ke=!1):qt.__webglFramebuffer===void 0?Ee.setupRenderTarget(pe):qt.__hasExternalTextures&&Ee.rebindTextures(pe,xe.get(pe.texture).__webglTexture,xe.get(pe.depthTexture).__webglTexture);let Dt=pe.texture;(Dt.isData3DTexture||Dt.isDataArrayTexture||Dt.isCompressedArrayTexture)&&(Gt=!0);let er=xe.get(pe).__webglFramebuffer;pe.isWebGLCubeRenderTarget?(Qe=er[je],Tt=!0):fe.isWebGL2&&pe.samples>0&&Ee.useMultisampledRTT(pe)===!1?Qe=xe.get(pe).__webglMultisampledFramebuffer:Qe=er,C.copy(pe.viewport),T.copy(pe.scissor),E=pe.scissorTest}else C.copy(B).multiplyScalar(I).floor(),T.copy(q).multiplyScalar(I).floor(),E=G;if(he.bindFramebuffer(36160,Qe)&&fe.drawBuffers&&ke&&he.drawBuffers(pe,Qe),he.viewport(C),he.scissor(T),he.setScissorTest(E),Tt){let qt=xe.get(pe.texture);ie.framebufferTexture2D(36160,36064,34069+je,qt.__webglTexture,Ke)}else if(Gt){let qt=xe.get(pe.texture),Dt=je||0;ie.framebufferTextureLayer(36160,36064,qt.__webglTexture,Ke||0,Dt)}P=-1},this.readRenderTargetPixels=function(pe,je,Ke,ke,Qe,Tt,Gt){if(!(pe&&pe.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let qt=xe.get(pe).__webglFramebuffer;if(pe.isWebGLCubeRenderTarget&&Gt!==void 0&&(qt=qt[Gt]),qt){he.bindFramebuffer(36160,qt);try{let Dt=pe.texture,er=Dt.format,wr=Dt.type;if(er!==dn&&Ue.convert(er)!==ie.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let vr=wr===Rh&&(Z.has("EXT_color_buffer_half_float")||fe.isWebGL2&&Z.has("EXT_color_buffer_float"));if(wr!==Fa&&Ue.convert(wr)!==ie.getParameter(35738)&&!(wr===Ni&&(fe.isWebGL2||Z.has("OES_texture_float")||Z.has("WEBGL_color_buffer_float")))&&!vr){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}je>=0&&je<=pe.width-ke&&Ke>=0&&Ke<=pe.height-Qe&&ie.readPixels(je,Ke,ke,Qe,Ue.convert(er),Ue.convert(wr),Tt)}finally{let Dt=S!==null?xe.get(S).__webglFramebuffer:null;he.bindFramebuffer(36160,Dt)}}},this.readRenderTargetPixelsAsync=async function(pe,je,Ke,ke,Qe,Tt,Gt){if(!(pe&&pe.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let qt=xe.get(pe).__webglFramebuffer;if(pe.isWebGLCubeRenderTarget&&Gt!==void 0&&(qt=qt[Gt]),qt){let Dt=pe.texture,er=Dt.format,wr=Dt.type;if(je>=0&&je<=pe.width-ke&&Ke>=0&&Ke<=pe.height-Qe){he.bindFramebuffer(ie.FRAMEBUFFER,qt);let vr=ie.createBuffer();ie.bindBuffer(ie.PIXEL_PACK_BUFFER,vr),ie.bufferData(ie.PIXEL_PACK_BUFFER,Tt.byteLength,ie.STREAM_READ),ie.readPixels(je,Ke,ke,Qe,Ue.convert(er),Ue.convert(wr),0);let Xt=S!==null?xe.get(S).__webglFramebuffer:null;he.bindFramebuffer(ie.FRAMEBUFFER,Xt);let Ci=ie.fenceSync(ie.SYNC_GPU_COMMANDS_COMPLETE,0);return ie.flush(),await Q2e(ie,Ci,4),ie.bindBuffer(ie.PIXEL_PACK_BUFFER,vr),ie.getBufferSubData(ie.PIXEL_PACK_BUFFER,0,Tt),ie.deleteBuffer(vr),ie.deleteSync(Ci),Tt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(pe,je,Ke=0){let ke=Math.pow(2,-Ke),Qe=Math.floor(je.image.width*ke),Tt=Math.floor(je.image.height*ke);Ee.setTexture2D(je,0),ie.copyTexSubImage2D(3553,Ke,0,0,pe.x,pe.y,Qe,Tt),he.unbindTexture()},this.copyTextureToTexture=function(pe,je,Ke,ke=0){let Qe=je.image.width,Tt=je.image.height,Gt=Ue.convert(Ke.format),qt=Ue.convert(Ke.type);Ee.setTexture2D(Ke,0),ie.pixelStorei(37440,Ke.flipY),ie.pixelStorei(37441,Ke.premultiplyAlpha),ie.pixelStorei(3317,Ke.unpackAlignment),je.isDataTexture?ie.texSubImage2D(3553,ke,pe.x,pe.y,Qe,Tt,Gt,qt,je.image.data):je.isCompressedTexture?ie.compressedTexSubImage2D(3553,ke,pe.x,pe.y,je.mipmaps[0].width,je.mipmaps[0].height,Gt,je.mipmaps[0].data):ie.texSubImage2D(3553,ke,pe.x,pe.y,Gt,qt,je.image),ke===0&&Ke.generateMipmaps&&ie.generateMipmap(3553),he.unbindTexture()},this.copyTextureToTexture3D=function(pe,je,Ke,ke,Qe=0){if(y.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let Tt=pe.max.x-pe.min.x+1,Gt=pe.max.y-pe.min.y+1,qt=pe.max.z-pe.min.z+1,Dt=Ue.convert(ke.format),er=Ue.convert(ke.type),wr;if(ke.isData3DTexture)Ee.setTexture3D(ke,0),wr=32879;else if(ke.isDataArrayTexture)Ee.setTexture2DArray(ke,0),wr=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ie.pixelStorei(37440,ke.flipY),ie.pixelStorei(37441,ke.premultiplyAlpha),ie.pixelStorei(3317,ke.unpackAlignment);let vr=ie.getParameter(3314),Xt=ie.getParameter(32878),Ci=ie.getParameter(3316),ea=ie.getParameter(3315),mo=ie.getParameter(32877),gi=Ke.isCompressedTexture?Ke.mipmaps[0]:Ke.image;ie.pixelStorei(3314,gi.width),ie.pixelStorei(32878,gi.height),ie.pixelStorei(3316,pe.min.x),ie.pixelStorei(3315,pe.min.y),ie.pixelStorei(32877,pe.min.z),Ke.isDataTexture||Ke.isData3DTexture?ie.texSubImage3D(wr,Qe,je.x,je.y,je.z,Tt,Gt,qt,Dt,er,gi.data):Ke.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ie.compressedTexSubImage3D(wr,Qe,je.x,je.y,je.z,Tt,Gt,qt,Dt,gi.data)):ie.texSubImage3D(wr,Qe,je.x,je.y,je.z,Tt,Gt,qt,Dt,er,gi),ie.pixelStorei(3314,vr),ie.pixelStorei(32878,Xt),ie.pixelStorei(3316,Ci),ie.pixelStorei(3315,ea),ie.pixelStorei(32877,mo),Qe===0&&ke.generateMipmaps&&ie.generateMipmap(wr),he.unbindTexture()},this.initRenderTarget=function(pe){xe.get(pe).__webglFramebuffer===void 0&&Ee.setupRenderTarget(pe)},this.initTexture=function(pe){pe.isCubeTexture?Ee.setTextureCube(pe,0):pe.isData3DTexture?Ee.setTexture3D(pe,0):pe.isDataArrayTexture||pe.isCompressedArrayTexture?Ee.setTexture2DArray(pe,0):Ee.setTexture2D(pe,0),he.unbindTexture()},this.resetState=function(){w=0,_=0,S=null,he.reset(),Ne.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var YCe=class extends _ie{};YCe.prototype.isWebGL1Renderer=!0;var Sie=class{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Zt(e),this.near=t,this.far=r}clone(){return new Sie(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},Ro=class extends Ei{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},XCe=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Pj,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Gl()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},$a=new V,Ij=class{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)$a.fromBufferAttribute(this,t),$a.applyMatrix4(e),this.setXYZ(t,$a.x,$a.y,$a.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)$a.fromBufferAttribute(this,t),$a.applyNormalMatrix(e),this.setXYZ(t,$a.x,$a.y,$a.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)$a.fromBufferAttribute(this,t),$a.transformDirection(e),this.setXYZ(t,$a.x,$a.y,$a.z);return this}setX(e,t){return this.normalized&&(t=qi(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=qi(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=qi(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=qi(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=mh(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=mh(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=mh(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=mh(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=qi(t,this.array),r=qi(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=qi(t,this.array),r=qi(r,this.array),i=qi(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=qi(t,this.array),r=qi(r,this.array),i=qi(i,this.array),n=qi(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=n,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return new Jt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ij(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},Eie=class extends Ei{constructor(){super(),this.isBone=!0,this.type="Bone"}},ao=class extends yn{constructor(e=null,t=1,r=1,i,n,s,a,o,l=jr,c=jr,u,d){super(null,s,a,o,l,c,i,n,u,d),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},rW=new ot,$Ce=new ot,G6=class{constructor(e=[],t=[]){this.uuid=Gl(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new ot)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new ot;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let n=0,s=e.length;n<s;n++){let a=e[n]?e[n].matrixWorld:$Ce;rW.multiplyMatrices(a,t[n]),rW.toArray(r,n*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new G6(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=oie(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new ao(t,e,e,dn,Ni);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){let n=e.bones[r],s=t[n];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),s=new Eie),this.bones.push(s),this.boneInverses.push(new ot().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let i=0,n=t.length;i<n;i++){let s=t[i];e.bones.push(s.uuid);let a=r[i];e.boneInverses.push(a.toArray())}return e}},P2=class extends Jt{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},iW=new ot,nW=new ot,cA=[],KCe=new ot,I1=new Yi,QCe=class extends Yi{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new P2(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let i=0;i<r;i++)this.setMatrixAt(i,KCe)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){let r=this.matrixWorld,i=this.count;if(I1.geometry=this.geometry,I1.material=this.material,I1.material!==void 0)for(let n=0;n<i;n++){this.getMatrixAt(n,iW),nW.multiplyMatrices(r,iW),I1.matrixWorld=nW,I1.raycast(e,cA);for(let s=0,a=cA.length;s<a;s++){let o=cA[s];o.instanceId=n,o.object=this,t.push(o)}cA.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new P2(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}},tm=class extends k_{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Zt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},sW=new V,aW=new V,oW=new ot,n4=new Wx,uA=new Oo,oM=class extends Ei{constructor(e=new Lt,t=new tm){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let i=1,n=t.count;i<n;i++)sW.fromBufferAttribute(t,i-1),aW.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=sW.distanceTo(aW);e.setAttribute("lineDistance",new At(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,i=this.matrixWorld,n=e.params.Line.threshold,s=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),uA.copy(r.boundingSphere),uA.applyMatrix4(i),uA.radius+=n,e.ray.intersectsSphere(uA)===!1)return;oW.copy(i).invert(),n4.copy(e.ray).applyMatrix4(oW);let a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new V,c=new V,u=new V,d=new V,f=this.isLineSegments?2:1,m=r.index,v=r.attributes.position;if(m!==null){let y=Math.max(0,s.start),x=Math.min(m.count,s.start+s.count);for(let w=y,_=x-1;w<_;w+=f){let S=m.getX(w),P=m.getX(w+1);if(l.fromBufferAttribute(v,S),c.fromBufferAttribute(v,P),n4.distanceSqToSegment(l,c,d,u)>o)continue;d.applyMatrix4(this.matrixWorld);let M=e.ray.origin.distanceTo(d);M<e.near||M>e.far||t.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else{let y=Math.max(0,s.start),x=Math.min(v.count,s.start+s.count);for(let w=y,_=x-1;w<_;w+=f){if(l.fromBufferAttribute(v,w),c.fromBufferAttribute(v,w+1),n4.distanceSqToSegment(l,c,d,u)>o)continue;d.applyMatrix4(this.matrixWorld);let S=e.ray.origin.distanceTo(d);S<e.near||S>e.far||t.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}},lW=new V,cW=new V,R_=class extends oM{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let i=0,n=t.count;i<n;i+=2)lW.fromBufferAttribute(t,i),cW.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+lW.distanceTo(cW);e.setAttribute("lineDistance",new At(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},ZCe=class extends yn{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,n,s,a,o,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:Pr,this.magFilter=n!==void 0?n:Pr,this.generateMipmaps=!1;let c=this;function u(){c.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},JCe=class extends yn{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,n,s,a,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},hd=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,i=this.getPoint(0),n=0;t.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),n+=r.distanceTo(i),t.push(n),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),i=0,n=r.length,s;t?s=t:s=e*r[n-1];let a=0,o=n-1,l;for(;a<=o;)if(i=Math.floor(a+(o-a)/2),l=r[i]-s,l<0)a=i+1;else if(l>0)o=i-1;else{o=i;break}if(i=o,r[i]===s)return i/(n-1);let c=r[i],u=r[i+1]-c,d=(s-c)/u;return(i+d)/(n-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);let n=this.getPoint(r),s=this.getPoint(i),a=t||(n.isVector2?new ge:new V);return a.copy(s).sub(n).normalize(),a}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new V,i=[],n=[],s=[],a=new V,o=new ot;for(let f=0;f<=e;f++){let m=f/e;i[f]=this.getTangentAt(m,new V)}n[0]=new V,s[0]=new V;let l=Number.MAX_VALUE,c=Math.abs(i[0].x),u=Math.abs(i[0].y),d=Math.abs(i[0].z);c<=l&&(l=c,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),d<=l&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),n[0].crossVectors(i[0],a),s[0].crossVectors(i[0],n[0]);for(let f=1;f<=e;f++){if(n[f]=n[f-1].clone(),s[f]=s[f-1].clone(),a.crossVectors(i[f-1],i[f]),a.length()>Number.EPSILON){a.normalize();let m=Math.acos(ns(i[f-1].dot(i[f]),-1,1));n[f].applyMatrix4(o.makeRotationAxis(a,m))}s[f].crossVectors(i[f],n[f])}if(t===!0){let f=Math.acos(ns(n[0].dot(n[e]),-1,1));f/=e,i[0].dot(a.crossVectors(n[0],n[e]))>0&&(f=-f);for(let m=1;m<=e;m++)n[m].applyMatrix4(o.makeRotationAxis(i[m],f*m)),s[m].crossVectors(i[m],n[m])}return{tangents:i,normals:n,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},D3=class extends hd{constructor(e=0,t=0,r=1,i=1,n=0,s=Math.PI*2,a=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let r=t||new ge,i=Math.PI*2,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(s?n=0:n=i),this.aClockwise===!0&&!s&&(n===i?n=-i:n=n-i);let a=this.aStartAngle+e*n,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let c=Math.cos(this.aRotation),u=Math.sin(this.aRotation),d=o-this.aX,f=l-this.aY;o=d*c-f*u+this.aX,l=d*u+f*c+this.aY}return r.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},eTe=class extends D3{constructor(e,t,r,i,n,s){super(e,t,r,r,i,n,s),this.isArcCurve=!0,this.type="ArcCurve"}};function W6(){let e=0,t=0,r=0,i=0;function n(s,a,o,l){e=s,t=o,r=-3*s+3*a-2*o-l,i=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){n(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,u,d){let f=(a-s)/c-(o-s)/(c+u)+(o-a)/u,m=(o-a)/u-(l-a)/(u+d)+(l-o)/d;f*=u,m*=u,n(a,o,f,m)},calc:function(s){let a=s*s,o=a*s;return e+t*s+r*a+i*o}}}var dA=new V,s4=new W6,a4=new W6,o4=new W6,tTe=class extends hd{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new V){let r=t,i=this.points,n=i.length,s=(n-(this.closed?0:1))*e,a=Math.floor(s),o=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/n)+1)*n:o===0&&a===n-1&&(a=n-2,o=1);let l,c;this.closed||a>0?l=i[(a-1)%n]:(dA.subVectors(i[0],i[1]).add(i[0]),l=dA);let u=i[a%n],d=i[(a+1)%n];if(this.closed||a+2<n?c=i[(a+2)%n]:(dA.subVectors(i[n-1],i[n-2]).add(i[n-1]),c=dA),this.curveType==="centripetal"||this.curveType==="chordal"){let f=this.curveType==="chordal"?.5:.25,m=Math.pow(l.distanceToSquared(u),f),v=Math.pow(u.distanceToSquared(d),f),y=Math.pow(d.distanceToSquared(c),f);v<1e-4&&(v=1),m<1e-4&&(m=v),y<1e-4&&(y=v),s4.initNonuniformCatmullRom(l.x,u.x,d.x,c.x,m,v,y),a4.initNonuniformCatmullRom(l.y,u.y,d.y,c.y,m,v,y),o4.initNonuniformCatmullRom(l.z,u.z,d.z,c.z,m,v,y)}else this.curveType==="catmullrom"&&(s4.initCatmullRom(l.x,u.x,d.x,c.x,this.tension),a4.initCatmullRom(l.y,u.y,d.y,c.y,this.tension),o4.initCatmullRom(l.z,u.z,d.z,c.z,this.tension));return r.set(s4.calc(o),a4.calc(o),o4.calc(o)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new V().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function uW(e,t,r,i,n){let s=(i-t)*.5,a=(n-r)*.5,o=e*e,l=e*o;return(2*r-2*i+s+a)*l+(-3*r+3*i-2*s-a)*o+s*e+r}function rTe(e,t){let r=1-e;return r*r*t}function iTe(e,t){return 2*(1-e)*e*t}function nTe(e,t){return e*e*t}function Gw(e,t,r,i){return rTe(e,t)+iTe(e,r)+nTe(e,i)}function sTe(e,t){let r=1-e;return r*r*r*t}function aTe(e,t){let r=1-e;return 3*r*r*e*t}function oTe(e,t){return 3*(1-e)*e*e*t}function lTe(e,t){return e*e*e*t}function Ww(e,t,r,i,n){return sTe(e,t)+aTe(e,r)+oTe(e,i)+lTe(e,n)}var Ec=class extends hd{constructor(t=new ge,r=new ge,i=new ge,n=new ge){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=r,this.v2=i,this.v3=n}getPoint(t,r=new ge){let i=r,n=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(Ww(t,n.x,s.x,a.x,o.x),Ww(t,n.y,s.y,a.y,o.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},sT=class extends hd{constructor(e=new V,t=new V,r=new V,i=new V){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new V){let r=t,i=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set(Ww(e,i.x,n.x,s.x,a.x),Ww(e,i.y,n.y,s.y,a.y),Ww(e,i.z,n.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},Nc=class extends hd{constructor(t=new ge,r=new ge){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=r}getPoint(t,r=new ge){let i=r;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,r){return this.getPoint(t,r)}getTangent(t,r){let i=r||new ge;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},Aie=class extends hd{constructor(e=new V,t=new V){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new V){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Ip=class extends hd{constructor(e=new ge,t=new ge,r=new ge){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ge){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Gw(e,i.x,n.x,s.x),Gw(e,i.y,n.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},cTe=class extends hd{constructor(e=new V,t=new V,r=new V){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new V){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Gw(e,i.x,n.x,s.x),Gw(e,i.y,n.y,s.y),Gw(e,i.z,n.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},q6=class extends hd{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ge){let r=t,i=this.points,n=(i.length-1)*e,s=Math.floor(n),a=n-s,o=i[s===0?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],u=i[s>i.length-3?i.length-1:s+2];return r.set(uW(a,o.x,l.x,c.x,u.x),uW(a,o.y,l.y,c.y,u.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new ge().fromArray(i))}return this}},uTe=Object.freeze({__proto__:null,ArcCurve:eTe,CatmullRomCurve3:tTe,CubicBezierCurve:Ec,CubicBezierCurve3:sT,EllipseCurve:D3,LineCurve:Nc,LineCurve3:Aie,QuadraticBezierCurve:Ip,QuadraticBezierCurve3:cTe,SplineCurve:q6}),Cie=class extends hd{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Nc(t,e))}getPoint(e,t){let r=e*this.getLength(),i=this.getCurveLengths(),n=0;for(;n<i.length;){if(i[n]>=r){let s=i[n]-r,a=this.curves[n],o=a.getLength(),l=o===0?0:1-s/o;return a.getPointAt(l,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let i=0,n=this.curves;i<n.length;i++){let s=n[i],a=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,o=s.getPoints(a);for(let l=0;l<o.length;l++){let c=o[l];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(new uTe[i.type]().fromJSON(i))}return this}},lM=class extends Cie{constructor(e){super(),this.type="Path",this.currentPoint=new ge,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new Nc(this.currentPoint.clone(),new ge(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){let n=new Ip(this.currentPoint.clone(),new ge(e,t),new ge(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,n,s){let a=new Ec(this.currentPoint.clone(),new ge(e,t),new ge(r,i),new ge(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new q6(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,n,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,r,i,n,s),this}absarc(e,t,r,i,n,s){return this.absellipse(e,t,r,r,i,n,s),this}ellipse(e,t,r,i,n,s,a,o){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,i,n,s,a,o),this}absellipse(e,t,r,i,n,s,a,o){let l=new D3(e,t,r,i,n,s,a,o);if(this.curves.length>0){let u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},Tie=class extends Lt{constructor(e=[new ge(0,-.5),new ge(.5,0),new ge(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=ns(i,0,Math.PI*2);let n=[],s=[],a=[],o=[],l=[],c=1/t,u=new V,d=new ge,f=new V,m=new V,v=new V,y=0,x=0;for(let w=0;w<=e.length-1;w++)switch(w){case 0:y=e[w+1].x-e[w].x,x=e[w+1].y-e[w].y,f.x=x*1,f.y=-y,f.z=x*0,v.copy(f),f.normalize(),o.push(f.x,f.y,f.z);break;case e.length-1:o.push(v.x,v.y,v.z);break;default:y=e[w+1].x-e[w].x,x=e[w+1].y-e[w].y,f.x=x*1,f.y=-y,f.z=x*0,m.copy(f),f.x+=v.x,f.y+=v.y,f.z+=v.z,f.normalize(),o.push(f.x,f.y,f.z),v.copy(m)}for(let w=0;w<=t;w++){let _=r+w*c*i,S=Math.sin(_),P=Math.cos(_);for(let M=0;M<=e.length-1;M++){u.x=e[M].x*S,u.y=e[M].y,u.z=e[M].x*P,s.push(u.x,u.y,u.z),d.x=w/t,d.y=M/(e.length-1),a.push(d.x,d.y);let C=o[3*M+0]*S,T=o[3*M+1],E=o[3*M+0]*P;l.push(C,T,E)}}for(let w=0;w<t;w++)for(let _=0;_<e.length-1;_++){let S=_+w*e.length,P=S,M=S+e.length,C=S+e.length+1,T=S+1;n.push(P,M,T),n.push(C,T,M)}this.setIndex(n),this.setAttribute("position",new At(s,3)),this.setAttribute("uv",new At(a,2)),this.setAttribute("normal",new At(l,3))}static fromJSON(e){return new Tie(e.points,e.segments,e.phiStart,e.phiLength)}},Y6=class extends Lt{constructor(e=1,t=1,r=1,i=32,n=1,s=!1,a=0,o=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:a,thetaLength:o};let l=this;i=Math.floor(i),n=Math.floor(n);let c=[],u=[],d=[],f=[],m=0,v=[],y=r/2,x=0;w(),s===!1&&(e>0&&_(!0),t>0&&_(!1)),this.setIndex(c),this.setAttribute("position",new At(u,3)),this.setAttribute("normal",new At(d,3)),this.setAttribute("uv",new At(f,2));function w(){let S=new V,P=new V,M=0,C=(t-e)/r;for(let T=0;T<=n;T++){let E=[],N=T/n,D=N*(t-e)+e;for(let I=0;I<=i;I++){let j=I/i,L=j*o+a,B=Math.sin(L),q=Math.cos(L);P.x=D*B,P.y=-N*r+y,P.z=D*q,u.push(P.x,P.y,P.z),S.set(B,C,q).normalize(),d.push(S.x,S.y,S.z),f.push(j,1-N),E.push(m++)}v.push(E)}for(let T=0;T<i;T++)for(let E=0;E<n;E++){let N=v[E][T],D=v[E+1][T],I=v[E+1][T+1],j=v[E][T+1];c.push(N,D,j),c.push(D,I,j),M+=6}l.addGroup(x,M,0),x+=M}function _(S){let P=m,M=new ge,C=new V,T=0,E=S===!0?e:t,N=S===!0?1:-1;for(let I=1;I<=i;I++)u.push(0,y*N,0),d.push(0,N,0),f.push(.5,.5),m++;let D=m;for(let I=0;I<=i;I++){let j=I/i*o+a,L=Math.cos(j),B=Math.sin(j);C.x=E*B,C.y=y*N,C.z=E*L,u.push(C.x,C.y,C.z),d.push(0,N,0),M.x=L*.5+.5,M.y=B*.5*N+.5,f.push(M.x,M.y),m++}for(let I=0;I<i;I++){let j=P+I,L=D+I;S===!0?c.push(L,L+1,j):c.push(L+1,L,j),T+=3}l.addGroup(x,T,S===!0?1:2),x+=T}}static fromJSON(e){return new Y6(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},X6=class extends Y6{constructor(e=1,t=1,r=32,i=1,n=!1,s=0,a=Math.PI*2){super(0,e,t,r,i,n,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:s,thetaLength:a}}static fromJSON(e){return new X6(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},$6=class extends Lt{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};let n=[],s=[];a(i),l(r),c(),this.setAttribute("position",new At(n,3)),this.setAttribute("normal",new At(n.slice(),3)),this.setAttribute("uv",new At(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(w){let _=new V,S=new V,P=new V;for(let M=0;M<t.length;M+=3)f(t[M+0],_),f(t[M+1],S),f(t[M+2],P),o(_,S,P,w)}function o(w,_,S,P){let M=P+1,C=[];for(let T=0;T<=M;T++){C[T]=[];let E=w.clone().lerp(S,T/M),N=_.clone().lerp(S,T/M),D=M-T;for(let I=0;I<=D;I++)I===0&&T===M?C[T][I]=E:C[T][I]=E.clone().lerp(N,I/D)}for(let T=0;T<M;T++)for(let E=0;E<2*(M-T)-1;E++){let N=Math.floor(E/2);E%2===0?(d(C[T][N+1]),d(C[T+1][N]),d(C[T][N])):(d(C[T][N+1]),d(C[T+1][N+1]),d(C[T+1][N]))}}function l(w){let _=new V;for(let S=0;S<n.length;S+=3)_.x=n[S+0],_.y=n[S+1],_.z=n[S+2],_.normalize().multiplyScalar(w),n[S+0]=_.x,n[S+1]=_.y,n[S+2]=_.z}function c(){let w=new V;for(let _=0;_<n.length;_+=3){w.x=n[_+0],w.y=n[_+1],w.z=n[_+2];let S=y(w)/2/Math.PI+.5,P=x(w)/Math.PI+.5;s.push(S,1-P)}m(),u()}function u(){for(let w=0;w<s.length;w+=6){let _=s[w+0],S=s[w+2],P=s[w+4],M=Math.max(_,S,P),C=Math.min(_,S,P);M>.9&&C<.1&&(_<.2&&(s[w+0]+=1),S<.2&&(s[w+2]+=1),P<.2&&(s[w+4]+=1))}}function d(w){n.push(w.x,w.y,w.z)}function f(w,_){let S=w*3;_.x=e[S+0],_.y=e[S+1],_.z=e[S+2]}function m(){let w=new V,_=new V,S=new V,P=new V,M=new ge,C=new ge,T=new ge;for(let E=0,N=0;E<n.length;E+=9,N+=6){w.set(n[E+0],n[E+1],n[E+2]),_.set(n[E+3],n[E+4],n[E+5]),S.set(n[E+6],n[E+7],n[E+8]),M.set(s[N+0],s[N+1]),C.set(s[N+2],s[N+3]),T.set(s[N+4],s[N+5]),P.copy(w).add(_).add(S).divideScalar(3);let D=y(P);v(M,N+0,w,D),v(C,N+2,_,D),v(T,N+4,S,D)}}function v(w,_,S,P){P<0&&w.x===1&&(s[_]=w.x-1),S.x===0&&S.z===0&&(s[_]=P/2/Math.PI+.5)}function y(w){return Math.atan2(w.z,-w.x)}function x(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}static fromJSON(e){return new $6(e.vertices,e.indices,e.radius,e.details)}},Mie=class extends $6{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Mie(e.radius,e.detail)}},cM=class extends lM{constructor(e){super(e),this.uuid=Gl(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(new lM().fromJSON(i))}return this}},dTe={triangulate:function(e,t,r=2){let i=t&&t.length,n=i?t[0]*r:e.length,s=Pie(e,0,n,r,!0),a=[];if(!s||s.next===s.prev)return a;let o,l,c,u,d,f,m;if(i&&(s=gTe(e,t,s,r)),e.length>80*r){o=c=e[0],l=u=e[1];for(let v=r;v<n;v+=r)d=e[v],f=e[v+1],d<o&&(o=d),f<l&&(l=f),d>c&&(c=d),f>u&&(u=f);m=Math.max(c-o,u-l),m=m!==0?32767/m:0}return D2(s,a,r,o,l,m,0),a}};function Pie(e,t,r,i,n){let s,a;if(n===TTe(e,t,r,i)>0)for(s=t;s<r;s+=i)a=dW(s,e[s],e[s+1],a);else for(s=r-i;s>=t;s-=i)a=dW(s,e[s],e[s+1],a);return a&&N3(a,a.next)&&(k2(a),a=a.next),a}function Wg(e,t){if(!e)return e;t||(t=e);let r=e,i;do if(i=!1,!r.steiner&&(N3(r,r.next)||gn(r.prev,r,r.next)===0)){if(k2(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function D2(e,t,r,i,n,s,a){if(!e)return;!a&&s&&wTe(e,i,n,s);let o=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,s?fTe(e,i,n,s):hTe(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(c.i/r|0),k2(e),e=c.next,o=c.next;continue}if(e=c,e===o){a?a===1?(e=pTe(Wg(e),t,r),D2(e,t,r,i,n,s,2)):a===2&&mTe(e,t,r,i,n,s):D2(Wg(e),t,r,i,n,s,1);break}}}function hTe(e){let t=e.prev,r=e,i=e.next;if(gn(t,r,i)>=0)return!1;let n=t.x,s=r.x,a=i.x,o=t.y,l=r.y,c=i.y,u=n<s?n<a?n:a:s<a?s:a,d=o<l?o<c?o:c:l<c?l:c,f=n>s?n>a?n:a:s>a?s:a,m=o>l?o>c?o:c:l>c?l:c,v=i.next;for(;v!==t;){if(v.x>=u&&v.x<=f&&v.y>=d&&v.y<=m&&vy(n,o,s,l,a,c,v.x,v.y)&&gn(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function fTe(e,t,r,i){let n=e.prev,s=e,a=e.next;if(gn(n,s,a)>=0)return!1;let o=n.x,l=s.x,c=a.x,u=n.y,d=s.y,f=a.y,m=o<l?o<c?o:c:l<c?l:c,v=u<d?u<f?u:f:d<f?d:f,y=o>l?o>c?o:c:l>c?l:c,x=u>d?u>f?u:f:d>f?d:f,w=Oj(m,v,t,r,i),_=Oj(y,x,t,r,i),S=e.prevZ,P=e.nextZ;for(;S&&S.z>=w&&P&&P.z<=_;){if(S.x>=m&&S.x<=y&&S.y>=v&&S.y<=x&&S!==n&&S!==a&&vy(o,u,l,d,c,f,S.x,S.y)&&gn(S.prev,S,S.next)>=0||(S=S.prevZ,P.x>=m&&P.x<=y&&P.y>=v&&P.y<=x&&P!==n&&P!==a&&vy(o,u,l,d,c,f,P.x,P.y)&&gn(P.prev,P,P.next)>=0))return!1;P=P.nextZ}for(;S&&S.z>=w;){if(S.x>=m&&S.x<=y&&S.y>=v&&S.y<=x&&S!==n&&S!==a&&vy(o,u,l,d,c,f,S.x,S.y)&&gn(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;P&&P.z<=_;){if(P.x>=m&&P.x<=y&&P.y>=v&&P.y<=x&&P!==n&&P!==a&&vy(o,u,l,d,c,f,P.x,P.y)&&gn(P.prev,P,P.next)>=0)return!1;P=P.nextZ}return!0}function pTe(e,t,r){let i=e;do{let n=i.prev,s=i.next.next;!N3(n,s)&&Die(n,i,i.next,s)&&N2(n,s)&&N2(s,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),k2(i),k2(i.next),i=e=s),i=i.next}while(i!==e);return Wg(i)}function mTe(e,t,r,i,n,s){let a=e;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&ETe(a,o)){let l=Nie(a,o);a=Wg(a,a.next),l=Wg(l,l.next),D2(a,t,r,i,n,s,0),D2(l,t,r,i,n,s,0);return}o=o.next}a=a.next}while(a!==e)}function gTe(e,t,r,i){let n=[],s,a,o,l,c;for(s=0,a=t.length;s<a;s++)o=t[s]*i,l=s<a-1?t[s+1]*i:e.length,c=Pie(e,o,l,i,!1),c===c.next&&(c.steiner=!0),n.push(STe(c));for(n.sort(vTe),s=0;s<n.length;s++)r=yTe(n[s],r);return r}function vTe(e,t){return e.x-t.x}function yTe(e,t){let r=xTe(e,t);if(!r)return t;let i=Nie(r,e);return Wg(i,i.next),Wg(r,r.next)}function xTe(e,t){let r=t,i=-1/0,n,s=e.x,a=e.y;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){let f=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(f<=s&&f>i&&(i=f,n=r.x<r.next.x?r:r.next,f===s))return n}r=r.next}while(r!==t);if(!n)return null;let o=n,l=n.x,c=n.y,u=1/0,d;r=n;do s>=r.x&&r.x>=l&&s!==r.x&&vy(a<c?s:i,a,l,c,a<c?i:s,a,r.x,r.y)&&(d=Math.abs(a-r.y)/(s-r.x),N2(r,e)&&(d<u||d===u&&(r.x>n.x||r.x===n.x&&bTe(n,r)))&&(n=r,u=d)),r=r.next;while(r!==o);return n}function bTe(e,t){return gn(e.prev,e,t.prev)<0&&gn(t.next,e,e.next)<0}function wTe(e,t,r,i){let n=e;do n.z===0&&(n.z=Oj(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,_Te(n)}function _Te(e){let t,r,i,n,s,a,o,l,c=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,i=r,o=0,t=0;t<c&&(o++,i=i.nextZ,!!i);t++);for(l=c;o>0||l>0&&i;)o!==0&&(l===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,o--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,c*=2}while(a>1);return e}function Oj(e,t,r,i,n){return e=(e-r)*n|0,t=(t-i)*n|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function STe(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function vy(e,t,r,i,n,s,a,o){return(n-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(i-o)>=(r-a)*(t-o)&&(r-a)*(s-o)>=(n-a)*(i-o)}function ETe(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!ATe(e,t)&&(N2(e,t)&&N2(t,e)&&CTe(e,t)&&(gn(e.prev,e,t.prev)||gn(e,t.prev,t))||N3(e,t)&&gn(e.prev,e,e.next)>0&&gn(t.prev,t,t.next)>0)}function gn(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function N3(e,t){return e.x===t.x&&e.y===t.y}function Die(e,t,r,i){let n=fA(gn(e,t,r)),s=fA(gn(e,t,i)),a=fA(gn(r,i,e)),o=fA(gn(r,i,t));return!!(n!==s&&a!==o||n===0&&hA(e,r,t)||s===0&&hA(e,i,t)||a===0&&hA(r,e,i)||o===0&&hA(r,t,i))}function hA(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function fA(e){return e>0?1:e<0?-1:0}function ATe(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Die(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function N2(e,t){return gn(e.prev,e,e.next)<0?gn(e,t,e.next)>=0&&gn(e,e.prev,t)>=0:gn(e,t,e.prev)<0||gn(e,e.next,t)<0}function CTe(e,t){let r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function Nie(e,t){let r=new jj(e.i,e.x,e.y),i=new jj(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function dW(e,t,r,i){let n=new jj(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function k2(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function jj(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function TTe(e,t,r,i){let n=0;for(let s=t,a=r-i;s<r;s+=i)n+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return n}var kie=class{static area(e){let t=e.length,r=0;for(let i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return r*.5}static isClockWise(e){return kie.area(e)<0}static triangulateShape(e,t){let r=[],i=[],n=[];hW(e),fW(r,e);let s=e.length;t.forEach(hW);for(let o=0;o<t.length;o++)i.push(s),s+=t[o].length,fW(r,t[o]);let a=dTe.triangulate(r,i);for(let o=0;o<a.length;o+=3)n.push(a.slice(o,o+3));return n}};function hW(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function fW(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var Rie=class extends $6{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,n,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Rie(e.radius,e.detail)}},ky=class extends Lt{constructor(e=1,t=32,r=16,i=0,n=Math.PI*2,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let o=Math.min(s+a,Math.PI),l=0,c=[],u=new V,d=new V,f=[],m=[],v=[],y=[];for(let x=0;x<=r;x++){let w=[],_=x/r,S=0;x==0&&s==0?S=.5/t:x==r&&o==Math.PI&&(S=-.5/t);for(let P=0;P<=t;P++){let M=P/t;u.x=-e*Math.cos(i+M*n)*Math.sin(s+_*a),u.y=e*Math.cos(s+_*a),u.z=e*Math.sin(i+M*n)*Math.sin(s+_*a),m.push(u.x,u.y,u.z),d.copy(u).normalize(),v.push(d.x,d.y,d.z),y.push(M+S,1-_),w.push(l++)}c.push(w)}for(let x=0;x<r;x++)for(let w=0;w<t;w++){let _=c[x][w+1],S=c[x][w],P=c[x+1][w],M=c[x+1][w+1];(x!==0||s>0)&&f.push(_,S,M),(x!==r-1||o<Math.PI)&&f.push(S,P,M)}this.setIndex(f),this.setAttribute("position",new At(m,3)),this.setAttribute("normal",new At(v,3)),this.setAttribute("uv",new At(y,2))}static fromJSON(e){return new ky(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},Iie=class extends Lt{constructor(e=1,t=.4,r=12,i=48,n=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:n},r=Math.floor(r),i=Math.floor(i);let s=[],a=[],o=[],l=[],c=new V,u=new V,d=new V;for(let f=0;f<=r;f++)for(let m=0;m<=i;m++){let v=m/i*n,y=f/r*Math.PI*2;u.x=(e+t*Math.cos(y))*Math.cos(v),u.y=(e+t*Math.cos(y))*Math.sin(v),u.z=t*Math.sin(y),a.push(u.x,u.y,u.z),c.x=e*Math.cos(v),c.y=e*Math.sin(v),d.subVectors(u,c).normalize(),o.push(d.x,d.y,d.z),l.push(m/i),l.push(f/r)}for(let f=1;f<=r;f++)for(let m=1;m<=i;m++){let v=(i+1)*f+m-1,y=(i+1)*(f-1)+m-1,x=(i+1)*(f-1)+m,w=(i+1)*f+m;s.push(v,y,w),s.push(y,x,w)}this.setIndex(s),this.setAttribute("position",new At(a,3)),this.setAttribute("normal",new At(o,3)),this.setAttribute("uv",new At(l,2))}static fromJSON(e){return new Iie(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},Oie=class extends Lt{constructor(e=1,t=.4,r=64,i=8,n=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:s},r=Math.floor(r),i=Math.floor(i);let a=[],o=[],l=[],c=[],u=new V,d=new V,f=new V,m=new V,v=new V,y=new V,x=new V;for(let _=0;_<=r;++_){let S=_/r*n*Math.PI*2;w(S,n,s,e,f),w(S+.01,n,s,e,m),y.subVectors(m,f),x.addVectors(m,f),v.crossVectors(y,x),x.crossVectors(v,y),v.normalize(),x.normalize();for(let P=0;P<=i;++P){let M=P/i*Math.PI*2,C=-t*Math.cos(M),T=t*Math.sin(M);u.x=f.x+(C*x.x+T*v.x),u.y=f.y+(C*x.y+T*v.y),u.z=f.z+(C*x.z+T*v.z),o.push(u.x,u.y,u.z),d.subVectors(u,f).normalize(),l.push(d.x,d.y,d.z),c.push(_/r),c.push(P/i)}}for(let _=1;_<=r;_++)for(let S=1;S<=i;S++){let P=(i+1)*(_-1)+(S-1),M=(i+1)*_+(S-1),C=(i+1)*_+S,T=(i+1)*(_-1)+S;a.push(P,M,T),a.push(M,C,T)}this.setIndex(a),this.setAttribute("position",new At(o,3)),this.setAttribute("normal",new At(l,3)),this.setAttribute("uv",new At(c,2));function w(_,S,P,M,C){let T=Math.cos(_),E=Math.sin(_),N=P/S*_,D=Math.cos(N);C.x=M*(2+D)*.5*T,C.y=M*(2+D)*E*.5,C.z=M*Math.sin(N)*.5}}static fromJSON(e){return new Oie(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},MTe=class extends Jr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}};function Pf(e,t,r){return jie(e)?new e.constructor(e.subarray(t,r!==void 0?r:e.length)):e.slice(t,r)}function pA(e,t,r){return!e||e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function jie(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function PTe(e){function t(n,s){return e[n]-e[s]}let r=e.length,i=new Array(r);for(let n=0;n!==r;++n)i[n]=n;return i.sort(t),i}function pW(e,t,r){let i=e.length,n=new e.constructor(i);for(let s=0,a=0;a!==i;++s){let o=r[s]*t;for(let l=0;l!==t;++l)n[a++]=e[o+l]}return n}function Lie(e,t,r,i){let n=1,s=e[0];for(;s!==void 0&&s[i]===void 0;)s=e[n++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(t.push(s.time),r.push.apply(r,a)),s=e[n++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(t.push(s.time),a.toArray(r,r.length)),s=e[n++];while(s!==void 0);else do a=s[i],a!==void 0&&(t.push(s.time),r.push(a)),s=e[n++];while(s!==void 0)}var k3=class{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,i=t[r],n=t[r-1];e:{t:{let s;r:{i:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<n)break i;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(n=i,i=t[++r],e<i)break t}s=t.length;break r}if(!(e>=n)){let a=t[1];e<a&&(r=2,n=a);for(let o=r-2;;){if(n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===o)break;if(i=n,n=t[--r-1],e>=n)break t}s=r,r=0;break r}break e}for(;r<s;){let a=r+s>>>1;e<t[a]?s=a:r=a+1}if(i=t[r],n=t[r-1],n===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i;for(let s=0;s!==i;++s)t[s]=r[n+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},DTe=class extends k3{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:py,endingEnd:py}}intervalChanged_(e,t,r){let i=this.parameterPositions,n=e-2,s=e+1,a=i[n],o=i[s];if(a===void 0)switch(this.getSettings_().endingStart){case my:n=e,a=2*t-r;break;case nM:n=i.length-2,a=t+i[n]-i[n+1];break;default:n=e,a=r}if(o===void 0)switch(this.getSettings_().endingEnd){case my:s=e,o=2*r-t;break;case nM:s=1,o=r+i[1]-i[0];break;default:s=e-1,o=t}let l=(r-t)*.5,c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-r),this._offsetPrev=n*c,this._offsetNext=s*c}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,f=this._weightNext,m=(r-t)/(i-t),v=m*m,y=v*m,x=-d*y+2*d*v-d*m,w=(1+d)*y+(-1.5-2*d)*v+(-.5+d)*m+1,_=(-1-f)*y+(1.5+f)*v+.5*m,S=f*y-f*v;for(let P=0;P!==a;++P)n[P]=x*s[c+P]+w*s[l+P]+_*s[o+P]+S*s[u+P];return n}},zie=class extends k3{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(r-t)/(i-t),u=1-c;for(let d=0;d!==a;++d)n[d]=s[l+d]*u+s[o+d]*c;return n}},NTe=class extends k3{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}},fd=class{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=pA(t,this.TimeBufferType),this.values=pA(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:pA(e.times,Array),values:pA(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new NTe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new zie(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new DTe(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case rM:t=this.InterpolantFactoryMethodDiscrete;break;case iM:t=this.InterpolantFactoryMethodLinear;break;case kR:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return rM;case this.InterpolantFactoryMethodLinear:return iM;case this.InterpolantFactoryMethodSmooth:return kR}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){let r=this.times,i=r.length,n=0,s=i-1;for(;n!==i&&r[n]<e;)++n;for(;s!==-1&&r[s]>t;)--s;if(++s,n!==0||s!==i){n>=s&&(s=Math.max(s,1),n=s-1);let a=this.getValueSize();this.times=Pf(r,n,s),this.values=Pf(this.values,n*a,s*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,i=this.values,n=r.length;n===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==n;a++){let o=r[a];if(typeof o=="number"&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,o),e=!1;break}if(s!==null&&s>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,o,s),e=!1;break}s=o}if(i!==void 0&&jie(i))for(let a=0,o=i.length;a!==o;++a){let l=i[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=Pf(this.times),t=Pf(this.values),r=this.getValueSize(),i=this.getInterpolation()===kR,n=e.length-1,s=1;for(let a=1;a<n;++a){let o=!1,l=e[a],c=e[a+1];if(l!==c&&(a!==1||l!==e[0]))if(i)o=!0;else{let u=a*r,d=u-r,f=u+r;for(let m=0;m!==r;++m){let v=t[u+m];if(v!==t[d+m]||v!==t[f+m]){o=!0;break}}}if(o){if(a!==s){e[s]=e[a];let u=a*r,d=s*r;for(let f=0;f!==r;++f)t[d+f]=t[u+f]}++s}}if(n>0){e[s]=e[n];for(let a=n*r,o=s*r,l=0;l!==r;++l)t[o+l]=t[a+l];++s}return s!==e.length?(this.times=Pf(e,0,s),this.values=Pf(t,0,s*r)):(this.times=e,this.values=t),this}clone(){let e=Pf(this.times,0),t=Pf(this.values,0),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}};fd.prototype.TimeBufferType=Float32Array;fd.prototype.ValueBufferType=Float32Array;fd.prototype.DefaultInterpolation=iM;var Xx=class extends fd{};Xx.prototype.ValueTypeName="bool";Xx.prototype.ValueBufferType=Array;Xx.prototype.DefaultInterpolation=rM;Xx.prototype.InterpolantFactoryMethodLinear=void 0;Xx.prototype.InterpolantFactoryMethodSmooth=void 0;var Bie=class extends fd{};Bie.prototype.ValueTypeName="color";var uM=class extends fd{};uM.prototype.ValueTypeName="number";var kTe=class extends k3{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){let n=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(r-t)/(i-t),l=e*a;for(let c=l+a;l!==c;l+=4)ar.slerpFlat(n,0,s,l-a,s,l,o);return n}},I_=class extends fd{InterpolantFactoryMethodLinear(e){return new kTe(this.times,this.values,this.getValueSize(),e)}};I_.prototype.ValueTypeName="quaternion";I_.prototype.DefaultInterpolation=iM;I_.prototype.InterpolantFactoryMethodSmooth=void 0;var $x=class extends fd{};$x.prototype.ValueTypeName="string";$x.prototype.ValueBufferType=Array;$x.prototype.DefaultInterpolation=rM;$x.prototype.InterpolantFactoryMethodLinear=void 0;$x.prototype.InterpolantFactoryMethodSmooth=void 0;var dM=class extends fd{};dM.prototype.ValueTypeName="vector";var Lj=class{constructor(e,t=-1,r,i=z6){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Gl(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,i=1/(e.fps||1);for(let s=0,a=r.length;s!==a;++s)t.push(ITe(r[s]).scale(i));let n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){let t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let n=0,s=r.length;n!==s;++n)t.push(fd.toJSON(r[n]));return i}static CreateFromMorphTargetSequence(e,t,r,i){let n=t.length,s=[];for(let a=0;a<n;a++){let o=[],l=[];o.push((a+n-1)%n,a,(a+1)%n),l.push(0,1,0);let c=PTe(o);o=pW(o,1,c),l=pW(l,1,c),!i&&o[0]===0&&(o.push(n),l.push(l[0])),s.push(new uM(".morphTargetInfluences["+t[a].name+"]",o,l).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let i={},n=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){let l=e[a],c=l.name.match(n);if(c&&c.length>1){let u=c[1],d=i[u];d||(i[u]=d=[]),d.push(l)}}let s=[];for(let a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(c,u,d,f,m){if(d.length!==0){let v=[],y=[];Lie(d,v,y,f),v.length!==0&&m.push(new c(u,v,y))}},i=[],n=e.name||"default",s=e.fps||30,a=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let u=l[c].keys;if(!(!u||u.length===0))if(u[0].morphTargets){let d={},f;for(f=0;f<u.length;f++)if(u[f].morphTargets)for(let m=0;m<u[f].morphTargets.length;m++)d[u[f].morphTargets[m]]=-1;for(let m in d){let v=[],y=[];for(let x=0;x!==u[f].morphTargets.length;++x){let w=u[f];v.push(w.time),y.push(w.morphTarget===m?1:0)}i.push(new uM(".morphTargetInfluence["+m+"]",v,y))}o=d.length*s}else{let d=".bones["+t[c].name+"]";r(dM,d+".position",u,"pos",i),r(I_,d+".quaternion",u,"rot",i),r(dM,d+".scale",u,"scl",i)}}return i.length===0?null:new this(n,o,i,a)}resetDuration(){let e=this.tracks,t=0;for(let r=0,i=e.length;r!==i;++r){let n=this.tracks[r];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function RTe(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return uM;case"vector":case"vector2":case"vector3":case"vector4":return dM;case"color":return Bie;case"quaternion":return I_;case"bool":case"boolean":return Xx;case"string":return $x}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function ITe(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=RTe(e.type);if(e.times===void 0){let r=[],i=[];Lie(e.keys,r,i,"value"),e.times=r,e.values=i}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var hM={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Fie=class{constructor(e,t,r){let i=this,n=!1,s=0,a=0,o,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){a++,n===!1&&i.onStart!==void 0&&i.onStart(c,s,a),n=!0},this.itemEnd=function(c){s++,i.onProgress!==void 0&&i.onProgress(c,s,a),s===a&&(n=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return o?o(c):c},this.setURLModifier=function(c){return o=c,this},this.addHandler=function(c,u){return l.push(c,u),this},this.removeHandler=function(c){let u=l.indexOf(c);return u!==-1&&l.splice(u,2),this},this.getHandler=function(c){for(let u=0,d=l.length;u<d;u+=2){let f=l[u],m=l[u+1];if(f.global&&(f.lastIndex=0),f.test(c))return m}return null}}},OTe=new Fie,O_=class{constructor(e){this.manager=e!==void 0?e:OTe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(i,n){r.load(e,i,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},Ud={},jTe=class extends Error{constructor(e,t){super(e),this.response=t}},zj=class extends O_{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=hM.get(e);if(n!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(Ud[e]!==void 0){Ud[e].push({onLoad:t,onProgress:r,onError:i});return}Ud[e]=[],Ud[e].push({onLoad:t,onProgress:r,onError:i});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=Ud[e],u=l.body.getReader(),d=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),f=d?parseInt(d):0,m=f!==0,v=0,y=new ReadableStream({start(x){w();function w(){u.read().then(({done:_,value:S})=>{if(_)x.close();else{v+=S.byteLength;let P=new ProgressEvent("progress",{lengthComputable:m,loaded:v,total:f});for(let M=0,C=c.length;M<C;M++){let T=c[M];T.onProgress&&T.onProgress(P)}x.enqueue(S),w()}})}}});return new Response(y)}else throw new jTe(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(o){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return l.json();default:if(a===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(a),u=c&&c[1]?c[1].toLowerCase():void 0,d=new TextDecoder(u);return l.arrayBuffer().then(f=>d.decode(f))}}}).then(l=>{hM.add(e,l);let c=Ud[e];delete Ud[e];for(let u=0,d=c.length;u<d;u++){let f=c[u];f.onLoad&&f.onLoad(l)}}).catch(l=>{let c=Ud[e];if(c===void 0)throw this.manager.itemError(e),l;delete Ud[e];for(let u=0,d=c.length;u<d;u++){let f=c[u];f.onError&&f.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},LTe=class extends O_{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,s=hM.get(e);if(s!==void 0)return n.manager.itemStart(e),setTimeout(function(){t&&t(s),n.manager.itemEnd(e)},0),s;let a=M2("img");function o(){c(),hM.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(u){c(),i&&i(u),n.manager.itemError(e),n.manager.itemEnd(e)}function c(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),n.manager.itemStart(e),a.src=e,a}},zTe=class extends O_{constructor(e){super(e)}load(e,t,r,i){let n=new yn,s=new LTe(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){n.image=a,n.needsUpdate=!0,t!==void 0&&t(n)},r,i),n}},j_=class extends Ei{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Zt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},BTe=class extends j_{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Ei.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Zt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},l4=new ot,mW=new V,gW=new V,K6=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ge(512,512),this.map=null,this.mapPass=null,this.matrix=new ot,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new U6,this._frameExtents=new ge(1,1),this._viewportCount=1,this._viewports=[new fr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;mW.setFromMatrixPosition(e.matrixWorld),t.position.copy(mW),gW.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(gW),t.updateMatrixWorld(),l4.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(l4),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(l4)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},FTe=class extends K6{constructor(){super(new Ra(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=T2*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(r!==t.fov||i!==t.aspect||n!==t.far)&&(t.fov=r,t.aspect=i,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},VTe=class extends j_{constructor(e,t,r=0,i=Math.PI/3,n=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Ei.DEFAULT_UP),this.updateMatrix(),this.target=new Ei,this.distance=r,this.angle=i,this.penumbra=n,this.decay=s,this.map=null,this.shadow=new FTe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},vW=new ot,O1=new V,c4=new V,UTe=class extends K6{constructor(){super(new Ra(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ge(4,2),this._viewportCount=6,this._viewports=[new fr(2,1,1,1),new fr(0,1,1,1),new fr(3,1,1,1),new fr(1,1,1,1),new fr(3,0,1,1),new fr(1,0,1,1)],this._cubeDirections=[new V(1,0,0),new V(-1,0,0),new V(0,0,1),new V(0,0,-1),new V(0,1,0),new V(0,-1,0)],this._cubeUps=[new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,1,0),new V(0,0,1),new V(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,i=this.matrix,n=e.distance||r.far;n!==r.far&&(r.far=n,r.updateProjectionMatrix()),O1.setFromMatrixPosition(e.matrixWorld),r.position.copy(O1),c4.copy(r.position),c4.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(c4),r.updateMatrixWorld(),i.makeTranslation(-O1.x,-O1.y,-O1.z),vW.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vW)}},HTe=class extends j_{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new UTe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},GTe=class extends K6{constructor(){super(new M3(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},WTe=class extends j_{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Ei.DEFAULT_UP),this.updateMatrix(),this.target=new Ei,this.shadow=new GTe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},Vie=class extends Lt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},Uie=class extends O_{constructor(e){super(e)}load(e,t,r,i){let n=this,s=new zj(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,function(a){try{t(n.parse(JSON.parse(a)))}catch(o){i?i(o):console.error(o),n.manager.itemError(e)}},r,i)}parse(e){let t={},r={};function i(d,f){if(t[f]!==void 0)return t[f];let m=d.interleavedBuffers[f],v=n(d,m.buffer),y=GE(m.type,v),x=new XCe(y,m.stride);return x.uuid=m.uuid,t[f]=x,x}function n(d,f){if(r[f]!==void 0)return r[f];let m=d.arrayBuffers[f],v=new Uint32Array(m).buffer;return r[f]=v,v}let s=e.isInstancedBufferGeometry?new Vie:new Lt,a=e.data.index;if(a!==void 0){let d=GE(a.type,a.array);s.setIndex(new Jt(d,1))}let o=e.data.attributes;for(let d in o){let f=o[d],m;if(f.isInterleavedBufferAttribute){let v=i(e.data,f.data);m=new Ij(v,f.itemSize,f.offset,f.normalized)}else{let v=GE(f.type,f.array),y=f.isInstancedBufferAttribute?P2:Jt;m=new y(v,f.itemSize,f.normalized)}f.name!==void 0&&(m.name=f.name),f.usage!==void 0&&m.setUsage(f.usage),f.updateRange!==void 0&&(m.updateRange.offset=f.updateRange.offset,m.updateRange.count=f.updateRange.count),s.setAttribute(d,m)}let l=e.data.morphAttributes;if(l)for(let d in l){let f=l[d],m=[];for(let v=0,y=f.length;v<y;v++){let x=f[v],w;if(x.isInterleavedBufferAttribute){let _=i(e.data,x.data);w=new Ij(_,x.itemSize,x.offset,x.normalized)}else{let _=GE(x.type,x.array);w=new Jt(_,x.itemSize,x.normalized)}x.name!==void 0&&(w.name=x.name),m.push(w)}s.morphAttributes[d]=m}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let d=0,f=c.length;d!==f;++d){let m=c[d];s.addGroup(m.start,m.count,m.materialIndex)}let u=e.data.boundingSphere;if(u!==void 0){let d=new V;u.center!==void 0&&d.fromArray(u.center),s.boundingSphere=new Oo(d,u.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}},qTe=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=yW(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=yW();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function yW(){return(typeof performance>"u"?Date:performance).now()}var YTe=class{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,n,s;switch(t){case"quaternion":i=this._slerp,n=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,n=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,n=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=n,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let r=this.buffer,i=this.valueSize,n=e*i+i,s=this.cumulativeWeight;if(s===0){for(let a=0;a!==i;++a)r[n+a]=r[a];s=t}else{s+=t;let a=t/s;this._mixBufferRegion(r,n,0,a,i)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,i=e*t+t,n=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let o=t*this._origIndex;this._mixBufferRegion(r,i,o,1-n,t)}s>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(r[o]!==r[o+t]){a.setValue(r,i);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let n=r,s=i;n!==s;++n)t[n]=t[i+n%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,n){if(i>=.5)for(let s=0;s!==n;++s)e[t+s]=e[r+s]}_slerp(e,t,r,i){ar.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,n){let s=this._workIndex*n;ar.multiplyQuaternionsFlat(e,s,e,t,e,r),ar.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,r,i,n){let s=1-i;for(let a=0;a!==n;++a){let o=t+a;e[o]=e[o]*s+e[r+a]*i}}_lerpAdditive(e,t,r,i,n){for(let s=0;s!==n;++s){let a=t+s;e[a]=e[a]+e[r+s]*i}}},Q6="\\[\\]\\.:\\/",XTe=new RegExp("["+Q6+"]","g"),Z6="[^"+Q6+"]",$Te="[^"+Q6.replace("\\.","")+"]",KTe=/((?:WC+[\/:])*)/.source.replace("WC",Z6),QTe=/(WCOD+)?/.source.replace("WCOD",$Te),ZTe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Z6),JTe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Z6),eMe=new RegExp("^"+KTe+QTe+ZTe+JTe+"$"),tMe=["material","materials","bones","map"],rMe=class{constructor(e,t,r){let i=r||Bi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},Bi=class{constructor(e,t,r){this.path=t,this.parsedPath=r||Bi.parseTrackName(t),this.node=Bi.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Bi.Composite(e,t,r):new Bi(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(XTe,"")}static parseTrackName(e){let t=eMe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){let n=r.nodeName.substring(i+1);tMe.indexOf(n)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=n)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=function(n){for(let s=0;s<n.length;s++){let a=n[s];if(a.name===t||a.uuid===t)return a;let o=r(a.children);if(o)return o}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,i=t.propertyName,n=t.propertyIndex;if(e||(e=Bi.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let l=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===l){l=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let s=e[i];if(s===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(n!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[n]!==void 0&&(n=e.morphTargetDictionary[n])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else s.fromArray!==void 0&&s.toArray!==void 0?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};Bi.Composite=rMe;Bi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Bi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Bi.prototype.GetterByBindingType=[Bi.prototype._getValue_direct,Bi.prototype._getValue_array,Bi.prototype._getValue_arrayElement,Bi.prototype._getValue_toArray];Bi.prototype.SetterByBindingTypeAndVersioning=[[Bi.prototype._setValue_direct,Bi.prototype._setValue_direct_setNeedsUpdate,Bi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Bi.prototype._setValue_array,Bi.prototype._setValue_array_setNeedsUpdate,Bi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Bi.prototype._setValue_arrayElement,Bi.prototype._setValue_arrayElement_setNeedsUpdate,Bi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Bi.prototype._setValue_fromArray,Bi.prototype._setValue_fromArray_setNeedsUpdate,Bi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var iMe=class{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;let n=t.tracks,s=n.length,a=new Array(s),o={endingStart:py,endingEnd:py};for(let l=0;l!==s;++l){let c=n[l].createInterpolant(null);a[l]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=sie,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){let i=this._clip.duration,n=e._clip.duration,s=n/i,a=i/n;e.warp(1,s,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let i=this._mixer,n=i.time,s=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=n,o[1]=n+r,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}let n=this._startTime;if(n!==null){let o=(e-n)*r;o<0||r===0?t=0:(this._startTime=null,t=r*o)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let o=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case k2e:for(let c=0,u=o.length;c!==u;++c)o[c].evaluate(s),l[c].accumulateAdditive(a);break;case z6:default:for(let c=0,u=o.length;c!==u;++c)o[c].evaluate(s),l[c].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;if(r!==null){let i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,i=this.time+e,n=this._loopCount,s=r===L6;if(e===0)return n===-1?i:s&&(n&1)===1?t-i:i;if(r===nie){n===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(n===-1&&(e>=0?(n=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),i>=t||i<0){let a=Math.floor(i/t);i-=t*a,n+=Math.abs(a);let o=this.repetitions-n;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(o===1){let l=e<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=n,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(s&&(n&1)===1)return t-i}return i}_setEndings(e,t,r){let i=this._interpolantSettings;r?(i.endingStart=my,i.endingEnd=my):(e?i.endingStart=this.zeroSlopeAtStart?my:py:i.endingStart=nM,t?i.endingEnd=this.zeroSlopeAtEnd?my:py:i.endingEnd=nM)}_scheduleFading(e,t,r){let i=this._mixer,n=i.time,s=this._weightInterpolant;s===null&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=n,o[0]=t,a[1]=n+e,o[1]=r,this}},nMe=new Float32Array(1),sMe=class extends wa{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let r=e._localRoot||this._root,i=e._clip.tracks,n=i.length,s=e._propertyBindings,a=e._interpolants,o=r.uuid,l=this._bindingsByRootAndName,c=l[o];c===void 0&&(c={},l[o]=c);for(let u=0;u!==n;++u){let d=i[u],f=d.name,m=c[f];if(m!==void 0)++m.referenceCount,s[u]=m;else{if(m=s[u],m!==void 0){m._cacheIndex===null&&(++m.referenceCount,this._addInactiveBinding(m,o,f));continue}let v=t&&t._propertyBindings[u].binding.parsedPath;m=new YTe(Bi.create(r,f,v),d.ValueTypeName,d.getValueSize()),++m.referenceCount,this._addInactiveBinding(m,o,f),s[u]=m}a[u].resultBuffer=m.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let r=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,r)}let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];n.useCount++===0&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.useCount===0&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){let i=this._actions,n=this._actionsByClip,s=n[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=s;else{let a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;let n=e._clip.uuid,s=this._actionsByClip,a=s[n],o=a.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;let u=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete u[d],o.length===0&&delete s[n],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){let n=t[r];--n.referenceCount===0&&this._removeInactiveBinding(n)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_addInactiveBinding(e,t,r){let i=this._bindingsByRootAndName,n=this._bindings,s=i[t];s===void 0&&(s={},i[t]=s),s[r]=e,e._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,i=r.rootNode.uuid,n=r.path,s=this._bindingsByRootAndName,a=s[i],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[n],Object.keys(a).length===0&&delete s[i]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return r===void 0&&(r=new zie(new Float32Array(2),new Float32Array(2),1,nMe),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,n=t[i];e.__cacheIndex=i,t[i]=e,n.__cacheIndex=r,t[r]=n}clipAction(e,t,r){let i=t||this._root,n=i.uuid,s=typeof e=="string"?Lj.findByName(i,e):e,a=s!==null?s.uuid:e,o=this._actionsByClip[a],l=null;if(r===void 0&&(s!==null?r=s.blendMode:r=z6),o!==void 0){let u=o.actionByRoot[n];if(u!==void 0&&u.blendMode===r)return u;l=o.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let c=new iMe(this,s,t,r);return this._bindAction(c,l),this._addInactiveAction(c,a,n),c}existingAction(e,t){let r=t||this._root,i=r.uuid,n=typeof e=="string"?Lj.findByName(r,e):e,s=n?n.uuid:e,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,i=this.time+=e,n=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==r;++l)t[l]._update(i,e,n,s);let a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,i=this._actionsByClip,n=i[r];if(n!==void 0){let s=n.knownActions;for(let a=0,o=s.length;a!==o;++a){let l=s[a];this._deactivateAction(l);let c=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,t[c]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let s in r){let a=r[s].actionByRoot,o=a[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}let i=this._bindingsByRootAndName,n=i[t];if(n!==void 0)for(let s in n){let a=n[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){let r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}},it=class{constructor(e){this.value=e}clone(){return new it(this.value.clone===void 0?this.value:this.value.clone())}},Hie=class{constructor(e,t,r=0,i=1/0){this.ray=new Wx(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new F6,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return Bj(e,this,r,t),r.sort(xW),r}intersectObjects(e,t=!0,r=[]){for(let i=0,n=e.length;i<n;i++)Bj(e[i],this,r,t);return r.sort(xW),r}};function xW(e,t){return e.distance-t.distance}function Bj(e,t,r,i){if(e.layers.test(t.layers)&&e.raycast(t,r),i===!0){let n=e.children;for(let s=0,a=n.length;s<a;s++)Bj(n[s],t,r,!0)}}var bW=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(ns(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},wW=new ge,J6=class{constructor(e=new ge(1/0,1/0),t=new ge(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=wW.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return wW.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},_W=new V,mA=new V,Wl=class{constructor(e=new V,t=new V){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){_W.subVectors(e,this.start),mA.subVectors(this.end,this.start);let r=mA.dot(mA),i=mA.dot(_W)/r;return t&&(i=ns(i,0,1)),i}closestPointToPoint(e,t,r){let i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},SW=new V,aMe=class extends Ei{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let r=new Lt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let l=s/o*Math.PI*2,c=a/o*Math.PI*2;i.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}r.setAttribute("position",new At(i,3));let n=new tm({fog:!1,toneMapped:!1});this.cone=new R_(r,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),SW.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(SW),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},oMe=class extends Yi{constructor(e,t,r){let i=new ky(t,4,2),n=new Ih({wireframe:!0,fog:!1,toneMapped:!1});super(i,n),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},EW=new V,gA=new V,AW=new V,lMe=class extends Ei{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Lt;i.setAttribute("position",new At([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let n=new tm({fog:!1,toneMapped:!1});this.lightPlane=new oM(i,n),this.add(this.lightPlane),i=new Lt,i.setAttribute("position",new At([0,0,0,0,0,1],3)),this.targetLine=new oM(i,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),EW.setFromMatrixPosition(this.light.matrixWorld),gA.setFromMatrixPosition(this.light.target.matrixWorld),AW.subVectors(gA,EW),this.lightPlane.lookAt(gA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(gA),this.targetLine.scale.z=AW.length()}},vA=new V,En=new em,fM=class extends R_{constructor(e){let t=new Lt,r=new tm({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(m,v){o(m),o(v)}function o(m){i.push(0,0,0),n.push(0,0,0),s[m]===void 0&&(s[m]=[]),s[m].push(i.length/3-1)}t.setAttribute("position",new At(i,3)),t.setAttribute("color",new At(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new Zt(16755200),c=new Zt(16711680),u=new Zt(43775),d=new Zt(16777215),f=new Zt(3355443);this.setColors(l,c,u,d,f)}setColors(e,t,r,i,n){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,r.r,r.g,r.b),s.setXYZ(33,r.r,r.g,r.b),s.setXYZ(34,r.r,r.g,r.b),s.setXYZ(35,r.r,r.g,r.b),s.setXYZ(36,r.r,r.g,r.b),s.setXYZ(37,r.r,r.g,r.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,n.r,n.g,n.b),s.setXYZ(41,n.r,n.g,n.b),s.setXYZ(42,n.r,n.g,n.b),s.setXYZ(43,n.r,n.g,n.b),s.setXYZ(44,n.r,n.g,n.b),s.setXYZ(45,n.r,n.g,n.b),s.setXYZ(46,n.r,n.g,n.b),s.setXYZ(47,n.r,n.g,n.b),s.setXYZ(48,n.r,n.g,n.b),s.setXYZ(49,n.r,n.g,n.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,r=1,i=1;En.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),In("c",t,e,En,0,0,-1),In("t",t,e,En,0,0,1),In("n1",t,e,En,-r,-i,-1),In("n2",t,e,En,r,-i,-1),In("n3",t,e,En,-r,i,-1),In("n4",t,e,En,r,i,-1),In("f1",t,e,En,-r,-i,1),In("f2",t,e,En,r,-i,1),In("f3",t,e,En,-r,i,1),In("f4",t,e,En,r,i,1),In("u1",t,e,En,r*.7,i*1.1,-1),In("u2",t,e,En,-r*.7,i*1.1,-1),In("u3",t,e,En,0,i*2,-1),In("cf1",t,e,En,-r,0,1),In("cf2",t,e,En,r,0,1),In("cf3",t,e,En,0,-i,1),In("cf4",t,e,En,0,i,1),In("cn1",t,e,En,-r,0,-1),In("cn2",t,e,En,r,0,-1),In("cn3",t,e,En,0,-i,-1),In("cn4",t,e,En,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function In(e,t,r,i,n,s,a){vA.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],vA.x,vA.y,vA.z)}}var pM=class extends R_{constructor(e,t=16776960){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],n=new Lt;n.setIndex(new Jt(r,1)),n.setAttribute("position",new At(i,3)),super(n,new tm({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},cMe=class extends R_{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Lt;i.setAttribute("position",new At(t,3)),i.setAttribute("color",new At(r,3));let n=new tm({vertexColors:!0,toneMapped:!1});super(i,n),this.type="AxesHelper"}setColors(e,t,r){let i=new Zt,n=this.geometry.attributes.color.array;return i.set(e),i.toArray(n,0),i.toArray(n,3),i.set(t),i.toArray(n,6),i.toArray(n,9),i.set(r),i.toArray(n,12),i.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},lh=uMe();function uMe(){let e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),i=new Uint32Array(512),n=new Uint32Array(512);for(let l=0;l<256;++l){let c=l-127;c<-27?(i[l]=0,i[l|256]=32768,n[l]=24,n[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,n[l]=-c-1,n[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,n[l]=13,n[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,n[l]=24,n[l|256]=24):(i[l]=31744,i[l|256]=64512,n[l]=13,n[l|256]=13)}let s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;(c&8388608)===0;)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:t,uint32View:r,baseTable:i,shiftTable:n,mantissaTable:s,exponentTable:a,offsetTable:o}}function dMe(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=ns(e,-65504,65504),lh.floatView[0]=e;let t=lh.uint32View[0],r=t>>23&511;return lh.baseTable[r]+((t&8388607)>>lh.shiftTable[r])}function hMe(e){let t=e>>10;return lh.uint32View[0]=lh.mantissaTable[lh.offsetTable[t]+(e&1023)]+lh.exponentTable[t],lh.floatView[0]}var fMe=Object.freeze({__proto__:null,fromHalfFloat:hMe,toHalfFloat:dMe});typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Gx}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Gx);var j1=".",eB=Symbol("target"),Gie=Symbol("unsubscribe");function Fj(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function pMe(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var Du=Array.isArray;function tB(e){return typeof e=="symbol"}var mMe={after:(e,t)=>Du(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>Du(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=j1),tB(t)?e+t.toString():e+t):e,initial:e=>{if(Du(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(j1);return t===-1?"":e.slice(0,t)},last:e=>{if(Du(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(j1);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(Du(e))for(let r of e)t(r);else if(e!==""){let r=0,i=e.indexOf(j1);if(i===-1)t(e);else for(;r<e.length;)i===-1&&(i=e.length),t(e.slice(r,i)),r=i+1,i=e.indexOf(j1,r)}},get(e,t){return this.walk(t,r=>{e&&(e=e[r])}),e}},kl=mMe;function gMe(e){return typeof e=="object"&&typeof e.next=="function"}function vMe(e,t,r,i,n){let s=e.next;if(t.name==="entries")e.next=function(){let a=s.call(this);return a.done===!1&&(a.value[0]=n(a.value[0],t,a.value[0],i),a.value[1]=n(a.value[1],t,a.value[0],i)),a};else if(t.name==="values"){let a=r[eB].keys();e.next=function(){let o=s.call(this);return o.done===!1&&(o.value=n(o.value,t,a.next().value,i)),o}}else e.next=function(){let a=s.call(this);return a.done===!1&&(a.value=n(a.value,t,a.value,i)),a};return e}function CW(e,t,r){return e.isUnsubscribed||t.ignoreSymbols&&tB(r)||t.ignoreUnderscores&&r.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(r)}var yMe=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),r=t.get(e);return r===void 0&&(r={},t.set(e,r)),r}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let r=this._getProperties(e),i=r[t];return i===void 0&&(i=Reflect.getOwnPropertyDescriptor(e,t),r[t]=i),i}getProxy(e,t,r,i){if(this.isUnsubscribed)return e;let n=e[i],s=n||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return a===void 0&&(a=n===void 0?new Proxy(e,r):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,kl.get(t,this.getPath(e)))}defineProperty(e,t,r){return Reflect.defineProperty(e,t,r)?(this.isUnsubscribed||(this._getProperties(e)[t]=r),!0):!1}setProperty(e,t,r,i,n){if(!this._equals(n,r)||!(t in e)){let s=this._getOwnPropertyDescriptor(e,t);return s!==void 0&&"set"in s?Reflect.set(e,t,r,i):Reflect.set(e,t,r)}return!0}deleteProperty(e,t,r){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(e);i&&(delete i[t],this._pathCache.delete(r))}return!0}return!1}isSameDescriptor(e,t,r){let i=this._getOwnPropertyDescriptor(t,r);return e!==void 0&&i!==void 0&&Object.is(e.value,i.value)&&(e.writable||!1)===(i.writable||!1)&&(e.enumerable||!1)===(i.enumerable||!1)&&(e.configurable||!1)===(i.configurable||!1)&&e.get===i.get&&e.set===i.set}isGetInvariant(e,t){let r=this._getOwnPropertyDescriptor(e,t);return r!==void 0&&r.configurable!==!0&&r.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function Vj(e){return toString.call(e)==="[object Object]"}function yA(){return!0}function Cv(e,t){return e.length!==t.length||e.some((r,i)=>t[i]!==r)}var Wie=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),xMe=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),qie={push:yA,pop:yA,shift:yA,unshift:yA,copyWithin:Cv,reverse:Cv,sort:Cv,splice:Cv,flat:Cv,fill:Cv},bMe=new Set([...Wie,...xMe,...Object.keys(qie)]);function xA(e,t){if(e.size!==t.size)return!0;for(let r of e)if(!t.has(r))return!0;return!1}var Yie=["keys","values","entries"],Xie=new Set(["has","toString"]),$ie={add:xA,clear:xA,delete:xA,forEach:xA},wMe=new Set([...Xie,...Object.keys($ie),...Yie]);function bA(e,t){if(e.size!==t.size)return!0;let r;for(let[i,n]of e)if(r=t.get(i),r!==n||r===void 0&&!t.has(i))return!0;return!1}var _Me=new Set([...Xie,"get"]),Kie={set:bA,clear:bA,delete:bA,forEach:bA},SMe=new Set([..._Me,...Object.keys(Kie),...Yie]),Op=class{constructor(e,t,r,i){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return Wie.has(e)}_shallowClone(e){let t=e;if(Vj(e))t={...e};else if(Du(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(r=>this._shallowClone(r)));else if(e instanceof Map){t=new Map;for(let[r,i]of e.entries())t.set(r,this._shallowClone(i))}return this._clonedCache.add(t),t}preferredThisArg(e,t,r,i){return e?(Du(i)?this._onIsChanged=qie[t]:i instanceof Set?this._onIsChanged=$ie[t]:i instanceof Map&&(this._onIsChanged=Kie[t]),i):r}update(e,t,r){let i=kl.after(e,this._path);if(t!=="length"){let n=this.clone;kl.walk(i,s=>{n&&n[s]&&(this._clonedCache.has(n[s])||(n[s]=this._shallowClone(n[s])),n=n[s])}),this._hasOnValidate&&this._changes.push({path:i,property:t,previous:r}),n&&n[t]&&(n[t]=r)}this._isChanged=!0}undo(e){let t;for(let r=this._changes.length-1;r!==-1;r--)t=this._changes[r],kl.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},TW=class extends Op{static isHandledMethod(e){return bMe.has(e)}},EMe=class extends Op{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},MW=class extends Op{static isHandledMethod(e){return wMe.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},PW=class extends Op{static isHandledMethod(e){return SMe.has(e)}undo(e){for(let[t,r]of this.clone.entries())e.set(t,r);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},AMe=class extends Op{constructor(e,t,r,i){super(void 0,t,r,i),this._arg1=r[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},CMe=class extends Op{constructor(e,t,r,i){super(void 0,t,r,i),this._weakKey=r[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},ey=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return Vj(e)||Du(e)||Fj(e)}static isHandledMethod(e,t){return Vj(e)?Op.isHandledMethod(t):Du(e)?TW.isHandledMethod(t):e instanceof Set?MW.isHandledMethod(t):e instanceof Map?PW.isHandledMethod(t):Fj(e)}get isCloning(){return this._stack.length>0}start(e,t,r){let i=Op;Du(e)?i=TW:e instanceof Date?i=EMe:e instanceof Set?i=MW:e instanceof Map?i=PW:e instanceof WeakSet?i=AMe:e instanceof WeakMap&&(i=CMe),this._stack.push(new i(e,t,r,this._hasOnValidate))}update(e,t,r){this._stack[this._stack.length-1].update(e,t,r)}preferredThisArg(e,t,r){let{name:i}=e,n=ey.isHandledMethod(r,i);return this._stack[this._stack.length-1].preferredThisArg(n,i,t,r)}isChanged(e,t,r){return this._stack[this._stack.length-1].isChanged(e,t,r)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},TMe={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},rB=(e,t,r={})=>{r={...TMe,...r};let i=Symbol("ProxyTarget"),{equals:n,isShallow:s,ignoreDetached:a,details:o}=r,l=new yMe(n),c=typeof r.onValidate=="function",u=new ey(c),d=(_,S,P,M,C)=>!c||u.isCloning||r.onValidate(kl.concat(l.getPath(_),S),P,M,C)===!0,f=(_,S,P,M)=>{!CW(l,r,S)&&!(a&&l.isDetached(_,e))&&m(l.getPath(_),S,P,M)},m=(_,S,P,M,C)=>{u.isCloning?u.update(_,S,M):t(kl.concat(_,S),P,M,C)},v=_=>_&&(_[i]||_),y=(_,S,P,M)=>pMe(_)||P==="constructor"||s&&!ey.isHandledMethod(S,P)||CW(l,r,P)||l.isGetInvariant(S,P)||a&&l.isDetached(S,e)?_:(M===void 0&&(M=l.getPath(S)),l.getProxy(_,kl.concat(M,P),x,i)),x={get(_,S,P){if(tB(S)){if(S===i||S===eB)return _;if(S===Gie&&!l.isUnsubscribed&&l.getPath(_).length===0)return l.unsubscribe(),_}let M=Fj(_)?Reflect.get(_,S):Reflect.get(_,S,P);return y(M,_,S)},set(_,S,P,M){P=v(P);let C=_[i]||_,T=C[S];if(n(T,P)&&S in _)return!0;let E=d(_,S,P,T);return E&&l.setProperty(C,S,P,M,T)?(f(_,S,_[S],T),!0):!E},defineProperty(_,S,P){if(!l.isSameDescriptor(P,_,S)){let M=_[S];d(_,S,P.value,M)&&l.defineProperty(_,S,P,M)&&f(_,S,P.value,M)}return!0},deleteProperty(_,S){if(!Reflect.has(_,S))return!0;let P=Reflect.get(_,S),M=d(_,S,void 0,P);return M&&l.deleteProperty(_,S,P)?(f(_,S,void 0,P),!0):!M},apply(_,S,P){let M=S[i]||S;if(l.isUnsubscribed)return Reflect.apply(_,M,P);if((o===!1||o!==!0&&!o.includes(_.name))&&ey.isHandledType(M)){let C=kl.initial(l.getPath(_)),T=ey.isHandledMethod(M,_.name);u.start(M,C,P);let E=Reflect.apply(_,u.preferredThisArg(_,S,M),T?P.map(I=>v(I)):P),N=u.isChanged(M,n),D=u.stop();if(ey.isHandledType(E)&&T&&(S instanceof Map&&_.name==="get"&&(C=kl.concat(C,P[0])),E=l.getProxy(E,C,x)),N){let I={name:_.name,args:P,result:E},j=u.isCloning?kl.initial(C):C,L=u.isCloning?kl.last(C):"";d(kl.get(e,j),L,M,D,I)?m(j,L,M,D,I):u.undo(M)}return(S instanceof Map||S instanceof Set)&&gMe(E)?vMe(E,_,S,C,y):E}return Reflect.apply(_,S,P)}},w=l.getProxy(e,r.pathAsArray?[]:"",x);return t=t.bind(w),c&&(r.onValidate=r.onValidate.bind(w)),w};rB.target=e=>e&&e[eB]||e;rB.unsubscribe=e=>e[Gie]||e;var DW=rB,MMe=typeof global=="object"&&global&&global.Object===Object&&global,Qie=MMe,PMe=typeof self=="object"&&self&&self.Object===Object&&self,DMe=Qie||PMe||Function("return this")(),Yc=DMe,NMe=Yc.Symbol,Xl=NMe,Zie=Object.prototype,kMe=Zie.hasOwnProperty,RMe=Zie.toString,L1=Xl?Xl.toStringTag:void 0;function IMe(e){var t=kMe.call(e,L1),r=e[L1];try{e[L1]=void 0;var i=!0}catch{}var n=RMe.call(e);return i&&(t?e[L1]=r:delete e[L1]),n}var OMe=IMe,jMe=Object.prototype,LMe=jMe.toString;function zMe(e){return LMe.call(e)}var BMe=zMe,FMe="[object Null]",VMe="[object Undefined]",NW=Xl?Xl.toStringTag:void 0;function UMe(e){return e==null?e===void 0?VMe:FMe:NW&&NW in Object(e)?OMe(e):BMe(e)}var f0=UMe;function HMe(e){return e!=null&&typeof e=="object"}var Oh=HMe,GMe="[object Symbol]";function WMe(e){return typeof e=="symbol"||Oh(e)&&f0(e)==GMe}var L_=WMe;function qMe(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var Jie=qMe,YMe=Array.isArray,td=YMe,kW=Xl?Xl.prototype:void 0,RW=kW?kW.toString:void 0;function ene(e){if(typeof e=="string")return e;if(td(e))return Jie(e,ene)+"";if(L_(e))return RW?RW.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var tne=ene,XMe=/\s/;function $Me(e){for(var t=e.length;t--&&XMe.test(e.charAt(t)););return t}var rne=$Me,KMe=/^\s+/;function QMe(e){return e&&e.slice(0,rne(e)+1).replace(KMe,"")}var ZMe=QMe;function JMe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Vc=JMe,IW=NaN,ePe=/^[-+]0x[0-9a-f]+$/i,tPe=/^0b[01]+$/i,rPe=/^0o[0-7]+$/i,iPe=parseInt;function nPe(e){if(typeof e=="number")return e;if(L_(e))return IW;if(Vc(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Vc(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ZMe(e);var r=tPe.test(e);return r||rPe.test(e)?iPe(e.slice(2),r?2:8):ePe.test(e)?IW:+e}var OW=nPe;function sPe(e){return e}var ine=sPe,aPe="[object AsyncFunction]",oPe="[object Function]",lPe="[object GeneratorFunction]",cPe="[object Proxy]";function uPe(e){if(!Vc(e))return!1;var t=f0(e);return t==oPe||t==lPe||t==aPe||t==cPe}var nne=uPe,dPe=Yc["__core-js_shared__"],u4=dPe,jW=function(){var e=/[^.]+$/.exec(u4&&u4.keys&&u4.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function hPe(e){return!!jW&&jW in e}var fPe=hPe,pPe=Function.prototype,mPe=pPe.toString;function gPe(e){if(e!=null){try{return mPe.call(e)}catch{}try{return e+""}catch{}}return""}var p0=gPe,vPe=/[\\^$.*+?()[\]{}|]/g,yPe=/^\[object .+?Constructor\]$/,xPe=Function.prototype,bPe=Object.prototype,wPe=xPe.toString,_Pe=bPe.hasOwnProperty,SPe=RegExp("^"+wPe.call(_Pe).replace(vPe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function EPe(e){if(!Vc(e)||fPe(e))return!1;var t=nne(e)?SPe:yPe;return t.test(p0(e))}var APe=EPe;function CPe(e,t){return e?.[t]}var TPe=CPe;function MPe(e,t){var r=TPe(e,t);return APe(r)?r:void 0}var m0=MPe,PPe=m0(Yc,"WeakMap"),Uj=PPe,LW=Object.create,DPe=function(){function e(){}return function(t){if(!Vc(t))return{};if(LW)return LW(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),NPe=DPe;function kPe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var RPe=kPe;function IPe(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var OPe=IPe,jPe=800,LPe=16,zPe=Date.now;function BPe(e){var t=0,r=0;return function(){var i=zPe(),n=LPe-(i-r);if(r=i,n>0){if(++t>=jPe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var FPe=BPe;function VPe(e){return function(){return e}}var UPe=VPe,HPe=function(){try{var e=m0(Object,"defineProperty");return e({},"",{}),e}catch{}}(),mM=HPe,GPe=mM?function(e,t){return mM(e,"toString",{configurable:!0,enumerable:!1,value:UPe(t),writable:!0})}:ine,WPe=GPe,qPe=FPe(WPe),YPe=qPe;function XPe(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}var $Pe=XPe;function KPe(e,t,r,i){for(var n=e.length,s=r+(i?1:-1);i?s--:++s<n;)if(t(e[s],s,e))return s;return-1}var QPe=KPe;function ZPe(e){return e!==e}var JPe=ZPe;function e3e(e,t,r){for(var i=r-1,n=e.length;++i<n;)if(e[i]===t)return i;return-1}var t3e=e3e;function r3e(e,t,r){return t===t?t3e(e,t,r):QPe(e,JPe,r)}var i3e=r3e,n3e=9007199254740991,s3e=/^(?:0|[1-9]\d*)$/;function a3e(e,t){var r=typeof e;return t=t??n3e,!!t&&(r=="number"||r!="symbol"&&s3e.test(e))&&e>-1&&e%1==0&&e<t}var iB=a3e;function o3e(e,t,r){t=="__proto__"&&mM?mM(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var sne=o3e;function l3e(e,t){return e===t||e!==e&&t!==t}var nB=l3e,c3e=Object.prototype,u3e=c3e.hasOwnProperty;function d3e(e,t,r){var i=e[t];(!(u3e.call(e,t)&&nB(i,r))||r===void 0&&!(t in e))&&sne(e,t,r)}var sB=d3e;function h3e(e,t,r,i){var n=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=i?i(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),n?sne(r,o,l):sB(r,o,l)}return r}var z_=h3e,zW=Math.max;function f3e(e,t,r){return t=zW(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,s=zW(i.length-t,0),a=Array(s);++n<s;)a[n]=i[t+n];n=-1;for(var o=Array(t+1);++n<t;)o[n]=i[n];return o[t]=r(a),RPe(e,this,o)}}var p3e=f3e,m3e=9007199254740991;function g3e(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=m3e}var aB=g3e;function v3e(e){return e!=null&&aB(e.length)&&!nne(e)}var ane=v3e,y3e=Object.prototype;function x3e(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||y3e;return e===r}var oB=x3e;function b3e(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var w3e=b3e,_3e="[object Arguments]";function S3e(e){return Oh(e)&&f0(e)==_3e}var BW=S3e,one=Object.prototype,E3e=one.hasOwnProperty,A3e=one.propertyIsEnumerable,C3e=BW(function(){return arguments}())?BW:function(e){return Oh(e)&&E3e.call(e,"callee")&&!A3e.call(e,"callee")},lB=C3e;function T3e(){return!1}var M3e=T3e,lne=typeof exports=="object"&&exports&&!exports.nodeType&&exports,FW=lne&&typeof module=="object"&&module&&!module.nodeType&&module,P3e=FW&&FW.exports===lne,VW=P3e?Yc.Buffer:void 0,D3e=VW?VW.isBuffer:void 0,N3e=D3e||M3e,gM=N3e,k3e="[object Arguments]",R3e="[object Array]",I3e="[object Boolean]",O3e="[object Date]",j3e="[object Error]",L3e="[object Function]",z3e="[object Map]",B3e="[object Number]",F3e="[object Object]",V3e="[object RegExp]",U3e="[object Set]",H3e="[object String]",G3e="[object WeakMap]",W3e="[object ArrayBuffer]",q3e="[object DataView]",Y3e="[object Float32Array]",X3e="[object Float64Array]",$3e="[object Int8Array]",K3e="[object Int16Array]",Q3e="[object Int32Array]",Z3e="[object Uint8Array]",J3e="[object Uint8ClampedArray]",eDe="[object Uint16Array]",tDe="[object Uint32Array]",rn={};rn[Y3e]=rn[X3e]=rn[$3e]=rn[K3e]=rn[Q3e]=rn[Z3e]=rn[J3e]=rn[eDe]=rn[tDe]=!0;rn[k3e]=rn[R3e]=rn[W3e]=rn[I3e]=rn[q3e]=rn[O3e]=rn[j3e]=rn[L3e]=rn[z3e]=rn[B3e]=rn[F3e]=rn[V3e]=rn[U3e]=rn[H3e]=rn[G3e]=!1;function rDe(e){return Oh(e)&&aB(e.length)&&!!rn[f0(e)]}var iDe=rDe;function nDe(e){return function(t){return e(t)}}var cB=nDe,cne=typeof exports=="object"&&exports&&!exports.nodeType&&exports,qw=cne&&typeof module=="object"&&module&&!module.nodeType&&module,sDe=qw&&qw.exports===cne,d4=sDe&&Qie.process,aDe=function(){try{var e=qw&&qw.require&&qw.require("util").types;return e||d4&&d4.binding&&d4.binding("util")}catch{}}(),ox=aDe,UW=ox&&ox.isTypedArray,oDe=UW?cB(UW):iDe,une=oDe,lDe=Object.prototype,cDe=lDe.hasOwnProperty;function uDe(e,t){var r=td(e),i=!r&&lB(e),n=!r&&!i&&gM(e),s=!r&&!i&&!n&&une(e),a=r||i||n||s,o=a?w3e(e.length,String):[],l=o.length;for(var c in e)(t||cDe.call(e,c))&&!(a&&(c=="length"||n&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||iB(c,l)))&&o.push(c);return o}var dne=uDe;function dDe(e,t){return function(r){return e(t(r))}}var hne=dDe,hDe=hne(Object.keys,Object),fDe=hDe,pDe=Object.prototype,mDe=pDe.hasOwnProperty;function gDe(e){if(!oB(e))return fDe(e);var t=[];for(var r in Object(e))mDe.call(e,r)&&r!="constructor"&&t.push(r);return t}var vDe=gDe;function yDe(e){return ane(e)?dne(e):vDe(e)}var uB=yDe;function xDe(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var bDe=xDe,wDe=Object.prototype,_De=wDe.hasOwnProperty;function SDe(e){if(!Vc(e))return bDe(e);var t=oB(e),r=[];for(var i in e)i=="constructor"&&(t||!_De.call(e,i))||r.push(i);return r}var EDe=SDe;function ADe(e){return ane(e)?dne(e,!0):EDe(e)}var ug=ADe,CDe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,TDe=/^\w*$/;function MDe(e,t){if(td(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||L_(e)?!0:TDe.test(e)||!CDe.test(e)||t!=null&&e in Object(t)}var PDe=MDe,DDe=m0(Object,"create"),R2=DDe;function NDe(){this.__data__=R2?R2(null):{},this.size=0}var kDe=NDe;function RDe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var IDe=RDe,ODe="__lodash_hash_undefined__",jDe=Object.prototype,LDe=jDe.hasOwnProperty;function zDe(e){var t=this.__data__;if(R2){var r=t[e];return r===ODe?void 0:r}return LDe.call(t,e)?t[e]:void 0}var BDe=zDe,FDe=Object.prototype,VDe=FDe.hasOwnProperty;function UDe(e){var t=this.__data__;return R2?t[e]!==void 0:VDe.call(t,e)}var HDe=UDe,GDe="__lodash_hash_undefined__";function WDe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=R2&&t===void 0?GDe:t,this}var qDe=WDe;function Kx(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Kx.prototype.clear=kDe;Kx.prototype.delete=IDe;Kx.prototype.get=BDe;Kx.prototype.has=HDe;Kx.prototype.set=qDe;var HW=Kx;function YDe(){this.__data__=[],this.size=0}var XDe=YDe;function $De(e,t){for(var r=e.length;r--;)if(nB(e[r][0],t))return r;return-1}var R3=$De,KDe=Array.prototype,QDe=KDe.splice;function ZDe(e){var t=this.__data__,r=R3(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():QDe.call(t,r,1),--this.size,!0}var JDe=ZDe;function eNe(e){var t=this.__data__,r=R3(t,e);return r<0?void 0:t[r][1]}var tNe=eNe;function rNe(e){return R3(this.__data__,e)>-1}var iNe=rNe;function nNe(e,t){var r=this.__data__,i=R3(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var sNe=nNe;function Qx(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Qx.prototype.clear=XDe;Qx.prototype.delete=JDe;Qx.prototype.get=tNe;Qx.prototype.has=iNe;Qx.prototype.set=sNe;var I3=Qx,aNe=m0(Yc,"Map"),I2=aNe;function oNe(){this.size=0,this.__data__={hash:new HW,map:new(I2||I3),string:new HW}}var lNe=oNe;function cNe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var uNe=cNe;function dNe(e,t){var r=e.__data__;return uNe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var O3=dNe;function hNe(e){var t=O3(this,e).delete(e);return this.size-=t?1:0,t}var fNe=hNe;function pNe(e){return O3(this,e).get(e)}var mNe=pNe;function gNe(e){return O3(this,e).has(e)}var vNe=gNe;function yNe(e,t){var r=O3(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var xNe=yNe;function Zx(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Zx.prototype.clear=lNe;Zx.prototype.delete=fNe;Zx.prototype.get=mNe;Zx.prototype.has=vNe;Zx.prototype.set=xNe;var j3=Zx,bNe="Expected a function";function dB(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(bNe);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var a=e.apply(this,i);return r.cache=s.set(n,a)||s,a};return r.cache=new(dB.Cache||j3),r}dB.Cache=j3;var wNe=dB,_Ne=500;function SNe(e){var t=wNe(e,function(i){return r.size===_Ne&&r.clear(),i}),r=t.cache;return t}var ENe=SNe,ANe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,CNe=/\\(\\)?/g,TNe=ENe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(ANe,function(r,i,n,s){t.push(n?s.replace(CNe,"$1"):i||r)}),t}),MNe=TNe;function PNe(e){return e==null?"":tne(e)}var fne=PNe;function DNe(e,t){return td(e)?e:PDe(e,t)?[e]:MNe(fne(e))}var Jx=DNe;function NNe(e){if(typeof e=="string"||L_(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var L3=NNe;function kNe(e,t){t=Jx(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[L3(t[r++])];return r&&r==i?e:void 0}var pne=kNe;function RNe(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var hB=RNe,GW=Xl?Xl.isConcatSpreadable:void 0;function INe(e){return td(e)||lB(e)||!!(GW&&e&&e[GW])}var ONe=INe;function mne(e,t,r,i,n){var s=-1,a=e.length;for(r||(r=ONe),n||(n=[]);++s<a;){var o=e[s];t>0&&r(o)?t>1?mne(o,t-1,r,i,n):hB(n,o):i||(n[n.length]=o)}return n}var jNe=mne;function LNe(e){var t=e==null?0:e.length;return t?jNe(e,1):[]}var zNe=LNe;function BNe(e){return YPe(p3e(e,void 0,zNe),e+"")}var gne=BNe,FNe=hne(Object.getPrototypeOf,Object),fB=FNe,VNe="[object Object]",UNe=Function.prototype,HNe=Object.prototype,vne=UNe.toString,GNe=HNe.hasOwnProperty,WNe=vne.call(Object);function qNe(e){if(!Oh(e)||f0(e)!=VNe)return!1;var t=fB(e);if(t===null)return!0;var r=GNe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&vne.call(r)==WNe}var YNe=qNe;function XNe(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(n);++i<n;)s[i]=e[i+t];return s}var yne=XNe;function $Ne(e,t,r){var i=e.length;return r=r===void 0?i:r,!t&&r>=i?e:yne(e,t,r)}var KNe=$Ne,QNe="\\ud800-\\udfff",ZNe="\\u0300-\\u036f",JNe="\\ufe20-\\ufe2f",eke="\\u20d0-\\u20ff",tke=ZNe+JNe+eke,rke="\\ufe0e\\ufe0f",ike="\\u200d",nke=RegExp("["+ike+QNe+tke+rke+"]");function ske(e){return nke.test(e)}var ake=ske;function oke(e){return e.split("")}var lke=oke,xne="\\ud800-\\udfff",cke="\\u0300-\\u036f",uke="\\ufe20-\\ufe2f",dke="\\u20d0-\\u20ff",hke=cke+uke+dke,fke="\\ufe0e\\ufe0f",pke="["+xne+"]",Hj="["+hke+"]",Gj="\\ud83c[\\udffb-\\udfff]",mke="(?:"+Hj+"|"+Gj+")",bne="[^"+xne+"]",wne="(?:\\ud83c[\\udde6-\\uddff]){2}",_ne="[\\ud800-\\udbff][\\udc00-\\udfff]",gke="\\u200d",Sne=mke+"?",Ene="["+fke+"]?",vke="(?:"+gke+"(?:"+[bne,wne,_ne].join("|")+")"+Ene+Sne+")*",yke=Ene+Sne+vke,xke="(?:"+[bne+Hj+"?",Hj,wne,_ne,pke].join("|")+")",bke=RegExp(Gj+"(?="+Gj+")|"+xke+yke,"g");function wke(e){return e.match(bke)||[]}var _ke=wke;function Ske(e){return ake(e)?_ke(e):lke(e)}var WW=Ske;function Eke(){this.__data__=new I3,this.size=0}var Ake=Eke;function Cke(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var Tke=Cke;function Mke(e){return this.__data__.get(e)}var Pke=Mke;function Dke(e){return this.__data__.has(e)}var Nke=Dke,kke=200;function Rke(e,t){var r=this.__data__;if(r instanceof I3){var i=r.__data__;if(!I2||i.length<kke-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new j3(i)}return r.set(e,t),this.size=r.size,this}var Ike=Rke;function eb(e){var t=this.__data__=new I3(e);this.size=t.size}eb.prototype.clear=Ake;eb.prototype.delete=Tke;eb.prototype.get=Pke;eb.prototype.has=Nke;eb.prototype.set=Ike;var aT=eb;function Oke(e,t){return e&&z_(t,uB(t),e)}var jke=Oke;function Lke(e,t){return e&&z_(t,ug(t),e)}var zke=Lke,Ane=typeof exports=="object"&&exports&&!exports.nodeType&&exports,qW=Ane&&typeof module=="object"&&module&&!module.nodeType&&module,Bke=qW&&qW.exports===Ane,YW=Bke?Yc.Buffer:void 0,XW=YW?YW.allocUnsafe:void 0;function Fke(e,t){if(t)return e.slice();var r=e.length,i=XW?XW(r):new e.constructor(r);return e.copy(i),i}var Vke=Fke;function Uke(e,t){for(var r=-1,i=e==null?0:e.length,n=0,s=[];++r<i;){var a=e[r];t(a,r,e)&&(s[n++]=a)}return s}var Hke=Uke;function Gke(){return[]}var Cne=Gke,Wke=Object.prototype,qke=Wke.propertyIsEnumerable,$W=Object.getOwnPropertySymbols,Yke=$W?function(e){return e==null?[]:(e=Object(e),Hke($W(e),function(t){return qke.call(e,t)}))}:Cne,pB=Yke;function Xke(e,t){return z_(e,pB(e),t)}var $ke=Xke,Kke=Object.getOwnPropertySymbols,Qke=Kke?function(e){for(var t=[];e;)hB(t,pB(e)),e=fB(e);return t}:Cne,Tne=Qke;function Zke(e,t){return z_(e,Tne(e),t)}var Jke=Zke;function eRe(e,t,r){var i=t(e);return td(e)?i:hB(i,r(e))}var Mne=eRe;function tRe(e){return Mne(e,uB,pB)}var Wj=tRe;function rRe(e){return Mne(e,ug,Tne)}var Pne=rRe,iRe=m0(Yc,"DataView"),qj=iRe,nRe=m0(Yc,"Promise"),Yj=nRe,sRe=m0(Yc,"Set"),Xj=sRe,KW="[object Map]",aRe="[object Object]",QW="[object Promise]",ZW="[object Set]",JW="[object WeakMap]",eq="[object DataView]",oRe=p0(qj),lRe=p0(I2),cRe=p0(Yj),uRe=p0(Xj),dRe=p0(Uj),Km=f0;(qj&&Km(new qj(new ArrayBuffer(1)))!=eq||I2&&Km(new I2)!=KW||Yj&&Km(Yj.resolve())!=QW||Xj&&Km(new Xj)!=ZW||Uj&&Km(new Uj)!=JW)&&(Km=function(e){var t=f0(e),r=t==aRe?e.constructor:void 0,i=r?p0(r):"";if(i)switch(i){case oRe:return eq;case lRe:return KW;case cRe:return QW;case uRe:return ZW;case dRe:return JW}return t});var O2=Km,hRe=Object.prototype,fRe=hRe.hasOwnProperty;function pRe(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&fRe.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var mRe=pRe,gRe=Yc.Uint8Array,vM=gRe;function vRe(e){var t=new e.constructor(e.byteLength);return new vM(t).set(new vM(e)),t}var mB=vRe;function yRe(e,t){var r=t?mB(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var xRe=yRe,bRe=/\w*$/;function wRe(e){var t=new e.constructor(e.source,bRe.exec(e));return t.lastIndex=e.lastIndex,t}var _Re=wRe,tq=Xl?Xl.prototype:void 0,rq=tq?tq.valueOf:void 0;function SRe(e){return rq?Object(rq.call(e)):{}}var ERe=SRe;function ARe(e,t){var r=t?mB(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var CRe=ARe,TRe="[object Boolean]",MRe="[object Date]",PRe="[object Map]",DRe="[object Number]",NRe="[object RegExp]",kRe="[object Set]",RRe="[object String]",IRe="[object Symbol]",ORe="[object ArrayBuffer]",jRe="[object DataView]",LRe="[object Float32Array]",zRe="[object Float64Array]",BRe="[object Int8Array]",FRe="[object Int16Array]",VRe="[object Int32Array]",URe="[object Uint8Array]",HRe="[object Uint8ClampedArray]",GRe="[object Uint16Array]",WRe="[object Uint32Array]";function qRe(e,t,r){var i=e.constructor;switch(t){case ORe:return mB(e);case TRe:case MRe:return new i(+e);case jRe:return xRe(e,r);case LRe:case zRe:case BRe:case FRe:case VRe:case URe:case HRe:case GRe:case WRe:return CRe(e,r);case PRe:return new i;case DRe:case RRe:return new i(e);case NRe:return _Re(e);case kRe:return new i;case IRe:return ERe(e)}}var YRe=qRe;function XRe(e){return typeof e.constructor=="function"&&!oB(e)?NPe(fB(e)):{}}var $Re=XRe,KRe="[object Map]";function QRe(e){return Oh(e)&&O2(e)==KRe}var ZRe=QRe,iq=ox&&ox.isMap,JRe=iq?cB(iq):ZRe,e4e=JRe,t4e="[object Set]";function r4e(e){return Oh(e)&&O2(e)==t4e}var i4e=r4e,nq=ox&&ox.isSet,n4e=nq?cB(nq):i4e,s4e=n4e,a4e=1,o4e=2,l4e=4,Dne="[object Arguments]",c4e="[object Array]",u4e="[object Boolean]",d4e="[object Date]",h4e="[object Error]",Nne="[object Function]",f4e="[object GeneratorFunction]",p4e="[object Map]",m4e="[object Number]",kne="[object Object]",g4e="[object RegExp]",v4e="[object Set]",y4e="[object String]",x4e="[object Symbol]",b4e="[object WeakMap]",w4e="[object ArrayBuffer]",_4e="[object DataView]",S4e="[object Float32Array]",E4e="[object Float64Array]",A4e="[object Int8Array]",C4e="[object Int16Array]",T4e="[object Int32Array]",M4e="[object Uint8Array]",P4e="[object Uint8ClampedArray]",D4e="[object Uint16Array]",N4e="[object Uint32Array]",Qi={};Qi[Dne]=Qi[c4e]=Qi[w4e]=Qi[_4e]=Qi[u4e]=Qi[d4e]=Qi[S4e]=Qi[E4e]=Qi[A4e]=Qi[C4e]=Qi[T4e]=Qi[p4e]=Qi[m4e]=Qi[kne]=Qi[g4e]=Qi[v4e]=Qi[y4e]=Qi[x4e]=Qi[M4e]=Qi[P4e]=Qi[D4e]=Qi[N4e]=!0;Qi[h4e]=Qi[Nne]=Qi[b4e]=!1;function oT(e,t,r,i,n,s){var a,o=t&a4e,l=t&o4e,c=t&l4e;if(r&&(a=n?r(e,i,n,s):r(e)),a!==void 0)return a;if(!Vc(e))return e;var u=td(e);if(u){if(a=mRe(e),!o)return OPe(e,a)}else{var d=O2(e),f=d==Nne||d==f4e;if(gM(e))return Vke(e,o);if(d==kne||d==Dne||f&&!n){if(a=l||f?{}:$Re(e),!o)return l?Jke(e,zke(a,e)):$ke(e,jke(a,e))}else{if(!Qi[d])return n?e:{};a=YRe(e,d,o)}}s||(s=new aT);var m=s.get(e);if(m)return m;s.set(e,a),s4e(e)?e.forEach(function(x){a.add(oT(x,t,r,x,e,s))}):e4e(e)&&e.forEach(function(x,w){a.set(w,oT(x,t,r,w,e,s))});var v=c?l?Pne:Wj:l?ug:uB,y=u?void 0:v(e);return $Pe(y||e,function(x,w){y&&(w=x,x=e[w]),sB(a,w,oT(x,t,r,w,e,s))}),a}var Rne=oT,k4e=1,R4e=4;function I4e(e){return Rne(e,k4e|R4e)}var z3=I4e,O4e="__lodash_hash_undefined__";function j4e(e){return this.__data__.set(e,O4e),this}var L4e=j4e;function z4e(e){return this.__data__.has(e)}var B4e=z4e;function yM(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new j3;++t<r;)this.add(e[t])}yM.prototype.add=yM.prototype.push=L4e;yM.prototype.has=B4e;var F4e=yM;function V4e(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}var U4e=V4e;function H4e(e,t){return e.has(t)}var G4e=H4e,W4e=1,q4e=2;function Y4e(e,t,r,i,n,s){var a=r&W4e,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e),u=s.get(t);if(c&&u)return c==t&&u==e;var d=-1,f=!0,m=r&q4e?new F4e:void 0;for(s.set(e,t),s.set(t,e);++d<o;){var v=e[d],y=t[d];if(i)var x=a?i(y,v,d,t,e,s):i(v,y,d,e,t,s);if(x!==void 0){if(x)continue;f=!1;break}if(m){if(!U4e(t,function(w,_){if(!G4e(m,_)&&(v===w||n(v,w,r,i,s)))return m.push(_)})){f=!1;break}}else if(!(v===y||n(v,y,r,i,s))){f=!1;break}}return s.delete(e),s.delete(t),f}var Ine=Y4e;function X4e(e){var t=-1,r=Array(e.size);return e.forEach(function(i,n){r[++t]=[n,i]}),r}var $4e=X4e;function K4e(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}var Q4e=K4e,Z4e=1,J4e=2,eIe="[object Boolean]",tIe="[object Date]",rIe="[object Error]",iIe="[object Map]",nIe="[object Number]",sIe="[object RegExp]",aIe="[object Set]",oIe="[object String]",lIe="[object Symbol]",cIe="[object ArrayBuffer]",uIe="[object DataView]",sq=Xl?Xl.prototype:void 0,h4=sq?sq.valueOf:void 0;function dIe(e,t,r,i,n,s,a){switch(r){case uIe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case cIe:return!(e.byteLength!=t.byteLength||!s(new vM(e),new vM(t)));case eIe:case tIe:case nIe:return nB(+e,+t);case rIe:return e.name==t.name&&e.message==t.message;case sIe:case oIe:return e==t+"";case iIe:var o=$4e;case aIe:var l=i&Z4e;if(o||(o=Q4e),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;i|=J4e,a.set(e,t);var u=Ine(o(e),o(t),i,n,s,a);return a.delete(e),u;case lIe:if(h4)return h4.call(e)==h4.call(t)}return!1}var hIe=dIe,fIe=1,pIe=Object.prototype,mIe=pIe.hasOwnProperty;function gIe(e,t,r,i,n,s){var a=r&fIe,o=Wj(e),l=o.length,c=Wj(t),u=c.length;if(l!=u&&!a)return!1;for(var d=l;d--;){var f=o[d];if(!(a?f in t:mIe.call(t,f)))return!1}var m=s.get(e),v=s.get(t);if(m&&v)return m==t&&v==e;var y=!0;s.set(e,t),s.set(t,e);for(var x=a;++d<l;){f=o[d];var w=e[f],_=t[f];if(i)var S=a?i(_,w,f,t,e,s):i(w,_,f,e,t,s);if(!(S===void 0?w===_||n(w,_,r,i,s):S)){y=!1;break}x||(x=f=="constructor")}if(y&&!x){var P=e.constructor,M=t.constructor;P!=M&&"constructor"in e&&"constructor"in t&&!(typeof P=="function"&&P instanceof P&&typeof M=="function"&&M instanceof M)&&(y=!1)}return s.delete(e),s.delete(t),y}var vIe=gIe,yIe=1,aq="[object Arguments]",oq="[object Array]",wA="[object Object]",xIe=Object.prototype,lq=xIe.hasOwnProperty;function bIe(e,t,r,i,n,s){var a=td(e),o=td(t),l=a?oq:O2(e),c=o?oq:O2(t);l=l==aq?wA:l,c=c==aq?wA:c;var u=l==wA,d=c==wA,f=l==c;if(f&&gM(e)){if(!gM(t))return!1;a=!0,u=!1}if(f&&!u)return s||(s=new aT),a||une(e)?Ine(e,t,r,i,n,s):hIe(e,t,l,r,i,n,s);if(!(r&yIe)){var m=u&&lq.call(e,"__wrapped__"),v=d&&lq.call(t,"__wrapped__");if(m||v){var y=m?e.value():e,x=v?t.value():t;return s||(s=new aT),n(y,x,r,i,s)}}return f?(s||(s=new aT),vIe(e,t,r,i,n,s)):!1}var wIe=bIe;function One(e,t,r,i,n){return e===t?!0:e==null||t==null||!Oh(e)&&!Oh(t)?e!==e&&t!==t:wIe(e,t,r,i,One,n)}var _Ie=One;function SIe(e,t){return e!=null&&t in Object(e)}var EIe=SIe;function AIe(e,t,r){t=Jx(t,e);for(var i=-1,n=t.length,s=!1;++i<n;){var a=L3(t[i]);if(!(s=e!=null&&r(e,a)))break;e=e[a]}return s||++i!=n?s:(n=e==null?0:e.length,!!n&&aB(n)&&iB(a,n)&&(td(e)||lB(e)))}var CIe=AIe;function TIe(e,t){return e!=null&&CIe(e,t,EIe)}var MIe=TIe,PIe=function(){return Yc.Date.now()},f4=PIe,DIe="Expected a function",NIe=Math.max,kIe=Math.min;function RIe(e,t,r){var i,n,s,a,o,l,c=0,u=!1,d=!1,f=!0;if(typeof e!="function")throw new TypeError(DIe);t=OW(t)||0,Vc(r)&&(u=!!r.leading,d="maxWait"in r,s=d?NIe(OW(r.maxWait)||0,t):s,f="trailing"in r?!!r.trailing:f);function m(C){var T=i,E=n;return i=n=void 0,c=C,a=e.apply(E,T),a}function v(C){return c=C,o=setTimeout(w,t),u?m(C):a}function y(C){var T=C-l,E=C-c,N=t-T;return d?kIe(N,s-E):N}function x(C){var T=C-l,E=C-c;return l===void 0||T>=t||T<0||d&&E>=s}function w(){var C=f4();if(x(C))return _(C);o=setTimeout(w,y(C))}function _(C){return o=void 0,f&&i?m(C):(i=n=void 0,a)}function S(){o!==void 0&&clearTimeout(o),c=0,i=l=n=o=void 0}function P(){return o===void 0?a:_(f4())}function M(){var C=f4(),T=x(C);if(i=arguments,n=this,l=C,T){if(o===void 0)return v(l);if(d)return clearTimeout(o),o=setTimeout(w,t),m(l)}return o===void 0&&(o=setTimeout(w,t)),a}return M.cancel=S,M.flush=P,M}var j2=RIe;function IIe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var OIe=IIe;function jIe(e,t){return e>t}var LIe=jIe;function zIe(e,t){return t.length<2?e:pne(e,yne(t,0,-1))}var BIe=zIe;function FIe(e,t){return _Ie(e,t)}var gB=FIe;function VIe(e,t,r){for(var i=-1,n=e.length;++i<n;){var s=e[i],a=t(s);if(a!=null&&(o===void 0?a===a&&!L_(a):r(a,o)))var o=a,l=s}return l}var UIe=VIe;function HIe(e){return e&&e.length?UIe(e,ine,LIe):void 0}var GIe=HIe;function WIe(e,t){return t=Jx(t,e),e=BIe(e,t),e==null||delete e[L3(OIe(t))]}var qIe=WIe;function YIe(e){return YNe(e)?void 0:e}var XIe=YIe,$Ie=1,KIe=2,QIe=4,ZIe=gne(function(e,t){var r={};if(e==null)return r;var i=!1;t=Jie(t,function(s){return s=Jx(s,e),i||(i=s.length>1),s}),z_(e,Pne(e),r),i&&(r=Rne(r,$Ie|KIe|QIe,XIe));for(var n=t.length;n--;)qIe(r,t[n]);return r}),$j=ZIe;function JIe(e,t,r,i){if(!Vc(e))return e;t=Jx(t,e);for(var n=-1,s=t.length,a=s-1,o=e;o!=null&&++n<s;){var l=L3(t[n]),c=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(n!=a){var u=o[l];c=i?i(u,l,o):void 0,c===void 0&&(c=Vc(u)?u:iB(t[n+1])?[]:{})}sB(o,l,c),o=o[l]}return e}var eOe=JIe;function tOe(e,t,r){for(var i=-1,n=t.length,s={};++i<n;){var a=t[i],o=pne(e,a);r(o,a)&&eOe(s,Jx(a,e),o)}return s}var rOe=tOe;function iOe(e,t){return rOe(e,t,function(r,i){return MIe(e,i)})}var nOe=iOe,sOe=gne(function(e,t){return e==null?{}:nOe(e,t)}),Bu=sOe,aOe="Expected a function";function oOe(e,t,r){var i=!0,n=!0;if(typeof e!="function")throw new TypeError(aOe);return Vc(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),j2(e,t,{leading:i,maxWait:t,trailing:n})}var lOe=oOe;function cOe(e,t){for(var r=e.length;r--&&i3e(t,e[r],0)>-1;);return r}var uOe=cOe;function dOe(e,t,r){if(e=fne(e),e&&(r||t===void 0))return e.slice(0,rne(e)+1);if(!e||!(t=tne(t)))return e;var i=WW(e),n=uOe(i,WW(t))+1;return KNe(i,0,n).join("")}var hOe=dOe;function jne(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function $l(e,t){return Object.setPrototypeOf(e,t),e}var fOe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),pOe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),mOe=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||B3&&"ontouchend"in document,gOe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,vOe=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,yOe=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},xOe=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]},bOe=()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");return e?(window.localStorage.setItem("desktop-app-version",e),e):window.localStorage.getItem("desktop-app-version")??"0.0.6"},Lne=fOe();Lne&&bOe();var B3=pOe(),B_=mOe(),wOe=gOe(),nl=vOe(),cq=yOe(),_Oe=Number(xOe());function zne(e){return Array.isArray(e)?e:[e]}function Bne(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}function _A(e){return B3?e.metaKey:e.ctrlKey}function SOe(e){return e.wheelDeltaY===0||e.deltaY===0?B3&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX||e.wheelDeltaX===-3*window.devicePixelRatio*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY||e.wheelDeltaY===-3*window.devicePixelRatio*e.deltaY:e.deltaMode===0}var nr=[],xM={},xw={},lT={};function Fne(e){nr.includes(e)||nr.push(e)}function Ry(e){delete xM[e.pointerId];for(let t=0;t<nr.length;t++)if(nr[t].pointerId===e.pointerId){nr.splice(t,1);break}}function EOe(){nr.splice(0,nr.length)}function bM(e){if(e.pointerType!=="touch")return;let t=xM[e.pointerId];t===void 0&&(t={x:0,y:0},xM[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function p4(e){let t=e.pointerId===nr[0].pointerId?nr[1]:nr[0];return xM[t.pointerId]}function Vne(e){xw[e.key]=!0,lT[e.key]=lT[e.key]===void 0?1:lT[e.key]+1}function Une(e){if(B3&&xw.Meta)for(let t in xw)xw[t]=!1;else xw[e.key]=!1;lT={}}function AOe(e){e.addEventListener("pointerdown",Fne,!0),e.addEventListener("pointerdown",bM,!0),e.addEventListener("pointermove",bM,!0),e.addEventListener("pointerup",Ry,!0),e.addEventListener("pointercancel",Ry,!0),e.addEventListener("pointerleave",Ry,!0),window.addEventListener("keydown",Vne,!0),window.addEventListener("keyup",Une,!0)}function COe(e){e.removeEventListener("pointerdown",Fne,!0),e.removeEventListener("pointerdown",bM,!0),e.removeEventListener("pointermove",bM,!0),e.removeEventListener("pointerup",Ry,!0),e.removeEventListener("pointercancel",Ry,!0),e.removeEventListener("pointerleave",Ry,!0),window.removeEventListener("keydown",Vne,!0),window.removeEventListener("keyup",Une,!0)}var Hne,TOe=new Promise(e=>{Hne=e}),SA;function MOe(e){if(SA)return SA;async function t(){let r=e??"https://unpkg.com/@splinetool/navmesh-wasm@1.10.37/build",i=Zp(()=>import("./navmesh-BFd9Mv4x.js"),[]),[n,s]=await Promise.all([i,fetch(`${r}/navmesh.wasm`).then(l=>l.arrayBuffer())]),a=n.default,o=await a({wasmBinary:s});Hne(o)}return SA=t(),SA}var Gne,POe=new Promise(e=>{Gne=e}),EA;function DOe(){if(EA)return EA;async function e(){let t=await Zp(()=>import("./physics-BM4kW-A5.js"),[]);await t.init(),Gne(t)}return EA=e(),EA}var Qt=class{modifyById(e,t){let r=this;if(r[e]===void 0)throw new Error("not expected");{let i={...r,[e]:t};return Object.setPrototypeOf(i,Qt.prototype),i}}add(e,t){return this.runOp({type:1,id:e,data:t})?.data??this}runOp(e){let t=this;if(e.type===1){let r=t[e.id],i;r===void 0?i={type:2,id:e.id}:i={type:1,id:e.id,data:r};let{id:n,data:s}=e,a={...t,[n]:s};return Object.setPrototypeOf(a,Qt.prototype),{data:a,actual:e,reverse:i}}else if(e.type===2){let{id:r}=e,i=t[r];if(i===void 0)return null;{let n={...t};return Object.setPrototypeOf(n,Qt.prototype),delete n[r],{data:n,actual:e,reverse:{type:1,id:r,data:i}}}}return null}};function vB(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let r of t){let i=e[r];i&&typeof i=="object"&&vB(i)}return Object.freeze(e)}function NOe(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}var Wne=class extends Error{};function m4(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function cp(e,t,r){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let s=e;e=t,t=s}let i=[],n=1/(r+1);for(let s=0;s<r;s++){let a=e+(t-e)*(s+.75+Math.random()*.5)*n;i.push(a)}return i}function yB(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function kOe(){return typeof process<"u"}function qne(e,t){for(let r of e)t(r.id,r.data)!==!0&&qne(r.children,t)}function Yne(e,t){if(t(e.id,e.data)!==!0)for(let r of e.children)Yne(r,t)}var ma=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,ma.prototype)}deepFreeze(){let e=0;for(;e<this.length;)vB(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let r of e.children)this.fillCaches0(r,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(t)e=t;else return e}return e}isDescendantOf(e,t){for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}data(e){return this.get(e)?.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){return e===null?this:this.get(e)?.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let r=this.get(e);r&&Yne(r,t)}}traverse(e){qne(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this.parent(e),i=this.childrenArray(r),n=i.findIndex(a=>a.id===e);if(n<0)throw new Error("not expected");let s=i[n];return i=[...i],i[n]={...s,data:t},this.modifyArrayBy(r,i)}}modifyArrayBy(e,t){let r=e,i=t;for(;r!==null;){let s=i,a=r;if(r=this.parent(r),r===void 0)throw new Error;i=this.childrenArray(r);let o=i.findIndex(l=>l.id===a);if(o<0)throw new Error;i=[...i],i[o]={...i[o],children:s}}Object.setPrototypeOf(i,ma.prototype);let n=i;return n.fillCaches(),n}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let r of t)if(this.checkDuplicatedIdRec(r))return!0;return!1}addOp(e){let{parent:t,fi:r,id:i,data:n,children:s}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let a=t,o=this.childrenArray(a),l={fi:r,id:i,data:n,children:s};return o=[...o,l],o.sort((c,u)=>c.fi-u.fi),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(a,o),actual:e,reverse:{type:8,id:i}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let r=this.parent(t);if(r===void 0)return null;let i=this.childrenArray(r),n=i.findIndex(a=>a.id===t);e.localIndex=n,i=[...i];let s=i.splice(n,1)[0];return{data:this.modifyArrayBy(r,i),actual:e,reverse:{type:7,...s,parent:r}}}}moveOp(e){let{parent:t,fi:r,id:i}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:i});if(t!==null){let d=t;for(;d!==null;){if(d===void 0)throw new Error;if(d===i)throw new Wne("cyclic tree");d=this.parent(d)}}let n=this.parent(i);if(n===void 0)return null;let s=n,a=this.childrenArray(n),o=a.findIndex(d=>d.id===i);a=[...a];let l=a.splice(o,1)[0],c=this.modifyArrayBy(n,a);n=t,a=c.childrenArray(n);let u=l.fi;return l={...l,fi:r},a=[...a,l],a.sort((d,f)=>d.fi-f.fi),e.localIndex=a.indexOf(l),c=c.modifyArrayBy(n,a),{data:c,actual:e,reverse:{type:9,parent:s,fi:u,id:i}}}previous(e,t){if(t===null){let i=this.childrenArray(e);return i.length===0?null:i[i.length-1].id}let r=null;for(let i of this.childrenArray(e)){if(i.id===t)return r;r=i.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)+1;if(i<r.length)return r[i].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)-1;return i>=0?this.traverseSortPrevious(r[i].id):t}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push({...r,...i})}t.sort((r,i)=>NOe(r.sortKey,i.sortKey));for(let r of t)delete r.sortKey;return t}getWithSortKey(e){var t=e;let r=[],i=this.get(t),n=i;if(i!==void 0){for(;t;)r.splice(0,0,i.fi),t=this.parent(t),t!==null&&(i=this.get(t));return{...n,sortKey:r}}}insertBeforeHelper(e,t,r){return this.insertAfterHelper(e,this.previous(e,t),r)}insertAfterHelper(e,t,r){let i=this.childrenArray(e);if(t===null){if(i.length===0)return cp(0,r,r);{let n=i[0].fi;return cp(n-r,n,r)}}else{let n=this.get(t);if(n===void 0||this.parent(t)!==e)throw new Error("illegal args");let s=i.find(a=>a.fi>n.fi);if(s===void 0){let a=i[i.length-1].fi;return cp(a,a+r,r)}else return cp(n.fi,s.fi,r)}}},wM;(e=>{function t(r,i){if(i.type!==0)return null;if(Array.isArray(r)){let n=i.props,s={},a=[...r],o=!1;if(n)for(let l of Object.keys(n)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=a[c],a[c]=n[l],o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}else{let n=i.props,s={},a={...r},o=!1;if(n)for(let l of Object.keys(n)){s[l]=a[l];let c=n[l];c===void 0?delete a[l]:a[l]=c,o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}}e.runOp=t})(wM||(wM={}));var Vt=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Vt.prototype)}deepFreeze(){let e=0;for(;e<this.length;)vB(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){return this.get(e)?.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this,i=r.findIndex(s=>s.id===e);if(i<0)throw new Error("not expected");let n=r[i];return r=[...r],r[i]={...n,data:t},this.modifyArrayBy(r)}}modifyArrayBy(e){Object.setPrototypeOf(e,Vt.prototype);let t=e;return kOe()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:r,data:i}=e,n=this,s={fi:t,id:r,data:i};return n=[...n,s],n.sort((a,o)=>a.fi-o.fi),e.localIndex=n.indexOf(s),{data:this.modifyArrayBy(n),actual:e,reverse:{type:5,id:r}}}deleteOp(e){let{id:t}=e,r=this,i=r.findIndex(s=>s.id===t);if(i===-1)return null;e.localIndex=i,r=[...r];let n=r.splice(i,1)[0];return{data:this.modifyArrayBy(r),actual:e,reverse:{type:4,...n}}}moveOp(e){let{fi:t,id:r}=e,i=this;i=[...i];let n=i.findIndex(o=>o.id===r);if(n===-1)return null;let s=i[n].fi,a={...i[n],fi:t};return i[n]=a,i.sort((o,l)=>o.fi-l.fi),e.localIndex=i.indexOf(a),{data:this.modifyArrayBy(i),actual:e,reverse:{type:6,fi:s,id:r}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let r of this){if(r.id===e)return t;t=r.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let r=this;if(e===null){if(r.length===0)return cp(0,t,t);{let i=r[0].fi;return cp(i-t,i,t)}}else{let i=this.get(e);if(i===void 0)throw new Error("illegal args");let n=r.find(s=>s.fi>i.fi);if(n===void 0){let s=r[r.length-1].fi;return cp(s,s+t,t)}else return cp(i.fi,n.fi,t)}}};function lx(e){return e&&typeof e=="object"&&e instanceof us}var us=class{unusedFunOverridesTable(e){}runOp(e){let t=[],r=this,i=0,n={};for(;i<e.path.length;){if(t.push(r),r=r===void 0?void 0:r[e.path[i]],r!==void 0&&!lx(r))return null;i+=1}r=r?m4(r):new us;for(let[o,l]of Object.entries(e.props)){let c=r[o];n[o]=c,l===void 0?delete r[o]:r[o]=l}for(;i>0;){if(Object.keys(r).length===0){let o=t[i-1];o&&(r=m4(o),delete r[e.path[i-1]])}else{let o=t[i-1];if(o){let l=m4(o);l[e.path[i-1]]=r,r=l}else{let l=new us;l[e.path[i-1]]=r,r=l}}i-=1}let s=Object.setPrototypeOf(r,us.prototype),a={...e,props:n};return{data:s,actual:e,reverse:a}}},xp;(e=>{function t(n,s){return L2(n,s)??n}e.apply=t;function r(n,s){return bB(n,s)}e.merge=r;function i(n,s){let a=0,o=s.path,l=n;for(;a<o.length&&l!==void 0;){if(l=As.zoomOnce(l,o[a]),l===void 0)return s;if(!lx(l))return;a+=1}if(l===void 0)return s;if(lx(l))if(s.type===0){let c={...s.props};for(let u of Object.keys(l))delete c[u];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=xB([s],l);return c?(console.log(c),c):s}else return s}e.filterOp=i})(xp||(xp={}));function xB(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let s=n.id,a=L2(n.data,t[s]);if(r=r||a!==void 0,a===void 0&&(a=n.data),n.children){let o=xB(n.children,t);return o!==void 0?r=!0:o=n.children,{...n,id:s,data:a,children:o}}else return{...n,id:s,data:a}});if(r)return i}function ROe(e,t){if(t===void 0)return;let r=!1,i=e.map(n=>{let s=n.id,a=L2(n.data,t[s]);return r=r||a!==void 0,a===void 0&&(a=n.data),{...n,id:s,data:a}});if(r)return Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}function L2(e,t){if(!lx(t))return t;if(e instanceof ma){let r=xB(e,t);return r!==void 0&&Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}else{if(e instanceof Vt)return ROe(e,t);if(Array.isArray(e)){let r=!1,i=e.map((n,s)=>{let a=L2(n,t[s]);return r=r||a!==void 0,a===void 0&&(a=n),a});return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else{if(e instanceof us)return bB(e,t);if(e&&typeof e=="object"){let r={},i=!1;for(let[n,s]of Object.entries(e)){let a=L2(s,t[n]);i=i||a!==void 0,a===void 0&&(a=s),r[n]=a}return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}}}}function bB(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!lx(t))return t;if(!lx(e))return xp.apply(e,t);let r=new Set;for(let n of Object.keys(e))r.add(n);for(let n of Object.keys(t))r.add(n);let i=new us;for(let n of r){let s=bB(e===void 0?void 0:e[n],t===void 0?void 0:t[n]);i[n]=s}return i}function IOe(e,t){let r={cur:[],result:[],len:0};return e=z2(e,t,r)??e,[e,r.result]}function _M(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function SM(e){e&&(e.len-=1)}function OOe(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function Xne(e,t,r){let i=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(i=!0,a=o,r!==null))throw new Error("not supported");let l=z2(s.data,t,_M(r,a));SM(r),i=i||l!==void 0,l===void 0&&(l=s.data);let c=Xne(s.children,t,r);return c!==void 0?i=!0:c=s.children,{...s,id:a,data:l,children:c}});if(i)return n}function jOe(e,t,r){let i=!1,n=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(i=!0,a=o,r!==null))throw new Error("not supported");let l=z2(s.data,t,_M(r,a));return SM(r),i=i||l!==void 0,l===void 0&&(l=s.data),{...s,id:a,data:l}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}function z2(e,t,r){if(e instanceof ma){let i=Xne(e,t,r);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof Vt)return jOe(e,t,r);if(Array.isArray(e)){let i=!1,n=e.map((s,a)=>{let o=z2(s,t,_M(r,a));return SM(r),i=i||o!==void 0,o===void 0&&(o=s),o});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else if(e&&typeof e=="object"&&!yB(e)){let i={},n=!1;for(let[s,a]of Object.entries(e))if(s!=="name"&&s!=="variableId"){let o=t[s];if(typeof o=="string"){if(r!==null)throw new Error("not supported");n=!0,s=o}let l=z2(a,t,_M(r,s));SM(r),n=n||l!==void 0,l===void 0&&(l=a),i[s]=l}else i[s]=a;return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}else if(typeof e=="string"){let i=t[e];return i!==void 0&&OOe(r),i}else return}}var EM;(e=>{function t(r,i){let n=As.zoom(i,r.path);if(typeof n=="object"){let s={};for(let a of Object.keys(r.props))s[a]=n[a];return{...r,props:s}}else return{...r,props:{}}}e.replaceProps=t})(EM||(EM={}));var Ws;(e=>{function t(l,c){return{...l,path:l.path.slice(c)}}e.drop=t;function r(l,c){return i(l,c)?.data??l}e.applySimple=r;function i(l,c){let u=c.path;for(var d=[];;){let f;if(l instanceof us&&c.type===0&&(f=l.runOp({...c,path:u.slice(d.length)}),f===null&&(f=void 0)),f===void 0&&d.length===u.length&&(l instanceof ma||l instanceof Vt||l instanceof Qt?f=l.runOp(c):f=wM.runOp(l,c)),f!==void 0)if(f!==null){let y=f.data;for(let x=d.length-1;x>=0;x--){let w=u[x],_=d[x];if(_ instanceof ma){if(typeof w=="number")throw new Error("illegal arg");y=_.modifyById(w,y)}else if(_ instanceof Vt){if(typeof w=="number")throw new Error("illegal arg");y=_.modifyById(w,y)}else if(_ instanceof Qt){if(typeof w=="number")throw new Error("illegal arg");y=_.modifyById(w,y)}else if(_ instanceof us){let S={..._,[w]:y};y=Object.setPrototypeOf(S,us.prototype)}else if(typeof _=="object")if(Array.isArray(_)){if(typeof w=="string"&&(w=parseInt(w),isNaN(w)))throw new Error("Invalid path");let S=y;y=[..._],y[w]=S}else y={..._,[w]:y};else return null}return{data:y,actual:{...f.actual,path:u},reverse:{...f.reverse,path:u}}}else return null;let m=u[d.length],v;if(l instanceof ma){if(typeof m=="number")throw new Error("");v=l.get(m)?.data}else if(l instanceof Vt){if(typeof m=="number")throw new Error("");v=l.get(m)?.data}else l!==null&&(v=l[m]);if(v!==void 0)d.push(l),l=v;else return null}}e.apply=i;function n(l,c){for(let u=0;u<l.length&&u<c.length;u++)if(l[u]!==c[u])return!0;return!1}e.pathDisjoint=n;function s(l,c){if(l.length!==c.length)return!1;for(let u=0;u<l.length;u++)if(l[u]!==c[u])return!1;return!0}e.pathEq=s;function a(l,c){return n(l.path,c.path)}e.commutative=a;function o(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(u=>c.props[u]!==void 0):!1}e.subsumed=o})(Ws||(Ws={}));var Kj;(e=>{function t(){return[]}e.empty=t;function r(c,u){let d=[];for(let f of c){let[m,...v]=f.path;m===u&&d.push({...f,path:v})}return d}e.removePrefix=r;function i(c,u){return c.map(d=>({...d,path:[u,...d.path]}))}e.addPrefix=i;function n(c,u){return[...c,...u]}e.concat=n;function s(c,u){return[...c.filter(d=>!u.some(f=>Ws.subsumed(d,f))),...u]}e.compress=s;function a(c,u){return c.every(d=>u.every(f=>Ws.commutative(d,f)))}e.commutative=a;function o(c,u){for(let d of u){let f=l(c,d);f!==null&&(c=f.data)}return c}e.applyAll=o;function l(c,u){var d=c;let f=[],m=[];for(let v of u)try{if(v.type===3||v.type===5&&v.path[v.path.length-1]==="variables"){let y,x,w;if(v.type===3?(y=As.zoom(d,[...v.path,v.id]),w=Ws.apply(d,{...v,type:2})):(y=As.zoom(d,[...v.path,v.id,"value"]),w=Ws.apply(d,v)),w!==null){d=w.data;let[_,S]=IOe(d,{[v.id]:y});d=_;for(let P=0;P<S.length;P++){let M=S[P],C=M.pop();if(typeof C=="number"){let T=[C];for(let N=P+1;N<S.length;N++){let D=S[N],I=D[D.length-1];if(typeof I=="number"&&As.equal(M,D.slice(0,D.length-1)))T.push(I),S.splice(N,1);else break}let E=As.zoom(d,M);x=E.map((N,D)=>T.includes(D)?v.id:N),y=E,C=M.pop()}else{if(C==="alphaOverride"||C==="alpha"){y/=100;let T=y,E=As.zoom(d,M.slice(0,M.length-2)),N=E.layers.map(D=>D.id===M[M.length-1]?{...D,data:{...D.data,[C]:T}}:D);Object.setPrototypeOf(N,Object.getPrototypeOf(E.layers)),E.layers=N}x=v.id}f.push({type:0,path:M,props:{[C]:y}}),m.push({type:0,path:M,props:{[C]:x}})}m.push(w.reverse),f.push(w.actual)}}else{let y=Ws.apply(d,v);y!==null&&(f.push(y.actual),d=y.data,m.push(y.reverse))}}catch(y){if(y instanceof Wne)return null;throw y}return{data:d,actual:f,reverse:m.reverse()}}e.apply=l})(Kj||(Kj={}));var $ne=Symbol(),LOe=Symbol(),F3=Symbol(),F_=class{reportOp(e,t,r=[]){let i=this;if(t===null)return;i._current=t.data;let n=r;for(;!(i instanceof Qne);){let s=i._path,a=i._current;if(s!==""&&n.splice(0,0,s),i=i._parent,i===null)return;i.update(s,a)}i.push(n,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let r=t[F3];r&&r(),delete this._children[e]}}}},zOe=class extends F_{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,wM.runOp(this._current,e),e.path)}},BOe=class extends F_{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,Qt.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},Kne={get(e,t){if(t===F3)return()=>{e._parent=null};if(t===$ne)return e._current;if(t===LOe)return e;let{_current:r,_children:i}=e;if(t==="push"&&Array.isArray(r))throw new Error("not supported to expand array");let n=i===void 0?void 0:i[t];if(n!==void 0)return n;let s=r[t],a=V3(e,t,s);return a!==s?(i===void 0&&(i={},e._children=i),i[t]=a,a):s},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let r=e._current,i=Reflect.getOwnPropertyDescriptor(r,t);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:r[t]}}},FOe={...Kne,set(e,t,r){let i={type:0,props:{[t]:Vn(r)??r}};return e.deleteChildren(t),e.runOp(i),!0},deleteProperty(e,t){let r={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(r),!0}},VOe={...Kne,set(e,t,r){return r===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:r})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},wB=class extends F_{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[F3]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,r)=>{e(t,this.data(t))})}data(e){let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=t.get(e)?.data,s=V3(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}add(e,t,r,i,n){this.runOp({type:7,parent:e,fi:t,id:r,data:i,children:n})}move(e,t,r){this.runOp({type:9,parent:e,fi:t,id:r})}insertAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}insertBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}moveAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}moveBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},_B=class extends F_{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[F3]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id,n=this._current[r].fi;e(this.data(this._current[r].id),i,n)}}find(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id;if(e(this.data(i),i))return this.get(i)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=t.get(e)?.data,s=V3(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,r){this.runOp({type:4,fi:e,id:t,data:r})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}insertBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}moveAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}moveBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function g4(e,t,r){if(e.length>0){let i=e[e.length-1];if(i.type===0&&t.type===0&&As.equal(i.path,r)){Object.assign(i.props,t.props);return}}e.push({...t,path:r})}var Qne=class extends F_{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,r,i){g4(this.ts,t,e),g4(this.actual,r,e),g4(this.reverse,i,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function V3(e,t,r){return r instanceof ma?new wB(e,t,r):r instanceof Vt?new _B(e,t,r):r instanceof Qt?new Proxy(new BOe(e,t,r),VOe):r!==null&&typeof r=="object"?yB(r)?r:new Proxy(new zOe(e,t,r),FOe):r}function Zne(e){let t=new Qne(e);return[V3(t,"",e),t]}function B2(e,t){let[r,i]=Zne(e);return t(r),i.result()}function Vn(e){return e instanceof wB||e instanceof _B?e._current:e!==null&&typeof e=="object"?e[$ne]:e}var As;(e=>{function t(s,a){if(a.length===s.length)for(var o=0;o<s.length;){if(s[o]!==a[o])return!1;o+=1}else return!1;return!0}e.equal=t;function r(s,a,o){let l=n(o,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...a};return Object.keys(l).forEach(u=>{delete c[u]}),c}else return a}e.removeOverridden=r;function i(s,a){if((s instanceof ma||s instanceof wB)&&typeof a=="string"||(s instanceof Vt||s instanceof _B)&&typeof a=="string")return s.data(a);if(typeof a=="number"&&Array.isArray(s)||typeof a=="string"&&typeof s=="object"&&s!==null)return s[a]}e.zoomOnce=i;function n(s,a,o=0){for(;o<a.length&&s!==void 0;)s=i(s,a[o]),o+=1;return s}e.zoom=n})(As||(As={}));function UOe(e,t){let r=[];if(t.length===e.length)for(var i=0;i<e.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}function Vi(e,t){let r=[];if(t.length<=e.length)for(var i=0;i<t.length;){if(t[i]==="*")r.push(e[i]);else if(e[i]!==t[i])return null;i+=1}else return null;return r}var Jne=class{},uq=class extends Jne{constructor(e){super(),this.id=e}},dq=class extends Jne{constructor(e){super(),this.data=e}},Qj;try{Qj=new TextDecoder}catch{}var Nt,bp,Oe=0,Ao={},pi,up,Rl=0,Nu=0,Jo,Th,co=[],_i,hq={useRecords:!1,mapsAsObjects:!0},ese=class{},tse=new ese;tse.name="MessagePack 0xC1";var cx=!1,AM=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(Nt)return ose(()=>(Jj(),this?this.unpack(e,t):AM.prototype.unpack.call(hq,e,t)));bp=t>-1?t:e.length,Oe=0,Nu=0,up=null,Jo=null,Nt=e;try{_i=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw Nt=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof AM){if(Ao=this,this.structures)return pi=this.structures,AA();(!pi||pi.length>0)&&(pi=[])}else Ao=hq,(!pi||pi.length>0)&&(pi=[]);return AA()}unpackMultiple(e,t){let r,i=0;try{cx=!0;let n=e.length,s=this?this.unpack(e,n):H3.unpack(e,n);if(t){for(t(s);Oe<n;)if(i=Oe,t(AA())===!1)return}else{for(r=[s];Oe<n;)i=Oe,r.push(AA());return r}}catch(n){throw n.lastPosition=i,n.values=r,n}finally{cx=!1,Jj()}}_mergeStructures(e,t){e=e||[];for(let r=0,i=e.length;r<i;r++){let n=e[r];n&&(n.isShared=!0,r>=32&&(n.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],n=t[r];n&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=n)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function AA(){try{if(!Ao.trusted&&!cx){let t=pi.sharedLength||0;t<pi.length&&(pi.length=t)}let e=Mn();if(Oe==bp)pi.restoreStructures&&fq(),pi=null,Nt=null,Th&&(Th=null);else if(Oe>bp){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!cx)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw pi.restoreStructures&&fq(),Jj(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function fq(){for(let e in pi.restoreStructures)pi[e]=pi.restoreStructures[e];pi.restoreStructures=null}function Mn(){let e=Nt[Oe++];if(e<160)if(e<128){if(e<64)return e;{let t=pi[e&63]||Ao.getStructures&&rse()[e&63];return t?(t.read||(t.read=SB(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,Ao.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[nse()]=Mn();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(Mn(),Mn());return t}else{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=Mn();return t}else if(e<192){let t=e-160;if(Nu>=Oe)return up.slice(Oe-Rl,(Oe+=t)-Rl);if(Nu==0&&bp<140){let r=t<16?EB(t):ise(t);if(r!=null)return r}return Zj(t)}else{let t;switch(e){case 192:return null;case 193:return Jo?(t=Mn(),t>0?Jo[1].slice(Jo.position1,Jo.position1+=t):Jo[0].slice(Jo.position0,Jo.position0-=t)):tse;case 194:return!1;case 195:return!0;case 196:return v4(Nt[Oe++]);case 197:return t=_i.getUint16(Oe),Oe+=2,v4(t);case 198:return t=_i.getUint32(Oe),Oe+=4,v4(t);case 199:return zm(Nt[Oe++]);case 200:return t=_i.getUint16(Oe),Oe+=2,zm(t);case 201:return t=_i.getUint32(Oe),Oe+=4,zm(t);case 202:if(t=_i.getFloat32(Oe),Ao.useFloat32>2){let r=AB[(Nt[Oe]&127)<<1|Nt[Oe+1]>>7];return Oe+=4,(r*t+(t>0?.5:-.5)>>0)/r}return Oe+=4,t;case 203:return t=_i.getFloat64(Oe),Oe+=8,t;case 204:return Nt[Oe++];case 205:return t=_i.getUint16(Oe),Oe+=2,t;case 206:return t=_i.getUint32(Oe),Oe+=4,t;case 207:return Ao.int64AsNumber?(t=_i.getUint32(Oe)*4294967296,t+=_i.getUint32(Oe+4)):t=_i.getBigUint64(Oe),Oe+=8,t;case 208:return _i.getInt8(Oe++);case 209:return t=_i.getInt16(Oe),Oe+=2,t;case 210:return t=_i.getInt32(Oe),Oe+=4,t;case 211:return Ao.int64AsNumber?(t=_i.getInt32(Oe)*4294967296,t+=_i.getUint32(Oe+4)):t=_i.getBigInt64(Oe),Oe+=8,t;case 212:if(t=Nt[Oe++],t==114)return yq(Nt[Oe++]&63);{let r=co[t];if(r)return r.read?(Oe++,r.read(Mn())):r.noBuffer?(Oe++,r()):r(Nt.subarray(Oe,++Oe));throw new Error("Unknown extension "+t)}case 213:return t=Nt[Oe],t==114?(Oe++,yq(Nt[Oe++]&63,Nt[Oe++])):zm(2);case 214:return zm(4);case 215:return zm(8);case 216:return zm(16);case 217:return t=Nt[Oe++],Nu>=Oe?up.slice(Oe-Rl,(Oe+=t)-Rl):GOe(t);case 218:return t=_i.getUint16(Oe),Oe+=2,Nu>=Oe?up.slice(Oe-Rl,(Oe+=t)-Rl):WOe(t);case 219:return t=_i.getUint32(Oe),Oe+=4,Nu>=Oe?up.slice(Oe-Rl,(Oe+=t)-Rl):qOe(t);case 220:return t=_i.getUint16(Oe),Oe+=2,mq(t);case 221:return t=_i.getUint32(Oe),Oe+=4,mq(t);case 222:return t=_i.getUint16(Oe),Oe+=2,gq(t);case 223:return t=_i.getUint32(Oe),Oe+=4,gq(t);default:if(e>=224)return e-256;if(e===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+e)}}}var HOe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function SB(e,t){function r(){if(r.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map(s=>HOe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(Mn);return e.highByte===0&&(e.read=pq(t,e.read)),n()}let i={};for(let n=0,s=e.length;n<s;n++){let a=e[n];i[a]=Mn()}return i}return r.count=0,e.highByte===0?pq(t,r):r}var pq=(e,t)=>function(){let r=Nt[Oe++];if(r===0)return t();let i=e<32?-(e+(r<<5)):e+(r<<5),n=pi[i]||rse()[i];if(!n)throw new Error("Record id is not defined for "+i);return n.read||(n.read=SB(n,e)),n.read()};function rse(){let e=ose(()=>(Nt=null,Ao.getStructures()));return pi=Ao._mergeStructures(e,pi)}var Zj=U3,GOe=U3,WOe=U3,qOe=U3;function U3(e){let t;if(e<16&&(t=EB(e)))return t;if(e>64&&Qj)return Qj.decode(Nt.subarray(Oe,Oe+=e));let r=Oe+e,i=[];for(t="";Oe<r;){let n=Nt[Oe++];if((n&128)===0)i.push(n);else if((n&224)===192){let s=Nt[Oe++]&63;i.push((n&31)<<6|s)}else if((n&240)===224){let s=Nt[Oe++]&63,a=Nt[Oe++]&63;i.push((n&31)<<12|s<<6|a)}else if((n&248)===240){let s=Nt[Oe++]&63,a=Nt[Oe++]&63,o=Nt[Oe++]&63,l=(n&7)<<18|s<<12|a<<6|o;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(n);i.length>=4096&&(t+=Bs.apply(String,i),i.length=0)}return i.length>0&&(t+=Bs.apply(String,i)),t}function mq(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=Mn();return t}function gq(e){if(Ao.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[nse()]=Mn();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(Mn(),Mn());return t}}var Bs=String.fromCharCode;function ise(e){let t=Oe,r=new Array(e);for(let i=0;i<e;i++){let n=Nt[Oe++];if((n&128)>0){Oe=t;return}r[i]=n}return Bs.apply(String,r)}function EB(e){if(e<4)if(e<2){if(e===0)return"";{let t=Nt[Oe++];if((t&128)>1){Oe-=1;return}return Bs(t)}}else{let t=Nt[Oe++],r=Nt[Oe++];if((t&128)>0||(r&128)>0){Oe-=2;return}if(e<3)return Bs(t,r);let i=Nt[Oe++];if((i&128)>0){Oe-=3;return}return Bs(t,r,i)}else{let t=Nt[Oe++],r=Nt[Oe++],i=Nt[Oe++],n=Nt[Oe++];if((t&128)>0||(r&128)>0||(i&128)>0||(n&128)>0){Oe-=4;return}if(e<6){if(e===4)return Bs(t,r,i,n);{let s=Nt[Oe++];if((s&128)>0){Oe-=5;return}return Bs(t,r,i,n,s)}}else if(e<8){let s=Nt[Oe++],a=Nt[Oe++];if((s&128)>0||(a&128)>0){Oe-=6;return}if(e<7)return Bs(t,r,i,n,s,a);let o=Nt[Oe++];if((o&128)>0){Oe-=7;return}return Bs(t,r,i,n,s,a,o)}else{let s=Nt[Oe++],a=Nt[Oe++],o=Nt[Oe++],l=Nt[Oe++];if((s&128)>0||(a&128)>0||(o&128)>0||(l&128)>0){Oe-=8;return}if(e<10){if(e===8)return Bs(t,r,i,n,s,a,o,l);{let c=Nt[Oe++];if((c&128)>0){Oe-=9;return}return Bs(t,r,i,n,s,a,o,l,c)}}else if(e<12){let c=Nt[Oe++],u=Nt[Oe++];if((c&128)>0||(u&128)>0){Oe-=10;return}if(e<11)return Bs(t,r,i,n,s,a,o,l,c,u);let d=Nt[Oe++];if((d&128)>0){Oe-=11;return}return Bs(t,r,i,n,s,a,o,l,c,u,d)}else{let c=Nt[Oe++],u=Nt[Oe++],d=Nt[Oe++],f=Nt[Oe++];if((c&128)>0||(u&128)>0||(d&128)>0||(f&128)>0){Oe-=12;return}if(e<14){if(e===12)return Bs(t,r,i,n,s,a,o,l,c,u,d,f);{let m=Nt[Oe++];if((m&128)>0){Oe-=13;return}return Bs(t,r,i,n,s,a,o,l,c,u,d,f,m)}}else{let m=Nt[Oe++],v=Nt[Oe++];if((m&128)>0||(v&128)>0){Oe-=14;return}if(e<15)return Bs(t,r,i,n,s,a,o,l,c,u,d,f,m,v);let y=Nt[Oe++];if((y&128)>0){Oe-=15;return}return Bs(t,r,i,n,s,a,o,l,c,u,d,f,m,v,y)}}}}}function v4(e){return Ao.copyBuffers?Uint8Array.prototype.slice.call(Nt,Oe,Oe+=e):Nt.subarray(Oe,Oe+=e)}function zm(e){let t=Nt[Oe++];if(co[t])return co[t](Nt.subarray(Oe,Oe+=e));throw new Error("Unknown extension type "+t)}var vq=new Array(4096);function nse(){let e=Nt[Oe++];if(e>=160&&e<192){if(e=e-160,Nu>=Oe)return up.slice(Oe-Rl,(Oe+=e)-Rl);if(!(Nu==0&&bp<180))return Zj(e)}else return Oe--,Mn();let t=(e<<5^(e>1?_i.getUint16(Oe):e>0?Nt[Oe]:0))&4095,r=vq[t],i=Oe,n=Oe+e-3,s,a=0;if(r&&r.bytes==e){for(;i<n;){if(s=_i.getUint32(i),s!=r[a++]){i=1879048192;break}i+=4}for(n+=3;i<n;)if(s=Nt[i++],s!=r[a++]){i=1879048192;break}if(i===n)return Oe=i,r.string;n-=3,i=Oe}for(r=[],vq[t]=r,r.bytes=e;i<n;)s=_i.getUint32(i),r.push(s),i+=4;for(n+=3;i<n;)s=Nt[i++],r.push(s);let o=e<16?EB(e):ise(e);return o!=null?r.string=o:r.string=Zj(e)}var yq=(e,t)=>{var r=Mn();let i=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let n=pi[e];return n&&n.isShared&&((pi.restoreStructures||(pi.restoreStructures=[]))[e]=n),pi[e]=r,r.read=SB(r,i),r.read()},sse=typeof self=="object"?self:global;co[0]=()=>{};co[0].noBuffer=!0;co[101]=()=>{let e=Mn();return(sse[e[0]]||Error)(e[1])};co[105]=e=>{let t=_i.getUint32(Oe-4);Th||(Th=new Map);let r=Nt[Oe],i;r>=144&&r<160||r==220||r==221?i=[]:i={};let n={target:i};Th.set(t,n);let s=Mn();return n.used?Object.assign(i,s):(n.target=s,s)};co[112]=e=>{let t=_i.getUint32(Oe-4),r=Th.get(t);return r.used=!0,r.target};co[115]=()=>new Set(Mn());var ase=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");co[116]=e=>{let t=e[0],r=ase[t];if(!r)throw new Error("Could not find typed array for code "+t);return new sse[r](Uint8Array.prototype.slice.call(e,1).buffer)};co[120]=()=>{let e=Mn();return new RegExp(e[0],e[1])};co[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=Oe;Oe+=t-4,Jo=[Mn(),Mn()],Jo.position0=0,Jo.position1=0;let i=Oe;Oe=r;try{return Mn()}finally{Oe=i}};co[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function ose(e){let t=bp,r=Oe,i=Rl,n=Nu,s=up,a=Th,o=Jo,l=new Uint8Array(Nt.slice(0,bp)),c=pi,u=pi.slice(0,pi.length),d=Ao,f=cx,m=e();return bp=t,Oe=r,Rl=i,Nu=n,up=s,Th=a,Jo=o,Nt=l,cx=f,pi=c,pi.splice(0,pi.length,...u),Ao=d,_i=new DataView(Nt.buffer,Nt.byteOffset,Nt.byteLength),m}function Jj(){Nt=null,Th=null,pi=null}function YOe(e){e.unpack?co[e.type]=e.unpack:co[e.type]=e}var AB=new Array(147);for(let e=0;e<256;e++)AB[e]=+("1e"+Math.floor(45.15-e*.30103));var H3=new AM({useRecords:!1});H3.unpack;H3.unpackMultiple;H3.unpack;var XOe=new Float32Array(1);new Uint8Array(XOe.buffer,0,4);var cT;try{cT=new TextEncoder}catch{}var CM,CB,G3=typeof Buffer<"u",y4=G3?Buffer.allocUnsafeSlow:Uint8Array,lse=G3?Buffer:Uint8Array,xq=G3?4294967296:2144337920,nt,On,Ge=0,du,hu=null,$Oe=/[\u0080-\uFFFF]/,z1=Symbol("record-id"),cse=class extends AM{constructor(e){super(e),this.offset=0;let t,r,i,n,s,a=0,o=lse.prototype.utf8Write?function(C,T,E){return nt.utf8Write(C,T,E)}:cT&&cT.encodeInto?function(C,T){return cT.encodeInto(C,nt.subarray(T)).written}:!1,l=this;e||(e={});let c=e&&e.sequential,u=e.structures||e.saveStructures,d=e.maxSharedStructures;if(d==null&&(d=u?32:0),d>8160)throw new Error("Maximum maxSharedStructure is 8160");let f=e.maxOwnStructures;f==null&&(f=u?32:64),c&&!e.saveStructures&&(this.structures=[]);let m=d>32||f+d>64,v=d+64,y=d+f+64;if(y>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let x=[],w=0,_=0;this.pack=this.encode=function(C,T){if(nt||(nt=new y4(8192),On=new DataView(nt.buffer,0,8192),Ge=0),du=nt.length-10,du-Ge<2048?(nt=new y4(nt.length),On=new DataView(nt.buffer,0,nt.length),du=nt.length-10,Ge=0):Ge=Ge+7&2147483640,t=Ge,s=l.structuredClone?new Map:null,l.bundleStrings?(hu=["",""],nt[Ge++]=214,nt[Ge++]=98,hu.position=Ge-t,Ge+=4):hu=null,r=l.structures,r){r.uninitialized&&(r=l._mergeStructures(l.getStructures()));let E=r.sharedLength||0;if(E>d)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let N=0;N<E;N++){let D=r[N];if(!D)continue;let I,j=r.transitions;for(let L=0,B=D.length;L<B;L++){let q=D[L];I=j[q],I||(I=j[q]=Object.create(null)),j=I}j[z1]=N+64}a=E}c||(r.nextId=E+64)}i&&(i=!1),n=r||[];try{if(S(C),hu){On.setUint32(hu.position+t,Ge-hu.position-t);let E=hu;hu=null,S(E[0]),S(E[1])}if(l.offset=Ge,s&&s.idsToInsert){Ge+=s.idsToInsert.length*6,Ge>du&&M(Ge),l.offset=Ge;let E=QOe(nt.subarray(t,Ge),s.idsToInsert);return s=null,E}return T&ZOe?(nt.start=t,nt.end=Ge,nt):nt.subarray(t,Ge)}finally{if(r){if(_<10&&_++,w>1e4)r.transitions=null,_=0,w=0,x.length>0&&(x=[]);else if(x.length>0&&!c){for(let E=0,N=x.length;E<N;E++)x[E][z1]=0;x=[]}if(i&&l.saveStructures){let E=r.sharedLength||d;r.length>E&&(r=r.slice(0,E));let N=nt.subarray(t,Ge);return l.saveStructures(r,a)===!1?(l._mergeStructures(l.getStructures()),l.pack(C)):(a=E,N)}}T&JOe&&(Ge=t)}};let S=C=>{Ge>du&&(nt=M(Ge));var T=typeof C,E;if(T==="string"){let N=C.length;if(hu&&N>=8&&N<4096){let j=$Oe.test(C);hu[j?0:1]+=C,nt[Ge++]=193,S(j?-N:N);return}let D;N<32?D=1:N<256?D=2:N<65536?D=3:D=5;let I=N*3;if(Ge+I>du&&(nt=M(Ge+I)),N<64||!o){let j,L,B,q=Ge+D;for(j=0;j<N;j++)L=C.charCodeAt(j),L<128?nt[q++]=L:L<2048?(nt[q++]=L>>6|192,nt[q++]=L&63|128):(L&64512)===55296&&((B=C.charCodeAt(j+1))&64512)===56320?(L=65536+((L&1023)<<10)+(B&1023),j++,nt[q++]=L>>18|240,nt[q++]=L>>12&63|128,nt[q++]=L>>6&63|128,nt[q++]=L&63|128):(nt[q++]=L>>12|224,nt[q++]=L>>6&63|128,nt[q++]=L&63|128);E=q-Ge-D}else E=o(C,Ge+D,I);E<32?nt[Ge++]=160|E:E<256?(D<2&&nt.copyWithin(Ge+2,Ge+1,Ge+1+E),nt[Ge++]=217,nt[Ge++]=E):E<65536?(D<3&&nt.copyWithin(Ge+3,Ge+2,Ge+2+E),nt[Ge++]=218,nt[Ge++]=E>>8,nt[Ge++]=E&255):(D<5&&nt.copyWithin(Ge+5,Ge+3,Ge+3+E),nt[Ge++]=219,On.setUint32(Ge,E),Ge+=4),Ge+=E}else if(T==="number")if(C>>>0===C)C<64?nt[Ge++]=C:C<256?(nt[Ge++]=204,nt[Ge++]=C):C<65536?(nt[Ge++]=205,nt[Ge++]=C>>8,nt[Ge++]=C&255):(nt[Ge++]=206,On.setUint32(Ge,C),Ge+=4);else if(C>>0===C)C>=-32?nt[Ge++]=256+C:C>=-128?(nt[Ge++]=208,nt[Ge++]=C+256):C>=-32768?(nt[Ge++]=209,On.setInt16(Ge,C),Ge+=2):(nt[Ge++]=210,On.setInt32(Ge,C),Ge+=4);else{let N;if((N=this.useFloat32)>0&&C<4294967296&&C>=-2147483648){nt[Ge++]=202,On.setFloat32(Ge,C);let D;if(N<4||(D=C*AB[(nt[Ge]&127)<<1|nt[Ge+1]>>7])>>0===D){Ge+=4;return}else Ge--}nt[Ge++]=203,On.setFloat64(Ge,C),Ge+=8}else if(T==="object")if(!C)nt[Ge++]=192;else{if(s){let D=s.get(C);if(D){if(!D.id){let I=s.idsToInsert||(s.idsToInsert=[]);D.id=I.push(D)}nt[Ge++]=214,nt[Ge++]=112,On.setUint32(Ge,D.id),Ge+=4;return}else s.set(C,{offset:Ge-t})}let N=C.constructor;if(N===Object)P(C,!0);else if(N===Array){E=C.length,E<16?nt[Ge++]=144|E:E<65536?(nt[Ge++]=220,nt[Ge++]=E>>8,nt[Ge++]=E&255):(nt[Ge++]=221,On.setUint32(Ge,E),Ge+=4);for(let D=0;D<E;D++)S(C[D])}else if(N===Map){E=C.size,E<16?nt[Ge++]=128|E:E<65536?(nt[Ge++]=222,nt[Ge++]=E>>8,nt[Ge++]=E&255):(nt[Ge++]=223,On.setUint32(Ge,E),Ge+=4);for(let[D,I]of C)S(D),S(I)}else{for(let D=0,I=CM.length;D<I;D++){let j=CB[D];if(C instanceof j){let L=CM[D];if(L.write){L.type&&(nt[Ge++]=212,nt[Ge++]=L.type,nt[Ge++]=0),S(L.write.call(this,C));return}let B=nt,q=On,G=Ge;nt=null;let Y;try{Y=L.pack.call(this,C,X=>(nt=B,B=null,Ge+=X,Ge>du&&M(Ge),{target:nt,targetView:On,position:Ge-X}),S)}finally{B&&(nt=B,On=q,Ge=G,du=nt.length-10)}Y&&(Y.length+Ge>du&&M(Y.length+Ge),Ge=KOe(Y,nt,Ge,L.type));return}}P(C,!C.hasOwnProperty)}}else if(T==="boolean")nt[Ge++]=C?195:194;else if(T==="bigint"){if(C<BigInt(1)<<BigInt(63)&&C>=-(BigInt(1)<<BigInt(63)))nt[Ge++]=211,On.setBigInt64(Ge,C);else if(C<BigInt(1)<<BigInt(64)&&C>0)nt[Ge++]=207,On.setBigUint64(Ge,C);else if(this.largeBigIntToFloat)nt[Ge++]=203,On.setFloat64(Ge,Number(C));else throw new RangeError(C+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");Ge+=8}else if(T==="undefined")this.encodeUndefinedAsNil?nt[Ge++]=192:(nt[Ge++]=212,nt[Ge++]=0,nt[Ge++]=0);else if(T==="function")S(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+T)},P=this.useRecords===!1?this.variableMapSize?C=>{let T=Object.keys(C),E=T.length;E<16?nt[Ge++]=128|E:E<65536?(nt[Ge++]=222,nt[Ge++]=E>>8,nt[Ge++]=E&255):(nt[Ge++]=223,On.setUint32(Ge,E),Ge+=4);let N;for(let D=0;D<E;D++)S(N=T[D]),S(C[N])}:(C,T)=>{nt[Ge++]=222;let E=Ge-t;Ge+=2;let N=0;for(let D in C)(T||C.hasOwnProperty(D))&&(S(D),S(C[D]),N++);nt[E+++t]=N>>8,nt[E+t]=N&255}:C=>{let T=Object.keys(C),E,N=n.transitions||(n.transitions=Object.create(null)),D=0;for(let j=0,L=T.length;j<L;j++){let B=T[j];E=N[B],E||(E=N[B]=Object.create(null),D++),N=E}let I=N[z1];if(I)I>=96&&m?(nt[Ge++]=((I-=96)&31)+96,nt[Ge++]=I>>5):nt[Ge++]=I;else{I=n.nextId,I||(I=64),I<v&&this.shouldShareStructure&&!this.shouldShareStructure(T)?(I=n.nextOwnId,I<y||(I=v),n.nextOwnId=I+1):(I>=y&&(I=v),n.nextId=I+1);let j=T.highByte=I>=96&&m?I-96>>5:-1;N[z1]=I,n[I-64]=T,I<v?(T.isShared=!0,n.sharedLength=I-63,i=!0,j>=0?(nt[Ge++]=(I&31)+96,nt[Ge++]=j):nt[Ge++]=I):(j>=0?(nt[Ge++]=213,nt[Ge++]=114,nt[Ge++]=(I&31)+96,nt[Ge++]=j):(nt[Ge++]=212,nt[Ge++]=114,nt[Ge++]=I),D&&(w+=_*D),x.length>=f&&(x.shift()[z1]=0),x.push(N),S(T))}for(let j=0,L=T.length;j<L;j++)S(C[T[j]])},M=C=>{let T;if(C>16777216){if(C-t>xq)throw new Error("Packed buffer would be larger than maximum buffer size");T=Math.min(xq,Math.round(Math.max((C-t)*(C>67108864?1.25:2),4194304)/4096)*4096)}else T=(Math.max(C-t<<2,nt.length-1)>>12)+1<<12;let E=new y4(T);return On=new DataView(E.buffer,0,T),nt.copy?nt.copy(E,0,t,C):E.set(nt.slice(t,C)),Ge-=t,t=0,du=E.length-10,nt=E}}useBuffer(e){nt=e,On=new DataView(nt.buffer,nt.byteOffset,nt.byteLength),Ge=0}};CB=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,ese];CM=[{pack(e,t,r){let i=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:n,targetView:s,position:a}=t(6);n[a++]=214,n[a++]=255,s.setUint32(a,i)}else if(i>0&&i<17179869184){let{target:n,targetView:s,position:a}=t(10);n[a++]=215,n[a++]=255,s.setUint32(a,e.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(a+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:n,targetView:s,position:a}=t(3);n[a++]=212,n[a++]=255,n[a++]=255}else{let{target:n,targetView:s,position:a}=t(15);n[a++]=199,n[a++]=12,n[a++]=255,s.setUint32(a,e.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(i)))}}},{pack(e,t,r){let i=Array.from(e),{target:n,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(n[s++]=212,n[s++]=115,n[s++]=0),r(i)}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=101,i[n++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=120,i[n++]=0),r([e.source,e.flags])}},{pack(e,t){this.structuredClone?bq(e,16,t):wq(G3?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==lse&&this.structuredClone?bq(e,ase.indexOf(r.name),t):wq(e,t)}},{pack(e,t){let{target:r,position:i}=t(1);r[i]=193}}];function bq(e,t,r,i){let n=e.byteLength;if(n+1<256){var{target:s,position:a}=r(4+n);s[a++]=199,s[a++]=n+1}else if(n+1<65536){var{target:s,position:a}=r(5+n);s[a++]=200,s[a++]=n+1>>8,s[a++]=n+1&255}else{var{target:s,position:a,targetView:o}=r(7+n);s[a++]=201,o.setUint32(a,n+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function wq(e,t){let r=e.byteLength;var i,n;if(r<256){var{target:i,position:n}=t(r+2);i[n++]=196,i[n++]=r}else if(r<65536){var{target:i,position:n}=t(r+3);i[n++]=197,i[n++]=r>>8,i[n++]=r&255}else{var{target:i,position:n,targetView:s}=t(r+5);i[n++]=198,s.setUint32(n,r),n+=4}i.set(e,n)}function KOe(e,t,r,i){let n=e.length;switch(n){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:n<256?(t[r++]=199,t[r++]=n):n<65536?(t[r++]=200,t[r++]=n>>8,t[r++]=n&255):(t[r++]=201,t[r++]=n>>24,t[r++]=n>>16&255,t[r++]=n>>8&255,t[r++]=n&255)}return t[r++]=i,t.set(e,r),r+=n,r}function QOe(e,t){let r,i=t.length*6,n=e.length-i;for(t.sort((s,a)=>s.offset>a.offset?1:-1);r=t.pop();){let s=r.offset,a=r.id;e.copyWithin(s+i,s,n),i-=6;let o=s+i;e[o++]=214,e[o++]=105,e[o++]=a>>24,e[o++]=a>>16&255,e[o++]=a>>8&255,e[o++]=a&255,n=s}return e}function tb(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");CB.unshift(e.Class),CM.unshift(e)}YOe(e)}var use=new cse({useRecords:!1});use.pack;use.pack;var ZOe=512,JOe=1024,_q=new cse({structuredClone:!0});tb({Class:Qt.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Qt.prototype),e}});tb({Class:Vt.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,Vt.prototype),e}});tb({Class:ma.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,ma.prototype),e}});tb({Class:uq.prototype.constructor,type:4,write(e){return e.id},read(e){return new uq(e)}});tb({Class:dq.prototype.constructor,type:5,write(e){return e.data},read(e){return new dq(e)}});tb({Class:us.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,us.prototype),e}});function eje(e){var t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){let i=e[r];t=(t<<5)-t+i,t=t&t}return t}function eL(e){if(yB(e))return e;if(Array.isArray(e))return e.map(eL);if(typeof e=="object"&&e!==null){let t={};for(let r of Object.keys(e).sort())t[r]=eL(e[r]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var tL;(e=>{function t(n){return _q.pack(n)}e.serialize=t;function r(n){return _q.unpack(n)}e.deserialize=r;function i(n){return eje(t(eL(n))).toString()}e.checksum=i})(tL||(tL={}));var Sq;(e=>{function t(i){return i.type==="Conditional"?i.condition.type==="Distance"?"Distance":"StateChange":i.type}e.toEventUIType=t;function r(i){return i==="Distance"||i==="StateChange"?"Conditional":i}e.fromEventUIType=r})(Sq||(Sq={}));function Eq(e){return e==="MouseDown"||e==="MouseUp"||e==="KeyDown"||e==="KeyUp"||e==="Collision"||e==="Trigger"}var Ma={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Particles","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseHover:["Transition","Animation","Particles","Create","Destroy","SwitchCamera","SceneTransition","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Scroll:["Transition","Animation","Create","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Start:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Conditional:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MouseUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],MousePress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyDown:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyUp:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],KeyPress:["Transition","Animation","Audio","Particles","Video","Link","Create","SwitchCamera","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],GameControl:["Transition","Animation","Audio","Particles","Create","Conditional"],Collision:["Transition","Animation","Audio","Particles","Video","Create","Destroy","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Trigger:["Transition","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],Resize:["Transition","Animation","Audio","Particles","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],VariableChange:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],API:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],WEBHOOK:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"],AIAssistantListener:["SetVariable"],AIAssistantTrigger:["Transition","Animation","Audio","Particles","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset","SetVariable","DynamicVariablePlay","Conditional","ClearLocalStorage","UserAPI"]},Aq;(e=>{function t(i){return i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress"||i.type==="KeyDown"||i.type==="KeyUp"||i.type==="KeyPress"}e.is=t;function r(i){return i==="MouseDown"||i==="MouseUp"||i==="MousePress"?{type:i,mode:"Object",disabled:!1,actions:new Vt}:{type:i,disabled:!1,key:void 0,actions:new Vt}}e.defaultData=r})(Aq||(Aq={}));var TM;(e=>{function t(r){return{type:"Property",value:[r??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(TM||(TM={}));var rL;(e=>{function t(n){return{type:"Comparison",operator:"==",lOperand:TM.propertyDefaultData(n),rOperand:{...TM.valueDefaultData}}}e.comparisonDefaultData=t;function r(n){return{type:"Distance",toObject:n??null,fromObject:n??null,distance:200}}e.distanceDefaultData=r;function i(n,s){return{type:"State",object:n??null,state:s??null}}e.stateDefaultData=i})(rL||(rL={}));var Cq;(e=>{function t(r){return r.find(i=>i==="ifActions"||i==="elseActions")!==void 0}e.isConditionalSubActions=t})(Cq||(Cq={}));var Tq;(e=>{function t(i){return i.type==="Conditional"}e.is=t;function r(i){return{type:"Conditional",disabled:!1,inActions:new Vt,outActions:new Vt,condition:rL.distanceDefaultData(i)}}e.defaultData=r})(Tq||(Tq={}));var Mq;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new Vt,drop:new Vt}})(Mq||(Mq={}));var iL;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new Vt})(iL||(iL={}));var nL;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(nL||(nL={}));var Pq;(e=>{function t(i){return i.type==="MouseHover"}e.is=t;function r(){return{type:"MouseHover",disabled:!1,actions:new Vt}}e.defaultData=r})(Pq||(Pq={}));var Dq;(e=>{function t(i){return i.type==="Scroll"}e.is=t;function r(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new Vt}}e.defaultData=r})(Dq||(Dq={}));var Nq;(e=>{function t(i){return i.type==="Start"}e.is=t;function r(){return{type:"Start",disabled:!1,actions:new Vt}}e.defaultData=r})(Nq||(Nq={}));var kq;(e=>{function t(i){return i.type==="Collision"}e.is=t;function r(){return{type:"Collision",disabled:!1,target:"character",actions:new Vt}}e.defaultData=r})(kq||(kq={}));var Rq;(e=>{function t(i){return i.type==="Trigger"}e.is=t;function r(i,n){return{type:"Trigger",disabled:!1,target:"all",triggeringObjects:[],actions:new Vt,triggerZone:"box",position:n.toArray(),rotation:[0,0,0],size:i.toArray(),radius:i.length()/2,helperVisible:!0}}e.defaultData=r})(Rq||(Rq={}));var sL;(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function t(a){return a.type==="Resize"}e.is=t;function r(a){return typeof a=="string"?a:"custom"}e.sizeToDevice=r;function i(a){return typeof a=="string"?[...e.defaultSizes[a]]:[...a]}e.deviceToSize=i;function n(){let a={size:"mobile",operator:"<",actions:new Vt},o={size:"tablet",operator:"<",actions:new Vt},l={size:[...e.defaultSizes.custom],operator:"<>",actions:new Vt},c=new Vt;return c.push({id:Ct.generateUUID(),fi:0,data:a},{id:Ct.generateUUID(),fi:1,data:o},{id:Ct.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:c}}e.defaultData=n;function s(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new Vt}}e.defaultBreakpointData=s})(sL||(sL={}));var aL;(e=>{e.propertyPaths={Position:["position"],"Position X":["position","x"],"Position Y":["position","y"],"Position Z":["position","z"],Rotation:["rotation"],"Rotation X":["rotation","x"],"Rotation Y":["rotation","y"],"Rotation Z":["rotation","z"],Scale:["scale"],"Scale X":["scale","x"],"Scale Y":["scale","y"],"Scale Z":["scale","z"],Width:["width"],Height:["height"],Depth:["depth"],"Mouse Position X":["mouse","x"],"Mouse Position Y":["mouse","y"],"Mouse Pressed":["mouse","pressed"],"Screen Width":["mouse","width"],"Screen Height":["mouse","height"],"Hit Position X":["raycast","x"],"Hit Position Y":["raycast","y"],"Hit Position Z":["raycast","z"],"Hit Object Position X":["raycast","objX"],"Hit Object Position Y":["raycast","objY"],"Hit Object Position Z":["raycast","objZ"]};function t(i){return i.type==="VariableChange"}e.is=t;function r(){return{disabled:!1,type:"VariableChange",actions:new Vt,variableId:"",objectId:null,property:"Position X"}}e.defaultData=r})(aL||(aL={}));var Iq;(e=>{function t(i){return i.type==="API"}e.is=t;function r(){return{disabled:!1,type:"API",successActions:new Vt,errorActions:new Vt,userAPIId:""}}e.defaultData=r})(Iq||(Iq={}));var Oq;(e=>{function t(i){return i.type==="WEBHOOK"}e.is=t;function r(){return{disabled:!1,type:"WEBHOOK",actions:new Vt,userWebhookId:""}}e.defaultData=r})(Oq||(Oq={}));var jq;(e=>{function t(i){return i.type==="AIAssistantListener"}e.is=t;function r(){return{disabled:!1,type:"AIAssistantListener",actions:new Vt,analysis:"average",analysisRange:[0,71],analysisSingle:0}}e.defaultData=r})(jq||(jq={}));var Lq;(e=>{function t(i){return i.type==="AIAssistantTrigger"}e.is=t;function r(){return{disabled:!1,description:"",type:"AIAssistantTrigger",actions:new Vt}}e.defaultData=r})(Lq||(Lq={}));var rb="personal camera",Yw="a218fcc3-276b-49b9-b485-49037fd14f5f",tje=2960946,ul=5526619,vh;(e=>{function t(v,y){return v[0]===y[0]&&v[1]===y[1]}e.isEqual=t;function r(v,y,x){return[v[0]+(y[0]-v[0])*x,v[1]+(y[1]-v[1])*x]}e.lerp=r;function i(v,y){return[v[0]+y[0],v[1]+y[1]]}e.add=i;function n(v,y){return[v[0]-y[0],v[1]-y[1]]}e.sub=n;function s(v,y){return[v[0]*y[0],v[1]*y[1]]}e.multiply=s;function a(v,y){return[v[0]/y[0],v[1]/y[1]]}e.divide=a;function o(v,y){return Math.pow(y[0]-v[0],2)+Math.pow(y[1]-v[1],2)}e.distanceSquared=o;function l(v,y){return Math.sqrt(o(v,y))}e.distance=l;function c(v,y){return v[0]*y[0]+v[1]*y[1]}e.dot=c;function u(v,y){return[v[0]*y,v[1]*y]}e.scalarMultiply=u;function d(v,y,x){let w=e.sub(y,v),_=e.sub(x,v),S=e.dot(w,_)/e.dot(w,w),P=e.scalarMultiply(w,S);return e.add(v,P)}e.projectionOnto=d;function f(v,y,x){return l(v,d(v,y,x))}e.projectionOntoDistance=f;function m(v,y){return[(v[0]+y[0])*.5,(v[1]+y[1])*.5]}e.center=m})(vh||(vh={}));var Pg;(e=>{function t(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}e.isEqual=t;function r(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}e.add=r;function i(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}e.sub=i;function n(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}e.div=n;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}e.mul=s;function a(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}e.dist=a;function o(l,c,u){return[l[0]+(c[0]-l[0])*u,l[1]+(c[1]-l[1])*u,l[2]+(c[2]-l[2])*u]}e.lerp=o})(Pg||(Pg={}));var MM;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]}e.isEqual=t;function r(i,n,s){return[i[0]+(n[0]-i[0])*s,i[1]+(n[1]-i[1])*s,i[2]+(n[2]-i[2])*s,i[3]+(n[3]-i[3])*s]}e.lerp=r})(MM||(MM={}));var zq;(e=>{let t=180/Math.PI,r=Math.PI/180;function i(o){return typeof o=="number"?o*t:o}function n(o){return typeof o=="number"?o*r:o}function s(o){return[i(o[0]),i(o[1]),i(o[2])]}e.radToDeg=s;function a(o){return[n(o[0]),n(o[1]),n(o[2])]}e.degToRad=a})(zq||(zq={}));var ux;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(n,s){for(let a=0;a<16;a++)if(n[a]!==s[a])return!1;return!0}e.isEqual=t;function r(n){return n??e.identity}e.simplify=r;function i(n,s){let a=s.slice(0);for(var o=0,l=s.length;o<l;o+=3){let c=n[3]*s[o]+n[7]*s[o+1]+n[11]*s[o+2]+n[15];a[o]=(n[0]*s[o]+n[4]*s[o+1]+n[8]*s[o+2]+n[12])/c,a[o+1]=(n[1]*s[o]+n[5]*s[o+1]+n[9]*s[o+2]+n[13])/c,a[o+2]=(n[2]*s[o]+n[6]*s[o+1]+n[10]*s[o+2]+n[14])/c}return a}e.applyMatrix4=i})(ux||(ux={}));var ha;(e=>{function t(c){return typeof c=="object"&&typeof c.r=="number"&&typeof c.g=="number"&&typeof c.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function r(c){return{r:Math.round(c.r*255),g:Math.round(c.g*255),b:Math.round(c.b*255),a:1}}e.toRgb255a1=r;function i(c){return{r:c.r,g:c.g,b:c.b}}e.clone=i;function n(c){return c=Math.floor(c),{r:(c>>16&255)/255,g:(c>>8&255)/255,b:(c&255)/255}}e.fromHex=n;function s(c){return Math.round(c.r*255)*65536+Math.round(c.g*255)*256+Math.round(c.b*255)}e.toHex=s;function a(c,u){return c.r===u.r&&c.g===u.g&&c.b===u.b}e.equals=a;function o(c,u){return c.r.toFixed(2)===u.r.toFixed(2)&&c.g.toFixed(2)===u.g.toFixed(2)&&c.b.toFixed(2)===u.b.toFixed(2)}e.equalsFixed=o;function l(c,u,d){return{r:c.r+(u.r-c.r)*d,g:c.g+(u.g-c.g)*d,b:c.b+(u.b-c.b)*d}}e.lerp=l})(ha||(ha={}));var Ri;(e=>{e.white={...ha.white,a:1},e.transparent={...ha.white,a:0};function t(l){return{r:l[0],g:l[1],b:l[2],a:l[3]}}e.from0to1=t;function r(l,c){return{...ha.fromHex(l),a:c}}e.fromHexAndA=r;function i(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:l.a}}e.toRgb255a1=i;function n(l,c){return ha.equals(l,c)&&l.a===c.a}e.equals=n;function s(l,c){return ha.equalsFixed(l,c)&&l.a.toFixed(2)===c.a.toFixed(2)}e.equalsFixed=s;function a(l,c,u){return{r:l.r+(c.r-l.r)*u,g:l.g+(c.g-l.g)*u,b:l.b+(c.b-l.b)*u,a:l.a+(c.a-l.a)*u}}e.lerp=a;function o({r:l,g:c,b:u,a:d}=e.white){return`rgba(${l*255}, ${c*255}, ${u*255}, ${d})`}e.toStyle=o})(Ri||(Ri={}));var oL;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(oL||(oL={}));var rje=(e=>(e[e.LINEAR=0]="LINEAR",e[e.EASE=1]="EASE",e[e.EASE_IN=2]="EASE_IN",e[e.EASE_OUT=3]="EASE_OUT",e[e.EASE_IN_OUT=4]="EASE_IN_OUT",e[e.CUBIC=5]="CUBIC",e[e.SPRING=6]="SPRING",e))(rje||{}),lL;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(lL||(lL={}));var cL;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})(cL||(cL={}));var Yf;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))(Yf||(Yf={}));function Bq(e){return typeof e=="string"&&e.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e):!1}var qg;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(r){return e.all.includes(r)}e.is=t})(qg||(qg={}));var dx;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(r){return r.type==="PerspectiveCamera"?r.perspective?.zoom??1:r.orthographic?.zoom??1}e.getZoom=t})(dx||(dx={}));var dp;(e=>{function t(i,n=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*n,0,0]},grid:{count:[2,2,2],size:i.map(s=>s*(1+n)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function r(i,n){let s={...i};if(dse.forEach(a=>{Object.assign(s,{[a]:n[a]??i[a]})}),s.radial={...i.radial},n.radial){let a=i.radial,o=n.radial;hse.forEach(l=>{Object.assign(s.radial,{[l]:o[l]??a[l]})})}if(s.linear={...i.linear},n.linear){let a=i.linear,o=n.linear;fse.forEach(l=>{Object.assign(s.linear,{[l]:o[l]??a[l]})})}if(s.grid={...i.grid},n.grid){let a=i.grid,o=n.grid;pse.forEach(l=>{Object.assign(s.grid,{[l]:o[l]??a[l]})})}if(s.toObject={...i.toObject},n.toObject){let a=i.toObject,o=n.toObject;mse.forEach(l=>{Object.assign(s.toObject,{[l]:o[l]??a[l]})})}if(s.randomnessObject={...i.randomnessObject},n.randomnessObject){let a=i.randomnessObject,o=n.randomnessObject;gse.forEach(l=>{Object.assign(s.randomnessObject,{[l]:o[l]??a[l]})})}return s}e.merge=r})(dp||(dp={}));var uL;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function r(i,n){let s=[];i.count!==void 0&&s.push({type:0,path:n,props:{count:i.count}});for(let a of t){let o=i[a];o&&Object.keys(o).length>0&&s.push({type:0,path:[...n,a],props:o})}return s}e.toOps=r})(uL||(uL={}));var dse=["count"],hse=["radius","start","end","position","scale","rotation"],fse=["position","scale","rotation"],pse=["count","size"],mse=["count","position","scale","rotation"],gse=["strength","scale","rotation","position","movement","seed","freqScale"],dL;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(r){return e.all.includes(r)}e.is=t})(dL||(dL={}));var hL;(e=>{function t(i){return r(i)}e.defaultData=t;function r(i){if(i==="PointLight")return{type:i,color:Ri.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(i==="SpotLight")return{type:i,color:Ri.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:Ri.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(hL||(hL={}));var PM;(e=>(e.defaultShapeData={type:"PlaneEmitterShape",size:[100,100,100]},e.defaultCollisionData={colliderEntityId:null,collisionBounce:.75},e.defaultData={renderMaterial:{type:"particleMaterial",color:{r:1,g:.2,b:.545,a:1},color2:{r:.945,g:.714,b:.184,a:1},coloring:"gradient",ease:"linearFadeOut",easeSize:"linearFadeOut",transparent:!0,size:[40,40],texture:"pt_default_particle",spriteRotation:[0,0]},birthRatePerSec:50,gravity:1,noiseStrength:0,noiseScale:0,noiseSeed:1,noiseType:"curl",randomRotation:0,randomScale:.2,randomMass:.5,rootObjectType:"instancedMesh",life:1,direction:[0,0,0],directionMode:"axis",speed:10,shape:e.defaultShapeData,autoPlay:!0,emitTimeDelay:0,emitTimeCycle:"infinity",emitTimeDuration:1,...e.defaultCollisionData}))(PM||(PM={}));var hx;(e=>e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(hx||(hx={}));var fL;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(r,i){return r.castShadow===i.castShadow&&r.receiveShadow===i.receiveShadow}e.equals=t})(fL||(fL={}));var pL;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(r,i){return r.flatShading===i.flatShading&&r.side===i.side&&r.wireframe===i.wireframe}e.equals=t})(pL||(pL={}));var mL;(e=>e.defaultData={...pL.defaultData,...fL.defaultData})(mL||(mL={}));var Fq;(e=>{function t(r,i){let n=[];if("material"in r){let s=typeof r.material=="string"?i.materials[r.material]??i.lib.materials[r.material]?.asset:r.material;s&&n.push(s)}else if("materials"in r)for(let s of r.materials){let a=typeof s=="string"?i.materials[s]??i.lib.materials[s]?.asset:s;a&&n.push(a)}return n}e.getMaterialData=t})(Fq||(Fq={}));var DM;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(DM||(DM={}));var Vq;(e=>{function t(r){return r==="texture"||r==="video"||r==="color"||r==="depth"||r==="normal"||r==="gradient"||r==="noise"||r==="fresnel"||r==="rainbow"||r==="toon"||r==="outline"||r==="particle"||r==="transmission"||r==="matcap"||r==="displace"||r==="pattern"||r==="light"}e.is=t})(Vq||(Vq={}));function ije(e){return e.type!=="displace"}var Uq;(e=>{function t(r){return r==="phong"||r==="toon"||r==="lambert"||r==="physical"}e.is=t})(Uq||(Uq={}));var vse=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],nje=["wrapping","image","video","name","minFilter","magFilter"],Vs;(e=>{function t(s,a){let{texture:o,...l}=a;if(Object.assign(s,l),o){let c=s.texture;c&&Object.assign(c,o)}}e.patch=t;function r(s,a){return s==="light"&&a?i(a):n(s)}e.defaultData=r;function i(s){let a={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...a,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...a,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...a,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...a,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function n(s){let a={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...a,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"video":return{...a,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:DM.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006},crop:!1};case"color":return{...a,type:"color",color:ha.fromHex(ul)};case"depth":return{...a,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...a,type:"normal",cnormal:[1,1,1]};case"gradient":return{...a,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...a,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...ha.fromHex(6710886),a:1},colorB:{...ha.fromHex(6710886),a:1},colorC:{...ha.fromHex(16777215),a:1},colorD:{...ha.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...a,type:"fresnel",color:Ri.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...a,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...a,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Ri.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...a,type:"outline",outlineColor:Ri.fromHexAndA(0,1),contourColor:Ri.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...a,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0],rotation:0,minFilter:1008,magFilter:1006}};case"transmission":return{...a,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...a,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...ha.fromHex(0),a:1},colorB:{...ha.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(Vs||(Vs={}));var qs;(e=>{function t(u){return!u.layers.some(d=>d.data.type==="texture"&&d.data.projection!==0||d.data.type==="depth"&&!d.data.isWorldSpace||d.data.type==="noise"||d.data.type==="displace")}e.isMergable=t;function r(u){let d="";return u.layers.forEach(f=>{Object.entries(f.data).forEach(([m,v])=>{d+=`${m}${v}`,Array.isArray(v)?v.forEach(y=>d+=`${y}`):typeof v=="object"?Object.values(v).forEach(y=>{typeof y=="number"?d+=`${y.toFixed(4)}`:d+=`${y}`}):d+=`${v}`})}),d}e.getHash=r;function i(){return{layers:new Vt}}e.defaultEmptyData=i;function n(u="layer1",d="layer2"){return a("phong",u,d)}e.defaultData=n;function s(u,d){return{...u,name:d}}e.withName=s;function a(u,d="layer1",f="layer2"){let m=new Vt;return m.push({fi:0,data:Vs.defaultData("light",u),id:d}),m.push({fi:1,data:Vs.defaultData("color"),id:f}),{layers:m}}e.defaultTwoLayerData=a;function o(u){let d=Vs.defaultData("texture");u&&Object.assign(d.texture,{image:u});let f=new Vt;return f.push({fi:0,data:d,id:"layer1"}),f.push({fi:1,data:{...Vs.defaultData("transmission"),alpha:1},id:"layer2"}),f.push({fi:2,data:{...Vs.defaultData("light","lambert"),alpha:0},id:"layer3"}),{layers:f}}e.defaultUIObjectMaterial=o;function l(u,d="phong",f="layer1",m="layer2"){let v=Vs.defaultData("texture");Object.assign(v.texture,{image:u});let y=new Vt;return y.push({fi:0,data:v,id:f}),y.push({fi:1,data:Vs.defaultData("light",d),id:m}),{layers:y}}e.defaultTwoLayerTextureData=l;function c(u,d="phong",f="layer1",m="layer2"){let v=Vs.defaultData("video");Object.assign(v.texture,{video:u});let y=new Vt;return y.push({fi:0,data:v,id:f}),y.push({fi:1,data:Vs.defaultData("light",d),id:m}),{layers:y}}e.defaultTwoLayerVideoTextureData=c})(qs||(qs={}));var NM;(e=>{function t(){return{points:new Vt,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(NM||(NM={}));var kM;(e=>{function t(){return{points:new Vt,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})(kM||(kM={}));var yse={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},gL;(e=>{function t(r,i){let n={...r};return bse.forEach(s=>{Object.assign(n,{[s]:i[s]??r[s]})}),n}e.merge=t})(gL||(gL={}));var xse={shape:yse,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},bse=["depth","offset","angle","twist","startScale","endScale"],RM;(e=>{function t(i){return i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="UIGeometry"}e.is2DParametricMesh=t;function r(i){return i==="PolygonGeometry"||i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="PathGeometry"||i==="VectorGeometry"||i==="ConeGeometry"||i==="CubeGeometry"||i==="CylinderGeometry"||i==="DodecahedronGeometry"||i==="HelixGeometry"||i==="IcosahedronGeometry"||i==="LatheGeometry"||i==="PyramidGeometry"||i==="SphereGeometry"||i==="PlaneGeometry"||i==="BackdropGeometry"||i==="TorusGeometry"||i==="TorusKnotGeometry"||i==="BooleanGeometry"||i==="TextGeometry"||i==="InputGeometry"}e.isParametricMesh=r})(RM||(RM={}));var vL;(e=>{function t(r,i){let n={...r};return Object.assign(n,i),n.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(n.extrusion={...r.extrusion},Object.assign(n.extrusion,gL.merge(n.extrusion,i.extrusion))),n}e.merge=t})(vL||(vL={}));var Kf;(e=>{function t(r){if(r==="RectangleGeometry")return{width:320,height:320,type:r,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="UIGeometry")return{type:r,frame:"",cornerRadius:[0,0,0,0],cornerType:0,width:1,height:1};if(r==="PathGeometry")return{type:r,width:1,height:1,depth:1,path:kM.defaultData(),extrusion:xse};if(r==="VectorGeometry")return{width:1,height:1,type:r,subdivisions:12,shape:NM.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="BooleanGeometry")return{type:r,operation:2,width:0,height:0,depth:0,phongAngle:35};if(r==="ShapeBlendGeometry")return{type:r,width:0,height:0,depth:0,resolutionLevel:6,blendRange:100,useChildrenColors:!1};if(r==="TextGeometry")return{type:r,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",editable:!1,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="InputGeometry")return{...e.defaultData("TextGeometry"),type:r,editable:!0};if(r==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}e.defaultData=t})(Kf||(Kf={}));var x4=["width","height","depth"],yL;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:ha.white,near:.1,far:2e3})(yL||(yL={}));var IM;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focusDistance:100,focalLength:20,bokehScale:5},noise:{...t,blendFunction:16}}})(IM||(IM={}));var xL;(e=>e.defaultData={softShadowQuality:"low"})(xL||(xL={}));var bL;(e=>e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(bL||(bL={}));var wL;(e=>e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(wL||(wL={}));var fx;(e=>e.defaultData={usePhysics:!1,gravity:-10})(fx||(fx={}));var _L;(e=>e.defaultData={playCamera:rb,gameControlObject:null})(_L||(_L={}));var SL;(e=>e.defaultData={backgroundColor:Ri.fromHexAndA(tje,1),postprocessing:IM.defaultData,fog:yL.defaultData,globalPhysics:fx.defaultData,ambient:bL.defaultData,ao:wL.defaultData,shadow:xL.defaultData,publish:_L.defaultData})(SL||(SL={}));var EL;(e=>e.defaultData={colliderType:"box",size:[100,100,100],colliderHelperVisible:!0,forceType:"collider",forceRange:"global",forceIntensity:.5,forceDambing:.95})(EL||(EL={}));var Hq;(e=>{function t(i){return i==="Component"||i==="Instance"}e.isComponentRelated=t;function r(i){return i==="Empty"||i==="Instance"}e.isEmptyOrComponent=r})(Hq||(Hq={}));var px;(e=>{e.identity={...oL.identity,hiddenMatrix:ux.identity};function t(n){return{position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix}}e.fromObject=t;function r(n,s){return{position:s?.position||n.position,rotation:s?.rotation||n.rotation,scale:s?.scale||n.scale,hiddenMatrix:s?.hiddenMatrix||n.hiddenMatrix}}e.merge=r;function i(n,s){return jne({position:Pg.isEqual(n.position,s.position)?void 0:s.position,rotation:Pg.isEqual(n.rotation,s.rotation)?void 0:s.rotation,scale:Pg.isEqual(n.scale,s.scale)?null:s.scale,hiddenMatrix:ux.isEqual(n.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}e.diff=i})(px||(px={}));var Cs;(e=>e.defaultData={states:new Vt,events:new Vt,visible:!0,raycastLock:!1,physics:hx.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...px.identity,cloner:null})(Cs||(Cs={}));var AL;(e=>e.defaultData={type:"Empty",...Cs.defaultData})(AL||(AL={}));var Gq;(e=>e.defaultData={type:"ParticleCollider",...EL.defaultData,...Cs.defaultData})(Gq||(Gq={}));var Wq;(e=>e.defaultData={type:"Component",...Cs.defaultData})(Wq||(Wq={}));var qq;(e=>e.defaultData={type:"Particle",...Cs.defaultData,...PM.defaultData})(qq||(qq={}));var Qf;(e=>e.defaultData={type:"Mesh",...Cs.defaultData,...mL.defaultData})(Qf||(Qf={}));var F2;(e=>e.defaultData={...Cs.defaultData,...px.identity,position:[0,0,dx.DefaultTargetOffset],...dx.defaultData})(F2||(F2={}));var CL;(e=>{function t(r){return{...Cs.defaultData,...hL.defaultData(r)}}e.defaultData=t,e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(CL||(CL={}));var OM;(e=>{function t(i,n,s=0){for(;s<n.length;){let a=i?i[n[s]]:void 0;if(n.length===s+1)return a;if(a)i=a.descendants,s+=1;else return}}e.resolveWithDes=t;function r(i,n,s=0){let a=t(i,n,s);if(a){let o=Object.keys(a);if(o.length===1&&o[0]==="descendants")return}return a}e.resolve=r})(OM||(OM={}));var hp;(e=>{e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(i,n){return{...Cs.defaultData,...n,component:i,overrides:new us,physics:void 0,events:void 0,type:"Instance"}}e.ofComponent=t;function r(i){let n=px.fromObject(i.data);return t(i.id,n)}e.fromComponentData=r})(hp||(hp={}));var mx;(e=>{e.defaultData={type:"Page",...Cs.defaultData,physics:{...hx.defaultData,fusedBody:!1},...SL.defaultData,camera:F2.defaultData};function t(r){return r.uiScene!==void 0}e.isUIPage=t})(mx||(mx={}));var TL;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:ux.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:hx.defaultData,states:new Vt,events:new Vt,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...dx.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...Cs.defaultData,...Qf.defaultData,geometry:Kf.defaultData("RectangleGeometry"),material:qs.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...Cs.defaultData,...Qf.defaultData,geometry:Kf.defaultData("BooleanGeometry"),material:qs.defaultTwoLayerData("phong","layer1","layer2")},e.defaultShapeBlendObject={name:"Shape Blend",...Cs.defaultData,...Qf.defaultData,geometry:Kf.defaultData("ShapeBlendGeometry"),material:qs.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...Cs.defaultData,...Qf.defaultData,geometry:Kf.defaultData("TextGeometry"),material:qs.defaultTwoLayerData("phong","layer1","layer2")},e.defaultInputObject={name:"Input",...Cs.defaultData,...Qf.defaultData,geometry:Kf.defaultData("InputGeometry"),material:qs.defaultTwoLayerData("phong","layer1","layer2")}))(TL||(TL={}));var dg;(e=>{function t(s,a){let o={name:a};return s.type==="Mesh"?(o.geometry={},"material"in s&&(o.material={layers:new us}),"materials"in s&&(o.materials=s.materials.map(l=>({layers:new us})))):qg.is(s.type)&&(o.perspective={},o.orthographic={}),o}e.newEmpty=t;function r(s,a){if(a===void 0)return s;let o={...s};return"material"in o&&"material"in a&&a.material&&(o.material=B2(o.material,l=>{if(typeof l!="string")for(let[c,u]of Object.entries(a.material.layers)){let d=l.layers.data(c);d&&Vs.patch(d,u)}}).data),o.materials&&a.materials&&(o.materials=B2(o.materials,l=>{for(let c=0;c<o.materials.length;c++){let u=a.materials[c];if(typeof u!="string")for(let[d,f]of Object.entries(u.layers)){let m=l[c]?.layers?.data(d);m&&Vs.patch(m,f)}}}).data),o}function i(s,a){let o,l=[],c={orthographic:0,perspective:0,geometry:0};function u(d,f){for(let[m,v]of Object.entries(f.layers)){let{texture:y,...x}=v;if(y!==void 0&&Object.keys(y).length>0){let w={path:[...d,"layers",m,"texture"],props:y,type:0};l.push(w)}if(Object.keys(x).length>0){let w={path:[...d,"layers",m],props:x,type:0};l.push(w)}}}for(let[d,f]of Object.entries(a))if(d!=="name")if(d==="cloner")l.push(...uL.toOps(f,["cloner"]));else if(d==="pathSnapping")l.push({path:[d],props:{slide:f.slide,offset:f.offset},type:0});else if(d==="material")u(["material"],f);else if(d==="materials")for(let[m,v]of Object.entries(f))u(["materials",m],v);else if(c[d]===0){if(d==="geometry"&&f.extrusion!==void 0){let m={path:[d,"extrusion"],props:f.extrusion,type:0};l.push(m),f={...f},delete f.extrusion}if(Object.keys(f).length>0){let m={path:[d],props:f,type:0};l.push(m)}}else o===void 0&&(o={path:[],props:{},type:0},l.push(o)),o.props[d]=f;return l}e.toOps=i;function n(s,a){if(a===void 0)return s;let o={...s};if(Object.assign(o,px.merge(o,a)),Object.assign(o,{pathSnapping:Object.assign({},o.pathSnapping,{slide:a.pathSnapping?.slide??o.pathSnapping?.slide??0,offset:a.pathSnapping?.offset??o.pathSnapping?.offset??0})}),qg.is(s.type)){o.orthographic={...o.orthographic},o.perspective={...o.perspective};let l=a;l.orthographic?.zoom!==void 0&&(o.orthographic.zoom=l.orthographic.zoom),l.perspective?.zoom!==void 0&&(o.perspective.zoom=l.perspective.zoom),l.isUpVectorFlipped!==void 0&&(o.isUpVectorFlipped=l.isUpVectorFlipped),l.targetOffset!==void 0&&(o.targetOffset=l.targetOffset)}else if(s.type==="Mesh")"geometry"in a&&Object.assign(o,{geometry:vL.merge(o.geometry,a.geometry)}),(a.material||a.materials)&&(o=r(o,a)),o.cloner&&"cloner"in a&&Object.assign(o,{cloner:dp.merge(o.cloner,a.cloner)});else if(s.type==="Empty")o.cloner&&"cloner"in a&&Object.assign(o,{cloner:dp.merge(o.cloner,a.cloner)});else if(dL.is(s.type)){let l=a;l.intensity!==void 0&&(o.intensity=l.intensity),l.color!==void 0&&(typeof l.color=="string"?o.color=l.color:o.color=ha.clone(l.color))}return o}e.patch=n})(dg||(dg={}));var jM;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(jM||(jM={}));var yh;(e=>e.defaultData={orbitControls:jM.defaultData,playPage:Yw,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((t,r)=>{let i=0,n=0;return r<5?n=-30:r<10&&(n=30),r===0||r===10||r===5?i=30:(r===4||r===11||r===9)&&(i=-30),[120,[i,n],"show"]}),settings:{image:{format:"jpg",ratio:1},videoStatic:{fps:60,mbps:150,ratio:1,duration:1e3},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1,imageQuality:70}},stopRaycast:!0,hdTransmission:!1})(yh||(yh={}));var ML;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(ML||(ML={}));var PL;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(PL||(PL={}));var hg;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...ML.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:PL.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(hg||(hg={}));var V2;(e=>{function t(i){return i.find(n=>n.data.type==="Page"&&n.data.globalPhysics.usePhysics)!==void 0}e.physicsEnabled=t;function r(i,n,s){i.scene.objects.traverseFrom(n,(a,o)=>{if(o.type==="Instance"){let l=BM.getComponentData(i,o.component)?.data;l&&s(a,o,l.events)}else s(a,o,o.events)})}e.traverseModuleInstances=r})(V2||(V2={}));var fg;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222",e.defaultLight={fi:-1,data:CL.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]};function t(n=!0,s=[]){let a=[],o=TL.defaultMeshObject;n&&(a.push({...e.defaultLight}),a.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]})),a.push(...s);let l=new ma;return l.push({fi:1,id:Yw,data:{...mx.defaultData,name:"Scene 1"},children:a}),l}e.createDefaultObjectTreeWithPage=t,e.defaultData={objects:t(),publish:yh.defaultData,styles:hg.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new ma,publish:yh.defaultData,styles:hg.defaultData()}},e.emptyDataWithPage=function(n=!0){return{objects:t(n),publish:yh.defaultData,styles:hg.defaultData()}},e.emptyData=function(){return{objects:new ma,publish:{...yh.defaultData},styles:hg.defaultData()}};function r(n){return{...e.defaultData,objects:$l(n,ma.prototype)}}e.withObjs=r;function i(n,s){return r([{id:n,data:s,children:[],fi:0}])}e.withObj=i})(fg||(fg={}));var Xw;(e=>e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(Xw||(Xw={}));var DL;(e=>(e.defaultData=t=>({url:t,name:"New Webhook",parametersSchemas:new Vt}),e.defaultParameterValueByType=t=>t==="number"?0:t==="boolean"?!1:""))(DL||(DL={}));var Yq;(e=>e.defaultData=(t,r="GET")=>({url:t,method:r,name:"New API",headers:new Vt,queries:new Vt,autoStart:!0}))(Yq||(Yq={}));var ga;(e=>{function t(a){return a.textValue!==void 0}e.isTextValue=t;function r(a){return typeof a=="number"}e.isNumber=r;function i(a){return typeof a=="boolean"}e.isBoolean=i;function n(a){return t(a)?"string":i(a)?"boolean":"number"}e.typeOfVariable=n;function s(a){return e.isTextValue(a)?Array.isArray(a.textValue)?a.textValue.map(o=>o.toString().padStart(a.padding??2,"0")).join(a.deliminator??":")+(a.suffix!==void 0?" "+a.suffix:""):a.textValue.toString():e.isBoolean(a)?a?"True":"False":e.isNumber(a)?parseFloat(a.toFixed(3)).toString():a.toString()}e.getDisplayedValue=s})(ga||(ga={}));var NL;(e=>e.all=["images","videos","colors","audios","particles","fonts","materials","variables"])(NL||(NL={}));var Xq;(e=>e.all=[...NL.all,"components"])(Xq||(Xq={}));var $q;(e=>{function t(){return{images:new Qt,videos:new Qt,colors:new Qt,audios:new Qt,particles:new Qt,fonts:new Qt,materials:new Qt,components:new Qt,variables:new Qt,userAPIs:new Qt,userWebhooks:new Qt}}e.defaultData=t})($q||($q={}));var jh;(e=>{function t(){return{images:new Qt,videos:new Qt,colors:new Qt,audios:new Qt,particles:new Qt,fonts:new Qt,materials:new Qt,components:new Qt,variables:new Qt,userAPIs:new Qt,userWebhooks:new Qt}}e.defaultData=t})(jh||(jh={}));var Il;(e=>{function t(){let a={};return a["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},$l(a,Qt.prototype)}e.defaultColors=t;function r(){return $l({},Qt.prototype)}e.defaultImages=r;function i(){return{catelogs:new Qt,materials:new Qt,images:new Qt,videos:new Qt,colors:new Qt,audios:new Qt,particles:new Qt,fonts:new Qt,variables:new Vt,userAPIs:new Qt,userWebhooks:new Qt,lib:jh.defaultData()}}e.emptyData=i;function n(a){switch(a){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let o=[0,0,0];return{name:"Time",value:{textValue:o,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:o,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",a)}}e.defaultVariables=n;function s(a,o){if(o.format==="HH:mm:ss"){let l=Math.floor(a/3600),c=Math.floor((a-l*3600)/60),u=Math.round(a-l*3600-c*60);return{textValue:[l,c,u]}}else if(o.format==="mm:ss"){let l=Math.floor(a/60),c=Math.round(a-l*60);return{textValue:[l,c]}}else return o.format==="number"?a=Math.round(a):a=Math.round(a*1e3)/1e3,a}e.getFormattedTimerTime=s})(Il||(Il={}));var LM;(e=>e.list=["idle","move","jump","run"])(LM||(LM={}));var zM;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new Vt,move:new Vt,jump:new Vt,run:new Vt},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:Ri.fromHexAndA(3728051,1)}}))(zM||(zM={}));function Kq(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let r=t.colorA,i=t.colorB,n=[[r.r,r.g,r.b,r.a],[i.r,i.g,i.b,i.a]],s=[0,1];for(let o=2;o<10;o++)n.push(n[1]),s.push(1);let a={...Bu(Vn(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:n,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,a)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let r={...Vn(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,r)}})}function Zf(e,t){Object.values(e.shared.materials).forEach(r=>t(r))}function Jf(e,t){e.scene.objects.traverse((r,i)=>{"materials"in i?i.materials.forEach((n,s)=>{n===void 0&&(i.materials[s]=qs.defaultData(),n=i.materials[s]),typeof n!="string"&&t(n)}):"material"in i?typeof i.material!="string"&&(i.material===void 0&&(i.material=qs.defaultData()),t(i.material)):i.type==="Mesh"&&(i.material===void 0&&(i.material=qs.defaultData()),t(i.material)),"overrides"in i&&Object.values(i.overrides).forEach(n=>{n.material&&typeof n.material!="string"&&Object.getPrototypeOf(n.material)!==us.prototype&&t(n.material)})})}function sje(e){Object.assign(e.scene.publish,{orbitControls:{...jM.defaultData,...Vn(e.scene.publish.orbitControls)}})}function aje(e){Object.assign(e.scene.publish.settings,{video:{...yh.defaultData.settings.video,...Vn(e.scene.publish.settings.video)}})}function oje(e){function t(r){if(r.layers){for(let i of Object.values(r.layers))if(i){for(let[n,s]of Object.entries(i))if((vse.includes(n)||typeof s=="boolean")&&delete i[n],n==="texture")for(let[a,o]of Object.entries(s))(nje.includes(a)||typeof o=="boolean")&&delete s[a]}}}e.scene.objects.traverse((r,i)=>{i.states.forEach(n=>{let s=n;s.material?t(s.material):s.materials&&s.materials.forEach(a=>{t(a)})})})}function lje(e){e.scene.publish.withBackground=!0}function cje(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function uje(e){e.scene.objects.traverse((t,r)=>{let i=r.cloner;i&&(i.radial.scale=i.radial.scale.map(n=>n+1),i.linear.scale=i.linear.scale.map(n=>n+1))})}function dje(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function hje(e){e.scene.objects.traverse((t,r)=>{let i=e.scene.objects.unproxy().parent(t);if(i){let n=Vn(e.scene.objects.data(i));n&&n.type==="Mesh"&&n.geometry.type==="BooleanGeometry"&&r.type==="Mesh"&&(r.visible=Vn(r).booleanExclude!==!0)}})}function fje(e){e.scene.objects.traverse((t,r)=>{if(r.type==="Mesh"){let i=r;r.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function pje(e){function t(i){Object.setPrototypeOf(i,us.prototype),i.texture&&Object.setPrototypeOf(i.texture,us.prototype)}function r(i){Object.setPrototypeOf(i,us.prototype);for(let n in i)t(i[n])}e.scene.objects.traverse((i,n)=>{n.states.forEach(s=>{let a=s;if(a.material){let o=Vn(a.material).layers;r(o),a.material.layers=o}if(a.materials)for(let o=0;o<a.materials.length;o++){let l=a.materials[o],c=Vn(l).layers;r(c),l.layers=c}})})}function Qq(e){e.layers===void 0&&Object.assign(e,qs.defaultTwoLayerData("lambert"))}function b4(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let r=[...t.colors];r.push(t.colors[9]);let i=[...t.steps];i.push(t.steps[9]);let n={...Vn(t),colors:r,steps:i};Object.assign(t,n)}})}function mje(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&(r.geometry.type==="BooleanGeometry"||r.geometry.type==="SubdivGeometry")&&(r.geometry.phongAngle=35)})}function Zq(e){e.scene.objects.traverse((t,r)=>{"materials"in r?r.materials.forEach(i=>{typeof i!="string"&&b4(i)}):"material"in r&&typeof r.material!="string"&&b4(r.material)}),Object.values(e.shared.materials).forEach(t=>b4(t))}function gje(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,r)=>{(r.type==="DirectionalLight"||r.type==="SpotLight")&&(r.shadowResolution=1024,r.shadowRadius=1,r.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function vje(e){e.shared.audios=$l({},Qt.prototype)}function yje(e){e.shared.videos=$l({},Qt.prototype)}function xje(e){let t=e.shared.materials;Object.entries(t).forEach(([r,i])=>{if(!i.layers){let n={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[r]:n})}})}function bje(e){Object.entries(Vn(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(Vn(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function wje(e){e.scene.publish.settings.web.preload=!1}function Jq(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function eY(e){e.layers&&e.layers.forEach(t=>{ije(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function _je(e){e.shared.fonts=$l({},Qt.prototype)}function Sje(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function Eje(e){let t=[];e.scene.objects.traverse((r,i)=>{let n=i;if(n.type==="TextFrame"){let s=qs.defaultTwoLayerData("phong"),a=typeof n.color=="string"?e.shared.colors[n.color]:n.color;s.layers[1].data.color={r:a.r,g:a.g,b:a.b},s.layers[1].data.alpha=n.alpha;let o=Sje(n.font);e.shared.fonts[o]===void 0&&(e.shared.fonts[o]={name:o});let l={name:n.name,...Cs.defaultData,...Qf.defaultData,flatShading:!1,wireframe:!1,geometry:{...Kf.defaultData("TextGeometry"),width:n.width,height:n.height,font:o,depth:0,horizontalAlign:n.horizontalAlign,verticalAlign:n.verticalAlign,fontSize:n.fontSize*1.40625,lineHeight:n.lineHeight/1.40625,letterSpacing:n.letterSpacing-1,text:n.text,textTransform:n.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:Vn(n.states),events:Vn(n.events),visible:n.visible,raycastLock:n.raycastLock,position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix},c=Vn(e.scene.objects).parent(r);e.scene.objects.insertAfter(c??null,r,[{id:r+"new",data:l,children:[]}]),t.push(r)}}),t.forEach(r=>{e.scene.objects.delete(r)})}function Aje(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((r,i)=>{i.events.forEach(n=>{if(t[Number(n.type)])if(Object.assign(n,{type:t[Number(n.type)]}),n.type==="Audio"&&"audioEvent"in n&&(Object.assign(n,{playAudio:n.audioEvent}),delete n.audioEvent),n.type==="GameControl")Object.assign(n,{gameActions:{idle:new Vt,move:new Vt,jump:new Vt}});else{let s=new Vt;Object.assign(n,{actions:s}),(n.type==="MouseDown"||n.type==="MouseUp"||n.type==="KeyDown"||n.type==="KeyUp")&&"url"in n&&s.push({fi:0,id:Ct.generateUUID(),data:{type:"Link",url:n.url,delay:0}}),"targets"in n&&(n.targets.forEach((a,o,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},u={easing:a.easing,duration:a.duration};a.easing===6?Object.assign(u,Bu(a,"mass","stiffness","damping","velocity")):a.easing===5&&Object.assign(u,{control1:{...a.control1},control2:{...a.control2}});let d={repeat:a.repeat?-1:0,delay:a.delay,delayDirection:a.delayDirection,direction:a.cycle&&a.rewind?"pingpong-rewind":a.cycle?"pingpong":"normal"},f={state:a.state,...d,...u},m={allowSlerp:!0,type:"Transition",object:a.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new Vt({fi:0,id:Ct.generateUUID(),data:c},{fi:1,id:Ct.generateUUID(),data:f})};s.push({fi:l,id:o,data:m})}),delete n.targets)}})})}function Cje(e){e.scene.objects.traverse((t,r)=>{function i(n,s){let a=new Vt,o=[];if(r.events.forEach((l,c,u)=>{if(l.type==="Audio"&&l.trigger===s){let d;o.push(c),l.interaction==="play"?d={...Bu(l,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in l?l.after:void 0,toggle:"after"in l?l.toggle:void 0,type:"Audio"}:(l.interaction==="pause"||l.interaction==="stop")&&(d={...Bu(l,"interaction","delay","object","playAudio"),type:"Audio"}),d&&a.push({fi:u,id:c,data:d})}}),o.forEach(l=>r.events.delete(l)),a.length){let l=r.events.find(c=>c.type===n)?.data;l?"actions"in l&&l.actions.insertBefore(null,a):r.events.insertBefore(null,[{id:Ct.generateUUID(),data:{type:n,actions:a}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function tY(e){let t=e.layers.find(r=>r.type==="light")?.data;if(t?.category==="basic"){let r=Vs.defaultData("light","phong"),i=t;Object.assign(i,r),i.visible=!1}}function rY(e){Zf(e,tY),Jf(e,tY)}function Tje(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="SubdivGeometry"&&(r.geometry.scaleBaked||(r.geometry.scaleBaked=[1,1,1]))})}function Mje(e){e.scene.objects.traverse((t,r)=>{(r.type==="Empty"||r.type==="Mesh")&&r.cloner&&!r.cloner.randomnessObject&&!r.cloner.toObject&&!r.cloner.randomness&&(r.cloner={...r.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function Pje(e){e.scene.objects.traverse((t,r)=>{r.type==="Mesh"&&r.geometry.type==="NonParametricGeometry"&&!("material"in r)&&!("materials"in r)&&(r.material=qs.defaultTwoLayerData("phong"))})}function Dje(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,r)=>{(r.type==="OrthographicCamera"||r.type==="PerspectiveCamera")&&(r.orthographic.autoZoom===void 0&&(r.orthographic.autoZoom=!1),r.orthographic.autoZoomFrustumSize===void 0&&(r.orthographic.autoZoomFrustumSize=790))})}function Nje(e){e.scene.objects.traverse((t,r)=>{r.pathSnapping===void 0&&(r.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),r.pathSnapping.offset===void 0&&(r.pathSnapping.offset=0)})}function kje(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function Rje(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function Ije(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-r.position[1]))})})}function Oje(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((r,i)=>{t&&i.physics===null?i.collision=!1:i.collision="visibility"})}function jje(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.navmesh=zM.defaultDataThirdPerson.navmesh)})})}function Lje(e){e.scene.styles||(e.scene.styles=hg.defaultData())}function iY(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function zje(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Jf(e,iY),Zf(e,iY)}function Bje(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&Object.assign(i.gameActions,{run:new Vt})})})}function Fje(e){e.scene.objects.traverse((t,r)=>{r.events.forEach(i=>{i.type==="GameControl"&&(i.keyAssignments=[...i.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function nY(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.bumpMapIntensity===void 0&&(t.bumpMapIntensity=5)})}function Vje(e,t){if(t<1&&(Jf(e,Kq),Zf(e,Kq),e.schema=1),t<2&&(sje(e),e.schema=2),t<3&&(oje(e),e.schema=3),t<4&&(lje(e),e.schema=4),t<5&&(cje(e),e.schema=5),t<6&&(uje(e),e.schema=6),t<7&&(dje(e),e.schema=7),t<8&&(e.schema=8),t<9&&(Zq(e),e.schema=9),t<10&&(mje(e),e.schema=10),t<11&&(gje(e),e.schema=11),t<12&&(Zq(e),e.schema=12),t<13&&(vje(e),e.schema=13),t<14&&(xje(e),e.schema=14),t<15&&(bje(e),e.schema=15),t<16&&(wje(e),e.schema=16),t<17&&(Jf(e,Jq),Zf(e,Jq),e.schema=17),t<18&&(Jf(e,Qq),Zf(e,Qq),e.schema=18),t<19&&(aje(e),e.schema=19),t<20&&(_je(e),Eje(e),e.schema=20),t<21&&(Aje(e),Cje(e),e.schema=21),t<22&&(rY(e),e.schema=22),t<23&&(Tje(e),e.schema=23),t<24&&(Mje(e),e.schema=24),(t<25||e.shared.videos===void 0)&&(yje(e),t<25&&(e.schema=25)),t<26&&(hje(e),e.schema=26),t<27&&(fje(e),e.schema=27),t<28&&(rY(e),e.schema=28),t<29&&(pje(e),e.schema=29),t<30&&(Pje(e),e.schema=30),t<31&&(Dje(e),e.schema=31),t<33&&(Nje(e),e.schema=33),t<34&&(kje(e),e.schema=34),t<35&&(Rje(e),e.schema=35),t<36&&(Ije(e),e.schema=36),t<37&&(Oje(e),e.schema=37),t<38&&(Jf(e,eY),Zf(e,eY),e.schema=38),t<39&&(jje(e),e.schema=39),t<40&&(Lje(e),e.schema=40),t<41&&(zje(e),e.schema=41),t<42&&(Bje(e),e.schema=42),t<43&&(Fje(e),e.schema=43),t<99){Jf(e,nY),Zf(e,nY),e.scene.publish.playCamera===null&&(e.scene.publish.playCamera=rb);let r=Vn(e.scene.objects),i=e.scene.objects;e.scene.publish.playPage=Yw,i.insertBefore(null,null,[{id:Yw,data:{...mx.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:Bu(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:Bu(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...fx.defaultData,...Bu(e.scene.environment,"usePhysics","gravity")},camera:Vn(e.scene.ownerCamera)??mx.defaultData.camera,name:"Scene"},children:[]}]);for(let a of r)a.id!==fg.TRASH_CAN_ID&&i.move(Yw,a.fi,a.id);let n=0,s=0;e.shared.penumbraSize&&e.scene.objects.traverse((a,o)=>{o.type==="DirectionalLight"?(o.penumbraSize=e.shared.penumbraSize[Math.min(n,2)],n+=1):o.type==="SpotLight"&&(o.penumbraSize=e.shared.penumbraSize[3+Math.min(s,1)],s+=1),(o.physics===void 0||o.physics===null)&&o.type!=="Instance"&&(o.physics={},Object.assign(o.physics,hx.defaultData)),o.physics!==void 0&&o.physics!==null&&(o.physics.enabled=o.collision??"visibility",delete o.collision)}),e.schema=99}}function sY(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.alphaOverride===void 0&&(t.alphaOverride=1)})}function Uje(e){e.scene.objects.traverse((t,r)=>{let i=r.geometry;i&&i.type==="PathGeometry"&&(i.extrusion.capType="flat",i.extrusion.bevel=50,i.extrusion.bevelSides=6,i.extrusion.shape.type==="Custom"&&(i.extrusion.shape.shapeQuality="low"))})}function Hje(e){Array.isArray(Vn(e.events))&&e.events?.forEach(t=>{"disabled"in t||(t.disabled=!1),(t.type==="MouseDown"||t.type==="MouseUp"||t.type==="MousePress")&&(t.mode=t.mode||"Object")})}var ty=180/Math.PI;function aY(e){e.rotation=e.rotation.slice(0,3).map(t=>t*ty)}function wse(e){aY(e),e.type==="Page"&&aY(e.camera),e.states?.forEach(r=>{r.rotation===void 0||r.rotation===null||(r.rotation=r.rotation.slice(0,3).map(i=>i*ty))});let t=e.geometry;t&&t.type==="SphereGeometry"&&(t.thetaLength=(t.thetaLength??180)*ty),t&&t.type==="TorusGeometry"&&(t.arc=t.arc*ty),t&&t.type==="PathGeometry"&&(t.extrusion.angle*=ty,t.extrusion.twist*=ty),e.type==="Mesh"&&e.geometry.type==="TextGeometry"&&(e.geometry.text={textValue:e.geometry.text}),Array.isArray(Vn(e.events))&&e.events?.forEach(r=>{(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="MousePress"||r.type==="KeyDown"||r.type==="KeyUp"||r.type==="KeyPress"||r.type==="Collision"||r.type==="Trigger")&&(r.runMode=r.toggle?"Toggle":"Repeat")})}function Gje(e){e.shared.variables=$l({},Qt.prototype)}function Wje(e){let t=Vn(e.shared.variables);e.shared.variables=$l(Object.entries(t??{}).map(([r,i],n)=>({fi:n,id:r,data:i})),Vt.prototype)}var nh=116;function _se(e,t){t(e.data);for(let r of e.children)_se(r,t)}function qje(e){let t=e.schema??104;t!==nh&&t<105&&(_se(e.asset,wse),e.schema=105)}function Yje(e){e.shared.particles=$l({},Qt.prototype),e.shared.lib&&(e.shared.lib.particles=jh.defaultData().particles)}function Xje(e){e.scene.objects.traverse((t,r)=>{r.type==="Particle"&&typeof r.renderMaterial.size=="number"&&Object.assign(r.renderMaterial,{size:[r.renderMaterial.size,r.renderMaterial.size]})})}function $je(e){e.scene.objects.traverse((t,r)=>{r.type==="Page"&&(r.postprocessing.depthOfField.focusDistance=100,r.postprocessing.depthOfField.focalLength=20,r.postprocessing.depthOfField.bokehScale=5)})}function Kje(e){e.scene.objects.traverse((t,r)=>{Array.isArray(Vn(r.events))!==!1&&r.events?.forEach(i=>{let n=i.runMode;i.type==="MouseDown"||i.type==="MouseUp"||i.type==="KeyDown"||i.type==="KeyUp"||i.type==="Collision"||i.type==="Trigger"?i.actions?.forEach(s=>{s.type==="Transition"&&(s.runMode=n??"Repeat"),(s.type==="Animation"||s.type==="SwitchCamera")&&(s.runMode=n==="Toggle"?"Toggle":"Normal")}):i.type==="MouseHover"||i.type==="MousePress"||i.type==="KeyPress"?i.actions?.forEach(s=>{(s.type==="Transition"||s.type==="Animation"||s.type==="SwitchCamera")&&(s.runMode="Toggle")}):i.type==="GameControl"?(delete i.actions,Object.keys(i.gameActions).forEach(s=>{i.gameActions[s]?.forEach(a=>{a.type==="Transition"&&(a.runMode="Repeat"),a.type==="Animation"&&(a.runMode="Normal")})})):i.type==="DragDrop"?(delete i.actions,i.dragDropActions?.drag?.forEach(s=>{(s.type==="Transition"||s.type==="Animation"||s.type==="SwitchCamera")&&(s.runMode="Toggle")}),i.dragDropActions?.drop?.forEach(s=>{(s.type==="Transition"||s.type==="Animation"||s.type==="SwitchCamera")&&(s.runMode="Toggle")})):i.type==="Resize"?(delete i.actions,i.breakpoints?.forEach(s=>{s.actions?.forEach(a=>{(a.type==="Transition"||a.type==="Animation"||a.type==="SwitchCamera")&&(a.runMode="Toggle")})})):i.type==="Start"?i.actions?.forEach(s=>{s.type==="Transition"&&(s.runMode="Once"),(s.type==="Animation"||s.type==="SwitchCamera")&&(s.runMode="Normal")}):i.type==="VariableChange"||i.type==="Scroll"?i.actions?.forEach(s=>{s.type==="Transition"&&(s.runMode="Repeat"),(s.type==="Animation"||s.type==="SwitchCamera")&&(s.runMode="Normal")}):i.type==="Conditional"&&(delete i.actions,i.inActions?.forEach(s=>{s.type==="Transition"&&(s.runMode="Repeat"),(s.type==="Animation"||s.type==="SwitchCamera")&&(s.runMode="Normal")}),i.outActions?.forEach(s=>{s.type==="Transition"&&(s.runMode="Repeat"),(s.type==="Animation"||s.type==="SwitchCamera")&&(s.runMode="Normal")}))})})}function Qje(e){e.shared.userAPIs=$l({},Qt.prototype),e.shared.userWebhooks=$l({},Qt.prototype),e.shared.lib&&(e.shared.lib.userAPIs=jh.defaultData().userAPIs,e.shared.lib.userWebhooks=jh.defaultData().userWebhooks)}function Zje(e){e.scene.publish.settings.videoStatic===void 0&&(e.scene.publish.settings.videoStatic=yh.defaultData.settings.videoStatic)}function Sse(e){let t=e.schema??0;if(t!==nh){console.warn("updating from ",t,"to ",nh),Vje(e,t),t<100&&(e.scene.publish.joystickSizeAndXYOffset===void 0&&(e.scene.publish.joystickSizeAndXYOffset=yh.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(Jf(e,sY),Zf(e,sY),e.schema=101),t<102&&(Uje(e),e.schema=102),t<104&&(e.shared.catelogs=new Qt,e.shared.lib=jh.defaultData(),e.schema=104),t<105&&(Gje(e),e.scene.objects.traverse((r,i)=>{wse(i)}),e.schema=105);for(let r of Object.values(e.shared.lib.components))qje(r);t<106&&(Wje(e),e.schema=106),t<107&&(e.shared.lib.variables=jh.defaultData().variables,e.schema=107),t<109&&(Yje(e),e.schema=109),t<110&&(Xje(e),e.schema=110),t<111&&(e.scene.objects.traverse((r,i)=>{Hje(i)}),e.schema=111),t<112&&($je(e),e.schema=112),t<113&&(Kje(e),e.schema=113),t<114&&(e.scene.publish.settings.web.imageQuality===void 0&&(e.scene.publish.settings.web.imageQuality=70),e.schema=114),t<115&&(Qje(e),e.schema=115),t<116&&(Zje(e),e.schema=116)}}var BM;(e=>{e.defaultData={schema:nh,scene:fg.defaultData,frames:new Qt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Xw.defaultData),shared:{...Il.emptyData(),colors:Il.defaultColors()}},e.emptyDataForImports=function(){let s=fg.emptyDataWithPage();return{schema:nh,scene:s,frames:new Qt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Xw.defaultData),shared:{...Il.emptyData(),colors:Il.defaultColors(),images:Il.defaultImages()}}},e.emptyData=function(){return{schema:nh,scene:fg.emptyDataWithPage(),frames:new Qt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Xw.defaultData),shared:Il.emptyData()}},e.clipboard2dData=function(){return{schema:nh,scene:fg.emptyData(),frames:new Qt,shared:Il.emptyData()}},e.collabHelper={...Kj,updateSchema(s){return(s.schema??0)<nh?B2(s,Sse):(s.schema??0)-nh}};function t(s){let a=e.collabHelper.updateSchema(s);return typeof a=="number"?a===0?s:null:a.data}e.updateSchemaDirectly=t;function r(s){return{...s,shared:{...s.shared,lib:jh.defaultData()}}}e.withoutLib=r;function i(s,a){let o=s.scene.objects.get(a);if(o&&o.data.type==="Component")return o;{let l=s.shared.lib.components[a];if(l)return l.asset}}e.getComponentData=i;function n(s){let a=Object.values(s.shared.userAPIs);for(let o of a){let l=o.headers;for(let c of l)if(c.data.key.toLowerCase()==="authorization"&&c.data.value!=="")return!0}return!1}e.hasSensitiveData=n})(BM||(BM={}));var kL;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(kL||(kL={}));var oY;(e=>{function t(r){return!0}e.is=t})(oY||(oY={}));var FM;(e=>{e.defaultData={position:[0,0],scale:[1,1],rotation:0,shear:[0,0]};function t(i,n){return{position:n?.position??i.position,rotation:n?.rotation??i.rotation,scale:n?.scale??i.scale,shear:n?.shear??i.shear}}e.merge=t;function r(i,n){return jne({position:vh.isEqual(i.position,n.position)?void 0:n.position,rotation:i.rotation===n.rotation?void 0:n.rotation,scale:vh.isEqual(i.scale,n.scale)?void 0:n.scale,shear:i.shear&&n.shear&&vh.isEqual(i.shear,n.shear)?void 0:n.shear})}e.diff=r})(FM||(FM={}));var RL;(e=>e.defaultData={horizontalConstraint:0,verticalConstraint:0})(RL||(RL={}));var lY;(e=>e.defaultData={direction:"row",wrap:"unwrap",align:"top-left",gap:10,rowGap:10,autoGap:!1,autoRowGap:!1,leftPadding:8,rightPadding:8,topPadding:8,bottomPadding:8})(lY||(lY={}));var VM;(e=>e.defaultData={opacity:1,fill:{color:Ri.fromHexAndA(ul,1),enabled:!0},stroke:{color:Ri.from0to1([0,0,0,1]),thickness:1,enabled:!1,mode:"inside"},layerBlur:{radius:2,enabled:!1},backgroundBlur:{radius:2,enabled:!1},dropShadow:{offset:[10,10],blurRadius:10,color:Ri.from0to1([0,0,0,1]),enabled:!1,spread:0},innerShadow:{offset:[10,10],blurRadius:10,color:Ri.from0to1([0,0,0,1]),enabled:!1,spread:0}})(VM||(VM={}));var pg;(e=>{function t(a,o){return{name:o}}e.newEmpty=t;function r(a,o){if(o===void 0)return a;let l={...a},c=["width","height","cornerRadius"];for(let u of c)u in l&&u in o&&o[u]!==void 0&&Object.assign(l,{[u]:o[u]});return l}function i(a,o){if(o===void 0)return a;let l={...a};return"fill"in l&&"fill"in o&&o.fill!==void 0&&Object.assign(l,{fill:{...l.fill,...o.fill}}),"stroke"in l&&"stroke"in o&&o.stroke!==void 0&&Object.assign(l,{stroke:{...l.stroke,...o.stroke}}),"layerBlur"in l&&"layerBlur"in o&&o.layerBlur!==void 0&&Object.assign(l,{layerBlur:{...l.layerBlur,...o.layerBlur}}),"backgroundBlur"in l&&"backgroundBlur"in o&&o.backgroundBlur!==void 0&&Object.assign(l,{backgroundBlur:{...l.backgroundBlur,...o.backgroundBlur}}),"dropShadow"in l&&"dropShadow"in o&&o.dropShadow!==void 0&&Object.assign(l,{dropShadow:{...l.dropShadow,...o.dropShadow}}),"innerShadow"in l&&"innerShadow"in o&&o.innerShadow!==void 0&&Object.assign(l,{innerShadow:{...l.innerShadow,...o.innerShadow}}),l}function n(a,o){if(o===void 0)return a;let l={...a};return Object.assign(l,FM.merge(l,o)),l=r(l,o),l=i(l,o),l}e.patch=n;function s(a,o){let l,c=[];for(let[u,d]of Object.entries(o))u!=="name"&&(l===void 0&&(l={path:[],props:{},type:0},c.push(l)),l.props[u]=d);return c}e.toOps=s})(pg||(pg={}));var U2;(e=>e.defaultData={...FM.defaultData,...RL.defaultData,states:new Vt,events:new Vt,visible:!0,raycastLock:!1})(U2||(U2={}));var gx;(e=>e.defaultData={...U2.defaultData,...VM.defaultData})(gx||(gx={}));var UM;(e=>e.defaultData={cornerRadius:[0,0,0,0]})(UM||(UM={}));var IL;(e=>e.defaultData={...gx.defaultData,type:"ellipse2d",width:100,height:100,name:"Ellipse"})(IL||(IL={}));var H2;(e=>e.defaultData={...gx.defaultData,...UM.defaultData,type:"rectangle2d",width:100,height:100,name:"Rectangle"})(H2||(H2={}));var OL;(e=>e.defaultData={...gx.defaultData,type:"text2d",width:100,height:100,fontSize:12,lineHeight:1.2,letterSpacing:0,text:{textValue:"Hello world"},horizontalAlign:1,verticalAlign:1,textTransform:1,font:"Roboto_regular",name:"Text"})(OL||(OL={}));var jL;(e=>e.defaultData={...gx.defaultData,type:"path2d",path:"",name:"Path"})(jL||(jL={}));var cY;(e=>{function t(r){return r.type==="ellipse2d"||r.type==="rectangle2d"||r.type==="text2d"||r.type==="vector2d"||r.type==="path2d"}e.is=t})(cY||(cY={}));var HM;(e=>e.defaultData={...U2.defaultData,name:"Group",type:"group2d"})(HM||(HM={}));var LL;(e=>e.defaultData=()=>({...U2.defaultData,...UM.defaultData,...VM.defaultData,name:"Frame",type:"frame2d",clipped:!0,width:200,height:200,fill:{color:Ri.fromHexAndA(4737101,1),enabled:!0},stroke:{color:Ri.fromHexAndA(0,1),thickness:1,enabled:!1,mode:"inside"},backgroundBlur:{radius:2,enabled:!1},layerBlur:{radius:2,enabled:!1}}))(LL||(LL={}));var Dg;(e=>{function t(a){switch(a){case"rectangle2d":return{...H2.defaultData};case"ellipse2d":return{...IL.defaultData};case"text2d":return{...OL.defaultData};case"vector2d":return{...H2.defaultData};case"path2d":return{...jL.defaultData};case"frame2d":return{...LL.defaultData()};case"group2d":return{...HM.defaultData}}}e.defaultData=t;function r(a){return"width"in a&&"height"in a?[typeof a.width=="number"?a.width*.5:0,typeof a.height=="number"?a.height*.5:0]:[0,0]}e.getPivot=r;function i(a){return a.type==="rectangle2d"||a.type==="ellipse2d"||a.type==="text2d"||a.type==="frame2d"}e.isResizeable=i;function n(a){return a.type==="frame2d"&&a.autoLayout!==void 0}e.isAutoLayoutable=n;function s(a){return a.type==="rectangle2d"||a.type==="frame2d"}e.hasCorners=s})(Dg||(Dg={}));var zL;(e=>(e.defaultData={name:"UI",type:"scene2d",objects:new ma},e.emptyData=function(){return{type:"scene2d",objects:new ma}}))(zL||(zL={}));function mg(e,t=!1){let r=e[0].index!==null,i=new Set(Object.keys(e[0].attributes)),n=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new Lt,c=0;for(let u=0;u<e.length;++u){let d=e[u],f=0;if(r!==(d.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let m in d.attributes){if(!i.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;s[m]===void 0&&(s[m]=[]),s[m].push(d.attributes[m]),f++}if(f!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(o!==d.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let m in d.morphAttributes){if(!n.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;a[m]===void 0&&(a[m]=[]),a[m].push(d.morphAttributes[m])}if(t){let m;if(r)m=d.index.count;else if(d.attributes.position!==void 0)m=d.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,m,u),c+=m}}if(r){let u=0,d=[];for(let f=0;f<e.length;++f){let m=e[f].index;for(let v=0;v<m.count;++v)d.push(m.getX(v)+u);u+=e[f].attributes.position.count}l.setIndex(d)}for(let u in s){let d=uY(s[u]);if(!d)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,d)}for(let u in a){let d=a[u][0].length;if(d===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let f=0;f<d;++f){let m=[];for(let y=0;y<a[u].length;++y)m.push(a[u][y][f]);let v=uY(m);if(!v)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(v)}}return l}function uY(e){let t,r,i,n=0;for(let o=0;o<e.length;++o){let l=e[o];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=l.itemSize),r!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=l.array.length}let s=new t(n),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new Jt(s,r,i)}var Jje=Math.pow(2,-24),CA=class{constructor(){}};function ku(e,t,r){return r.min.x=t[e],r.min.y=t[e+1],r.min.z=t[e+2],r.max.x=t[e+3],r.max.y=t[e+4],r.max.z=t[e+5],r}function dY(e){let t=-1,r=-1/0;for(let i=0;i<3;i++){let n=e[i+3]-e[i];n>r&&(r=n,t=i)}return t}function hY(e,t){t.set(e)}function fY(e,t,r){let i,n;for(let s=0;s<3;s++){let a=s+3;i=e[s],n=t[s],r[s]=i<n?i:n,i=e[a],n=t[a],r[a]=i>n?i:n}}function TA(e,t,r){for(let i=0;i<3;i++){let n=t[e+2*i],s=t[e+2*i+1],a=n-s,o=n+s;a<r[i]&&(r[i]=a),o>r[i+3]&&(r[i+3]=o)}}function B1(e){let t=e[3]-e[0],r=e[4]-e[1],i=e[5]-e[2];return 2*(t*r+r*i+i*t)}function eLe(e,t){if(!e.index){let r=e.attributes.position.count,i=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,n;r>65535?n=new Uint32Array(new i(4*r)):n=new Uint16Array(new i(2*r)),e.setIndex(new Jt(n,1));for(let s=0;s<r;s++)n[s]=s}}function tLe(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],r=new Set;for(let n of e.groups)r.add(n.start),r.add(n.start+n.count);let i=Array.from(r.values()).sort((n,s)=>n-s);for(let n=0;n<i.length-1;n++){let s=i[n],a=i[n+1];t.push({offset:s/3,count:(a-s)/3})}return t}function w4(e,t,r,i,n=null){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0,d=1/0,f=1/0,m=1/0,v=-1/0,y=-1/0,x=-1/0,w=n!==null;for(let _=t*6,S=(t+r)*6;_<S;_+=6){let P=e[_+0],M=e[_+1],C=P-M,T=P+M;C<s&&(s=C),T>l&&(l=T),w&&P<d&&(d=P),w&&P>v&&(v=P);let E=e[_+2],N=e[_+3],D=E-N,I=E+N;D<a&&(a=D),I>c&&(c=I),w&&E<f&&(f=E),w&&E>y&&(y=E);let j=e[_+4],L=e[_+5],B=j-L,q=j+L;B<o&&(o=B),q>u&&(u=q),w&&j<m&&(m=j),w&&j>x&&(x=j)}i[0]=s,i[1]=a,i[2]=o,i[3]=l,i[4]=c,i[5]=u,w&&(n[0]=d,n[1]=f,n[2]=m,n[3]=v,n[4]=y,n[5]=x)}function rLe(e,t,r,i){let n=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,c=-1/0;for(let u=t*6,d=(t+r)*6;u<d;u+=6){let f=e[u+0];f<n&&(n=f),f>o&&(o=f);let m=e[u+2];m<s&&(s=m),m>l&&(l=m);let v=e[u+4];v<a&&(a=v),v>c&&(c=v)}i[0]=n,i[1]=s,i[2]=a,i[3]=o,i[4]=l,i[5]=c}function iLe(e,t,r,i,n){let s=r,a=r+i-1,o=n.pos,l=n.axis*2;for(;;){for(;s<=a&&t[s*6+l]<o;)s++;for(;s<=a&&t[a*6+l]>=o;)a--;if(s<a){for(let c=0;c<3;c++){let u=e[s*3+c];e[s*3+c]=e[a*3+c],e[a*3+c]=u;let d=t[s*6+c*2+0];t[s*6+c*2+0]=t[a*6+c*2+0],t[a*6+c*2+0]=d;let f=t[s*6+c*2+1];t[s*6+c*2+1]=t[a*6+c*2+1],t[a*6+c*2+1]=f}s++,a--}else return s}}var Jd=32,nLe=(e,t)=>e.candidate-t.candidate,Df=new Array(Jd).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),MA=new Float32Array(6);function sLe(e,t,r,i,n,s){let a=-1,o=0;if(s===0)a=dY(t),a!==-1&&(o=(t[a]+t[a+3])/2);else if(s===1)a=dY(e),a!==-1&&(o=aLe(r,i,n,a));else if(s===2){let l=B1(e),c=1.25*n,u=i*6,d=(i+n)*6;for(let f=0;f<3;f++){let m=t[f],v=(t[f+3]-m)/Jd;if(n<Jd/4){let y=[...Df];y.length=n;let x=0;for(let _=u;_<d;_+=6,x++){let S=y[x];S.candidate=r[_+2*f],S.count=0;let{bounds:P,leftCacheBounds:M,rightCacheBounds:C}=S;for(let T=0;T<3;T++)C[T]=1/0,C[T+3]=-1/0,M[T]=1/0,M[T+3]=-1/0,P[T]=1/0,P[T+3]=-1/0;TA(_,r,P)}y.sort(nLe);let w=n;for(let _=0;_<w;_++){let S=y[_];for(;_+1<w&&y[_+1].candidate===S.candidate;)y.splice(_+1,1),w--}for(let _=u;_<d;_+=6){let S=r[_+2*f];for(let P=0;P<w;P++){let M=y[P];S>=M.candidate?TA(_,r,M.rightCacheBounds):(TA(_,r,M.leftCacheBounds),M.count++)}}for(let _=0;_<w;_++){let S=y[_],P=S.count,M=n-S.count,C=S.leftCacheBounds,T=S.rightCacheBounds,E=0;P!==0&&(E=B1(C)/l);let N=0;M!==0&&(N=B1(T)/l);let D=1+1.25*(E*P+N*M);D<c&&(a=f,c=D,o=S.candidate)}}else{for(let w=0;w<Jd;w++){let _=Df[w];_.count=0,_.candidate=m+v+w*v;let S=_.bounds;for(let P=0;P<3;P++)S[P]=1/0,S[P+3]=-1/0}for(let w=u;w<d;w+=6){let _=~~((r[w+2*f]-m)/v);_>=Jd&&(_=Jd-1);let S=Df[_];S.count++,TA(w,r,S.bounds)}let y=Df[Jd-1];hY(y.bounds,y.rightCacheBounds);for(let w=Jd-2;w>=0;w--){let _=Df[w],S=Df[w+1];fY(_.bounds,S.rightCacheBounds,_.rightCacheBounds)}let x=0;for(let w=0;w<Jd-1;w++){let _=Df[w],S=_.count,P=_.bounds,M=Df[w+1].rightCacheBounds;S!==0&&(x===0?hY(P,MA):fY(P,MA,MA)),x+=S;let C=0,T=0;x!==0&&(C=B1(MA)/l);let E=n-x;E!==0&&(T=B1(M)/l);let N=1+1.25*(C*x+T*E);N<c&&(a=f,c=N,o=_.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:o}}function aLe(e,t,r,i){let n=0;for(let s=t,a=t+r;s<a;s++)n+=e[s*6+i*2];return n/r}function oLe(e,t){let r=e.attributes.position,i=e.index.array,n=i.length/3,s=new Float32Array(n*6),a=r.normalized,o=r.array,l=r.offset||0,c=3;r.isInterleavedBufferAttribute&&(c=r.data.stride);let u=["getX","getY","getZ"];for(let d=0;d<n;d++){let f=d*3,m=d*6,v,y,x;a?(v=i[f+0],y=i[f+1],x=i[f+2]):(v=i[f+0]*c+l,y=i[f+1]*c+l,x=i[f+2]*c+l);for(let w=0;w<3;w++){let _,S,P;a?(_=r[u[w]](v),S=r[u[w]](y),P=r[u[w]](x)):(_=o[v+w],S=o[y+w],P=o[x+w]);let M=_;S<M&&(M=S),P<M&&(M=P);let C=_;S>C&&(C=S),P>C&&(C=P);let T=(C-M)/2,E=w*2;s[m+E+0]=M+T,s[m+E+1]=T+(Math.abs(M)+T)*Jje,M<t[w]&&(t[w]=M),C>t[w+3]&&(t[w+3]=C)}}return s}function lLe(e,t){function r(w){f&&f(w/m)}function i(w,_,S,P=null,M=0){if(!v&&M>=l&&(v=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),S<=u||M>=l)return r(_+S),w.offset=_,w.count=S,w;let C=sLe(w.boundingData,P,a,_,S,d);if(C.axis===-1)return r(_+S),w.offset=_,w.count=S,w;let T=iLe(o,a,_,S,C);if(T===_||T===_+S)r(_+S),w.offset=_,w.count=S;else{w.splitAxis=C.axis;let E=new CA,N=_,D=T-_;w.left=E,E.boundingData=new Float32Array(6),w4(a,N,D,E.boundingData,s),i(E,N,D,s,M+1);let I=new CA,j=T,L=S-D;w.right=I,I.boundingData=new Float32Array(6),w4(a,j,L,I.boundingData,s),i(I,j,L,s,M+1)}return w}eLe(e,t);let n=new Float32Array(6),s=new Float32Array(6),a=oLe(e,n),o=e.index.array,l=t.maxDepth,c=t.verbose,u=t.maxLeafTris,d=t.strategy,f=t.onProgress,m=e.index.count/3,v=!1,y=[],x=tLe(e);if(x.length===1){let w=x[0],_=new CA;_.boundingData=n,rLe(a,w.offset,w.count,s),i(_,w.offset,w.count,s),y.push(_)}else for(let w of x){let _=new CA;_.boundingData=new Float32Array(6),w4(a,w.offset,w.count,_.boundingData,s),i(_,w.offset,w.count,s),y.push(_)}return y}function cLe(e,t){let r=lLe(e,t),i,n,s,a=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<r.length;u++){let d=r[u],f=l(d),m=new o(32*f);i=new Float32Array(m),n=new Uint32Array(m),s=new Uint16Array(m),c(0,d),a.push(m)}return a;function l(u){return u.count?1:1+l(u.left)+l(u.right)}function c(u,d){let f=u/4,m=u/2,v=!!d.count,y=d.boundingData;for(let x=0;x<6;x++)i[f+x]=y[x];if(v){let x=d.offset,w=d.count;return n[f+6]=x,s[m+14]=w,s[m+15]=65535,u+32}else{let x=d.left,w=d.right,_=d.splitAxis,S;if(S=c(u+32,x),S/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[f+6]=S/4,S=c(S,w),n[f+7]=_,S}}}var Lh=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let r=1/0,i=-1/0;for(let n=0,s=e.length;n<s;n++){let a=e[n][t];r=a<r?a:r,i=a>i?a:i}this.min=r,this.max=i}setFromPoints(e,t){let r=1/0,i=-1/0;for(let n=0,s=t.length;n<s;n++){let a=t[n],o=e.dot(a);r=o<r?o:r,i=o>i?o:i}this.min=r,this.max=i}isSeparated(e){return this.min>e.max||e.min>this.max}};Lh.prototype.setFromBox=function(){let e=new V;return function(t,r){let i=r.min,n=r.max,s=1/0,a=-1/0;for(let o=0;o<=1;o++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){e.x=i.x*o+n.x*(1-o),e.y=i.y*l+n.y*(1-l),e.z=i.z*c+n.z*(1-c);let u=t.dot(e);s=Math.min(u,s),a=Math.max(u,a)}this.min=s,this.max=a}}();var uLe=function(){let e=new V,t=new V,r=new V;return function(i,n,s){let a=i.start,o=e,l=n.start,c=t;r.subVectors(a,l),e.subVectors(i.end,i.start),t.subVectors(n.end,n.start);let u=r.dot(c),d=c.dot(o),f=c.dot(c),m=r.dot(o),v=o.dot(o)*f-d*d,y,x;v!==0?y=(u*d-m*f)/v:y=0,x=(u+y*d)/f,s.x=y,s.y=x}}(),TB=function(){let e=new ge,t=new V,r=new V;return function(i,n,s,a){uLe(i,n,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1){i.at(o,s),n.at(l,a);return}else if(o>=0&&o<=1){l<0?n.at(0,a):n.at(1,a),i.closestPointToPoint(a,!0,s);return}else if(l>=0&&l<=1){o<0?i.at(0,s):i.at(1,s),n.closestPointToPoint(s,!0,a);return}else{let c;o<0?c=i.start:c=i.end;let u;l<0?u=n.start:u=n.end;let d=t,f=r;if(i.closestPointToPoint(u,!0,t),n.closestPointToPoint(c,!0,r),d.distanceToSquared(u)<=f.distanceToSquared(c)){s.copy(d),a.copy(u);return}else{s.copy(c),a.copy(f);return}}}}(),dLe=function(){let e=new V,t=new V,r=new So,i=new Wl;return function(n,s){let{radius:a,center:o}=n,{a:l,b:c,c:u}=s;if(i.start=l,i.end=c,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a||(i.start=l,i.end=u,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a)||(i.start=c,i.end=u,i.closestPointToPoint(o,!0,e).distanceTo(o)<=a))return!0;let d=s.getPlane(r);if(Math.abs(d.distanceToPoint(o))<=a){let f=d.projectPoint(o,t);if(s.containsPoint(f))return!0}return!1}}(),hLe=1e-15;function Tv(e){return Math.abs(e)<hLe}var zh=class extends fa{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new V),this.satBounds=new Array(4).fill().map(()=>new Lh),this.points=[this.a,this.b,this.c],this.sphere=new Oo,this.plane=new So,this.needsUpdate=!0}intersectsSphere(e){return dLe(e,this)}update(){let e=this.a,t=this.b,r=this.c,i=this.points,n=this.satAxes,s=this.satBounds,a=n[0],o=s[0];this.getNormal(a),o.setFromPoints(a,i);let l=n[1],c=s[1];l.subVectors(e,t),c.setFromPoints(l,i);let u=n[2],d=s[2];u.subVectors(t,r),d.setFromPoints(u,i);let f=n[3],m=s[3];f.subVectors(r,e),m.setFromPoints(f,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};zh.prototype.closestPointToSegment=function(){let e=new V,t=new V,r=new Wl;return function(i,n=null,s=null){let{start:a,end:o}=i,l=this.points,c,u=1/0;for(let d=0;d<3;d++){let f=(d+1)%3;r.start.copy(l[d]),r.end.copy(l[f]),TB(r,i,e,t),c=e.distanceToSquared(t),c<u&&(u=c,n&&n.copy(e),s&&s.copy(t))}return this.closestPointToPoint(a,e),c=a.distanceToSquared(e),c<u&&(u=c,n&&n.copy(e),s&&s.copy(a)),this.closestPointToPoint(o,e),c=o.distanceToSquared(e),c<u&&(u=c,n&&n.copy(e),s&&s.copy(o)),Math.sqrt(u)}}();zh.prototype.intersectsTriangle=function(){let e=new zh,t=new Array(3),r=new Array(3),i=new Lh,n=new Lh,s=new V,a=new V,o=new V,l=new V,c=new Wl,u=new Wl,d=new Wl;return function(f,m=null,v=!1){this.needsUpdate&&this.update(),f.isExtendedTriangle?f.needsUpdate&&f.update():(e.copy(f),e.update(),f=e);let y=this.plane,x=f.plane;if(Math.abs(y.normal.dot(x.normal))>1-1e-10){let w=this.satBounds,_=this.satAxes;r[0]=f.a,r[1]=f.b,r[2]=f.c;for(let M=0;M<4;M++){let C=w[M],T=_[M];if(i.setFromPoints(T,r),C.isSeparated(i))return!1}let S=f.satBounds,P=f.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let M=0;M<4;M++){let C=S[M],T=P[M];if(i.setFromPoints(T,t),C.isSeparated(i))return!1}for(let M=0;M<4;M++){let C=_[M];for(let T=0;T<4;T++){let E=P[T];if(s.crossVectors(C,E),i.setFromPoints(s,t),n.setFromPoints(s,r),i.isSeparated(n))return!1}}return m&&(v||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),m.start.set(0,0,0),m.end.set(0,0,0)),!0}else{let w=this.points,_=!1,S=0;for(let L=0;L<3;L++){let B=w[L],q=w[(L+1)%3];c.start.copy(B),c.end.copy(q),c.delta(a);let G=_?u.start:u.end,Y=Tv(x.distanceToPoint(B));if(Tv(x.normal.dot(a))&&Y){u.copy(c),S=2;break}if((x.intersectLine(c,G)||Y)&&!Tv(G.distanceTo(q))){if(S++,_)break;_=!0}}if(S===1&&f.containsPoint(u.end))return m&&(m.start.copy(u.end),m.end.copy(u.end)),!0;if(S!==2)return!1;let P=f.points,M=!1,C=0;for(let L=0;L<3;L++){let B=P[L],q=P[(L+1)%3];c.start.copy(B),c.end.copy(q),c.delta(o);let G=M?d.start:d.end,Y=Tv(y.distanceToPoint(B));if(Tv(y.normal.dot(o))&&Y){d.copy(c),C=2;break}if((y.intersectLine(c,G)||Y)&&!Tv(G.distanceTo(q))){if(C++,M)break;M=!0}}if(C===1&&this.containsPoint(d.end))return m&&(m.start.copy(d.end),m.end.copy(d.end)),!0;if(C!==2)return!1;if(u.delta(a),d.delta(o),a.dot(o)<0){let L=d.start;d.start=d.end,d.end=L}let T=u.start.dot(a),E=u.end.dot(a),N=d.start.dot(a),D=d.end.dot(a),I=E<N,j=T<D;return T!==D&&N!==E&&I===j?!1:(m&&(l.subVectors(u.start,d.start),l.dot(a)>0?m.start.copy(u.start):m.start.copy(d.start),l.subVectors(u.end,d.end),l.dot(a)<0?m.end.copy(u.end):m.end.copy(d.end)),!0)}}}();zh.prototype.distanceToPoint=function(){let e=new V;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();zh.prototype.distanceToTriangle=function(){let e=new V,t=new V,r=["a","b","c"],i=new Wl,n=new Wl;return function(s,a=null,o=null){let l=a||o?i:null;if(this.intersectsTriangle(s,l))return(a||o)&&(a&&l.getCenter(a),o&&l.getCenter(o)),0;let c=1/0;for(let u=0;u<3;u++){let d,f=r[u],m=s[f];this.closestPointToPoint(m,e),d=m.distanceToSquared(e),d<c&&(c=d,a&&a.copy(e),o&&o.copy(m));let v=this[f];s.closestPointToPoint(v,e),d=v.distanceToSquared(e),d<c&&(c=d,a&&a.copy(v),o&&o.copy(e))}for(let u=0;u<3;u++){let d=r[u],f=r[(u+1)%3];i.set(this[d],this[f]);for(let m=0;m<3;m++){let v=r[m],y=r[(m+1)%3];n.set(s[v],s[y]),TB(i,n,e,t);let x=e.distanceToSquared(t);x<c&&(c=x,a&&a.copy(e),o&&o.copy(t))}}return Math.sqrt(c)}}();var rd=class{constructor(e,t,r){this.isOrientedBox=!0,this.min=new V,this.max=new V,this.matrix=new ot,this.invMatrix=new ot,this.points=new Array(8).fill().map(()=>new V),this.satAxes=new Array(3).fill().map(()=>new V),this.satBounds=new Array(3).fill().map(()=>new Lh),this.alignedSatBounds=new Array(3).fill().map(()=>new Lh),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),r&&this.matrix.copy(r)}set(e,t,r){this.min.copy(e),this.max.copy(t),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};rd.prototype.update=function(){return function(){let e=this.matrix,t=this.min,r=this.max,i=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let u=0;u<=1;u++){let d=1*l|2*c|4*u,f=i[d];f.x=l?r.x:t.x,f.y=c?r.y:t.y,f.z=u?r.z:t.z,f.applyMatrix4(e)}let n=this.satBounds,s=this.satAxes,a=i[0];for(let l=0;l<3;l++){let c=s[l],u=n[l],d=1<<l,f=i[d];c.subVectors(a,f),u.setFromPoints(c,i)}let o=this.alignedSatBounds;o[0].setFromPointsField(i,"x"),o[1].setFromPointsField(i,"y"),o[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();rd.prototype.intersectsBox=function(){let e=new Lh;return function(t){this.needsUpdate&&this.update();let r=t.min,i=t.max,n=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=r.x,e.max=i.x,a[0].isSeparated(e)||(e.min=r.y,e.max=i.y,a[1].isSeparated(e))||(e.min=r.z,e.max=i.z,a[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let l=s[o],c=n[o];if(e.setFromBox(l,t),c.isSeparated(e))return!1}return!0}}();rd.prototype.intersectsTriangle=function(){let e=new zh,t=new Array(3),r=new Lh,i=new Lh,n=new V;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let a=this.satBounds,o=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let d=0;d<3;d++){let f=a[d],m=o[d];if(r.setFromPoints(m,t),f.isSeparated(r))return!1}let l=s.satBounds,c=s.satAxes,u=this.points;for(let d=0;d<3;d++){let f=l[d],m=c[d];if(r.setFromPoints(m,u),f.isSeparated(r))return!1}for(let d=0;d<3;d++){let f=o[d];for(let m=0;m<4;m++){let v=c[m];if(n.crossVectors(f,v),r.setFromPoints(n,t),i.setFromPoints(n,u),r.isSeparated(i))return!1}}return!0}}();rd.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();rd.prototype.distanceToPoint=function(){let e=new V;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();rd.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new Wl),r=new Array(12).fill().map(()=>new Wl),i=new V,n=new V;return function(s,a=0,o=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(o||l)&&(s.getCenter(n),this.closestPointToPoint(n,i),s.closestPointToPoint(i,n),o&&o.copy(i),l&&l.copy(n)),0;let c=a*a,u=s.min,d=s.max,f=this.points,m=1/0;for(let y=0;y<8;y++){let x=f[y];n.copy(x).clamp(u,d);let w=x.distanceToSquared(n);if(w<m&&(m=w,o&&o.copy(x),l&&l.copy(n),w<c))return Math.sqrt(w)}let v=0;for(let y=0;y<3;y++)for(let x=0;x<=1;x++)for(let w=0;w<=1;w++){let _=(y+1)%3,S=(y+2)%3,P=x<<_|w<<S,M=1<<y|x<<_|w<<S,C=f[P],T=f[M];t[v].set(C,T);let E=e[y],N=e[_],D=e[S],I=r[v],j=I.start,L=I.end;j[E]=u[E],j[N]=x?u[N]:d[N],j[D]=w?u[D]:d[N],L[E]=d[E],L[N]=x?u[N]:d[N],L[D]=w?u[D]:d[N],v++}for(let y=0;y<=1;y++)for(let x=0;x<=1;x++)for(let w=0;w<=1;w++){n.x=y?d.x:u.x,n.y=x?d.y:u.y,n.z=w?d.z:u.z,this.closestPointToPoint(n,i);let _=n.distanceToSquared(i);if(_<m&&(m=_,o&&o.copy(i),l&&l.copy(n),_<c))return Math.sqrt(_)}for(let y=0;y<12;y++){let x=t[y];for(let w=0;w<12;w++){let _=r[w];TB(x,_,i,n);let S=i.distanceToSquared(n);if(S<m&&(m=S,o&&o.copy(i),l&&l.copy(n),S<c))return Math.sqrt(S)}}return Math.sqrt(m)}}();var Mv=new V,Pv=new V,Dv=new V,PA=new ge,DA=new ge,NA=new ge,pY=new V,mY=new V,gY=new V,kA=new V;function fLe(e,t,r,i,n,s){let a;return s===Ys?a=e.intersectTriangle(i,r,t,!0,n):a=e.intersectTriangle(t,r,i,s!==La,n),a===null?null:{distance:e.origin.distanceTo(n),point:n.clone()}}function pLe(e,t,r,i,n,s,a,o,l){Mv.fromBufferAttribute(t,s),Pv.fromBufferAttribute(t,a),Dv.fromBufferAttribute(t,o);let c=fLe(e,Mv,Pv,Dv,kA,l);if(c){i&&(PA.fromBufferAttribute(i,s),DA.fromBufferAttribute(i,a),NA.fromBufferAttribute(i,o),c.uv=fa.getInterpolation(kA,Mv,Pv,Dv,PA,DA,NA,new ge)),n&&(PA.fromBufferAttribute(n,s),DA.fromBufferAttribute(n,a),NA.fromBufferAttribute(n,o),c.uv1=fa.getInterpolation(kA,Mv,Pv,Dv,PA,DA,NA,new ge)),r&&(pY.fromBufferAttribute(r,s),mY.fromBufferAttribute(r,a),gY.fromBufferAttribute(r,o),c.normal=fa.getInterpolation(kA,Mv,Pv,Dv,pY,mY,gY,new V),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let u={a:s,b:a,c:o,normal:new V,materialIndex:0};fa.getNormal(Mv,Pv,Dv,u.normal),c.face=u,c.faceIndex=s}return c}function Ese(e,t,r,i,n){let s=i*3,a=e.index.getX(s),o=e.index.getX(s+1),l=e.index.getX(s+2),{position:c,normal:u,uv:d,uv1:f}=e.attributes,m=pLe(r,c,u,d,f,a,o,l,t);return m?(m.faceIndex=i,n&&n.push(m),m):null}function mLe(e,t,r,i,n,s){for(let a=i,o=i+n;a<o;a++)Ese(e,t,r,a,s)}function gLe(e,t,r,i,n){let s=1/0,a=null;for(let o=i,l=i+n;o<l;o++){let c=Ese(e,t,r,o);c&&c.distance<s&&(a=c,s=c.distance)}return a}function Pu(e,t,r,i){let n=e.a,s=e.b,a=e.c,o=t,l=t+1,c=t+2;r&&(o=r.getX(t),l=r.getX(t+1),c=r.getX(t+2)),n.x=i.getX(o),n.y=i.getY(o),n.z=i.getZ(o),s.x=i.getX(l),s.y=i.getY(l),s.z=i.getZ(l),a.x=i.getX(c),a.y=i.getY(c),a.z=i.getZ(c)}function vY(e,t,r,i,n,s,a){let o=r.index,l=r.attributes.position;for(let c=e,u=t+e;c<u;c++)if(Pu(a,c*3,o,l),a.needsUpdate=!0,i(a,c,n,s))return!0;return!1}var Ase=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function ep(e,t){return t[e+15]===65535}function Iy(e,t){return t[e+6]}function G2(e,t){return t[e+14]}function W2(e){return e+8}function q2(e,t){return t[e+6]}function vLe(e,t){return t[e+7]}var yy=new Wn,GM=new V,yLe=["x","y","z"];function BL(e,t,r,i,n){let s=e*2,a=ib,o=wp,l=_p;if(ep(s,o)){let c=Iy(e,l),u=G2(s,o);mLe(t,r,i,c,u,n)}else{let c=W2(e);WM(c,a,i,GM)&&BL(c,t,r,i,n);let u=q2(e,l);WM(u,a,i,GM)&&BL(u,t,r,i,n)}}function FL(e,t,r,i){let n=e*2,s=ib,a=wp,o=_p;if(ep(n,a)){let l=Iy(e,o),c=G2(n,a);return gLe(t,r,i,l,c)}else{let l=vLe(e,o),c=yLe[l],u=i.direction[c]>=0,d,f;u?(d=W2(e),f=q2(e,o)):(d=q2(e,o),f=W2(e));let m=WM(d,s,i,GM)?FL(d,t,r,i):null;if(m){let y=m.point[c];if(u?y<=s[f+l]:y>=s[f+l+3])return m}let v=WM(f,s,i,GM)?FL(f,t,r,i):null;return m&&v?m.distance<=v.distance?m:v:m||v||null}}var xLe=function(){let e,t,r=[],i=new Ase(()=>new Wn);return function(...s){e=i.getPrimitive(),t=i.getPrimitive(),r.push(e,t);let a=n(...s);i.releasePrimitive(e),i.releasePrimitive(t),r.pop(),r.pop();let o=r.length;return o>0&&(t=r[o-1],e=r[o-2]),a};function n(s,a,o,l,c=null,u=0,d=0){function f(_){let S=_*2,P=wp,M=_p;for(;!ep(S,P);)_=W2(_),S=_*2;return Iy(_,M)}function m(_){let S=_*2,P=wp,M=_p;for(;!ep(S,P);)_=q2(_,M),S=_*2;return Iy(_,M)+G2(S,P)}let v=s*2,y=ib,x=wp,w=_p;if(ep(v,x)){let _=Iy(s,w),S=G2(v,x);return ku(s,y,e),l(_,S,!1,d,u+s,e)}else{let _=W2(s),S=q2(s,w),P=_,M=S,C,T,E,N;if(c&&(E=e,N=t,ku(P,y,E),ku(M,y,N),C=c(E),T=c(N),T<C)){P=S,M=_;let G=C;C=T,T=G,E=N}E||(E=e,ku(P,y,E));let D=ep(P*2,x),I=o(E,D,C,d+1,u+P),j;if(I===2){let G=f(P),Y=m(P)-G;j=l(G,Y,!0,d+1,u+P,E)}else j=I&&n(P,a,o,l,c,u,d+1);if(j)return!0;N=t,ku(M,y,N);let L=ep(M*2,x),B=o(N,L,T,d+1,u+M),q;if(B===2){let G=f(M),Y=m(M)-G;q=l(G,Y,!0,d+1,u+M,N)}else q=B&&n(M,a,o,l,c,u,d+1);return!!q}}}(),bLe=function(){let e=new zh,t=new zh,r=new ot,i=new rd,n=new rd;return function s(a,o,l,c,u=null){let d=a*2,f=ib,m=wp,v=_p;if(u===null&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,c),u=i),ep(d,m)){let y=o,x=y.index,w=y.attributes.position,_=l.index,S=l.attributes.position,P=Iy(a,v),M=G2(d,m);if(r.copy(c).invert(),l.boundsTree)return ku(a,f,n),n.matrix.copy(r),n.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:C=>n.intersectsBox(C),intersectsTriangle:C=>{C.a.applyMatrix4(c),C.b.applyMatrix4(c),C.c.applyMatrix4(c),C.needsUpdate=!0;for(let T=P*3,E=(M+P)*3;T<E;T+=3)if(Pu(t,T,x,w),t.needsUpdate=!0,C.intersectsTriangle(t))return!0;return!1}});for(let C=P*3,T=M+P*3;C<T;C+=3){Pu(e,C,x,w),e.a.applyMatrix4(r),e.b.applyMatrix4(r),e.c.applyMatrix4(r),e.needsUpdate=!0;for(let E=0,N=_.count;E<N;E+=3)if(Pu(t,E,_,S),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let y=a+8,x=v[a+6];return ku(y,f,yy),!!(u.intersectsBox(yy)&&s(y,o,l,c,u)||(ku(x,f,yy),u.intersectsBox(yy)&&s(x,o,l,c,u)))}}}();function WM(e,t,r,i){return ku(e,t,yy),r.intersectBox(yy,i)}var VL=[],uT,ib,wp,_p;function bw(e){uT&&VL.push(uT),uT=e,ib=new Float32Array(e),wp=new Uint16Array(e),_p=new Uint32Array(e)}function RA(){uT=null,ib=null,wp=null,_p=null,VL.length&&bw(VL.pop())}var _4=Symbol("skip tree generation"),S4=new Wn,E4=new Wn,Nv=new ot,Bm=new rd,F1=new rd,V1=new V,IA=new V,wLe=new V,_Le=new V,SLe=new V,yY=new Wn,fu=new Ase(()=>new zh),$w=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),$w.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let r=e.geometry,i=e._roots,n=r.getIndex(),s;return t.cloneBuffers?s={roots:i.map(a=>a.slice()),index:n.array.slice()}:s={roots:i,index:n.array},s}static deserialize(e,t,r={}){if(typeof r=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),$w.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});r={setIndex:!0,...r};let{index:i,roots:n}=e,s=new $w(t,{...r,[_4]:!0});if(s._roots=n,r.setIndex){let a=t.getIndex();if(a===null){let o=new Jt(e.index,1,!1);t.setIndex(o)}else a.array!==i&&(a.array.set(i),a.needsUpdate=!0)}return s}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[_4]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[_4]||(this._roots=cLe(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Wn))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,r=t.index.array,i=t.attributes.position,n,s,a,o,l=0,c=this._roots;for(let d=0,f=c.length;d<f;d++)n=c[d],s=new Uint32Array(n),a=new Uint16Array(n),o=new Float32Array(n),u(0,l),l+=n.byteLength;function u(d,f,m=!1){let v=d*2;if(a[v+15]===65535){let y=s[d+6],x=a[v+14],w=1/0,_=1/0,S=1/0,P=-1/0,M=-1/0,C=-1/0;for(let T=3*y,E=3*(y+x);T<E;T++){let N=r[T],D=i.getX(N),I=i.getY(N),j=i.getZ(N);D<w&&(w=D),D>P&&(P=D),I<_&&(_=I),I>M&&(M=I),j<S&&(S=j),j>C&&(C=j)}return o[d+0]!==w||o[d+1]!==_||o[d+2]!==S||o[d+3]!==P||o[d+4]!==M||o[d+5]!==C?(o[d+0]=w,o[d+1]=_,o[d+2]=S,o[d+3]=P,o[d+4]=M,o[d+5]=C,!0):!1}else{let y=d+8,x=s[d+6],w=y+f,_=x+f,S=m,P=!1,M=!1;e?S||(P=e.has(w),M=e.has(_),S=!P&&!M):(P=!0,M=!0);let C=S||P,T=S||M,E=!1;C&&(E=u(y,f,S));let N=!1;T&&(N=u(x,f,S));let D=E||N;if(D)for(let I=0;I<3;I++){let j=y+I,L=x+I,B=o[j],q=o[j+3],G=o[L],Y=o[L+3];o[d+I]=B<G?B:G,o[d+I+3]=q>Y?q:Y}return D}}}traverse(e,t=0){let r=this._roots[t],i=new Uint32Array(r),n=new Uint16Array(r);s(0);function s(a,o=0){let l=a*2,c=n[l+15]===65535;if(c){let u=i[a+6],d=n[l+14];e(o,c,new Float32Array(r,a*4,6),u,d)}else{let u=a+8,d=i[a+6],f=i[a+7];e(o,c,new Float32Array(r,a*4,6),f)||(s(u,o+1),s(d,o+1))}}}raycast(e,t=zc){let r=this._roots,i=this.geometry,n=[],s=t.isMaterial,a=Array.isArray(t),o=i.groups,l=s?t.side:t;for(let c=0,u=r.length;c<u;c++){let d=a?t[o[c].materialIndex].side:l,f=n.length;if(bw(r[c]),BL(0,i,d,e,n),RA(),a){let m=o[c].materialIndex;for(let v=f,y=n.length;v<y;v++)n[v].face.materialIndex=m}}return n}raycastFirst(e,t=zc){let r=this._roots,i=this.geometry,n=t.isMaterial,s=Array.isArray(t),a=null,o=i.groups,l=n?t.side:t;for(let c=0,u=r.length;c<u;c++){let d=s?t[o[c].materialIndex].side:l;bw(r[c]);let f=FL(0,i,d,e);RA(),f!=null&&(a==null||f.distance<a.distance)&&(a=f,s&&(f.face.materialIndex=o[c].materialIndex))}return a}intersectsGeometry(e,t){let r=this.geometry,i=!1;for(let n of this._roots)if(bw(n),i=bLe(0,r,e,t),RA(),i)break;return i}shapecast(e,t,r){let i=this.geometry;if(e instanceof Function){if(t){let d=t;t=(f,m,v,y)=>{let x=m*3;return d(f,x,x+1,x+2,v,y)}}e={boundsTraverseOrder:r,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let n=fu.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let d=o;o=(f,m,v,y,x)=>d(f,m,v,y,x)?!0:vY(f,m,i,l,v,y,n)}else o||(l?o=(d,f,m,v)=>vY(d,f,i,l,m,v,n):o=(d,f,m)=>m);let c=!1,u=0;for(let d of this._roots){if(bw(d),c=xLe(0,i,a,o,s,u),RA(),c)break;u+=d.byteLength}return fu.releasePrimitive(n),c}bvhcast(e,t,r){let{intersectsRanges:i,intersectsTriangles:n}=r,s=this.geometry.index,a=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;Nv.copy(t).invert();let c=fu.getPrimitive(),u=fu.getPrimitive();if(n){let f=function(m,v,y,x,w,_,S,P){for(let M=y,C=y+x;M<C;M++){Pu(u,M*3,o,l),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let T=m,E=m+v;T<E;T++)if(Pu(c,T*3,s,a),c.needsUpdate=!0,n(c,u,T,M,w,_,S,P))return!0}return!1};if(i){let m=i;i=function(v,y,x,w,_,S,P,M){return m(v,y,x,w,_,S,P,M)?!0:f(v,y,x,w,_,S,P,M)}}else i=f}e.getBoundingBox(E4),E4.applyMatrix4(t);let d=this.shapecast({intersectsBounds:f=>E4.intersectsBox(f),intersectsRange:(f,m,v,y,x,w)=>(S4.copy(w),S4.applyMatrix4(Nv),e.shapecast({intersectsBounds:_=>S4.intersectsBox(_),intersectsRange:(_,S,P,M,C)=>i(f,m,_,S,y,x,M,C)}))});return fu.releasePrimitive(c),fu.releasePrimitive(u),d}intersectsBox(e,t){return Bm.set(e.min,e.max,t),Bm.needsUpdate=!0,this.shapecast({intersectsBounds:r=>Bm.intersectsBox(r),intersectsTriangle:r=>Bm.intersectsTriangle(r)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,r={},i={},n=0,s=1/0){e.boundingBox||e.computeBoundingBox(),Bm.set(e.boundingBox.min,e.boundingBox.max,t),Bm.needsUpdate=!0;let a=this.geometry,o=a.attributes.position,l=a.index,c=e.attributes.position,u=e.index,d=fu.getPrimitive(),f=fu.getPrimitive(),m=IA,v=wLe,y=null,x=null;i&&(y=_Le,x=SLe);let w=1/0,_=null,S=null;return Nv.copy(t).invert(),F1.matrix.copy(Nv),this.shapecast({boundsTraverseOrder:P=>Bm.distanceToBox(P),intersectsBounds:(P,M,C)=>C<w&&C<s?(M&&(F1.min.copy(P.min),F1.max.copy(P.max),F1.needsUpdate=!0),!0):!1,intersectsRange:(P,M)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:C=>F1.distanceToBox(C),intersectsBounds:(C,T,E)=>E<w&&E<s,intersectsRange:(C,T)=>{for(let E=C*3,N=(C+T)*3;E<N;E+=3){Pu(f,E,u,c),f.a.applyMatrix4(t),f.b.applyMatrix4(t),f.c.applyMatrix4(t),f.needsUpdate=!0;for(let D=P*3,I=(P+M)*3;D<I;D+=3){Pu(d,D,l,o),d.needsUpdate=!0;let j=d.distanceToTriangle(f,m,y);if(j<w&&(v.copy(m),x&&x.copy(y),w=j,_=D/3,S=E/3),j<n)return!0}}}});{let C=u?u.count:c.count;for(let T=0,E=C;T<E;T+=3){Pu(f,T,u,c),f.a.applyMatrix4(t),f.b.applyMatrix4(t),f.c.applyMatrix4(t),f.needsUpdate=!0;for(let N=P*3,D=(P+M)*3;N<D;N+=3){Pu(d,N,l,o),d.needsUpdate=!0;let I=d.distanceToTriangle(f,m,y);if(I<w&&(v.copy(m),x&&x.copy(y),w=I,_=N/3,S=T/3),I<n)return!0}}}}}),fu.releasePrimitive(d),fu.releasePrimitive(f),w===1/0?null:(r.point?r.point.copy(v):r.point=v.clone(),r.distance=w,r.faceIndex=_,i&&(i.point?i.point.copy(x):i.point=x.clone(),i.point.applyMatrix4(Nv),v.applyMatrix4(Nv),i.distance=v.sub(i.point).length(),i.faceIndex=S),r)}closestPointToPoint(e,t={},r=0,i=1/0){let n=r*r,s=i*i,a=1/0,o=null;if(this.shapecast({boundsTraverseOrder:c=>(V1.copy(e).clamp(c.min,c.max),V1.distanceToSquared(e)),intersectsBounds:(c,u,d)=>d<a&&d<s,intersectsTriangle:(c,u)=>{c.closestPointToPoint(e,V1);let d=e.distanceToSquared(V1);return d<a&&(IA.copy(V1),a=d,o=u),d<n}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(IA):t.point=IA.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{ku(0,new Float32Array(t),yY),e.union(yY)}),e}},UL=Jp(Bwe()),ELe=.5*(Math.sqrt(3)-1),U1=(3-Math.sqrt(3))/6,ALe=1/3,pu=1/6,Kw=e=>Math.floor(e)|0,xY=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),A4=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function CLe(e=Math.random){let t=Cse(e),r=new Float64Array(t).map(n=>xY[n%12*2]),i=new Float64Array(t).map(n=>xY[n%12*2+1]);return function(n,s){let a=0,o=0,l=0,c=(n+s)*ELe,u=Kw(n+c),d=Kw(s+c),f=(u+d)*U1,m=u-f,v=d-f,y=n-m,x=s-v,w,_;y>x?(w=1,_=0):(w=0,_=1);let S=y-w+U1,P=x-_+U1,M=y-1+2*U1,C=x-1+2*U1,T=u&255,E=d&255,N=.5-y*y-x*x;if(N>=0){let j=T+t[E],L=r[j],B=i[j];N*=N,a=N*N*(L*y+B*x)}let D=.5-S*S-P*P;if(D>=0){let j=T+w+t[E+_],L=r[j],B=i[j];D*=D,o=D*D*(L*S+B*P)}let I=.5-M*M-C*C;if(I>=0){let j=T+1+t[E+1],L=r[j],B=i[j];I*=I,l=I*I*(L*M+B*C)}return 70*(a+o+l)}}function TLe(e=Math.random){let t=Cse(e),r=new Float64Array(t).map(s=>A4[s%12*3]),i=new Float64Array(t).map(s=>A4[s%12*3+1]),n=new Float64Array(t).map(s=>A4[s%12*3+2]);return function(s,a,o){let l,c,u,d,f=(s+a+o)*ALe,m=Kw(s+f),v=Kw(a+f),y=Kw(o+f),x=(m+v+y)*pu,w=m-x,_=v-x,S=y-x,P=s-w,M=a-_,C=o-S,T,E,N,D,I,j;P>=M?M>=C?(T=1,E=0,N=0,D=1,I=1,j=0):P>=C?(T=1,E=0,N=0,D=1,I=0,j=1):(T=0,E=0,N=1,D=1,I=0,j=1):M<C?(T=0,E=0,N=1,D=0,I=1,j=1):P<C?(T=0,E=1,N=0,D=0,I=1,j=1):(T=0,E=1,N=0,D=1,I=1,j=0);let L=P-T+pu,B=M-E+pu,q=C-N+pu,G=P-D+2*pu,Y=M-I+2*pu,X=C-j+2*pu,re=P-1+3*pu,F=M-1+3*pu,$=C-1+3*pu,se=m&255,H=v&255,ne=y&255,ce=.6-P*P-M*M-C*C;if(ce<0)l=0;else{let fe=se+t[H+t[ne]];ce*=ce,l=ce*ce*(r[fe]*P+i[fe]*M+n[fe]*C)}let ie=.6-L*L-B*B-q*q;if(ie<0)c=0;else{let fe=se+T+t[H+E+t[ne+N]];ie*=ie,c=ie*ie*(r[fe]*L+i[fe]*B+n[fe]*q)}let ae=.6-G*G-Y*Y-X*X;if(ae<0)u=0;else{let fe=se+D+t[H+I+t[ne+j]];ae*=ae,u=ae*ae*(r[fe]*G+i[fe]*Y+n[fe]*X)}let Z=.6-re*re-F*F-$*$;if(Z<0)d=0;else{let fe=se+1+t[H+1+t[ne+1]];Z*=Z,d=Z*Z*(r[fe]*re+i[fe]*F+n[fe]*$)}return 32*(l+c+u+d)}}function Cse(e){let t=new Uint8Array(512);for(let r=0;r<512/2;r++)t[r]=r;for(let r=0;r<512/2-1;r++){let i=r+~~(e()*(256-r)),n=t[r];t[r]=t[i],t[i]=n}for(let r=256;r<512;r++)t[r]=t[r-256];return t}var oc=new fa,MLe=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let i=0;i<e.count;i+=3){let n=1;oc.a.fromBufferAttribute(e,i),oc.b.fromBufferAttribute(e,i+1),oc.c.fromBufferAttribute(e,i+2),n*=oc.getArea(),t[i/3]=n}this.distribution=new Float32Array(e.count/3);let r=0;for(let i=0;i<t.length;i++)r+=t[i],this.distribution[i]=r;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let r=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*r);return this.sampleFace(i,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let s=Math.ceil((r+i)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?i=s-1:r=s+1}return n}sampleFace(e,t,r){let i=this.randomFunction(),n=this.randomFunction();return i+n>1&&(i=1-i,n=1-n),oc.a.fromBufferAttribute(this.positionAttribute,e*3),oc.b.fromBufferAttribute(this.positionAttribute,e*3+1),oc.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(oc.a,i).addScaledVector(oc.b,n).addScaledVector(oc.c,1-(i+n)),oc.getNormal(r),this}},PLe=Jp(Kre()),DLe=new ot,NLe=new ot,kLe=new ot,Yg;(e=>{function t(r){return r&&r.__isSPEObject}e.is=t})(Yg||(Yg={}));var MB=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new ot,this.copyPreviousMatrix=!0,this.hiddenMatrix=new ot,this.matrixWorldRigid=new ot,this.shearScale=new ot,this.shearScaleInv=new ot}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof Ei&&(t=t.uuid);let r=this;for(;r.parent;){if(r.parent.uuid===t)return!0;r=r.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let r of this.children)r.updateMatrixWorld(t)}updateWorldMatrix(t,r){let i=this.parent;if(t&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),r)for(let n of this.children)n.updateWorldMatrix(!1,!0)}traverseChildren(t,r=0){for(let i of this.children)Yg.is(i)&&i.traverseObject(t,r+1)}traverseObject(t,r=0){if(t(this,r)!==!0)for(let i of this.children)Yg.is(i)&&i.traverseObject(t,r+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,r=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:i,v:n,q:s}=(0,PLe.SVD)(r),a=DLe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),o=NLe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),l=kLe.copy(o).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(o),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(a,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,r){this.updateWorldMatrix(!0,!1);let i=new ot().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),i.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof ot?t.hiddenMatrix.premultiply(i):t.applyMatrix4(i),t.updateWorldMatrix(!1,!1),this.add(t),r!==void 0&&(this.children.pop(),this.children.splice(r,0,t)),this}copy(t,r=!1){return super.copy(t,r),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,r,i,n,s,a){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},RLe=class extends MB(Ei){},ILe=e=>e.type==="Mesh",va=class extends RLe{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let r=this.children[e];r?.object!==t&&(r&&this.remove(r),r=new va(t),this.add(r),this.children.splice(e,0,this.children.pop()),r.matrixWorldNeedsUpdate=!0,r.matrixAutoUpdate=!1,r.matrix=t.matrix,r.hiddenMatrix=t.hiddenMatrix),r.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&this.object.dataPatched.cloner?.hideBase===!0}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return ILe(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},ng=new V,sg=new V,Oy=new ot,Tse=[new V(-1,1,1),new V(-1,-1,1),new V(1,-1,1),new V(1,1,1),new V(-1,1,-1),new V(-1,-1,-1),new V(1,-1,-1),new V(1,1,-1)],OLe=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],jLe=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],bY=(e,t,r)=>{e.updateEntityBoxSize(ng,sg),Oy.copy(t).multiply(e.matrixWorld),sg.x===0&&sg.y===0&&sg.z===0?r.push(new V(ng.x,ng.y,ng.z).applyMatrix4(Oy)):Tse.forEach(i=>{r.push(i.clone().multiply(sg).add(ng).applyMatrix4(Oy))})},wY=class extends Wn{constructor(){super(...arguments),this.matrix=new ot,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let r=new ot().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];return r===!0?e.traverseEntity(n=>{if(n.visible||n.cloner&&n.data.visible){if(!("geometry"in n)){i.push(new V);return}bY(n,t,i)}}):bY(e,t,i),this.setFromPoints(i)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(Oy.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(sg).multiplyScalar(.5),this.getCenter(ng),Oy.copy(this.matrix).setPosition(ng),this.vertices=Tse.map(e=>e.clone().multiply(sg).applyMatrix4(Oy))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=OLe.map(([e,t])=>new Wl(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new V))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=jLe.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},fp={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},LLe=class extends Cie{constructor(){super()}getPoints(e=12){let t=[],r,i=this.getCurveLengths(),n=i[i.length-1]/i.length;for(let s=0,a=this.curves;s<a.length;s++){let o=a[s],l=s===0?i[s]:i[s]-i[s-1],c=Math.ceil(e*l/n),u=o.getPoints(c);for(let d=0;d<u.length;d++){let f=u[d];r&&r.equals(f)||(t.push(f),r=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},HL=.001;function GL(e,t,r){return t.clone().sub(e).cross(t.clone().sub(r)).length()<=HL}function C4(e,t){let r=new V(...e.position),i=new V(...e.controlNext.position),n=new V(...t.controlPrevious.position),s=new V(...t.position);return GL(r,i,s)&&GL(r,n,s)}function Mse(e){let t=e.points.map(u=>new V(...u.data.position)),r=[e.points[0]],i=new V(...r[0].data.position);for(let u=0;u<e.points.length-1;u++)GL(i,t[u],t[u+1])||(r.push(e.points[u]),i=t[u]);r.push(e.points[e.points.length-1]);let n=e.isClosed,s=r.length-(n?0:1),a=r.length,o=[];for(let u=0;u<a;u++){let d=r[u].data,f=new V(...d.position),m=new V(...d.controlPrevious.position),v=new V(...d.controlNext.position),y={position:f,baseRoundness:d.roundness,controlPrevious:m,controlNext:v};if(d.roundness===0||!e.isClosed&&(u===0||u===a-1)){o[u]={...y,removedLength:0};continue}let x=n&&u==0?a-1:u-1,w=n&&u==a-1?0:u+1,_=r[x].data,S=r[w].data,P=new V(..._.position),M=new V(...S.position),C=P.clone().sub(f).normalize(),T=M.clone().sub(f).normalize();Object.assign(y,{prevDir:C,nextDir:T});let E=C4(_,d),N=C4(d,S);if(!E||!N)o[u]={...y,removedLength:0};else{let D=C.clone().add(T).normalize(),I=D.clone().cross(C).length()/C.dot(D);o[u]={...y,tan:I,removedLength:d.roundness/I}}}for(let u=0;u<s;u++){let d=u,f=n&&u===a-1?0:u+1,m=o[d],v=o[f];if(m.removedLength!==0||v.removedLength!==0){let y=m.position.distanceTo(v.position);m.removedLength=Math.min(m.removedLength,y/2),v.removedLength=Math.min(v.removedLength,y/2)}}let l=[];for(let u=0;u<s;u++){let d=u,f=n&&u===a-1?0:u+1,m=o[d],v=o[f],y=null;if(!C4(r[d].data,r[f].data))m.position.distanceTo(v.position)>HL&&(y=new sT(m.position,m.controlNext,v.controlPrevious,v.position));else{let x=m.position.clone(),w=v.position.clone();(m.removedLength!==0||v.removedLength!==0)&&(m.nextDir&&x.add(m.nextDir.clone().setLength(m.removedLength)),v.prevDir&&w.add(v.prevDir.clone().setLength(v.removedLength))),x.distanceTo(w)>HL&&(y=new sT(x,x.clone().lerp(w,.3),w.clone().lerp(x,.3),w))}l[2*u+1]=y}for(let u=0;u<a;u++){let d=o[u];if(d.removedLength===0){l[2*u]=null;continue}let f=d.position,m=d.prevDir.clone().multiplyScalar(d.removedLength).add(f),v=d.nextDir.clone().multiplyScalar(d.removedLength).add(f),y=d.tan*d.removedLength,x=d.prevDir.clone().add(d.nextDir).normalize(),w=m.clone().lerp(v,.5),_=m.distanceTo(v)/2,S=x.clone().multiplyScalar(Math.sqrt(Math.pow(y,2)-Math.pow(_,2))).add(w),P=x.clone().multiplyScalar(-y).add(S),M=f.distanceTo(P)/f.distanceTo(w),C=d.prevDir.clone().multiplyScalar(M*f.distanceTo(m)).add(f),T=C.clone().lerp(P,2),E=m.clone().lerp(C,4/3),N=v.clone().lerp(T,4/3);l[2*u]=new sT(m,E,N,v)}let c=new LLe;return l.forEach(u=>{u&&c.add(u)}),c}var Xr;(e=>{function t(r){return r&&r.__isEntity}e.is=t})(Xr||(Xr={}));var sh=e=>Xr.is(e),zLe={type:"completeState",isfromEntity:!0},BLe=["x","y","z"],T4=new V,FLe=new V().set(0,1,0),PB=e=>class extends MB(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new wY,this._recursiveBBox=new wY,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let r=this.children[t];if(Xr.is(r))return r}entityChildrenCount(){let t=this.children.length;for(;t--;)if(Xr.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let r=t.parent;if(Xr.is(r))t=r;else return}return t}forInstancesRec(t){this.instances.forEach(r=>{r.disposed||t(r),r.forInstancesRec(t)})}super_Entity(t,r){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=r,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,r,i=!1){if(!(this.data.states.length===0&&!i)){for(let n of this.data.states)dg.toOps(this.data,n.data).forEach(s=>{let a=EM.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(a,this.data,r)});if(t!==null){let n=this.data.states.data(t);n&&(this.dataPatched=dg.patch(this.data,n),dg.toOps(this.data,n).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,r)}))}i&&this.updateTransformState(this.dataPatched,r),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,r){t.setScalar(0),r.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{sh(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let r;return this.traverseEntity(i=>{i.uuid===t&&(r=i)}),r}traverseSortNextHelper(){let t=this.parent;if(t){let r=t.children,i=r.indexOf(this)+1;if(Xr.is(r[i]))return r[i];if(Xr.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&Xr.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let r=this;for(;t>0&&r!==null;)r=r.parent,t-=1;return r}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let r=this.parent;for(;r;){if(t===r)return!0;r=r.parent}return!1}countToAccestor(t){let r=0,i=this;for(;i!==t;){if(i===null)return-1;i=i.parent,r+=1}return r}forEachEntity(t){for(let r of this.children)sh(r)&&t(r)}traverseEntityAncestors(t){this.traverseAncestors(r=>{Xr.is(r)&&t(r)})}traverseConcreteEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)sh(i)&&i.isConcreteEntity&&i.traverseEntity(t,r+1)}traverseEntity(t,r=0){if(t(this,r)!==!0)for(let i of this.children)sh(i)&&i.traverseEntity(t,r+1)}traverseVisibleEntity(t){t(this);for(let r of this.children)sh(r)&&r.visible&&r.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(t){super.updateMatrixWorld(t),this.dispatchEvent({type:"updateMatrixWorld"})}copy(t,r=!1){return super.copy(t,r),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>sh(t))}isAncestorOf(t){if(this.uuid===t)return!1;let r=!1;return this.traverseEntity(i=>{i.uuid===t&&(r=!0)}),r}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let r={position:this.position.toArray(),rotation:[this.rotation.x*Ct.RAD2DEG,this.rotation.y*Ct.RAD2DEG,this.rotation.z*Ct.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return $j(r,t)}getTransformValues(t,r,i){return r[t].map((n,s)=>i?.shared.getVariable(n,[this.uuid,t,BLe[s]])??n)}updateTransformState(t,r){let i=!1;return t.position&&(this.position.fromArray(this.getTransformValues("position",t,r)),i=!0),t.rotation&&(T4.fromArray(this.getTransformValues("rotation",t,r)).multiplyScalar(Ct.DEG2RAD),this.rotation.setFromVector3(T4),i=!0),t.scale&&(this.scale.fromArray(this.getTransformValues("scale",t,r)),i=!0),t.hiddenMatrix!==void 0&&(i=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??ux.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),i}onVariableUpdate(t=!1){if(t){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(r=>{r.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)Xr.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{Xr.is(t)&&t.disposeRecursively()})}toState(t=[]){let r={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return $j(r,t)}updateByObjUpdateOp(t,r){t!==void 0&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},r,!1)}updateByOp(t,r,i,n){let s=this.data;this.data=r;let a=t,o=Vi(t.path,["states","*"]);if(o!==null){if(t.type===0){let[l]=o;if(this?.stateSelection===l){let c={...t.props};if(delete c.name,Object.values(t.props).some(u=>u===void 0)){let u=this.data;if(u!==void 0){let d=As.zoom(u,t.path.slice(2));if(d)for(let f in t.props)t.props[f]===void 0&&f in d&&(c[f]=d[f])}}a={...t,props:c,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:u,...d}=l;l=d}if(t.props.material!==void 0&&"material"in l){let{material:u,...d}=l;l=d}let c=As.removeOverridden(t.path,t.props,l);a={...t,props:c}}}if(this.updateByPatchedOpBase(a,dg.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),Vi(t.path,["overrides"])){let l=[],c=[...t.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let u of Object.keys(t.props)){l[l.length-1]=u;let d=i.scene.findInstance([this.uuid,...l]);d&&(d.overrideData=t.props[u],d.updateState(xp.apply(d.component.data,d.overrideData),i))}}else{let u=i.scene.findInstance([this.uuid,...l]);if(u){let d=As.zoom(u.component.data,c);if(t={...t,path:c},t.type===0){let f=t.props;if(d)for(let[m,v]of Object.entries(t.props))v===void 0&&(f===t.props&&(f={...t.props}),f[m]=d[m]);t={...t,props:f}}u.overrideData=OM.resolve(r.overrides,l),u.updateByOp(t,Ws.applySimple(u.data,t),i,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let c;for(let u of hp.rootOverrideProps)u in t.props&&(c===void 0&&(c={}),c[u]=t.props[u]);c&&(l={...t,props:c})}else for(let c of hp.rootOverrideProps)if(Vi(t.path,[c])){l=t;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let u=xp.filterOp(c.overrideData,l);u&&c.updateByOp(u,Ws.applySimple(c.data,u),i,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let u=xp.filterOp(c.overrideData,t);if(u){let d;s===c.data&&t===u?d=r:d=Ws.applySimple(c.data,u),c.updateByOp(u,d,i,!0)}}})}}updateByPatchedOpBase(t,r,i){if(this.dataPatched=r,t.path.length===0&&t.type===0)t.props.type!==void 0&&!qg.is(t.props.type)&&fp.changeEntityProptotype(this,r,i);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){fp.changeEntityProptotype(this,r,i);for(let n of this.children)Xr.is(n)&&n.updateVisible(i.scene)}this.updateByPatchedOp(t,r,i)}updateByPatchedOp(t,r,i){if(t.path.length===0&&t.type===0?this.updateState(t.props,i):t.type===0&&("resolutionLevel"in t.props||"useChildrenColors"in t.props)&&this.updateState(r,i),t.path[0]==="morphTargetInfluences"&&t.type===0){let n=r.morphTargetInfluences.get(t.path[1])?.data.name;n&&this.updateMorphInfluences(n,i.shared.getVariable(t.props.value,[this.uuid,"morphTargetInfluences",n]))}if(Vi(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(r.pathSnapping),Vi(t.path,["cloner"])!==null){let n=Ws.drop(t,1);n.path.length===0&&n.type===0&&n.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(r.cloner,i.scene):(this.setFromClonerState(r.cloner,i),this.expandCloner(i.scene)),this.updateVisible(i.scene)}}updatePathSnapping(t=this.dataPatched.pathSnapping){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){let r=this._updatedPathSnapping?.pathId??this.dataPatched.pathSnapping.pathId,i=this._updatedPathSnapping?.slide??this.dataPatched.pathSnapping.slide??0,n=this._updatedPathSnapping?.offset??this.dataPatched.pathSnapping.offset??0,s=this._updatedPathSnapping?.orientation??this.dataPatched.pathSnapping.orientation;if(r===null)return;let a=t.find(r);if(!a||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let o=a.data;if(o.geometry.path.points.length<=1)return;let l=Mse(o.geometry.path),c=(i+n)%1;i+n===1&&c===0&&(c=1);let u=null;try{u=l.curves.length?l.getPointAt(c):null}catch{}if(u===null)return;let d=this.parent?this.parent?.matrixWorld:new ot;a.updateMatrixWorld();let f=new ot().multiplyMatrices(d.clone().invert(),a.matrixWorld);u.applyMatrix4(f);let m={position:u.toArray(),rotation:o.rotation};if(s==="tangential"){let v=new ot().extractRotation(a.matrixWorld),y=l.getTangentAt(c).applyMatrix4(v).add(u),x=new ot().lookAt(u,y,FLe),w=T4.setFromEuler(new Es().setFromRotationMatrix(x)).multiplyScalar(Ct.RAD2DEG);m={...m,rotation:w.toArray()}}this.updateTransformState(m),this.traverseEntity(v=>{v._cameraType&&v.dispatchEvent(zLe)})}updateVisible(t){if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||this.dataPatched.cloner?.hideBase!==!0),!t)return;let r=!1;this.traverseEntity(i=>{if(i.data.type==="Splat")return r=!0,!0}),r&&t.reloadSplats()}updateState_Entity(t,r){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(r?.scene),this.resetBBoxNeedsUpdate()),r&&"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,r),this.updateVisible(r.scene)),this.updateTransformState(t,r)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof fp.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,r){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new fp.Cloner(this,t),r.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,r.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}requestRender(){this.dispatchEvent({type:"requestRender"})}},Pse=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=e.parameters?.radiusTop,i=e.parameters?.radiusBottom,n=Object.assign({},t?.parameters??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters);n.thetaLength=Ct.clamp(n.thetaLength,0,360);let s=n.width/2,a=n.radiusTop??s,o=n.radiusBottom??s;if(a===o?(a=s,o=s):a>o?(a=s,o=o*s/a):(a=a*s/o,o=s),n.shapeBlendNode){a=r??s,o=i??s;let l=Math.max(a,o)*2;n.width=l,n.depth=l}return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),radiusTop:a,radiusBottom:o})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,radiusTop:c,radiusBottom:u,cornerRadius:d,cornerSegments:f,hollow:m}=e.parameters,v;return l===0?(v=new Lt,v.setAttribute("position",new At([],3))):d||m?v=new Dse(c,u,i,n,s,a,o,l*Math.PI/180,d,d,f,m):v=new Y6(c,u,i,n,s,a,o,l*Math.PI/180),v.scale(1,1,r/t),Object.assign(v,{userData:{...e,type:"CylinderGeometry"}})}};function Nf(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function _Y(e){return new ge(e.y,-e.x)}var Dse=class extends Lt{constructor(e,t,r,i,n,s,a,o,l,c,u,d,f=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,r=r||1,i=Math.floor(i)||8,n=Math.floor(n)||1,s=s!==void 0?s:!1,a=a!==void 0?a:0,o=o!==void 0?o:Math.PI*2,s&&(l=0,c=0);let m=[],v=[],y=[],x=[],w=0,_=r/2,S=new V,P=new V;f&&e==0&&(e=l),f&&t==0&&(t=c);let M=new ge(e,_),C=new ge(t,-_),T=null,E=null,N=null,D=null,I=M.clone().sub(C),j=0,L=0,B=0;d>0&&(j=Math.min(e,t)*(1-d),L=e-j,B=t-j);let q=M.clone();q.x-=j;let G=Math.PI-I.angle(),Y=I.angle(),X=Math.tan(Y/2),re=Math.tan(G/2),F=X+re,$=d?F:re,se=d?F:X;if(l=Math.min(l,(e-L)/$,I.length()/F),c=Math.min(c,(t-B)/se,I.length()/F),l>0){let Z=l/X;T=M.clone().sub(new ge(Z,l)),d&&(N=T.clone(),N.x-=j-F*l),M.sub(I.clone().setLength(Z))}if(c>0){let Z=c/re;E=C.clone().sub(new ge(Z,-c)),C.add(I.clone().setLength(Z)),d&&(D=E.clone(),D.x-=j-F*c,q.sub(I.clone().setLength(Z)))}I=M.clone().sub(C);let H=I.length()<.5,ne=[];for(let Z=0;Z<=i;Z++){let fe=[],he=Z/i,Ae=he*o+a,xe=new ge(Math.sin(Ae),Math.cos(Ae));D&&E?(ce(fe,he,xe,G,c,D,-1,!0),ce(fe,he,xe,Y,c,E,-1,!1)):E?(ie(fe,xe,E.x,0,-1),ce(fe,he,xe,Y,c,E,-1,!1)):s||ie(fe,xe,t,B,-1);let Ee=_Y(I).normalize();if(Nf(Ee,xe,S),!H)for(let Be=0;Be<=n;Be++){let $e=Be/n,mt=I.clone().multiplyScalar($e).add(C);Nf(mt,xe,P),v.push(P.x,P.y,P.z),y.push(S.x,S.y,S.z),x.push(he,.5+P.y/r),fe.push(w++)}if(N&&T?(ce(fe,he,xe,G,l,T,1,!1),ce(fe,he,xe,Y,l,N,1,!0)):T?(ce(fe,he,xe,G,l,T,1,!1),ie(fe,xe,T.x,0,1)):s||ie(fe,xe,e,L,1),d&&!H){let Be=_Y(I).multiplyScalar(-1).normalize();Nf(Be,xe,S);for(let $e=0;$e<=n;$e++){let mt=$e/n,dt=I.clone().multiplyScalar(-mt).add(q);Nf(dt,xe,P),v.push(P.x,P.y,P.z),y.push(S.x,S.y,S.z),x.push(he,.5+P.y/r),fe.push(w++)}}d&&!s&&fe.push(fe[0]),ne.push(fe)}for(let Z=0;Z<ne.length-1;Z++)for(let fe=0;fe<ne[0].length-1;fe++){if(s&&d&&fe==n)continue;let he=ne[Z][fe],Ae=ne[Z+1][fe],xe=ne[Z+1][fe+1],Ee=ne[Z][fe+1],Be=v[xe*3+0],$e=v[xe*3+2];m.push(he,Ae,Ee),(Be!=0||$e!=0)&&m.push(Ae,xe,Ee)}o<Math.PI*2&&(ae(-1,ne[0],a),ae(1,ne[ne.length-1],a+o)),this.setIndex(m),this.setAttribute("position",new At(v,3)),this.setAttribute("normal",new At(y,3)),this.setAttribute("uv",new At(x,2));function ce(Z,fe,he,Ae,xe,Ee,Be,$e){for(let mt=0;mt<u+1;mt++){let dt=mt/u,ct=Be<0?dt:1-dt;$e&&(ct-=1),ct*=Ae;let ut=new ge(Math.sin(ct),Math.cos(ct)*Be),me=ut.clone().multiplyScalar(xe).add(Ee);Nf(me,he,P),v.push(P.x,P.y,P.z),Nf(ut,he,S),y.push(S.x,S.y,S.z),x.push(fe,.5+P.y/r),Z.push(w++)}}function ie(Z,fe,he,Ae,xe){let Ee=new V,Be=new ge,$e=[he,Ae];xe<0&&$e.reverse();for(let mt of $e)Be.set(mt,_*xe),Nf(Be,fe,Ee),v.push(Ee.x,Ee.y,Ee.z),y.push(0,xe,0),x.push(.5,.5),Z.push(w++)}function ae(Z,fe,he){let Ae=new ge(Math.sin(he),Math.cos(he)),xe=new ge(-Math.cos(he),Math.sin(he)),Ee=new V,Be=Z<0?(dt,ct,ut)=>m.push(dt,ct,ut):(dt,ct,ut)=>m.push(dt,ut,ct),$e=new ge((e+t+L+B)/4,0);Nf($e,Ae,Ee),v.push(Ee.x,Ee.y,Ee.z),y.push(xe.x,0,xe.y),x.push(.5,.5);let mt=w++;for(let dt of fe){let ct=v.slice(dt*3,dt*3+3);v.push(...ct),y.push(xe.x,0,xe.y);let ut=x.slice(dt*2,dt*2+2);x.push(...ut),w++}for(let dt=mt+1;dt<w-1;dt++)Be(mt,dt,dt+1);Be(mt,w-1,mt+1)}}},VLe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return r.thetaLength=Ct.clamp(r.thetaLength,0,360),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:u,cornerSegments:d}=e.parameters,f;return l===0?(f=new Lt,f.setAttribute("position",new At([],3))):c>0||u>0||l<360?f=new Dse(0,t/2,i,n,s,a,o,l*Math.PI/180,c,u,d,0,!0):f=new X6(t/2,i,n,s,a),f.scale(1,1,r/t),Object.assign(f,{userData:{...e,type:"ConeGeometry"}})}},ULe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,widthSegments:n,heightSegments:s,depthSegments:a,cornerRadius:o,cornerSegments:l}=e.parameters,c;return o===0?c=new Fc(t,r,i,n,s,a):c=new HLe(t,r,i,n,s,a,o,l),Object.assign(c,{userData:{...e,type:"CubeGeometry"}})}},M4=Math.PI/2,HLe=class extends Lt{constructor(e=1,t=1,r=1,i=1,n=1,s=1,a=0,o=4){super(),this.type="BoxGeometry",i=Math.floor(i),n=Math.floor(n),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,r/2);let l=[],c=[],u=[],d=[],f=0;m("z","y","x",-1,-1,r,t,e,s,n),m("z","y","x",1,-1,r,t,-e,s,n),m("x","z","y",1,1,e,r,t,i,s),m("x","z","y",1,-1,e,r,-t,i,s),m("x","y","z",1,-1,e,t,r,i,n),m("x","y","z",-1,-1,e,t,-r,i,n),a>0&&(v("z","y","x",-1,-1,1,r,t,e,s),v("z","y","x",1,-1,-1,r,t,e,s),v("z","y","x",-1,1,-1,r,t,e,s),v("z","y","x",1,1,1,r,t,e,s),v("x","y","z",-1,-1,-1,e,t,r,i),v("x","y","z",1,-1,1,e,t,r,i),v("x","y","z",-1,1,1,e,t,r,i),v("x","y","z",1,1,-1,e,t,r,i),v("y","x","z",-1,-1,1,t,e,r,n),v("y","x","z",1,-1,-1,t,e,r,n),v("y","x","z",1,1,1,t,e,r,n),v("y","x","z",-1,1,-1,t,e,r,n),y(1,1,1),y(-1,1,1),y(1,-1,1),y(-1,-1,1),y(1,1,-1),y(-1,1,-1),y(1,-1,-1),y(-1,-1,-1)),this.setIndex(l),this.setAttribute("position",new At(c,3)),this.setAttribute("normal",new At(u,3)),this.setAttribute("uv",new At(d,2));function m(x,w,_,S,P,M,C,T,E,N){let D=(M-2*a)/E,I=(C-2*a)/N,j=M/2-a,L=C/2-a,B=T/2,q=E+1,G=N+1,Y=0,X=new V;for(let re=0;re<G;re++){let F=re*I-L;for(let $=0;$<q;$++){let se=$*D-j;X[x]=se*S,X[w]=F*P,X[_]=B,c.push(X.x,X.y,X.z),X[x]=0,X[w]=0,X[_]=T>0?1:-1,u.push(X.x,X.y,X.z),d.push($/E),d.push(1-re/N),Y+=1}}for(let re=0;re<N;re++)for(let F=0;F<E;F++){let $=f+F+q*re,se=f+F+q*(re+1),H=f+(F+1)+q*(re+1),ne=f+(F+1)+q*re;l.push($,se,ne),l.push(se,H,ne)}f+=Y}function v(x,w,_,S,P,M,C,T,E,N){let D=(C-2*a)/N,I=C/2-a,j=T/2-a,L=E/2,B=N+1,q=0,G=new V,Y=new V;for(let X=0;X<o+1;X++){let re=X/o*M4,F=Math.sin(re)*a,$=(1-Math.cos(re))*a,se=Math.sin(re),H=Math.cos(re);G[w]=(j+F)*P,G[_]=(L-$)*M,Y[x]=0,Y[w]=se*Math.sign(G[w]),Y[_]=H*Math.sign(G[_]);for(let ne=0;ne<B;ne++){let ce=ne*D-I;G[x]=ce*S,c.push(G.x,G.y,G.z),u.push(Y.x,Y.y,Y.z),d.push(ne/N),d.push(0),q+=1}}for(let X=0;X<o;X++)for(let re=0;re<N;re++){let F=f+re+B*X,$=f+re+B*(X+1),se=f+(re+1)+B*(X+1),H=f+(re+1)+B*X;l.push(F,$,H),l.push($,se,H)}f+=q}function y(x,w,_){let S=new V,P=new V(e/2,t/2,r/2);P.subScalar(a);let M=[],C=x*w*_>0?(E,N,D)=>l.push(E,N,D):(E,N,D)=>l.push(E,D,N);for(let E=0;E<=o;E++){let N=[],D=M4*(1-E/o),I=Math.cos(D),j=Math.sin(D),L=0;for(let B=0;B<=E;B++){let q=Math.cos(L),G=Math.sin(L);S.x=I*q,S.y=j,S.z=I*G;let Y=P.clone().addScaledVector(S,a);c.push(x*Y.x,w*Y.y,_*Y.z),u.push(x*S.x,w*S.y,_*S.z),d.push(0,0),N.push(f++),L+=M4/E}M.push(N)}let T=M.length-1;for(let E=0;E<T;E++){let N=M[E],D=M[E+1],I=N.length-1;C(N[0],D[1],D[0]);for(let j=1;j<=I;j++)C(N[j-1],N[j],D[j]),C(N[j],D[j+1],D[j])}}}},DB=class extends Lt{constructor(e=[],t=[],r="",i=1,n=.2,s=4){super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];c(),u(),this.setAttribute("position",new At(a,3)),this.setAttribute("normal",new At(l,3)),this.setAttribute("uv",new At(o,2));return;function c(){n=Math.min(1-1e-5,n),n==0&&(s=0);let d={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[r],f=new V,m=f.clone(),v=new fa,y=n*i,x=i-y,w=s+1,_=new V,S=(Y,X)=>_.subVectors(Y,X).normalize(),P=(Y,X)=>Array(Y).fill(void 0).map(X),M=P(e.length/3,(Y,X)=>new V().fromArray(e,X*3).setLength(i)),C=[],T=1e6;for(let Y=0;Y<M.length;Y++){let X=M[Y],re=[],F,$,se,H=1e10,ne=-1;for(;(ne=t.indexOf(Y,ne+1))!=-1;){let Z=ne-ne%3;F=t[Z+(ne+1)%3],$=t[Z+(ne+2)%3],se=X.distanceToSquared(M[F]),H=Math.min(H,se),re.push([F,$,se])}H+=1e-6;let ce=[],ie=0,ae=re.length;for(let Z=0;Z<ae;Z++){[F,$,se]=re[ie];let fe=C[F]?.includes(Y)==!0;se<=H&&ce.push(F+ +fe*T),ie=re.findIndex(he=>he[0]==$)}C.push(ce)}let E=[];{let Y=0,X=0,re,F,$=d==3;for(let se=0;se<=s;se++){re=se*(se+1)/2,F=(se+1)*(se+2)/2;for(let H=0;H<s-se;H++)[Y,X]=[re+H+se+2,F+H+se+3],E.push(re,F,...$?[X,re]:[Y,F],X,Y),[re,F]=[Y,X];E.push(re,F,re+s+2)}}let N=f.clone(),D=f.clone(),I=f.clone(),j=f.clone(),L=f.clone(),B=[],q=P(M.length,()=>P(d,()=>f.clone()));for(let Y=0;Y<M.length;Y++){f.copy(M[Y]).normalize(),N.copy(f).multiplyScalar(x);let X=C[Y];for(let ce=0;ce<X.length;ce++){let ie=X[ce],ae=X[(ce+1)%d];v.setFromPointsAndIndices(M,Y,ie%T,ae%T),v.b.sub(v.a).setLength(1e10).add(v.a),v.c.sub(v.a).setLength(1e10).add(v.a),v.closestPointToPoint(N,q[Y][ce])}let re=[],F=[],$=[],se=new V;s==0&&[...q[Y]].reduce((ce,ie)=>ce.add(ie),se).multiplyScalar(1/d);for(let ce=0;ce<d;ce++){let ie=[],ae=(ce-1+d)%d,Z=q[Y][ae],fe=q[Y][ce];f.copy(Z).sub(N),m.copy(fe).sub(N);let he=N.angleTo(f),Ae=f.angleTo(m),xe=Math.cos(he)*y;s==0?D.copy(se):D.copy(N).setLength(x+xe),F.push(xe);let Ee=[D,Z,fe];for(let Be=0;Be<2;Be++){let $e=Ee[Be],mt=Ee[Be+1];j.subVectors($e,N),L.subVectors(mt,N),I.crossVectors(j,L).normalize();for(let dt=0;dt<w;dt++){let ct=[he,Ae][Be]*dt/w;f.copy(j).applyAxisAngle(I,ct).add(N),re.push(f.clone()),Be&&(S(f,N),ie.push([dt==0?$e:f.clone(),_.clone()]))}Be&&(S(mt,N),ie.push([mt,_.clone()]))}$.push(ie)}B.push($);let H=2*w,ne=2;for(let ce=0;ce<d;ce++){let ie=H*ce,ae=H*((ce+1)%d),Z=[re[ie]];for(let he=1;he<w;he++){j=re[ie+he],L=re[ae+he],Z.push(j);for(let Ae=1,xe=he-ne+1;Ae<=xe;Ae++)f.lerpVectors(j,L,Ae/(xe+1)),f.sub(N).setLength(F[ce]).add(N),Z.push(f.clone());Z.push(L)}for(let he=0;he<w;he++)Z.push(re[he+w+ie]);Z.push(re[ae+w]);let fe=E.map(he=>Z[he]);a.push(...fe.map(he=>[he.x,he.y,he.z]).flat()),l.push(...fe.map(he=>(S(he,N),[_.x,_.y,_.z])).flat())}}let G=[];for(let Y=0;Y<C.length;Y++)for(let X=0;X<d;X++){let re=C[Y][X];if(re<T){let F=C[re].findIndex(H=>H%T==Y),$=B[Y][X],se=B[re][F];for(let H=0;H<w;H++){let ne=$[H],ce=se[w-H],ie=$[H+1],ae=se[w-(H+1)];[ne,ce,ie,ie,ce,ae].forEach(Z=>{a.push(Z[0].x,Z[0].y,Z[0].z),l.push(Z[1].x,Z[1].y,Z[1].z)})}G.push($[0][0],se[w][0],$[w][0],se[0][0])}}for(;G.length;){let Y,X,re,F;[Y,X]=G.splice(0,2);let $=[Y];for(;Y!=X;)$.push(X),re=G.indexOf(X),F=re%2,X=G.splice(re-F,2)[1-F];_.subVectors($[0],$[1]).cross(f.subVectors($[0],$[2])).normalize();let se=_.dot($[0])<0;se&&_.negate();for(let H=1;H<=$.length-2;H++)[$[H+ +se],$[H+1-+se],$[0]].forEach(ne=>{a.push(ne.x,ne.y,ne.z),l.push(_.x,_.y,_.z)})}}function u(){let d=new V;for(let C=0;C<a.length;C+=3){d.x=a[C+0],d.y=a[C+1],d.z=a[C+2];let T=P(d)/2/Math.PI+.5,E=M(d)/Math.PI+.5;o.push(T,1-E)}let f=new V,m=new V,v=new V,y=new V,x=new ge,w=new ge,_=new ge,S=(C,T,E,N)=>{N<0&&C.x===1&&(o[T]=C.x-1),E.x===0&&E.z===0&&(o[T]=N/2/Math.PI+.5)};for(let C=0,T=0;C<a.length;C+=9,T+=6){f.set(a[C+0],a[C+1],a[C+2]),m.set(a[C+3],a[C+4],a[C+5]),v.set(a[C+6],a[C+7],a[C+8]),x.set(o[T+0],o[T+1]),w.set(o[T+2],o[T+3]),_.set(o[T+4],o[T+5]),y.copy(f).add(m).add(v).divideScalar(3);let E=P(y);S(x,T+0,f,E),S(w,T+2,m,E),S(_,T+4,v,E)}for(let C=0;C<o.length;C+=6){let T=o[C+0],E=o[C+2],N=o[C+4],D=Math.max(T,E,N),I=Math.min(T,E,N);D>.9&&I<.1&&(T<.2&&(o[C+0]+=1),E<.2&&(o[C+2]+=1),N<.2&&(o[C+4]+=1))}function P(C){return Math.atan2(C.z,-C.x)}function M(C){return Math.atan2(-C.y,Math.sqrt(C.x*C.x+C.z*C.z))}}}static fromJSON(e){return new DB(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},GLe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new Nse(t*.5,s,a):new Mie(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:{...e,type:"DodecahedronGeometry"}})}},Nse=class extends DB{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],o="DodecahedronGeometry";super(s,a,o,e,t,r),this.type=o}static fromJSON(e){return new Nse(e.radius,e.corner,e.cornerSides)}},H1=1e-12,NB=class{constructor(e){this.position=new ge,this.startPosition=new ge,this.uuid=Ct.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new NB(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},WL=class extends NB{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new WL(this.parent).copy(this)}},jy=class extends NB{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new WL(this),new WL(this))}static create(e,t){let r=new jy(e,new ge(...t.position));return r.controls[0].position.set(...t.controlPrevious.position),r.controls[1].position.set(...t.controlNext.position),r.roundness=t.roundness,r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,r}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let r=0,i=this.controls.length;r<i;r++){let n=this.controls[r];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new jy(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){let e=this.curveBefore?.getTangentAt(1),t=this.curveAfter?.getTangentAt(0);return[e,t]}computeNormals(e=new ge,t=new ge){let[r,i]=this.computeTangents();return r&&i&&(SY(r,e),SY(i,t)),[e,t]}computeTangent(e=new ge){let[t,r]=this.computeTangents();return t&&r&&e.copy(t).add(r).normalize(),e}computeNormal(e=new ge){let[t,r]=this.computeNormals();return e.copy(t).add(r).normalize(),e}};function SY(e,t=new ge){let r=e.length();return t.set(-e.y/r,e.x/r)}var kB=e=>e,nb=new ge,W3=new ge,WLe=new ge,qLe=new ge,YLe=new ge,XLe=new ge,kse=new V,Rse=new V;function $Le(e){let t=new ge;t.addVectors(e.v0,nb.subVectors(e.v1,e.v0).multiplyScalar(2/3));let r=new ge;return r.addVectors(e.v2,W3.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new Ec(e.v0,t,r,e.v2)}function ww(e,t,r=Number.EPSILON){return Math.abs(e-t)<r}function KLe(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function QLe(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function Ise(e,t,r){let i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),s=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));return Math.acos((n*n+i*i-s*s)/(2*n*i))}function ZLe(e,t,r){return AY(e,t)&&AY(t,r)&&qL(e.position,t.position,r.position)}function qL(e,t,r){return nb.copy(t).sub(e).cross(W3.copy(r).sub(e))===0}function JLe(e,t,r,i,n){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(e.y-t.y)/s,c=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return i.set(o+l,a+c),n.set(o-l,a-c),[i,n]}function e5e(e,t,r){let i=e.distanceTo(r),n=t.distanceTo(r);return i<n?t:e}function t5e(e,t,r,i,n,s){let a=t.x-e.x,o=t.y-e.y,l=r.x-e.x,c=r.y-e.y,u=Math.sqrt((a+l)*(a+l)+(o+c)*(o+c)),d;return Ise(t,e,r)>Math.PI&&(u*=-1),ww(c,o)?d=(o+c)*(i/u-.5)*8/3/(a-l):d=(a+l)*(i/u-.5)*8/3/(c-o),n.set(t.x-d*o,t.y+d*a),s.set(r.x+d*c,r.y-d*l),[n,s]}function EY(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function AY(e,t){return qL(e.position,e.controls[1].position,t.position)&&qL(e.position,t.controls[0].position,t.position)}function r5e(e,t,r,i,n=.5){let s=nb.subVectors(t,e).multiplyScalar(n).add(e),a=W3.subVectors(r,t).multiplyScalar(n).add(t),o=WLe.subVectors(i,r).multiplyScalar(n).add(r),l=s,c=qLe.subVectors(a,s).multiplyScalar(n).add(s),u=YLe.subVectors(o,a).multiplyScalar(n).add(a),d=o,f=XLe.subVectors(u,c).multiplyScalar(n).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,f.x,f.y,u.x,u.y,d.x,d.y,i.x,i.y]}function i5e(e,t,r=12,i=!0){let n=Rse.set(0,0,0),s,a=0;for(let o=0;o<t.length;o++){let l=kB(t[o]),c=nb,u=Ng(l,r);for(let d=0;d<=u;d++)if(l instanceof Ec||l instanceof Ip||l instanceof Nc){if(l.getPoint(d/u,c),n.set(c.x,c.y,0),s!==void 0&&QLe(s,n))continue;s===void 0&&(s=kse),s.copy(n),e.setXYZ(a,n.x,n.y,n.z),a++}}return i&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),e}function n5e(e,t,r,i=12,n=!0){let s=Rse.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){if(r[l]===!1)continue;let c,u=kB(t[l]),d=nb,f=Ng(u,i);o.push(f);for(let m=0;m<=f;m++)if(u instanceof Ec||u instanceof Ip||u instanceof Nc){if(u.getPoint(m/f,d),s.set(d.x,d.y,0),c?.equals(s))continue;c===void 0?c=kse:(e.setXYZ(a,c.x,c.y,c.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),c.copy(s)}}return n&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}function CY(e,t=12,r=!1){let i=[];for(let n=0,s=e.length;n<s;n++){let a=e[n],o=0;if(r&&a.roundedCurveCorner!==void 0){let l=Ng(a.roundedCurveCorner,t)*.5;n>0&&(i[n-1]+=l),o+=l}a.curveAfter!==void 0&&(o+=Ng(a.curveAfter,t)),i.push(o)}return e.length>0&&r&&e[0].roundedCurveCorner!==void 0&&(i[e.length-1]+=Ng(e[0].roundedCurveCorner,t)*.5),i}function Ng(e,t=12){return e&&e instanceof D3?t*2:e&&(e instanceof Nc||e instanceof Aie)?1:e&&e instanceof q6?t*e.points.length:t}function s5e(e,t,r=12,i=!0){let n,s=0;for(let a=0;a<t.length;a++){let o=kB(t[a]),l=Ng(o,r),c=nb;for(let u=0;u<=l;u++)if(o instanceof Ec||o instanceof Ip||o instanceof Nc){if(o.getPoint(u/l,c),n!==void 0&&KLe(n,c,H1))continue;n===void 0&&(n=W3),n.copy(c),e.push(c.x,c.y),s++}}return ww(e[0],e[e.length-2],H1)&&ww(e[1],e[e.length-1],H1)&&(e.pop(),e.pop()),i&&s>1&&!(ww(e[s-1],e[1],H1)&&ww(e[s-2],e[0],H1))&&(e.push(e[0],e[1]),s++),e}var P4=new ge,a5e=new ge,o5e=new ge,l5e=new ge,c5e=new ge,u5e=new ge,Pn=class extends cM{constructor(t=100,r=100){super(),this.points=[],this.shapeHoles=[],this.plane=new So(new V(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=Ct.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=t,this._height=r}static createFromState(t,r,i){let n=new Pn;return n.isClosed=t.isClosed,n.points=t.points.map(s=>jy.create(s.id,s.data)),typeof t.roundness=="number"&&(n.roundness=t.roundness),n.shapeHoles=t.shapeHoles.map(s=>Pn.createFromState(s)),r!==void 0&&i!==void 0&&n.applySize(r,i),n.update(),n}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(t){if(this._roundness!==t){this._roundness=t;for(let r=0,i=this.points.length;r<i;r++)this.points[r].roundness=t;this.needsUpdate=!0}}getPointsIndexesByIds(t){return t.map(r=>this.getPointIndexById(r)).filter(r=>r>=0)}getPointIndexById(t){let r=this.points.length,i=this.points.findIndex(n=>n.uuid===t);if(i<0){let n=r;for(let s=0,a=this.shapeHoles.length;s<a;s++){let o=this.shapeHoles[s],l=o.points.length,c=o.getPointIndexById(t);if(c<0)n+=l;else return c+n}}return i}getLineIndexById(t){return this.getPointIndexById(t)}getBezierPoint(t){if(t<=this.points.length-1)return this.points[t];if(this.shapeHoles.length>0){let r=this.points.length;for(let i=0,n=this.shapeHoles.length;i<n;i++){let s=this.shapeHoles[i],a=t-r;if(a<=s.points.length-1)return s.points[a];r+=s.points.length}}throw new Error("This shape does not have a point for this index: "+t)}getBezierPointIndex(t){let r=this.points.indexOf(t);if(r>=0)return r;if(r=this.points.length,this.shapeHoles.length>0)for(let i=0,n=this.shapeHoles.length;i<n;i++){let s=this.shapeHoles[i],a=s.points.indexOf(t);if(a>=0)return r+a;r+=s.points.length}return-1}getAllPoints(){let t=[].concat(...this.shapeHoles.map(r=>r.points));return[...this.points,...t]}applySize(t,r){t===0&&(t=.001),r===0&&(r=.001),this._width=t,this._height=r}applyScale(t,r){let i=P4.set(t,r);for(let n=0,s=this.points.length;n<s;n++){let a=this.points[n];a.position.multiply(i),a.controls[0].position.multiply(i),a.controls[1].position.multiply(i)}for(let n=0,s=this.shapeHoles.length;n<s;n++)this.shapeHoles[n].applyScale(t,r);this._update()}createPoint(t,r=0,i=Ct.generateUUID()){let n;t instanceof ge?n=t:n=new ge(t,r);let s=new jy(i,n);return s.roundness=this.roundness,s}addPoint(t){this.points.push(t),this.needsUpdate=!0}addPointAt(t,r){this.points.splice(r,0,t),this.needsUpdate=!0}getPointByUuid(t){for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r];if(n.uuid===t)return n}for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r].getPointByUuid(t);if(n)return n}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(t){let r=this.points.indexOf(t);r>=0&&this.points.splice(r,1),this.needsUpdate=!0}removePointById(t){let r=this.points.find(i=>i.uuid===t);r&&this.removePoint(r)}update(){for(let t=0,r=this.shapeHoles.length;t<r;t++)this.shapeHoles[t].update();this._update()}extractShapePointsToBuffer(t,r=12,i=!1){this.subdivision=r,this.curveDivisions===void 0&&this.computeCurveDivisions(r);let n=i?this.roundedCurveDivisions:this.curveDivisions;return i5e(t,i?this.roundedCurves:this.curves,r,this.autoClose),n.reduce((s,a)=>s+a,0)+1}computeCurveDivisions(t=12){return this.curveDivisions=CY(this.points,t,!1),this.roundedCurveDivisions=CY(this.points,t,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(t,r,i=12){return n5e(t,this.curves,r,i,this.autoClose).reduce((n,s)=>n+s,0)*2}extractShapePointsToFlatArray(t,r=12){return this.subdivision=r,this.curveDivisions===void 0&&this.computeCurveDivisions(r),s5e(t,this.roundedCurves,r,this.autoClose)}getCurveIndexFromVertexId(t,r=!1){let i=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let n=r?this.roundedCurveDivisions:this.curveDivisions,s=0;r&&this.points[0].roundedCurveCorner!==void 0&&(s=Ng(this.points[0].roundedCurveCorner,this.subdivision)*.5);let a=t-s;a<0&&(a+=n.reduce((o,l)=>o+l,0));for(let o=0,l=n.length;o<l;o++){let c=n[o];if(a<i+c)return[o,(a-i+1)/c];i+=c}return[0,1]}getCurveT(t,r,i){let n=this.points[t],s=this.points[t>=this.points.length-1?0:t+1],a=this.curveDivisions,o=a[t];if(EY(n,s)){let c=n.position.distanceTo(s.position);return n.position.distanceTo(P4.set(i.x,i.y))/c}let l=0;for(let c=0;c<t;c++)l+=a[c];return(r-l)/o}dispose(){}_applyCurveForPoint(t,r){EY(r,t)?this.lineTo(t.position.x,t.position.y):this.bezierCurveTo(r.controls[1].position.x,r.controls[1].position.y,t.controls[0].position.x,t.controls[0].position.y,t.position.x,t.position.y);let i=this.curves[this.curves.length-1];t.curveBefore=i,r.curveAfter=i;let n=i.clone();t.roundedCurveBefore=n,r.roundedCurveAfter=n,t.roundedCurveCorner=void 0,this.roundedCurves.push(n)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let r=0,i=this.points.length;r<i;r++){let n=this.points[r];if(r===0)this.moveTo(n.position.x,n.position.y);else{let s=this.points[r-1];this._applyCurveForPoint(n,s)}}let t=this.getLastPoint();if(t?.curveAfter&&(t.curveAfter=void 0),this.isClosed){let r=this.points[0],i=this.points[this.points.length-1];this._applyCurveForPoint(r,i)}if(this.points.length>2){let r=0;for(let i=0,n=this.points.length;i<n;i++){let s=this.points[i],a=this.points[i-1]??this.points[this.points.length-1],o=this.points[i+1]??this.points[0],l=s.roundness,c=a&&o&&ZLe(a,s,o);if(!s.controlsMoved()&&l>0&&!c){let u=s.curveBefore,d=s.curveAfter;if(u===void 0||d===void 0)continue;let f=s.roundedCurveBefore,m=s.roundedCurveAfter,v=u.getLength(),y=d.getLength(),x=Math.min(l,v*.499),w=Math.min(l,y*.499),_=Math.min(x,w),S=1-_/v,P=_/y,M=u.getPointAt(S,P4),C=d.getPointAt(P,a5e);this._subSplitCurve(u,f,S,M,void 0),this._subSplitCurve(d,m,P,void 0,C);let T;if(this.useCubicForRoundedCorners){let E=Ise(M,s.position,C)/2,N=Math.tan(E)*M.distanceTo(s.position),[D,I]=JLe(M,C,N,o5e,l5e),j=e5e(D,I,s.position),[L,B]=t5e(j,M,C,N,c5e,u5e);T=new Ec(M.clone(),L.clone(),B.clone(),C.clone())}else T=new Ip(M.clone(),s.position.clone(),C.clone());s.roundedCurveCorner=T,this.roundedCurves.splice(i+r,0,T),r++}}}}_subSplitCurve(t,r,i,n,s){if(t instanceof Nc)n!==void 0&&r.v2.copy(n),s!==void 0&&r.v1.copy(s);else{let a=t,o=r,l=a.getUtoTmapping(i,0),c=r5e(a.v0,a.v1,a.v2,a.v3,l);return n!==void 0&&(o.v0.set(c[0],c[1]),o.v1.set(c[2],c[3]),o.v2.set(c[4],c[5]),o.v3.set(c[6],c[7])),s!==void 0&&(o.v0.set(c[6],c[7]),o.v1.set(c[8],c[9]),o.v2.set(c[10],c[11]),o.v3.set(c[12],c[13])),o}return r}clone(){let t=new Pn(this._width,this._height);return t.points=this.points.map(r=>r.clone()),t.isClosed=this.isClosed,t.roundness=this.roundness,t.isMesh2D=this.isMesh2D,t.shapeHoles=this.shapeHoles.map(r=>r.clone()),t}toJSON(){return{points:this.points.reduce((t,r)=>t.concat(r.toJSON()),[]),shapeHoles:this.shapeHoles.map(t=>t.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(t){this.points=[],this.pointIDs=0;let r=t.points.length/7;for(let i=0;i<r;i++){let n=i*7,s=t.points[n+0],a=t.points[n+1],o=t.points[n+2],l=t.points[n+3],c=t.points[n+4],u=t.points[n+5],d=t.points[n+6],f=new jy(Ct.generateUUID(),new ge(s,a));f.controls[0].position.set(o,l),f.controls[1].position.set(c,u),f.roundness=d,this.points.push(f)}return this.shapeHoles=t.shapeHoles?.length?t.shapeHoles.map(i=>{let n=new Pn;return n.fromJSON(i),n}):[],this.isClosed=t.isClosed,this._roundness=t.roundness,this._update(),this}fromShape(t,r=!1){this.isText=r;let i=(s,a)=>{a instanceof Ec&&a.v3.equals(s.position)&&s.controls[0].position.copy(a.v2)},n=s=>{let a=[],o,l;for(o=0,l=s.length;o<l;o++)s[o]instanceof Ip&&(s[o]=$Le(s[o]));for(o=0,l=s.length;o<l;o++){let d=s[o],f=o>0?s[o-1]:null,m;d instanceof Ec?(m=this.createPoint(d.v0),m.controls[1].position.copy(d.v1)):d instanceof Nc&&(m=this.createPoint(d.v1)),m!==void 0&&(f!==null&&i(m,f),a.push(m))}let c=s[s.length-1],u=!1;return c instanceof Ec?c.v3.equals(a[0].position)&&(a[0].controls[0].position.copy(c.v2),u=!0):c instanceof Nc&&c.v2.equals(a[0].position)&&(u=!0),this.isClosed=u,a};return this.points=n(t.curves),t instanceof cM&&(this.shapeHoles=t.holes.map(s=>{let a=new Pn;return a.fromShape(s),a})),this.update(),this}updatePoint(t,r){let i=this.getPointByUuid(t);i&&(r.position!==void 0&&i.position.fromArray(r.position),r.roundness!==void 0&&(i.roundness=r.roundness),r.areControlsDirectionsMirrored!==void 0&&(i.areControlsDirectionsMirrored=r.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(t,r){let i=this.getPointByUuid(t)?.controls[0];i&&(r.position&&i.position.fromArray(r.position),this.needsUpdate=!0)}updateNextControl(t,r){let i=this.getPointByUuid(t)?.controls[1];i&&(r.position&&i.position.fromArray(r.position),this.needsUpdate=!0)}},Ose=Math.PI*2;function D4({x:e,y:t},r,i,n,s){return{x:e*r+n,y:t*i+s}}function d5e(e,t){let r=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),n=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:i-n*r,y:n+i*r},{x:s+a*r,y:a-s*r},{x:s,y:a}]}function TY(e,t,r,i){let n=e*i-t*r<0?-1:1,s=Math.min(1,Math.max(-1,e*r+t*i));return n*Math.acos(s)}function h5e(e,t,r,i,n,s,a,o,l,c){let u=Math.pow(n,2),d=Math.pow(s,2),f=Math.pow(a,2),m=Math.pow(o,2),v=u*d-u*m-d*f;v<0&&(v=0),v/=u*m+d*f,v=Math.sqrt(v)*(l===c?-1:1);let y=v*n/s*o,x=v*-s/n*a,w=y+(e+r)/2,_=x+(t+i)/2,S=(a-y)/n,P=(o-x)/s,M=(-a-y)/n,C=(-o-x)/s,T=TY(1,0,S,P),E=TY(S,P,M,C);return E<0&&(E+=Ose),{centerx:w,centery:_,ang1:T,ang2:E}}function f5e({px:e,py:t,cx:r,cy:i,rx:n,ry:s,largeArcFlag:a,sweepFlag:o}){let l=[];if(n===0||s===0)return[];let c=(e-r)/2,u=(t-i)/2;if(c===0&&u===0)return[];n=Math.abs(n),s=Math.abs(s);let d=Math.pow(c,2)/Math.pow(n,2)+Math.pow(u,2)/Math.pow(s,2);d>1&&(n*=Math.sqrt(d),s*=Math.sqrt(d));let f=h5e(e,t,r,i,n,s,c,u,a,o),{ang1:m,ang2:v}=f,{centerx:y,centery:x}=f,w=Math.abs(v)/(Ose/4);Math.abs(1-w)<1e-7&&(w=1);let _=Math.max(Math.ceil(w),1);v/=_;for(let S=0;S<_;S++)l.push(d5e(m,v)),m+=v;return l.map(S=>{let{x:P,y:M}=D4(S[0],n,s,y,x),{x:C,y:T}=D4(S[1],n,s,y,x),{x:E,y:N}=D4(S[2],n,s,y,x);return{x1:P,y1:M,x2:C,y2:T,x:E,y:N}})}var ki;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(ki||(ki={}));var ss;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(ss||(ss={}));function sr(e,t){if(!e)throw t||"Assertion Failed!"}var $t=function(){function e(){}return e.vertEq=function(t,r){return t.s===r.s&&t.t===r.t},e.vertLeq=function(t,r){return t.s<r.s||t.s===r.s&&t.t<=r.t},e.transLeq=function(t,r){return t.t<r.t||t.t===r.t&&t.s<=r.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,r){return Math.abs(t.s-r.s)+Math.abs(t.t-r.t)},e.edgeEval=function(t,r,i){sr(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?n<s?r.t-t.t+(t.t-i.t)*(n/(n+s)):r.t-i.t+(i.t-t.t)*(s/(n+s)):0},e.edgeSign=function(t,r,i){sr(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?(r.t-i.t)*n+(r.t-t.t)*s:0},e.transEval=function(t,r,i){sr(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?n<s?r.s-t.s+(t.s-i.s)*(n/(n+s)):r.s-i.s+(i.s-t.s)*(s/(n+s)):0},e.transSign=function(t,r,i){sr(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?(r.s-i.s)*n+(r.s-t.s)*s:0},e.vertCCW=function(t,r,i){return t.s*(r.t-i.t)+r.s*(i.t-t.t)+i.s*(t.t-r.t)>=0},e.interpolate=function(t,r,i,n){return t=t<0?0:t,i=i<0?0:i,t<=i?i===0?(r+n)/2:r+(n-r)*(t/(t+i)):n+(r-n)*(i/(t+i))},e.intersect=function(t,r,i,n,s){var a,o,l;e.vertLeq(t,r)||(l=t,t=r,r=l),e.vertLeq(i,n)||(l=i,i=n,n=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.vertLeq(i,r)?e.vertLeq(r,n)?(a=e.edgeEval(t,i,r),o=e.edgeEval(i,r,n),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,r.s)):(a=e.edgeSign(t,i,r),o=-e.edgeSign(t,n,r),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,n.s)):s.s=(i.s+r.s)/2,e.transLeq(t,r)||(l=t,t=r,r=l),e.transLeq(i,n)||(l=i,i=n,n=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.transLeq(i,r)?e.transLeq(r,n)?(a=e.transEval(t,i,r),o=e.transEval(i,r,n),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,r.t)):(a=e.transSign(t,i,r),o=-e.transSign(t,n,r),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,n.t)):s.t=(i.t+r.t)/2},e}(),G1=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),OA=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),ry=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),MY=function(){function e(){var t=new ry,r=new G1,i=new OA(0),n=new OA(1);t.next=t.prev=t,t.anEdge=null,r.next=r.prev=r,i.next=i,i.Sym=n,n.next=n,n.Sym=i,this.vHead=t,this.fHead=r,this.eHead=i,this.eHeadSym=n}return e.prototype.makeEdge_=function(t){var r=new OA(0),i=new OA(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return i.next=n,n.Sym.next=r,r.next=t,t.Sym.next=i,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r},e.prototype.splice_=function(t,r){var i=t.Onext,n=r.Onext;i.Sym.Lnext=r,n.Sym.Lnext=t,t.Onext=n,r.Onext=i},e.prototype.makeVertex_=function(t,r,i){var n=t;sr(n,"Vertex can't be null!");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r;var a=r;do a.Org=n,a=a.Onext;while(a!==r)},e.prototype.makeFace_=function(t,r,i){var n=t;sr(n,"Face can't be null");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r,n.trail=null,n.marked=!1,n.inside=i.inside;var a=r;do a.Lface=n,a=a.Lnext;while(a!==r)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var r=t.next,i=t.Sym.next;r.Sym.next=i,i.Sym.next=r},e.prototype.killVertex_=function(t,r){var i=t.anEdge,n=i;do n.Org=r,n=n.Onext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.killFace_=function(t,r){var i=t.anEdge,n=i;do n.Lface=r,n=n.Lnext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.makeEdge=function(){var t=new ry,r=new ry,i=new G1,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(r,n.Sym,this.vHead),this.makeFace_(i,n,this.fHead),n},e.prototype.splice=function(t,r){var i=!1,n=!1;if(t!==r){if(r.Org!==t.Org&&(n=!0,this.killVertex_(r.Org,t.Org)),r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(r,t),!n){var s=new ry;this.makeVertex_(s,r,t.Org),t.Org.anEdge=t}if(!i){var a=new G1;this.makeFace_(a,r,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var r=t.Sym,i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){var n=new G1;this.makeFace_(n,t,t.Lface)}r.Onext===r?(this.killVertex_(r.Org,null),this.killFace_(r.Lface,null)):(t.Lface.anEdge=r.Oprev,r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var r=this.makeEdge_(t),i=r.Sym;this.splice_(r,t.Lnext),r.Org=t.Dst;var n=new ry;return this.makeVertex_(n,i,r.Org),r.Lface=i.Lface=t.Lface,r},e.prototype.splitEdge=function(t){var r=this.addEdgeVertex(t),i=r.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i.idx=t.idx,i.Sym.idx=t.Sym.idx,i},e.prototype.connect=function(t,r){var i=!1,n=this.makeEdge_(t),s=n.Sym;if(r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(s,r),n.Org=t.Dst,s.Org=r.Org,n.Lface=s.Lface=t.Lface,t.Lface.anEdge=s,!i){var a=new G1;this.makeFace_(a,n,t.Lface)}return n},e.prototype.zapFace=function(t){var r=t.anEdge,i,n,s,a,o;n=r.Lnext;do i=n,n=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),s=i.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(i));while(i!=r);a=t.prev,o=t.next,o.prev=a,a.next=o},e.prototype.countFaceVerts_=function(t){var r=t.anEdge,i=0;do i++,r=r.Lnext;while(r!==t.anEdge);return i},e.prototype.mergeConvexFaces=function(t){var r,i,n,s,a,o,l;for(r=this.fHead.next;r!==this.fHead;r=r.next)if(r.inside)for(i=r.anEdge,a=i.Org;n=i.Lnext,s=i.Sym,s&&s.Lface&&s.Lface.inside&&(o=this.countFaceVerts_(r),l=this.countFaceVerts_(s.Lface),o+l-2<=t&&$t.vertCCW(i.Lprev.Org,i.Org,s.Lnext.Lnext.Org)&&$t.vertCCW(s.Lprev.Org,s.Org,i.Lnext.Lnext.Org)&&(n=s.Lnext,this.delete(s),i=null,s=null)),!(i&&i.Lnext.Org===a);)i=n;return!0},e.prototype.check=function(){var t=this.fHead,r=this.vHead,i=this.eHead,n,s,a,o,l,c;for(s=t,s=t;(n=s.next)!==t;s=n){sr(n.prev===s),l=n.anEdge;do sr(l.Sym!==l),sr(l.Sym.Sym===l),sr(l.Lnext.Onext.Sym===l),sr(l.Onext.Sym.Lnext===l),sr(l.Lface===n),l=l.Lnext;while(l!==n.anEdge)}for(sr(n.prev===s&&n.anEdge===null),o=r,o=r;(a=o.next)!==r;o=a){sr(a.prev===o),l=a.anEdge;do sr(l.Sym!==l),sr(l.Sym.Sym===l),sr(l.Lnext.Onext.Sym===l),sr(l.Onext.Sym.Lnext===l),sr(l.Org===a),l=l.Onext;while(l!==a.anEdge)}for(sr(a.prev===o&&a.anEdge===null),c=i,c=i;(l=c.next)!==i;c=l)sr(l.Sym.next===c.Sym),sr(l.Sym!==l),sr(l.Sym.Sym===l),sr(l.Org!==null),sr(l.Dst!==null),sr(l.Lnext.Onext.Sym===l),sr(l.Onext.Sym.Lnext===l);sr(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),PY=function(){function e(){this.handle=null}return e}(),DY=function(){function e(){this.key=null,this.node=0}return e}(),p5e=function(){function e(t,r){this.leq=r,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var i=0;i<t+1;i++)this.nodes[i]=new PY,this.handles[i]=new DY;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t<<1,a<this.size&&this.leq(i[r[a+1].handle].key,i[r[a].handle].key)&&++a,sr(a<=this.max),s=r[a].handle,a>this.size||this.leq(i[n].key,i[s].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.floatUp_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t>>1,s=r[a].handle,a===0||this.leq(i[s].key,i[n].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var r,i;if(r=++this.size,r*2>this.max){this.max*=2;var n,s;for(s=this.nodes.length,this.nodes.length=this.max+1,n=s;n<this.nodes.length;n++)this.nodes[n]=new PY;for(s=this.handles.length,this.handles.length=this.max+1,n=s;n<this.handles.length;n++)this.handles[n]=new DY}return this.freeList===0?i=r:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[r].handle=i,this.handles[i].node=r,this.handles[i].key=t,this.initialized&&this.floatUp_(r),i},e.prototype.extractMin=function(){var t=this.nodes,r=this.handles,i=t[1].handle,n=r[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,r[t[1].handle].node=1,r[i].key=null,r[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(t){var r=this.nodes,i=this.handles,n;sr(t>=1&&t<=this.max&&i[t].key!==null),n=i[t].node,r[n].handle=r[this.size].handle,i[r[n].handle].node=n,--this.size,n<=this.size&&(n<=1||this.leq(i[r[n>>1].handle].key,i[r[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),i[t].key=null,i[t].node=this.freeList,this.freeList=t},e}(),N4=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),NY=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),m5e=function(){function e(t,r){this.frame=t,this.leq=r,this.head=new NY,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var r=this.head;do r=r.next;while(r.key!==null&&!this.leq(this.frame,t,r.key));return r},e.prototype.insertBefore=function(t,r){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,r));var i=new NY;return i.key=r,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),g5e=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.edgeLeq=function(t,r,i){var n=t.event,s=r.eUp,a=i.eUp;if(s.Dst===n)return a.Dst===n?$t.vertLeq(s.Org,a.Org)?$t.edgeSign(a.Dst,s.Org,a.Org)<=0:$t.edgeSign(s.Dst,a.Org,s.Org)>=0:$t.edgeSign(a.Dst,n,a.Org)<=0;if(a.Dst===n)return $t.edgeSign(s.Dst,n,s.Org)>=0;var o=$t.edgeEval(s.Dst,n,s.Org),l=$t.edgeEval(a.Dst,n,a.Org);return o>=l},e.deleteRegion=function(t,r){r.fixUpperEdge&&sr(r.eUp.winding===0),r.eUp.activeRegion=null,t.dict.delete(r.nodeUp)},e.fixUpperEdge=function(t,r,i){sr(r.fixUpperEdge),t.mesh.delete(r.eUp),r.fixUpperEdge=!1,r.eUp=i,i.activeRegion=r},e.topLeftRegion=function(t,r){var i=r.eUp.Org,n;do r=e.regionAbove(r);while(r.eUp.Org===i);if(r.fixUpperEdge){if(n=t.mesh.connect(e.regionBelow(r).eUp.Sym,r.eUp.Lnext),n===null)return null;e.fixUpperEdge(t,r,n),r=e.regionAbove(r)}return r},e.topRightRegion=function(t){var r=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===r);return t},e.addRegionBelow=function(t,r,i){var n=new N4;return n.eUp=i,n.nodeUp=t.dict.insertBefore(r.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,i.activeRegion=n,n},e.isWindingInside=function(t,r){switch(t.windingRule){case ki.ODD:return(r&1)!==0;case ki.NONZERO:return r!==0;case ki.POSITIVE:return r>0;case ki.NEGATIVE:return r<0;case ki.ABS_GEQ_TWO:return r>=2||r<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,r){r.windingNumber=e.regionAbove(r).windingNumber+r.eUp.winding,r.inside=e.isWindingInside(t,r.windingNumber)},e.finishRegion=function(t,r){var i=r.eUp,n=i.Lface;n.inside=r.inside,n.anEdge=i,e.deleteRegion(t,r)},e.finishLeftRegions=function(t,r,i){for(var n,s=null,a=r,o=r.eUp;a!==i;){if(a.fixUpperEdge=!1,s=e.regionBelow(a),n=s.eUp,n.Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}n=t.mesh.connect(o.Lprev,n.Sym),e.fixUpperEdge(t,s,n)}o.Onext!==n&&(t.mesh.splice(n.Oprev,n),t.mesh.splice(o,n)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,r,i,n,s,a){var o,l,c,u,d=!0;c=i;do sr($t.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,r,c.Sym),c=c.Onext;while(c!==n);for(s===null&&(s=e.regionBelow(r).eUp.Rprev),l=r,u=s;o=e.regionBelow(l),c=o.eUp.Sym,c.Org===u.Org;)c.Onext!==u&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(u.Oprev,c)),o.windingNumber=l.windingNumber-c.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!d&&e.checkForRightSplice(t,l)&&(e.addWinding(c,u),e.deleteRegion(t,l),t.mesh.delete(u)),d=!1,l=o,u=c;l.dirty=!0,sr(l.windingNumber-c.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,r,i){t.mesh.splice(r,i)},e.vertexWeights=function(t,r,i){var n=$t.vertL1dist(r,t),s=$t.vertL1dist(i,t),a=.5*s/(n+s),o=.5*n/(n+s);t.coords[0]+=a*r.coords[0]+o*i.coords[0],t.coords[1]+=a*r.coords[1]+o*i.coords[1],t.coords[2]+=a*r.coords[2]+o*i.coords[2]},e.getIntersectData=function(t,r,i,n,s,a){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,e.vertexWeights(r,i,n),e.vertexWeights(r,s,a)},e.checkForRightSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp;if($t.vertLeq(n.Org,s.Org)){if($t.edgeSign(s.Dst,n.Org,s.Org)>0)return!1;$t.vertEq(n.Org,s.Org)?n.Org!==s.Org&&(t.pq.delete(n.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,n)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(n,s.Oprev),r.dirty=i.dirty=!0)}else{if($t.edgeSign(n.Dst,s.Org,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Oprev,n)}return!0},e.checkForLeftSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a;if(sr(!$t.vertEq(n.Dst,s.Dst)),$t.vertLeq(n.Dst,s.Dst)){if($t.edgeSign(n.Dst,s.Dst,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,a=t.mesh.splitEdge(n),t.mesh.splice(s.Sym,a),a.Lface.inside=r.inside}else{if($t.edgeSign(s.Dst,n.Dst,s.Org)>0)return!1;r.dirty=i.dirty=!0,a=t.mesh.splitEdge(s),t.mesh.splice(n.Lnext,s.Sym),a.Rface.inside=r.inside}return!0},e.checkForIntersect=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a=n.Org,o=s.Org,l=n.Dst,c=s.Dst,u,d,f=new ry,m,v;if(sr(!$t.vertEq(c,l)),sr($t.edgeSign(l,t.event,a)<=0),sr($t.edgeSign(c,t.event,o)>=0),sr(a!==t.event&&o!==t.event),sr(!r.fixUpperEdge&&!i.fixUpperEdge),a===o||(u=Math.min(a.t,l.t),d=Math.max(o.t,c.t),u>d))return!1;if($t.vertLeq(a,o)){if($t.edgeSign(c,a,o)>0)return!1}else if($t.edgeSign(l,o,a)<0)return!1;return e.debugEvent(t),$t.intersect(l,a,c,o,f),sr(Math.min(a.t,l.t)<=f.t),sr(f.t<=Math.max(o.t,c.t)),sr(Math.min(c.s,l.s)<=f.s),sr(f.s<=Math.max(o.s,a.s)),$t.vertLeq(f,t.event)&&(f.s=t.event.s,f.t=t.event.t),m=$t.vertLeq(a,o)?a:o,$t.vertLeq(m,f)&&(f.s=m.s,f.t=m.t),$t.vertEq(f,a)||$t.vertEq(f,o)?(e.checkForRightSplice(t,r),!1):!$t.vertEq(l,t.event)&&$t.edgeSign(l,t.event,f)>=0||!$t.vertEq(c,t.event)&&$t.edgeSign(c,t.event,f)<=0?c===t.event?(t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Sym,n),r=e.topLeftRegion(t,r),n=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),i),e.addRightEdges(t,r,n.Oprev,n,n,!0),!0):l===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(n.Lnext,s.Oprev),i=r,r=e.topRightRegion(r),v=e.regionBelow(r).eUp.Rprev,i.eUp=s.Oprev,s=e.finishLeftRegions(t,i,null),e.addRightEdges(t,r,s.Onext,n.Rprev,v,!0),!0):($t.edgeSign(l,t.event,f)>=0&&(e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),n.Org.s=t.event.s,n.Org.t=t.event.t),$t.edgeSign(c,t.event,f)<=0&&(r.dirty=i.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),!1):(t.mesh.splitEdge(n.Sym),t.mesh.splitEdge(s.Sym),t.mesh.splice(s.Oprev,n),n.Org.s=f.s,n.Org.t=f.t,n.Org.pqHandle=t.pq.insert(n.Org),e.getIntersectData(t,n.Org,a,l,o,c),e.regionAbove(r).dirty=r.dirty=i.dirty=!0,!1)},e.walkDirtyRegions=function(t,r){for(var i=e.regionBelow(r),n,s;;){for(;i.dirty;)r=i,i=e.regionBelow(i);if(!r.dirty&&(i=r,r=e.regionAbove(r),r===null||!r.dirty))return;if(r.dirty=!1,n=r.eUp,s=i.eUp,n.Dst!==s.Dst&&e.checkForLeftSplice(t,r)&&(i.fixUpperEdge?(e.deleteRegion(t,i),t.mesh.delete(s),i=e.regionBelow(r),s=i.eUp):r.fixUpperEdge&&(e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i),n=r.eUp)),n.Org!==s.Org)if(n.Dst!==s.Dst&&!r.fixUpperEdge&&!i.fixUpperEdge&&(n.Dst===t.event||s.Dst===t.event)){if(e.checkForIntersect(t,r))return}else e.checkForRightSplice(t,r);n.Org===s.Org&&n.Dst===s.Dst&&(e.addWinding(s,n),e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i))}},e.connectRightVertex=function(t,r,i){var n,s=i.Onext,a=e.regionBelow(r),o=r.eUp,l=a.eUp,c=!1;if(o.Dst!==l.Dst&&e.checkForIntersect(t,r),$t.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),r=e.topLeftRegion(t,r),s=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),a),c=!0),$t.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,a,null),c=!0),c){e.addRightEdges(t,r,i.Onext,s,s,!0);return}$t.vertLeq(l.Org,o.Org)?n=l.Oprev:n=o,n=t.mesh.connect(i.Lprev,n),e.addRightEdges(t,r,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,r)},e.connectLeftDegenerate=function(t,r,i){var n,s,a,o,l;if(n=r.eUp,$t.vertEq(n.Org,i)){sr(!1),e.spliceMergeVertices(t,n,i.anEdge);return}if(!$t.vertEq(n.Dst,i)){t.mesh.splitEdge(n.Sym),r.fixUpperEdge&&(t.mesh.delete(n.Onext),r.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),e.sweepEvent(t,i);return}sr(!1),r=e.topRightRegion(r),l=e.regionBelow(r),a=l.eUp.Sym,s=o=a.Onext,l.fixUpperEdge&&(sr(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(i.anEdge,a),$t.edgeGoesLeft(s)||(s=null),e.addRightEdges(t,r,a.Onext,o,s,!0)},e.connectLeftVertex=function(t,r){var i,n,s,a,o,l,c=new N4;if(c.eUp=r.anEdge.Sym,i=t.dict.search(c).key,n=e.regionBelow(i),!!n){if(a=i.eUp,o=n.eUp,$t.edgeSign(a.Dst,r,a.Org)===0){e.connectLeftDegenerate(t,i,r);return}if(s=$t.vertLeq(o.Dst,a.Dst)?i:n,i.inside||s.fixUpperEdge){if(s===i)l=t.mesh.connect(r.anEdge.Sym,a.Lnext);else{var u=t.mesh.connect(o.Dnext,r.anEdge);l=u.Sym}s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,r)}else e.addRightEdges(t,i,r.anEdge,r.anEdge,null,!0)}},e.sweepEvent=function(t,r){t.event=r,e.debugEvent(t);for(var i=r.anEdge;i.activeRegion===null;)if(i=i.Onext,i===r.anEdge){e.connectLeftVertex(t,r);return}var n=e.topLeftRegion(t,i.activeRegion);sr(n!==null);var s=e.regionBelow(n),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,n,o):e.addRightEdges(t,n,o.Onext,a,a,!0)},e.addSentinel=function(t,r,i,n){var s=new N4,a=t.mesh.makeEdge();a.Org.s=i,a.Org.t=n,a.Dst.s=r,a.Dst.t=n,t.event=a.Dst,s.eUp=a,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=t.dict.insert(s)},e.initEdgeDict=function(t){t.dict=new m5e(t,e.edgeLeq);var r=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],n=t.bmin[0]-r,s=t.bmax[0]+r,a=t.bmin[1]-i,o=t.bmax[1]+i;e.addSentinel(t,n,s,a),e.addSentinel(t,n,s,o)},e.doneEdgeDict=function(t){for(var r,i=0;(r=t.dict.min().key)!==null;)r.sentinel||(sr(r.fixUpperEdge),sr(++i===1)),sr(r.windingNumber===0),e.deleteRegion(t,r)},e.removeDegenerateEdges=function(t){var r,i,n,s=t.mesh.eHead;for(r=s.next;r!==s;r=i)i=r.next,n=r.Lnext,$t.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(e.spliceMergeVertices(t,n,r),t.mesh.delete(r),r=n,n=r.Lnext),n.Lnext===r&&(n!==r&&((n===i||n===i.Sym)&&(i=i.next),t.mesh.delete(n)),(r===i||r===i.Sym)&&(i=i.next),t.mesh.delete(r))},e.initPriorityQ=function(t){var r,i,n,s=0;for(n=t.mesh.vHead,i=n.next;i!==n;i=i.next)s++;for(s+=8,r=t.pq=new p5e(s,$t.vertLeq),n=t.mesh.vHead,i=n.next;i!==n;i=i.next)i.pqHandle=r.insert(i);return i!==n?!1:(r.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,r){var i,n,s;for(i=r.fHead.next;i!==r.fHead;i=n)n=i.next,s=i.anEdge,sr(s.Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,r){r===void 0&&(r=!0);var i,n;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(i=t.pq.extractMin())!==null;){for(;n=t.pq.min(),!(n===null||!$t.vertEq(n,i));)n=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,n.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(r&&t.mesh.check(),!0):!1},e}(),v5e=function(){function e(){this.mesh=new MY,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=ki.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},e.prototype.normalize_=function(t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!r)throw"Zero-size vector!";r=Math.sqrt(r),t[0]/=r,t[1]/=r,t[2]/=r},e.prototype.longAxis_=function(t){var r=0;return Math.abs(t[1])>Math.abs(t[0])&&(r=1),Math.abs(t[2])>Math.abs(t[r])&&(r=2),r},e.prototype.computeNormal_=function(t){var r,i,n,s,a,o,l=[0,0,0],c=[0,0,0],u=[0,0,0],d=[0,0,0],f=[0,0,0],m=[null,null,null],v=[null,null,null],y=this.mesh.vHead;r=y.next;for(var x=0;x<3;++x)s=r.coords[x],c[x]=s,v[x]=r,l[x]=s,m[x]=r;for(r=y.next;r!==y;r=r.next)for(var w=0;w<3;++w)s=r.coords[w],s<c[w]&&(c[w]=s,v[w]=r),s>l[w]&&(l[w]=s,m[w]=r);var _=0;if(l[1]-c[1]>l[0]-c[0]&&(_=1),l[2]-c[2]>l[_]-c[_]&&(_=2),c[_]>=l[_]){t[0]=0,t[1]=0,t[2]=1;return}for(o=0,i=v[_],n=m[_],u[0]=i.coords[0]-n.coords[0],u[1]=i.coords[1]-n.coords[1],u[2]=i.coords[2]-n.coords[2],r=y.next;r!==y;r=r.next)d[0]=r.coords[0]-n.coords[0],d[1]=r.coords[1]-n.coords[1],d[2]=r.coords[2]-n.coords[2],f[0]=u[1]*d[2]-u[2]*d[1],f[1]=u[2]*d[0]-u[0]*d[2],f[2]=u[0]*d[1]-u[1]*d[0],a=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],a>o&&(o=a,t[0]=f[0],t[1]=f[1],t[2]=f[2]);o<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(u)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,r,i=this.mesh.vHead,n,s=0,a=t.next;a!==t;a=a.next)if(n=a.anEdge,!(n.winding<=0))do s+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext;while(n!==a.anEdge);if(s<0){for(r=i.next;r!==i;r=r.next)r.t=-r.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,r=[0,0,0],i,n,s=!1;r[0]=this.normal[0],r[1]=this.normal[1],r[2]=this.normal[2],!r[0]&&!r[1]&&!r[2]&&(this.computeNormal_(r),s=!0),i=this.sUnit,n=this.tUnit;var a=this.longAxis_(r);i[a]=0,i[(a+1)%3]=1,i[(a+2)%3]=0,n[a]=0,n[(a+1)%3]=0,n[(a+2)%3]=r[a]>0?1:-1;for(var o=t.next;o!==t;o=o.next)o.s=this.dot_(o.coords,i),o.t=this.dot_(o.coords,n);s&&this.checkOrientation_();for(var l=!0,c=t.next;c!==t;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},e.prototype.addWinding_=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,r){var i,n;if(i=r.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;$t.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;$t.vertLeq(i.Org,i.Dst);i=i.Lnext);n=i.Lprev;for(var s=void 0;i.Lnext!==n;)if($t.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&($t.edgeGoesLeft(n.Lnext)||$t.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)s=t.connect(n.Lnext,n),n=s.Sym;n=n.Lprev}else{for(;n.Lnext!==i&&($t.edgeGoesRight(i.Lprev)||$t.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)s=t.connect(i,i.Lprev),i=s.Sym;i=i.Lnext}if(n.Lnext===i)throw"Mono region invalid";for(;n.Lnext.Lnext!==i;)s=t.connect(n.Lnext,n),n=s.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)if(r=i.next,i.inside&&!this.tessellateMonoRegion_(t,i))return!1;return!0},e.prototype.discardExterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)r=i.next,i.inside||t.zapFace(i)},e.prototype.setWindingNumber_=function(t,r,i){for(var n,s=t.eHead.next;s!==t.eHead;s=n)n=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?r:-r:i?t.delete(s):s.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,r,i,n){var s,a=0,o=0,l;i>3&&t.mergeConvexFaces(i);for(var c=t.vHead.next;c!==t.vHead;c=c.next)c.n=-1;for(var u=t.fHead.next;u!==t.fHead;u=u.next)if(u.n=-1,!!u.inside){s=u.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=o,o++),l++,s=s.Lnext}while(s!==u.anEdge);if(l>i)throw"Face vertex greater that support polygon";u.n=a,++a}this.elementCount=a,r===ss.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*i,this.vertexCount=o,this.vertices=[],this.vertices.length=o*n,this.vertexIndices=[],this.vertexIndices.length=o;for(var c=t.vHead.next;c!==t.vHead;c=c.next)if(c.n!==-1){var d=c.n*n;this.vertices[d+0]=c.coords[0],this.vertices[d+1]=c.coords[1],n>2&&(this.vertices[d+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var f=0,u=t.fHead.next;u!==t.fHead;u=u.next)if(u.inside){s=u.anEdge,l=0;do{var c=s.Org;this.elements[f++]=c.n,l++,s=s.Lnext}while(s!==u.anEdge);for(var m=l;m<i;++m)this.elements[f++]=-1;if(r===ss.CONNECTED_POLYGONS){s=u.anEdge;do this.elements[f++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==u.anEdge);for(var v=l;v<i;++v)this.elements[f++]=-1}}},e.prototype.outputContours_=function(t,r){var i,n,s=0,a=0;this.vertexCount=0,this.elementCount=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){n=i=o.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==n);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*r,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,u=0;s=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){a=0,n=i=o.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],r>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,a++,i=i.Lnext;while(i!==n);this.elements[u++]=s,this.elements[u++]=a,s+=a}},e.prototype.addContour=function(t,r){this.mesh===null&&(this.mesh=new MY),t<2&&(t=2),t>3&&(t=3);for(var i=null,n=0;n<r.length;n+=t)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=r[n+0],i.Org.coords[1]=r[n+1],t>2?i.Org.coords[2]=r[n+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},e.prototype.tesselate=function(t,r,i,n,s,a){if(t===void 0&&(t=ki.ODD),r===void 0&&(r=ss.POLYGONS),a===void 0&&(a=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),g5e.computeInterior(this,a);var o=this.mesh;return r===ss.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),a&&o.check(),r===ss.BOUNDARY_CONTOURS?this.outputContours_(o,n):this.outputPolymesh_(o,r,i,n),!0},e}();function pp(e){var t=e.windingRule,r=t===void 0?ki.ODD:t,i=e.elementType,n=i===void 0?ss.POLYGONS:i,s=e.polySize,a=s===void 0?3:s,o=e.vertexSize,l=o===void 0?2:o,c=e.normal,u=c===void 0?[0,0,1]:c,d=e.contours,f=d===void 0?[]:d,m=e.strict,v=m===void 0?!0:m,y=e.debug,x=y===void 0?!1:y;if(!f&&v)throw new Error("Contours can't be empty");if(f){var w=new v5e;e.edgeCreateCallback&&(w.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(w.vertexIdCallback=e.vertexIdCallback);for(var _=0;_<f.length;_++)w.addContour(l||2,f[_]);return w.tesselate(r,n,a,l,u,v),{vertices:w.vertices,vertexIndices:w.vertexIndices,vertexCount:w.vertexCount,elements:w.elements,elementCount:w.elementCount,mesh:x?w.mesh:void 0}}}ki.ODD;ki.NONZERO;ki.POSITIVE;ki.NEGATIVE;ki.ABS_GEQ_TWO;ss.POLYGONS;ss.CONNECTED_POLYGONS;ss.BOUNDARY_CONTOURS;var YL=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let r=e*YL.eSize;this.buffer=new ArrayBuffer(r);let i=Float32Array.BYTES_PER_ELEMENT,n=0;this.positions=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.normals=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.uvs=new Float32Array(this.buffer,n*i,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} → ${e}`);let r=e*YL.eSize,i=new ArrayBuffer(r),n=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(i,s*n,3*e);s+=3*e;let o=new Float32Array(i,s*n,3*e);s+=3*e;let l=new Float32Array(i,s*n,2*e);t?(a.set(this.positions.subarray(0,this.size*3)),o.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(a.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=i,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let i=this.capacity;for(;t>i;)i*=2;this.realloc(i)}let r=this.size;return this.size=t,r}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},jse=YL;jse.eSize=8*Float32Array.BYTES_PER_ELEMENT;var y5e=class{constructor(e=[],t=(r,i)=>r<i?-1:r>i?1:0){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;let e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:r}=this,i=t[e];for(;e>0;){let n=e-1>>1,s=t[n];if(r(i,s)>=0)break;t[e]=s,e=n}t[e]=i}_down(e){let{data:t,compare:r}=this,i=this.length>>1,n=t[e];for(;e<i;){let s=(e<<1)+1,a=s+1;if(a<this.length&&r(t[a],t[s])<0&&(s=a),r(t[s],n)>=0)break;t[e]=t[s],e=s}t[e]=n}};function x5e(e,t,r=1,i=!1){let n=1/0,s=1/0,a=-1/0,o=-1/0;for(let[_,S]of e[0])_<n&&(n=_),S<s&&(s=S),_>a&&(a=_),S>o&&(o=S);let l=a-n,c=o-s,u=Math.max(r,Math.min(l,c));if(u===r){let _=[n,s];return _.distance=0,_.distance}let d=new y5e([],(_,S)=>S.max-_.max),f=w5e(e),m=new qM(n+l/2,s+c/2,0,e);m.d>f.d&&(f=m);let v=2;function y(_,S,P){let M=new qM(_,S,P,e);if(v++,M.max>f.d+r&&d.push(M),M.d>f.d&&(f=M,i&&console.log(`found best ${Math.round(1e4*M.d)/1e4} after ${v} probes`),f.d>t))return t}let x=u/2;for(let _=n;_<a;_+=u)for(let S=s;S<o;S+=u)y(_+x,S+x,x);for(;d.length;){let{max:_,x:S,y:P,h:M}=d.pop();if(_-f.d<=r)break;x=M/2,y(S-x,P-x,x),y(S+x,P-x,x),y(S-x,P+x,x),y(S+x,P+x,x)}i&&console.log(`num probes: ${v}
best distance: ${f.d}`);let w=[f.x,f.y];return w.distance=f.d,w.distance}function qM(e,t,r,i){this.x=e,this.y=t,this.h=r,this.d=b5e(e,t,i),this.max=this.d+this.h*Math.SQRT2}function b5e(e,t,r){let i=!1,n=1/0;for(let s of r)for(let a=0,o=s.length,l=o-1;a<o;l=a++){let c=s[a],u=s[l];c[1]>t!=u[1]>t&&e<(u[0]-c[0])*(t-c[1])/(u[1]-c[1])+c[0]&&(i=!i),n=Math.min(n,_5e(e,t,c,u))}return n===0?0:(i?1:-1)*Math.sqrt(n)}function w5e(e){let t=0,r=0,i=0,n=e[0];for(let a=0,o=n.length,l=o-1;a<o;l=a++){let c=n[a],u=n[l],d=c[0]*u[1]-u[0]*c[1];r+=(c[0]+u[0])*d,i+=(c[1]+u[1])*d,t+=d*3}let s=new qM(r/t,i/t,0,e);return t===0||s.d<0?new qM(n[0][0],n[0][1],0,e):s}function _5e(e,t,r,i){let n=r[0],s=r[1],a=i[0]-n,o=i[1]-s;if(a!==0||o!==0){let l=((e-n)*a+(t-s)*o)/(a*a+o*o);l>1?(n=i[0],s=i[1]):l>0&&(n+=a*l,s+=o*l)}return a=e-n,o=t-s,a*a+o*o}var RB={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},Lse={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},zse={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},k4=(e,t)=>([r,i])=>(i<r&&(i+=t),(e>=r?e:e+t)<=i),IB=class extends Lt{constructor(e,t,r=0,i=12,n=3,s=ki.ODD,a=!1){super(),this.forPathBevel=a,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=i,this._bevelSegmentsInput=n;let o=this._shape.extractShapePointsToFlatArray([],i),l=this._shape.shapeHoles.map(N=>{let D=N.extractShapePointsToFlatArray([],i),I=[];for(let j=D.length-1;j>=1;j-=2){let L=D[j-1],B=D[j-0];I.push(L,B)}return I}),c=[],u=[];for(let N=0;N<o.length;N+=2)u.push([o[N],o[N+1]]);c.push(u);for(let N=0;N<l.length;N++){let D=l[N],I=[];for(let j=0;j<D.length;j+=2)I.push([D[j],D[j+1]]);c.push(I)}let d;e.isText?d=new J6().setFromPoints(e.points.map(N=>N.position)).getSize(new ge).length()*.1:c[0].length===0?d=r:r>0?d=x5e(c,r):d=1e-5,r<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(r,d,t/2),this._bevelSegments=Math.floor(n));let f;try{f=pp({windingRule:s,elementType:ss.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{f=RB}let m;try{m=pp({windingRule:ki.ODD,elementType:ss.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{m=Lse}if(!f)throw new Error("error generating geometry");let v=f.elementCount;if(m){f.elementCount+=m.elementCount;for(let N=0;N<m.elements.length;N++){let D=m.elements[N],I=N%2===0?f.vertexCount:0;f.elements.push(D+I)}for(let N=0;N<m.vertexIndices.length;N++){let D=m.vertexIndices[N],I=f.vertexCount;f.vertexIndices.push(D+I)}for(let N=0;N<m.vertices.length;N++){let D=m.vertices[N];f.vertices.push(D)}}let y=1/0,x=-1/0,w=1/0,_=-1/0;for(let N=0,D=f.vertexCount;N<D;N++){let I=N*2,j=f.vertices[I+0],L=f.vertices[I+1];j<y&&(y=j),j>x&&(x=j),L<w&&(w=L),L>_&&(_=L)}this._minX=y,this._minY=w,this._width=x-y,this._height=_-w,this._buffer=new jse(this._computeBufferEstimatedSize(f));let S=[],P=[];for(let N=f.elementCount-1;N>=0;N--){let D=N>=v,I=N*2,j=f.elements[I+0],L=f.elements[I+1],B=j+L,q={start:j,count:L,normals:[],continuous:[],concave:[]},G=j,Y=B-1,X=j+1,re=this._shape.roundedCurves.length;do{let ne=G-j,ce=f.vertices[Y*2+0],ie=f.vertices[Y*2+1],ae=f.vertices[G*2+0],Z=f.vertices[G*2+1],fe=f.vertices[X*2+0],he=f.vertices[X*2+1],Ae=ae-ce,xe=Z-ie,Ee=Math.sqrt(Ae*Ae+xe*xe);Ae/=Ee,xe/=Ee;let Be=ae-fe,$e=Z-he,mt=Math.sqrt(Be*Be+$e*$e);Be/=mt,$e/=mt,q.normals[ne*2+0]=-$e,q.normals[ne*2+1]=Be,q.concave[ne]=Ae*$e-xe*Be>0;let dt=f.vertexIndices[G];if(Array.isArray(dt))q.continuous[ne]=!1;else{let[ct,ut]=this._shape.getCurveIndexFromVertexId(dt-1,!0);if(ut>0&&ut<1)q.continuous[ne]=!0;else{let me=ut===1?ct+1:ct-1;me=(me+re)%re;let _e=ut===1?0:1,te=this._shape.roundedCurves[ct].getTangent(ut),J=this._shape.roundedCurves[me].getTangent(_e);q.continuous[ne]=te.dot(J)>.95}}D&&(q.normals[ne*2+0]*=-1,q.normals[ne*2+1]*=-1),[Y,G,X]=[G,X,X+1],X>=B&&(X-=L)}while(X!==j+1);let F=[];F.push({bevelI:0,angle:0,size:0,boundary:{vertices:f.vertices.slice(j*2,B*2),vertexCount:L,vertexIndices:new Array(L).fill(!0).map((ne,ce)=>[ce,ce]),elements:[0,L],elementCount:1,mesh:null},reverseMap:[],insetPoints:f.vertices.slice(j*2,B*2)});let $=0;for(let ne=1;ne<=this._bevelSegments;ne++){let ce=ne/this._bevelSegments*Math.PI/2,ie=(1-Math.cos(ce))*this._bevel,ae=[],Z=[],fe=0;for(let Ae=0;Ae<L;Ae++){let xe=Ae*2,Ee=(Ae-1+L)%L*2,Be=f.vertices[q.start*2+xe+0],$e=f.vertices[q.start*2+xe+1],mt=-q.normals[Ee+0]*ie,dt=-q.normals[Ee+1]*ie,ct=-q.normals[xe+0]*ie,ut=-q.normals[xe+1]*ie;if(q.concave[Ae]||!q.concave[Ae]&&D){let me=Math.atan2(dt,mt),_e=Math.atan2(ut,ct);_e>me&&(_e-=Math.PI*2);let te=_e-me;if(q.continuous[Ae]||D){let J=me+te/2,ve=Math.cos(J)*ie,Me=Math.sin(J)*ie;ae[2*fe+0]=Be+ve*(D?-1:1),ae[2*fe+1]=$e+Me*(D?-1:1),Z[fe]=Ae,fe++}else{let J=Math.max(1,Math.floor(i/4*Math.abs(te)/Math.PI));for(let ve=0;ve<=J;ve++){let Me=me+te*(ve/J),W=Math.cos(Me)*ie,Se=Math.sin(Me)*ie;ae[2*fe+0]=Be+W,ae[2*fe+1]=$e+Se,Z[fe]=Ae,fe++}}}else ae[2*fe+0]=Be+mt,ae[2*fe+1]=$e+dt,Z[fe]=Ae,fe++,ae[2*fe+0]=Be,ae[2*fe+1]=$e,Z[fe]=Ae,fe++,ae[2*fe+0]=Be+ct,ae[2*fe+1]=$e+ut,Z[fe]=Ae,fe++}let he=pp({windingRule:ki.POSITIVE,elementType:ss.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[ae],edgeCreateCallback:Ae=>{let xe=Ae.Org.idx,Ee=Z[xe],Be=Z[(xe+1)%Z.length];Ae.idx=[Ee,Be],Ae.Sym.idx=[Be,Ee]},vertexIdCallback:Ae=>{let xe=Ae.Lprev.idx;return[xe?xe[1]:0,Ae.idx?Ae.idx[0]:0]}});if(!he)throw console.log("Error"),new Error(`error generating bevel geometry for ${ne}'th loop`);if(!he.vertexCount){let Ae=(ne-1)/this._bevelSegments*Math.PI/2;$=(1-Math.sin(Ae))*this._bevel;break}for(let Ae=0;Ae<he.vertexIndices.length;Ae++){let[xe,Ee]=he.vertexIndices[Ae];if(xe===Ee)continue;let Be=Ee;Ee<xe&&(Be+=L);for(let $e=xe;$e<Be;$e++){let mt=$e%L,dt=($e+1)%L;if(!q.continuous[mt]||!q.continuous[dt]){he.vertexIndices[Ae]=[xe,mt],he.vertexIndices.splice(Ae+1,0,[dt,Ee]),he.vertices.splice((Ae+1)*2,0,he.vertices[Ae*2],he.vertices[Ae*2+1]);break}}}F.push({bevelI:ne,angle:ce,size:ie,boundary:he,reverseMap:Z,insetPoints:ae})}let se=(ne,ce,ie)=>{let ae=0,Z=ne.boundary.vertexIndices.length;for(;ae<Z&&ie(ne.boundary.vertexIndices[ce]);)ce=(ce+1)%Z,ae++;return ae},H=S.length;for(let ne=1;ne<F.length;ne++){let ce=F[ne-1],ie=F[ne],ae=ce.boundary.vertexIndices.length,Z=ie.boundary.vertexIndices.length;if(!ae||!Z)break;let fe=q.concave.length,he=0,Ae=k4(he,L);for(;!ce.boundary.vertexIndices.filter(Ae).length||!ie.boundary.vertexIndices.filter(Ae).length;)he++,Ae=k4(he,L);let xe=ce.boundary.vertexIndices.findIndex(Ae),Ee=ie.boundary.vertexIndices.findIndex(Ae);do xe=(xe+1)%ae;while(Ae(ce.boundary.vertexIndices[xe]));do Ee=(Ee+1)%Z;while(Ae(ie.boundary.vertexIndices[Ee]));he=(he+1)%L;let Be=he,$e=0,mt=this._buildBevelVert(q,ce,(xe-1+ae)%ae,void 0,$e),dt=this._buildBevelVert(q,ie,(Ee-1+Z)%Z,void 0,$e),ct=mt,ut=dt,me,_e,te=!1;do{$e=(he||fe)/fe,Ae=k4(he,L);let J=se(ce,xe,Ae),ve=se(ie,Ee,Ae),Me=te;if(te=!1,J&&!ve){for(let W=0;W<J;W++)me=this._buildBevelVert(q,ce,(xe+W)%ae,W/(J-1),$e),S.push(ct.topN,me.topP,ut.topN),a===!1&&S.push(me.bottomP,ct.bottomN,ut.bottomN),ct=me;te=!0}else if(!J&&ve)for(let W=0;W<ve;W++)_e=this._buildBevelVert(q,ie,(Ee+W)%Z,W/(ve-1),$e),S.push(ut.topN,ct.topP,_e.topP),a===!1&&S.push(ct.bottomP,ut.bottomN,_e.bottomP),ut=_e;else if(J&&ve)if(me=this._buildBevelVert(q,ce,xe,0,$e),_e=this._buildBevelVert(q,ie,Ee,0,$e),Me?(S.push(ct.topN,_e.topP,ut.topN),S.push(ct.topN,me.topP,_e.topP),a===!1&&(S.push(_e.bottomP,ct.bottomN,ut.bottomN),S.push(_e.bottomP,me.bottomP,ct.bottomN))):(S.push(ut.topN,ct.topN,me.topP),S.push(ut.topN,me.topP,_e.topP),a===!1&&(S.push(me.bottomP,ct.bottomN,ut.bottomN),S.push(me.bottomP,ut.bottomN,_e.bottomP))),ct=me,ut=_e,J===ve)for(let W=1;W<J;W++)me=this._buildBevelVert(q,ce,(xe+W)%ae,W/(J-1),$e),_e=this._buildBevelVert(q,ie,(Ee+W)%Z,W/(ve-1),$e),S.push(ct.topN,me.topP,ut.topN),S.push(ut.topN,me.topP,_e.topP),a===!1&&(S.push(me.bottomP,ct.bottomN,ut.bottomN),S.push(me.bottomP,ut.bottomN,_e.bottomP)),ct=me,ut=_e;else if(J>ve){let W=J/ve,Se=0;for(let ze=1;ze<J;ze++)me=this._buildBevelVert(q,ce,(xe+ze)%ae,ze/(J-1),$e),S.push(ct.topN,me.topP,ut.topN),a===!1&&S.push(me.bottomP,ct.bottomN,ut.bottomN),ct=me,ze>(Se+1)*W&&(Se++,_e=this._buildBevelVert(q,ie,(Ee+Se)%Z,Se/(ve-1),$e),S.push(ut.topN,me.topP,_e.topP),a===!1&&S.push(me.bottomP,ut.bottomN,_e.bottomP),ut=_e)}else{let W=ve/J,Se=0;for(let ze=1;ze<ve;ze++)_e=this._buildBevelVert(q,ie,(Ee+ze)%Z,ze/(ve-1),$e),S.push(ut.topN,me.topP,_e.topP),a===!1&&S.push(me.bottomP,ut.bottomN,_e.bottomP),ut=_e,ze>(Se+1)*W&&(Se++,me=this._buildBevelVert(q,ce,(xe+Se)%ae,Se/(J-1),$e),S.push(ct.topN,me.topP,ut.topN),a===!1&&S.push(me.bottomP,ct.bottomN,ut.bottomN),ct=me)}xe=(xe+J)%ae,Ee=(Ee+ve)%Z,he=(he+1)%fe}while(he!==Be)}if(a===!1&&this._depth>this._bevel*2&&this._buildWall(F,q,S),D){let ne=[];for(let ce=S.length-1;ce>=H+2;ce-=3){let ie=S[ce-2],ae=S[ce-1],Z=S[ce-0];ne.push(Z,ae,ie)}S.splice(H,S.length-H,...ne)}if(D){let ne=[];for(let ce=F[F.length-1].boundary.vertices.length-1;ce>=1;ce-=2){let ie=F[F.length-1].boundary.vertices[ce-1],ae=F[F.length-1].boundary.vertices[ce-0];ne.push(ie,ae)}P.push(ne)}if(!D){let ne=F[F.length-1],ce;try{ce=pp({windingRule:F.length>1?ki.POSITIVE:ki.ODD,elementType:ss.POLYGONS,vertexSize:2,strict:!0,contours:[ne.insetPoints,...P]})}catch{ce=zse}if(!ce)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<d&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let ie=0;ie<ce.elementCount*3;ie+=3){let ae=this._buildSurfaceVert(ce,ce.elements[ie+0],$),Z=this._buildSurfaceVert(ce,ce.elements[ie+1],$),fe=this._buildSurfaceVert(ce,ce.elements[ie+2],$);S.push(ae.top,Z.top,fe.top),a===!1&&S.push(fe.bottom,Z.bottom,ae.bottom)}}this.vertexCache={}}this._buffer.shrink();let M=new Jt(Uint32Array.from(S),1),C=new Jt(this._buffer.positions,3),T=new Jt(this._buffer.normals,3),E=new Jt(this._buffer.uvs,2);C.needsUpdate=!0,T.needsUpdate=!0,E.needsUpdate=!0,M.needsUpdate=!0,this.setAttribute("position",C),this.setAttribute("normal",T),this.setAttribute("uv",E),this.setIndex(M)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,s=i.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,i,n),o=this._buildBevelVert(t,i,(n+1)%s);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}_buildSurfaceVert(e,t,r){let i=t.toString();if(i in this.vertexCache)return this.vertexCache[i];let n=e.vertices[t*2+0],s=e.vertices[t*2+1],a=(n-this._minX)/this._width,o=(s-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),c=l*3,u=l*2,d={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=n,this._buffer.positions[c+1]=s,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-r,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[u+0]=a,this._buffer.uvs[u+1]=o,this.forPathBevel===!1&&(this._buffer.positions[c+3]=n,this._buffer.positions[c+4]=s,this._buffer.positions[c+5]=r,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[u+2]=a,this._buffer.uvs[u+3]=o),this.vertexCache[i]=d,d}_buildBevelVert(e,t,r,i=1,n){let s=`${t.bevelI}:${r}`;if(s in this.vertexCache&&n!==0&&n!==1&&(!n||n===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let[a,o]=t.boundary.vertexIndices[r],l,c,u,d;a!==o?(c=a,l=o,d=!1,u=e.continuous[c]&&e.continuous[l]):(l=a,c=(l-1+e.count)%e.count,d=e.concave[l]&&t.bevelI>0,u=e.continuous[l]||d);let f=Math.cos(t.angle),m=Math.sin(t.angle),v=r*2,y=l*2,x=c*2,w=t.boundary.vertices[v+0],_=t.boundary.vertices[v+1],S=(1-m)*this._bevel,P=(w-this._minX)/this._width,M=(_-this._minY)/this._height;this.forPathBevel&&(n!==void 0&&(P=n),M=1);let C=e.normals[y+0],T=e.normals[y+1],E=e.normals[x+0],N=e.normals[x+1];if(d){let B=E-C,q=N-T;C=C+B*(1-i),T=T+q*(1-i);let G=Math.sqrt(C*C+T*T);C/=G,T/=G}let D=this.forPathBevel?this._buffer.get(u?1:2):this._buffer.get(u?2:4),I=D*3,j=D*2,L={i:r,fi:l,topP:D+0,topN:D+0,bottomP:D+1,bottomN:D+1,pathBevelUCoord:n};return this._buffer.positions[I+0]=w,this._buffer.positions[I+1]=_,this._buffer.positions[I+2]=(this.forPathBevel?this._bevel:this._depth)-S,this._buffer.normals[I+0]=C*f,this._buffer.normals[I+1]=T*f,this._buffer.normals[I+2]=m,this._buffer.uvs[j+0]=P,this._buffer.uvs[j+1]=M,this.forPathBevel===!1&&(this._buffer.positions[I+3]=w,this._buffer.positions[I+4]=_,this._buffer.positions[I+5]=S,this._buffer.normals[I+3]=C*f,this._buffer.normals[I+4]=T*f,this._buffer.normals[I+5]=-m,this._buffer.uvs[j+2]=M,this._buffer.uvs[j+3]=P),u||(this.forPathBevel?(D+=1,I+=3,j+=2):(D+=2,I+=6,j+=4),L.topP=D+0,L.bottomP=D+1,this._buffer.positions[I+0]=w,this._buffer.positions[I+1]=_,this._buffer.positions[I+2]=(this.forPathBevel?this._bevel:this._depth)-S,this._buffer.normals[I+0]=E*f,this._buffer.normals[I+1]=N*f,this._buffer.normals[I+2]=m,this._buffer.uvs[j+0]=P,this._buffer.uvs[j+1]=M,this.forPathBevel===!1&&(this._buffer.positions[I+3]=w,this._buffer.positions[I+4]=_,this._buffer.positions[I+5]=S,this._buffer.normals[I+3]=E*f,this._buffer.normals[I+4]=N*f,this._buffer.normals[I+5]=-m,this._buffer.uvs[j+2]=M,this._buffer.uvs[j+3]=P)),this.vertexCache[s]=L,L}clone(){let e=new IB(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=z3(this.userData),e}},Bse=class extends Lt{constructor(e,t=12,r={}){super(),this.type="ShapeGeometry",this.windingRule=ki.ODD,this.elementType=ss.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:ki.ODD,elementType:ss.POLYGONS,polySize:3,vertexSize:2,strict:!0},r);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),n=this._shape.shapeHoles.map(f=>f.extractShapePointsToFlatArray([],this._curveSegments)),s,a=!0,o=!0,l,c;for(let f=0,m=i.length/2;f<m;f++){let v=f*2,y=i[v+0],x=i[v+1];if(l!==void 0&&y!==l&&(a=!1),c!==void 0&&x!==c&&(o=!1),l=y,c=x,!a&&!o)break}if(!a&&!o)try{s=pp({contours:[i,...n],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=RB}let u=s?.vertexCount??1,d=s?.elementCount??1;if(this._positionAttribute=new Jt(new Float32Array(u*3),3),this._normalAttribute=new Jt(new Float32Array(u*3),3),this._uvAttribute=new Jt(new Float32Array(u*2),2),this._indexAttribute=new Jt(new Uint32Array(d*3),1),s){let f=1/0,m=-1/0,v=1/0,y=-1/0;for(let _=0,S=u;_<S;_++){let P=_*2,M=s.vertices[P+0],C=s.vertices[P+1];M<f&&(f=M),M>m&&(m=M),C<v&&(v=C),C>y&&(y=C)}let x=m-f,w=y-v;for(let _=0,S=u;_<S;_++){let P=_*2,M=s.vertices[P+0],C=s.vertices[P+1],T=(M-f)/x,E=(C-v)/w;this._positionAttribute.setXYZ(_,M,C,0),this._normalAttribute.setXYZ(_,0,0,1),this._uvAttribute.setXY(_,T,E)}for(let _=0,S=d;_<S;_++){let P=_*3,M=s.elements[P+0],C=s.elements[P+1],T=s.elements[P+2];this._indexAttribute.setX(P+0,M),this._indexAttribute.setX(P+1,C),this._indexAttribute.setX(P+2,T)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,(s?.elementCount??1)*3)}clone(){let e=new Bse(this._shape,this._curveSegments);return e.userData=z3(this.userData),e}},Fse=class extends IB{constructor(e,t,r=0,i=12,n=3,s=ki.ODD){super(e,t,r,i,n,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,r){let i=e[0];for(let n=0,s=i.boundary.vertexCount;n<s;n++){let a=this._buildBevelVert(t,i,n),o=this._buildBevelVert(t,i,(n+1)%s);r.push(o.topP,a.topN,a.bottomN),r.push(o.topP,a.bottomN,o.bottomP)}}clone(){let e=new Fse(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=z3(this.userData),e}},g0=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:ki.ODD},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.abs(r.depth??0),a=e.shape??t?.shape,o=a?.roundness??r.roundness;a!==void 0&&(a instanceof Pn?(a.width!==i||a.height!==n)&&a.applySize(i,n):a=new Pn(i,n).fromJSON(a),e.parameters?.roundness!==void 0&&e.parameters?.roundness>0&&a.update());let l=a??new Pn(i,n);return{parameters:Object.assign(r,{width:i,height:n,depth:s,roundness:o}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:r,extrudeBevelSegments:i,subdivisions:n,roundness:s,windingRule:a}=e.parameters;e.shape.roundness=s;let o;return t<=0?o=new Bse(e.shape,n,{windingRule:a}):o=new Fse(e.shape,t,r,n,i,a),Object.assign(o,{userData:{...e,type:"VectorGeometry"}})}},Vse=Math.PI*2,OB=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return r.angle=Ct.clamp(r.angle,0,360),{shape:e.shape&&e.shape instanceof Pn?e.shape:new Pn,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,angle:n,innerRadius:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c=e.shape,u=t*.5,d=r*.5,f=S5e(c,u,d,n*Math.PI/180,i,s);c.isClosed=!0,c.update();let m;return n===0?(m=new Lt,m.setAttribute("position",new At([],3))):m=g0.create({shape:c,parameters:{subdivisions:f,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}}),Object.assign(m,{userData:{...e,type:"EllipseGeometry"}})}};function S5e(e,t,r,i,n,s){if(i>=Vse)return n>30||n%4===0?(A5e(e,t,r,s),Math.round(n/4)):kY(e,i,n,t,r,s);i=Math.max(i,.001);let a={x:0,y:r},o=i+Math.PI*.5,l={x:Math.cos(o)*t,y:Math.sin(o)*r},c=f5e({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:r,largeArcFlag:i>Math.PI,sweepFlag:!0});return n>30||n%c.length===0?E5e(e,a.x,a.y,c,n,t,r,s):kY(e,i,n,t,r,s)}function E5e(e,t,r,i,n,s,a,o){let l=Math.round(n/i.length);e.addPoint(Ly(t,r));for(let c=0,u=i.length;c<u;c++){let d=i[c],f=e.points[c],m=Ly(d.x,d.y);f.controls[1].position.set(d.x1,d.y1),m.controls[0].position.set(d.x2,d.y2),e.addPoint(m)}return o>0?Use(e,s,a,o):e.addPoint(Ly(0,0)),l}function kY(e,t,r,i,n,s){let a=-t/r;for(let o=0;o<=r;o++){let l=a*o,c=Math.sin(l)*i,u=Math.cos(l)*n;e.addPoint(Ly(c,u))}return t<Vse?s>0?Use(e,i,n,s):e.addPoint(Ly(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&Hse(e,i,n,s)),1}function A5e(e,t,r,i=0,n=0,s=0){let a=.5522847498,o=t*a,l=r*a;e.addPoint(jA(n-t,s,n-t,s-l,n-t,s+l)),e.addPoint(jA(n,s+r,n-o,s+r,n+o,s+r)),e.addPoint(jA(n+t,s,n+t,s+l,n+t,s-l)),e.addPoint(jA(n,s-r,n+o,s-r,n-o,s-r)),i>0&&Hse(e,t,r,i)}function Ly(e,t){return new jy(Ct.generateUUID(),new ge(e,t))}function jA(e,t,r,i,n,s){let a=Ly(e,t);return a.controls[0].position.set(r,i),a.controls[1].position.set(n,s),a}function Use(e,t,r,i){Gse(e,t,r,i).forEach(n=>e.addPoint(n))}function Hse(e,t,r,i){let n=Gse(e,t,r,i),s=new Pn;n.forEach(a=>s.addPoint(a)),s.isClosed=!0,e.shapeHoles.push(s)}function Gse(e,t,r,i){let n=i*t/100,s=n*(Math.abs(r)/Math.abs(t)),a=new ge(n/t,s/r),o=e.points.map(l=>{let c=l.clone();return c.uuid=Ct.generateUUID(),c}).reverse();return o.forEach(l=>{l.position.multiply(a);let c=l.controls[0].position.clone().multiply(a),u=l.controls[1].position.clone().multiply(a);l.controls[0].position.copy(u),l.controls[1].position.copy(c)}),o}var C5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??i),s=Math.abs(r.depth??i),a=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(r,{width:i,height:n,depth:s,radius:a,segments:Math.round(r.segments),pathSegments:Math.round(r.pathSegments),cornerSegments:Math.round(r.cornerSegments)})}}static build(e){let{width:t,height:r,depth:i,radius:n,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:c,cornerRadius:u,cornerSegments:d}=e.parameters,f=new Wse(!1,t,r,i,n,s,a,o,l,c,u,d);return Object.assign(f,{userData:{...e,type:"HelixGeometry"}})}},R4=new Ny([0,0,0],1),Wse=class extends Lt{constructor(e=!0,t=1,r=1,i=1,n=1,s=1,a=1,o=1,l=1,c=1,u=1,d=1){if(super(),s===0)return;let f=e&&s===1;f&&(d=0),u>100&&(u=100),u===0&&(d=0);let m=()=>new V,v=new V,y=m(),x=m(),w=m(),_,S,P,M,C,T,E,N,D=m(),I=m(),j=m(),L=m(),B=m(),q=m(),G=m(),Y=m(),X=r-2*o+.001,re=X/s,F=Math.ceil(a*s),$=F+1,se=X/F,H=-X/2,ne=c+1,ce=2*Math.PI/c,ie=Math.PI/2/d,ae=.01,Z=Math.min((1-u/100)*o,o-ae),fe=o-Z,he=0,Ae=2,xe=d*Ae+Ae,Ee=ne*xe/Ae,Be=Ee+ne*$,$e=Math.max(0,ne*($+xe)),[mt,dt,ct]=[3,3,2].map(Ne=>Array($e*Ne).fill(0)),ut=[],me=n-o;function _e(Ne,De){let We=Math.PI/2;T=De*se,N=2*Math.PI*(T%re)/re+We,T+=H,E=Math.sin(N)*me,C=Math.cos(N)*me,e?Ne.set(C,E,T):Ne.set(C,T,E)}_e(v,-1e-10),_e(y,0),D.copy(v),_e(v,1);let te=v.distanceTo(y),J=f?0:fe+Z,ve=te*F+2*J,Me=Z,W=ve-J;for(let Ne=0;Ne<=F;Ne++){_e(x,Ne),Y.subVectors(x,D).normalize(),D.copy(x),q.copy(x).setComponent(+e+1,0).normalize(),G.crossVectors(Y,q).normalize();let De=Ne===0,We=Ne===F,Je=De?3*Math.PI/2:ie,et=De?Me:W,qe=De?ne:Be,ft=De?0:$e-ne,kt=Y.clone().multiplyScalar(De?-fe:fe).add(x),Mt=Y.clone().multiplyScalar(De?-1:1).normalize();for(let ye=0;ye<ne;ye++){let He=ye*ce;if(I.addVectors(v.copy(q).multiplyScalar(o*Math.cos(He)),y.copy(G).multiplyScalar(o*Math.sin(He))),j.copy(I).normalize(),De||We){f||(he=ft+ye,[0,1,2].forEach(tt=>{mt[he*3+tt]=kt.getComponent(tt),dt[he*3+tt]=Mt.getComponent(tt)}),ct[he*2]=+We,ct[he*2+1]=ye/c),y.copy(j).multiplyScalar(Z),w.addVectors(x,y);for(let tt=0;tt<d;tt++){let xt=tt*ie+Je;L.addVectors(v.copy(Y).multiplyScalar(fe*Math.sin(xt)),y.copy(j).multiplyScalar(fe*Math.cos(xt))),B.copy(L).normalize(),y.addVectors(w,L),L.normalize(),he=qe+tt*ne+ye,[0,1,2].forEach(gr=>{mt[he*3+gr]=y.getComponent(gr),dt[he*3+gr]=B.getComponent(gr)});let Wt=+De+Math.sin(xt);ct[he*2]=(et+fe*Wt)/ve,ct[he*2+1]=ye/c}}y.addVectors(x,I),he=Ee+Ne*ne+ye,[0,1,2].forEach(tt=>{mt[he*3+tt]=y.getComponent(tt),dt[he*3+tt]=j.getComponent(tt)}),ct[he*2]=(J+Ne*te)/ve,ct[he*2+1]=ye/c}}let Se=$+2*d+Ae,[ze,Ue]=[+f,Se-1];for(let Ne=ze;Ne<=Ue-1;Ne++){let De=f&&Ne===Ue-1;for(let We=0;We<ne-1;We++)_=Ne*ne+We,S=_+1,P=(De?We:_)+ne,M=(De?We+1:S)+ne,Ne===0?ut.push(S,M,P):Ne===Se-2?ut.push(_,S,P):ut.push(_,S,P,S,M,P)}this.setIndex(ut),this.setAttribute("position",new At(mt,3)),this.setAttribute("normal",new At(dt,3)),this.setAttribute("uv",new At(ct,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),r=e.radialSegments+1,i=Array.from(this.getIndex().array),n,s,a,o,l=6*(t-1)*e.radialSegments,c=t,u=c===t;for(let d=0;d<e.radialSegments;d++)n=c*r+d,s=n+1,a=(u?d:n)+r,o=(u?d+1:s)+r,i[l++]=n,i[l++]=s,i[l++]=a,i[l++]=s,i[l++]=o,i[l++]=a;return i.length=l,R4.array=i,R4.count=i.length,R4}},T5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new qse(t*.5,s,a):new Rie(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:{...e,type:"IcosahedronGeometry"}})}},qse=class extends DB{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a="IcosahedronGeometry";super(n,s,a,e,t,r),this.type=a}static fromJSON(e){return new qse(e.radius,e.corner,e.cornerSides)}},M5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){(e.parameters?.points??[]).forEach(i=>{Array.isArray(i)&&(i.x=i[0],i.y=i[1])});let r=Object.assign({},t?.parameters??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{points:t,segments:r,verticalSegments:i}=e.parameters,n=new cM;n.moveTo(t[0].x,t[0].y),n.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new Tie(n.extractPoints(i).shape,r);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...e,type:"LatheGeometry"}})}},mu=new ot,I4=new Ei,LA=new V,YM=class extends wa{constructor(){super(),this.uuid=Ct.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new as().getNormalMatrix(e);for(let r=0,i=this.vertices.length;r<i;r++)this.vertices[r].applyMatrix4(e);for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];n.normal.applyMatrix3(t).normalize();for(let s=0,a=n.vertexNormals.length;s<a;s++)n.vertexNormals[s].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return mu.makeRotationX(e),this.applyMatrix4(mu),this}rotateY(e){return mu.makeRotationY(e),this.applyMatrix4(mu),this}rotateZ(e){return mu.makeRotationZ(e),this.applyMatrix4(mu),this}translate(e,t,r){return mu.makeTranslation(e,t,r),this.applyMatrix4(mu),this}scale(e,t,r){return mu.makeScale(e,t,r),this.applyMatrix4(mu),this}lookAt(e){return I4.lookAt(e),I4.updateMatrix(),this.applyMatrix4(I4.matrix),this}fromBufferGeometry(e){let t=this,r=e.index!==null?e.index:void 0,i=e.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let n=i.position,s=i.normal,a=i.color,o=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let d=0;d<n.count;d++)t.vertices.push(new V().fromBufferAttribute(n,d)),a!==void 0&&t.colors.push(new Zt().fromBufferAttribute(a,d));function c(d,f,m,v){let y=a===void 0?[]:[t.colors[d].clone(),t.colors[f].clone(),t.colors[m].clone()],x=s===void 0?[]:[new V().fromBufferAttribute(s,d),new V().fromBufferAttribute(s,f),new V().fromBufferAttribute(s,m)],w=new XL(d,f,m,x,y,v);t.faces.push(w),o!==void 0&&t.faceVertexUvs[0].push([new ge().fromBufferAttribute(o,d),new ge().fromBufferAttribute(o,f),new ge().fromBufferAttribute(o,m)]),l!==void 0&&t.faceVertexUvs[1].push([new ge().fromBufferAttribute(l,d),new ge().fromBufferAttribute(l,f),new ge().fromBufferAttribute(l,m)])}let u=e.groups;if(u.length>0)for(let d=0;d<u.length;d++){let f=u[d],m=f.start,v=f.count;for(let y=m,x=m+v;y<x;y+=3)r!==void 0?c(r.getX(y),r.getX(y+1),r.getX(y+2),f.materialIndex):c(y,y+1,y+2,f.materialIndex)}else if(r!==void 0)for(let d=0;d<r.count;d+=3)c(r.getX(d),r.getX(d+1),r.getX(d+2));else for(let d=0;d<n.count;d+=3)c(d,d+1,d+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(LA).negate(),this.translate(LA.x,LA.y,LA.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,r=t===0?1:1/t,i=new ot;return i.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let e=new V,t=new V;for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=this.vertices[n.a],a=this.vertices[n.b],o=this.vertices[n.c];e.subVectors(o,a),t.subVectors(s,a),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let r=0,i=this.vertices.length;r<i;r++)t[r]=new V;if(e){let r=new V,i=new V;for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c];r.subVectors(c,l),i.subVectors(o,l),r.cross(i),t[a.a].add(r),t[a.b].add(r),t[a.c].add(r)}}else{this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let r=0,i=this.vertices.length;r<i;r++)t[r].normalize();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=n.vertexNormals;s.length===3?(s[0].copy(t[n.a]),s[1].copy(t[n.b]),s[2].copy(t[n.c])):(s[0]=t[n.a].clone(),s[1]=t[n.b].clone(),s[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let r=this.faces[e],i=r.vertexNormals;i.length===3?(i[0].copy(r.normal),i[1].copy(r.normal),i[2].copy(r.normal)):(i[0]=r.normal.clone(),i[1]=r.normal.clone(),i[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let n=0,s=i.vertexNormals.length;n<s;n++)i.__originalVertexNormals[n]?i.__originalVertexNormals[n].copy(i.vertexNormals[n]):i.__originalVertexNormals[n]=i.vertexNormals[n].clone()}let e=new YM;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let n=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(let a=0,o=this.faces.length;a<o;a++){let l=new V,c={a:new V,b:new V,c:new V};n.push(l),s.push(c)}}let i=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=i.faceNormals[n],l=i.vertexNormals[n];o.copy(a.normal),l.a.copy(a.vertexNormals[0]),l.b.copy(a.vertexNormals[1]),l.c.copy(a.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Wn),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Oo),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,r=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let i,n=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,c=this.colors,u=e.colors;t!==void 0&&(i=new as().getNormalMatrix(t));for(let d=0,f=a.length;d<f;d++){let m=a[d].clone();t!==void 0&&m.applyMatrix4(t),s.push(m)}for(let d=0,f=u.length;d<f;d++)c.push(u[d].clone());for(let d=0,f=l.length;d<f;d++){let m=l[d],v,y,x=m.vertexNormals,w=m.vertexColors,_=new XL(m.a+n,m.b+n,m.c+n);_.normal.copy(m.normal),i!==void 0&&_.normal.applyMatrix3(i).normalize();for(let S=0,P=x.length;S<P;S++)v=x[S].clone(),i!==void 0&&v.applyMatrix3(i).normalize(),_.vertexNormals.push(v);_.color.copy(m.color);for(let S=0,P=w.length;S<P;S++)y=w[S],_.vertexColors.push(y.clone());_.materialIndex=m.materialIndex+r,o.push(_)}for(let d=0,f=e.faceVertexUvs.length;d<f;d++){let m=e.faceVertexUvs[d];this.faceVertexUvs[d]===void 0&&(this.faceVertexUvs[d]=[]);for(let v=0,y=m.length;v<y;v++){let x=m[v],w=[];for(let _=0,S=x.length;_<S;_++)w.push(x[_].clone());this.faceVertexUvs[d].push(w)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},r=[],i=[],n=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let c=this.vertices[o],u=Math.round(c.x*n)+"_"+Math.round(c.y*n)+"_"+Math.round(c.z*n);t[u]===void 0?(t[u]=o,r.push(this.vertices[o]),i[o]=r.length-1):i[o]=i[t[u]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let c=this.faces[o];c.a=i[c.a],c.b=i[c.b],c.c=i[c.c];let u=[c.a,c.b,c.c];for(let d=0;d<3;d++)if(u[d]===u[(d+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let l=s[o];this.faces.splice(l,1);for(let c=0,u=this.faceVertexUvs.length;c<u;c++)this.faceVertexUvs[c].splice(l,1)}let a=this.vertices.length-r.length;return this.vertices=r,a}setFromPoints(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){let i=e[t];this.vertices.push(new V(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let o=0;o<t;o++)e[o]._id=o;function r(o,l){return o.materialIndex-l.materialIndex}e.sort(r);let i=this.faceVertexUvs[0],n=this.faceVertexUvs[1],s,a;i&&i.length===t&&(s=[]),n&&n.length===t&&(a=[]);for(let o=0;o<t;o++){let l=e[o]._id;s&&s.push(i[l]),a&&a.push(n[l])}s&&(this.faceVertexUvs[0]=s),a&&(this.faceVertexUvs[1]=a)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let m=this.parameters;for(let v in m)m[v]!==void 0&&(e[v]=m[v]);return e}let t=[];for(let m=0;m<this.vertices.length;m++){let v=this.vertices[m];t.push(v.x,v.y,v.z)}let r=[],i=[],n={},s=[],a={},o=[],l={};for(let m=0;m<this.faces.length;m++){let v=this.faces[m],y=!0,x=!1,w=this.faceVertexUvs[0][m]!==void 0,_=v.normal.length()>0,S=v.vertexNormals.length>0,P=v.color.r!==1||v.color.g!==1||v.color.b!==1,M=v.vertexColors.length>0,C=0;if(C=c(C,0,0),C=c(C,1,y),C=c(C,2,x),C=c(C,3,w),C=c(C,4,_),C=c(C,5,S),C=c(C,6,P),C=c(C,7,M),r.push(C),r.push(v.a,v.b,v.c),r.push(v.materialIndex),w){let T=this.faceVertexUvs[0][m];r.push(f(T[0]),f(T[1]),f(T[2]))}if(_&&r.push(u(v.normal)),S){let T=v.vertexNormals;r.push(u(T[0]),u(T[1]),u(T[2]))}if(P&&r.push(d(v.color)),M){let T=v.vertexColors;r.push(d(T[0]),d(T[1]),d(T[2]))}}function c(m,v,y){return y?m|1<<v:m&~(1<<v)}function u(m){let v=m.x.toString()+m.y.toString()+m.z.toString();return n[v]!==void 0||(n[v]=i.length/3,i.push(m.x,m.y,m.z)),n[v]}function d(m){let v=m.r.toString()+m.g.toString()+m.b.toString();return a[v]!==void 0||(a[v]=s.length,s.push(m.getHex())),a[v]}function f(m){let v=m.x.toString()+m.y.toString();return l[v]!==void 0||(l[v]=o.length/2,o.push(m.x,m.y)),l[v]}return e.data={},e.data.vertices=t,e.data.normals=i,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=r,e}clone(){return new YM().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let d=0,f=t.length;d<f;d++)this.vertices.push(t[d].clone());let r=e.colors;for(let d=0,f=r.length;d<f;d++)this.colors.push(r[d].clone());let i=e.faces;for(let d=0,f=i.length;d<f;d++)this.faces.push(i[d].clone());for(let d=0,f=e.faceVertexUvs.length;d<f;d++){let m=e.faceVertexUvs[d];this.faceVertexUvs[d]===void 0&&(this.faceVertexUvs[d]=[]);for(let v=0,y=m.length;v<y;v++){let x=m[v],w=[];for(let _=0,S=x.length;_<S;_++){let P=x[_];w.push(P.clone())}this.faceVertexUvs[d].push(w)}}let n=e.morphTargets;for(let d=0,f=n.length;d<f;d++){let m={};if(m.name=n[d].name,n[d].vertices!==void 0){m.vertices=[];for(let v=0,y=n[d].vertices.length;v<y;v++)m.vertices.push(n[d].vertices[v].clone())}if(n[d].normals!==void 0){m.normals=[];for(let v=0,y=n[d].normals.length;v<y;v++)m.normals.push(n[d].normals[v].clone())}this.morphTargets.push(m)}let s=e.morphNormals;for(let d=0,f=s.length;d<f;d++){let m={};if(s[d].vertexNormals!==void 0){m.vertexNormals=[];for(let v=0,y=s[d].vertexNormals.length;v<y;v++){let x=s[d].vertexNormals[v],w={};w.a=x.a.clone(),w.b=x.b.clone(),w.c=x.c.clone(),m.vertexNormals.push(w)}}if(s[d].faceNormals!==void 0){m.faceNormals=[];for(let v=0,y=s[d].faceNormals.length;v<y;v++)m.faceNormals.push(s[d].faceNormals[v].clone())}this.morphNormals.push(m)}let a=e.skinWeights;for(let d=0,f=a.length;d<f;d++)this.skinWeights.push(a[d].clone());let o=e.skinIndices;for(let d=0,f=o.length;d<f;d++)this.skinIndices.push(o[d].clone());let l=e.lineDistances;for(let d=0,f=l.length;d<f;d++)this.lineDistances.push(l[d]);let c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new P5e().fromGeometry(this),t=new Lt,r=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",zA.call(new Jt(r,3),e.vertices)),e.normals.length>0){let i=new Float32Array(e.normals.length*3);t.setAttribute("normal",zA.call(new Jt(i,3),e.normals))}if(e.colors.length>0){let i=new Float32Array(e.colors.length*3);t.setAttribute("color",RY.call(new Jt(i,3),e.colors))}if(e.uvs.length>0){let i=new Float32Array(e.uvs.length*2);t.setAttribute("uv",IY.call(new Jt(i,2),e.uvs))}if(e.uvs2.length>0){let i=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",IY.call(new Jt(i,2),e.uvs2))}t.groups=e.groups;for(let i in e.morphTargets){let n=[],s=e.morphTargets[i];for(let a=0,o=s.length;a<o;a++){let l=s[a],c=new At(l.data.length*3,3);c.name=l.name,n.push(zA.call(c,l.data))}t.morphAttributes[i]=n}if(e.skinIndices.length>0){let i=new At(e.skinIndices.length*4,4);t.setAttribute("skinIndex",OY.call(i,e.skinIndices))}if(e.skinWeights.length>0){let i=new At(e.skinWeights.length*4,4);t.setAttribute("skinWeight",OY.call(i,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new Lt,r=e.geometry;if(e.isPoints||e.isLine){let i=new At(r.vertices.length*3,3),n=new At(r.colors.length*3,3);if(t.setAttribute("position",zA.call(i,r.vertices)),t.setAttribute("color",RY.call(n,r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){let s=new At(r.lineDistances.length,1);t.setAttribute("lineDistance",D5e.call(s,r.lineDistances))}r.boundingSphere!==null&&(t.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(t.boundingBox=r.boundingBox.clone())}else e.isMesh&&(t=r.toBufferGeometry());return t}};YM.prototype.isGeometry=!0;var P5e=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],r,i,n,s=e.faces;for(i=0;i<s.length;i++){let a=s[i];a.materialIndex!==n&&(n=a.materialIndex,r!==void 0&&(r.count=i*3-r.start,t.push(r)),r={start:i*3,materialIndex:n})}r!==void 0&&(r.count=i*3-r.start,t.push(r)),this.groups=t}fromGeometry(e){let t=e.faces,r=e.vertices,i=e.faceVertexUvs,n=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,a=e.morphTargets,o=a.length,l;if(o>0){l=[];for(let x=0;x<o;x++)l[x]={name:a[x].name,data:[]};this.morphTargets.position=l}let c=e.morphNormals,u=c.length,d;if(u>0){d=[];for(let x=0;x<u;x++)d[x]={name:c[x].name,data:[]};this.morphTargets.normal=d}let f=e.skinIndices,m=e.skinWeights,v=f.length===r.length,y=m.length===r.length;r.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let x=0;x<t.length;x++){let w=t[x];this.vertices.push(r[w.a],r[w.b],r[w.c]);let _=w.vertexNormals;if(_.length===3)this.normals.push(_[0],_[1],_[2]);else{let P=w.normal;this.normals.push(P,P,P)}let S=w.vertexColors;if(S.length===3)this.colors.push(S[0],S[1],S[2]);else{let P=w.color;this.colors.push(P,P,P)}if(n===!0){let P=i[0][x];P!==void 0?this.uvs.push(P[0],P[1],P[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",x),this.uvs.push(new ge,new ge,new ge))}if(s===!0){let P=i[1][x];P!==void 0?this.uvs2.push(P[0],P[1],P[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",x),this.uvs2.push(new ge,new ge,new ge))}for(let P=0;P<o;P++){let M=a[P].vertices;l[P].data.push(M[w.a],M[w.b],M[w.c])}for(let P=0;P<u;P++){let M=c[P].vertexNormals[x];d[P].data.push(M.a,M.b,M.c)}v&&this.skinIndices.push(f[w.a],f[w.b],f[w.c]),y&&this.skinWeights.push(m[w.a],m[w.b],m[w.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},XL=class{constructor(e,t,r,i,n,s=0){this.a=e,this.b=t,this.c=r,this.normal=i&&i.isVector3?i:new V,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new Zt,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function D5e(e){return this.array.set(e),this}function RY(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new Zt),t[r++]=s.r,t[r++]=s.g,t[r++]=s.b}return this}function IY(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new ge),t[r++]=s.x,t[r++]=s.y}return this}function zA(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new V),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z}return this}function OY(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new fr),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z,t[r++]=s.w}return this}var N5e=["a","b","c"];function k5e(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function O4(e,t,r){let i=Math.min(e,t),n=Math.max(e,t),s=i+"_"+n;return r.get(s)}function j4(e,t,r,i,n,s){let a=Math.min(e,t),o=Math.max(e,t),l=a+"_"+o,c;if(i.has(l))c=i.get(l);else{let u=r[a],d=r[o];c={a:u,b:d,newEdge:null,faces:[]},i.set(l,c)}c.faces.push(n),s[e].edges.push(c),s[t].edges.push(c)}function R5e(e,t,r,i){let n,s,a;for(n=0,s=e.length;n<s;n++)r[n]={edges:[]};for(n=0,s=t.length;n<s;n++)a=t[n],j4(a.a,a.b,e,i,a,r),j4(a.b,a.c,e,i,a,r),j4(a.c,a.a,e,i,a,r)}function BA(e,t,r,i,n){e.push(new XL(t,r,i,void 0,void 0,n))}function kv(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function FA(e,t,r,i){e.push([t.clone(),r.clone(),i.clone()])}var I5e=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof Lt?e=new YM().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new V,r,i,n,s,a,o=e.vertices,l=e.faces,c=e.faceVertexUvs[0],u=c!==void 0&&c.length>0,d=[],f=new Map;R5e(o,l,d,f);let m=[],v,y,x,w,_,S,P;for(let ae of Array.from(f.keys())){for(y=f.get(ae),x=new V,_=3/8,S=1/8,P=y.faces.length,P!=2&&(_=.5,S=0,P!=1),x.addVectors(y.a,y.b).multiplyScalar(_),t.set(0,0,0),s=0;s<P;s++){for(w=y.faces[s],a=0;a<3&&(v=o[k5e(w,N5e[a])],!(v!==y.a&&v!==y.b));a++);v&&t.add(v)}t.multiplyScalar(S),x.add(t),y.newEdge=m.length,m.push(x)}let M,C,T,E,N,D,I,j=[];for(i=0,n=o.length;i<n;i++){for(D=o[i],N=d[i].edges,r=N.length,r==3?M=3/16:r>3&&(M=3/(8*r)),C=1-r*Number(M),T=M,r<=2&&(r==2?(C=3/4,T=1/8):r==1||r==0),I=D.clone().multiplyScalar(C),t.set(0,0,0),s=0;s<r;s++)E=N[s],v=E.a!==D?E.a:E.b,t.add(v);t.multiplyScalar(Number(T)),I.add(t),j.push(I)}let L=j.concat(m),B=j.length,q,G,Y,X=[],re=[],F,$,se,H,ne=new ge,ce=new ge,ie=new ge;for(i=0,n=l.length;i<n;i++)w=l[i],q=Number(O4(w.a,w.b,f).newEdge)+B,G=Number(O4(w.b,w.c,f).newEdge)+B,Y=Number(O4(w.c,w.a,f).newEdge)+B,BA(X,q,G,Y,w.materialIndex),BA(X,w.a,q,Y,w.materialIndex),BA(X,w.b,G,q,w.materialIndex),BA(X,w.c,Y,G,w.materialIndex),u&&(F=c[i],$=F[0],se=F[1],H=F[2],ne.set(kv($.x,se.x),kv($.y,se.y)),ce.set(kv(se.x,H.x),kv(se.y,H.y)),ie.set(kv($.x,H.x),kv($.y,H.y)),FA(re,ne,ce,ie),FA(re,$,ne,ie),FA(re,se,ce,ne),FA(re,H,ie,ce));e.vertices=L,e.faces=X,u&&(e.faceVertexUvs[0]=re)}},xs=new V,O5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=e.geometry??t?.geometry??new Lt().copy(new Fc(100,100,100)),i;t===void 0?(r.computeBoundingBox(),r.boundingBox.getSize(xs),i={width:xs.x,height:xs.y,depth:xs.z,subdivisions:0}):i=t.parameters;let n={...i,...e.parameters};return{parameters:{width:Math.abs(n.width),height:Math.abs(n.height),depth:Math.abs(n.depth),subdivisions:Math.abs(n.subdivisions)},geometry:r}}static build(e){let{width:t,height:r,depth:i,subdivisions:n}=e.parameters,s=e.geometry??new Lt().copy(new Fc(100,100,100)),a=s.userData.parameters;a===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(xs)):xs.set(a.width,a.height,a.depth),(t!==xs.x||r!==xs.y||i!==xs.z)&&s.scale(xs.x===0?1:t/xs.x,xs.y===0?1:r/xs.y,xs.z===0?1:i/xs.z);let o=s.originalGeometry;try{n>0?(o===void 0||a?.subdivisions!==n)&&(o===void 0&&(o=s),s=new I5e(n).modify(o).toBufferGeometry()):(o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return o!==void 0&&Object.assign(s,{originalGeometry:o}),delete e.geometry,Object.assign(s,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,r){new Uie(r).load(e,i=>{let n=this.normalizeInputs({geometry:i});i.boundingBox.getSize(xs);let s=100/xs.x;Object.assign(n.parameters,{width:100,height:xs.y*s,depth:xs.z*s}),t(this.build(n))})}},Yse=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof Pn?e.shape:new Pn,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,spikes:i,cornerRadius:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,c=t*.5,u=r*.5,d=0,f=0,m=2*Math.PI/i;for(let y=0;y<i;y++){let x=m*y,w=d+Math.sin(x)*c,_=f+Math.cos(x)*u;l.addPoint(l.createPoint(w,_))}l.isClosed=!0;for(let y=0,x=l.points.length;y<x;y++)l.points[y].roundness=n;l.roundness=n,l.update();let v=g0.create({shape:l,parameters:{roundness:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(v,{userData:{...e,type:"PolygonGeometry"}})}},j5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=new z5e(t*.5,r,n,s,a,o,l);return c.scale(1,1,i/t),Object.assign(c,{userData:{...e,type:"PyramidGeometry"}})}};function W1(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function L4(e,t,r,i,n,s){let a=t.clone().sub(e),o=r.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),i===n){let c=a.add(o).normalize();s.copy(e).addScaledVector(c,i/Math.sin(l/2))}else{let c=a.angleTo(o);s.copy(e),s.addScaledVector(a,n/Math.sin(c)),s.addScaledVector(o,i/Math.sin(c))}}function L5e(e,t,r){let i=e.clone().sub(t),n=r.clone().sub(t);return i.projectOnVector(n),i.add(t)}var z5e=class extends Lt{constructor(e=.5,t=1,r=4,i=1,n=!1,s=0,a=4){super(),r=Math.floor(Math.max(3,r)),i=Math.floor(i),a=Math.floor(a);let o=[],l=[],c=[],u=[],d=0,f=t/2,m=Math.PI/r,v=e*Math.cos(Math.PI/r),y=2*Math.PI/r,x=(r-2)*Math.PI/r,w=Math.PI-x,_=new V(0,-f,0),S=new V(0,f,0),P=new ge(e,-f),M=new ge(v,-f),C=new ge(0,S.y).sub(M),T=new ge(0,S.y).sub(P),E=new ge(C.y,-C.x).normalize(),N=new ge(T.y,-T.x).normalize(),D=e*Math.cos(Math.PI/r)*Math.tan((Math.PI-C.angle())/2)-1e-8;s=Math.min(s,D);let I;{let Y=new V(E.x,E.y,0),X=new V(Math.cos(y)*Y.x,Y.y,Math.sin(y)*Y.x);I=Y.angleTo(X)}let j=s/Math.tan((Math.PI-C.angle())/2),L=s/Math.tan((Math.PI-I)/2),B=new V;if(!n){l.push(_.x,_.y,_.z),c.push(0,-1,0),u.push(0,0);let Y=d++,X=[],re=P.clone(),F=j/Math.cos(Math.PI/r);re.x-=F;for(let $=0;$<r;$++){let se=$/r*Math.PI*2+m,H=new ge(Math.sin(se),Math.cos(se));W1(re,H,B),l.push(B.x,B.y,B.z),c.push(0,-1,0),u.push(0,0),X.push(d++)}for(let $=0;$<X.length;$++)o.push(X[$],Y,X[($+1)%X.length])}{let Y=new V,X=new V,re=new V,F=new V,$=new V,se=new V;for(let H=0;H<r;H++){let ne=H/r*Math.PI*2+m,ce=(H+.5)/r*Math.PI*2+m,ie=(H+1)/r*Math.PI*2+m,ae=new ge(Math.sin(ne),Math.cos(ne)),Z=new ge(Math.sin(ce),Math.cos(ce)),fe=new ge(Math.sin(ie),Math.cos(ie));W1(P,ae,X),W1(P,fe,re),W1(E,Z,Y),L4(S,X,re,L,L,F),l.push(F.x,F.y,F.z),L4(X,S,re,L,j,$),l.push($.x,$.y,$.z),L4(re,X,S,j,L,se),l.push(se.x,se.y,se.z),c.push(Y.x,Y.y,Y.z),c.push(Y.x,Y.y,Y.z),c.push(Y.x,Y.y,Y.z),u.push(0,0),u.push(0,0),u.push(0,0);let he=d++,Ae=d++,xe=d++;if(o.push(he,Ae,xe),s>0){{let $e=X.clone().add(re).multiplyScalar(.5),mt=S.clone().sub($e).normalize(),dt=_.clone().sub($e).normalize().add(mt).normalize().multiplyScalar(-1),ct=se.clone().sub($);q($e,ct,dt,C.angle())}let Ee,Be;{let $e=new V;W1(N,fe,$e);let mt=se.clone().add(F).multiplyScalar(.5);mt=L5e(mt,re,S);let dt=se.clone().sub(F);[Ee,Be]=q(mt,dt,$e,I,F.y)}{let $e=Ee,mt=$e.clone().setY(0).normalize(),dt=new V(0,-1,0),ct=mt.clone().cross(dt);G($e,mt,dt,ct)}{let $e=C.angle(),mt=Math.PI-$e,dt=S.clone();dt.y-=s/Math.sin($e-Math.PI/2);let ct=new V,ut=[];for(let _e=0;_e<a;_e++){let te=[],J=Math.PI/2-mt*_e/a,ve=Math.cos(J),Me=Math.sin(J),W=ce;for(let Se=0;Se<=_e;Se++){let ze=Math.cos(W),Ue=Math.sin(W);Y.x=ve*Ue,Y.y=Me,Y.z=ve*ze,ct.copy(dt).addScaledVector(Y,s),l.push(ct.x,ct.y,ct.z),c.push(Y.x,Y.y,Y.z),u.push(0,0),te.push(d++),W+=Math.PI*2/_e/r}ut.push(te)}Be.reverse(),ut.push(Be);let me=ut.length-1;for(let _e=0;_e<me;_e++){let te=ut[_e],J=ut[_e+1],ve=te.length-1;o.push(J[1],te[0],J[0]);for(let Me=1;Me<=ve;Me++)o.push(te[Me],te[Me-1],J[Me]),o.push(J[Me+1],te[Me],J[Me])}}}}}this.setIndex(o),this.setAttribute("position",new At(l,3)),this.setAttribute("normal",new At(c,3)),this.setAttribute("uv",new At(u,2));function q(Y,X,re,F,$){let se=-F/2,H=(Math.PI-F)/2,ne=X.clone().normalize().cross(re);Y.addScaledVector(re,-s/Math.sin(H));let ce=new V,ie=new V,ae=1,Z=d,fe=[];for(let he=0;he<=a;he++){let Ae=se+he/a*F;ie.set(0,0,0),ie.addScaledVector(ne,Math.sin(Ae)),ie.addScaledVector(re,Math.cos(Ae));for(let xe=0;xe<=ae;xe++){let Ee=xe/ae-.5;if(ce.copy(Y),ce.addScaledVector(X,Ee),ce.addScaledVector(ie,s),$!=null){let Be=Math.max(0,ce.y-$);ce.addScaledVector(X,-Be/X.y)}l.push(ce.x,ce.y,ce.z),c.push(ie.x,ie.y,ie.z),u.push(0,0),xe===0&&fe.push(d),d++}}for(let he=0;he<a;he++)for(let Ae=0;Ae<ae;Ae++){let xe=Z+Ae+(ae+1)*he,Ee=xe+(ae+1),Be=Ee+1,$e=xe+1;o.push(xe,Ee,$e),o.push(Ee,Be,$e)}return[Y.clone().addScaledVector(X,.5),fe]}function G(Y,X,re,F){let $=Math.PI/2,se=T.angle()-$,H=[],ne=new V,ce=new V;for(let ae=0;ae<=a;ae++){let Z=[],fe=ae/a;for(let he=0;he<=ae;he++){let Ae=((ae?he/ae:0)-.5)*w,xe=Math.cos(Ae),Ee=Math.sin(Ae),Be=Math.atan(Math.tan(se)*xe),$e=($+Be)*fe,mt=Math.cos($e),dt=Math.sin($e);ne.set(0,0,0),ne.addScaledVector(X,dt*xe),ne.addScaledVector(re,mt),ne.addScaledVector(F,dt*Ee),ce.copy(Y).addScaledVector(ne,s),l.push(ce.x,ce.y,ce.z),c.push(ne.x,ne.y,ne.z),u.push(0,0),Z.push(d++)}H.push(Z)}let ie=H.length-1;for(let ae=0;ae<ie;ae++){let Z=H[ae],fe=H[ae+1],he=Z.length-1;o.push(Z[0],fe[1],fe[0]);for(let Ae=1;Ae<=he;Ae++)o.push(Z[Ae-1],Z[Ae],fe[Ae]),o.push(Z[Ae],fe[Ae+1],fe[Ae])}}}},jB=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),i=Object.assign(t?.ui??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof Pn?e.shape:new Pn,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)}),ui:i}}static build(e){let t=e.shape,{width:r,height:i,cornerRadius:n,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c={x:r*.5,y:i*.5},u={x:-c.x,y:-c.y},d={x:c.x,y:c.y};function f(P,M,C){return M>r&&C>i?Math.min(P*r/M,P*i/C):M>r?P*r/M:C>i?P*i/C:P}let m=[];m[0]=n[0]===0?0:f(n[0],n[0]+n[3],n[0]+n[1]),m[1]=n[1]===0?0:f(n[1],n[1]+n[2],n[1]+n[0]),m[2]=n[2]===0?0:f(n[2],n[2]+n[1],n[2]+n[3]),m[3]=n[3]===0?0:f(n[3],n[3]+n[0],n[3]+n[2]);let v=u.x,y=d.x,x=d.y,w=u.y;t.addPoint(t.createPoint(v,x)),t.addPoint(t.createPoint(y,x)),t.addPoint(t.createPoint(y,w)),t.addPoint(t.createPoint(v,w)),t.isClosed=!0;let _=!0;for(let P=0,M=t.points.length;P<M;P++)t.points[P].roundness=m[P],P>0&&m[P]!==m[P-1]&&(_=!1);_&&(t.roundness=m[0]),t.useCubicForRoundedCorners=s!==1,t.update();let S=g0.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(S,{userData:{...e,type:"RectangleGeometry"}})}},B5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},e.parameters);return r.thetaLength=Ct.clamp(r.thetaLength,0,180),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t=100,height:r=t,depth:i=t,widthSegments:n=64,heightSegments:s=64,phiStart:a,phiLength:o,thetaStart:l,thetaLength:c}=e.parameters,u;return c===0?(u=new Lt,u.setAttribute("position",new At([],3))):u=new ky(.5*t,n,s,a,o,l,c*Ct.DEG2RAD),u.scale(1,r/t,i/t),Object.assign(u,{userData:{...e,type:"SphereGeometry"}})}},F5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:0})}}static build(e){let{width:t=100,height:r=t,widthSegments:i=8,heightSegments:n=8}=e.parameters,s=new ed(t,r,i,n);return s.scale(1,1,1),Object.assign(s,{userData:{...e,type:"PlaneGeometry"}})}},V5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width)})}}static build(e){let{width:t,height:r,depth:i,angle:n,cornerRadius:s,cornerSegments:a}=e.parameters,o=new U5e(t,r,i,n,s,a);return Object.assign(o,{userData:{...e,type:"BackdropGeometry"}})}},U5e=class extends Lt{constructor(e=1,t=1,r=1,i=90,n=10,s=24){super(),this.type="BackdropGeometry";let a=[],o=[],l=[],c=.001;n==0&&(s=1),s=Math.max(1,Math.floor(s)),n=Math.min(n,100),i=Math.min(180-c,i),i*=Math.PI/180;let u=[],d=Math.PI/2,f=(ae=0,Z=0,fe=0)=>new V(ae,Z,fe),m=f(),v=f(),[y,x,w]=[t/2,e/2,r/2],_=-x,S=+x,[P,M,C]=[f(_,-y,+w),f(_,-y,-w),f(_,+y,-w)],T=(ae,Z=!1)=>Math.sin(ae-Math.PI/(1+ +Z)),E=(ae,Z=!1)=>Math.cos(ae-Math.PI/(1+ +Z));C.y=Math.sin(i)*t-y;let N=Math.cos(i)*t-w,D=P.z-c;i<=d?(C.z=Math.min(N,D),C.z==D&&(C.y-=(N-D)/Math.tan(d-i))):M.z=Math.min(M.z-N-w,P.z-c),m.subVectors(P,M),v.subVectors(C,M);let I=Math.min(m.length(),v.length())*n/100,j=I*Math.tan(i/2),L=I/Math.cos(i/2),B=m.clone().normalize().add(v.normalize()).setLength(L).add(M);m.set(0,T(i,!0),E(i,!0)),u.push([C,m.clone()]);let q=(Math.PI-i)/s;for(let ae=0;ae<=s;ae++){let Z=d+i+ae*q;m.set(0,Math.sin(Z)*j,Math.cos(Z)*j),m.add(B),v.set(0,T(Z),E(Z)),u.push([m.clone(),v.clone()])}u.push([P,f(0,1,0)]);let G=Math.sin(q/2)*j*2,Y=u.length-1,X=u[0][0].distanceTo(u[1][0]),re=u[Y-1][0].distanceTo(u[Y][0]),F=X+G*s+re;u[0].push(1);for(let ae=0;ae<=s;ae++)u[ae+1].push(1-(X+ae*G)/F);u[Y].push(0);let[$,se,H]=u[0],ne,ce,ie;for(let ae=1;ae<u.length;ae++)[ne,ce,ie]=u[ae],a.push(_,$.y,$.z,_,ne.y,ne.z,S,$.y,$.z,S,$.y,$.z,_,ne.y,ne.z,S,ne.y,ne.z),o.push(0,se.y,se.z,0,ce.y,ce.z,0,se.y,se.z,0,se.y,se.z,0,ce.y,ce.z,0,ce.y,ce.z),l.push(0,H,0,ie,1,H,1,H,0,ie,1,ie),[$,se,H]=[ne,ce,ie];this.setAttribute("position",new At(a,3)),this.setAttribute("normal",new At(o,3)),this.setAttribute("uv",new At(l,2))}},Xse=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof Pn?e.shape:new Pn,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r,innerRadiusPercent:i,spikes:n,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,u=e.shape,d=t*.5,f=r*.5,m=0,v=0,y=a*Math.PI/360/n,x=Math.PI/2*3*-1,w=d*i/100,_=f*i/100;if(n===3&&i===50){y=2*Math.PI/n;for(let P=0;P<n;P++){let M=y*P,C=m+Math.sin(M)*d,T=v+Math.cos(M)*f;u.addPoint(u.createPoint(C,T))}}else for(let P=0;P<n;P++){let M=m+Math.cos(x)*d,C=v+Math.sin(x)*f;u.addPoint(u.createPoint(M,C)),x+=y,M=m+Math.cos(x)*w,C=v+Math.sin(x)*_,u.addPoint(u.createPoint(M,C)),x+=y}u.isClosed=!0;for(let P=0,M=u.points.length;P<M;P++)u.points[P].roundness=s;u.roundness=s,u.update();let S=g0.create({shape:u,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(S,{userData:{...e,type:"StarGeometry"}})}},H5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,depth:0},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t,height:r}=e.parameters,i=new ed(t,r);return Object.assign(i,{userData:{...e,type:"TextFrameGeometry"}})}},G5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width);r.shapeBlendNode&&(n=i);let s=Math.round(Math.abs(r.depth??r.width*.25));return{parameters:Object.assign(r,{width:i,height:n,depth:s})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=W5e(t,r,i,t*.5,a,s,0,0,n,o,l);return c.scale(1,r/t,1),Object.assign(c,{userData:{...e,type:"TorusGeometry"}})}};function W5e(e,t,r,i,n,s,a,o,l,c,u){[t,r]=[r,t],a=t/2;let d=Ct.clamp(n/360,0,1);if(d===0){let f=new Lt;return f.setAttribute("position",new At([],3)),f}return d===1&&(c=0),new Wse(!0,e,t,r,i,d,s,a,o,l,c,u)}var q5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width),depth:Math.abs(r.depth??r.width),tube:r.tube??r.width*.125})}}static build(e){let{width:t,tube:r,tubularSegments:i,radialSegments:n,p:s,q:a}=e.parameters,o=t*.5;o!==r&&(o-=r);let l=new Oie(o,r,i,n,s,a);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},Y5e=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof Pn?e.shape:new Pn,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs(r.height??r.width*(r.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(r.depth??0)})}}static build(e){let{width:t=100,height:r,cornerRadius:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,c=t*.5,u=r*.5;o?(l.addPoint(l.createPoint(-c,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))):(l.addPoint(l.createPoint(0,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))),l.isClosed=!0;for(let f=0,m=l.points.length;f<m;f++)l.points[f].roundness=i;l.roundness=i,l.update();let d=g0.create({shape:l,parameters:{roundness:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(d,{userData:{...e,type:"TriangleGeometry"}})}};function X5e(e,t){let r=2*Math.PI;return(e%r+r)%r===(t%r+r)%r}function $5e(e){return/^(rgba)?\(\s*(\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e.toLowerCase())}function K5e(e,t,r){let i,n,s,a=Math.floor(e*6),o=e*6-a,l=r*(1-t),c=r*(1-o*t),u=r*(1-(1-o)*t);switch(a%6){case 0:i=r,n=u,s=l;break;case 1:i=c,n=r,s=l;break;case 2:i=l,n=r,s=u;break;case 3:i=l,n=c,s=r;break;case 4:i=u,n=l,s=r;break;case 5:default:i=r,n=l,s=c;break}return{r:i*255,g:n*255,b:s*255}}function Q5e(e,t,r){e/=255,t/=255,r/=255;let i=Math.max(e,t,r),n=Math.min(e,t,r),s=i,a=i-n,o=i==0?0:a/i,l;if(i==n)l=0;else{switch(i){case e:l=(t-r)/a+(t<r?6:0);break;case t:l=(r-e)/a+2;break;case r:default:l=(e-t)/a+4;break}l/=6}return{h:l,s:o,v:s}}function Z5e(e){return e=Math.floor(e),{r:e>>16&255,g:e>>8&255,b:e&255}}function J5e(e,t,r){return(e<<16)+(t<<8)+r}function eze(e,t,r){return e=Math.round(e),t=Math.round(t),r=Math.round(r),"#"+[e,t,r].map(i=>i.toString(16).padStart(2,"0")).join("").toUpperCase()}function tze(e){let t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(i,n,s,a)=>String(n+n+s+s+a+a));let r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}:null}var rze={parseRgba:$5e,hsvToRgb:K5e,rgbToHsv:Q5e,hexToRgb:Z5e,rgbToHex:J5e,rgbToHexString:eze,hexStringToRgb:tze},ize=class{add(e,t,r){if(typeof arguments[0]!="string")for(let i in arguments[0])this.add(i,arguments[0][i],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(i){this[i]=this[i]||[],t&&this[i][r?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(r){r.call(t&&t.context?t.context:t,t)})}},nze=class{constructor(e){this.jsep=e,this.registered={}}register(...e){e.forEach(t=>{if(typeof t!="object"||!t.name||!t.init)throw new Error("Invalid JSEP plugin format");this.registered[t.name]||(t.init(this.jsep),this.registered[t.name]=t)})}},Ze=class{static get version(){return"1.3.8"}static toString(){return"JavaScript Expression Parser (JSEP) v"+Ze.version}static addUnaryOp(t){return Ze.max_unop_len=Math.max(t.length,Ze.max_unop_len),Ze.unary_ops[t]=1,Ze}static addBinaryOp(t,r,i){return Ze.max_binop_len=Math.max(t.length,Ze.max_binop_len),Ze.binary_ops[t]=r,i?Ze.right_associative.add(t):Ze.right_associative.delete(t),Ze}static addIdentifierChar(t){return Ze.additional_identifier_chars.add(t),Ze}static addLiteral(t,r){return Ze.literals[t]=r,Ze}static removeUnaryOp(t){return delete Ze.unary_ops[t],t.length===Ze.max_unop_len&&(Ze.max_unop_len=Ze.getMaxKeyLen(Ze.unary_ops)),Ze}static removeAllUnaryOps(){return Ze.unary_ops={},Ze.max_unop_len=0,Ze}static removeIdentifierChar(t){return Ze.additional_identifier_chars.delete(t),Ze}static removeBinaryOp(t){return delete Ze.binary_ops[t],t.length===Ze.max_binop_len&&(Ze.max_binop_len=Ze.getMaxKeyLen(Ze.binary_ops)),Ze.right_associative.delete(t),Ze}static removeAllBinaryOps(){return Ze.binary_ops={},Ze.max_binop_len=0,Ze}static removeLiteral(t){return delete Ze.literals[t],Ze}static removeAllLiterals(){return Ze.literals={},Ze}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(t){this.expr=t,this.index=0}static parse(t){return new Ze(t).parse()}static getMaxKeyLen(t){return Math.max(0,...Object.keys(t).map(r=>r.length))}static isDecimalDigit(t){return t>=48&&t<=57}static binaryPrecedence(t){return Ze.binary_ops[t]||0}static isIdentifierStart(t){return t>=65&&t<=90||t>=97&&t<=122||t>=128&&!Ze.binary_ops[String.fromCharCode(t)]||Ze.additional_identifier_chars.has(String.fromCharCode(t))}static isIdentifierPart(t){return Ze.isIdentifierStart(t)||Ze.isDecimalDigit(t)}throwError(t){let r=new Error(t+" at character "+this.index);throw r.index=this.index,r.description=t,r}runHook(t,r){if(Ze.hooks[t]){let i={context:this,node:r};return Ze.hooks.run(t,i),i.node}return r}searchHook(t){if(Ze.hooks[t]){let r={context:this};return Ze.hooks[t].find(function(i){return i.call(r.context,r),r.node}),r.node}}gobbleSpaces(){let t=this.code;for(;t===Ze.SPACE_CODE||t===Ze.TAB_CODE||t===Ze.LF_CODE||t===Ze.CR_CODE;)t=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");let t=this.gobbleExpressions(),r=t.length===1?t[0]:{type:Ze.COMPOUND,body:t};return this.runHook("after-all",r)}gobbleExpressions(t){let r=[],i,n;for(;this.index<this.expr.length;)if(i=this.code,i===Ze.SEMCOL_CODE||i===Ze.COMMA_CODE)this.index++;else if(n=this.gobbleExpression())r.push(n);else if(this.index<this.expr.length){if(i===t)break;this.throwError('Unexpected "'+this.char+'"')}return r}gobbleExpression(){let t=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",t)}gobbleBinaryOp(){this.gobbleSpaces();let t=this.expr.substr(this.index,Ze.max_binop_len),r=t.length;for(;r>0;){if(Ze.binary_ops.hasOwnProperty(t)&&(!Ze.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!Ze.isIdentifierPart(this.expr.charCodeAt(this.index+t.length))))return this.index+=r,t;t=t.substr(0,--r)}return!1}gobbleBinaryExpression(){let t,r,i,n,s,a,o,l,c;if(a=this.gobbleToken(),!a||(r=this.gobbleBinaryOp(),!r))return a;for(s={value:r,prec:Ze.binaryPrecedence(r),right_a:Ze.right_associative.has(r)},o=this.gobbleToken(),o||this.throwError("Expected expression after "+r),n=[a,s,o];r=this.gobbleBinaryOp();){if(i=Ze.binaryPrecedence(r),i===0){this.index-=r.length;break}s={value:r,prec:i,right_a:Ze.right_associative.has(r)},c=r;let u=d=>s.right_a&&d.right_a?i>d.prec:i<=d.prec;for(;n.length>2&&u(n[n.length-2]);)o=n.pop(),r=n.pop().value,a=n.pop(),t={type:Ze.BINARY_EXP,operator:r,left:a,right:o},n.push(t);t=this.gobbleToken(),t||this.throwError("Expected expression after "+c),n.push(s,t)}for(l=n.length-1,t=n[l];l>1;)t={type:Ze.BINARY_EXP,operator:n[l-1].value,left:n[l-2],right:t},l-=2;return t}gobbleToken(){let t,r,i,n;if(this.gobbleSpaces(),n=this.searchHook("gobble-token"),n)return this.runHook("after-token",n);if(t=this.code,Ze.isDecimalDigit(t)||t===Ze.PERIOD_CODE)return this.gobbleNumericLiteral();if(t===Ze.SQUOTE_CODE||t===Ze.DQUOTE_CODE)n=this.gobbleStringLiteral();else if(t===Ze.OBRACK_CODE)n=this.gobbleArray();else{for(r=this.expr.substr(this.index,Ze.max_unop_len),i=r.length;i>0;){if(Ze.unary_ops.hasOwnProperty(r)&&(!Ze.isIdentifierStart(this.code)||this.index+r.length<this.expr.length&&!Ze.isIdentifierPart(this.expr.charCodeAt(this.index+r.length)))){this.index+=i;let s=this.gobbleToken();return s||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:Ze.UNARY_EXP,operator:r,argument:s,prefix:!0})}r=r.substr(0,--i)}Ze.isIdentifierStart(t)?(n=this.gobbleIdentifier(),Ze.literals.hasOwnProperty(n.name)?n={type:Ze.LITERAL,value:Ze.literals[n.name],raw:n.name}:n.name===Ze.this_str&&(n={type:Ze.THIS_EXP})):t===Ze.OPAREN_CODE&&(n=this.gobbleGroup())}return n?(n=this.gobbleTokenProperty(n),this.runHook("after-token",n)):this.runHook("after-token",!1)}gobbleTokenProperty(t){this.gobbleSpaces();let r=this.code;for(;r===Ze.PERIOD_CODE||r===Ze.OBRACK_CODE||r===Ze.OPAREN_CODE||r===Ze.QUMARK_CODE;){let i;if(r===Ze.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==Ze.PERIOD_CODE)break;i=!0,this.index+=2,this.gobbleSpaces(),r=this.code}this.index++,r===Ze.OBRACK_CODE?(t={type:Ze.MEMBER_EXP,computed:!0,object:t,property:this.gobbleExpression()},this.gobbleSpaces(),r=this.code,r!==Ze.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):r===Ze.OPAREN_CODE?t={type:Ze.CALL_EXP,arguments:this.gobbleArguments(Ze.CPAREN_CODE),callee:t}:(r===Ze.PERIOD_CODE||i)&&(i&&this.index--,this.gobbleSpaces(),t={type:Ze.MEMBER_EXP,computed:!1,object:t,property:this.gobbleIdentifier()}),i&&(t.optional=!0),this.gobbleSpaces(),r=this.code}return t}gobbleNumericLiteral(){let t="",r,i;for(;Ze.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(this.code===Ze.PERIOD_CODE)for(t+=this.expr.charAt(this.index++);Ze.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(r=this.char,r==="e"||r==="E"){for(t+=this.expr.charAt(this.index++),r=this.char,(r==="+"||r==="-")&&(t+=this.expr.charAt(this.index++));Ze.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);Ze.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+t+this.char+")")}return i=this.code,Ze.isIdentifierStart(i)?this.throwError("Variable names cannot start with a number ("+t+this.char+")"):(i===Ze.PERIOD_CODE||t.length===1&&t.charCodeAt(0)===Ze.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:Ze.LITERAL,value:parseFloat(t),raw:t}}gobbleStringLiteral(){let t="",r=this.index,i=this.expr.charAt(this.index++),n=!1;for(;this.index<this.expr.length;){let s=this.expr.charAt(this.index++);if(s===i){n=!0;break}else if(s==="\\")switch(s=this.expr.charAt(this.index++),s){case"n":t+=`
`;break;case"r":t+="\r";break;case"t":t+="	";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:t+=s}else t+=s}return n||this.throwError('Unclosed quote after "'+t+'"'),{type:Ze.LITERAL,value:t,raw:this.expr.substring(r,this.index)}}gobbleIdentifier(){let t=this.code,r=this.index;for(Ze.isIdentifierStart(t)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(t=this.code,Ze.isIdentifierPart(t));)this.index++;return{type:Ze.IDENTIFIER,name:this.expr.slice(r,this.index)}}gobbleArguments(t){let r=[],i=!1,n=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let s=this.code;if(s===t){i=!0,this.index++,t===Ze.CPAREN_CODE&&n&&n>=r.length&&this.throwError("Unexpected token "+String.fromCharCode(t));break}else if(s===Ze.COMMA_CODE){if(this.index++,n++,n!==r.length){if(t===Ze.CPAREN_CODE)this.throwError("Unexpected token ,");else if(t===Ze.CBRACK_CODE)for(let a=r.length;a<n;a++)r.push(null)}}else if(r.length!==n&&n!==0)this.throwError("Expected comma");else{let a=this.gobbleExpression();(!a||a.type===Ze.COMPOUND)&&this.throwError("Expected comma"),r.push(a)}}return i||this.throwError("Expected "+String.fromCharCode(t)),r}gobbleGroup(){this.index++;let t=this.gobbleExpressions(Ze.CPAREN_CODE);if(this.code===Ze.CPAREN_CODE)return this.index++,t.length===1?t[0]:t.length?{type:Ze.SEQUENCE_EXP,expressions:t}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:Ze.ARRAY_EXP,elements:this.gobbleArguments(Ze.CBRACK_CODE)}}},sze=new ize;Object.assign(Ze,{hooks:sze,plugins:new nze(Ze),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},right_associative:new Set,additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});Ze.max_unop_len=Ze.getMaxKeyLen(Ze.unary_ops);Ze.max_binop_len=Ze.getMaxKeyLen(Ze.binary_ops);var vx=e=>new Ze(e).parse(),aze=Object.getOwnPropertyNames(Ze);aze.forEach(e=>{vx[e]===void 0&&e!=="prototype"&&(vx[e]=Ze[e])});vx.Jsep=Ze;var oze="ConditionalExpression",lze={name:"ternary",init(e){e.hooks.add("after-expression",function(t){if(t.node&&this.code===e.QUMARK_CODE){this.index++;let r=t.node,i=this.gobbleExpression();if(i||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;let n=this.gobbleExpression();if(n||this.throwError("Expected expression"),t.node={type:oze,test:r,consequent:i,alternate:n},r.operator&&e.binary_ops[r.operator]<=.9){let s=r;for(;s.right.operator&&e.binary_ops[s.right.operator]<=.9;)s=s.right;t.node.test=s.right,s.right=t.node,t.node=r}}else this.throwError("Expected :")}})}};vx.plugins.register(lze);function q3(e){return{all:e=e||new Map,on:function(t,r){var i=e.get(t);i?i.push(r):e.set(t,[r])},off:function(t,r){var i=e.get(t);i&&(r?i.splice(i.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var i=e.get(t);i&&i.slice().map(function(n){n(r)}),(i=e.get("*"))&&i.slice().map(function(n){n(t,r)})}}}var $se=class{constructor(e,t,r){this.id=e,this.userAPI=t,this.result=void 0,this.error="null",this.isPrefetched=!1,this.isLoading=!1,this.isLoaded=!1,this.prefetchPromise=new Promise(i=>i()),this.emitter=q3(),this._innerCallUserAPI=async i=>{this.emitter.emit("start",{userAPIId:this.id}),this.isLoading=!0,this.isLoading=!1;try{this.result=await fze(this.userAPI,i),this.error="null",this.emitter.emit("success",{userAPIId:this.id})}catch(n){let s=n.message?.split("_:_")?.[0]?.replace("status:","")??"null";this.error=s,this.result=null,this.emitter.emit("error",{userAPIId:this.id})}this.isLoading=!1,this.isPrefetched=!0,this.isLoaded=!0},t?.integration?.type==="OpenAI"?this.result={content:""}:t.method==="GET"&&t.url!==""&&(this.prefetchPromise=this.prefetch(r)),this._debouncedCallUserAPI=this._innerCallUserAPI,this._updateDebouncedCallUserAPI(),this._debouncedPrefetch=j2(this.prefetch,1e3,{trailing:!0})}_updateDebouncedCallUserAPI(){this._debouncedCallUserAPI=this.userAPI.debounce!==void 0&&this.userAPI.debounce>0?j2(this._innerCallUserAPI,this.userAPI.debounce,{leading:!0,trailing:!0}):this._innerCallUserAPI}async prefetch(e){await this.callUserAPI(e)}async callUserAPI(e){await this._debouncedCallUserAPI(e)}update(e,t,r=!0){this.userAPI=e,this._updateDebouncedCallUserAPI(),this.userAPI.url!==""&&this.userAPI.method==="GET"&&r&&this._debouncedPrefetch(t)}retrieveValue(e){if(this.result)try{return As.zoom(this.result,e)}catch(t){console.error(t)}}retrieveZoomedKeyValues(e){if(this.result){let t=e&&e.length?As.zoom(this.result,e):this.result;if(hze(t))return Object.entries(t);if(dze(t))return t.map((r,i)=>[i.toString(),r]);throw uze(t)?new Error("This path points to a value, use retrieveValue() instead. "+e?.join(".")):new Error("Path error"+e?.join("."))}}dispose(){}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}get autostart(){return this.userAPI.autoStart}};function cze(e){let t=new Headers;return e.headers.forEach(r=>{r.data.key!==""&&t.append(r.data.key,r.data.value)}),t}function uze(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||e===null}function dze(e){return Array.isArray(e)}function hze(e){return typeof e=="object"&&e!==null}async function fze(e,t,r=new AbortController){let i,n=e.url,s=e.proxy?.enabled??!1,a;if(e.integration?.type==="OpenAI"){let l=_w(e.integration.prompt===""?[]:JSON.parse(e.integration.prompt),t),c=e.integration.behavior===""?[]:_w(JSON.parse(e.integration.behavior),t);a=`{
		"model": "${e.integration.model}",
		"messages": [${e.integration.useBehavior?`
		{
			"role": "system",
			"content": "${c}"
		},`:""}
		{
			"role": "user",
			"content": "${l}"
		}
		]
	}`}if(s){n=`https://apis.spline.design/file/${e.proxy.fileId}/external-api/request?uuidexternalapi=${e.proxy.proxyId}`;let l;a!==void 0?l=a:e.method==="POST"&&e.body&&(l=_w(JSON.parse(e.body),t)),l!==void 0&&(n+=`&data=${encodeURIComponent(l.replace(/(\r\n|\n|\r|\t)/gm,""))}`)}else e.integration?.type==="OpenAI"?i=a:e.method==="POST"&&e.body&&(i=_w(JSON.parse(e.body),t));let o=await fetch(n,{method:s?"GET":e.method,headers:s?void 0:cze(e),signal:r.signal,body:i});if(!o.ok)throw new Error("status:"+o.status+"_:_"+o.statusText);if(e.integration?.type==="OpenAI"){let l=await o.json();return s&&(l=l.response),{content:l.choices[0].message.content}}else{let l=await o.json();return s&&(l=l.response),l}}var Kse=(e,t)=>{if(typeof e=="string"){let r=t.getVariable(e);if(r)return Kse(r,t)}return ga.isBoolean(e)?ga.getDisplayedValue(e).toLowerCase():ga.getDisplayedValue(e)},_w=(e,t)=>e.map((r,i)=>{if("text"in r)return r.text;if("type"in r){if(r.type==="paragraph")return(i>0?`
`:"")+_w(r.children,t);if(r.type==="variable"){let n=t.getVariable(r.variableId);if(n!==void 0)return Kse(n,t)}}return""}).join(""),pze=["+","-","*","/","(",")","==","!=",">","<",">=","<=","and","or","!","%","^",","],mze=["0","1","2","3","4","5","6","7","8","9","."],gze=["sin","cos","tan","asin","acos","atan","atan2","sqrt","abs","log","exp","floor","ceil","round","min","max","random"];function vze(e){return typeof e!="string"?!1:!isNaN(e)&&!isNaN(parseFloat(e))}vx.addBinaryOp("^",11,!0);function Qse(e,t,r="number"){let i="";for(let a=0;a<e.length;a++){let o=e[a];if("objType"in o&&o.objType==="api"){let l=JSON.parse(o.id),c=l[0],u=t.getUserAPI(c);if(u!==void 0&&u instanceof $se){let d=u.retrieveValue(l.slice(1));d!==void 0&&(i+=d)}continue}if("objType"in o&&o.objType==="webhook"){let l=JSON.parse(o.id),[c,u]=l,d=t.getUserWebhook(c);if(d!==void 0){let f=d.getParameterValue(u);f!==void 0&&(i+=f)}continue}if("objType"in o&&o.objType==="aiAssistant"){let l=t.openAIRealtime;if("objId"in o&&o.objId!==void 0){let c;if(t.scene.data.objects.traverse((u,d)=>{let f=d.events?.find(m=>m.id===o.objId);f&&(c=f)}),c!==void 0&&c.data.type==="AIAssistantListener"){let u=l?.computeAnalysisForListenerEvent(c.data);if(u!==void 0){i+=u;continue}}}i+=l?.voice??0;continue}if("id"in o){let l=e[a-1];if(a>0&&"id"in l){console.error("Two variables in a row",e);return}let c=t.getVariable(o.id),u=ga.getDisplayedValue(c);r==="number"&&ga.isTextValue(c)&&Array.isArray(c.textValue)&&c.textValue.length===1?u=parseFloat(u).toString():r==="boolean"&&ga.isBoolean(c)?u=c?"true":"false":r==="boolean"&&ga.isTextValue(c)&&!Array.isArray(c.textValue)&&(u='"'+u+'"'),i+=u;continue}else if(r==="string"){o.name!=='"'&&(o.name!=="+"||o.escaped)&&(i+=o.name),o.name==="+"&&!o.escaped&&i[i.length-1]==="\\"&&(i=i.slice(0,-1)+o.name);continue}if(o.name==="and"){i+="&&";continue}if(o.name==="or"){i+="||";continue}if(o.name==="True"){i+="true";continue}if(o.name==="False"){i+="false";continue}if(r==="boolean"&&!vze(o.name)&&!mze.includes(o.name)&&!pze.includes(o.name)&&!gze.includes(o.name.replace(/\($/g,""))){i+='"'+o.name+'"';continue}i+=o.name}if(r==="string")return i;if(e.length===0){if(r==="number")return 0;if(r==="boolean")return!1}let n;try{n=vx(i)}catch(a){console.error(i,a);return}let s;try{s=li(n)}catch(a){console.error(i,n,a)}return s}function li(e){switch(e.type){case"BinaryExpression":switch(e.operator){case"==":return+(li(e.left)===li(e.right));case"!=":return+(li(e.left)!==li(e.right));case">":return+(li(e.left)>li(e.right));case">=":return+(li(e.left)>=li(e.right));case"<":return+(li(e.left)<li(e.right));case"<=":return+(li(e.left)<=li(e.right));case"+":return li(e.left)+li(e.right);case"-":return li(e.left)-li(e.right);case"*":return li(e.left)*li(e.right);case"/":return li(e.left)/li(e.right);case"%":return li(e.left)%li(e.right);case"&&":return li(e.left)&&li(e.right);case"||":return li(e.left)||li(e.right);case"^":return Math.pow(li(e.left),li(e.right));default:throw new Error("Unknown operator: "+e.operator)}case"UnaryExpression":switch(e.operator){case"-":return-li(e.argument);case"!":return+!li(e.argument);default:throw new Error("Unknown operator: "+e.operator)}case"Identifier":throw new Error("Unknown identifier: "+e.name);case"Literal":return e.value;case"CallExpression":if(e.callee.type==="Identifier"){if(e.callee.name==="random"){let t=0,r=1;if(e.arguments.length>=1)try{t=li(e.arguments[0])}catch(i){console.warn(i)}if(e.arguments.length>=2)try{r=li(e.arguments[1])}catch(i){console.warn(i)}return t=Math.min(r,t),r=Math.max(r,t),t+Math.random()*(r-t)}return Math[e.callee.name].apply(null,e.arguments.map(li))}else throw new Error("Unknown node");default:throw new Error("Unknown node type: "+e.type)}}var yze=new ot,xze=new ot;function bze(e,t,r){let i=[new V,new V,new V],n=[new V,new V,new V];return e.extractBasis(i[0],i[1],i[2]),t.extractBasis(n[0],n[1],n[2]),i.forEach((s,a)=>{let o=n[a],l=Ct.lerp(s.length(),o.length(),r);s.lerp(o,r).setLength(l)}),new ot().makeBasis(i[0],i[1],i[2])}var wze=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let r=Object.assign({},t?.parameters??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),i=Math.abs(r.width),n=Math.abs(r.height??r.width),s=Math.abs(r.depth??0),a=t?.shapeData??OB.create({parameters:yse}).userData.shape;return{path:e.path??kM.defaultData(),parameters:Object.assign(r,{width:i,height:n,depth:s,extrusion:{...xse,...r.extrusion}}),shapeData:a}}static build(e){if(e.path.points.length>=2){let t=new _ze(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new Lt,{userData:{...e,type:"PathGeometry"}})}},_ze=class extends Lt{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!X5e(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:r,offset:i}=this.inputs.parameters.extrusion;r=Math.max(0,Math.min(r,1)),i=Math.max(0,Math.min(i,1));let n=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(i*n),a=this.inputs.path.isClosed?Math.ceil((r+i)*n):Math.ceil(Math.min(1,r+i)*n),o=Math.min(Math.max(2,a-s+1),n+2),l=[],c=[];for(let Y=0;Y<o;Y++){let X=this.inputs.path.isClosed?(Y+s)%e.length:Math.min(Y+s,e.length-1);l.push(e[X].clone()),c.push(t[X].clone())}let u=(Y,X,re)=>{l[Y]=l[Y].clone().lerp(l[X],re),c[Y]=bze(c[Y],c[X],re)},d=0,f=i*n%1;(!this.inputs.path.isClosed||r<=1)&&(f||i===0)&&(d=f,u(0,1,d));let m=0,v=(i+r)*n%1;if((this.inputs.path.isClosed&&r<=1||!this.inputs.path.isClosed&&i+r<1)&&v&&(m=v,u(l.length-1,l.length-2,1-m)),r===0){let Y=l.length-1;l[Y].copy(l[0]),c[Y].copy(c[0])}this._applyPathModifiers(c,d,m);let{bevel:y,bevelSides:x}=this.inputs.parameters.extrusion,w=y>0?this.inputs.parameters.extrusion.capType:"flat",_=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(_=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:S,infos:P,vertices:M}=this._computeShapePoints(_),C=0,T;w==="round"&&(T=new IB(this.inputs.shapeData,2*y,y,_,x,void 0,!0),C=T.getAttribute("position").count);let E=0,N=0;P.sort((Y,X)=>Y.start-X.start),P.forEach(Y=>{Y.verticesStart=E,Y.verticesCount=Y.continuous.reduce((X,re,F)=>X+(F===0||!re?2:1),0),N+=Y.verticesCount,E=N});let D=N*o,I,j=0;if(this._isOpenEnded()&&w==="flat"){try{I=pp({windingRule:ki.ODD,elementType:ss.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:S})}catch{I=zse}j=I.vertexCount}let L=D+2*j+C*2,B=D+2*j,q={positions:new Float32Array(L*3),normals:new Float32Array(L*3),uvs:new Float32Array(L*2)},G=[];if(P.forEach(Y=>{this._extrudeRegion(Y,M,c,l,q,G,this._isGeometryClosed()&&!this._isOpenEnded())}),I&&(this._closeEnd(I,D,G,q,c[0],l[0],!1),this._closeEnd(I,D+j,G,q,c[c.length-1],l[l.length-1],!0)),T){q.positions.set(T.getAttribute("position").array,B*3),q.normals.set(T.getAttribute("normal").array,B*3),q.uvs.set(T.getAttribute("uv").array,B*2);for(let F=B;F<B+C;F++)q.uvs[F*2+1]=1e-4;let Y=G.length;G.push(...T.getIndex().array.map(F=>F+B)),B+=C,q.positions.set(T.getAttribute("position").array,B*3),q.normals.set(T.getAttribute("normal").array,B*3),q.uvs.set(T.getAttribute("uv").array,B*2);let X=G.length;G.push(...T.getIndex().array.map(F=>F+B)),this.setAttribute("position",new Jt(q.positions,3)),this.setAttribute("normal",new Jt(q.normals,3)),this.setAttribute("uv",new Jt(q.uvs,2)),this.setIndex(G);let re=yze;re.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(re,B,L),re.copy(c[0]).setPosition(l[0]).multiply(xze.makeScale(1,1,-1)),this.applyMatrix4OnRange(re,B-C,B),this.reverseIndicesOnRange(Y,X)}else this.setAttribute("position",new Jt(q.positions,3)),this.setAttribute("normal",new Jt(q.normals,3)),this.setAttribute("uv",new Jt(q.uvs,2)),this.setIndex(G)}_extractPathPoints(){let e=Mse(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(r=>{t[t.length-1].distanceToSquared(r)>.001&&t.push(r)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],r=e.length,i=this.inputs.path.isClosed,n=new V,s=new V,a=new V,o=new V,l=new V(0,1,0);for(let v=0;v<r;v++){let y=e[v],x;v===0?x=i?e[e.length-2]:y.clone().multiplyScalar(2).sub(e[1]):x=e[v-1];let w;v===r-1?w=i?e[1]:y.clone().multiplyScalar(2).sub(e[v-1]):w=e[v+1];let _=y.clone().sub(x).normalize(),S=w.clone().sub(y).normalize(),P=_.clone().add(S).normalize();a.copy(P),v===0&&(P.equals(l)||P.clone().negate().equals(l))&&l.set(0,0,1);let M=l.clone().cross(P).normalize(),C=P.clone().cross(M).normalize();l.copy(C),o.copy(M),v===0&&(n.copy(C),s.copy(P));let T=new ot().makeBasis(M,C,P);t.push(T)}let c=i?s:a,u=i?n:new V(0,1,0),d=c.clone().cross(o).normalize(),f=Math.acos(u.dot(d));if(isNaN(f))return t;let m=u.clone().cross(d);c.dot(m)>0&&(f*=-1);for(let v=1;v<t.length;v++){let y=new ot().makeRotationZ(f*v/t.length);t[v].multiply(y)}return t}_applyPathModifiers(e,t,r){let i=e.length,{angle:n,twist:s,startScale:a,endScale:o}=this.inputs.parameters.extrusion,l=new ot,c=new ot;return e.forEach((u,d)=>{let f=d===0?0:d===i-1?1:(d-t)/(i-(r===0?0:1)-(t+(1-r)));l.makeRotationZ(Ct.lerp(n,n+s,f)*Ct.DEG2RAD);let m=Ct.lerp(a,o,f);c.makeScale(m,m,m),u.multiply(l).multiply(c)}),e}_computeShapePoints(e=12,t=ki.ODD){let r=this.inputs.shapeData,i=r.extractShapePointsToFlatArray([],e),n=r.shapeHoles.map(c=>{let u=c.extractShapePointsToFlatArray([],e),d=[];for(let f=u.length-1;f>=1;f-=2){let m=u[f-1],v=u[f-0];d.push(m,v)}return d}),s;try{s=pp({windingRule:t,elementType:ss.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]})}catch{s=RB}let a;try{a=pp({windingRule:ki.ODD,elementType:ss.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...n]})}catch{a=Lse}if(!s)throw new Error("error generating geometry");let o=s.elementCount;if(a){s.elementCount+=a.elementCount;for(let c=0;c<a.elements.length;c++){let u=a.elements[c],d=c%2===0?s.vertexCount:0;s.elements.push(u+d)}for(let c=0;c<a.vertexIndices.length;c++){let u=a.vertexIndices[c],d=s.vertexCount;s.vertexIndices.push(u+d)}for(let c=0;c<a.vertices.length;c++){let u=a.vertices[c];s.vertices.push(u)}}for(let c=0,u=s.vertexCount;c<u;c++){let d=c*2;s.vertices[d+0],s.vertices[d+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let u=c>=o,d=c*2,f=s.elements[d+0],m=s.elements[d+1],v=f+m,y={start:f,count:m,normals:[],isHole:u,continuous:[],verticesStart:0,verticesCount:0};l.push(y);let x=f,w=v-1,_=f+1,S=r.roundedCurves.length;do{let P=x-f;s.vertices[w*2+0],s.vertices[w*2+1];let M=s.vertices[x*2+0],C=s.vertices[x*2+1],T=s.vertices[_*2+0],E=s.vertices[_*2+1],N=M-T,D=C-E,I=Math.sqrt(N*N+D*D);N/=I,D/=I,y.normals[P*2+0]=-D,y.normals[P*2+1]=N;let j=s.vertexIndices[x];if(Array.isArray(j))y.continuous[P]=!1;else{let[L,B]=r.getCurveIndexFromVertexId(j-1,!0);if(B>0&&B<1)y.continuous[P]=!0;else{let q=B===1?L+1:L-1;q=(q+S)%S;let G=B===1?0:1,Y=r.roundedCurves[L].getTangent(B),X=r.roundedCurves[q].getTangent(G);y.continuous[P]=Y.dot(X)>.95}}u&&(y.normals[P*2+0]*=-1,y.normals[P*2+1]*=-1),[w,x,_]=[x,_,_+1],_>=v&&(_-=m)}while(_!==f+1)}return{regions:[i,...n],infos:l,vertices:s.vertices}}_insertVertex(e,t,r,i,n){let s=t*2,a=t*3;e.positions[a+0]=r.x,e.positions[a+1]=r.y,e.positions[a+2]=r.z,e.normals[a+0]=i.x,e.normals[a+1]=i.y,e.normals[a+2]=i.z,e.uvs[s+0]=n.x,e.uvs[s+1]=n.y}_extrudeRegion(e,t,r,i,n,s,a){let o=new V,l=new V,c=new V,u=new V,d=new ge;r.forEach((m,v)=>{let y=i[v],x=e.verticesStart*r.length+e.verticesCount*v;for(let w=0;w<e.count;w++){let _=(e.start+w)*2;if(o.set(t[_+0],t[_+1],0),c.copy(o).applyMatrix4(m).add(y),e.continuous[w])u.set(e.normals[w*2+0],e.normals[w*2+1],0);else{let S=w===0?(e.start+e.count-1)*2:_-2;l.set(t[S+0],t[S+1],0),u.copy(o).sub(l),u.set(-u.y,u.x,0),e.isHole||u.negate()}if(u.applyMatrix4(m).normalize(),d.set(w===0?1:w/e.count,v/(r.length-1)),this._insertVertex(n,x,c,u,d),x++,!e.continuous[w]||w===0){if(w===0)u.set(e.normals[w*2+0],e.normals[w*2+1],0),d.set(0,v/(r.length-1));else{let S=w===e.count-1?e.start*2:_+2;l.set(t[S+0],t[S+1],0),u.copy(l).sub(o),u.set(-u.y,u.x,0),e.isHole||u.negate()}u.applyMatrix4(m).normalize(),this._insertVertex(n,x,c,u,d),x++}}});let f=r.length-1;for(let m=0;m<f;m++){let v=e.verticesStart*r.length+e.verticesCount*m,y=e.verticesStart*r.length+e.verticesCount*(m+1),x=0;for(let w=0;w<e.count;w++){(!e.continuous[w]||w===0)&&x++;let _=w===e.count-1?0:x+1,S=v+x,P=v+_,M=y+_,C=y+x;e.isHole?s.push(S,M,P,S,C,M):s.push(S,P,M,S,M,C),x++}}}_closeEnd(e,t,r,i,n,s,a){let o=e.vertexCount,l=new V(0,0,a?-1:1).applyMatrix4(n),c=new V,u=new ge;for(let f=0;f<o;f++){let m=2*f;c.set(e.vertices[m+0],e.vertices[m+1],0).applyMatrix4(n).add(s),this._insertVertex(i,t+f,c,l,u)}let d=e.elements;for(let f=0;f<e.elementCount;f++){let m=3*f,v=d[m+0]+t,y=d[m+(a?1:2)]+t,x=d[m+(a?2:1)]+t;r.push(v,y,x)}}applyMatrix4OnRange(e,t,r){let i=e.elements,n=new as().getNormalMatrix(e).elements,s,a,o,l,c=this.attributes.position,u=this.attributes.normal;if(!c||!u)return;let d=c.array,f=u.array,m=c.itemSize;for(let v=t*m,y=r*m;v<y;v+=m){if(v===t)debugger;s=d[v+0],a=d[v+1],o=d[v+2],l=1/(i[3]*s+i[7]*a+i[11]*o+i[15]),d[v+0]=(i[0]*s+i[4]*a+i[8]*o+i[12])*l,d[v+1]=(i[1]*s+i[5]*a+i[9]*o+i[13])*l,d[v+2]=(i[2]*s+i[6]*a+i[10]*o+i[14])*l,s=f[v+0],a=f[v+1],o=f[v+2],f[v+0]=n[0]*s+n[3]*a+n[6]*o,f[v+1]=n[1]*s+n[4]*a+n[7]*o,f[v+2]=n[2]*s+n[5]*a+n[8]*o}c.needsUpdate=!0,u.needsUpdate=!0}reverseIndicesOnRange(e,t){let r=this.index;if(r){for(let i=e;i<t;i+=3){let n=r.getX(i),s=r.getX(i+1),a=r.getX(i+2);r.setXYZ(i,a,s,n)}r.needsUpdate=!0}}};function Zse(){let e=new Lt;return e.setAttribute("position",new Jt(new Float32Array([]),3)),e.setIndex(new Jt(new Uint16Array([]),1)),e}var Sze=Zse().attributes,Eze=12,Aze=1,$L=class extends Lt{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,Sze),this.userData={parameters:e,type:"TextGeometry"};let r=t.getFont(e.font);r?.isLoaded?(this.font=r,this.update(e,t)):this.updateFont(e.font,t).then(()=>{this.update(e,t),t?.requestRender()})}async updateFont(e,t){let r=t.getFont(e);r&&(this.font=r,await r.loadingPromise)}update(e,t){let r=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!r?.isLoaded){console.warn("Cannot update text because its font is not loaded");return}let{width:i,height:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o,text:l,textTransform:c}=e,u=ga.getDisplayedValue(l),d=c===2?u.toUpperCase():c===3?u.toLowerCase():u,f=Cze(e,r,d,t),{shapes:m,charWidths:v,charCoords:y}=r.generateShapes(f,e,t),x=(typeof i=="number"?i:Number(t.getVariable(i)))*.5,w=(typeof n=="number"?n:Number(t.getVariable(n)))*.5,_=m.map(M=>new Pn().fromShape(M,!0));this.vectorShapes=_;let S=_.map(M=>g0.create({shape:M,parameters:{depth:s,extrudeBevelSegments:o,extrudeBevelSize:a,windingRule:s<=0?ki.NONZERO:ki.ODD,subdivisions:this.isLowResolution&&s>0?Aze:Eze}})),P=S.length?mg(S):Zse();P.translate(-x,w,0),this.dispose(),this.wrappedText=f,this.charCoords=y,this.charWidths=v,this.deleteAttribute("extrudeNormal"),Object.entries(P.attributes).forEach(([M,C])=>{this.setAttribute(M,C)}),this.setIndex(P.index),this.computeBoundingSphere()}clone(){let e=$l(new Lt,$L.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(([t,r])=>{this.setAttribute(t,r)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e,t){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:{textValue:e}},t)}get text(){return this.userData.parameters.text??""}};function Cze(e,t,r,i){let n=typeof e.width=="string"?Number(i.getVariable(e.width)):e.width,s=[""],a="";for(let o of r)a+=o,o===" "||o===`
`?(s[s.length-1]+=a,a="",o===`
`&&s.push("")):t.getTextWidth(s[s.length-1]+a,e)>n&&(s[s.length-1].length&&s.push(""),t.getTextWidth(s[s.length-1]+a,e)>n&&(a.length===1?(s[s.length-1]+=a,a=""):(s[s.length-1]+=a.slice(0,-1),a=a[a.length-1],s.push(""))));return s[s.length-1]+=a,s}var Jse,eae=new Promise(e=>{Jse=e}),jY=!1,VA;function Tze(e){if(jY)return;if(VA)return VA;async function t(){let r=e??"https://unpkg.com/@splinetool/modelling-wasm@1.10.37/build",i=Zp(()=>import("./process-BndNkLcD.js"),[]),[n,s]=await Promise.all([i,fetch(`${r}/process.wasm`).then(l=>l.arrayBuffer())]),a=n.default,o=await a({wasmBinary:s});Jse(o),jY=!0}return VA=t(),VA}var Mze=["font"];function Y2(e,t,r,i){let n,s,a;e.type==="PathGeometry"?(s=JSON.parse(JSON.stringify(e)),a=[[],["extrusion"]]):(s={...e},a=[[]]);for(let c of a){let u=s;for(let d of c)u=u[d];for(n in u){let d=u[n];Bq(d)&&!Mze.includes(n)&&(u[n]=t.getVariable(d,[i.uuid,"geometry",...c,n]),Bq(u[n])&&(u[n]=1))}}let o={parameters:s,type:s.type};if(s.type==="PathGeometry")o.path=s.path;else if(s.type==="VectorGeometry"){let c=Pn.createFromState(s.shape,s.width,s.height);o.shape=c}else if(s.type==="NonParametricGeometry"){if(s.data.groups&&s.data.groups?.forEach(c=>c.materialIndex=Math.max(c.materialIndex??0,0)),o.geometry=new Uie().parse(s),o.geometry.groups.length===0){let c=o.geometry;c.addGroup(0,Math.max(c.getIndex()?.count??0,c.getAttribute("position").count),0)}}else if(s.type==="SubdivGeometry"){let c=new to(s,r);return c.data=e,c}else{if(s.type==="TextGeometry")return new $L(s,t);if(s.type==="InputGeometry")return new $L(s,t);if(s.type==="UIGeometry")return jB.create({parameters:{width:s.width,height:s.height,cornerRadius:s.cornerRadius,cornerType:s.cornerType}})}let l;try{l=VY(o)}catch(c){console.error(c)}if(!l){let c=Pn.createFromState(NM.defaultData(),100,100);o.shape=c,l=VY(o)}return l}var Pze=new ot;function KL(e,t,r,i){let n=e.position.array,s=e.normal.array,a=Pze.makeScale(t,r,i).invert().elements,o,l,c;for(var u=0,d=n.length;u<d;u+=3)n[u]*=t,n[u+1]*=r,n[u+2]*=i,o=s[u],l=s[u+1],c=s[u+2],s[u]=a[0]*o+a[4]*l+a[8]*c,s[u+1]=a[1]*o+a[5]*l+a[9]*c,s[u+2]=a[2]*o+a[6]*l+a[10]*c;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var UA=new Wn,Rv=new V,tr;eae.then(e=>{tr=e});var LY=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),zY=new Uint32Array([0,1,2,3]),BY=new Uint8Array([4]),to=class extends Lt{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let r=this.data.scaleBaked,i=Pg.div(t,r);this.subdividedGeometry&&KL(this.subdividedGeometry.attributes,...i),this.originalGeometry&&KL(this.originalGeometry.attributes,...i),this.data=e;let n=this.userData.parameters;this.userData.parameters={width:n.width*i[0],height:n.height*i[1],depth:n.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(Rv.fromArray(i));let s=Rv.set(n.width,n.height,n.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,r;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:r}=to.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new Fc(100,100,100),r=0}this.subdivPointer=r,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(to.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Oo,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;UA.setFromBufferAttribute(t),UA.getCenter(r),e.boundingSphere.radius=r.distanceTo(UA.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),UA.getSize(Rv);let i={width:Rv.x,height:Rv.y,depth:Rv.z};return this.userData.parameters=i,i}static build(e,t,r,i){let n,s,a,o=e?.phongAngle??35;r===!1&&(o=-1),t&&(tr.free_bvh(t),tr.free_subdivision_surface(t));try{n=to.allocate(e,i)}catch(l){console.error(l,e),n=to.allocate({positionWASM:LY,indexWASM:zY,verticesPerFaceWASM:BY},i)}if(tr.set_destination_refinement_level(n,0),s=to.buildLevel(n,!0,o),e.subdivisions>0)try{tr.set_destination_refinement_level(n,e.subdivisions),a=to.buildLevel(n,!1,o)}catch{try{tr.set_destination_refinement_level(n,e.subdivisions-1),a=to.buildLevel(n,!1,o)}catch{a=null}}else a=null;return{subdivPointer:n,originalGeometry:s,subdividedGeometry:a}}static primitiveToQuads(e,t,r){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let i=e.shape!==void 0||e.path!==void 0?t.geometry:Y2(e,r,!1),n;e.type==="TorusGeometry"&&e.arc===Math.PI*2?n=i.getClosedTorusIndicesForBooleanOrSubdiv():n=i.getIndex();let s,a,o,l;({positions:s,triIndices:l}=Y3(i.getAttribute("position"),n));let c;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let u=e.radialSegments*e.heightSegments*3*2,d=u+e.radialSegments*3;c=[u,d]}return{indices:a,verticesPerFace:o}=tae(s,l,i,c),{positions:s,indices:a,verticesPerFace:o}}static allocate(e,t){let r,i,n,s=[],a=[];e.positionWASM&&e.positionWASM.length>0?(r=e.positionWASM,i=e.indexWASM,n=e.verticesPerFaceWASM):(r=LY,i=zY,n=BY);let o=r.length,l=i.length,c=n.length,u=r.length+s.length+a.length,d=i.length+n.length,f=u*Float32Array.BYTES_PER_ELEMENT+d*Uint32Array.BYTES_PER_ELEMENT,m=u*Float32Array.BYTES_PER_ELEMENT,v=tr._malloc(f),y=new Float32Array(tr.HEAPF32.buffer,v,u),x=new Uint32Array(tr.HEAPU32.buffer,v+m,d);y.set(r,0),y.set(s,r.length),y.set(a,r.length+s.length),x.set(i,0),x.set(n,i.length);let w;e?.scaleBaked?.some(S=>S!==1)&&(w=new ot().makeScale(...e.scaleBaked)),t&&(w?w.premultiply(t):w=t);let _=w?tr.alloc_subdivision_surface2(v,o,v+m,l,v+m+i.length*Uint32Array.BYTES_PER_ELEMENT,c,w.elements):tr.alloc_subdivision_surface(v,o,v+m,l,v+m+i.length*Uint32Array.BYTES_PER_ELEMENT,c);return tr._free(v),_}static buildLevel(e,t,r,i,n){let s=n?tr.get_mesh_data2(e,t?tr.Level.CONTROL:tr.Level.REFINED,r,n.elements):tr.get_mesh_data(e,t?tr.Level.CONTROL:tr.Level.REFINED,r),a=8,o=tr.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(4,8),c=0,u=tr.HEAPU32[o[c]>>2],d=tr.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let f=tr.HEAPU32[o[c]>>2],m=tr.HEAPF32.subarray(f>>2,(f>>2)+l[c]);c++;let v=tr.HEAPU32[o[c]>>2],y=tr.HEAPU32.subarray(v>>2,(v>>2)+l[c]);c++;let x=tr.HEAPU32[o[c]>>2],w=tr.HEAPU32.subarray(x>>2,(x>>2)+l[c]);if(c++,i===void 0){let _=new Lt;if(_.setIndex(new Ny(w,1)),_.setAttribute("position",new At(d,3)),_.setAttribute("normal",new At(m,3)),t){_.setAttribute("faceMap",new Ny(y,1));let S=new Float32Array(m.length/3*4).fill(0);_.setAttribute("color",new Jt(S,4))}return tr.free_mesh_data(s),_.userData.type="SubdivGeometry",_}i.getAttribute("position").copyArray(d),i.getAttribute("normal").copyArray(m),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,tr.free_mesh_data(s)}static freeSubdivPointer(e){tr.free_bvh(e),tr.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,r){let i=tr.get_wireframe_data_for_base_level(e),n=4,s=tr.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(2,4),o=0,l=tr.HEAPU32[s[o]>>2],c=tr.HEAPF32.subarray(l>>2,(l>>2)+a[o]);o++;let u=tr.HEAPU32[s[o]>>2],d=tr.HEAPU32.subarray(u>>2,(u>>2)+a[o]);if(t===void 0){let f=new Lt;f.setAttribute("position",new At(c,3));let m=new Float32Array(c.length);for(let v=0,y=c.length;v<y;)m[v++]=r.r,m[v++]=r.g,m[v++]=r.b;return f.setAttribute("color",new Jt(m,3)),f.setIndex(new Ny(d,1)),tr.free_wireframe_data_for_base_level(i),f}t.getAttribute("position").copyArray(c),t.attributes.position.needsUpdate=!0,tr.free_wireframe_data_for_base_level(i)}static updateCollabMesh(e,t,r){let i=t===0;i||tr.set_destination_refinement_level(e,t);let n=r?tr.get_topological_data2(e,i?tr.Level.CONTROL:tr.Level.REFINED,r.elements):tr.get_topological_data(e,i?tr.Level.CONTROL:tr.Level.REFINED),s=6,a=tr.HEAPU32.subarray(n>>2,(n>>2)+s),o=a.subarray(3,6),l=0,c=tr.HEAPU32[a[l]>>2],u=new Float32Array(tr.HEAPF32.subarray(c>>2,(c>>2)+o[l]));l++;let d=tr.HEAPU32[a[l]>>2],f=new Uint32Array(tr.HEAPU32.subarray(d>>2,(d>>2)+o[l]));l++;let m=tr.HEAPU32[a[l]>>2],v=new Uint8Array(tr.HEAPU32.subarray(m>>2,(m>>2)+o[l]));return tr.free_topological_data(n),{positions:u,indices:f,verticesPerFace:v}}},FY=["getX","getY","getZ"];function Y3(e,t){let r={},i=t?t.count:e.count,n=0,s=[],a=[],o=1e4;for(let c=0;c<i;c++){let u=t?t.getX(c):c,d="";for(let f=0;f<3;f++)d+=`${~~(e[FY[f]](u)*o)},`;if(d in r)s.push(r[d]);else{for(let f=0;f<3;f++)a.push(e[FY[f]](u));r[d]=n,s.push(n),n++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:a,triIndices:l}}var HA=new V,z4=new V,B4=new V,F4=new V;function tae(e,t,r,i){let n=[],s=[];if(r.userData.shape!==void 0&&r.userData.parameters.depth===0&&r.userData.shape.shapeHoles.length===0){let l=r.userData.shape.extractShapePointsToFlatArray([]),c=r.userData.parameters.spikes;if(r.userData.type==="EllipseGeometry"&&c<=24&&c%4===0&&r.userData.parameters.angle>=360){let f=l.length/2/c;l=l.filter((m,v)=>Math.floor(v/2)%f===0)}let u=0;for(let f=0;f<l.length;f+=2)u+=(l[f]-l[(f===0?l.length:f)-2])*(l[f+1]+l[(f===0?l.length:f)-1]);e.length=0;let d=0;if(u<0)for(let f=0;f<l.length;f+=2)e.push(l[f],l[f+1],0),n.push(d++);else for(let f=l.length-2;f>=0;f-=2)e.push(l[f],l[f+1],0),n.push(d++);return s.push(d),{indices:n,verticesPerFace:s}}let a=new Float32Array([r.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(r.useNgonForTopBottomFaceDuringBake){let l=0;if((e[t[o]*3+2]===a||e[t[o]*3+2]===0)&&l++,(e[t[o+1]*3+2]===a||e[t[o+1]*3+2]===0)&&l++,(e[t[o+2]*3+2]===a||e[t[o+2]*3+2]===0)&&l++,l===3)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){HA.set(e[t[o]*3],e[t[o]*3+1],e[t[o]*3+2]),z4.set(e[t[o+1]*3],e[t[o+1]*3+1],e[t[o+1]*3+2]),B4.set(e[t[o+4]*3],e[t[o+4]*3+1],e[t[o+4]*3+2]),F4.set(e[t[o+5]*3],e[t[o+5]*3+1],e[t[o+5]*3+2]),z4.sub(HA).normalize(),B4.sub(HA).normalize(),F4.sub(HA).normalize();let l=z4.cross(B4).dot(F4);Math.abs(l)>.005||i&&i.some((c,u)=>u%2===1?!1:o>=i[u]&&o<i[u+1])?(n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(n.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else n.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3}if(r.useNgonForTopBottomFaceDuringBake){let l=[],c=[],u=0;for(let d=0,f=0;d<e.length;d+=3,f++)e[d+2]===0&&(l.push(f),u++),e[d+2]===a&&c.push(f);if(r.userData.parameters.extrudeBevelSize===0){let d=c[0];c[0]=c[1],c[1]=d}l.reverse(),n.push(...l,...c),s.push(u,u)}return{indices:n,verticesPerFace:s}}var rh={};Lwe(rh,{calcBoolean:()=>Ize,calcBooleanTopological:()=>Rze,freeMeshSet:()=>zze,getMeshSet:()=>Oze,hasOpenEdges:()=>jze,transformMeshSet:()=>Lze});var rae,Dze=new Promise(e=>{rae=e}),GA;function Nze(e){if(GA)return GA;async function t(){let r=e??"https://unpkg.com/@splinetool/boolean-wasm@1.10.37/build",i=Zp(()=>import("./boolean-B0Yz-YaS.js"),[]),[n,s]=await Promise.all([i,fetch(`${r}/boolean.wasm`).then(l=>l.arrayBuffer())]),a=n.default,o=await a({wasmBinary:s});rae(o)}return GA=t(),GA}var Yr,zy;Dze.then(e=>Yr=e);function kze(e,t,r){let i,n;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?n=e.getClosedTorusIndicesForBooleanOrSubdiv():n=e.getIndex();let{positions:s,triIndices:a}=Y3(e.getAttribute("position"),n),o;if(t&&r){let{indices:l,verticesPerFace:c}=tae(s,a,e);o=c.length,i=[];for(let u=0,d=0;u<o;u++){i.push(c[u]);for(let f=0;f<c[u];f++)i.push(l[d++])}}else{let l=a.length;i=Array(l+l/3),o=0;for(let c=0,u=0;u<i.length;)i[u++]=3,o++,i[u++]=a[c++],i[u++]=a[c++],i[u++]=a[c++]}return{positions:s,faceIndices:i,nFaces:o}}function iae(e){let t=e.length,r=t*Uint32Array.BYTES_PER_ELEMENT,i=t*Float32Array.BYTES_PER_ELEMENT,n=Number.isInteger(e[0])?r:i,s=Yr._malloc(n);return(Number.isInteger(e[0])?new Uint32Array(Yr.HEAPU32.buffer,s,t):new Float32Array(Yr.HEAPF32.buffer,s,t)).set(e,0),s}function nae(e){switch(e){case 0:return Yr.OP.UNION;case 1:return Yr.OP.INTERSECTION;case 2:return Yr.OP.A_MINUS_B;default:throw new Error("Unknown boolean operation "+e)}}function Rze(e,t){zy===void 0&&(zy=Yr.init_csg());let r=iae(e),i=Yr.csg_calc_topological(zy,r,e.length,nae(t));Yr._free(r);let n=6,s=Yr.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(3,6),o=0,l=Yr.HEAPU32[s[o]>>2],c=new Float32Array(Yr.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let u=Yr.HEAPU32[s[o]>>2],d=new Uint32Array(Yr.HEAPU32.subarray(u>>2,(u>>2)+a[o]));o++;let f=Yr.HEAPU32[s[o]>>2],m=new Uint8Array(Yr.HEAPU32.subarray(f>>2,(f>>2)+a[o]));return Yr.free_mesh_data(i),{positions:c,indices:d,verticesPerFace:m}}function Ize(e,t,r,i){zy===void 0&&(zy=Yr.init_csg());let n=iae(e),s=Yr.csg_calc(zy,n,e.length,i,nae(t));Yr._free(n);let a=5,o=Yr.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(2,5),c=0,u=Yr.HEAPU32[o[c]>>2],d=Yr.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let f=Yr.HEAPU32[o[c]>>2],m=Yr.HEAPF32.subarray(f>>2,(f>>2)+l[c]);c++;let v=l[c];r.setAttribute("position",new At(d,3)),r.setAttribute("normal",new At(m,3));let y=Yr.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return r.boundingSphere===null&&(r.boundingSphere=new Oo),r.boundingSphere.center.set(y[0],y[1],y[2]),r.boundingSphere.radius=(y[3]**2+y[4]**2+y[5]**2)**.5,r.userData.parameters={width:y[3]*2,height:y[4]*2,depth:y[5]*2},Yr.free_mesh_data(s),v}function Oze(e,t,r){if(Yr===void 0)return-1;let i,n,s;if(t&&e.userData.positions!==void 0){let x=e.userData;s=x.verticesPerFace.length,i=x.positions,n=Array(x.verticesPerFace.reduce((w,_)=>w+_,0)+s);for(let w=0,_=0,S=0;w<x.verticesPerFace.length;w++){n[S++]=x.verticesPerFace[w];for(let P=0;P<x.verticesPerFace[w];P++)n[S++]=x.indices[_++]}}else({positions:i,faceIndices:n,nFaces:s}=kze(e,t,r));let a=i.length,o=n.length,l=i.length,c=n.length,u=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,d=l*Float32Array.BYTES_PER_ELEMENT,f=Yr._malloc(u),m=new Float32Array(Yr.HEAPF32.buffer,f,l),v=new Uint32Array(Yr.HEAPU32.buffer,f+d,c);m.set(i,0),v.set(n,0);let y=Yr.get_csg_mesh(f,a,f+d,o,s);return Yr._free(f),y}function jze(e){return Yr.has_open_edges(e)}function Lze(e,t){Yr.transform_csg_mesh(e,t.elements)}function zze(e){Yr.free_csg_mesh(e)}var Bze={ConeGeometry:VLe,CubeGeometry:ULe,CylinderGeometry:Pse,DodecahedronGeometry:GLe,EllipseGeometry:OB,HelixGeometry:C5e,IcosahedronGeometry:T5e,LatheGeometry:M5e,NonParametricGeometry:O5e,PolygonGeometry:Yse,PyramidGeometry:j5e,RectangleGeometry:jB,SphereGeometry:B5e,PlaneGeometry:F5e,BackdropGeometry:V5e,StarGeometry:Xse,TextFrameGeometry:H5e,TorusGeometry:G5e,TorusKnotGeometry:q5e,TriangleGeometry:Y5e,PathGeometry:wze,VectorGeometry:g0},VY=e=>Bze[e.type].create(e);function Iv(e){return e!==null&&"booleanOp"in e}var sae=class extends PB(Yi){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new ot}updateVisible(e){super.updateVisible(e),this.visible=!Iv(this.parent)&&this.visible,Iv(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(rh.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),Iv(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof sae&&(e.freeBooleanPointer(),Iv(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e,t){let r=super.updateTransformState(e,t);return r&&Iv(this.parent)&&this.invalidateDownstreamBooleanData(!0),r}onVariableUpdate(e=!1){super.onVariableUpdate(e),Iv(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},WA=new Wn;function LB(e,t=0,r=e.count,i,n){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0;for(let d=t;d<r;d++){let f=e.getX(d),m=e.getY(d),v=e.getZ(d);f<s&&(s=f),m<a&&(a=m),v<o&&(o=v),f>l&&(l=f),m>c&&(c=m),v>u&&(u=v)}WA.min.set(s,a,o),WA.max.set(l,c,u),WA.getCenter(i),WA.getSize(n).multiplyScalar(.5)}var Fze=new Lt,Vze=new Ih,uo=class extends sae{constructor(e,t){super(Fze,Vze),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?LB(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},Xf=class{constructor(e){if(this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},Xf.uuidContext===null)throw new Error("plz startContext");Xf.uuidContext===Xf.globalContext?this.uuid="_gid"+Xf.uuidContext.nodeContextUuid++:this.uuid="_uid"+Xf.uuidContext.nodeContextUuid++,this.type=e,this.name=""}static startContext(e){this.uuidContext===null||this.uuidContext===Xf.globalContext?this.uuidContext=e:console.error("Can't start context twice")}static endContext(e){this.uuidContext!==e&&console.error("Can't end context twice"),this.uuidContext=null}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,r){return r=r??{},this.analyze(e,r),this.flow(e,t,r)}flow(e,t,r){r=r??{},e.addFlow(r.slot,r.cache,r.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,r){t=t??this.getType(e,t);let i=e.getNodeData(r??this);return e.analyzing&&this.appendDepsNode(e,i,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,r)}updateFrame(e){}generateReadonly(e,t,r,i,n,s){return""}generate(e,t,r,i,n){return""}parse(e,t,r,i){}appendDepsNode(e,t,r){t.deps=(t.deps||0)+1;let i=e.getTypeLength(r);(i>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=i,t.output=r)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}},Ss=Xf;Ss.globalContext={nodeContextUuid:0},Ss.uuidContext=Xf.globalContext;var UY=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},Uze=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,r){r=r!==void 0?r:!0,this.keywords[e]={callback:t,cache:r}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},Co=new Uze,Ii=class extends Ss{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,r,i){if(t=t??this.getType(e),this.getShared(e,t)){let n=this.getUnique(e,t);n&&this.uuid===void 0&&(this.uuid=Ct.generateUUID()),r=e.getUUID(r??this.getUUID(),!n);let s=e.getNodeData(r),a=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,r)):super.build(e,t,r);if(n)return s.name=s.name||super.build(e,t,r),s.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||s.deps===1))return super.build(e,t,r);r=this.getUUID(!1);let o=this.getTemp(e,r);if(o)return e.format(o,a,t);{o=super.generate(e,t,r,s.output,i);let l=this.generate(e,a,r);return e.addNodeCode(o+" = "+l+";"),e.format(o,a,t)}}return super.build(e,t,r)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let r=e.getVars()[t];return r?r.name:void 0}generate(e,t,r,i,n){return this.getShared(e,t)||console.error("TempNode is not shared"),r=r??this.uuid,e.getTempVar(r,i??this.getType(e),n,this.getLabel()).name}},Lo=class extends Ii{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,r,i,n,s){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(r);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}},ca=class extends Lo{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof ge?e:new ge(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,r,i,n,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}},Nl=class extends Lo{constructor(e=0,t,r){super("v3"),this.nodeType="Vector3",this.value=e instanceof V?e:new V(e,t,r)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,r,i,n,s){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,t)}},xa=class extends Zt{constructor(e,t,r,i){super(e,t,r),this.isColorA=!0,this.a=i}setRGBA(e,t,r,i){super.setRGB(e,t,r),this.a=i}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}equals(e){return super.equals(e)&&this.a===e.a}setStyle(e,t="srgb"){let r;if(e==="transparent")return this.setRGBA(0,0,0,0),this;if(r=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let i,n=r[1],s=r[2];switch(n){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=n==="rgba"?parseFloat(i[4]):1,super.setStyle(e,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=n==="hsla"?parseFloat(i[4]):1,super.setStyle(e,t);break}}return super.setStyle(e,t)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},ih=class extends Lo{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof xa?e:new xa(e.r,e.g,e.b,e.a)}generateReadonly(e,t,r,i,n,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,t)}},Hze=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,HY=/[a-z_0-9]+/gi,_t=class extends Ii{constructor(t,r,i,n,s){super(s),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=s===void 0,this.isInterface=!1,this.parse(t,r,i,n)}getShared(t,r){return!this.isMethod}getType(t){return t.getTypeByFormat(this.type)}getInputByName(t){if(this.inputs){let r=this.inputs.length;for(;r--;)if(this.inputs[r].name===t)return this.inputs[r]}}getIncludeByName(t){if(this.includes){let r=this.includes.length;for(;r--;)if(this.includes[r].name===t)return this.includes[r]}}generate(t,r,i,n,s){let a,o=0,l=this.src;if(this.includes)for(let u=0;u<this.includes.length;u++)t.include(this.includes[u],this);for(let u in this.extensions)t.extensions[u]=!0;let c=[];for(;a=HY.exec(this.src);)c.push(a);for(let u=0;u<c.length;u++){let d=c[u],f=d[0],m=this.isMethod?!this.getInputByName(f):!0,v=f;if(this.keywords[f]||this.useKeywords&&m&&Co.containsKeyword(f)){let y=this.keywords[f];if(!y){let x=Co.getKeywordData(f);x.cache&&(y=t.keywords[f]),y=y||Co.getKeyword(f,t),x.cache&&(t.keywords[f]=y)}v=y.build(t)}f!==v&&l[d.index+o-1]!=="."&&(l=l.substring(0,d.index+o)+v+l.substring(d.index+f.length+o),o+=v.length-f.length),this.getIncludeByName(v)===void 0&&Co.contains(v)&&t.include(Co.get(v))}return r==="source"?l:this.isMethod?(this.isInterface||t.include(this,void 0,l),this.name):t.format("( "+l+" )",this.getType(t),r)}parse(t,r,i,n){if(this.src=t||"",this.includes=r??[],this.extensions=i??{},this.keywords=n??{},this.isMethod){let s=Hze.exec(this.src);if(this.inputs=[],s&&s.length==4){this.type=s[1],this.name=s[2];let a=s[3].match(HY);if(a){let o=0;for(;o<a.length;){let l=a[o++],c;l==="in"||l==="out"||l==="inout"?c=a[o++]:(c=l,l="");let u=a[o++];this.inputs.push({name:u,type:c,qualifier:l})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},Gze=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,aae=class extends Ii{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||aae.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,r,i,n){this.src=e||"";let s,a,o="",l=Gze.exec(e);this.useDefine=n??this.src.charAt(0)==="#",l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,r,i,n){return e.format(this.name,this.getType(e),t)}},bi=aae;bi.PI="PI",bi.PI2="PI2",bi.RECIPROCAL_PI="RECIPROCAL_PI",bi.RECIPROCAL_PI2="RECIPROCAL_PI2",bi.LOG2="LOG2",bi.EPSILON="EPSILON";var Wze=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),qze=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),oae=class extends Ii{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,r,i,n){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=Wze.exec(e);if(t){let r=t[2],i;for(;i=qze.exec(r);)this.inputs.push({type:i[1],name:i[2]});this.name=t[1]}else this.name="";this.type=this.name}},zB=class extends Ii{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let r=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(i,this.getType(e),t)}};Co.addKeyword("uv",function(){return new zB});Co.addKeyword("uv2",function(){return new zB(1)});var iy=class extends Ii{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??iy.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case Bc:return["Linear"];case Ar:return["sRGB"];default:return[]}}generate(e,t){let r=this.input.build(e,"v4"),i=this.getType(e),n=iy.Nodes[this.method],s=e.include(n);if(s===iy.LINEAR_TO_LINEAR)return e.format(r,i,t);if(n.inputs?.length===2){let a=this.factor.build(e,"f");return e.format(s+"( "+r+", "+a+" )",i,t)}else return e.format(s+"( "+r+" )",i,t)}fromEncoding(e){let t=iy.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=iy.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},Iu=iy;Iu.Nodes={LinearToLinear:new _t(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new _t(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new _t(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Iu.LINEAR_TO_LINEAR="LinearToLinear",Iu.SRGB_TO_LINEAR="sRGBToLinear",Iu.LINEAR_TO_SRGB="LinearTosRGB";var Ji=class extends _t{constructor(t="",r,i,n,s){super(t,s,n,i,r),this.nodeType="Expression"}},ch=class extends Lo{constructor(e=new yn,t,r,i){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new zB,this.bias=r,this.project=i!==void 0?i:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if(t==="sampler2D")return this.getTexture(e,t);let r=this.getTexture(e,t),i=this.uv.build(e,this.project?"v4":"v2"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s,a;this.project?s="texture2DProj":s=n?"tex2DBias":"tex2D",n?a=s+"( "+r+", "+i+", "+n+" )":a=s+"( "+r+", "+i+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new Iu(new Ji("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,l),e.removeContext(),e.format(a,l,t)}},Pt=class extends Lo{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,r,i,n,s){return e.format(this.value+(this.value%1?"":".0"),i,t)}},GY=class extends Ii{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,r,i,n){i=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],u=this.inputs[l]||this.inputs[c.name];o.push(u.build(e,e.getTypeByFormat(c.type)))}a+=o.join(", ")+" )"}return e.format(a,i,t)}},lae=class extends Ii{constructor(e,t,r=lae.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=r}getType(e){let t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t}generate(e,t){let r=this.getType(e);this.type=r;let i=this.a.build(e,r),n=this.b.build(e,r);return e.format("( "+i+" "+this.op+" "+n+" )",r,t)}},wo=lae;wo.ADD="+",wo.SUB="-",wo.MUL="*",wo.DIV="/";var Pi=class extends Ii{constructor(e,t=Pi.ABS,r,i){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:i=t,typeof r!="string"?this.c=r:i=r,this.method=i,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case Pi.MIX:case Pi.CLAMP:case Pi.REFRACT:case Pi.SMOOTHSTEP:case Pi.FACEFORWARD:return 3;case Pi.MIN:case Pi.MAX:case Pi.MOD:case Pi.STEP:case Pi.REFLECT:case Pi.DISTANCE:case Pi.DOT:case Pi.CROSS:case Pi.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>i?this.a.getType(e):r>i?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case Pi.LENGTH:case Pi.DISTANCE:case Pi.DOT:return"f";case Pi.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let r,i,n,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case Pi.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Pi.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Pi.CROSS:r=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case Pi.STEP:r=this.a.build(e,s===1?"f":l),i=this.b.build(e,l);break;case Pi.MIN:case Pi.MAX:case Pi.MOD:r=this.a.build(e,l),i=this.b.build(e,a===1?"f":l);break;case Pi.REFRACT:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,"f");break;case Pi.MIX:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,o===1?"f":l);break;default:r=this.a.build(e,l),this.b&&(i=this.b.build(e,l)),this.c&&(n=this.c.build(e,l));break}let u=[];u.push(r),i&&u.push(i),n&&u.push(n);let d=this.getNumInputs(e);if(u.length!==d)throw Error(`Arguments not match used in "${this.method}". Require ${d}, currently ${u.length}.`);return e.format(this.method+"( "+u.join(", ")+" )",c,t)}},Sr=Pi;Sr.RAD="radians",Sr.DEG="degrees",Sr.EXP="exp",Sr.EXP2="exp2",Sr.LOG="log",Sr.LOG2="log2",Sr.SQRT="sqrt",Sr.INV_SQRT="inversesqrt",Sr.FLOOR="floor",Sr.CEIL="ceil",Sr.NORMALIZE="normalize",Sr.FRACT="fract",Sr.SATURATE="saturate",Sr.SIN="sin",Sr.COS="cos",Sr.TAN="tan",Sr.ASIN="asin",Sr.ACOS="acos",Sr.ARCTAN="atan",Sr.ABS="abs",Sr.SIGN="sign",Sr.LENGTH="length",Sr.NEGATE="negate",Sr.INVERT="invert",Sr.MIN="min",Sr.MAX="max",Sr.MOD="mod",Sr.STEP="step",Sr.REFLECT="reflect",Sr.DISTANCE="distance",Sr.DOT="dot",Sr.CROSS="cross",Sr.POW="pow",Sr.MIX="mix",Sr.CLAMP="clamp",Sr.REFRACT="refract",Sr.SMOOTHSTEP="smoothstep",Sr.FACEFORWARD="faceforward";var Sw=class extends Ii{constructor(e,t,r){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=r}bilinearCubeUV(e,t,r,i){let n=new GY(Sw.Nodes.bilinearCubeUV,[t,r,i]);this.colorSpaceTL=this.colorSpaceTL??new Iu(new Ji("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(n.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Iu(new Ji("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(n.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Iu(new Ji("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(n.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Iu(new Ji("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(n.build(e)+".br");let s={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(s),this.colorSpaceTLExp=new Ji(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new Ji(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new Ji(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new Ji(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let a=new Ji("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return a.keywords.cubeUV_TL=this.colorSpaceTLExp,a.keywords.cubeUV_TR=this.colorSpaceTRExp,a.keywords.cubeUV_BL=this.colorSpaceBLExp,a.keywords.cubeUV_BR=this.colorSpaceBRExp,a.keywords.cubeUV=n,a}generate(e,t){if(e.isShader("fragment")){let r=this.uv,i=this.bias||e.context.roughness,n=new GY(Sw.Nodes.roughnessToMip,[i]),s=new Sr(n,Sw.Nodes.m0,Sw.Nodes.cubeUV_maxMipLevel,Sr.CLAMP),a=new Sr(s,Sr.FLOOR),o=new Sr(s,Sr.FRACT),l=this.bilinearCubeUV(e,this.value,r,a),c=this.bilinearCubeUV(e,this.value,r,new wo(a,new Pt(1).setReadonly(!0),wo.ADD)),u=new Sr(l,c,o,Sr.MIX);return e.format(u.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},QL=Sw;QL.Nodes=function(){let e=new oae(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new bi("float cubeUV_maxMipLevel 8.0",!0),r=new bi("float cubeUV_minMipLevel 4.0",!0),i=new bi("float cubeUV_maxTileSize 256.0",!0),n=new bi("float cubeUV_minTileSize 16.0",!0),s=new _t(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let a=new _t(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);a.useKeywords=!1;let o=new _t(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,s,a,t,r,i,n]);o.useKeywords=!1;let l=new bi("float r0 1.0",!0),c=new bi("float v0 0.339",!0),u=new bi("float m0 -2.0",!0),d=new bi("float r1 0.8",!0),f=new bi("float v1 0.276",!0),m=new bi("float m1 -1.0",!0),v=new bi("float r4 0.4",!0),y=new bi("float v4 0.046",!0),x=new bi("float m4 2.0",!0),w=new bi("float r5 0.305",!0),_=new bi("float v5 0.016",!0),S=new bi("float m5 3.0",!0),P=new bi("float r6 0.21",!0),M=new bi("float v6 0.0038",!0),C=new bi("float m6 4.0",!0),T=[l,c,u,d,f,m,v,y,x,w,_,S,P,M,C],E=new _t(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,T);return{bilinearCubeUV:o,roughnessToMip:E,m0:u,cubeUV_maxMipLevel:t}}();var ny=class extends Ii{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??ny.VIEW}getShared(){return this.scope===ny.WORLD}build(e,t,r,i){let n=e.context[this.scope+"Normal"];return n?n.build(e,t,r,i):super.build(e,t,r)}generate(e,t,r,i,n){let s;switch(this.scope){case ny.VIEW:e.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case ny.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case ny.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal");break}return e.format(s,this.getType(e),t)}},To=ny;To.LOCAL="local",To.WORLD="world",To.VIEW="view",To.NORMAL="normal";Co.addKeyword("viewNormal",function(){return new To(To.VIEW)});Co.addKeyword("localNormal",function(){return new To(To.NORMAL)});Co.addKeyword("worldNormal",function(){return new To(To.WORLD)});var eh=class extends Ii{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??eh.LOCAL}getType(){switch(this.scope){case eh.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case eh.LOCAL:case eh.WORLD:return!1}return!0}generate(e,t,r,i,n){let s;switch(this.scope){case eh.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case eh.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case eh.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case eh.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(s,this.getType(),t)}},Ac=eh;Ac.LOCAL="local",Ac.WORLD="world",Ac.VIEW="view",Ac.PROJECTION="projection";Co.addKeyword("position",function(){return new Ac});Co.addKeyword("worldPosition",function(){return new Ac(Ac.WORLD)});Co.addKeyword("viewPosition",function(){return new Ac(Ac.VIEW)});var Su=class extends Ii{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??Su.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case Su.SPHERE:return"v2"}return this.type}generate(e,t){let r=this.getUnique(e);if(e.isShader("fragment")){let i;switch(this.scope){case Su.VECTOR:{let n=new To(To.VIEW),s=e.context.roughness,a=n.build(e,"v3"),o=new Ac(Ac.VIEW).build(e,"v3"),l=s?s.build(e,"f"):void 0,c=`reflect( -normalize( ${o} ), ${a} )`;l&&(c=`normalize( mix( ${c}, ${a}, ${l} * ${l} ) )`);let u=`inverseTransformDirection( ${c}, viewMatrix )`;r?(e.addNodeCode(`vec3 reflectVec = ${u};`),i="reflectVec"):i=u;break}case Su.CUBE:{let n=new Su(Su.VECTOR).build(e,"v3"),s="vec3( -"+n+".x, "+n+".yz )";r?(e.addNodeCode(`vec3 reflectCubeVec = ${s};`),i="reflectCubeVec"):i=s;break}case Su.SPHERE:{let n="normalize( ( viewMatrix * vec4( "+new Su(Su.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(e.addNodeCode(`vec2 reflectSphereVec = ${n};`),i="reflectSphereVec"):i=n;break}}return e.format(i,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},By=Su;By.CUBE="cube",By.SPHERE="sphere",By.VECTOR="vector";var Yze=class extends Ii{constructor(e=new ch,t,r){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new QL(this.value,t??new By(By.VECTOR),r),this.irradianceNode=new QL(this.value,new To(To.WORLD),new Pt(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},Xze=class extends Lo{constructor(e=new V6,t,r){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new By,this.bias=r}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){if(t==="samplerCube")return this.getTexture(e,t);let r=this.getTexture(e,t),i=this.uv?.build(e,"v3"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s;n?s="texCubeBias( "+r+", "+i+", "+n+" )":s="texCube( "+r+", "+i+" )";let a={include:e.isShader("vertex"),ignoreCache:!0},o=this.getType(e);return e.addContext(a),this.colorSpace=this.colorSpace??new Iu(new Ji("",o)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(e,o),e.removeContext(),e.format(s,o,t)}},$ze=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,Kze=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,Qze=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,Zze=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,Jze=`
layout(location = 1) out vec4 gVelocity;
`,e6e=`
    // Discard fully transparent pixels 
    if (gl_FragColor.a <= 0.0) discard;

    gVelocity = vec4(0.0, 0.0, 0.0, 1.0);
`,WY=["x","y","z","w"],t6e=["float","vec2","vec3","vec4"],r6e={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},i6e={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},cae=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,r){return t.deps.length-r.deps.length}return function(t,r){let i=this.getIncludes(t,r);if(!i)return"";let n="";i=i.sort(e);for(let s=0;s<i.length;s++)i[s].src&&(n+=i[s].src+`
`);return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode($ze),this.addFragmentParsCode(Kze),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){let i=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode(`
				#ifndef SHAPEBLEND 
					vObjectNormal = normal;
				#else
					vObjectNormal = objectNormal;
				#endif
			`)),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(Qze),this.addFragmentFinalCode(Zze)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,r){return this.addSlot(e).addCache(t).addContext(r)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,r,i="varying",n="V",s=""){let a=this.getVars(i),o=a[e];if(!o){let l=a.length;o={name:r||"node"+n+l+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,r,i){return this.getVar(e,t,r,this.shader,"T",i)}getAttribute(e,t){if(!this.attributes[e]){let r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let r="";for(let i=0,n=e.length;i<n;++i){let s=e[i],a=s.type,o=s.name,l=s.size,c=this.getFormatByType(a);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?r+=t+" "+c.substring(0,c.length-2)+" "+o+`[${l}];
`:r+=t+" "+c+" "+o+`;
`}return r}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof Ss?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,r,i,n,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new UY({type:t,size:r.size,name:i||"nodeUA"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}else{let a=this.inputs.uniforms,o=a.list.length,l=new UY({type:t,name:i||"nodeU"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,r,i,n){return this.createUniform("vertex",e,t,r,i,n)}createFragmentUniform(e,t,r,i,n){return this.createUniform("fragment",e,t,r,i,n)}include(e,t,r){let i;if(e=typeof e=="string"?Co.get(e):e,this.context.include===!1)return e.name;e instanceof _t?i=this.includes.functions:e instanceof bi?i=this.includes.consts:e instanceof oae&&(i=this.includes.structs);let n=i[this.shader]=i[this.shader]||[];if(e){let s=n[e.name];if(s||(s=n[e.name]={node:e,deps:[]},n.push(s),s.src=e.build(this,"source")),e instanceof _t&&t&&n[t.name]&&n[t.name].deps.indexOf(e)===-1&&(n[t.name].deps.push(e),e.includes?.length)){let a=0;do this.include(e.includes[a++],t);while(a<e.includes.length)}return r&&(s.src=r),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return t6e[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r?.isNode)return r}}resolve(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!==void 0){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case Ug:case Hg:return new Xze(r);case N_:return new Yze(new ch(r));default:return new ch(r)}else{if(r.isVector2)return new ca(r);if(r.isVector3)return new Nl(r);if(r.isVector4)return new ih(r)}}}}format(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return r6e[e]||e}getFormatByType(e){return i6e[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return WY[e]}getIndexByElement(e){return WY.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=Bc,t===Bc&&this.context.gamma&&(t=Ar),t}},Dn=class extends Lo{constructor(e=0,t,r,i){super("c"),this.nodeType="Color",this.value=e instanceof xa?e:new xa(e||0,t,r,i)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,r,i,n,s){r=e.getUUID(r??this.getUUID()),i=i??this.getType(e);let a=e.getNodeData(r),o=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return o?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}generateReadonly(e,t,r,i,n,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},Fi=class extends Lo{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,r,i,n,s){return e.format(this.value.toString(),i,t)}},io=class extends Lo{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,r,i){return e.format(this.value?"true":"false",i,t)}},Qm=class extends Lo{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},BB=class extends Lo{},n6e=class extends BB{constructor(e){super("v3"),this.image=e,this._value=new V}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},ZL=class extends BB{constructor(e,t,r=1008,i=1006){super("t"),this.image=e,this.wrap=t,this.minFilter=r,this.magFilter=i}get value(){return this.image.getTexture(this.wrap,this.minFilter,this.magFilter)}},uae=class extends Lo{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new as}generateReadonly(e,t,r,i,n,s){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},id=class extends Lo{constructor(e){super("m4"),this.nodeType="Matrix4",this.value=e??new ot}generateReadonly(e,t,r,i,n,s){return e.format("mat4("+this.value.elements.join(", ")+")",i,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}};function qY(e,t,r,i=0){e.setUvTransform(r[0],r[1],t[0],t[1],0,0,0).premultiply(new as().makeRotation(i*Ct.DEG2RAD))}var s6e=class extends uae{constructor(t,r,i=0){super(new as),this.repeat=t,this.offset=r,this.rotation=i,qY(this.value,t,r,i)}updateMatrix(){qY(this.value,this.repeat,this.offset,this.rotation)}},Zm=class extends Lo{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof fr?new Array(e).fill(t):new Array(e).fill(new fr(0))}},YY=class extends Ii{constructor(e,t,r,i){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=r,this.mode=i}generate(e,t){if(e.isShader("fragment")){let r=[];return r.push(this.a.build(e,"c")),r.push(this.b.build(e,"c")),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),e.format("spe_blend("+r.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},dae=class extends Ii{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(dae.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.color.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},JL=dae;JL.Nodes=function(){return{customColor:new _t(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var hae=class extends Ii{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let r=e.include(hae.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let i=[];return i.push(this.cnormal.build(e,"v3")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},fae=hae;fae.Nodes=function(){return{customNormal:new _t(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var Ew=class extends Ii{constructor(e,t,r,i,n,s,a,o,l,c,u,d){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=r,this.projection=i,this.axis=n,this.side=s,this.size=a,this.blending=o,this.mat=l,this.isMask=d,this.alpha=c,this.mode=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let r=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=e.include(Ew.Nodes.cylindrical);break;case 2:i=e.include(Ew.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],a=["zy","xz","xy"][this.axis.value],o=new _t(`
		vec3 ${r}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${a})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);i=e.include(o);break;case 4:i=e.include(Ew.Nodes.triplanar);break;default:i=e.include(Ew.Nodes.uv);break}e.addFragmentVariable(this.calpha,"float");let n=[];if(n.push("normal"),n.push(this.texture.generate(e,"t")),n.push(this.textureSize.build(e,"v2")),n.push(this.crop.build(e,"f")),n.push(this.mat.build(e,"mat3")),n.push(this.size.build(e,"v2")),n.push(this.blending.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),this.projection.value===4){let s=`${r}_writeUvs`,a=s+"0",o=s+"1",l=s+"2",c=`${r}_triplanarWeights`;e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(l,"vec2"),e.addFragmentVariable(c,"vec3"),n.push(a),n.push(o),n.push(l),n.push(c)}else{let s=`${r}_writeUvs`;e.addFragmentVariable(s,"vec2"),n.push(s)}return e.format(i+"("+n.join(",")+")",this.getType(e),t)}},FB=Ew;FB.Nodes=function(){let e=new _t(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new _t(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),r=new _t(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),i=new _t(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:r,triplanar:i}}();var Aw=class extends Ii{constructor(e,t,r,i,n,s,a,o,l,c,u,d){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=r,this.far=i,this.isVector=n,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=c,this.isMask=d,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`,i=new _t(`vec3 ${r}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${r}_MAX_COLORS], float steps[${r}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${r}_IS_VECTOR
                   #ifdef ${r}_LINEAR
                       #ifdef ${r}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${r}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${r}_SMOOTH
				for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[Aw.Nodes.vectorLinearWorldSpaceDepth,Aw.Nodes.vectorLinearObjectSpaceDepth,Aw.Nodes.vectorSphericalObjectSpaceDepth,Aw.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${r}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${r}_SMOOTH`),this.isVector.value>.5&&e.define(`${r}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${r}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${r}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let n=e.include(i),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(n+"("+s.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},pae=Aw;pae.Nodes=function(){let e=new _t(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new _t(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),r=new _t(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new _t(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:r,vectorSphericalObjectSpaceDepth:i}}();var a6e=class extends Ii{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=r,this.intensity=i,this.factor=n,this.isMask=o,this.alpha=s,this.mode=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=new _t(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),i=e.include(r),n=[];return n.push(this.color.build(e,"c")),n.push(this.bias.build(e,"f")),n.push(this.scale.build(e,"f")),n.push(this.intensity.build(e,"f")),n.push(this.factor.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},mae=class extends Ii{constructor(e,t,r,i,n,s,a,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=r,this.steps=i,this.offset=n,this.morph=s,this.angle=a,this.isMask=l,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(mae.Nodes.gradient),i=[];return i.push(this.gradientType.build(e,"i")),i.push(this.smooth.build(e,"b")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.offset.build(e,"v2")),i.push(this.morph.build(e,"v2")),i.push(this.angle.build(e,"f")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},gae=mae;gae.Nodes=function(){return{gradient:new _t(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var vae=class extends Ii{constructor(e,t,r,i,n){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=i,this.alpha=t,this.mode=r,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`,this.rotation=n}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=e.include(vae.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let i=[];return i.push(this.texture.generate(e,"t")),i.push("normal"),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),i.push(this.rotation.build(e,"f")),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},yae=vae;yae.Nodes=function(){return{matcap:new _t(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha, float rotation) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) );
					uv = mat2( cos(rotation), sin(rotation), -sin(rotation), cos(rotation) ) * uv;
					uv = uv * 0.495 + 0.5;
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var Eo=function(){let e=new _t(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new _t(`float simplexFast(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 mediump vec3 x = p - s + dot(s, vec3(G3));
			 mediump vec3 hs = s;
			 
			 mediump vec3 e = step(vec3(0.0), x - x.yzx);
			 mediump vec3 i1 = e*(1.0 - e.zxy);
			 mediump vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 mediump vec3 x1 = x - i1 + G3;
			 mediump vec3 x2 = x - i2 + 2.0*G3;
			 mediump vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 mediump vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(hs), x);
			 d.y = dot(random3(hs + i1), x1);
			 d.z = dot(random3(hs + i2), x2);
			 d.w = dot(random3(hs + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new bi("float F3 0.3333333"),t.keywords.G3=new bi("float G3 0.1666667");let r=new _t(`float simplexPrecise(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);r.keywords.F3=new bi("float F3 0.3333333"),r.keywords.G3=new bi("float G3 0.1666667");let i=new _t(`float simplexFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplexFast(m * rot1)
				 + 0.2666667 * simplexFast(2.0 * m * rot2)
				 + 0.1333333 * simplexFast(4.0 * m * rot3)
				 + 0.0666667 * simplexFast(8.0 * m);
		}`,[t]),n=new _t("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),s=new _t("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),a=new _t(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[n,s]),o=new _t("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),l=new _t("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),c=new _t(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[l]),u=new _t(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[c]);u.keywords.NUM_OCTAVES=new bi("int NUM_OCTAVES 5");let d=new _t("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),f=new _t(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[n,s,d]),m=new _t(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),v=new _t(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),y=new _t(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),x=new _t(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),w=new _t(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),_=new _t(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),S=new _t(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			// Second pass for edge distance  
			// skip for styles don't need
			if (style != 0 &&  style != 5 && style != 7)
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[m,v,y,x,w,_]);return{simplexFast:t,simplexPrecise:r,simplexFractal:i,simplexAshima:a,fbm:u,perlin:f,voronoi:S}}(),xae=class extends Ii{constructor(e,t,r,i,n,s,a,o,l,c,u,d,f,m,v,y,x,w,_){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=r,this.fA=i,this.fB=n,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=c,this.noiseType=d,this.voronoiStyle=m,this.highCut=v,this.lowCut=y,this.smoothness=x,this.seed=w,this.quality=_,this.isMask=f,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,r,i,n){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=["simplexFast","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseType.value],a=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,o=new _t(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${a}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[Eo.simplexFast,Eo.simplexFractal,Eo.simplexAshima,Eo.fbm,Eo.perlin,Eo.voronoi]),l=e.include(o),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};xae.numOctaves=5;var bae=class extends Ii{constructor(e,t,r,i,n,s,a,o,l,c,u,d,f,m,v,y){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=r,this.contourWidth=i,this.contourThreshold=n,this.outlineThreshold=s,this.contourFrequency=a,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=c,this.compensation=u,this.resolution=d,this.normalMap=f,this.depthMap=m,this.pixelRatio=v,this.alpha=y,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${r}_offset`),this.firstTime){let i=this.outlineWidth.build(e,"f"),n=this.resolution.build(e,"v2"),s=this.compensation.build(e,"b"),a=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(i,"uniform float"),e.addVertexParsVariable(n,"uniform vec2"),e.addVertexParsVariable(s,"uniform bool"),e.addVertexParsVariable(a,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${r}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${r}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${r}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${r}_offset = normalize(${r}_clipNormal.xy) / ${n} * (${i} / 2.0) * ${r}_clipPosition.w * 2.0 * ${a};
                    ${r}_clipPosition.xy += ${r}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${r}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(bae.Nodes.outline),n=[];return n.push(this.outlineColor.build(e,"c")),n.push(this.contourColor.build(e,"c")),n.push(this.outlineWidth.build(e,"f")),n.push(this.contourWidth.build(e,"f")),n.push(this.contourThreshold.build(e,"f")),n.push(this.outlineThreshold.build(e,"f")),n.push(this.contourFrequency.build(e,"f")),n.push(this.outlineSmoothing.build(e,"f")),n.push(this.contourDirection.build(e,"v3")),n.push(this.positionalLines.build(e,"b")),n.push(this.resolution.build(e,"v2")),n.push(this.normalMap.getTexture(e,"t")),n.push(this.depthMap.getTexture(e,"t")),n.push(this.pixelRatio.build(e,"f")),n.push(this.compensation.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},wae=bae;wae.Nodes=function(){let e=new _t(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new _t(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var th=class extends Ii{constructor(e,t,r,i,n,s,a,o,l,c,u,d,f,m,v,y,x,w){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=r,this.blending=i,this.offset=n,this.colorA=s,this.colorB=a,this.frequency=o,this.size=l,this.variation=c,this.smoothness=u,this.zigzag=d,this.rotation=f,this.vertical=m,this.horizontal=v,this.sides=y,this.isMask=w,this.alpha=x,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let r;switch(this.style.value){case 0:r="circle";break;case 1:r="ring";break;case 2:r="polygon";break;case 3:r="xcross";break;case 4:r="diamond";break;case 5:r="checkerboard";break;case 6:r="line";break;case 7:r="wave";break;default:r="circle";break}let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new _t(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new _t(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),a="";if(this.projection.value===4){let u=this.style.value===2?`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,f=this.style.value===2?`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;a=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${u};
				float d1 = ${d};
				float d2 = ${f};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let u=this.style.value===2?`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${r}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d="";this.axis.value===0?d=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?d=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,d=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let f="";switch(this.projection.value){case 0:f="custom_uv = vUv.st;";break;case 1:break;case 2:f=`
							vec3 p = position;
							${d}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}a=`
				vec2 custom_uv;
				${f}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${u};
				`}let o=new _t(`vec3 ${i}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${a}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,n,th.DrawFunctions.circle,th.DrawFunctions.ring,th.DrawFunctions.polygon,th.DrawFunctions.cross,th.DrawFunctions.diamond,th.DrawFunctions.checkerboard,th.DrawFunctions.line,th.DrawFunctions.wave]),l=e.include(o),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}else return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},_ae=th;_ae.DrawFunctions=function(){let e=new _t(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new _t(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),r=new _t(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),i=new _t(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),n=new _t(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),s=new _t(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),a=new _t(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),o=new _t(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new _t(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),c=new _t(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:r,ring:i,polygon:n,cross:s,diamond:a,checkerboard:o,line:l,wave:c}}();var Sae=class extends Ii{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=r,this.noiseStrength=i,this.noiseScale=n,this.offset=s,this.isMask=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(Sae.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(e,"f")),i.push(this.movement.build(e,"f")),i.push(this.wavelengths.build(e,"v3")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.offset.build(e,"v3")),i.push(this.isMask.build(e,"b")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Eae=Sae;Eae.Nodes=function(){let e=new _t(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
				float f = 0.0;
				
				if (noiseStrength != 0.0) {
					vec3 st = position / noiseScale;
					float noise = simplexFast(1.6 * st + vec3(1.8, 1.5, 1.9) * simplexFast(st) + vec3(1.7, 9.2, 1.0));
					f = noise * noiseStrength;
				}

				vec3 waves = wavelengths * vec3(1.0, 0.8, 0.6) + 1.0;
				float angle = dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal));

				mediump vec3 color = cos((((filmThickness + f) / waves) * angle) + movement);
				return .5 + .5 * color;
			 }`,[Eo.simplexFast]);return{rainbow:new _t(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				mediump vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
			 }`,[e])}}();var Aae=class extends Ii{constructor(e,t,r,i,n,s,a,o,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=r,this.source=i,this.isWorldSpace=n,this.noiseStrength=s,this.noiseScale=a,this.shadowColor=o,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let r=e.include(Aae.Nodes.toon),i=[];return i.push(this.positioning.build(e,"i")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.source.build(e,"v3")),i.push(this.isWorldSpace.build(e,"b")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.shadowColor.build(e,"v4")),i.push(this.offset.build(e,"v3")),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Cae=Aae;Cae.Nodes=function(){let e=new _t(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new _t(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),r=new _t(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),i=new _t(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),n=new _t(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new _t(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplexFast(st),
					// 	simplexFast(st + vec3(111.1, 143.89, 217.19)),
					// 	simplexFast(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[Eo.simplexFast,e,r,n])}}();var o6e=function(){return{textureBicubic:new _t(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function l6e(e,t){return e>=t?new ge(t/e,1):new ge(1,e/t)}var Tae=class extends Ii{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=r,this.transmissionSamplerSize=i,this.transmissionSamplerMap=n,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,rr.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let r=e.include(Tae.Nodes.transmission),i=[];return i.push(this.thickness.build(e,"f")),i.push(this.ior.build(e,"f")),i.push(this.roughness.build(e,"f")),i.push(this.transmissionSamplerSize.build(e,"v2")),i.push(this.transmissionSamplerMap.getTexture(e,"t")),i.push(this.transmissionDepthMap.getTexture(e,"t")),i.push(this.aspectRatio.build(e,"v2")),i.push("normal"),i.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Mae=Tae;Mae.Nodes=function(){let e=new _t(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),t=new _t(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),r=new _t(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),i=new _t(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[o6e.textureBicubic,r,e]),n=new _t(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[i,t]);return{transmission:new _t(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[n])}}();var e5=(e=>(e.NOISE="noise",e.MAP="map",e))(e5||{}),Pae=class extends Ii{constructor(e,t,r,i,n,s,a,o,l,c,u){super("v3"),this.displacementTypeIndex=new Fi(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(e5)[this.displacementTypeIndex.value]==="map"&&(this.mat=new uae(this.movementOrTexture.value.matrix)),this.cropOrOffset=r,this.scale=c,this.noiseFunctionIndex=u,this.voronoiStyle=i,this.smoothness=n,this.seed=s,this.highCut=a,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let r,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(e5)[this.displacementTypeIndex.value]){case"map":{r=e.include(Pae.Nodes.map),i.push(this.movementOrTexture.getTexture(e,"t")),i.push("uv"),i.push(this.cropOrOffset.build(e,"f")),this.mat&&i.push(this.mat.build(e,"mat3"));break}case"noise":{let n=["simplexPrecise","simplexFractal","simplexAshima","fbm","perlin","voronoi"][this.noiseFunctionIndex.value],s=new _t(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),a=n=="voronoi"?`
					float v = ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,o=new _t(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${a}
						}`,[Eo.simplexPrecise,Eo.simplexFractal,Eo.simplexAshima,Eo.fbm,Eo.perlin,Eo.voronoi]),l=new _t(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,s]);r=e.include(l),i.push(this.scale.build(e,"f")),i.push(this.cropOrOffset.build(e,"v3")),i.push(this.movementOrTexture.build(e,"f")),i.push(this.voronoiStyle.build(e,"i")),i.push(this.smoothness.build(e,"f")),i.push(this.seed.build(e,"f")),i.push(this.highCut.build(e,"f")),i.push(this.lowCut.build(e,"f")),i.push(this.quality.build(e,"i"));break}}return i.push(this.intensity.build(e,"f")),i.push("displaced_normal"),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},Dae=Pae;Dae.Nodes=function(){let e=new _t(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new _t(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new _t(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var rr={normalRenderTarget:new ch,normalRenderTargetDepth:new ch,transmissionRenderTarget:new ch,aspectRatio:new ca,transmissionSize:new ca(2048,2048),transmissionRenderTargetDepth:new ch,aoRenderTarget:new ch,aoEnabled:new io,pixelRatioNode:new Pt(1),resolution:new ca,penumbraSize:new Qm(5,.5),frameIndex:new Fi(0),transmissionLod:new Fi(2)};for(let e of Object.values(rr))e.isRenderGlobal=!0;var Nae={skiaWasmUrl:"https://unpkg.com/@splinetool/ui-wasm@1.10.37/build/ui.wasm"},VB=class extends Ss{constructor(){super("basic"),this.nodeType="Basic",this.color=new Dn(ul),this.shadingAlpha=new Pt(1),this.shadingBlend=new Fi(0),this.previousModelViewMatrix=new id,this.previouseProjectionMatrix=new id}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:rr.frameIndex}),e.mergeUniform({resolution:rr.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(qx.merge([bt.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{this.color===void 0&&(this.color=new Dn(ul)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let r=this.color.flow(e,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(e,"f"):void 0,n=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=i!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let a=["#include <normal_fragment_begin>",r.code];i&&a.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),s?a.push(s.code,`vec3 outgoingLight = ${r.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):a.push(`vec3 finalColor = ${r.result};`);let o="1.0";this.mask&&(this.mask.analyze(e),o=`luminance(${this.mask.flow(e,"v3").result})`),i?a.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} * ${o} );`):a.push("gl_FragColor = vec4("+r.result+", 1.0 );"),n&&a.push(`gl_FragColor.a *= ${n.result};`),a.push("#include <fog_fragment>","#include <dithering_fragment>"),t=a.join(`
`)}return t}},c6e=class extends Ss{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Dn(ul),this.emissive=new Dn(0),this.emissiveIntensity=new Pt(1),this.previousModelViewMatrix=new id,this.previouseProjectionMatrix=new id,this.shadingAlpha=new Pt(1),this.shadingBlend=new Fi(0),this.occlusion=new io(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:rr.frameIndex}),e.mergeUniform({resolution:rr.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(qx.merge([bt.fog,bt.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),i.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:rr.penumbraSize}),e.mergeUniform({frameIndex:rr.frameIndex}),e.mergeUniform({aoMap:rr.aoRenderTarget}),e.mergeUniform({aoEnabled:rr.aoEnabled}),this.color===void 0&&(this.color=new Dn(ul)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.emissive.flow(e,"c",{slot:"emissive"}),n=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let d=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];d.push(r.code,"vec3 diffuseColor = "+r.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&d.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),d.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&d.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+n.result+";"),d.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let f="1.0";this.mask&&(this.mask.analyze(e),f=`luminance(${this.mask.flow(e,"v3").result})`),d.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${f} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${f}, ${o.result} );

					outgoingLight *= ao;
				}
				`),l&&d.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&d.push(`gl_FragColor.a *= ${u.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=d.join(`
`)}return t}},yx=function(){let e=new _t(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),t=new _t(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:e,perturbNormalArb:t}}(),u6e=class extends Ss{constructor(){super("phong"),this.nodeType="Phong",this.color=new Dn(ul),this.specular=new Dn(1118481),this.shininess=new Pt(30),this.previousModelViewMatrix=new id,this.previouseProjectionMatrix=new id,this.shadingAlpha=new Pt(1),this.shadingBlend=new Fi(0),this.occlusion=new io(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:rr.frameIndex}),e.mergeUniform({resolution:rr.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(qx.merge([bt.fog,bt.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:rr.penumbraSize}),e.mergeUniform({frameIndex:rr.frameIndex}),e.mergeUniform({aoMap:rr.aoRenderTarget}),e.mergeUniform({aoEnabled:rr.aoEnabled}),this.color===void 0&&(this.color=new Dn(ul)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let r=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let d=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){e.include(yx.dHdxy),e.include(yx.perturbNormalArb);let m=this.bumpMap.texture.flow(e,"t"),v=this.bumpMap.flow(e,"v3"),y=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",x="";this.bumpMap.projection.value===4?x=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${m.result}, uv0, ${y});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${m.result}, uv1, ${y});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${m.result}, uv2, ${y});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:x=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${m.result}, bumpMapCachedUv, ${y});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,d.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${v.result};
					${x}
					`)}d.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",n.code,"	vec3 specular = "+n.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),c&&d.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),d.push("material.diffuseColor = diffuseColor;"),d.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),d.push("vec3 ao = aoEnabled && "+r.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let f="1.0";this.mask&&(this.mask.analyze(e),f=`luminance(${this.mask.flow(e,"v3").result})`),d.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${f} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${f}, ${o.result} );
					
					outgoingLight *= ao;
				}
				`),l&&d.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?d.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):d.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&d.push(`gl_FragColor.a *= ${u.result};`),d.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=d.join(`
`)}return t}},d6e=class extends Ss{constructor(){super("standard"),this.nodeType="Standard",this.color=new Dn(ul),this.roughness=new Pt(.3),this.metalness=new Pt(0),this.reflectivity=new Pt(.5),this.previousModelViewMatrix=new id,this.previouseProjectionMatrix=new id,this.shadingAlpha=new Pt(1),this.shadingBlend=new Fi(0),this.occlusion=new io(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:rr.frameIndex}),e.mergeUniform({resolution:rr.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(qx.merge([bt.fog,bt.lights])),bt.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:rr.penumbraSize}),e.mergeUniform({frameIndex:rr.frameIndex}),e.mergeUniform({aoMap:rr.aoRenderTarget}),e.mergeUniform({aoEnabled:rr.aoEnabled});let r={gamma:!0};this.color===void 0&&(this.color=new Dn(ul)),this.color.analyze(e,{slot:"color",context:r}),this.roughness.analyze(e),this.metalness.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let n=this.color.flow(e,"c",{slot:"color",context:r}),s=this.roughness.flow(e,"f"),a=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,d=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,f=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=u!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let m=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(yx.dHdxy),e.include(yx.perturbNormalArb);let y=this.bumpMap.texture.flow(e,"t"),x=this.bumpMap.flow(e,"v3"),w=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",_="";this.bumpMap.projection.value===4?_=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${y.result}, uv0, ${w});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${y.result}, uv1, ${w});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${y.result}, uv2, ${w});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:_=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${y.result}, bumpMapCachedUv, ${w});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,m.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${x.result};
					${_}
					`)}if(m.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",a.code,"	float metalnessFactor = "+a.result+";"),this.roughnessMap){let y=this.roughnessMap.texture.flow(e,"t"),x=this.roughnessMap.flow(e,"v3"),w="";this.roughnessMap.projection.value===4?w=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${y.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${y.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${y.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:w=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${y.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,m.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${x.result};

					const float roughnessScale = 1.0;

					${w}
				`)}else m.push(s.code,"	float roughnessFactor = "+s.result+";");u&&m.push(u.code,"#ifdef ALPHATEST","	if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),m.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),m.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),f?m.push(f.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+f.result+" ) ), diffuseColor, metalnessFactor );"):m.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),m.push("#include <lights_fragment_begin>"),m.push("#include <lights_fragment_end>"),m.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let v="1.0";this.mask&&(this.mask.analyze(e),v=`luminance(${this.mask.flow(e,"v3").result})`),m.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${v} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${v}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&m.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),u?m.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result} );`):m.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),d&&m.push(`gl_FragColor.a *= ${d.result};`),m.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=m.join(`
`)}return t}},h6e=class extends Ss{constructor(){super("toon"),this.nodeType="Toon",this.color=new Dn(ul),this.specular=new Dn(1118481),this.shininess=new Pt(30),this.previousModelViewMatrix=new id,this.previouseProjectionMatrix=new id,this.shadingAlpha=new Pt(1),this.shadingBlend=new Fi(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:rr.frameIndex}),e.mergeUniform({resolution:rr.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(qx.merge([bt.fog,bt.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <morphtarget_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>","#include <morphnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","#include <morphtarget_vertex>","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:rr.penumbraSize}),e.mergeUniform({frameIndex:rr.frameIndex}),e.mergeUniform({aoMap:rr.aoRenderTarget}),e.mergeUniform({aoEnabled:rr.aoEnabled}),this.color===void 0&&(this.color=new Dn(ul)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),n=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){e.include(yx.dHdxy),e.include(yx.perturbNormalArb);let f=this.bumpMap.texture.flow(e,"t"),m=this.bumpMap.flow(e,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${f.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${f.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${f.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${f.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};
					${y}
					`)}u.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&u.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${d}, ${a.result} );
				}
				`),o&&u.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&u.push(`gl_FragColor.a *= ${c.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join(`
`)}return t}},f6e=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){return this.cache.get(e)?.data}load(e){let t=Date.now(),r=this.cache.get(e);return r===void 0?(r={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,r)):(r.time=t,r.prev.next=r.next,r.next.prev=r.prev),r.prev=this.tail.prev,r.next=this.tail,this.tail.prev.next=r,this.tail.prev=r,this.scheduleCleanup(),r.data}},p6e=class extends f6e{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},V4;function m6e(e){return typeof e=="string"?e:(V4||(V4=new p6e),V4.load(e))}var g6e=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},v6e=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},kae=class extends g6e{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isBuffer=!1,this._cache={1e3:{},1001:{},1002:{}},this.isVideo=e.type==="video",this.isBuffer=e.isWebGLRenderTarget===!0,this.loadPromise=this.updateSrc(this.isBuffer?e:e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;for(let i of Object.values(this._cache))for(let n of Object.values(i))for(let s of Object.values(n))s&&(s.image=this.img,s.needsUpdate=!0);this.shared.requestRender()};if(this.isBuffer)this.img=e,this.loaded=!0;else if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var r=new FileReader;r.readAsDataURL(new Blob([e],{type:"video/mp4"}));let i;await new Promise(n=>{r.onloadend=s=>{i=s.target?.result,n(null)}}),this.img.src=i}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=m6e(e),this.img.onload=t,await new Promise(i=>{this.img.onload=()=>{t(),i(null)}})}getTexture(e,t=1008,r=1006){let i=this._cache[e]?.[t]?.[r];if(i)return i;{let n;return this.isBuffer?n=this.img.texture:this.isVideo?n=new ZCe(this.img,void 0,e,e):n=new yn(this.img,void 0,e,e,r,t),this.loaded&&(n.needsUpdate=!0),this._cache[e]===void 0&&(this._cache[e]={}),this._cache[e][t]===void 0&&(this._cache[e][t]={}),this._cache[e][t][r]=n,n}}setNeedsUpdate(e){for(let t of Object.values(this._cache))for(let r of Object.values(t))for(let i of Object.values(r))i&&(i.needsUpdate=e)}disposeTextures(){for(let[e,t]of Object.entries(this._cache))for(let[r,i]of Object.entries(t))for(let[n,s]of Object.entries(i))s?.dispose(),this._cache[e]!==void 0&&this._cache[e][r]!==void 0&&(this._cache[e][r][n]=void 0)}dispose(){super.dispose(),this.disposeTextures()}},tp=class extends kae{};function y6e(e,t){var r=_6e(t);return r.formatToParts?b6e(r,e):w6e(r,e)}var x6e={year:0,month:1,day:2,hour:3,minute:4,second:5};function b6e(e,t){try{for(var r=e.formatToParts(t),i=[],n=0;n<r.length;n++){var s=x6e[r[n].type];s>=0&&(i[s]=parseInt(r[n].value,10))}return i}catch(a){if(a instanceof RangeError)return[NaN];throw a}}function w6e(e,t){var r=e.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(r);return[i[3],i[1],i[2],i[4],i[5],i[6]]}var U4={};function _6e(e){if(!U4[e]){var t=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:"America/New_York",year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),r=t==="06/25/2014, 00:00:00"||t==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";U4[e]=r?new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:e,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}return U4[e]}function Rae(e,t,r,i,n,s,a){var o=new Date(0);return o.setUTCFullYear(e,t,r),o.setUTCHours(i,n,s,a),o}var XY=36e5,S6e=6e4,H4={timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-]\d{2}):?(\d{2})$/};function Iae(e,t,r){var i,n;if(!e||(i=H4.timezoneZ.exec(e),i))return 0;var s;if(i=H4.timezoneHH.exec(e),i)return s=parseInt(i[1],10),$Y(s)?-(s*XY):NaN;if(i=H4.timezoneHHMM.exec(e),i){s=parseInt(i[1],10);var a=parseInt(i[2],10);return $Y(s,a)?(n=Math.abs(s)*XY+a*S6e,s>0?-n:n):NaN}if(C6e(e)){t=new Date(t||Date.now());var o=r?t:E6e(t),l=t5(o,e),c=r?l:A6e(t,l,e);return-c}return NaN}function E6e(e){return Rae(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function t5(e,t){var r=y6e(e,t),i=Rae(r[0],r[1]-1,r[2],r[3]%24,r[4],r[5],0).getTime(),n=e.getTime(),s=n%1e3;return n-=s>=0?s:1e3+s,i-n}function A6e(e,t,r){var i=e.getTime(),n=i-t,s=t5(new Date(n),r);if(t===s)return t;n-=s-t;var a=t5(new Date(n),r);return s===a?s:Math.max(s,a)}function $Y(e,t){return-23<=e&&e<=23&&(t==null||0<=t&&t<=59)}var KY={};function C6e(e){if(KY[e])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:e}),KY[e]=!0,!0}catch{return!1}}var T6e=Jp(Fwe(),1),QY=Jp(Vwe(),1),M6e=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,P6e=M6e,G4=36e5,ZY=6e4,D6e=2,no={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:P6e};function N6e(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(e===null)return new Date(NaN);var r={},i=r.additionalDigits==null?D6e:(0,T6e.default)(r.additionalDigits);if(i!==2&&i!==1&&i!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]")return new Date(e.getTime());if(typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]")return new Date(e);if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var n=k6e(e),s=R6e(n.date,i),a=s.year,o=s.restDateString,l=I6e(o,a);if(isNaN(l))return new Date(NaN);if(l){var c=l.getTime(),u=0,d;if(n.time&&(u=O6e(n.time),isNaN(u)))return new Date(NaN);if(n.timeZone||r.timeZone){if(d=Iae(n.timeZone||r.timeZone,new Date(c+u)),isNaN(d))return new Date(NaN)}else d=(0,QY.default)(new Date(c+u)),d=(0,QY.default)(new Date(c+u+d));return new Date(c+u+d)}else return new Date(NaN)}function k6e(e){var t={},r=no.dateTimePattern.exec(e),i;if(r?(t.date=r[1],i=r[3]):(r=no.datePattern.exec(e),r?(t.date=r[1],i=r[2]):(t.date=null,i=e)),i){var n=no.timeZone.exec(i);n?(t.time=i.replace(n[1],""),t.timeZone=n[1].trim()):t.time=i}return t}function R6e(e,t){var r=no.YYY[t],i=no.YYYYY[t],n;if(n=no.YYYY.exec(e)||i.exec(e),n){var s=n[1];return{year:parseInt(s,10),restDateString:e.slice(s.length)}}if(n=no.YY.exec(e)||r.exec(e),n){var a=n[1];return{year:parseInt(a,10)*100,restDateString:e.slice(a.length)}}return{year:null}}function I6e(e,t){if(t===null)return null;var r,i,n,s;if(e.length===0)return i=new Date(0),i.setUTCFullYear(t),i;if(r=no.MM.exec(e),r)return i=new Date(0),n=parseInt(r[1],10)-1,eX(t,n)?(i.setUTCFullYear(t,n),i):new Date(NaN);if(r=no.DDD.exec(e),r){i=new Date(0);var a=parseInt(r[1],10);return z6e(t,a)?(i.setUTCFullYear(t,0,a),i):new Date(NaN)}if(r=no.MMDD.exec(e),r){i=new Date(0),n=parseInt(r[1],10)-1;var o=parseInt(r[2],10);return eX(t,n,o)?(i.setUTCFullYear(t,n,o),i):new Date(NaN)}if(r=no.Www.exec(e),r)return s=parseInt(r[1],10)-1,tX(t,s)?JY(t,s):new Date(NaN);if(r=no.WwwD.exec(e),r){s=parseInt(r[1],10)-1;var l=parseInt(r[2],10)-1;return tX(t,s,l)?JY(t,s,l):new Date(NaN)}return null}function O6e(e){var t,r,i;if(t=no.HH.exec(e),t)return r=parseFloat(t[1].replace(",",".")),W4(r)?r%24*G4:NaN;if(t=no.HHMM.exec(e),t)return r=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),W4(r,i)?r%24*G4+i*ZY:NaN;if(t=no.HHMMSS.exec(e),t){r=parseInt(t[1],10),i=parseInt(t[2],10);var n=parseFloat(t[3].replace(",","."));return W4(r,i,n)?r%24*G4+i*ZY+n*1e3:NaN}return null}function JY(e,t,r){t=t||0,r=r||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var n=i.getUTCDay()||7,s=t*7+r+1-n;return i.setUTCDate(i.getUTCDate()+s),i}var j6e=[31,28,31,30,31,30,31,31,30,31,30,31],L6e=[31,29,31,30,31,30,31,31,30,31,30,31];function Oae(e){return e%400===0||e%4===0&&e%100!==0}function eX(e,t,r){if(t<0||t>11)return!1;if(r!=null){if(r<1)return!1;var i=Oae(e);if(i&&r>L6e[t]||!i&&r>j6e[t])return!1}return!0}function z6e(e,t){if(t<1)return!1;var r=Oae(e);return!(r&&t>366||!r&&t>365)}function tX(e,t,r){return!(t<0||t>52||r!=null&&(r<0||r>6))}function W4(e,t,r){return!(e!=null&&(e<0||e>=25)||t!=null&&(t<0||t>=60)||r!=null&&(r<0||r>=60))}function B6e(e,t,r){var i=N6e(e,r),n=Iae(t,i,!0),s=new Date(i.getTime()-n),a=new Date(0);return a.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),a.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),a}function oo(e,t){return t.color(e)}function rX(e=new Date,t){let r=t.format,i=e.getSeconds(),n=e;t&&t.timeZone!==null&&(n=B6e(new Date,t.timeZone));let s=n.getHours(),a=n.getMinutes(),o;t.format12h24h==="12ampm"&&(o=s>=12?"PM":"AM");let l=s;t.format12h24h!=="24"&&(l=s%12,l===0&&(l=12));let c,u;switch(r){case"HH:mm:ss":c=[l,a,i];break;case"HH:mm":c=[l,a];break;case"HH":c=[l],o=void 0;break;case"mm":c=[a],o=void 0;break;case"ss":c=[i],o=void 0;break;case"year":u=n.getFullYear();break;case"month":u=n.getMonth()+1;break;case"dayOfYear":u=Math.floor((n.getTime()-new Date(n.getFullYear(),0,0).getTime())/864e5);break;case"dayOfMonth":u=n.getDate();break;case"secondOfDay":u=s*60*60+a*60+i;break;default:console.error("Unknown time format",r),u=0;break}return c!==void 0?{textValue:c,suffix:o}:u}function F6e(e,t){switch(e.type){case"fresnel":return H6e(e,t);case"gradient":return G6e(e,t);case"depth":return W6e(e,t);case"normal":return q6e(e,t);case"noise":return Y6e(e,t);case"rainbow":return X6e(e,t);case"toon":return $6e(e,t);case"outline":return K6e(e,t);case"transmission":return Q6e(e,t);case"color":return U6e(e,t);case"pattern":return Z6e(e,t)}}function V6e(e){return{type:e.type}}function Xc(e,t){let{alpha:r,mode:i,isMask:n}=e,s=typeof r=="string"?(Number(t.getVariable(r))??100)/100:r;return{...V6e(e),alpha:s,mode:i,isMask:n}}function U6e(e,t){return{...Xc(e,t),color:oo(e.color,t)}}function H6e(e,t){let{bias:r,scale:i,intensity:n,factor:s,color:a}=e;return{...Xc(e,t),color:oo(a,t),bias:r,scale:i,intensity:n,factor:s}}function G6e(e,t){let{gradientType:r,smooth:i,colors:n,steps:s,angle:a,offset:o,morph:l}=e;return{...Xc(e,t),gradientType:r,smooth:i,colors:n.map(c=>new fr(c[0],c[1],c[2],c[3])),num:n.length,steps:s,offset:new ge(...o),morph:new ge(...l),angle:a}}function W6e(e,t){let{gradientType:r,near:i,far:n,isVector:s,isWorldSpace:a,origin:o,direction:l,colors:c,steps:u,smooth:d}=e;return{...Xc(e,t),gradientType:r,near:i,far:n,isVector:s,isWorldSpace:a,origin:new V(...o),direction:l?new V(...l):new V(1,0,0),colors:c.map(f=>f!==void 0?new fr(f[0],f[1],f[2],f[3]):new fr(0,0,0,0)),steps:u.slice(0,c.length),smooth:d}}function q6e(e,t){let{cnormal:r}=e;return{...Xc(e,t),cnormal:new V(r[0],r[1],r[2])}}function Y6e(e,t){return{...Xc(e,t),scale:e.scale,move:e.move,fA:new ge(...e.fA),fB:new ge(...e.fB),size:new V(...e.size),distortion:new ge(...e.distortion),colorA:oo(e.colorA,t),colorB:oo(e.colorB,t),colorC:oo(e.colorC,t),colorD:oo(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function X6e(e,t){return{...Xc(e,t),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new V(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new V(...e.offset)}}function $6e(e,t){return{...Xc(e,t),positioning:e.positioning,colors:e.colors.map(r=>new fr(r[0],r[1],r[2],r[3])),num:e.colors.length,steps:e.steps,source:new V(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:oo(e.shadowColor,t),offset:new V(...e.offset)}}function K6e(e,t){return{...Xc(e,t),outlineColor:oo(e.outlineColor,t),contourColor:oo(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new V(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function Q6e(e,t){return{...Xc(e,t),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function Z6e(e,t){return{...Xc(e,t),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new ge(...e.offset),colorA:oo(e.colorA,t),colorB:oo(e.colorB,t),frequency:new ge(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new ge(...e.vertical),horizontal:new ge(...e.horizontal),sides:e.sides}}var XM=class extends xa{},J6e={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},eBe={depth:["colors"]};function tBe(e,t,r){if(t==="isMask")return!0;let i=J6e[e.type],n=eBe[e.type];if(n!==void 0){let s=e.color;if(n.includes(t)){let a=s[t]?.value?.length;if(a!==void 0&&a!==r.length)return!0}}return i!==void 0?i.includes(t):!1}function jae(e,t,r){let i=r.uniforms[`f${r.id}_texture`];if(!i)return!1;let n=!1,s=e;if("image"in s){let a=s.image,o=t.image(a),l=i;l.image instanceof tp||l.image.deref(),l.image=o}if("video"in s){let a=s.video,o=t.video(a),l=i;l.image instanceof tp||l.image.deref(),l.image=o}if("wrapping"in s){let a=i;a.wrap=s.wrapping}if("minFilter"in s){let a=i;a.minFilter=s.minFilter}if("magFilter"in s){let a=i;a.magFilter=s.magFilter}if("rotation"in s&&r.uniforms[`f${r.id}_rotation`])return r.uniforms[`f${r.id}_rotation`].value=(s.rotation??0)*Ct.DEG2RAD,n;if("repeat"in s||"offset"in s||"rotation"in s){let a="mat",o=r.uniforms[`f${r.id}_${a}`];"repeat"in s&&(o.repeat=s.repeat),"offset"in s&&(o.offset=s.offset),"rotation"in s&&(o.rotation=s.rotation??0),o.updateMatrix()}return n}function rBe(e,t,r,i){let n=!1;for(let[s,a]of Object.entries(e)){if(s==="bumpMap"||s==="roughnessMap"){n=!0;continue}if(!s||a===void 0)continue;if(zae(s,r,i,t)){s==="visible"&&r.type==="light"&&(n=!0);continue}r.visible=i.visible;let o=r.uniforms[`f${r.id}_${s}`];if(o&&!(o instanceof BB))switch(n=n||tBe(r,s,a),o.constructor){case Dn:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof XM?o.value=new xa(l.r,l.g,l.b,l.a):o.setRGBA(l);break}case ih:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof XM?o.value=new xa(l.r,l.g,l.b,l.a):o.value.setRGBA(l.r,l.g,l.b,l.a);break}case ca:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]);break}case Nl:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]),o.value.setZ(l[2]);break}case ch:{jae(a,t,r);break}case Zm:{o.value=a.map(l=>new fr(...l));break}default:{o.value=a;break}}}return n}var Xg=(e,t,r)=>Math.max(0,Math.min(1,Number(t.getVariable(typeof e=="number"?e*100:e,r)??100)/100))??1,V_=class{constructor(e,t,r,i,n){this.id=e,this.uuid=t,this.data=r,this.uniforms={};for(let s in i)this.uniforms[`f${this.id}_${s}`]=i[s];for(let s in r)zae(s,this,r,n)}get type(){return this.data.type}static create(e,t,r,i){if(r.type==="light")return Cu.createLightLayer(e,t,r,i);if(r.type==="texture"||r.type==="video"){let n=r.type==="texture"?i.uiBuffer(r.texture.image)??i.image(r.texture.image):i.video(r.texture.video),s=new ZL(n,r.texture.wrapping,r.texture.minFilter??1008,r.texture.magFilter??1006),a=new n6e(n),o=new s6e(r.texture.repeat,r.texture.offset,r.texture.rotation??0),l=new Pt(r.crop?1:0),c=new Fi(r.projection??0),u=new Fi(["x","y","z"].indexOf(r.axis)??0),d=new Fi(r.side??0),f=new ca(r.size?new ge(r.size[0],r.size[1]):new ge(100,100)),m=new Pt(r.blending??0),v=new Pt(Xg(r.alpha,i)),y=new Fi(r.mode??0),x=new io(r.isMask??!1),w=new FB(s,a,l,c,u,d,f,m,o,v,y,x),_=new Ji(w.calpha,"f");return new An(e,t,r,{texture:s,textureSize:a,crop:l,projection:c,axis:u,side:d,size:f,blending:m,mat:o,alpha:v,mode:y,isMask:x},w,y,_,x,i)}else if(r.type==="matcap"){let n=i.image(r.texture.image),s=new ZL(n,r.texture.wrapping,r.texture.minFilter??1008,r.texture.magFilter??1006),a=new Pt(Xg(r.alpha,i)),o=new Fi(r.mode??0),l=new io(r.isMask??!1),c=new Pt((r.texture.rotation??0)*Ct.DEG2RAD),u=new yae(s,a,o,l,c),d=new Ji(u.calpha,"f");return new An(e,t,r,{texture:s,alpha:a,mode:o,isMask:l,rotation:c},u,o,d,l,i)}else if(r.type==="displace")if(r.displacementType==="noise"){let n=new Nl(new V(...r.offset)),s=new Pt(r.scale??10),a=new Pt(r.intensity??8),o=new Pt(r.movement??1),l=new Fi(r.noiseType??0),c=new Fi(r.voronoiStyle??0),u=new Pt(r.smoothness??.5),d=new Pt(r.seed??0),f=new Pt(r.highCut??1),m=new Pt(r.lowCut??0),v=new Fi(r.quality??1),y=new Dae(a,o,n,c,u,d,f,m,v,s,l);return new Lae(e,t,r,{offset:n,scale:s,intensity:a,movement:o,noiseType:l,voronoiStyle:c,smoothness:u,seed:d,highCut:f,lowCut:m,quality:v},y,i)}else throw new Error;else return sBe(e,t,r,i)}updateByOp(e,t,r){let i=e;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props||"visible"in i.props||"noiseType"in i.props?(r.scene.markNeedsUpdateRendererDirty(),!0):rBe(i.props,r.shared,this,t)}else if(i.path[0]==="texture")return"texture"in t||"video"in t?jae(i.props,r.shared,this):!0;return!1}dispose(){if(iBe(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof tp||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let r=`f${this.id}_${e}`;this.hasValueByKey(r)&&t!==void 0&&(this.uniforms[r].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let r=this.getName(t);r&&e.push(r)}return e}},An=class extends V_{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,l),this.params=i,this.color=n,this.mode=s,this.alpha=a,this.isMask=o}},Lae=class extends V_{constructor(e,t,r,i,n,s){super(e,t,r,i,s),this.position=n}},Cu=class extends V_{constructor(e,t,r,i,n,s){super(e,t,r,n,s),this.node=i}static createLightLayer(e,t,r,i){let n,s=new Pt(Xg(r.alpha,i)),a=new Fi(r.mode),o=new Pt(r.bumpMapIntensity),l=new Pt(Xg(r.alphaOverride,i)),c;if(!r.visible)n=new VB,c={};else if(r.category==="lambert"){n=new c6e;let u=new Dn(i.color(r.emissive)??0),d=new io(r.occlusion??!0);c={emissive:u,occlusion:d},n.emissive=u,n.occlusion=d}else if(r.category==="toon"){n=new h6e;let u=new Pt(r.shininess??30),d=new Dn(i.color(r.specular)??1118481);c={shininess:u,specular:d},n.shininess=u,n.specular=d}else if(r.category==="physical"){n=new d6e;let u=new Pt(r.roughness??.3),d=new Pt(r.metalness??0),f=new Pt(r.reflectivity??.5),m=new io(r.occlusion??!0);c={roughness:u,metalness:d,reflectivity:f,occlusion:m},n.roughness=u,n.metalness=d,n.reflectivity=f,n.occlusion=m}else{n=new u6e;let u=new Pt(r.shininess??30),d=new Dn(r.specular!==void 0?i.color(r.specular)??1118481:1118481),f=new io(r.occlusion??!0);c={shininess:u,specular:d,occlusion:f},n.shininess=u,n.specular=d,n.occlusion=f}return n.alpha=new Pt(1),n.shadingAlpha=s,n.shadingBlend=a,n.bumpMapIntensity=o,n.alphaOverride=l,c.alpha=n.shadingAlpha,c.mode=n.shadingBlend,c.bumpMapIntensity=n.bumpMapIntensity,c.alphaOverride=n.alphaOverride,new Cu(e,t,r,n,c,i)}get category(){return this.node.category}};function iBe(e){let t=e instanceof V_?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function Al(e){return{alpha:new Pt(e.alpha??1),mode:new Fi(e.mode??0),isMask:new io(e.isMask??!1)}}function nBe(e,t,r,i,n){switch(e.type){case"color":{let s=new Dn(i.color??ul),a=Al(i),o=new JL(s,a.alpha),l=new Ji(o.calpha,"f");return new An(t,r,e,{color:s,...a},o,a.mode,l,a.isMask,n)}case"fresnel":{let s=new Dn(i.color??16777215),a=new Pt(i.bias??.1),o=new Pt(i.scale??1),l=new Pt(i.intensity??2),c=new Pt(i.factor??1),u=Al(i),d=new a6e(s,a,o,l,c,u.alpha,u.mode,u.isMask),f=new Ji(d.calpha,"f");return new An(t,r,e,{color:s,bias:a,scale:o,intensity:l,factor:c,...u},d,u.mode,f,u.isMask,n)}case"rainbow":{let s=new Pt(i.filmThickness??30),a=new Pt(i.movement??0),o=new Nl(i.wavelengths??new V(0,0,0)),l=new Pt(i.noiseStrength??0),c=new Pt(i.noiseScale??1),u=new Nl(i.offset??new V(0,0,0)),d=Al(i),f=new Eae(s,a,o,l,c,u,d.alpha,d.isMask),m=new Ji(f.calpha,"f");return new An(t,r,e,{filmThickness:s,movement:a,wavelengths:o,noiseStrength:l,noiseScale:c,offset:u,...d},f,d.mode,m,d.isMask,n)}case"transmission":{let s=new Pt(i.thickness??10),a=new Pt(i.ior??1.5),o=new Pt(i.roughness??.5),l=rr.transmissionSize,c=rr.transmissionRenderTarget,u=rr.transmissionRenderTargetDepth,d=window.innerWidth,f=window.innerHeight,m=d>=f?new ca(f/d,1):new ca(1,d/f),v=Al(i),y=new Mae(s,a,o,l,c,u,m,v.alpha),x=new Ji(y.calpha,"f");return new An(t,r,e,{thickness:s,ior:a,roughness:o,aspectRatio:m,...v},y,v.mode,x,v.isMask,n)}case"toon":{let s=new Fi(i.positioning??0),a;i.colors?a=new Zm(i.colors.length,i.colors):(a=new Zm(10,new fr(0,0,0,1)),a.value[1]=new fr(1,1,1,1));let o;i.steps?o=new Qm(i.steps.length,i.steps):(o=new Qm(10,1),o.value[0]=0);let l=new Nl(i.source??new V(0,0,0)),c=new io(i.isWorldSpace??!0),u=new Pt(i.noiseStrength??0),d=new Pt(i.noiseScale??1),f=new ih(i.shadowColor),m=new Nl(i.offset??new V(0,0,0)),v=Al(i),y=new Cae(s,a,o,l,c,u,d,f,m,v.alpha),x=new Ji(y.calpha,"f");return new An(t,r,e,{positioning:s,colors:a,steps:o,source:l,isWorldSpace:c,noiseStrength:u,noiseScale:d,shadowColor:f,offset:m,...v},y,v.mode,x,v.isMask,n)}case"outline":{let s=new Dn(i.outlineColor??16777215),a=new Dn(i.contourColor??16777215),o=new Pt(i.outlineWidth??.1),l=new Pt(i.contourWidth??.1),c=new Pt(i.outlineThreshold??.1),u=new Pt(i.contourThreshold??.1),d=new Pt(i.outlineSmoothing??.1),f=new Pt(i.contourFrequency??.1),m=new Nl(i.contourDirection??new V(0,1,0)),v=new io(i.positionalLines??!1),y=new io(i.compensation??!0),x=rr.normalRenderTarget,w=rr.normalRenderTargetDepth,_=rr.pixelRatioNode,S=rr.resolution,P=Al(i),M=new wae(s,a,o,l,c,u,d,f,m,v,y,S,x,w,_,P.alpha),C=new Ji(M.calpha,"f");return new An(t,r,e,{outlineColor:s,contourColor:a,outlineWidth:o,contourWidth:l,outlineThreshold:c,contourThreshold:u,outlineSmoothing:d,contourFrequency:f,contourDirection:m,positionalLines:v,compensation:y,...P},M,P.mode,C,P.isMask,n)}case"depth":{let s=new Fi(i.gradientType??0),a=new io(i.smooth??!1),o=new Pt(i.near??50),l=new Pt(i.far??200),c=new Pt(i.isVector??1),u=new Pt(i.isWorldSpace??0),d=new Nl(i.origin??new V),f=new Nl(i.direction??new V),m;i.colors?m=new Zm(i.colors.length,i.colors):(m=new Zm(2,new fr(0,0,0,1)),m.value[1]=new fr(1,1,1,1));let v;i.steps?v=new Qm(i.steps.length,i.steps):(v=new Qm(2,1),v.value[0]=0);let y=Al(i),x=new pae(s,a,o,l,c,u,d,f,m,v,y.alpha,y.isMask),w=new Ji(x.calpha,"f");return new An(t,r,e,{gradientType:s,smooth:a,near:o,far:l,isVector:c,isWorldSpace:u,origin:d,direction:f,colors:m,steps:v,...y},x,y.mode,w,y.isMask,n)}case"noise":{let s=new Pt(i.scale??1),a=new Nl(i.size??new V(100,100,100)),o=new Pt(i.move??1),l=new ca(i.fA??new ge(1.7,9.2)),c=new ca(i.fB??new ge(8.3,2.8)),u=new ca(i.distortion??new ge(1,1)),d=new ih(i.colorA),f=new ih(i.colorB),m=new ih(i.colorC),v=new ih(i.colorD),y=new Fi(i.noiseType??0),x=new Fi(i.voronoiStyle??0),w=new Pt(i.highCut??1),_=new Pt(i.lowCut??0),S=new Pt(i.smoothness??.5),P=new Pt(i.seed??.5),M=new Fi(i.quality??1),C=Al(i),T=new xae(s,a,o,l,c,u,d,f,m,v,C.alpha,y,C.isMask,x,w,_,S,P,M),E=new Ji(T.calpha,"f");return new An(t,r,e,{scale:s,size:a,move:o,fA:l,fB:c,distortion:u,colorA:d,colorB:f,colorC:m,colorD:v,noiseType:y,...C,voronoiStyle:x,highCut:w,lowCut:_,smoothness:S,seed:P,quality:M},T,C.mode,E,C.isMask,n)}case"normal":{let s=new Nl(i.cnormal??new V(1,1,1)),a=Al(i),o=new fae(s,a.alpha),l=new Ji(o.calpha,"f");return new An(t,r,e,{cnormal:s,...a},o,a.mode,l,a.isMask,n)}case"gradient":{let s=new Fi(i.gradientType??0),a=new io(i.smooth??!1),o;i.colors?o=new Zm(i.colors.length,i.colors):(o=new Zm(10,new fr(0,0,0,1)),o.value[1]=new fr(1,1,1,1));let l;i.steps?l=new Qm(i.steps.length,i.steps):(l=new Qm(10,1),l.value[0]=0);let c=new ca(i.offset??new ge(0,0)),u=new ca(i.morph??new ge(0,0)),d=new Pt(i.angle??0),f=Al(i),m=new gae(s,a,o,l,c,u,d,f.alpha,f.isMask),v=new Ji(m.calpha,"f");return new An(t,r,e,{gradientType:s,smooth:a,colors:o,steps:l,offset:c,morph:u,angle:d,...f},m,f.mode,v,f.isMask,n)}case"pattern":{let s=new Fi(i.style??0),a=new Fi(i.projection??0),o=new Fi(["x","y","z"].indexOf(i.axis)??0),l=new Pt(i.blending??0),c=new ca(i.offset??new ge(0,0)),u=new ih(i.colorA),d=new ih(i.colorB),f=new ca(i.frequency??new ge(10,10)),m=new Pt(i.size??.5),v=new Pt(i.variation??0),y=new Pt(i.smoothness??.5),x=new Pt(i.zigzag??0),w=new Pt(i.rotation??0),_=new ca(i.vertical??new ge(0,1)),S=new ca(i.horizontal??new ge(0,1)),P=new Fi(i.sides??6),M=Al(i),C=new _ae(s,a,o,l,c,u,d,f,m,v,y,x,w,_,S,P,M.alpha,M.isMask),T=new Ji(C.calpha,"f");return new An(t,r,e,{style:s,projection:a,axis:o,blending:l,offset:c,colorA:u,colorB:d,frequency:f,size:m,variation:v,smoothness:y,zigzag:x,rotation:w,vertical:_,horizontal:S,sides:P,...M},C,M.mode,T,M.isMask,n)}default:{let s=new Dn(1,0,0,1),a=Al(i),o=new JL(s,a.alpha),l=new Ji(o.calpha,"f");return new An(t,r,e,{color:s,...a},o,a.mode,l,a.isMask,n)}}}function sBe(e,t,r,i){let n=F6e(r,i);return nBe(r,e,t,n,i)}function zae(e,t,r,i){if(r.type==="displace"&&(e==="intensity"||e==="visible")){let n=t.uniforms[`f${t.id}_intensity`];return n?(n.value=r.intensity*(r.visible?1:0),n):void 0}if(r.type!=="displace"&&(e==="alpha"||e==="visible")){let n=t.uniforms[`f${t.id}_alpha`];if(!n)return;if(n.value=Xg(r.alpha,i)*(r.visible?1:0),r.type==="outline"&&e==="visible"){let s=t.uniforms[`f${t.id}_compensation`];s&&(s.value=r.compensation&&r.visible)}return n}}function xy(e,t){let r=0,i=e.layers.find(n=>n.data.type==="light");if(i){let n=i.data,s=Number(t.getVariable(n.alphaOverride));if((typeof n.alphaOverride=="string"?s/100:n.alphaOverride)<1)return!0}for(let n of e.layers){if(n.data.type!=="displace"&&n.data.isMask)return!0;if(n.data.type!=="displace"&&"alpha"in n.data&&n.data.type!=="light"&&n.data.type!=="fresnel"&&n.data.type!=="texture"&&n.data.type!=="matcap"&&n.data.type!=="rainbow"&&n.data.type!=="outline"&&n.data.type!=="pattern"){let s=n.data.visible?n.data.alpha:0;if(typeof s=="string"&&(s=Math.max(0,Math.min(1,Number(t.getVariable(s)??100)/100))),s===1&&n.data.type==="depth"||n.data.type==="gradient"){for(let a of n.data.colors)if(a[3]<1){s=a[3];break}}else if(s===1&&n.data.type==="noise"){let a=t.color(n.data.colorA).a,o=t.color(n.data.colorB).a,l=t.color(n.data.colorC).a,c=t.color(n.data.colorD).a,u=Math.min(a,Math.min(o,Math.min(l,c)));u<1&&(s=u)}r+=(1-r)*s}}return r<1}var jp=class extends Jr{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.shadersPatchedForShapeBlend=!1,this.nodeContextUuid=0,this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return""}},aBe=class extends jp{constructor(e,t,r,i){super(),this.flatShading=e,this.side=t,this.wireframe=r,this.root=i}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,Object.assign(this.defines,e.defines),Object.assign(this.uniforms,e.uniforms),this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,r,i){return this.root.getFlavor(e,t,r,i)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,r){this.root.updateByOp(e,t,r)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},UB=class extends jp{constructor(e,t,r=!0){super(),this.data=e,this.allowVariableSaves=r,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.needsJitter=t.shared.needsJitter,Ss.startContext(this),this.reset0(e,t),Ss.endContext(this)}get nodeMaterial(){return this}getFlavor(e,t,r,i){let n=r?6:(e?3:0)+t;if(n+=((i?.resolutionLevel??0)-(i?.useChildrenColors?4:0))*7,n===0)return this;this.flavors===void 0&&(this.flavors=[]),n-=1;let s=this.flavors[n];return s===void 0&&(s=new aBe(e,t,r,this),s.needsJitter=this.needsJitter,this.flavors[n]=s,s.flatShading=e,s.side=t,s.updateAfterBuild(),i&&(s.defines.SHAPEBLEND=i.resolutionLevel,s.defines.SHAPEBLEND_C=i.useChildrenColors?1:0)),s}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){return this.lightLayer.getNode("occlusion")?.value??!1}reset(e,t,r=!1){Ss.startContext(this),(this.data!==e||r)&&this.reset0(e,t),Ss.endContext(this)}reset0(e,t){this.data=e;let r=e.layers??qs.defaultTwoLayerData("phong").layers;try{this.layers=r.map(i=>V_.create(this.layerIdGen++,i.id,i.data,t.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(t.shared),this.transparent=xy(e,t.shared),this.saveVariableLocations(t)}onVariableUpdate(e,t,r){if(e[0]==="alphaOverride")this.transparent=xy(this.data,r.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(t)/100,1)));else if(e[0]==="layer"){let i=e[1],n=e[2];if(i&&n){let s=this.layers.find(a=>a.uuid===i);s?.hasValue(n)&&(n==="alpha"?(this.transparent=xy(this.data,r.shared),s.setValue(n,Math.max(0,Math.min(Number(t)/100,1)))):s.setValue(n,t))}}}saveVariableLocations(e){if(!this.allowVariableSaves)return;let t=this.data.layers.find(r=>r.data.type==="light");t&&e.shared.getVariable(t.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(r=>{"alpha"in r.data&&typeof r.data.alpha=="string"&&e.shared.getVariable(r.data.alpha,["material",this.uuid,"layer",r.id,"alpha"])})}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(e){this.lightLayer=this.layers.find(t=>t instanceof Cu),this.lightLayer===void 0&&(this.lightLayer=new Cu(0,"",{...Vs.defaultData("light","phong"),visible:!1},new VB,{},e)),this.dispose();for(let t of this.flavors)t&&t.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.build(),this.nodeContextUuid=0}applyTextureMaps(){let e=this.layers.find(n=>n instanceof Cu);if(!e)return;let t=e.data,r=t.bumpMap,i=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let n=0;n<this.layers.length;++n){let s=this.layers[n];s instanceof An&&s.color instanceof FB&&(s.uuid===r&&(e.node.bumpMap=s.color),s.uuid===i&&(e.node.roughnessMap=s.color))}}updateByOp(e,t,r){if(Ss.startContext(this),t!==void 0?this.data=t:t=this.data,this.transparent=xy(t,r.shared),e.path[0]==="layers"){let i=r.shared,n=e.path[1];if(n===void 0)r.scene.markNeedsUpdateRendererDirty(),this.reset0(t,r);else{e.type===0&&e.props.occlusion!==void 0&&r.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(a=>a.uuid===n);if(s){let a=t.layers.data(n),o;e.type===0&&("alpha"in e.props||"alphaOverride"in e.props)&&("alpha"in e.props?o={...e.props,alpha:Xg(e.props.alpha,i,["material",this.uuid,"layer",n,"alpha"])}:o={...e.props,alphaOverride:Xg(e.props.alphaOverride,i,["material",this.uuid,"alphaOverride"])}),s.updateByOp({...e,...o?{props:o}:{},path:e.path.slice(2)},a,r)&&this.reset0(t,r)}}}else this.reset0(t,r);Ss.endContext(this)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof An?t.color.mask=void 0:t instanceof Cu&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof An&&t.isMask.value&&t.data.visible&&e>0){let r=e-1,i=this.layers[r];i instanceof Cu?i.node.mask=new wo(t.color,t.alpha,wo.MUL):i instanceof An&&(i.isMask.value||(i.color.mask=new wo(t.color,t.alpha,wo.MUL)))}}}blendColors(){let e=this.layers.findIndex(r=>r instanceof An),t=this.layers.findIndex(r=>r instanceof Cu);if(e!==-1&&e<t){let r=this.layers[e].color;for(let i=e+1;i<t;++i){let n=this.layers[i];if(n instanceof An){if(n.isMask.value)continue;r=new YY(r,n.color,n.alpha,n.mode)}}this.fragment.color=r}else this.fragment.color=void 0}blendAfterColors(){let e=new Ji("outgoingLight","f"),t=this.layers.findIndex(r=>r instanceof Cu);if(this.layers.length>t+1){for(let r=t+1;r<this.layers.length;++r){let i=this.layers[r];if(i instanceof An){if(i.isMask.value)continue;e=new YY(e,i.color,i.alpha,i.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof Lae);if(e.length>0){let t=e[0].position;for(let r=1;r<e.length;++r)e[r]&&(t=new wo(t,e[r].position,wo.ADD),t=new wo(t,new Pt(.5).setReadonly(!0),wo.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.shapeBlendhack&&this.shapeBlendhack(this),e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let r=(i,n,s)=>Math.min(Math.max(i,n),s);for(let i of this.layers)if(i.type==="displace"){let n=r(i.uniforms[`f${i.id}_intensity`].value,e,t);i.uniforms[`f${i.id}_intensity`].value=n}}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new cae;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this.shadersPatchedForShapeBlend=!1,this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof An){let t=e.params.texture;if(t instanceof ZL&&!t.image.loaded)return!1}return!0}};Object.defineProperties(jp.prototype,{properties:{get:function(){return this.fragment.properties}}});var r5=class extends UB{constructor(e,t,r){super(e,t,!1),this.uuid=r,this.allowVariableSaves=!0,this.saveVariableLocations(t)}},iX=new Map;function oBe(e){if(typeof e=="string")return e;let t=iX.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},iX.set(e,t)),t.url}var Bae,lBe=new Promise(e=>{Bae=e}),nX=!1,qA;function cBe(){if(nX)return;if(qA)return qA;async function e(){await Zp(()=>import("./howler-CRoMRGc2.js").then(t=>t.h),[]),Bae(window!==void 0?window:global),nX=!0}return qA=e(),qA}var Fae;lBe.then(e=>Fae=e);function sX(e,t){e.forEach(r=>{"dragDropActions"in r.data?(t.push(...r.data.dragDropActions.drag),t.push(...r.data.dragDropActions.drop)):"inActions"in r.data?(t.push(...r.data.inActions),t.push(...r.data.outActions)):"gameActions"in r.data?(t.push(...r.data.gameActions.idle),t.push(...r.data.gameActions.move),t.push(...r.data.gameActions.jump),t.push(...r.data.gameActions.run)):"breakpoints"in r.data?r.data.breakpoints.forEach(i=>{t.push(...i.data.actions)}):"actions"in r.data&&(t.push(...r.data.actions),r.data.actions.forEach(i=>{i.data.type==="Conditional"&&i.data.ifActions&&(t.push(...i.data.ifActions),t.push(...i.data.elseActions))}))})}function uBe(e){let t=!1,r=[];return e.scene.objects.traverse((i,n)=>{if(n.type==="Page"&&n.uiScene!==void 0&&n.uiScene.objects.traverse((s,a)=>{if(a.events===void 0||Array.isArray(a.events)===!1)return!0;sX(a.events,r),t=t||r.some(o=>o.data.type==="Audio")}),n.events===void 0||Array.isArray(n.events)===!1)return!0;sX(n.events,r),t=t||r.some(s=>s.data.type==="Audio")}),t}var Cw=class{constructor({src:e,volume:t,delay:r,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let n;typeof e=="string"?n={src:e}:n={src:oBe(e),format:"wav"},this.sound=new Fae.Howl(n),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),r!==void 0&&(this.delay=r),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,r){this.sound.on(e,t,r)}off(e,t,r){this.sound.off(e,t,r)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},dBe=class{constructor(){this.type="ShapePath",this.color=new Zt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new lM,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath?.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath?.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,n,s){return this.currentPath?.bezierCurveTo(e,t,r,i,n,s),this}splineThru(e){return this.currentPath?.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function r(m,v,y,x){let w=m.x,_=v.x,S=y.x,P=x.x,M=m.y,C=v.y,T=y.y,E=x.y,N=(P-S)*(M-T)-(E-T)*(w-S),D=(_-w)*(M-T)-(C-M)*(w-S),I=(E-T)*(_-w)-(P-S)*(C-M),j=N/I,L=D/I;if(I===0&&N!==0||j<=0||j>=1||L<0||L>1)return null;if(N===0&&I===0){for(let B=0;B<2;B++)if(i(B===0?y:x,m,v),t.loc===e.ORIGIN){let q=B===0?y:x;return{x:q.x,y:q.y,t:t.t}}else if(t.loc===e.BETWEEN){let q=+(w+t.t*(_-w)).toPrecision(10),G=+(M+t.t*(C-M)).toPrecision(10);return{x:q,y:G,t:t.t}}return null}else{for(let G=0;G<2;G++)if(i(G===0?y:x,m,v),t.loc===e.ORIGIN){let Y=G===0?y:x;return{x:Y.x,y:Y.y,t:t.t}}let B=+(w+j*(_-w)).toPrecision(10),q=+(M+j*(C-M)).toPrecision(10);return{x:B,y:q,t:j}}}function i(m,v,y){let x=y.x-v.x,w=y.y-v.y,_=m.x-v.x,S=m.y-v.y,P=x*S-_*w;if(m.x===v.x&&m.y===v.y){t.loc=e.ORIGIN,t.t=0;return}if(m.x===y.x&&m.y===y.y){t.loc=e.DESTINATION,t.t=1;return}if(P<-Number.EPSILON){t.loc=e.LEFT;return}if(P>Number.EPSILON){t.loc=e.RIGHT;return}if(x*_<0||w*S<0){t.loc=e.BEHIND;return}if(Math.sqrt(x*x+w*w)<Math.sqrt(_*_+S*S)){t.loc=e.BEYOND;return}let M;x!==0?M=_/x:M=S/w,t.loc=e.BETWEEN,t.t=M}function n(m,v){let y=[],x=[];for(let w=1;w<m.length;w++){let _=m[w-1],S=m[w];for(let P=1;P<v.length;P++){let M=v[P-1],C=v[P],T=r(_,S,M,C);T!==null&&y.find(E=>E.t<=T.t+Number.EPSILON&&E.t>=T.t-Number.EPSILON)===void 0&&(y.push(T),x.push(new ge(T.x,T.y)))}}return x}function s(m,v,y){let x=new ge;v.getCenter(x);let w=[];return y.forEach(_=>{_.boundingBox.containsPoint(x)&&n(m,_.points).forEach(S=>{w.push({identifier:_.identifier,isCW:_.isCW,point:S})})}),w.sort((_,S)=>_.point.x-S.point.x),w}function a(m,v,y,x,w){(w==null||w==="")&&(w="nonzero");let _=new ge;m.boundingBox.getCenter(_);let S=[new ge(y,_.y),new ge(x,_.y)],P=s(S,m.boundingBox,v);P.sort((D,I)=>D.point.x-I.point.x);let M=[],C=[];P.forEach(D=>{D.identifier===m.identifier?M.push(D):C.push(D)});let T=M[0].point.x,E=[],N=0;for(;N<C.length&&C[N].point.x<T;)E.length>0&&E[E.length-1]===C[N].identifier?E.pop():E.push(C[N].identifier),N++;if(E.push(m.identifier),w==="evenodd"){let D=E.length%2===0,I=E[E.length-2];return{identifier:m.identifier,isHole:D,for:I}}else if(w==="nonzero"){let D=!0,I=null,j=null;for(let L=0;L<E.length;L++){let B=E[L];v[B]&&(D?(j=v[B].isCW,D=!1,I=B):j!==v[B].isCW&&(j=v[B].isCW,D=!0))}return{identifier:m.identifier,isHole:D,for:I}}else console.warn('fill-rule: "'+w+'" is currently not implemented.')}let o=0,l=999999999,c=-999999999,u=[];this.subPaths.forEach(m=>{let v=m.getPoints(),y=-999999999,x=999999999,w=-999999999,_=999999999;for(let S=0;S<v.length;S++){let P=v[S];P.y>y&&(y=P.y),P.y<x&&(x=P.y),P.x>w&&(w=P.x),P.x<_&&(_=P.x)}c<=w&&(c=w+1),l>=_&&(l=_-1),v.length&&u.push({curves:m.curves,points:v,isCW:kie.isClockWise(v),identifier:o++,boundingBox:new J6(new ge(_,x),new ge(w,y))})});let d=u.map(m=>a(m,u,l,c,this.userData?.style.fillRule)),f=[];return u.forEach(m=>{let v=d[m.identifier];if(v&&!v.isHole){let y=new cM;y.curves=m.curves,d.filter(x=>x?.isHole&&x.for===m.identifier).forEach(x=>{if(x){let w=u[x.identifier],_=new lM;_.curves=w.curves,y.holes.push(_)}}),f.push(y)}}),f}},Vae=!1,Uae,aX=new Promise(e=>{Uae=e}),oX=!1,YA;function hBe(){if(Vae=!0,oX)return;if(YA)return YA;async function e(){let t=await Zp(()=>import("./opentype-LDE648lb.js"),[]);Uae(t),oX=!0}return YA=e(),YA}var fBe=class{async load(e,t,r=()=>{}){let{load:i}=await aX;i(e,(n,s)=>{n||!s?r(n??"Something went wrong"):t(s)})}async parse(e){let{parse:t,Bidi:r}=await aX;try{let i=t(e),n=new r,s=a=>i.charToGlyphIndex(a.char);return n.registerModifier("glyphIndex",null,s),n.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:n}}catch(i){console.error(i)}}};async function pBe(e){return await(await fetch(e)).arrayBuffer()}var mBe=new fBe;async function lX(e){let t,r,i=!1;if(e.url?(t=await pBe(e.url),r=e.url,i=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t)if(Vae){let n=await mBe.parse(t);if(n)return{font:n.font,url:r,intercepted:i,arr:t,bidi:n.bidi}}else return{font:void 0,url:r,intercepted:i,arr:t,bidi:null}}function gBe(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var vBe=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=lX(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=lX(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,r){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(t);let n=i.tokenizer.tokens,s=[],a=0,o=r.length===n.length;for(let l=0;l<r.length;l++){let c=r[l].index,u=String.fromCharCode(r[l].unicode),d=n[a];if(gBe(c,d)||o)s.push({char:u,index:c,replacements:[d.state.glyphIndex],replacementChars:[d.char]}),a++;else{let f=d.char,m="",v=[d.state.glyphIndex],y=[],x=!1;for(;!x;)a++,m=t.charAt(a),f+=m,v.push(e.charToGlyphIndex(m)),y=e.stringToGlyphs(f),y.length===1&&y[0].index===c&&(x=!0),a>t.length&&(x=!0);s.push({char:u,index:c,replacements:v,replacementChars:Array.from(f)}),a++}}return s}generateShapes(e,t,r){if(!this._isLoaded)return;let i=this.font,n=t.fontSize/this.unitsPerEm,s=t.fontSize*t.lineHeight,a=e.map(w=>this.getTextWidth(w,t)),o=typeof t.width=="string"?Number(r.getVariable(t.width)):t.width,l=typeof t.height=="string"?Number(r.getVariable(t.height)):t.height,c=this.getCharWidth(`
`,t),u=t.horizontalAlign===1?c:0,d=this.getLineInitialOffsetX(a[0],o,t.horizontalAlign,e[0],c),f=this.getLineInitialOffsetY(s,e.length,l,n,t.verticalAlign),m=[],v=e.map(w=>[]),y=e.map(w=>[]);for(let w=0;w<e.length;w++){let _=e[w],S={features:{liga:!0},letterSpacing:t.letterSpacing},P=[];try{P=i.stringToGlyphs(_,S)}catch(N){console.warn(N)}d=this.getLineInitialOffsetX(a[w],o,t.horizontalAlign,_,c);let M=[];try{M=this.reverseLigaturesTable(i,_,P)}catch(N){console.warn(N)}let C=this.computeSpaceWidthForLine(e,w,t,r),T=0,E=P[0];E&&t.horizontalAlign===2&&E.leftSideBearing!==void 0&&(d-=E.leftSideBearing*n),this.font?.forEachGlyph(_,d,f,t.fontSize,S,(N,D,I,j,L)=>{let B=N.index===0?`
`:N.unicode?String.fromCharCode(N.unicode):void 0,q=M[T],G=0;if(B===`
`)G=u;else if(B===" ")G=C;else{let Y=this.createPath(N,n,D,I,t);Y&&(G=Y.offsetX,m.push(Y.path))}if(q.replacements.length===1)y[w].push([D,I]),v[w].push(G);else{let Y=q.replacements.map($=>(i.glyphs.get($).advanceWidth??0)*n),X=Y.reduce(($,se)=>$+=se,0),re=Y.map($=>$/X),F=D;for(let $=0;$<re.length;$++){let se=G*re[$];y[w].push([F,I]),v[w].push(se),F+=se}}T++}),f-=s}let x=[];for(let w=0,_=m.length;w<_;w++)x.push(...m[w].toShapes());return{shapes:x,charWidths:v,lineWidths:a,charCoords:y}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){return this.font?.ascender??0}get descender(){return this.font?.descender??0}get familyName(){return this.font?.names.fontFamily??""}get subfamilyName(){return this.font?.names.fontSubfamily??""}get unitsPerEm(){return this.font?.unitsPerEm??1}getLineInitialOffsetX(e,t,r,i,n){return(r===3||r===2)&&i.indexOf(`
`)>=0&&(e-=n),r===3?t*.5-e*.5:r===2?t-e:0}getLineInitialOffsetY(e,t,r,i,n){let s=t*e,a=Math.abs(this.ascender-this.descender)*i,o=e-a,l=-this.ascender*i-o/2;return n===3?-(r-s-l):n===2?-(r*.5-s*.5-l):l}createPath(e,t,r,i,n){let s=e.getPath(r,-i,n.fontSize,{kerning:!1,letterSpacing:n.letterSpacing});if(!s){console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");return}let a=new dBe,o=(e.advanceWidth??1)*t;if(e)for(let l of s.commands){let c=a.currentPath?.currentPoint;if(!(c&&l.type!=="Z"&&c.x===l.x&&-c.y===l.y))switch(l.type){case"M":a.moveTo(l.x,-l.y);break;case"L":a.lineTo(l.x,-l.y);break;case"Q":a.quadraticCurveTo(l.x1,-l.y1,l.x,-l.y);break;case"C":a.bezierCurveTo(l.x1,-l.y1,l.x2,-l.y2,l.x,-l.y);break}}return a.subPaths.forEach(l=>{let c=yBe(l.curves);c!==void 0&&l.currentPoint.distanceTo(c)>0&&l.lineTo(c.x,c.y)}),{offsetX:o,path:a}}getCharWidth(e,t){return this.font?.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing})??0}getTextWidth(e,t){return this.font?.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing})??0}computeSpaceWidthForLine(e,t,r,i){let n=this.getCharWidth(" ",r),s=e[t];if(s){let a=this.countSpaces(s.trimEnd());if(r.horizontalAlign===4&&t<e.length-1&&a){let o=typeof r.width=="string"?Number(i.getVariable(r.width)):r.width,l=this.getTextWidth(s,r);return(o-(l-a*n))/a}}return n}countSpaces(e){return(e.match(/ /g)||[]).length}};function yBe(e){if(e.length){let t=e[0];if(t instanceof Nc)return t.v1;if(t instanceof Ec||t instanceof Ip)return t.v0}}var xBe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t,r){let i=this.objects.get(e);return i===void 0?(i=this.createObject(e,t,r),this.objects.set(e,i)):i.isShared=!0,i}forceDelete(e){let t=this.objects.get(e);t&&(this.disposeObject(t),this.objects.delete(e))}mutateIfUnique(e,t){let r=this.objects.get(e);if(r&&r.isShared!==!0)return this.objects.delete(e),this.objects.set(t,r),r}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let r=this.objects.get(e);t===r&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},cX=class extends xBe{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t,r){let i=Y2(e,t,this.flatShading,r);return i.computeBoundingSphere(),i}},bBe={markNeedsUpdateRendererDirty:()=>{}},dT=1e3,uX=512*dT;function wBe(e,t){let r=typeof e;return!!((t==="string"||t==="number")&&r===t||t==="boolean"&&(e==="true"||e==="false"||e===!0||e===!1)||t==="image"&&r==="string"&&e.startsWith("http"))}var _Be="https://hooks.spline.design",SBe=`${_Be}/events?hashFile=`,EBe=class{constructor(e,t){this.id=e,this.userWebhook=t,this.result=void 0,this._connected=!1,this.emitter=q3(),this.reconnectWaitFor=dT,this._onError=r=>{this.eventSource?.removeEventListener("message",this._onMessage),this.eventSource?.removeEventListener("error",this._onError),this.eventSource?.removeEventListener("open",this._onConnected),this._scheduleReconnect()},this._onConnected=r=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=dT,this._connected=!0},this._onDisconnected=()=>{clearTimeout(this.scheduledReconnectHandle),this.reconnectWaitFor=dT,this._connected=!1},this._onMessage=r=>{let i=r.data,n;try{n=JSON.parse(i)}catch(s){console.error("Error parsing webhook message",s)}if(n){let s=!1;this.userWebhook.parametersSchemas.forEach(({data:a})=>{n[a.name]!==void 0&&wBe(n[a.name],a.type)&&(this.result===void 0&&(this.result={}),this.result[a.name]=n[a.name],s=!0)}),s&&this.emitter.emit("message",{userWebhookId:this.id})}}}connect(){clearTimeout(this.scheduledReconnectHandle),this.userWebhook.url&&(this.eventSource=new EventSource(SBe+this.userWebhook.url),this.eventSource.addEventListener("message",this._onMessage),this.eventSource.addEventListener("error",this._onError),this.eventSource.addEventListener("open",this._onConnected))}disconnect(){this.eventSource?.removeEventListener("message",this._onMessage),this.eventSource?.removeEventListener("error",this._onError),this.eventSource?.removeEventListener("open",this._onConnected),this.eventSource?.close(),this._onDisconnected(),clearTimeout(this.scheduledReconnectHandle)}_scheduleReconnect(){this.reconnectWaitFor*=2,this.reconnectWaitFor>uX&&(this.reconnectWaitFor=uX),clearTimeout(this.scheduledReconnectHandle),this.scheduledReconnectHandle=setTimeout(()=>{this.scheduledReconnectHandle=void 0,this.connect()},this.reconnectWaitFor)}update(e){this.userWebhook=e}dispose(){this._connected&&this.disconnect()}get connected(){return this._connected}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}getParametersKeys(){return this.userWebhook.parametersSchemas.map(e=>e.data.name)}getParameterValue(e){if(this.getParametersKeys().includes(e)){if(this.result)return this.result?.[e];for(let t of this.userWebhook.parametersSchemas)if(t.data.name===e)return DL.defaultParameterValueByType(t.data.type)}}},dX=[4186.01,4434.92,4698.63,4978.03,5274.04,5587.65,5919.91,6271.93,6644.88,7040,7458.62,7902.13],ABe=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],Sp=[],HB=[];for(let e=1;e<=8;e++)for(let t=0;t<dX.length;t++){let r=dX[t];Sp.push(r/Math.pow(2,8-e)),HB.push(ABe[t]+e)}var $M=[32,2e3],hX=Sp.filter((e,t)=>Sp[t]>$M[0]&&Sp[t]<$M[1]),CBe=HB.filter((e,t)=>Sp[t]>$M[0]&&Sp[t]<$M[1]),TBe=class{static getFrequencies(e,t,r,i="frequency",n=-100,s=-30){r||(r=new Float32Array(e.frequencyBinCount),e.getFloatFrequencyData(r));let a=t/2,o=1/r.length*a,l,c,u;if(i==="music"||i==="voice"){let f=i==="voice"?hX:Sp,m=Array(f.length).fill(n);for(let v=0;v<r.length;v++){let y=v*o,x=r[v];for(let w=f.length-1;w>=0;w--)if(y>f[w]){m[w]=Math.max(m[w],x);break}}l=m,c=i==="voice"?hX:Sp,u=i==="voice"?CBe:HB}else l=Array.from(r),c=l.map((f,m)=>o*m),u=c.map(f=>`${f.toFixed(2)} Hz`);let d=l.map(f=>Math.max(0,Math.min((f-n)/(s-n),1)));return{values:new Float32Array(d),frequencies:c,labels:u}}},MBe="gpt-4o-realtime-preview-2024-12-17",PBe=()=>"https://relayserver.spline.design/";async function DBe(e){try{return(await(await fetch(PBe()+"session?uuidfile="+e)).json()).token}catch(t){console.error("Token generation error:",t)}}var NBe=class{constructor(e){this.value=0,this.frequencies=new Float32Array(0);let t=new AudioContext;this.source=t.createMediaStreamSource(e),this.analyser=t.createAnalyser(),this.source.connect(this.analyser),this.analyser.fftSize=8192,this.analyser.smoothingTimeConstant=.1}getFrequencies(e=-100,t=-30){if(!this.analyser)throw new Error("Not connected, please call .connect() first");return TBe.getFrequencies(this.analyser,44100,void 0,"voice",e,t)}update(){let e=this.getFrequencies(),t=e.values.reduce((r,i)=>r+i,0)/e.values.length;this.value=t,this.frequencies=e.values}disconnect(){this.source.disconnect(),this.analyser.disconnect()}},fX=class{constructor(e,t,r){this.data=e,this.id=t,this.shared=r,this.emitter=q3(),this.rafId=0,this.voice=0,this.frequencies=new Float32Array([0]),this.events=[],this.isConnected=!1,this.isToolsAdded=!1,this.tools=[],this.onMessage=i=>{let n=JSON.parse(i.data);if(this.appendEvent(n),n.type==="session.created"&&this.onSessionCreated(),n.type==="response.done"&&n.response?.output){for(let s of n.response.output)if(s.type==="function_call")for(let[a,o]of this.tools)s.name===a.name&&(o(JSON.parse(s.arguments)),setTimeout(()=>{this.sendClientEvent({type:"response.create",response:{instructions:"notice the user about what you just did"}})}))}},this.onSessionCreated=()=>{this.isToolsAdded||this.registerTools()},this.onOpen=()=>{this.events=[],this.isConnected=!0,this.sendClientEvent({type:"response.create",response:{instructions:"Say hi"}})},this.animate=()=>{if(this.rafId=requestAnimationFrame(this.animate),this.isConnected&&this.analyser){this.analyser.update();let i=this.analyser.value,n=this.analyser.frequencies;this.voice=i,this.frequencies=n,this.emitter.emit("voice",{value:i,frequencies:n})}}}update(e){this.data=e}setColorByName(e,t){let r=this.shared.getColorByName(e);if(r){let{id:i}=r,{r:n,g:s,b:a}=rze.hexStringToRgb(t)??{r:0,g:0,b:0};this.shared.updateColor(i,{r:n/255,g:s/255,b:a/255})}}async connect(){if(this.isConnected)return;let e=await DBe(this.data.integration.hash);this.pc=new RTCPeerConnection,this.audioElement=document.createElement("audio"),this.audioElement.autoplay=!0,this.pc.ontrack=n=>{let s=n.streams[0];this.audioElement.srcObject=s,this.analyser=new NBe(s)};let t=await navigator.mediaDevices.getUserMedia({audio:!0});this.pc.addTrack(t.getTracks()[0]),this.dc=this.pc.createDataChannel("oai-events"),this.dc.addEventListener("message",this.onMessage),this.dc.addEventListener("open",this.onOpen);let r=await this.pc.createOffer();await this.pc.setLocalDescription(r);let i={type:"answer",sdp:await(await fetch(`https://api.openai.com/v1/realtime?model=${MBe}`,{method:"POST",body:r.sdp,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/sdp"}})).text()};await this.pc.setRemoteDescription(i),this.animate()}appendEvent(e){this.events=[e,...this.events]}sendClientEvent(e){this.dc?(e.event_id=e.event_id||crypto.randomUUID(),this.dc.send(JSON.stringify(e)),this.appendEvent(e)):console.error("Failed to send message - no data channel available",e)}registerTools(){this.isToolsAdded=!0,this.registerTool({type:"function",name:"set_personality_color",description:"returns a color based on the voice personality of the ai assistant. This should be called by the voice assistant each time it is asks to speak differently. If a color cannot be associated to the personality, the color should be a neutral color.",parameters:{type:"object",properties:{color:{type:"string",description:"css hex color string, reflecting the personality"},personality:{type:"string",description:"the personality of the voice assistant"}},required:["color","personality"]}},({color:n})=>{this.setColorByName("Voice Assistant Color",n)});let e=this.shared.getVariablesNames().join(", ");this.registerTool({type:"function",name:"set_variable",description:"Sets a Spline variable value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:`The name of the variable that needs to be set. Here's a list of available variables: ${e}. It the variable does not exist, don't call the function and warn the user about it.`},value:{type:"string",description:"The new value for this variable, should always be a string even for number and boolean variables, assume that the value will be cast to the proper type afterwards."}},required:["name","value","type"]}},({name:n,value:s})=>{let a=this.shared.getVariableByName(n);if(a){let o=this.shared.getVariable(a.id),l;typeof o=="number"?l=parseFloat(s):typeof o=="boolean"?l=s.toLowerCase()==="true":l={textValue:s},this.shared.updateVariable(a.id,l)}});let t=this.shared.getColorNames().join(", ");this.registerTool({type:"function",name:"set_color",description:"Sets a Spline color asset value when asked by the user.",parameters:{type:"object",properties:{name:{type:"string",description:`The name of the color asset that needs to be set. Here's a list of available color assets: ${t}. It the color asset does not exist, don't call the function and warn the user about it.`},value:{type:"string",description:"css hex color string"}},required:["name","value"]}},({name:n,value:s})=>{this.setColorByName(n,s)});let r=this.shared.scene,i=[];r.traverseEntity(n=>{n.data.events.forEach(s=>{if(s.data.type==="AIAssistantTrigger"){let{description:a}=s.data;i.push(a)}})}),this.registerTool({type:"function",name:"trigger_event",description:"Trigger an event by name, here are the available events, please match what the user is asking for to one of these if it applies, otherwise don't call the function and warn the user.",parameters:{type:"object",properties:{description:{type:"string",description:`The name of the event that needs to be triggered. Here's a list of available events: ${JSON.stringify(i)}.`},direction:{type:"string",description:"default is forward, but can be forward or backward. Always set to forward unless the user ask to reverse or cancel the event, then set to backward."}},required:["description","direction"]}},({description:n,direction:s})=>{this.emitter.emit("trigger_event",{description:n,direction:s})}),this.sendClientEvent({type:"session.update",session:{tools:this.tools.map(([n])=>n)}})}registerTool(e,t){this.tools.push([e,t])}disconnect(){cancelAnimationFrame(this.rafId),this.analyser?.disconnect(),this.voice=0,this.isConnected=!1,this.isToolsAdded=!1,this.dc?.removeEventListener("message",this.onMessage),this.dc?.removeEventListener("open",this.onOpen),this.dc?.close(),this.pc?.getSenders().forEach(e=>{e.track&&e.track.stop()}),this.pc?.close(),this.pc=void 0}computeAnalysisForListenerEvent(e){if(e.analysis==="range"){let t=this.frequencies.slice(...e.analysisRange);return t.reduce((r,i)=>r+i,0)/t.length}return e.analysis==="single"?this.frequencies[e.analysisSingle]:this.voice}on(e,t){this.emitter.on(e,t)}off(e,t){this.emitter.off(e,t)}};function i5(e){return"variable_"+e}var kBe=class extends v6e{constructor(e){super(),this.shared=e}create(e){return new kae(e,this.shared)}},GB=class{constructor(e,t={},r=!0,i=!1){if(this.data=e,this.needsJitter=r,this.enableLocalStorageForPersistentVariables=i,this.geometryCache=new cX(!0),this.geometryCache2=new cX(!1),this.imageHolderCache=new kBe(this),this.thisContext={scene:bBe,shared:this},this.deletedMaterial=new r5(qs.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new tp(kL.emptyImage,this),this.deletedVideo=new tp(DM.defaultVideo,this),this.materials={},this.images={},this.uiBuffers={},this.videos={},this.colors={},this.audios={},this.particles={},this.fonts={},this.variables={},this.userAPIs={},this.userWebhooks={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[n,s]of Object.entries(t.images))this.addImage(n,s);if(t.videos)for(let[n,s]of Object.entries(t.videos))this.addVideo(n,s);if(t.audios)for(let[n,s]of Object.entries(t.audios))this.addAudio(n,s);if(t.particles)for(let[n,s]of Object.entries(t.particles))this.addParticle(n,s);this.reset(e)}setRequestRender(e){this._requestRender=e}getImageLoadPromises(){return Object.values(this.images).map(e=>e.loadPromise)}setEntityOpContext(e){this.entityOpContext=e}reset(e,t=!1,r=!1){this.data=e,this.resetLib(e.lib);for(let{id:i,data:n}of e.variables)this.addVariableHolder(i,n),t&&this.updateVariableHolder(i,n);for(let[i,n]of Object.entries(e.userAPIs))this.addUserAPI(i,n);for(let[i,n]of Object.entries(e.userWebhooks))this.addUserWebhook(i,n);if(!r){for(let[i,n]of Object.entries(e.images))this.addImage(i,n);for(let[i,n]of Object.entries(e.videos))this.addVideo(i,n)}for(let[i,n]of Object.entries(e.colors))this.addColor(i,n);for(let[i,n]of Object.entries(e.materials))this.addMaterial(i,n);for(let[i,n]of Object.entries(e.audios))this.addAudio(i,n);for(let[i,n]of Object.entries(e.particles))this.addParticle(i,n);for(let[i,n]of Object.entries(e.fonts))this.addFont(i,n)}addMaterial(e,t){if(this.materials[e]){let r=this.materials[e];r.reset(t,this.thisContext),r.dispose()}else{let r=new r5(t,this.thisContext,e);this.materials[e]=r}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):e==null?(console.error("material is undefined or null"),this.deletedMaterial):new UB(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new tp(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addUIBuffer(e,t){return this.uiBuffers[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.uiBuffers[e].updateSrc(t),!0):(this.uiBuffers[e]=new tp(t,this),!1)}uiBuffer(e){return this.uiBuffers[e]}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new tp(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new XM(t.r,t.g,t.b,t.a):this.colors[e]=new XM(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let r=this.colors[e];return this.colors[e].r=t.r??r.r,this.colors[e].g=t.g??r.g,this.colors[e].b=t.b??r.b,this.colors[e].a=t.a??r.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}getColorNames(){return Object.values(this.data.colors).map(e=>e.name)}getColorByName(e){for(let t in this.data.colors)if(this.data.colors[t].name===e)return{color:this.colors[t],id:t}}color(e){let t;if(typeof e=="string"){let r=this.getColor(e);r?t=r:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new xa(0,0,0,0))}else return"a"in e?new xa(e.r,e.g,e.b,e.a):new xa(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof Cw)return t;{let r=new Cw({src:t.data});return this.audios[e]=r,r}}addParticle(e,t){this.particles[e]=t}getParticle(e){return this.particles[e]}deleteParticle(e){this.particles[e]&&delete this.particles[e]}deleteAudio(e){let t=this.audios[e];t&&(t instanceof Cw&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new vBe(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof Cw&&e.dispose()}),this.audios={},this.particles={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(e,t){if(this.variables[e]===void 0){let r=t.value;if(this.enableLocalStorageForPersistentVariables&&t.persistent){let i=localStorage.getItem(i5(e));r=i!==null?JSON.parse(i):t.value}return this.variables[e]={value:r,locations:[],persistent:t.persistent},"dynamicVariableType"in t&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0),!0}return this.variables[e].value=t.value,!1}resetDynamicVariablePlayState(){for(let e in this.variables)this.variables[e].dynamicVariablePlayState!==void 0&&(this.variables[e].dynamicVariablePlayState="Playing",this.variables[e].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(e,t){this.updateVariable(e,t.value)}updateVariable(e,t){if(this.variables[e]===void 0)return!1;this.variables[e].value=t,this.enableLocalStorageForPersistentVariables&&this.variables[e].persistent&&localStorage.setItem(i5(e),JSON.stringify(t));let r=t;for(;typeof r=="string";)r=this.variables[r].value;let i=this.entityOpContext.scene;for(let n=this.variables[e].locations.length-1;n>=0;n--){let s=this.variables[e].locations[n];if(s[0]==="material"){let a=s[1],o=r,l={scene:i,shared:this},c=s.slice(2);i.traverseMaterial(d=>{let f=d.root??d;f.uuid===a&&f.onVariableUpdate(c,o,l)});let u=this.materials[a];u&&u.onVariableUpdate(c,o,l)}else{let a=i.find(s[0]);if(a===void 0){this.variables[e].locations.splice(n,1);continue}if(s[1]!=="geometry"&&s[1]!=="particles"){for(let o=1;o<s.length-1;o++)a=a[s[o]];s[1]==="rotation"?a[s[s.length-1]]=r*Ct.DEG2RAD:a[s[s.length-1]]=r}if(a=i.find(s[0]),a.type==="ParticleEmitter"&&a.updateVariableState(r,s),Xr.is(a))if(s[1]==="position"||s[1]==="rotation"||s[1]==="scale")a.onVariableUpdate();else if(s[1]==="geometry"){let o=a;a.component&&(o=a.component);let l=o.dataPatched;o.chooseGeoemtryCache(this).forceDelete(l.geometry),o.createGeometryDelayed(this.entityOpContext),o.onVariableUpdate(!0),o.invalidateDownstreamBooleanData(),o.instances.forEach(c=>{let u=c.dataPatched;c.chooseGeoemtryCache(this).forceDelete(u.geometry),c.createGeometryDelayed(this.entityOpContext),c.onVariableUpdate(!0),c.invalidateDownstreamBooleanData()})}else s[1]==="morphTargetInfluences"&&a.updateMorphInfluences(s[2],r)}}return this.requestRender(),!0}deleteVariable(e){this.variables[e]&&delete this.variables[e]}getVariable(e,t){if(Array.isArray(e)){if(e[0]==="mouse")return this.mouseProperty?.[e[1]]??0;if(e[0]==="raycast")return this.raycastProperty?.[e[1]]??0;let r=this.entityOpContext.scene.find(e[0]);if(e[1]==="width"||e[1]==="height"||e[1]==="depth")return r.geometry.userData.parameters[e[1]];for(let i=1;i<e.length;i++)r=r[e[i]];return e[1]==="rotation"&&(r*=Ct.RAD2DEG),r}for(let r in this.variables){if(t===void 0)break;let i=this.variables[r],n=i.locations?.findIndex(s=>As.equal(s,t));n!==void 0&&n!==-1&&i.locations.splice(n,1)}if(typeof e=="string"){let r=e,i=e;do{if(i=r,this.variables[r]===void 0)break;let n=this.variables[r].value;t&&this.variables[i]!==void 0&&this.variables[i].locations.push(t),r=n}while(typeof r=="string");return r}else return e}getVariables(){return this.variables}getVariablesNames(){return this.data.variables.map(e=>e.data.name)}getVariableByName(e){for(let t of this.data.variables)if(t.data.name===e)return{variable:t.data,id:t.id}}getDynamicVariablePlayState(e){return this.variables[e]?.dynamicVariablePlayState}setDynamicVariablePlayState(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariablePlayState=t)}getDynamicVariableToggleIsForward(e){return this.variables[e]?.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(e,t){this.variables[e]!==void 0&&(this.variables[e].dynamicVariableToggleIsForward=t)}resetLib(e){for(let[t,r]of Object.entries(e.images))this.addImage(t,r.asset);for(let[t,r]of Object.entries(e.audios))this.addAudio(t,r.asset);for(let[t,r]of Object.entries(e.particles))this.addParticle(t,r.asset);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r.asset);for(let[t,r]of Object.entries(e.fonts))this.addFont(t,r.asset);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,r.asset);for(let[t,r]of Object.entries(e.videos))this.addVideo(t,r.asset);for(let[t,r]of Object.entries(e.variables))this.addVariableHolder(t,r.asset)}updateLibByOp(e,t){e.path[0]==="images"?e.path.length===1&&e.type===1?this.addImage(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===1&&e.type===1?this.addVideo(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===1&&e.type===1?this.addAudio(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="particles"?e.path.length===1&&e.type===1?this.addParticle(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteParticle(e.id):e.path[0]==="colors"?e.path.length===1&&e.type===1?this.addColor(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteMaterial(e.id):e.path[0]==="fonts"?e.path.length===1&&e.type===1?this.addFont(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="variables"?e.path.length===1&&e.type===1?this.addVariableHolder(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVariable(e.id):e.path[0]==="components"&&t.updateByLibOp(e,this)}updateByOp(e,t,r){if(this.data=t,e.path[0]==="images")e.path.length===2&&e.type===0?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addImage(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteImage(e.id);else if(e.path[0]==="videos")e.path.length===2&&e.type===0?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addVideo(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteVideo(e.id);else if(e.path[0]==="audios")e.path.length===2&&e.type===0?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):e.path.length===1&&e.type===1?this.addAudio(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteAudio(e.id);else if(e.path[0]==="particles")e.path.length===2&&e.type===0?e.props.data&&this.addParticle(e.path[1],t.particles[e.path[1]]):e.path.length===1&&e.type===1?this.addParticle(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteParticle(e.id);else if(e.path[0]==="colors")e.path.length===2&&e.type===0?this.updateColor(e.path[1],e.props):e.path.length===1&&e.type===1?this.addColor(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteColor(e.id);else if(e.path[0]==="materials")e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data):e.path.length===1&&e.type===2?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(Ws.drop(e,2),t.materials[e.path[1]],{shared:this,scene:r});else if(e.path[0]==="fonts")e.path.length===2&&e.type===0?this.updateFont(e.path[1],e,r):e.path.length===1&&e.type===1?this.addFont(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteFont(e.id);else if(e.path[0]==="variables")e.path.length===2&&e.type===0?"value"in e.props?this.updateVariable(e.path[1],e.props.value):"persistent"in e.props&&(this.variables[e.path[1]].persistent=e.props.persistent):e.path.length===1&&e.type===4?this.addVariableHolder(e.id,e.data):e.path.length===1&&e.type===5&&this.deleteVariable(e.id);else if(e.path[0]==="userAPIs"){if(e.path.length===1&&e.type===1)this.addUserAPI(e.id,e.data);else if(e.path.length===1&&e.type===2)this.deleteUserAPI(e.id);else if(typeof e.path[1]=="string"){let i=t.userAPIs[e.path[1]];if(i){let n=e.type===0&&e.props.debounce===void 0,s=this.getUserAPI(e.path[1]);s instanceof fX?s.update(i):s?.update(i,this,n)}}}else if(e.path[0]==="userWebhooks"){if(e.path.length===1&&e.type===1)this.addUserWebhook(e.id,e.data);else if(e.path.length===1&&e.type===2)this.deleteUserWebhook(e.id);else if(typeof e.path[1]=="string"){let i=t.userWebhooks[e.path[1]];i&&this.getUserWebhook(e.path[1])?.update(i)}}else e.path[0]==="lib"&&this.updateLibByOp(Ws.drop(e,1),r)}updateFont(e,t,r){if(t.props.url){let i=this.getFont(e),n={...this.data.fonts[e],url:t.props.url};i.update(n),i.loadingPromise.then(()=>this.requestRender()),r.updateFont(e,this)}}addUserAPI(e,t){return this.userAPIs[e]?(this.userAPIs[e].update(t,this),!0):this.openAIRealtime?.id===e?(this.openAIRealtime.update(t),!0):t.integration?.type==="VoiceAssistant"?(this.openAIRealtime=new fX(t,e,this),!1):(this.userAPIs[e]=new $se(e,t,this),!1)}getUserAPI(e){return this.openAIRealtime?.id===e?this.openAIRealtime:this.userAPIs[e]}getUserAPIs(){return this.userAPIs}deleteUserAPI(e){let t=this.userAPIs[e];t&&(t.dispose(),delete this.userAPIs[e])}addUserWebhook(e,t){return this.userWebhooks[e]?(this.userWebhooks[e].update(t),!0):(this.userWebhooks[e]=new EBe(e,t),!1)}getUserWebhook(e){return this.userWebhooks[e]}getUserWebhooks(){return this.userWebhooks}deleteUserWebhook(e){let t=this.userWebhooks[e];t&&(t.dispose(),delete this.userWebhooks[e])}get scene(){return this.entityOpContext.scene}};new GB(Il.emptyData());var sb=class extends uo{updateByPatchedOp(e,t,r){if(super.updateByPatchedOp(e,t,r),UOe(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[i,n]of Object.entries(e.props)){let s=r.shared.material(n);this.material[Number(i)]=s}else if(Vi(e.path,["material"])&&this.material instanceof jp)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(Ws.drop(e,1),t.material,r);else if(Vi(e.path,["materials","*"])&&Array.isArray(this.material)){let i=e.path[1];if("materials"in t&&i<this.material.length){let n=t.materials[i];typeof n!="string"&&this.material[i].updateByOp(Ws.drop(e,2),n,r)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let r=this.dataPatched;this.dataPatched.type==="Mesh"&&this.dataPatched.geometry.shapeBlendNode&&this.layers.set(9);let i;if(this.dataPatched.type==="Mesh"&&this.dataPatched.geometry.type==="ShapeBlendGeometry"&&(i={resolutionLevel:this.dataPatched.geometry.resolutionLevel,useChildrenColors:this.dataPatched.geometry.useChildrenColors}),e.geometry?.type!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe,i),t.scene.markNeedsUpdateRendererDirty()),(e.geometry?.type==="NonParametricGeometry"||"materials"in e)&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(n=>t.shared.material(n).getFlavor(r.flatShading,r.side,r.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(r.flatShading,r.side,r.wireframe)],t.scene.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let n=0;n<this.material.length;n++)this.material[n]=this.material[n].getFlavor(r.flatShading,r.side,r.wireframe);else this.material=this.material.getFlavor(r.flatShading,r.side,r.wireframe,i)}disposeMaterial(){this.material&&zne(this.material).forEach(e=>{e instanceof jp&&(e instanceof r5||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},pX=new V,mX=new fr,gX=new fr,RBe=new V,vX=new ot,os=class extends sb{constructor(t,r,i){super(t,r),this.data=r,this.isSkinnedMesh=!1,this.localGeometry=void 0,r.bindMode&&r.bindMatrix&&(this.bindMode=r.bindMode,this.bindMatrix=new ot().fromArray(r.bindMatrix),this.bindMatrixInverse=new ot)}chooseGeoemtryCache(t){return t.geometryCache}markGeometryAsReachable(t){this.geometryCreateDeleyed instanceof Lt&&this.chooseGeoemtryCache(t).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof GB){let t=this.geometryCreateDeleyed,r=this.chooseGeoemtryCache(t);this.geometryCreateDeleyed=r.get(this.dataPatched.geometry,t,this)}return this.geometryCreateDeleyed}set geometry(t){this.localGeometry=t}get is2DAndNoDepth(){let t=this.dataPatched.geometry;return RM.is2DParametricMesh(t.type)&&t.depth===0}get is2DType(){return RM.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(t,r,i){super.updateByPatchedOp(t,r,i),Vi(t.path,["geometry"])&&this.updateByPatchedOpGeometry(Ws.drop(t,1),r.geometry,i)}removeInteractionGeometry(t){this.localGeometry?.dispose(),this.localGeometry=void 0}updateGeometryInteractions(t,r){this.invalidateDownstreamBooleanData();let i=this.data.geometry.type;if(i==="NonParametricGeometry"||i==="SubdivGeometry"){let n=t;if(this.localGeometry===void 0){let c={...this.data.geometry,...n};this.localGeometry=Y2(c,r,this.data.flatShading,this)}let s,a,o;n.scaleBaked?[s,a,o]=n.scaleBaked:{width:s,height:a,depth:o}=n;let l=this.localGeometry.userData;l.sxPrev!==void 0&&KL(this.localGeometry.attributes,s/l.sxPrev,a/l.syPrev,o/l.szPrev),l.sxPrev=s,l.syPrev=a,l.szPrev=o}else{let n={...this.data.geometry,...t};this.localGeometry?.dispose(),this.localGeometry=Y2(n,r,this.data.flatShading,this)}}refreshAttachedClonersInteractions(){for(let t of this.attachedSurfaceCloners)t.update()}refreshAttachedCloners(t){for(let r of this.attachedSurfaceCloners)t.scene.addPendingUpdateCloner(r.object)}refreshAttachedPaths(t){for(let r of this.attachedPaths)t.scene.addPendingCommand(()=>r.updateShape())}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.refreshAttachedCloners(t),this.refreshAttachedPaths(t)}updateByPatchedOpGeometry(t,r,i){let n=!1;t.type===0&&t.path.length===0&&Object.keys(t.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof to&&this.chooseGeoemtryCache(i.shared).mutateIfUnique(this.geometryCreateDeleyed.data,r)===this.geometryCreateDeleyed&&(n=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(r,t.props.scaleBaked),this.refreshAttachedCloners(i),this.refreshAttachedPaths(i)),n||(i.scene?.markGeometryCacheDirty(),this.createGeometryDelayed(i)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(t,r){this.createGeometryDelayed(r)}updateState(t,r){t.geometry!==void 0&&this.updateGeometryOnStateUpdate(t.geometry,r);let i=t.morphTargetInfluences;if(i){this.updateMorphTargets(),this.geometry.morphTargetsRelative=!0;for(let{data:{name:n,value:s}}of i)this.updateMorphInfluences(n,r.shared.getVariable(s,[this.uuid,"morphTargetInfluences",n]))}super.updateState(t,r)}updateMorphInfluences(t,r){if(this.morphTargetDictionary===void 0)return;let i=this.morphTargetDictionary[t];i!==void 0&&(this.morphTargetInfluences[i]=r)}updateGeometryGroupsIfNeeded(){Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(this.geometry.getIndex()?.count??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(t,r){let i=this.geometry.userData.parameters;this.is2DType?t.set(0,0,i.depth*.5):this.isNonParametric?(t.setScalar(0),this.geometry.boundingSphere&&t.copy(this.geometry.boundingSphere.center),r.set(i.width,i.height,i.depth??0).multiplyScalar(.5)):i.centerOffset?t.fromArray(i.centerOffset):t.setScalar(0),r.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(t,r){this.skeleton=t,this.isSkinnedMesh=!0,r===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),r=this.matrixWorld),this.bindMatrix.copy(r),this.bindMatrixInverse.copy(r).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(t){let r=new fr,i=this.geometry.attributes.skinWeight;for(let n=0,s=i.count;n<s;n++){r.fromBufferAttribute(i,n);let a=1/r.manhattanLength();a!==1/0?r.multiplyScalar(a):r.set(1,0,0,0),i.setXYZW(n,r.x,r.y,r.z,r.w)}}boneTransform(t,r){let i=this.skeleton;if(i===void 0)return;let n=this.geometry;mX.fromBufferAttribute(n.attributes.skinIndex,t),gX.fromBufferAttribute(n.attributes.skinWeight,t),pX.copy(r).applyMatrix4(this.bindMatrix),r.set(0,0,0);for(let s=0;s<4;s++){let a=gX.getComponent(s);if(a!==0){let o=mX.getComponent(s);vX.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),r.addScaledVector(RBe.copy(pX).applyMatrix4(vX),a)}}return r.applyMatrix4(this.bindMatrixInverse)}};function IBe(e){if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,r=e.geometry.attributes,i=r.position.array,n=r.normal.array,s=new Float32Array(i.length);for(let a=0;a<i.length;a+=3){let o=`${i[a]}_${i[a+1]}_${i[a+2]}`,l=new V(n[a],n[a+1],n[a+2]);t.has(o)?t.get(o)?.normals.push(l):t.set(o,{normals:[l],result:new V})}t.forEach((a,o)=>{for(let l of a.normals)a.result.add(l);a.result.divideScalar(a.normals.length)});for(let a=0;a<i.length;a+=3){let o=`${i[a]}_${i[a+1]}_${i[a+2]}`,l=t.get(o)?.result;l&&(s[a]=l.x,s[a+1]=l.y,s[a+2]=l.z)}e.geometry.setAttribute("extrudeNormal",new At(s,3))}function OBe(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=new V;for(let n=0;n<t.length;n+=3)i.set(t[n],t[n+1],t[n+2]).normalize(),r[n]=i.x,r[n+1]=i.y,r[n+2]=i.z;e.geometry.setAttribute("extrudeNormal",new At(r,3))}function WB(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof jp)||e.material.getLayersOfType("outline").length===0)return;e instanceof os&&e.is2DAndNoDepth?OBe(e):IBe(e)}function qB(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,r=new Float32Array(t.length),i=parseInt(e.uuid.replace(/\D/g,"")),n=[Ct.seededRandom(i),Ct.seededRandom(i+1e4),Ct.seededRandom(i+2e4)];for(let s=0;s<t.length;s++)r[s]=n[s%3];e.geometry.setAttribute("randomColor",new Jt(r,3))}var gu=new Wn,q1=new V;function jBe(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var X2=class extends os{constructor(e,t,r){super(e,t,r),this.data=t,this.hiddenMatrixOld=new ot,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let r=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(r.width,r.height,r.depth??0).multiplyScalar(.5)}createGeometryByControls(e){if(this.skipReactionUpdate===!0)return;let t=this.localGeometry?.uuid,{originalGeometry:r,subdividedGeometry:i,subdivPointer:n}=to.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=n,r!==void 0&&(this.originalGeometry?.dispose(),this.originalGeometry=r),i!==void 0&&(this.subdividedGeometry?.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,WB(this),qB(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let r=this.material;this.material=Array.isArray(r)?r.map(i=>i.getFlavor(!1,i.side,i.wireframe)):r.getFlavor(!1,r.side,r.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){to.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&to.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=to.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=to.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let r=this.localGeometry;this.localGeometry=this.originalGeometryNew,uo.prototype.raycast.call(this,e,t),this.localGeometry=r}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new Oo,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,r=e.boundingSphere.center;gu.setFromBufferAttribute(t),gu.getCenter(r),e.boundingSphere.radius=r.distanceTo(gu.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),gu.getSize(q1),this.hasNonUniformScale&&q1.divide(this.scale);let i={width:q1.x,height:q1.y,depth:q1.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(e){let t=this.originalGeometry;gu.min.set(e[0],e[2],e[4]),gu.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(gu.min.applyMatrix4(this.shearScaleInv),gu.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new Oo);let r=t.boundingSphere.center;gu.getCenter(r),t.boundingSphere.radius=r.distanceTo(gu.max)}freeSubdivPointer(){this.subdivPointer&&(to.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,this.originalGeometry?.dispose(),this.subdividedGeometry?.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),this.localGeometry&&this.createGeometryByControls(t)}},yX=-1,LBe=1,zBe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},BBe={polygon_center:0,edge:1,vertex:2},XA=(e,t)=>(r,i)=>!t||r===0||e===0?0:e*i/100,Er=(e,t)=>{let r=Math.abs(t),i=r*-1;return(e-yX)*(r-i)/(LBe-yX)+i},FBe=new V,$A=new V,VBe=new V,UBe=new V;function Fy(e,t){let r=VBe.fromArray(e),i=UBe.fromArray(t);$A.copy(i).sub(r);let n=$A.length();return $A.normalize().multiplyScalar(n*.5),FBe.copy(r).add($A).toArray()}var Ol=new fa,KA=new V,KM=new V,ag=new V;function HBe(e){let t=[];for(let r=0;r<=e.index.count;r++)if(KA.fromArray(e.index.array,r*3),Ol.setFromAttributeAndIndices(e.attributes.position,KA.x,KA.y,KA.z),Ol.getNormal(KM),Ol.getMidpoint(ag),!(isNaN(ag.x)||isNaN(ag.y)||isNaN(ag.z))){let{a:i,b:n,c:s}=Ol,a=i.toArray(),o=n.toArray(),l=s.toArray(),c=i.distanceTo(n),u=n.distanceTo(s),d=s.distanceTo(i),f=Fy(a,o),m=Fy(o,l),v=Fy(l,a),y=[c,u,d],x=Math.max(...y),w=y.filter(P=>Math.round(P)===Math.round(x)).length>1,_=[],S=Ol.getMidpoint(ag).toArray();x===c&&!w&&(_=[m,v,v],S=f),x===u&&!w&&(_=[f,v,v],S=m),x===d&&!w&&(_=[f,m,m],S=v),w&&(_=[f,m,v]),t.push({vertices:[a,o,l],faceCenters:_,midpoint:S,norm:Ol.getNormal(KM).toArray()})}return t}function GBe(e){let t=[],{position:r}=e.attributes;for(let i=0;i<r.count;i++){Ol.setFromAttributeAndIndices(r,i*3,i*3+1,i*3+2),Ol.getNormal(KM),Ol.getMidpoint(ag);let n=Ol.a.toArray(),s=Ol.b.toArray(),a=Ol.c.toArray();t.push({vertices:[n,s,a],faceCenters:[Fy(n,s),Fy(s,a),Fy(a,n)],midpoint:ag.toArray(),norm:KM.toArray()})}return t}var WBe=4,qBe=.5,q4=e=>.5*(1-Math.cos(e*Math.PI)),YBe=class{constructor(){this.perlin=new Array(4096)}noise(e,t=0,r=0){if(this.perlin==null){this.perlin=new Array(4096);for(let x=0;x<4096;x++)this.perlin[x]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),r<0&&(r=-r);let i=Math.floor(e),n=Math.floor(t),s=Math.floor(r),a=e-i,o=t-n,l=r-s,c,u,d=0,f=.5,m,v,y;for(let x=0;x<WBe;x++){let w=i+(n<<4)+(s<<8);c=q4(a),u=q4(o),m=this.perlin[w&4095],m+=c*(this.perlin[w+1&4095]-m),v=this.perlin[w+16&4095],v+=c*(this.perlin[w+16+1&4095]-v),m+=u*(v-m),w+=256,v=this.perlin[w&4095],v+=c*(this.perlin[w+1&4095]-v),y=this.perlin[w+16&4095],y+=c*(this.perlin[w+16+1&4095]-y),v+=u*(y-v),m+=q4(l)*(v-m),d+=m*f,f*=qBe,i<<=1,a*=2,n<<=1,o*=2,s<<=1,l*=2,a>=1&&(i++,a--),o>=1&&(n++,o--),l>=1&&(s++,l--)}return d}noiseSeed(e){let t=(()=>{let r,i;return{setSeed(n){i=r=(n??Math.random()*4294967296)>>>0},getSeed(){return r},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();t.setSeed(e),this.perlin=new Array(4096);for(let r=0;r<4096;r++)this.perlin[r]=t.rand()}},XBe=YBe,xX=new V,bX=new ot,wX=new Wx;function _X(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&(i.geometry.type==="TextGeometry"||i.geometry.type==="InputGeometry")&&(t=!0)}),t}var YB=class extends os{constructor(e,t,r){super(e,t,r),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){let e=this.dataPatched;return this.font?.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign)??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){return(this.font?.ascender??1)*this.fontScale}get descender(){return(this.font?.descender??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:r}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(bX.copy(r).invert(),wX.copy(e.ray).applyMatrix4(bX),wX.intersectBox(this.singleBBox,xX))){let i=xX.applyMatrix4(r),n=e.ray.origin.distanceTo(i);t.push({distance:n,point:i.clone(),object:this})}}},Ka=1e-4,vu,Hae,Gae,Wae,SX=new V,EX=new V;eae.then(e=>{vu=e,Hae=[vu.get_face_center,vu.get_edge_midpoint,vu.get_vertex_position],Gae=[vu.get_face_normal,vu.get_edge_normal,vu.get_vertex_normal],Wae=[vu.face_count,vu.edge_count,vu.vertex_count]});var $Be=new ot,KBe=new ot,kf=new V,QA=new V,Y1=new V,Y4=new V,QBe=new V,ZBe=new V,JBe=class{constructor(e,t){this.data=e,this.is3D=t,this.perlin=new XBe,e.noiseType==="perlin"?(this.perlin.noiseSeed(e.seed),t?this.noise=(r,i,n)=>this.perlin.noise(r,i,n):this.noise=r=>this.perlin.noise(r)):t?this.noise=TLe((0,UL.default)(e.seed)):this.noise=CLe((0,UL.default)(e.seed))}},Ul=class extends MB(Ei){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.random=null,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof va&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof va&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(e!==void 0?t=e:t=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"){if(!this.parameters.toObject.object)t=0;else if(e===void 0&&this.parameters.toObject.spreadType!=="random")return}if(this.parameters.type==="toObject"&&this.objectForSample){let r=this.children;if(r.length===t)return;if(r.length<t)for(let i=0,n=t-r.length;i<n;++i){let s=new va(this.object);s.expand(),this.add(s)}else for(let i=0,n=r.length-t;i<n;++i)this.remove(r[i])}else{if(this.children.length===t)return;if(this.children.length<t)for(let r=0,i=t-this.children.length;r<i;++r){let n=new va(this.object);n.expand(),this.add(n)}else for(let r=0,i=this.children.length-t;r<i;++r)this.remove(this.children[r])}}getRandom(e,t=!1){return(this.random===null||this.random.data.seed!==e.seed||this.random.is3D!==t)&&(this.random=new JBe(e,t)),this.random}_updateRadial(e){let t=e.radial,r=t.start*Ct.DEG2RAD,i=t.end*Ct.DEG2RAD,n=r-i,s=new Es(t.rotation[0],t.rotation[1],t.rotation[2]),a;switch(t.axis){case"z":a=new V(0,0,1);break;case"y":a=new V(0,1,0);break;default:case"x":a=new V(1,0,0);break}let o=e.randomnessObject??dp.defaultData([1,1,1]).randomnessObject,l=this.getRandom(o),c=XA(o.strength,this.parameters.randomness);for(let[u,d]of this.children.entries()){let f=u*(o.freqScale/10)+o.movement,m=l.noise(f,f,f),v=u+1;d.scale.x=t.scale[0]+c(v,Er(m,o.scale[0]))||Ka,d.scale.y=t.scale[1]+c(v,Er(m,o.scale[1]))||Ka,d.scale.z=t.scale[2]+c(v,Er(m,o.scale[2]))||Ka,d.position.setScalar(0);let y=n/e.count*u-r;switch(t.axis){case"x":d.rotation.set(0,y,0);break;case"y":d.rotation.set(0,0,y);break;case"z":d.rotation.set(y,0,0);break}d.translateOnAxis(a,t.radius),d.position.x+=t.position[0]+c(v,Er(m,o.position[0])),d.position.y+=t.position[1]+c(v,Er(m,o.position[1])),d.position.z+=t.position[2]+c(v,Er(m,o.position[2]));let x=c(v,Er(m,o.rotation[0])),w=c(v,Er(m,o.rotation[1])),_=c(v,Er(m,o.rotation[2]));t.alignment===!0?(d.rotation.x+=s.x+x,d.rotation.y+=s.y+w,d.rotation.z+=s.z+_):d.rotation.set(s.x+x,s.y+w,s.z+_)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,r=new Es(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??dp.defaultData([1,1,1]).randomnessObject,n=this.getRandom(i),s=XA(i.strength,this.parameters.randomness);for(let[a,o]of this.children.entries()){let l=a*(i.freqScale/10)+i.movement,c=n.noise(l,l,l),u=a+1,d=s(u,Er(c,i.rotation[0])),f=s(u,Er(c,i.rotation[1])),m=s(u,Er(c,i.rotation[2]));o.scale.x=1+(t.scale[0]-1)*a+s(u,Er(c,i.scale[0]))||Ka,o.scale.y=1+(t.scale[1]-1)*a+s(u,Er(c,i.scale[1]))||Ka,o.scale.z=1+(t.scale[2]-1)*a+s(u,Er(c,i.scale[2]))||Ka,o.rotation.x=r.x*a+d,o.rotation.y=r.y*a+f,o.rotation.z=r.z*a+m,o.position.x=t.position[0]*a+s(u,Er(c,i.position[0])),o.position.y=t.position[1]*a+s(u,Er(c,i.position[1])),o.position.z=t.position[2]*a+s(u,Er(c,i.position[2]))}}_updateGrid(e){let t=0,r=e.grid,i=e.randomnessObject??dp.defaultData([1,1,1]).randomnessObject,n=this.getRandom(i,!0),s=XA(i.strength,this.parameters.randomness);if(r.useCenter===!0){let a={x:r.count[0]%2===0?2:1,y:r.count[1]%2===0?2:1,z:r.count[2]%2===0?2:1},o=new V(r.size[0]*(r.count[0]-a.x)*.5,r.size[1]*(r.count[1]-a.y)*.5,r.size[2]*(r.count[2]-a.z)*.5);for(let l=0;l<r.count[0];l++)for(let c=0;c<r.count[1];c++)for(let u=0;u<r.count[2];u++){let d=n.noise((l+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement),f=this.children[t++];f.scale.x=1+s(t,Er(d,i.scale[0]))||Ka,f.scale.y=1+s(t,Er(d,i.scale[1]))||Ka,f.scale.z=1+s(t,Er(d,i.scale[2]))||Ka;let m=s(t,Er(d,i.rotation[0])),v=s(t,Er(d,i.rotation[1])),y=s(t,Er(d,i.rotation[2]));f.rotation.set(m,v,y),f.position.x=r.size[0]*l-o.x+s(t,Er(d,i.position[0])),f.position.y=r.size[1]*c-o.y+s(t,Er(d,i.position[1])),f.position.z=r.size[2]*u-o.z+s(t,Er(d,i.position[2]))}}else for(let a=0;a<r.count[0];a++)for(let o=0;o<r.count[1];o++)for(let l=0;l<r.count[2];l++){let c=n.noise((a+1)*(i.freqScale/10)+i.movement,(o+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement),u=this.children[t++];u.scale.x=1+s(t,Er(c,i.scale[0]))||Ka,u.scale.y=1+s(t,Er(c,i.scale[1]))||Ka,u.scale.z=1+s(t,Er(c,i.scale[2]))||Ka;let d=s(t,Er(c,i.rotation[0])),f=s(t,Er(c,i.rotation[1])),m=s(t,Er(c,i.rotation[2]));u.rotation.set(d,f,m),u.position.x=r.size[0]*a+s(t,Er(c,i.position[0])),u.position.y=-r.size[1]*o+s(t,Er(c,i.position[1])),u.position.z=-r.size[2]*l+s(t,Er(c,i.position[2]))}}_updateToObject(e){if(e.type!=="toObject")throw new Error;let{toObject:t}=e,r=new Es(t.rotation[0],t.rotation[1],t.rotation[2]),i=e.randomnessObject??dp.defaultData([1,1,1]).randomnessObject,n=this.getRandom(i),s=XA(i.strength,this.parameters.randomness);if(!t.object){for(let[,u]of this.children.entries())u.position.set(0,0,0),u.scale.setScalar(1),u.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof YB)if(!this.objectForSample.font?.isLoaded||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let a=this.getSubdivData();if(a.length>0){let u=Math.round(a.length*t.count/100);this._updateCount(u)}else{let u=this.objectForSample.geometry.getAttribute("position");if(!u||isNaN(u.count)||u.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let o=new MLe(this.objectForSample).build(),l=zBe[t.axis],c=this.children;o.setRandomGenerator((0,UL.default)(this.object.uuid+t.seed));for(let[u,d]of c.entries()){let f=u*(i.freqScale/10)+i.movement,m=n.noise(f,f,f),v=u+1,y=s(v,Er(m,i.rotation[0])),x=s(v,Er(m,i.rotation[1])),w=s(v,Er(m,i.rotation[2]));t.spreadType==="random"?o.sample(Y1,Y4):(a.length&&(Y1.fromArray(a[u].pos),Y4.fromArray(a[u].norm)),this.objectForSample instanceof X2&&Y1.applyMatrix4($Be.copy(this.objectForSample.matrixWorld).invert())),Y1.applyMatrix4(this.object.hiddenMatrix.clone().invert()),d.position.copy(Y1),kf.fromArray(l);let _=t.align==="normal"?Y4:this.object.getWorldDirection(ZBe),S=QA.fromArray(t.position);QA.x+=s(v,Er(m,i.position[0])),QA.y+=s(v,Er(m,i.position[1])),QA.z+=s(v,Er(m,i.position[2]));let P=Math.acos(_.dot(kf)),M=QBe.crossVectors(kf,_).normalize(),C=KBe.makeRotationAxis(M,P),T=_.clone().cross(this.object.up).normalize(),E=T.clone().cross(_).normalize(),N=new ot().makeBasis(T,_,E),D=new V(kf.y,kf.z,kf.x).normalize(),I=D.clone().cross(kf).normalize(),j=new ot().makeBasis(D,kf,I).invert(),L=new ot().multiplyMatrices(N,j);d.rotation.setFromRotationMatrix(L),S.applyMatrix4(C),d.position.add(S),d.rotation.x=d.rotation.x+r.x+y,d.rotation.y=d.rotation.y+r.y+x,d.rotation.z=d.rotation.z+r.z+w,d.scale.setScalar(1),d.scale.x=d.scale.x+t.scale[0]+s(v,Er(m,i.scale[0]))||Ka,d.scale.y=d.scale.y+t.scale[1]+s(v,Er(m,i.scale[1]))||Ka,d.scale.z=d.scale.z+t.scale[2]+s(v,Er(m,i.scale[2]))||Ka,d.scale.multiply(this.object.scale),d.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType,t=new Map,r=(n,s)=>{let a=Math.round(n[0]*1e4)+"_"+Math.round(n[1]*1e4)+"_"+Math.round(n[2]*1e4),o=t.get(a);o?(o.pos[0]+=n[0],o.pos[1]+=n[1],o.pos[2]+=n[2],o.norm[0]+=s[0],o.norm[1]+=s[1],o.norm[2]+=s[2],o.count+=1):t.set(a,{pos:[...n],norm:[...s],count:1})};if(e==="random")return[];if(this.objectForSample instanceof X2){let n=this.objectForSample,s=BBe[e],a=Wae[s],o=Hae[s],l=Gae[s],c=a(n.subdivPointerNew);for(let u=0;u<=c-1;u++){let d=o(n.subdivPointerNew,u),f=l(n.subdivPointerNew,u);SX.fromArray(d).applyMatrix4(n.matrixWorld),EX.fromArray(f),r(SX.toArray(),EX.toArray())}}else(this.objectForSample.geometry.index?HBe(this.objectForSample.geometry):GBe(this.objectForSample.geometry)).forEach((n,s)=>{e==="polygon_center"&&r(n.midpoint,n.norm),e==="vertex"&&(r(n.vertices[0],n.norm),r(n.vertices[1],n.norm),r(n.vertices[2],n.norm)),e==="edge"&&(r(n.faceCenters[0],n.norm),r(n.faceCenters[1],n.norm),r(n.faceCenters[2],n.norm))});let i=Array.from(t.values());for(let n of i)n.pos[0]/=n.count,n.pos[1]/=n.count,n.pos[2]/=n.count,n.norm[0]/=n.count,n.norm[1]/=n.count,n.norm[2]/=n.count;return i}updateState(e,t){if(this.parameters=z3(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),this.object.parent?.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let r=t.find(this.parameters.toObject.object);r instanceof uo?this.objectForSample=r:this.objectForSample=void 0,this.matrix=new ot,this.hiddenMatrix=new ot,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,r&&r.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},U_=e=>{var t;return t=class extends e{},t.geometryHelper=new Fc(30,30,30),t},ZA=new Wx,X4=new Oo,AX=new ot,H_=(e,t,r,i,n=!1,s=e)=>{let a=t,o=s.matrixWorld;if(a.boundingSphere===null&&a.computeBoundingSphere(),X4.copy(a.boundingSphere),X4.applyMatrix4(o),r.ray.intersectsSphere(X4)===!1||(AX.copy(o).invert(),ZA.copy(r.ray).applyMatrix4(AX),a.boundingBox!==null&&ZA.intersectsBox(a.boundingBox)===!1))return;let l,c,u,d,f=a.index,m=a.attributes.position,v=a.drawRange,y,x;if(n===!1){let _=Math.max(0,v.start),S=Math.min(f.count,v.start+v.count);for(y=_,x=S;y<x;y+=3)if(c=f.getX(y),u=f.getX(y+1),d=f.getX(y+2),l=w(e,r,ZA,m,c,u,d),l){l.faceIndex=Math.floor(y/3),i.push(l);return}}else{let _=a.attributes.position,S=new V,P=new V,M=new V,C=new V,T=2,E=1/((s.scale.x+s.scale.y+s.scale.z)/3),N=E*E,D=Math.max(0,v.start),I=Math.min(_.count,v.start+v.count);for(let j=D,L=I-1;j<L;j+=T){if(S.fromBufferAttribute(_,j),P.fromBufferAttribute(_,j+1),ZA.distanceSqToSegment(S,P,C,M)>N)continue;C.applyMatrix4(s.matrixWorld);let B=r.ray.origin.distanceTo(C);B<r.near||B>r.far||i.push({distance:B,point:M.clone().applyMatrix4(s.matrixWorld),object:e})}}function w(_,S,P,M,C,T,E){let N=new V,D=new V,I=new V,j=new V,L=new V;if(N.fromBufferAttribute(M,C),D.fromBufferAttribute(M,T),I.fromBufferAttribute(M,E),P.intersectTriangle(N,D,I,!1,j)===null)return null;L.copy(j),L.applyMatrix4(_.matrixWorld);let B=S.ray.origin.distanceTo(L);return B<S.near||B>S.far?null:{faceIndex:1,distance:B,point:L.clone(),object:_}}},JA=new V,Cl=new em,eFe=class extends R_{constructor(e){let t=new Lt,r=new tm({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={},a=new Zt(15711266),o=new Zt(15711266),l=new Zt(2857471);c("n1","n2",a),c("n2","n4",a),c("n4","n3",a),c("n3","n1",a),c("f1","f2",a),c("f2","f4",a),c("f4","f3",a),c("f3","f1",a),c("n1","f1",a),c("n2","f2",a),c("n3","f3",a),c("n4","f4",a),c("p","n1",o),c("p","n2",o),c("p","n3",o),c("p","n4",o),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(d,f,m){u(d,m),u(f,m)}function u(d,f){i.push(0,0,0),n.push(f.r,f.g,f.b),s[d]===void 0&&(s[d]=[]),s[d].push(i.length/3-1)}t.setAttribute("position",new At(i,3)),t.setAttribute("color",new At(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;Cl.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let r=1,i=1,n=.8;lc("n1",t,e,Cl,-r,-i,n),lc("n2",t,e,Cl,r,-i,n),lc("n3",t,e,Cl,-r,i,n),lc("n4",t,e,Cl,r,i,n);let s=n;lc("f1",t,e,Cl,-r,-i,s),lc("f2",t,e,Cl,r,-i,s),lc("f3",t,e,Cl,-r,i,s),lc("f4",t,e,Cl,r,i,s);let a=s,o=.5;lc("u1",t,e,Cl,r*.7*o,i*1.1,a),lc("u2",t,e,Cl,-r*.7*o,i*1.1,a),lc("u3",t,e,Cl,0,i*(1.1+.9*o),a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function lc(e,t,r,i,n,s,a){JA.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],JA.x,JA.y,JA.z)}}var tFe=class extends U_(eFe){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){H_(this.object,this.geometry,e,t,!0)}},n5;(e=>e.is=t=>"objectHelper"in t)(n5||(n5={}));var ab=(e,t)=>class extends PB(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(r,i){this.objectHelper.raycast(r,i)}showGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof pM&&(i.visible=!0)}}updateEntityBoxSize(r,i){this.objectHelper.visible&&this.geometryHelper instanceof Fc?(r.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(r,i)}hideGizmos(){for(let r in this.gizmos){let i=this.gizmos[r];i instanceof pM&&(i.visible=!1)}}},eC=790,Ov=new V,$4=new V,K4=new ar,Q4=new V,X1=new V,Z4=new V,Ba=class extends ab(em,tFe){constructor(e="",t={...F2.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=dx.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new ot,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let r=this.width,i=this.height;this.orthoCamera=new M3(r*-.5,r*.5,i*.5,i*-.5,-5e4,1e4),this.perspCamera=new Ra(45,r/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,r){typeof e=="number"&&(e=new V(e,t,r)),super.lookAt(e),this.getWorldPosition(Ov),this.targetOffset=Ov.distanceTo(e)}getTarget(e=new V){return this.getWorldDirection($4),this.getWorldPosition(Ov),$4.multiplyScalar(this.targetOffset),e.copy(Ov).add($4),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(Ov),Ov.distanceTo(e)}updateUp(){this.getWorldQuaternion(K4),Q4.set(0,0,1).applyQuaternion(K4),X1.copy(Ei.DEFAULT_UP),this.isUpVectorFlipped&&X1.negate(),X1.applyQuaternion(K4),Z4.copy(Ei.DEFAULT_UP).projectOnPlane(Q4),this.angleOffsetFromUp=Z4.angleTo(X1),this.angleOffsetFromUp*=Z4.cross(X1).dot(Q4)>=0?1:-1}updateTransformState(e,t){let r=super.updateTransformState(e,t);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),r}getViewFrontToObject(e){let t=e.getWorldPosition(new V),r=e.getWorldDirection(new V).multiplyScalar(this.targetOffset);return{position:t.clone().add(r),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new V).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new V;return e.getWorldPosition(t),this.getViewToTarget(t)}setViewplaneSize(e,t,r=!1){if(this.aspect=e/t,r){let i=e>t?this.aspect:1,n=e>t?1:this.aspect;this.left=-eC*.5*i,this.right=eC*.5*i,this.top=eC*.5*(1/n),this.bottom=-eC*.5*(1/n)}else this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,r,i,n,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,r,i,n,s):this.orthoCamera.setViewOffset(e,t,r,i,n,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return $j(t,e)}updateCameraSubtype(e,t){let r=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";t.zoom!==void 0&&this.setZoom(r,t.zoom),t.near!==void 0&&this.setNear(r,t.near),t.fov!==void 0&&r==="PerspectiveCamera"&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},jv=new ot,rFe=new ot;function CX(e){let t=!1;return e.scene.objects.traverse((r,i)=>{i.geometry?.type==="BooleanGeometry"&&(t=!0)}),t}var $g=class extends sb{constructor(e,t,r){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Lt,this.onAfterRender=(i,n,s,a,o,l)=>{super.onAfterRender(i,n,s,a,o,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){if(this.booleanMeshSetAddress!==-1&&!e)return;for(let i=0;i<this.children.length;i++){let n=this.children[i];n instanceof $g&&n.dataPatched.visible===!0&&n.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let i=0;i<this.children.length;i++){let n=this.children[i];if(n instanceof uo&&n.dataPatched.visible===!0&&n.geometry.attributes.position?.count>0&&n.geometry.drawRange.count>0&&n.booleanMeshSetAddress!==0){jv.multiplyMatrices(n.hiddenMatrix,n.matrix);try{if(n.booleanMeshSetAddress===-1){if((n.geometry.index??n.geometry.getAttribute("position")).count/3<15e5&&(n.booleanMeshSetAddress=rh.getMeshSet(n.geometry,e===!0,t)),n.booleanMeshSetAddress===-1)return;rh.transformMeshSet(n.booleanMeshSetAddress,jv),n.booleanMatrixInvOld.copy(jv).invert(),n.booleanWasTransformed=!1}else n instanceof $g&&n.needsTransformForDownstream===!0?(rh.transformMeshSet(n.booleanMeshSetAddress,jv),n.needsTransformForDownstream=!1):n.booleanWasTransformed===!0&&(rh.transformMeshSet(n.booleanMeshSetAddress,rFe.multiplyMatrices(jv,n.booleanMatrixInvOld)),n.booleanMatrixInvOld.copy(jv).invert(),n.booleanWasTransformed=!1)}catch(s){console.error(s),n.booleanMeshSetAddress=0,n.geometry.userData.booleanOperationDidFail=!0;continue}rh.hasOpenEdges(n.booleanMeshSetAddress)===!1||i===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(n.booleanMeshSetAddress),n.geometry.userData.booleanOperationDidFail=!1):n.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new At([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return rh.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let r=this.geometry;r.dispose(),this.geometry=new Lt,this.geometry.userData=r.userData,this.geometry.boundingSphere=r.boundingSphere;try{this.booleanMeshSetAddress=rh.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(i){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(i)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,WB(this),qB(this)}dispose(){super.dispose(),this.geometry.dispose()}},s5;(e=>{function t(r){return Xr.is(r)&&r instanceof j_}e.is=t})(s5||(s5={}));var XB=(e,t)=>class extends ab(e,t){updateState_Light(r,i){this.updateState_Entity(r,i),r.color!==void 0&&(this.color=i.shared.color(r.color)),r.intensity!==void 0&&(this.intensity=r.intensity),r.depth!==void 0&&(this.shadow.camera.far=r.depth,this.shadow.needsUpdate=!0),r.shadows!==void 0&&(this.castShadow=r.shadows)}},yc=e=>e instanceof uo,xh=e=>e!==null&&e instanceof $g,iFe=e=>e instanceof Ba,nFe=e=>s5.is(e),a5=e=>n5.is(e),sFe=new V(1,1,1),TX=new V,aFe=new V,MX=new ar,G_=class extends U_(cMe){constructor(e,t=15){super(t),this.object=e,this.dummy=new gh,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=this.dummy.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){H_(this.object,G_.geometryHelper,e,t,!1,this.dummy)}update(){}updateMatrix(){}updateMatrixWorld(e){this.object.matrixWorld.decompose(TX,MX,aFe),this.matrix.compose(TX,MX,sFe),super.updateMatrixWorld(e)}updateWorldMatrix(e,t){}},Vy=class extends ab(gh,G_){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t),"buffer"in e&&Object.keys(e).length===1&&t.scene.reloadSplats()}},Qw=class extends ab(gh,G_){constructor(e,t,r){super(),this.super_Entity(e,t),this.context=r,this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},qae={RED:0,GREEN:1},W_="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",oFe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;uniform vec4 kernel64[32];varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;}}`,tC=class extends Jr{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new it(null),kernel16:new it(null),inputBuffer:new it(null),cocBuffer:new it(null),texelSize:new it(new ge),scale:new it(1)},blending:cs,depthWrite:!1,depthTest:!1,fragmentShader:oFe,vertexShader:W_}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),r=new Float32Array(32),i=0,n=0;for(let o=0;o<80;++o){let l=o*e,c=Math.sqrt(o)/Math.sqrt(80),u=c*Math.cos(l),d=c*Math.sin(l);o%5===0?(r[n++]=u,r[n++]=d):(t[i++]=u,t[i++]=d)}let s=[],a=[];for(let o=0;o<128;)s.push(new fr(t[o++],t[o++],t[o++],t[o++]));for(let o=0;o<32;)a.push(new fr(r[o++],r[o++],r[o++],r[o++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=a}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function PX(e,t,r){return e*(t-r)-t}function o5(e,t,r){return Math.min(Math.max((e+t)/(t-r),0),1)}var lFe=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,cFe=class extends Jr{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new it(null),focusDistance:new it(0),focusRange:new it(0),cameraNear:new it(.3),cameraFar:new it(1e3)},blending:cs,depthWrite:!1,depthTest:!1,fragmentShader:lFe,vertexShader:W_}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=Kh){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-PX(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=o5(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-PX(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=o5(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Ra?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},uFe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,dFe="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",DX=class extends Jr{constructor(e=new ge){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new it(null),texelSize:new it(new ge),halfTexelSize:new it(new ge),kernel:new it(0),scale:new it(1)},blending:cs,depthWrite:!1,depthTest:!1,fragmentShader:uFe,vertexShader:dFe}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.halfTexelSize.value.copy(r.texelSize.value).multiplyScalar(.5)}},hFe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,fFe=class extends Jr{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new it(null),opacity:new it(1)},blending:cs,depthWrite:!1,depthTest:!1,fragmentShader:hFe,vertexShader:W_}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},pFe=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,mFe=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,X3={COLOR:2},gFe={DISABLED:0},vFe=class extends Jr{constructor(e=new ge,t=X3.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:Gx.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new it(null),depthBuffer:new it(null),predicationBuffer:new it(null),texelSize:new it(e)},blending:cs,depthWrite:!1,depthTest:!1,fragmentShader:pFe,vertexShader:mFe}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=Kh){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},yFe=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,xFe="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",cc={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},l5=class extends Jr{constructor(e,t,r,i,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Gx.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new it(null),depthBuffer:new it(null),resolution:new it(new ge),texelSize:new it(new ge),cameraNear:new it(.3),cameraFar:new it(1e3),aspect:new it(1),time:new it(0)},blending:cs,depthWrite:!1,depthTest:!1,dithering:n}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),r&&this.setUniforms(r),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=Kh){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=yFe.replace(cc.FRAGMENT_HEAD,e.get(cc.FRAGMENT_HEAD)).replace(cc.FRAGMENT_MAIN_UV,e.get(cc.FRAGMENT_MAIN_UV)).replace(cc.FRAGMENT_MAIN_IMAGE,e.get(cc.FRAGMENT_MAIN_IMAGE)),this.vertexShader=xFe.replace(cc.VERTEX_HEAD,e.get(cc.VERTEX_HEAD)).replace(cc.VERTEX_MAIN_SUPPORT,e.get(cc.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Ra?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let r=this.uniforms;r.resolution.value.set(e,t),r.texelSize.value.set(1/e,1/t),r.aspect.value=e/t}static get Section(){return cc}},bFe=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,wFe=class extends Jr{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Gx.replace(/\D+/g,"")},uniforms:{inputBuffer:new it(null),threshold:new it(0),smoothing:new it(1),range:new it(null)},blending:cs,depthWrite:!1,depthTest:!1,fragmentShader:bFe,vertexShader:W_}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},_Fe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,Yae={DISCARD:0,MULTIPLY:1},SFe=class extends Jr{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new it(e),inputBuffer:new it(null),strength:new it(1)},blending:cs,depthWrite:!1,depthTest:!1,fragmentShader:_Fe,vertexShader:W_}),this.toneMapped=!1,this.setColorChannel(qae.RED),this.setMaskFunction(Yae.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==Fa&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},EFe=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,AFe="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",CFe=class extends Jr{constructor(e=new ge,t=new ge){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new it(null),searchTexture:new it(null),areaTexture:new it(null),resolution:new it(t),texelSize:new it(e)},blending:cs,depthWrite:!1,depthTest:!1,fragmentShader:EFe,vertexShader:AFe}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.resolution.value.set(e,t)}},TFe=new em,Rf=null;function MFe(){if(Rf===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);Rf=new Lt,Rf.setAttribute!==void 0?(Rf.setAttribute("position",new Jt(e,3)),Rf.setAttribute("uv",new Jt(t,2))):(Rf.addAttribute("position",new Jt(e,3)),Rf.addAttribute("uv",new Jt(t,2)))}return Rf}var fo=class{constructor(e="Pass",t=new Ro,r=TFe){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Yi(MFe(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new Ro),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=Kh){}render(e,t,r,i,n){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof Ro||t===this.renderer)continue;this[e].dispose()}}}},c5=class extends fo{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new fFe,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Zr(1,1,{minFilter:Pr,magFilter:Pr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,r,i,n){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,r){r!==void 0&&(this.renderTarget.texture.type=r,r!==Fa?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===Ar&&(this.renderTarget.texture.encoding=Ar))}},PFe=class extends fo{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,r,i,n){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},J4=new Zt,$B=class extends fo{constructor(e=!0,t=!0,r=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=r,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,r){this.color=e,this.depth=t,this.stencil=r}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,r,i,n){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=s!==null,c=a>=0;l?(J4.copy(e.getClearColor(J4)),e.setClearColor(s,c?a:o)):c&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(J4,o):c&&e.setClearAlpha(o)}},If=-1,Mo=class extends wa{constructor(e,t=If,r=If,i=1){super(),this.resizable=e,this.base=new ge(1,1),this.preferred=new ge(t,r),this.target=this.preferred,this.s=i}get width(){let{base:e,preferred:t,scale:r}=this,i;return t.width!==If?i=t.width:t.height!==If?i=Math.round(t.height*(e.width/Math.max(e.height,1))):i=Math.round(e.width*r),i}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:r}=this,i;return t.height!==If?i=t.height:t.width!==If?i=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):i=Math.round(e.height*r),i}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(If),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return If}},eI=!1,NX=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let r;if(t.material.flatShading)switch(t.material.side){case La:r=this.materialsFlatShadedDoubleSide;break;case Ys:r=this.materialsFlatShadedBackSide;break;default:r=this.materialsFlatShaded;break}else switch(t.material.side){case La:r=this.materialsDoubleSide;break;case Ys:r=this.materialsBackSide;break;default:r=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=r[2]:t.isInstancedMesh?t.material=r[1]:t.material=r[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let r of t)r.uniforms=Object.assign({},e.uniforms),r.side=zc;t[2].skinning=!0,this.materialsBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=Ys,i}),this.materialsDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=La,i}),this.materialsFlatShaded=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=Ys,i}),this.materialsFlatShadedDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=La,i})}}render(e,t,r){let i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,eI){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);for(let s of n)s[0].material=s[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=n}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return eI}static set workaroundEnabled(e){eI=e}},DFe=class extends fo{constructor(e,t,r=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new $B,this.overrideMaterialManager=r===null?null:new NX(r),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new NX(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=s.background,u=e.shadowMap.autoUpdate,d=this.renderToScreen?null:t;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(d),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=c,e.shadowMap.autoUpdate=u}},kX=class extends fo{constructor(e,t,{resolutionScale:r=1,width:i=Mo.AUTO_SIZE,height:n=Mo.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new DFe(e,t,new wie({depthPacking:aie}));let a=this.renderPass;a.skipShadowMapUpdate=!0,a.ignoreBackground=!0;let o=a.getClearPass();o.overrideClearColor=new Zt(16777215),o.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new Zr(1,1,{minFilter:jr,magFilter:jr,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new Mo(this,i,n,r);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}},ri={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},NFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",kFe="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",RFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",IFe="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",OFe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",jFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",LFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",zFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",BFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",FFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",VFe="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",UFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",HFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",GFe="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",WFe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",qFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",YFe="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",XFe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",$Fe=new Map([[ri.SKIP,null],[ri.ADD,NFe],[ri.ALPHA,kFe],[ri.AVERAGE,RFe],[ri.COLOR_BURN,IFe],[ri.COLOR_DODGE,OFe],[ri.DARKEN,jFe],[ri.DIFFERENCE,LFe],[ri.EXCLUSION,zFe],[ri.LIGHTEN,BFe],[ri.MULTIPLY,FFe],[ri.DIVIDE,VFe],[ri.NEGATION,UFe],[ri.NORMAL,HFe],[ri.OVERLAY,GFe],[ri.REFLECT,WFe],[ri.SCREEN,qFe],[ri.SOFT_LIGHT,YFe],[ri.SUBTRACT,XFe]]),KFe=class extends wa{constructor(e,t=1){super(),this.f=e,this.opacity=new it(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return $Fe.get(this.blendFunction)}},Fu={NONE:0,DEPTH:1,CONVOLUTION:2},pd=class extends wa{constructor(e,t,{attributes:r=Fu.NONE,blendFunction:i=ri.SCREEN,defines:n=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=e,this.renderer=null,this.attributes=r,this.fragmentShader=t,this.vertexShader=o,this.defines=n,this.uniforms=s,this.extensions=a,this.blendMode=new KFe(i),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=Kh){}update(e,t,r){}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t=="object"&&typeof t.dispose=="function"){if(t instanceof Ro||t===this.renderer)continue;this[e].dispose()}}}};function RX(e,t,r){for(let i of t){let n="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let a of r.entries())a[1]!==null&&r.set(a[0],a[1].replace(s,n))}}function QFe(e,t,r,i,n,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=o.get("fragment")!==void 0&&/mainImage/.test(o.get("fragment")),c=o.get("fragment")!==void 0&&/mainUv/.test(o.get("fragment")),u=[],d=[],f=!1,m=!1;if(o.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(c&&(a&Fu.CONVOLUTION)!==0)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let v=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,y=l5.Section;if(c){let w=`	${e}MainUv(UV);
`;r.set(y.FRAGMENT_MAIN_UV,r.get(y.FRAGMENT_MAIN_UV)+w),f=!0}if(o.get("vertex")!==null&&/mainSupport/.test(o.get("vertex"))){let w=`	${e}MainSupport(`;w+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?`vUv);
`:`);
`,r.set(y.VERTEX_MAIN_SUPPORT,r.get(y.VERTEX_MAIN_SUPPORT)+w),u=u.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(_=>_[1])),d=d.concat(u).concat([...o.get("vertex").matchAll(v)].map(_=>_[1]))}d=d.concat([...o.get("fragment").matchAll(v)].map(w=>w[1])),d=d.concat([...t.defines.keys()].map(w=>w.replace(/\([\w\s,]*\)/g,""))),d=d.concat([...t.uniforms.keys()]),t.uniforms.forEach((w,_)=>s.set(e+_.charAt(0).toUpperCase()+_.slice(1),w)),t.defines.forEach((w,_)=>n.set(e+_.charAt(0).toUpperCase()+_.slice(1),w)),RX(e,d,n),RX(e,d,o);let x=t.blendMode;if(i.set(x.blendFunction,x),l){let w=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,_=`${e}MainImage(color0, UV, `;(a&Fu.DEPTH)!==0&&w.test(o.get("fragment"))&&(_+="depth, ",m=!0),_+=`color1);
	`;let S=e+"BlendOpacity";s.set(S,x.opacity),_+=`color0 = blend${x.blendFunction}(color0, color1, ${S});

	`,r.set(y.FRAGMENT_MAIN_IMAGE,r.get(y.FRAGMENT_MAIN_IMAGE)+_),_=`uniform float ${S};

`,r.set(y.FRAGMENT_HEAD,r.get(y.FRAGMENT_HEAD)+_)}r.set(y.FRAGMENT_HEAD,r.get(y.FRAGMENT_HEAD)+o.get("fragment")+`
`),o.get("vertex")!==null&&r.set(y.VERTEX_HEAD,r.get(y.VERTEX_HEAD)+o.get("vertex")+`
`)}return{varyings:u,transformedUv:f,readDepth:m}}var QM=class extends fo{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new l5(null,null,null,e),this.effects=t.sort((r,i)=>i.attributes-r.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=l5.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),r=new Map,i=new Map,n=new Map,s=new Set,a=0,o=0,l=0,c=!1,u=!1;for(let f of this.effects)if(f.blendMode.blendFunction===ri.SKIP)l|=f.getAttributes()&Fu.DEPTH;else if((l&f.getAttributes()&Fu.CONVOLUTION)!==0)console.error("Convolution effects cannot be merged",f);else{l|=f.getAttributes();let m="e"+a++,v=QFe(m,f,t,r,i,n,l);if(o+=v.varyings.length,c=c||v.transformedUv,u=u||v.readDepth,f.extensions!==null)for(let y of f.extensions)s.add(y)}let d=/\bblend\b/g;for(let f of r.values()){let m=f.getShaderCode().replace(d,`blend${f.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+m+`
`)}(l&Fu.DEPTH)!==0?(u&&t.set(e.FRAGMENT_MAIN_IMAGE,`float depth = readDepth(UV);

	`+t.get(e.FRAGMENT_MAIN_IMAGE)),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,c?(t.set(e.FRAGMENT_MAIN_UV,`vec2 transformedUv = vUv;
`+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")):i.set("UV","vUv"),t.forEach((f,m,v)=>v.set(m,f.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=o,this.skipRendering=a===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(n).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=Kh){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let r of this.effects)r.setDepthTexture(e,t)}render(e,t,r,i,n){for(let s of this.effects)s.update(e,t,i);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,s.time+=i,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let r of this.effects)r.setSize(e,t)}initialize(e,t,r){this.renderer=e;for(let i of this.effects)i.initialize(e,t,r),i.addEventListener("change",n=>this.handleEvent(n));this.updateMaterial(),this.verifyResources(),r!==void 0&&r!==Fa&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},ZFe=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],KB=class extends fo{constructor({resolutionScale:e=.5,width:t=Mo.AUTO_SIZE,height:r=Mo.AUTO_SIZE,kernelSize:i=$3.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Zr(1,1,{minFilter:Pr,magFilter:Pr,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let n=this.resolution=new Mo(this,t,r,e);n.addEventListener("change",s=>this.setSize(n.baseWidth,n.baseHeight)),this.blurMaterial=new DX,this.ditheredBlurMaterial=new DX,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,c=ZFe[this.kernelSize],u=this.blurMaterial,d=t,f,m;for(this.fullscreenMaterial=u,f=0,m=c.length-1;f<m;++f){let v=(f&1)===0?o:l;u.kernel=c[f],u.inputBuffer=d.texture,e.setRenderTarget(v),e.render(s,a),d=v}this.dithering&&(u=this.ditheredBlurMaterial,this.fullscreenMaterial=u),u.kernel=c[f],u.inputBuffer=d.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(s,a)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height;this.renderTargetA.setSize(i,n),this.renderTargetB.setSize(i,n),this.blurMaterial.setSize(i,n),this.ditheredBlurMaterial.setSize(i,n)}initialize(e,t,r){r!==void 0&&(this.renderTargetA.texture.type=r,this.renderTargetB.texture.type=r,r!==Fa?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===Ar&&(this.renderTargetA.texture.encoding=Ar,this.renderTargetB.texture.encoding=Ar))}static get AUTO_SIZE(){return Mo.AUTO_SIZE}},JFe=class extends fo{constructor({width:e=Mo.AUTO_SIZE,height:t=Mo.AUTO_SIZE,renderTarget:r,luminanceRange:i,colorOutput:n}={}){super("LuminancePass"),this.fullscreenMaterial=new wFe(n,i),this.needsSwap=!1,this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new Zr(1,1,{minFilter:Pr,magFilter:Pr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new Mo(this,e,t);s.addEventListener("change",a=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,r,i,n){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}initialize(e,t,r){r!==void 0&&r!==Fa&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},eVe=class extends fo{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new $B(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,r,i,n){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,d=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(d),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(r),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},jl=class extends fo{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,r,i,n){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}initialize(e,t,r){r!==void 0&&r!==Fa&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},tI=1/1e3,tVe=1e3,rVe=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*tI}getFixedDelta(){return this.fixedDelta*tI}setFixedDelta(e){return this.fixedDelta=e*tVe,this}getElapsed(){return this.elapsed*tI}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},$3={MEDIUM:2,LARGE:3,HUGE:5},iVe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,nVe=class extends pd{constructor({blendFunction:e=ri.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:r=.025,resolutionScale:i=.5,intensity:n=1,width:s=Mo.AUTO_SIZE,height:a=Mo.AUTO_SIZE,kernelSize:o=$3.LARGE}={}){super("BloomEffect",iVe,{blendFunction:e,uniforms:new Map([["map",new it(null)],["intensity",new it(n)]])}),this.renderTarget=new Zr(1,1,{minFilter:Pr,magFilter:Pr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new JFe({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=r,this.blurPass=new KB({resolutionScale:i,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,r){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.luminancePass.resolution.copy(r)}initialize(e,t,r){this.blurPass.initialize(e,t,r),r!==void 0&&(this.renderTarget.texture.type=r,e.outputEncoding===Ar&&(this.renderTarget.texture.encoding=Ar))}},sVe="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",aVe=class extends pd{constructor({blendFunction:e=ri.NORMAL,brightness:t=0,contrast:r=0}={}){super("BrightnessContrastEffect",sVe,{blendFunction:e,uniforms:new Map([["brightness",new it(t)],["contrast",new it(r)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},oVe="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",lVe=class extends pd{constructor(e=ri.NORMAL){super("ColorAverageEffect",oVe,{blendFunction:e})}},cVe="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",uVe="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",dVe=class extends pd{constructor({blendFunction:e=ri.NORMAL,offset:t=new ge(.001,5e-4)}={}){super("ChromaticAberrationEffect",cVe,{vertexShader:uVe,blendFunction:e,attributes:Fu.CONVOLUTION,uniforms:new Map([["offset",new it(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},hVe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,fVe=class extends pd{constructor(e,{blendFunction:t=ri.NORMAL,worldFocusDistance:r,worldFocusRange:i,focusDistance:n=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=Mo.AUTO_SIZE,height:c=Mo.AUTO_SIZE}={}){super("DepthOfFieldEffect",hVe,{blendFunction:t,attributes:Fu.DEPTH,uniforms:new Map([["nearColorBuffer",new it(null)],["farColorBuffer",new it(null)],["nearCoCBuffer",new it(null)],["scale",new it(1)]])}),this.camera=e,this.renderTarget=new Zr(1,1,{minFilter:Pr,magFilter:Pr,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new jl(new cFe(e));let u=this.cocMaterial;u.focusDistance=n,u.focusRange=a,r!==void 0&&(u.worldFocusDistance=r),i!==void 0&&(u.worldFocusRange=i),this.blurPass=new KB({kernelSize:$3.MEDIUM,width:l,height:c});let d=this.blurPass.getResolution();d.addEventListener("change",m=>this.setSize(d.getBaseWidth(),d.getBaseHeight())),this.maskPass=new jl(new SFe(this.renderTargetCoC.texture));let f=this.maskPass.fullscreenMaterial;f.maskFunction=Yae.MULTIPLY,f.colorChannel=qae.GREEN,this.bokehNearBasePass=new jl(new tC(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new jl(new tC(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new jl(new tC(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new jl(new tC(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let r of t)r.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,r=t.position.distanceTo(e);return o5(-r,t.near,t.far)}setDepthTexture(e,t=Kh){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,r){let i=this.renderTarget,n=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){let o=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=o}this.cocPass.render(e,null,n),this.blurPass.render(e,n,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(a=>a.setSize(e,t)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(a=>a.setSize(i,n)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(a=>a.fullscreenMaterial.setSize(i,n))}initialize(e,t,r){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(i=>i.initialize(e,t,r)),this.blurPass.initialize(e,t,Fa),r!==void 0&&(this.renderTarget.texture.type=r,this.renderTargetNear.texture.type=r,this.renderTargetFar.texture.type=r,this.renderTargetMasked.texture.type=r,e.outputEncoding===Ar&&(this.renderTarget.texture.encoding=Ar,this.renderTargetNear.texture.encoding=Ar,this.renderTargetFar.texture.encoding=Ar,this.renderTargetMasked.texture.encoding=Ar))}};new V;new ot;var pVe="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",mVe=class extends pd{constructor({blendFunction:e=ri.NORMAL,hue:t=0,saturation:r=0}={}){super("HueSaturationEffect",pVe,{blendFunction:e,uniforms:new Map([["hue",new it(new V)],["saturation",new it(r)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),r=Math.cos(e);this.uniforms.get("hue").value.set((2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new Zt;var gVe=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,vVe=class extends pd{constructor({blendFunction:e=ri.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",gVe,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},yVe="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",xVe=class extends pd{constructor(e=30){super("PixelationEffect",yVe,{uniforms:new Map([["active",new it(!1)],["d",new it(new ge)]])}),this.resolution=new ge,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new V;new V;var IX="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",OX="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",bVe="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",wVe="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",og={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},Xae=class extends pd{constructor({preset:e=og.MEDIUM,edgeDetectionMode:t=X3.COLOR,predicationMode:r=gFe.DISABLED}={}){super("SMAAEffect",bVe,{vertexShader:wVe,blendFunction:ri.NORMAL,attributes:Fu.CONVOLUTION|Fu.DEPTH,uniforms:new Map([["weightMap",new it(null)]])});let i,n;arguments.length>1&&(i=arguments[0],n=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new Zr(1,1,{minFilter:Pr,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new $B(!0,!1,!1),this.clearPass.overrideClearColor=new Zt(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new jl(new vFe),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new jl(new CFe);let s=new Fie;s.onLoad=()=>{let a=new yn(i);a.name="SMAA.Search",a.magFilter=jr,a.minFilter=jr,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!0,this.weightsMaterial.searchTexture=a;let o=new yn(n);o.name="SMAA.Area",o.magFilter=Pr,o.minFilter=Pr,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!1,this.weightsMaterial.areaTexture=o,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),i!==void 0&&n!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(i=new Image,n=new Image,i.addEventListener("load",()=>s.itemEnd("search")),n.addEventListener("load",()=>s.itemEnd("area")),i.src=IX,n.src=OX),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,r=this.weightsMaterial;switch(e){case og.LOW:t.edgeDetectionThreshold=.15,r.orthogonalSearchSteps=4,r.diagonalDetection=!1,r.cornerDetection=!1;break;case og.MEDIUM:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=8,r.diagonalDetection=!1,r.cornerDetection=!1;break;case og.HIGH:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=16,r.diagonalSearchSteps=8,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break;case og.ULTRA:t.edgeDetectionThreshold=.05,r.orthogonalSearchSteps=32,r.diagonalSearchSteps=16,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break}}setDepthTexture(e,t=Kh){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,r){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return IX}static get areaImageDataURL(){return OX}},_Ve=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,rC={DEFAULT:0,ESKIL:1},SVe=class extends pd{constructor({blendFunction:e=ri.NORMAL,technique:t=rC.DEFAULT,eskil:r=!1,offset:i=.5,darkness:n=.5}={}){super("VignetteEffect",_Ve,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new it(i)],["darkness",new it(n)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===rC.ESKIL}set eskil(e){this.technique=e?rC.ESKIL:rC.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},Qh=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(r){this.effect.blendMode.opacity.value=r},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(r){this.effect.blendMode.setBlendFunction(Number(r))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=ri.NORMAL}},EVe=class extends Qh{constructor(){super(nVe),this.blendFunction=ri.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},AVe=class extends Qh{constructor(){super(aVe)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},CVe=class extends Qh{constructor(){super(dVe),this.effect.offset=new ge(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},TVe=class extends Qh{constructor(){super(lVe)}},MVe=class extends Qh{constructor(){super(mVe),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},PVe=class extends Qh{constructor(){super(vVe),this.blendFunction=ri.OVERLAY}},DVe=class extends Qh{constructor(){super(SVe)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},NVe=class extends Qh{constructor(e){super(fVe)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e/2e3}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=this.isPerspectiveCamera?e/2e3:(e+992)/2e3}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}setCamera(e){let t=!1;(e.isPerspectiveCamera&&this.isPerspectiveCamera===!1||!e.isPerspectiveCamera&&this.isPerspectiveCamera===!0)&&(t=!0),e.isPerspectiveCamera?(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e.perspCamera),this.isPerspectiveCamera=!0):(this.effect.circleOfConfusionMaterial.adoptCameraSettings(e),this.isPerspectiveCamera=!1),t&&this.effect.setChanged()}},kVe=class extends Qh{constructor(){super(xVe)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},RVe=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,IVe=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,OVe=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,jVe=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,u5=class extends Jr{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new it(null)},blending:cs,depthWrite:!1,depthTest:!1,vertexShader:OVe,fragmentShader:jVe})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},LVe=class extends fo{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new u5,this.resolutionVector=new ge,this.resolveMaterial=new Jr({name:"TAAResolveMaterial",uniforms:{inputBuffer:new it(null),historyBuffer:new it(null),velocityBuffer:new it(null),depthBuffer:new it(null),resolution:new it(new ge)},blending:cs,depthWrite:!1,depthTest:!1,vertexShader:RVe,fragmentShader:IVe}),this.historyRenderTarget=new Zr(1024,1024,{minFilter:Pr,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Zr(1024,1024,{minFilter:Pr,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let r=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(r),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},zVe=class extends fo{constructor(e,t,r){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new kX(e,t,{renderTarget:r.transmissionDepthTarget}),this.passThroughMaterial=new u5,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new u5,this.depthPass=new kX(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,r){let i=this.camera.layers.mask,n=e;n.setRenderTarget(n.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],n.clear(),n.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,r),n.shadowMap.needsUpdate=!1,n.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=i}},jX=new Ro,BVe=new Jr({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),d5=class extends fo{constructor(e,t,r){super("OpaquePass",t??jX,r),this.MRTCompatible=!0,this.originalMaterials=[],this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??jX}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.length=0,this.scene.traverse(i=>{i.layers.isEnabled(3)&&i instanceof uo&&(this.originalMaterials.push([i,i.material]),i.material=BVe)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let r=this.renderToScreen?null:t;e.setRenderTarget(r),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach(i=>{i[0].material=i[1]})}},FVe=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:n=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new c5,this.depthTexture=null,this.timer=new rVe,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,r,n,i,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,r,n,i,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,r,n,i,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){let t=e.getSize(new ge),r=e.getContext().getContextAttributes()?.alpha??!1,i=this.inputBuffer.texture[0].type;i===Fa&&e.outputEncoding===Ar&&(this.inputBuffer.texture[0].encoding=Ar,this.outputBuffer.texture[0].encoding=Ar,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(t.width,t.height,!1);for(let n of this.passes)n.initialize(e,r,i)}}replaceRenderer(e,t=!0){let r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){let e=this.depthTexture=new ax(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.stencilBuffer?(e.format=Gg,e.type=Cg):e.type=ph,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i,n,s){let a=this.renderer,o=a===null?new ge:a.getDrawingBufferSize(new ge),l={minFilter:Pr,magFilter:Pr,wrapS:an,wrapT:an,stencilBuffer:t,depthBuffer:e},c;return i>0?(c=new Zr(o.width,o.height,l),c.samples=i):(n?(c=new fie(o.width,o.height,2,l),c.texture[1].type=Rh):c=new Zr(o.width,o.height,l),c.depthTexture=new ax(2048,2048),c.depthTexture.type=Ni),r===Fa&&a!==null&&a.outputEncoding===Ar&&(Array.isArray(c.texture)?c.texture.forEach(u=>u.encoding=Ar):c.texture.encoding=Ar),Array.isArray(c.texture)?c.texture.forEach((u,d)=>{u.name=`EffectComposer.Buffer ${n} ${d}`,u.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${n}`,c.texture.generateMipmaps=!1),c.name=s,c}addPass(e,t){let r=this.passes,i=this.renderer,n=i.getDrawingBufferSize(new ge),s=i.getContext().getContextAttributes()?.alpha??!1,a;if(e.MRTCompatible&&(a=this.inputBuffer.texture[0].type),e.MRTCompatible||(a=this.inputBuffer.texture.type),e.setRenderer(i),e.setSize(n.width,n.height),e.initialize(i,s,a),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let o=this.createDepthTexture();for(e of r)e.setDepthTexture(o)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){let i=(n,s)=>n||s.needsDepthTexture;t.reduce(i,!1)||e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null)}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,r=this.copyPass,i=this.inputBuffer,n=this.outputBuffer,s=this.inputBufferSingle,a=this.outputBufferSingle,o=!1,l,c,u,d;e===void 0&&(e=this.timer.update().getDelta());for(let f of this.passes)f.enabled&&(f.MRTCompatible?f.render(t,i,n,e,o):f.render(t,s,a,e,o),f.needsSwap&&(o&&(r.renderToScreen=f.renderToScreen,l=t.getContext(),c=t.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),r.render(t,i,n,e,o),c.setFunc(l.EQUAL,1,4294967295)),u=i,d=s,i=n,s=a,n=u,a=d),f instanceof eVe?o=!0:f instanceof PFe&&(o=!1))}setSize(e,t,r){let i=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let s=i.getSize(new ge);e=s.width,t=s.height}i.setSize(e,t,r);let n=i.getDrawingBufferSize(new ge);this.inputBuffer.setSize(n.width,n.height),this.outputBuffer.setSize(n.width,n.height),this.inputBufferSingle.setSize(n.width,n.height),this.outputBufferSingle.setSize(n.width,n.height);for(let s of this.passes)s.setSize(n.width,n.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},VVe=new Jr({name:"CombineMaterial",uniforms:{inputBufferA:new it(null),inputBufferB:new it(null)},blending:cs,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),UVe=class extends fo{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=VVe,this.helperPass=new d5(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new d5(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new Xae({preset:og.LOW,edgeDetectionMode:X3.COLOR});this.effectPass=new QM(this.camera,t),this.rt=new Zr(10,10,{minFilter:Pr,magFilter:Pr,wrapS:an,wrapT:an,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,r){this.rt.depthTexture=t.depthTexture;let i=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,r),this.fullscreenMaterial.uniforms.inputBufferA.value=r.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(i),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},HVe=`#define GLSLIFY 1
#include <skinning_pars_vertex>
#include <morphtarget_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <morphtarget_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,GVe=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,WVe=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,qVe=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,YVe=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,XVe=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,$1=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],$Ve=new Jr({vertexShader:HVe,fragmentShader:GVe}),Lv=new Jr({vertexShader:YVe,fragmentShader:XVe,uniforms:{texture_ao_lrez:new it(null),texture_depth_lrez:new it(null),texture_depth_hrez:new it(null),near:new it(null),far:new it(null)}}),KVe=class extends fo{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let r=1024,i=1024;this.gBuffer=new Zr(r,i,{type:B_?Rh:Ni,depthTexture:new ax(r,i),minFilter:Pr,magFilter:Pr}),this.depthBufferHighRes=new Zr(r,i,{depthTexture:new ax(r,i)}),this.aoBuffer=new Zr(r,i,{minFilter:Pr,magFilter:Pr}),this.splineScene=e,this.splineCamera=t;let n=new Float32Array($1.length*2);for(let a=0;a<$1.length;a++){let o=a*2;n[o+0]=$1[a][0],n[o+1]=$1[a][1]}this.blueNoiseInDiskTexture=new ao(n,$1.length,1,tM,Ni),this.blueNoiseInDiskTexture.wrapS=fh,this.blueNoiseInDiskTexture.wrapT=fh,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new Jr({vertexShader:WVe,fragmentShader:qVe,uniforms:{near:new it(null),far:new it(null),fov:new it(null),proj_info:new it(new fr),is_ortho:new it(!1),resolution:new it(new ge),radius_of_influence:new it(8),radius_in_screen_space:new it(1),exponent:new it(1),ao_color:new it(new V),bias:new it(.5),texture_depth:new it(null),texture_normals:new it(null),texture_blue_noise:new it(null),texture_blue_noise_in_disk:new it(this.blueNoiseInDiskTexture),frame_index:new it(0),fog_enabled:new it(!1),fog_near:new it(1),fog_far:new it(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Zr(r,i,{minFilter:Pr,magFilter:Pr,wrapS:an,wrapT:an,depthBuffer:!1,type:Ni});let s=new Xae({preset:og.ULTRA,edgeDetectionMode:X3.COLOR});this.effectPass=new QM(this.camera,s)}initialize(e,t,r){super.initialize(e,t,r),this.effectPass.initialize(e,t,r)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let r=this._runHalfRes?.5:1,i=e*r,n=t*r;this.gBuffer.setSize(i,n),this.aoBuffer.setSize(i,n),this.hbaoMaterial.uniforms.resolution.value.set(i,n),this.aaBuffer.setSize(i,n),this.effectPass.setSize(i,n)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}setDepthTexture(e){this.depthBufferHighRes.depthTexture=e,Lv.uniforms.texture_depth_hrez.value=e,Lv.needsUpdate=!0}render(e,t,r){this.splineScene.overrideMaterial=$Ve;let i=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=i,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let n=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1-n[8])/n[0],l=-(1+n[9])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),u=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),d=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*u;this.hbaoMaterial.uniforms.radius_in_screen_space.value=d,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let n=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/n[0],a=2/n[5],o=-(1+n[12])/n[0],l=-(1-n[13])/n[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/a),u=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=Lv,Lv.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,Lv.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,Lv.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},QVe=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ZVe=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,JVe=class extends jl{constructor(){super(new Jr({vertexShader:QVe,fragmentShader:ZVe,uniforms:{tInput:new it(null),tMap:new it(null),uResolution:new it(new ge),uSize:new it(new ge),uCoords:new it(new ge),uScale:new it(1),uSceneColor:new it(new Zt(16711680)),uDPR:new it(1),uCurrent:new it(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},eUe=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,tUe=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,rUe=[],iUe=class extends jl{constructor(){super(new Jr({vertexShader:eUe,fragmentShader:tUe,uniforms:{toScene:new it(null),fromScene:new it(null),uResolution:new it(new ge),uDPR:new it(1),mixRatio:new it(0),threshold:new it(.1),useTexture:new it(0),tMixTexture:{value:rUe[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}},nUe=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,sUe=`
uniform sampler2D inputBuffer;
uniform sampler2D blurredInputBuffer;
uniform sampler2D overlay;
uniform float blurIntensity;

uniform vec2 uResolution;
uniform float uDPR;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( overlay, screenUv );
	vec4 texel2 = texture2D( inputBuffer, screenUv );
	vec4 texel3 = texture2D( blurredInputBuffer, screenUv );

	float blurMask2 = max(sign(texel1.a), 0.0) * blurIntensity;
    gl_FragColor = mix( mix(texel2, texel3, blurMask2), texel1, texel1.a );
}
`,aUe=class extends jl{constructor(){super(new Jr({vertexShader:nUe,fragmentShader:sUe,uniforms:{inputBuffer:new it(null),blurredInputBuffer:new it(null),overlay:new it(null),uResolution:new it(new ge),uDPR:new it(1),blurIntensity:new it(0)}})),this._blurEnabled=!1,this.blurTarget=new Zr(1,1,{minFilter:Pr,magFilter:Pr,wrapS:an,wrapT:an}),this.blurPass=new KB({width:window.innerWidth,height:window.innerHeight,kernelSize:$3.HUGE,resolutionScale:.25}),this.blurPass.renderToScreen=!1,this.uniforms.blurredInputBuffer.value=this.blurTarget.texture}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.overlay.value}set texture(e){this.uniforms.overlay.value=e}setResolution(e,t,r=1){this.uniforms.uResolution.value.set(e,t),this.uniforms.uDPR.value=r,this.blurPass.setSize(e,t),this.blurTarget.setSize(e,t),this.blurPass.setSize(e,t)}get uiCanvas(){return this._uiCanvas}set uiCanvas(e){this._uiCanvas=e,e.texture&&(this.uniforms.overlay.value=e.texture);let t=e.frame;if(t){let r=t.data.backgroundBlur,i=r.radius;this._blurEnabled=r.enabled,this.uniforms.blurIntensity.value=this._blurEnabled?1:0,this.blurPass.scale=i/3}}render(e,t,r,i,n){this._blurEnabled&&(this.blurPass.setDepthTexture(this.getDepthTexture()),this.blurPass.render(e,t,this.blurTarget,i,n)),super.render(e,t,r,i,n)}},oUe=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,lUe=`
uniform sampler2D tInput;
uniform sampler2D tOverlayImage;
varying vec2 vUv;
uniform vec2 uResolution;
uniform vec2 uRightBottom;
uniform vec2 uImageSize;
uniform float uScale;
uniform float uDPR;

vec3 blendNormal(vec3 base, vec3 blend) {
	return blend;
}

vec3 blendNormal(vec3 base, vec3 blend, float opacity) {
	return (blendNormal(base, blend) * opacity + base * (1.0 - opacity));
}

vec4 drawFixedSizeImage(sampler2D image, vec2 screenUV, vec2 imageSize, vec2 imageCoords, vec2 screenSize, float dpr) {
	vec2 uv = (screenUV * screenSize * dpr - imageCoords) / (imageSize * dpr);
	if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {
		return vec4(0.0);
	}
	return texture2D(image, uv);
}

void main() {
    vec2 screenUV = gl_FragCoord.xy / (uResolution.xy * uDPR);
	vec2 imageCoords = vec2(uResolution.x * uDPR - uImageSize.x * uScale * uDPR - uRightBottom.x * uDPR, uRightBottom.y * uDPR);
    vec4 background = texture2D(tInput, screenUV);
    vec4 image = drawFixedSizeImage(tOverlayImage, screenUV, uImageSize * uScale, imageCoords, uResolution, uDPR);
    gl_FragColor = vec4(blendNormal(background.rgb, image.rgb, image.a), max(background.a, image.a));
}
`,cUe=class extends jl{constructor(){super(new Jr({vertexShader:oUe,fragmentShader:lUe,uniforms:{tInput:new it(null),tOverlayImage:new it(null),uResolution:new it(new ge),uImageSize:new it(new ge),uRightBottom:new it(new ge(20,20)),uScale:new it(.25),uDPR:new it(1)}}),"tInput")}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tOverlayImage.value}set texture(e){this.uniforms.tOverlayImage.value=e,this.uniforms.uImageSize.value.set(e.image.width,e.image.height)}};function LX(e,t){return t&&t.enabled&&e.push(t.effect),e}var uUe=e=>Object.values(ri).includes(e)?e:ri.NORMAL,dUe=class extends wa{constructor(e,t){super(),this._needsDOFResize=t,this.postprocessingState=IM.defaultData,this._scene=new Ro,this._camera=new Ba,this.effects=new Map,this.blueNoiseTexture=new ao,this._renderToScreen=!0,this._isUIOverlayEnabled=!1,this.clock=new qTe,this.renderer=e,this.debug=!1,this.effects.set("bloom",new EVe),this.effects.set("chromaticAberration",new CVe),this.effects.set("vignette",new DVe),this.effects.set("noise",new PVe),this.effects.set("colorAverage",new TVe),this.effects.set("hueSaturation",new MVe),this.effects.set("brightnessContrast",new AVe),this.effects.set("depthOfField",new NVe),this.effects.set("pixelation",new kVe),this.effectComposer=new FVe(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new d5(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new zVe(this.scene,this.camera,this.renderer),this.aoPass=new KVe(this.scene,this.camera),this.taaPass=new LVe,this.taaPass.renderToScreen=!1,this.helperPass=new UVe(this.camera),this.helperPass.renderToScreen=!1,this.stylesOverlayPass=new JVe,this.stylesOverlayPass.enabled=!1,this.uiOverlayPass=new aUe,this.uiOverlayPass.enabled=!1,this.logoOverlayPass=new cUe,this.logoOverlayPass.enabled=!1,this.sceneTransitionPass=new iUe,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.stylesOverlayPass.texture=e,this.stylesOverlayPass.enabled=!0):this.stylesOverlayPass.enabled=!1}get overlayTexture(){return this.stylesOverlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){let t=this._camera!==e;this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),t&&this.transmissionPass.updatePasses(this.renderer),this.aoPass.setCamera(e),this.helperPass.setCamera(e),this.effects.get("depthOfField").setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let r=this.effectComposer.passes[t];if(r.enabled===!0&&!e&&this._renderToScreen){r.renderToScreen=!0,e=!0;continue}r.renderToScreen=!1}}get isUIOverlayEnabled(){return this._isUIOverlayEnabled}disableUIOverlay(){this._isUIOverlayEnabled=!1}enableUIOverlay(){this._isUIOverlayEnabled=!0}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new ao(e,128,128),this.blueNoiseTexture.wrapS=fh,this.blueNoiseTexture.wrapT=fh,this.blueNoiseTexture.minFilter=jr,this.blueNoiseTexture.magFilter=jr,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,r,i,n,s,a,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=r,this.aoPass.aoColor=i,this.aoPass.fogEnabled=n,this.aoPass.fogNear=s,this.aoPass.fogFar=a,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){if(this.uvEffectPass?.dispose(),this.effectPass?.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let e=[this.effects.get("pixelation")].reduce(LX,[]);e.length>0&&(this.uvEffectPass=new QM(this.camera,...e),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let t=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("depthOfField"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(LX,[]);if(t.length>0&&(this.effectPass=new QM(this.camera,...t),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass),this._needsDOFResize&&this.effects.get("depthOfField")?.enabled&&window!==void 0)){let r=this.renderer.viewportWidth,i=this.renderer.viewportHeight;this.renderer.setSize(r-1,i-1),this.renderer.setSize(r,i)}}this.effectComposer.addPass(this.stylesOverlayPass),this.effectComposer.addPass(this.uiOverlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass),this.effectComposer.addPass(this.logoOverlayPass)}_initCopyPass(){if(this._savePass)return;let e=new ge;this.renderer.getDrawingBufferSize(e),this._rt=new Zr(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:fh,wrapT:fh}),this._rt.samples=0,this._savePass=new c5(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new c5(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(e!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}setWatermark(e){this.logoOverlayPass.enabled=e!==null,e&&(this.logoOverlayPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...r}=e,i=!1;t!==this.postprocessingState.enabled&&(i=!0);for(let n of Object.entries(r)){let s=n[1],a=this.effects.get(n[0]);if(a){a.enabled!==s.enabled&&(i=!0),a.enabled=s.enabled;for(let[o,l]of Object.entries(s))o==="blendFunction"?a.blendFunction=uUe(l):a[o]=l}}this.postprocessingState=e,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,r,i){e instanceof fr?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,r,i),this.effectComposer.outputBuffer.scissor.set(e,t,r,i));let n=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(n),this.effectComposer.outputBuffer.scissor.multiplyScalar(n),this.renderer.setScissor(e,t,r,i)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,r,i){e instanceof fr?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,r,i),this.effectComposer.outputBuffer.viewport.set(e,t,r,i))}resize(e,t,r){if(this.effectComposer.setSize(e,t,r),this._rt){let i=this.renderer.getPixelRatio();this._rt.setSize(e*i,t*i)}}dispose(){this.uvEffectPass?.dispose(),this.effectPass?.dispose(),this.effectComposer.dispose()}},hUe=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,fUe=Tr.lights_fragment_begin,pUe=Tr.shadowmask_pars_fragment,zX=null,mUe=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},gUe=(e="medium")=>{if(zX===e)return!1;zX=e;let t=mUe(e);Tr.shadowmap_pars_fragment=hUe(t);let r=fUe.slice();r=r.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),r=r.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),Tr.lights_fragment_begin=r;let i=pUe.slice();return i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),Tr.shadowmask_pars_fragment=i,!0},vUe=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;
#include <skinning_pars_vertex>
#include <morphtarget_pars_vertex>
	
void main()
{
#include <beginnormal_vertex>
#include <morphnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
vec3 transformed = vec3(position);
#include <morphtarget_vertex>
#include <skinning_vertex>

vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(transformed, 1.0));
}
`,yUe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,rI=new Jr({vertexShader:vUe,fragmentShader:yUe,uniforms:{depthContrast:{value:1}}}),BX=new yn,FX=new ge,xUe=class extends _ie{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new ge,this.dummyCamera=new Ba,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(n=!0,s=!0,a=!0)=>{let o=this.getContext(),l=0;n&&(l|=o.COLOR_BUFFER_BIT),s&&(l|=o.DEPTH_BUFFER_BIT),a&&(l|=o.STENCIL_BUFFER_BIT),o.clear(l),o.clearBufferfv(o.COLOR,1,[0,0,0,1])},this.pipeline=new dUe(this,e?.needsDOFResize??!1),this.autoClear=!1;let t=this.setPixelRatio.bind(this),r=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=j6,this.dummyCamera.matrixAutoUpdate=!1,this.domElement.removeAttribute("data-engine");let i=this.getContext();if(i&&"drawingBufferColorSpace"in i)try{i.drawingBufferColorSpace="display-p3"}catch(n){console.warn(n)}this.setPixelRatio=n=>{this._pixelRatio!==n&&(this._pixelRatio=n,t(n))},this.setSize=(n,s,a=!0)=>{(this.viewportWidth!==n||this.viewportHeight!==s)&&(this.viewportWidth=n,this.viewportHeight=s,r(n,s,a),this.normalRenderTarget?.setSize(n*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(n,s),this.transmissionDepthTarget?.setSize(n*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(n,s,a))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new Zr(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Pr,magFilter:Pr,wrapS:an,wrapT:an,depthBuffer:!1}))}_resizeTransmission(e,t){this.transmissionRenderTarget?.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),this.aoRenderTarget?.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return rr.transmissionLod.value===1}set hdTransmission(e){rr.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new Zr(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:nx,magFilter:Pr,wrapS:an,wrapT:an,depthBuffer:!1}),this.transmissionDepthTarget=new Zr(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:jr,magFilter:jr,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new Zr(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:jr,magFilter:jr,type:Ni,depthTexture:new ax(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,r){this.normalRenderTarget&&(this.setClearColor(0),r.layers.enable(8),r.layers.disable(0),r.layers.disable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),r instanceof Ba?rI.uniforms.depthContrast.value=(r.far-r.near)/1e4:rI.uniforms.depthContrast.value=1,t.overrideMaterial=rI,this.render(t,r),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?y5:null,r.layers.enable(0),r.layers.enable(3),t.traverseEntity(i=>{i.layers.isEnabled(8)&&(i.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t,r=1){this.dummyCamera.updateCameraState(t.dataPatched),this.dummyCamera.matrix.copy(t.matrixWorld);let i=t.height,n=t.width,s=this.viewportWidth/this.viewportHeight;n<i?n=i*s:i=n/s,this.dummyCamera.setViewplaneSize(n,i);for(let a=0;a<r;a++)this.renderSplineScene(e,this.dummyCamera)}renderSplineScene(e,t,{sceneHelpers:r=this.sceneHelpers,sceneHelpersOnTop:i=this.sceneHelpersOnTop,overrideTransmission:n=void 0,overrideNormal:s=void 0}={}){let a=e instanceof nF?e.activePage:e,o=a.visible;a.visible=!0;let l=a.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(a.bgColor,a.bgColor.a),a.penumbraSizeArray.forEach((f,m)=>{rr.penumbraSize.value[m]=f}),rr.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?rr.resolution.value.set(this.resolution.x,this.resolution.y):rr.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),s!==void 0?(rr.normalRenderTarget.value=s,rr.normalRenderTargetDepth.value=BX):l.needsNormal()&&(this.createNormalRenderTarget(),rr.normalRenderTarget.value=this.normalRenderTarget.texture,rr.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,a,t));let c=a.data.ao,u=c.occlusion;if(u&&(this.createAORenderTarget(),rr.aoRenderTarget.value=this.aoRenderTarget.texture),rr.aoEnabled.value=u,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,a.aoColor,a.fog!==null,a.backupFog.near,a.backupFog.far,c.aoFullRes&&!B_),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture),this.pipeline.isUIOverlayEnabled&&a.uiCanvas?.enabled&&a.uiCanvas.texture&&a.uiCanvas.texture.image.width>0){let f=this.getSize(FX),m=this.getPixelRatio();(a.uiCanvas.width!==this.viewportWidth||a.uiCanvas.height!==this.viewportHeight||a.uiCanvas.dpr!==m)&&a.uiCanvas.applySize({width:this.viewportWidth,height:this.viewportHeight},m),a.uiCanvas.render(this),this.pipeline.uiOverlayPass.uiCanvas=a.uiCanvas,this.pipeline.uiOverlayPass.enabled=!0,this.pipeline.uiOverlayPass.setResolution(f.x,f.y,m),this.pipeline.updateRenderToScreen()}else this.pipeline.uiOverlayPass.enabled=!1,this.pipeline.updateRenderToScreen();if(this.pipeline.logoOverlayPass.enabled){let f=this.getSize(FX),m=this.getPixelRatio();this.pipeline.logoOverlayPass.uniforms.uResolution.value.set(f.x,f.y),this.pipeline.logoOverlayPass.uniforms.uDPR.value=m}let d=!1;if(n!==void 0)rr.transmissionRenderTarget.value=n,rr.transmissionRenderTargetDepth.value=BX,this.pipeline.setTransmissionPassEnabled(!1);else{let f=l.needsTransmission();f&&(this.transmissionRenderTarget===void 0&&(d=!0),this.createTransmissionRenderTarget(),rr.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,rr.aspectRatio.value=l6e(this.viewportWidth,this.viewportHeight),rr.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(f)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=r,this.pipeline.sceneHelpersOnTop=i,this.pipeline.scene=a,this.pipeline.camera=t,d&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==a.postprocessing&&(this.pipeline.updatePostprocessing(a.postprocessing),!r&&!i&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),l.shapeBlendIntances.forEach(f=>{f.onBeforeShadowPass(this)}),a.overrideMaterial=l.wireframeState?y5:null,this.pipeline.render(),rr.frameIndex.value=(rr.frameIndex.value+1)%16,t instanceof Ba&&t.copyHistory(),a.visible=o}renderFromSceneForSceneTransitionPass(e,t,r){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=r,this.sceneTransitionTimeRemaining=r,this.pipeline.renderToScreen=!0;let i=this.pipeline.sceneTransitionPass.uniforms;i.uDPR.value=window.devicePixelRatio,i.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){this._superDispose(),this.pipeline.dispose(),this.aoRenderTarget?.dispose(),this.transmissionRenderTarget?.dispose(),this.transmissionDepthTarget?.dispose(),this.normalRenderTarget?.dispose(),this.normalRenderTarget?.depthTexture?.dispose()}},$ae=class extends U_(lMe){constructor(e,t=15,r=10066329){super(e,t,r),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){H_(this.object,$ae.geometryHelper,e,t)}},Kae=class extends U_(oMe){constructor(e,t=15,r=6710886){super(e,t,r),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){H_(this.object,Kae.geometryHelper,e,t)}},h5=class extends U_(aMe){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){H_(this.object,h5.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=h5._vector,t=this.object.distance?this.object.distance:1e3,r=t*Math.tan(this.object.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let n=0,s=this.cone.material.length;n<s;n++)this.cone.material[n].color.set(i);else this.cone.material.color.set(i)}}},Qae=h5;Qae._vector=new V;var Zae=class extends gh{constructor(){super(),this.caretIndex=0,this._caretVisibleAlpha=1,this._selectionVisibleAlpha=.3,this.current={start:0,end:void 0},this.matrixAutoUpdate=!1,this.caretMesh=new Yi(new ed(1,1),new Ih({transparent:!0,opacity:0,side:La})),this.add(this.caretMesh),this.selectionMesh=new Yi(new ed(1,1),new Ih({color:2857471,transparent:!0,depthTest:!1,depthWrite:!1,opacity:0,side:La})),this.add(this.selectionMesh),this.hide()}get caretHeight(){return this.object?.AD??0}show(e){this.visible=!0,this.object=e,this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.y=-this.caretHeight*.5,this.setCaretPosition(this.caretIndex),this.update()}hide(){this.visible=!1}update(){if(this.object===void 0)return;this.updateHelperMatrix();let{depth:e}=this.object.geometry.userData.parameters;this.caretMesh.position.z=e,this.selectionMesh.position.z=e}updateHelperMatrix(){if(this.object===void 0)return;let e=this.object,t=e.parent;t!==null&&t.updateWorldMatrix(!0,!1),e.matrixAutoUpdate&&e.updateMatrix(),t!==null?(this.matrixWorld.multiplyMatrices(t.matrixWorld,e.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,e.matrix)):this.matrixWorld.multiplyMatrices(e.hiddenMatrix,e.matrix),this.matrix.copy(this.matrixWorld);for(let r of this.children)r.matrixWorld.copy(this.matrixWorld);e.updateWorldMatrix(!0,!0)}setCaretColor(e){let t=this.caretMesh.material;t.color.setRGB(e.r,e.g,e.b);let r=this._caretVisibleAlpha===t.opacity;this._caretVisibleAlpha=e.a,r&&(t.opacity=this._caretVisibleAlpha)}setSelectionColor(e){this.selectionMesh.material.color.setRGB(e.r,e.g,e.b)}setCaretPosition(e,t={}){if(this.object===void 0)return;this.caretIndex=e;let r=this.object.wrappedText,[i,n]=ZM(r,e),[s,a]=e>0?ZM(r,e-1):[null,null];(e>0&&r.length?r[s].charAt(a):null)===`
`&&(i++,n=0),this.current.start=e,this.current.end=void 0;let[o,l]=iI(this.object,i,n),{AD:c,descender:u}=this.object,d=u+c*.5,{width:f,height:m,depth:v}=this.object.geometry.userData.parameters,y=typeof f=="string"?0:f,x=typeof m=="string"?0:m;this.caretMesh.scale.set(1,this.caretHeight,1),this.caretMesh.position.set(o-y*.5,l+d+x*.5,v),this.hideSelectionMesh(),this.showCaretMesh()}setSelection(e,t){if(this.object===void 0)return;let r=this.object.wrappedText;this.current.start=e,this.current.end=t;let i=[],n=[],s=bUe(r,e,t),{lineHeight:a,AD:o,descender:l}=this.object,c=l+o*.5-a*.5;for(let[x,w,_]of s)if(w!==_){let[S,P]=iI(this.object,x,w),[M,C]=iI(this.object,x,_);P+=c,C+=c,C+=a;let T=i.length/3;i.push(S,P,0),i.push(M,P,0),i.push(M,C,0),i.push(S,C,0),n.push(T+0,T+1,T+2),n.push(T+2,T+3,T+0)}let u=new Lt;u.setIndex(n),u.setAttribute("position",new At(i,3));let{width:d,height:f,depth:m}=this.object.geometry.userData.parameters,v=typeof d=="string"?0:d,y=typeof f=="string"?0:f;this.selectionMesh.geometry.dispose(),this.selectionMesh.geometry=u,this.selectionMesh.position.x=-v*.5,this.selectionMesh.position.y=y*.5,this.selectionMesh.position.z=m,this.showSelectionMesh(),this.hideCaretMesh()}getSelectionFromPosition(e,t,r="previous"){if(this.object===void 0||this.object.font===void 0)return;let i=this.object.wrappedText,n=i.length,s=this.object.lineHeight,a=n*s,{height:o,verticalAlign:l}=this.object.geometry.userData.parameters,c=typeof o=="string"?0:o,u=0;l===3?u=c-a:l===2&&(u=c*.5-a*.5);let d=Math.min(Math.floor(Math.max(Math.min(-t-u,a),0)/s),n-1),f=this.object.charCoords[d],m=this.object.charWidths[d],v=0,y=!1;if(r==="previous"){for(let x=0;x<f.length;x++)if(f[x][0]+m[x]*.5-e>0){v=x,y=!0;break}}else if(r==="closest"){let x=1/0;for(let w=0;w<f.length;w++){let _=f[w][0]+m[w]*.5,S=Math.abs(_-e);S<x&&(x=S,v=w,y=!0)}}else for(let x=0;x<f.length;x++){let w=f[x][0],_=f[x][0]+m[x];if(e>=w&&e<_){v=x,y=!0;break}}return y||(v=f.length),{index:this.getGlobalIndexFromLineAndCharIndexes(i,d,v),lineIndex:d,characterIndex:v}}getGlobalIndexFromLineAndCharIndexes(e,t,r){return e.slice(0,t).reduce((i,n)=>i+=n.length,0)+r}showSelectionMesh(){this.selectionMesh.material.opacity=this._selectionVisibleAlpha}hideSelectionMesh(){this.selectionMesh.material.opacity=0}showCaretMesh(){this.caretMesh.material.opacity=this._caretVisibleAlpha}hideCaretMesh(){this.caretMesh.material.opacity=0}};function iI(e,t,r){let{charCoords:i,charWidths:n,initialOffsetY:s,lineHeight:a}=e;if(i[t]&&i[t].length===0||i.length===0){let u=0,{horizontalAlign:d}=e.data.geometry,f=e.wrappedText,{width:m}=e.geometry.userData.parameters;return f.length===1&&f[0].length===0&&(d===3?u=m*.5:d===2&&(u=m)),[u,s-a*t]}let o=i[t];if(o===void 0||o.length===0)return[0,0];let[l,c]=o[Math.min(r,o.length-1)];return r>=o.length&&(l+=n[t][r-1]),[l,c]}function ZM(e,t){let r=0;for(let i=0;i<e.length;i++){let n=e[i],s=t-r;if(s<=n.length)return[i,s];r+=n.length}return[Math.max(0,e.length-1),e[e.length-1]?.length??0]}function bUe(e,t,r){let[i,n]=ZM(e,t),[s,a]=ZM(e,r),o=[];n>=e[i].length&&(i++,n=0);for(let l=i;l<=s;l++){let c=e[l],u=l===i?n:0,d=l===s?a:c.length;o.push([l,u,d])}return o}function wUe(e,t){let r=ha.fromHex(3223857),i=.8;for(let n of e.layers){if(n.data.type==="light"||n.data.type==="displace"||n.data.type==="fresnel"||n.data.type==="matcap"||n.data.type==="texture"||n.data.type==="toon"||n.data.type==="outline"||n.data.type==="transmission"||n.data.type==="noise")continue;let s=typeof n.data.alpha=="string"?Number(t.getVariable(n.data.alpha)):n.data.alpha;if(n.data.type==="color"&&s>.3){r=_Ue(n.data.color,t),i=s;break}else if((n.data.type==="depth"||n.data.type==="gradient")&&s>.3){let a=SUe(n.data);r={r:a[0],g:a[1],b:a[2]},i=typeof n.data.alpha=="string"?1:n.data.alpha;break}}return{...r,a:i}}function _Ue(e,t){return typeof e=="string"?t.data.colors[e]:e}function SUe(e){return e.colors[0]}function EUe(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var Jae=class extends XB(WTe,$ae){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let n=new fM(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof fM&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let r=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&EUe(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),r&&this.update()}},VX=new V,UX=new V,HX=new ar,eoe=class extends XB(VTe,Qae){constructor(e,t,r){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=Ct.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let n=new fM(this.shadow.camera);n.visible=!1,this.gizmos.shadowmap=n,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof fM&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),UX.setFromMatrixPosition(this.matrixWorld),HX.setFromRotationMatrix(this.matrixWorld),VX.copy(this.up).applyQuaternion(HX).negate().multiplyScalar(this.distance),this.target.position.copy(UX).add(VX),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}};function AUe(e){let t=(e[0][0]+e[1][1])/2,r=(e[0][0]-e[1][1])/2,i=(e[1][0]+e[0][1])/2,n=(e[1][0]-e[0][1])/2,s=Math.sqrt(t*t+n*n),a=Math.sqrt(r*r+i*i),o=s+a,l=s-a,c=Math.atan2(i,r),u=Math.atan2(n,t),d=(u-c)/2,f=(u+c)/2,m=[[Math.cos(f),Math.sin(f)],[-Math.sin(f),Math.cos(f)]],v=[[o,0],[0,l]],y=[[Math.cos(d),Math.sin(d)],[-Math.sin(d),Math.cos(d)]];return m[0][0]*=-1,m[0][1]*=-1,y[0][0]*=-1,y[1][0]*=-1,[m,v,y]}function hT(e,t){return[[e[0][0]*t[0][0]+e[0][1]*t[1][0],e[0][0]*t[0][1]+e[0][1]*t[1][1]],[e[1][0]*t[0][0]+e[1][1]*t[1][0],e[1][0]*t[0][1]+e[1][1]*t[1][1]]]}function GX(e){return[[e[0][0],e[1][0]],[e[0][1],e[1][1]]]}function CUe(e){let[t,r,i]=AUe(e),n=hT(t,GX(i)),s=hT(hT(i,r),GX(i)),a=Math.atan2(n[1][0],n[0][0]),o=[s[0][0],s[1][1]],l=[s[0][1]/s[1][1],s[1][0]/s[0][0]];return{rotation:a,scale:o,shear:l}}function TUe({rotation:e,scale:t,shear:r}){let i=Math.cos(e),n=Math.sin(e),s=[[i,-n],[n,i]],a=[[t[0],r[0]*t[1]],[r[1]*t[0],t[1]]],o=hT(s,a);return[o[0][0],o[1][0],o[0][1],o[1][1]]}var ci;(e=>{function t(){return[1,0,0,0,1,0,0,0,1]}e.identity=t;function r(C,T=e.identity()){for(let E=0,N=C.length;E<N;E++)T[E]=C[E];return T}e.copy=r;function i(C,T,E,N,D,I){return e.setAbcdef(e.identity(),C,T,E,N,D,I)}e.create=i;function n(C,T,E,N,D,I,j){return C[0]=T,C[1]=N,C[2]=I,C[3]=E,C[4]=D,C[5]=j,C}e.setAbcdef=n;function s(C,T){let[E,N,D,I,j,L]=o(C),[B,q,G,Y,X,re]=o(T),F=B*E+q*D,$=B*N+q*I,se=G*E+Y*D,H=G*N+Y*I,ne=X*E+re*D+j,ce=X*N+re*I+L;return e.create(F,$,se,H,ne,ce)}e.append=s;function a(C,T){let[E,N,D,I,j,L]=o(C),[B,q,G,Y,X,re]=o(T),F=E,$=N,se=D,H=I;(B!==1||q!==0||G!==0||Y!==1)&&(F=E*B+N*G,$=E*q+N*Y,se=D*B+I*G,H=D*q+I*Y);let ne=j*B+L*G+X,ce=j*q+L*Y+re;return e.create(F,$,se,H,ne,ce)}e.prepend=a;function o(C){return[C[0],C[3],C[1],C[4],C[2],C[5]]}e.getAbcdef=o;function l(C){let[T,E,N,D,I,j]=e.getAbcdef(C),L=T*D-E*N,B=D/L,q=-E/L,G=-N/L,Y=T/L,X=(N*j-D*I)/L,re=-(T*j-E*I)/L;return e.create(B,q,G,Y,X,re)}e.invert=l;function c([C,T],E){let[N,D,I,j,L,B]=e.getAbcdef(E);return[N*C+I*T+L,D*C+j*T+B]}e.apply=c;function u(C,T){let[E,N,D,I,j,L]=e.getAbcdef(T),B=1/(E*I+D*-N),[q,G]=C;return[I*B*q+-D*B*G+(L*D-j*I)*B,E*B*G+-N*B*q+(-L*E+j*N)*B]}e.applyInverse=u;function d(C,T,E=T){let[N,D,I,j,L,B]=e.getAbcdef(C);return e.setAbcdef(C,N*T,D*E,I*T,j*E,L*T,B*E),C}e.scale=d;function f(C,T){let E=Math.cos(T),N=Math.sin(T),[D,I,j,L,B,q]=e.getAbcdef(C);return e.setAbcdef(C,D*E-I*N,D*N+I*E,j*E-L*N,j*N+L*E,B*E-q*N,B*N+q*E),C}e.rotate=f;function m(C,T,E){let[N,D]=E,I=e.translate(C,-N,-D);return I=e.rotate(I,T),I=e.translate(I,N,D),I}e.rotateAround=m;function v(C,T,E){let[N,D,I,j,L,B]=e.getAbcdef(C);return e.setAbcdef(C,N,D,I,j,L+T,B+E),C}e.translate=v;function y(C,T,E){let[N,D,I,j]=e.getAbcdef(C);return e.setAbcdef(C,N,D,I,j,T,E),C}e.setTranslate=y;function x(C,T,E){let[N,D,I,j]=e.getAbcdef(C);return e.setAbcdef(C,N,D,I,j,T,E),C}e.setPosition=x;function w(C){let[T,E,N,D]=e.getAbcdef(C),I=Math.sqrt(T*T+E*E),j=Math.sqrt(N*N+D*D);return[I,j]}e.getScale=w;function _(C){let[,,,,T,E]=e.getAbcdef(C);return[T,E]}e.getPosition=_;function S(C,T){return e.decompose(C,T).rotation}e.getRotation=S;function P(C,T){let[E,N,D,I,j,L]=e.getAbcdef(C),{rotation:B,scale:q,shear:G}=CUe([[E,D],[N,I]]);return{position:[j+(T[0]*E+T[1]*D)-T[0],L+(T[0]*N+T[1]*I)-T[1]],scale:q,rotation:B,shear:G,pivot:T}}e.decompose=P;function M(C,T,E,N,D=[0,0]){let[I,j]=C,[L,B]=N,[q,G,Y,X]=TUe({rotation:E,scale:T,shear:D}),re=I-(L*q+B*Y)+L,F=j-(L*G+B*X)+B;return e.create(q,G,Y,X,re,F)}e.compose=M})(ci||(ci={}));var MUe=Math.PI/180;function PUe(e,t,r,i,n,s){let a=e-r,o=t-i;return a*a/(n*n)+o*o/(s*s)<=1}function DUe(e){return e*MUe}var Qs=class{constructor(e,t,r){this.uuid=e,this.data=t,this.localMatrix=ci.identity(),this.worldMatrix=ci.identity(),this.ignoreCameraZoom=!1,this.visible=!0,this._singleBBox=new f5,this._recursiveBBox=new f5,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.stateSelection=null,this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this.name="",this.position=[0,0],this.scale=[1,1],this.rotation=0,this.shear=[0,0],this.emitter=q3(),this.dpr=r.dpr??1,this.dataPatched=t}project(e,t){let r=this.worldMatrix;return t&&(r=ci.append(t.worldMatrix,r)),ci.applyInverse(e,r)}intersects(e,t,r,i=!1){return this.visible&&!this.data.raycastLock&&this.intersectsInLocalSpace(...this.project([e,t],r),i)}intersectsInLocalSpace(e,t,r=!1){let{min:i,max:n}=r?this.recursiveBBox:this.singleBBox;return e>=i[0]&&e<=n[0]&&t>=i[1]&&t<=n[1]}applyTransforms(e){e.setTransform(this.worldMatrix,this.ignoreCameraZoom)}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges()),this._recursiveBBox}updateLocalMatrix(){this.localMatrix=ci.compose(this.position,this.scale,DUe(this.rotation),Dg.getPivot(this.dataPatched),this.shear)}updateWorldMatrix(e,t,r){let i=this.parent;t&&i!==null&&i!==void 0&&i.updateWorldMatrix(e,!0,!1),e&&this.updateLocalMatrix(),this.parent?this.worldMatrix=ci.append(this.parent.worldMatrix,this.localMatrix):this.worldMatrix=ci.copy(this.localMatrix),this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}get pivot(){return Dg.getPivot(this.data)}getCenter(){return[0,0]}getHalfSize(){return[0,0]}get id(){return this.uuid}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{e.resetBBoxNeedsUpdateSelf()})}updateTransformState(e){let t=!1;e.position!==void 0&&(t=!0,this.position=e.position),e.rotation!==void 0&&(t=!0,this.rotation=e.rotation),e.scale!==void 0&&(t=!0,this.scale=e.scale),e.shear!==void 0&&(t=!0,this.shear=e.shear),t&&(this.updateWorldMatrix(!0,!1,!0),this.resetBBoxNeedsUpdate())}updateByOp(e,t,r){e.type===0&&e.props.visible!==void 0&&(this.visible=e.props.visible),this.data=t,this.data=t;let i=e,n=Vi(e.path,["states","*"]);if(n!==null){if(e.type===0){let[s]=n;if(this?.stateSelection===s){let a={...e.props};if(delete a.name,Object.values(e.props).some(o=>o===void 0)){let o=this.data;if(o!==void 0){let l=As.zoom(o,e.path.slice(2));if(l)for(let c in e.props)e.props[c]===void 0&&c in l&&(a[c]=l[c])}}i={...e,props:a,path:e.path.slice(2)}}}}else if(e.type===0){let s=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(s!==void 0){if(e.props.name!==void 0&&s.name){let{name:o,...l}=s;s=l}let a=As.removeOverridden(e.path,e.props,s);i={...e,props:a}}}this.updateByPatchedOpBase(i,pg.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),r)}changeSelectedState(e,t,r=!1){if(!(this.data.states.length===0&&!r)){for(let i of this.data.states)pg.toOps(this.data,i.data).forEach(n=>{let s=EM.replaceProps(n,this.data);this.dataPatched=this.data,this.updateByPatchedOp(s,this.data,t)});if(e!==null){let i=this.data.states.data(e);i&&(this.dataPatched=pg.patch(this.data,i),pg.toOps(this.data,i).forEach(n=>{this.updateByPatchedOp(n,this.dataPatched,t)}))}r&&this.updateTransformState(this.dataPatched),this.stateSelection=e}}updateState(e,t){e.name!==void 0&&(this.name=e.name),e.visible!==void 0&&(this.visible=e.visible),this.updateTransformState(e)}updateByPatchedOpBase(e,t,r){this.dataPatched=t,this.updateByPatchedOp(e,t,r)}updateByPatchedOp(e,t,r){e.path.length===0&&e.type===0&&this.updateState(e.props,r),this.requestRender()}traverseFrameAncestors(e){this.traverseAncestors(t=>{t.data.type==="frame2d"&&e(t)})}traverseAncestors(e){let t=this.parent;for(;t;)e(t),t=t.parent}requestRender(){this.traverseFrameAncestors(e=>{e.requestRender()})}clone(e){let t=new Qs(this.uuid,this.data,e);return t.parent=void 0,t}addEventListener(e,t){this.emitter.on(e,t)}removeEventListener(e,t){this.emitter.off(e,t)}dispatchEvent(e){this.emitter.emit(e.type,{...e,target:e.target??this})}traverseSortNextHelper(){let e=this.parent;if(e){let t=e.children;if(t){let r=t.indexOf(this)+1;return t[r]?t[r]:e.traverseSortNextHelper()}}}sortNext(){let e=this.children;return e&&e.length>0&&e[0]?e[0]:this.traverseSortNextHelper()}isDescendantOf(e){e instanceof Qs&&(e=e.uuid);let t=this;for(;t.parent;){if(t.parent.uuid===e)return!0;t=t.parent}return!1}},xc=class extends Qs{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.context=r,this.children=[]}add(e){e.parent&&e.parent instanceof xc&&e.parent.remove(e),this.children.push(e),e.parent=this}remove(e){let t=this.children.indexOf(e);t>=0&&(this.children.splice(t,1),e.parent=void 0)}traverse(e){let t=e(this);if(t!==!0)for(let r of this.children)r instanceof xc?r.traverse(e):t=e(r)}intersectsChildrenHelper(e,t,r,i,n){for(let s of this.children)if(s.intersects(e,t,r,!1)&&(n.push(s),i)||s instanceof xc&&s.intersectsChildrenHelper(e,t,r,i,n))return!0;return!1}intersectsChildren(e,t,r,i=!1,n=[],s=!1){return this.intersectsChildrenHelper(e,t,r,i,n),n}intersectsChildrenHelperReverse(e,t,r,i,n){for(let s of this.children)if(s instanceof xc&&s.intersectsChildrenHelperReverse(e,t,r,i,n)||s.intersects(e,t,r,!1)&&(n.push(s),i))return!0;return!1}intersectsChildrenReverse(e,t,r,i=!1,n=[],s=!1){return this.intersectsChildrenHelperReverse(e,t,r,i,n),n}updateWorldMatrix(e,t,r){if(super.updateWorldMatrix(e,t,r),r&&this.children)for(let i of this.children)i.updateWorldMatrix(e,!1,!0)}find(e){let t;return this.traverse(r=>{r.uuid===e&&(t=r)}),t}innerDrawChildren(e){for(let t=this.children.length-1;t>=0;t--)this.children[t].draw(e)}resetBBoxNeedsUpdate(){super.resetBBoxNeedsUpdate(),this.traverse(e=>{e.resetBBoxNeedsUpdateSelf()})}clone(e){let t=new xc(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},Lp=class extends xc{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.updateState(t,r)}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.innerDrawChildren(e),e.restore())}clone(e){let t=new Lp(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}};function NUe(e,t){let[[r,i],[n,s]]=e,[[a,o],[l,c]]=t,u=(r-n)*(o-c)-(i-s)*(a-l);if(u===0)return!1;let d=((r-a)*(o-c)-(i-o)*(a-l))/u,f=-((r-n)*(i-o)-(i-s)*(r-a))/u;return d>=0&&d<=1&&f>=0&&f<=1}var toe=[[-1,1],[-1,-1],[1,-1],[1,1]],WX=(e,t,r)=>{let i=e.getCenter(),n=e.getHalfSize(),s=ci.append(t,e.worldMatrix);n[0]===0&&n[1]===0?r.push(ci.apply(i,s)):toe.forEach(a=>{let o=[a[0]*n[0]+i[0],a[1]*n[1]+i[1]];r.push(ci.apply(o,s))})},f5=class{constructor(){this.matrix=ci.identity(),this.min=[1/0,1/0],this.max=[-1/0,-1/0],this.vertices=[],this.edges=[]}setFromObjectSize(e,t=!1){e.updateWorldMatrix(),this.makeEmpty(),ci.copy(e.worldMatrix,this.matrix);let r=ci.invert(e.worldMatrix);this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];r===!0&&e instanceof xc?e.traverse(n=>{n.visible&&WX(n,t,i)}):WX(e,t,i),this.setFromPoints(i)}setFromSize(e,t,r){this.makeEmpty(),ci.copy(r,this.matrix),this.expandBySize(e,t,r)}expandBySize(e,t,r){[ci.apply([0,0],r),ci.apply([0,t],r),ci.apply([e,t],r),ci.apply([e,0],r)].forEach(i=>this.expandByPoint(i))}getCenter(){let[e,t]=this.min,[r,i]=this.getHalfSize();return ci.apply([e+r,t+i],this.matrix)}getSize(){return[this.max[0]-this.min[0],this.max[1]-this.min[1]]}getHalfSize(){return[(this.max[0]-this.min[0])*.5,(this.max[1]-this.min[1])*.5]}makeEmpty(){this.min=[1/0,1/0],this.max=[-1/0,-1/0]}setFromPoints(e){this.makeEmpty();for(let t of e)this.expandByPoint(t)}expandByPoint(e){this.min=[Math.min(this.min[0],e[0]),Math.min(this.min[1],e[1])],this.max=[Math.max(this.max[0],e[0]),Math.max(this.max[1],e[1])]}computeVertices(){let[e,t]=this.getHalfSize(),r=this.getCenter(),[i,n,s,a]=ci.getAbcdef(this.matrix),o=ci.create(i,n,s,a,r[0],r[1]);this.vertices=toe.map(([l,c])=>ci.apply([l*e,c*t],o))}computeEdges(){this.edges=[];for(let e=0,t=this.vertices.length;e<t;++e)this.edges.push([this.vertices[e],this.vertices[(e+1)%t]])}project(e,t){let r=this.matrix;return t&&(r=ci.append(t.worldMatrix,r)),ci.applyInverse(e,r)}intersects(e,t,r){return this.intersectsInLocalSpace(...this.project([e,t],r))}intersectsInLocalSpace(e,t){let{min:r,max:i}=this;return e>=r[0]&&e<=i[0]&&t>=r[1]&&t<=i[1]}containsPoint(e){let[t,r]=e,[i,n]=this.min,[s,a]=this.max;return t>=i&&t<=s&&r>=n&&r<=a}intersectsBBox2D(e){for(let t=0,r=this.edges.length;t<r;t++){let i=this.edges[t];for(let n=0,s=e.edges.length;n<s;n++){let a=e.edges[n];if(NUe(i,a))return!0}}for(let t=0,r=e.vertices.length;t<r;t++){let i=e.vertices[t];if(this.containsPoint(i))return!0}return!1}ensureMinMax(){let e=this.min,t=this.max;this.min=[Math.min(e[0],t[0]),Math.min(e[1],t[1])],this.max=[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}copy(e){this.min=[...e.min],this.max=[...e.max],ci.copy(e.matrix,this.matrix),this.computeVertices(),this.computeEdges()}clone(){let e=new f5;return e.copy(this),e}},roe,kUe=new Promise(e=>{roe=e}),qX=!1,iC;function RUe(){if(qX)return;if(iC)return iC;async function e(){let t=await Zp(()=>import("./ui-Ds7EeOeb.js"),[]);roe(t.default??t),qX=!0}return iC=e(),iC}function YX(e){let t=!1;return e.scene.objects.traverse((r,i)=>{(i.type==="Mesh"&&i.geometry.type==="UIGeometry"||i.type==="Page"&&i.uiFrame!==void 0)&&(t=!0)}),t}var xr,nI;async function IUe(e){let t=await kUe;xr||(nI||(nI=t({locateFile:()=>e})),xr=await nI)}var XX=ci.identity(),ioe=class{constructor(e,t=1){this.canvas=e,this._dpr=t,this._width=0,this._height=0,this._strokeMode="inside",this._layerBlur=0,this._backgroundBlur=0,this._dropShadowBlur=0,this._dropShadowOffsetX=0,this._dropShadowOffsetY=0,this._dropShadowColor=Ri.transparent,this._innerShadowBlur=0,this._innerShadowOffsetX=0,this._innerShadowOffsetY=0,this._innerShadowSpread=0,this._innerShadowColor=Ri.transparent,this._fonts=new Map,this._isSizeDirty=!1;try{let r=e.getBoundingClientRect();e.width=r.width*t,e.height=r.height*t}catch{console.log(e.width,t)}this._currentM3Transform=XX,this._currentTransform=new Float32Array(XX)}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this._isSizeDirty=!0}async init(){if(!this.wasmURL)throw Error("Your must set the wasm binary url with renderer.wasmURL = ... before you can call renderer.init");await IUe(this.wasmURL),this._surface=xr.MakeWebGLCanvasSurface(this.canvas),this.ctx=this._surface?.getCanvas(),this._paint=new xr.Paint,this._paint.setAntiAlias(!0),this._paintFill=this._paint.copy(),this._paintFill.setStyle(xr.PaintStyle.Fill),this._paintStroke=this._paint.copy(),this._paintStroke.setStyle(xr.PaintStyle.Stroke),this.ctx?.scale(this.dpr,this.dpr)}get currentTransform(){return this._currentM3Transform}get currentTransformBuffer(){return this._currentTransform}set currentTransform(e){this._currentM3Transform=e,this._currentTransform.set(e)}async loadFont(e,t){let r=await(await fetch(e)).arrayBuffer();this.registerFont(r,t)}registerFont(e,t){if(this._fonts.has(t))return;let r=xr.FontMgr.FromData(e);if(r)this._fonts.set(t,r);else throw new Error("Invalid font data for "+t)}get width(){return this._width}get height(){return this._height}set strokeColor(e){this._paintStroke&&this._paintStroke.setColor(nC(e),xr.ColorSpace.DISPLAY_P3)}set fillColor(e){this._paintFill&&this._paintFill.setColor(nC(e),xr.ColorSpace.DISPLAY_P3)}set lineWidth(e){this._paintStroke&&this._paintStroke.setStrokeWidth(this._strokeMode==="center"?e:e*2)}set strokeMode(e){this._strokeMode=e}set dropShadowBlur(e){this._dropShadowBlur=e}set dropShadowColor(e){this._dropShadowColor=e}set dropShadowOffsetX(e){this._dropShadowOffsetX=e}set dropShadowOffsetY(e){this._dropShadowOffsetY=e}set innerShadowBlur(e){this._innerShadowBlur=e}set innerShadowColor(e){this._innerShadowColor=e}set innerShadowOffsetX(e){this._innerShadowOffsetX=e}set innerShadowOffsetY(e){this._innerShadowOffsetY=e}set innerShadowSpread(e){this._innerShadowSpread=e}set layerBlur(e){this._layerBlur=e}set backgroundBlur(e){this._backgroundBlur=e}clear(){this.ctx?.clear(xr.TRANSPARENT)}save(){this.ctx?.save()}restore(){this.ctx?.restore()}beginPath(){this._currentPath?.delete(),this._currentPath=new xr.Path}closePath(){let e=this._currentPath;if(e){if(e.isEmpty())return;let t=e.getBounds();(t[3]-t[1]||t[2]-t[0])&&e.close()}}fill(){this._paintInner(this._paintFill,!0)}stroke(){this._paintInner(this._paintStroke,!1)}clipRect(e,t,r,i,n=0,s=0,a=0,o=0){let l=xr.XYWHRect(e,t,r,i);if(n===0&&s===0&&o===0&&a===0)this.ctx?.clipRect(l,xr.ClipOp.Intersect,!0);else{let c=xr.RRectXY(l,n,n);c[4]=c[5]=n,c[6]=c[7]=s,c[8]=c[9]=a,c[10]=c[11]=o,this.ctx?.clipRRect(c,xr.ClipOp.Intersect,!0)}}_applyShadowOffsetMatrix(){if(this.ctx){let e=ci.invert(this.currentTransform);this.ctx.concat(e);let t=ci.translate(ci.identity(),this._dropShadowOffsetX,this._dropShadowOffsetY);this.ctx.concat(t),this.ctx.concat(this._currentTransform)}}_applyEffectsToPaint(e,t,r=!0){if(this.ctx&&this._currentPath){let i,n=!1;if(r&&this._hasDropShadow()){let s=e.copy();s.setColor(nC(this._dropShadowColor));let a;this._dropShadowBlur>0&&(a=xr.MaskFilter.MakeBlur(xr.BlurStyle.Normal,this._dropShadowBlur*this.dpr*(this.camera?.scale??1),!1),s.setMaskFilter(a)),this.ctx.save(),this.ctx.clipPath(this._currentPath,xr.ClipOp.Difference,!0),this._applyShadowOffsetMatrix(),t(s),this.ctx.restore(),s.delete(),a?.delete()}if(this._backgroundBlur>0&&r){this.ctx.save(),this.ctx.clipPath(this._currentPath,xr.ClipOp.Intersect,!0);let s=xr.ImageFilter.MakeBlur(this._backgroundBlur,this._backgroundBlur,xr.TileMode.Clamp,null),a=e.copy();a.setImageFilter(s),a.setAlphaf(1);let o=this._currentPath.computeTightBounds();this.ctx.saveLayer(a,o,null,xr.SaveLayerInitWithPrevious),this.ctx.drawColor(e.getColor()),this.ctx.restore(),this.ctx.restore(),a.delete(),s.delete(),n=!0}if(this._layerBlur>0){let s=e.copy();i=xr.MaskFilter.MakeBlur(xr.BlurStyle.Normal,this._layerBlur*this.dpr*(this.camera?.scale??1),!1),s.setMaskFilter(i),t(s),s.delete(),i.delete(),n=!0}if(n||t(e),r&&this._hasInnerShadow()){let s=new xr.Paint;s.setAntiAlias(!0),s.setStyle(xr.PaintStyle.Fill),s.setColor(nC(this._innerShadowColor));let a;this._innerShadowBlur>0&&(a=xr.MaskFilter.MakeBlur(xr.BlurStyle.Normal,this._innerShadowBlur*this.dpr*(this.camera?.scale??1),!1),s.setMaskFilter(a));let o=this._currentPath.computeTightBounds(),[l,c,u,d]=o,f=u-l,m=d-c;this.ctx.save(),this.ctx.clipPath(this._currentPath,xr.ClipOp.Intersect,!0),this.ctx.saveLayer(s,o,null,xr.SaveLayerInitWithPrevious),this.ctx?.translate(this._innerShadowOffsetX,this._innerShadowOffsetY),this.ctx.drawRect(xr.XYWHRect(-1e3-this._innerShadowOffsetX,-1e3-this._innerShadowOffsetY,2e3+f+Math.abs(this._innerShadowOffsetX*2),2e3+m+Math.abs(this._innerShadowOffsetY*2)),s),s.setBlendMode(xr.BlendMode.Clear),this.ctx.drawPath(this._currentPath,s),this.ctx.restore(),this.ctx.restore(),s.delete(),a?.delete()}}}_paintInner(e,t=!0){if(this.ctx&&this._currentPath&&e){let r=this.ctx,i=this._currentPath;this._applyEffectsToPaint(e,n=>{let s=!1;!t&&this._strokeMode!=="center"&&(r.save(),r.clipPath(i,this._strokeMode==="outside"?xr.ClipOp.Difference:xr.ClipOp.Intersect,!0),s=!0),r.drawPath(i,n),s&&r.restore()},t)}}_hasDropShadow(){return this._dropShadowColor?.a>0}_hasInnerShadow(){return this._innerShadowColor?.a>0}path(e){this._currentPath?.addPath(xr.Path.MakeFromSVGString(e))}ellipse(e,t,r,i,n,s,a,o){if(!$X([e,t,r,i])||!this._currentPath)return;if(r<0||i<0)throw Error("radii cannot be negative");let l=xr.XYWHRect(e-r,t-i,r*2,i*2);this._currentPath?.addOval(l)}rect(e,t,r,i,n=0,s=0,a=0,o=0){let l=xr.XYWHRect(e,t,r,i);if($X(l))if(n===0&&s===0&&o===0&&a===0)this._currentPath?.addRect(l);else{let c=xr.RRectXY(l,n,n);c[4]=c[5]=n,c[6]=c[7]=s,c[8]=c[9]=a,c[10]=c[11]=o,this._currentPath?.addRRect(c)}}getHorizontalAlign(e){switch(e){case 2:return xr.TextAlign.Right;case 3:return xr.TextAlign.Center;case 4:return xr.TextAlign.Justify;case 1:default:return xr.TextAlign.Left}}drawTextInner(e,t,r,[i,n,s,a],o,l,c=!0){let u=0,{ctx:d}=this;if(!d)return u;let f=l.copy(),m=l.copy();return m.setAlphaf(0),this._applyEffectsToPaint(f,v=>{t.pushPaintStyle(r,v,m),t.addText(e);let y=t.build();y.layout(s);let x=n;o===2?x+=(a-y.getHeight())/2:o===3&&(x+=a-y.getHeight()),d.drawParagraph(y,i,x),u=y.getHeight(),t.reset(),y.delete()},c),f.delete(),m.delete(),u}drawText(e,t){let r=0,i=this._fonts.get(t.font),{ctx:n,_paintFill:s,_paintStroke:a}=this;if(i&&n){let o=new xr.TextStyle({fontFamilies:[t.font],fontSize:t.fontSize,heightMultiplier:t.lineHeight,letterSpacing:t.letterSpacing}),l=new xr.ParagraphStyle({textStyle:o,textAlign:this.getHorizontalAlign(t.horizontalAlign)}),c=xr.XYWHRect(t.x,t.y,t.width,t.height),u=xr.ParagraphBuilder.Make(l,i);s&&(r=this.drawTextInner(e,u,o,c,t.verticalAlign,s,!0)),a&&(r=this.drawTextInner(e,u,o,c,t.verticalAlign,a,!1)),u.delete()}return{height:r}}render(){this._surface?.flush()}moveTo(e,t){this._currentPath?.moveTo(e,t)}lineTo(e,t){this._currentPath?.lineTo(e,t)}bezierCurveTo(e,t,r,i,n,s){this._currentPath?.cubicTo(e,t,r,i,n,s)}quadraticCurveTo(e,t,r,i){this._currentPath?.quadTo(e,t,r,i)}setTransform(e,t=!1){if(!this.ctx)return;let r=this.ctx.getTotalMatrix(),i=ci.invert(r);if(i&&this.ctx.concat(i),this.ctx?.scale(this.dpr,this.dpr),this.camera?.enabled&&(this.ctx?.concat(this.camera.worldMatrix),t)){let n=ci.getScale(this.camera.worldMatrix);this.ctx?.scale(1/n[0],1/n[1])}this.ctx?.concat(e),this.currentTransform=e}transform(e){this.ctx?.concat(e)}setSize(e,t){!this._isSizeDirty&&e===this._width&&t===this._height||(this._isSizeDirty=!1,this._width=e,this._height=t,this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.canvas.width=e*this.dpr,this.canvas.height=t*this.dpr,this._surface&&(this._surface=xr.MakeWebGLCanvasSurface(this.canvas),this.ctx=this._surface?.getCanvas()))}};function $X(e){for(let t=0;t<e.length;t++)if(e[t]!==void 0&&!Number.isFinite(e[t]))return!1;return!0}function nC({r:e,g:t,b:r,a:i}){return xr.Color4f(e,t,r,i)}var KX=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=Ri.transparent,this.blurRadius=0,this.offset=[0,0],this.spread=0,this.update(t)}update(e){e.color!==void 0&&(this.color=e.color),e.enabled!==void 0&&(this.enabled=e.enabled),e.blurRadius!==void 0&&(this.blurRadius=e.blurRadius),e.offset!==void 0&&(this.offset=e.offset),e.spread!==void 0&&(this.spread=e.spread)}},QX=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.radius=0,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.radius!==void 0&&(this.radius=e.radius)}},OUe=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=Ri.transparent,this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color)}},jUe=class{constructor(e,t,r){this.uuid=e,this.data=t,this.enabled=!1,this.color=Ri.transparent,this.thickness=0,this.mode="inside",this.update(t)}update(e){e.enabled!==void 0&&(this.enabled=e.enabled),e.color!==void 0&&(this.color=e.color),e.thickness!==void 0&&(this.thickness=e.thickness),e.mode!==void 0&&(this.mode=e.mode)}},Gs=class extends Qs{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.autoClose=!0,this.fill=new OUe(e+"-fill",t.fill,r),this.stroke=new jUe(e+"-stroke",t.stroke,r),this.dropShadow=new KX(e+"-dropShadow",t.dropShadow,r),this.innerShadow=new KX(e+"-innerShadow",t.innerShadow,r),this.backgroundBlur=new QX(e+"-backgroundBlur",t.backgroundBlur,r),this.layerBlur=new QX(e+"-layerBlur",t.layerBlur,r)}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:Ri.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:Ri.transparent,e.strokeMode=this.stroke.mode,e.lineWidth=this.stroke.thickness}applyFilters(e){this.layerBlur.enabled?e.layerBlur=this.layerBlur.radius*5:e.layerBlur=0,this.backgroundBlur.enabled?e.backgroundBlur=this.backgroundBlur.radius*5:e.backgroundBlur=0,this.dropShadow.enabled?(e.dropShadowBlur=this.dropShadow.blurRadius*5,e.dropShadowColor=this.dropShadow.color,e.dropShadowOffsetX=this.dropShadow.offset[0],e.dropShadowOffsetY=this.dropShadow.offset[1]):e.dropShadowColor=Ri.transparent,this.innerShadow.enabled?(e.innerShadowSpread=this.innerShadow.spread,e.innerShadowBlur=this.innerShadow.blurRadius*5,e.innerShadowColor=this.innerShadow.color,e.innerShadowOffsetX=this.innerShadow.offset[0],e.innerShadowOffsetY=this.innerShadow.offset[1]):e.innerShadowColor=Ri.transparent}innerDraw(e){}draw(e){!this.visible||(e.save(),this.applyTransforms(e),this.applyFilters(e),this.applyFillStroke(e),e.beginPath(),this.innerDraw(e),this.autoClose&&e.closePath(),this.fill.enabled&&e.fill(),this.stroke.enabled&&e.stroke(),e.restore())}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.type===0&&(Vi(e.path,["fill"])?this.fill.update(e.props):Vi(e.path,["stroke"])?this.stroke.update(e.props):Vi(e.path,["dropShadow"])?this.dropShadow.update(e.props):Vi(e.path,["innerShadow"])?this.innerShadow.update(e.props):Vi(e.path,["layerBlur"])?this.layerBlur.update(e.props):Vi(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}updateState(e,t){super.updateState(e,t),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur)}clone(e){let t=new Gs(this.uuid,this.data,e);return t.parent=void 0,t}},QB=class extends Gs{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.updateState(t,r)}innerDraw(e){e.ellipse(this.width*.5,this.height*.5,this.width*.5,this.height*.5,0,0,Math.PI*2)}intersectsInLocalSpace(e,t){return PUe(e,t,this.width*.5,this.height*.5,this.width*.5,this.height*.5)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e)}clone(e){let t=new QB(this.uuid,this.data,e);return t.parent=void 0,t}},q_=class extends Gs{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.width=0,this.height=0,this.cornerRadius=[0,0,0,0],this.updateState(t,r)}innerDraw(e){e.rect(0,0,this.width,this.height,...this.cornerRadius)}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e)}clone(e){let t=new q_(this.uuid,this.data,e);return t.parent=void 0,t}},ZB=class extends Gs{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._textHeight=0,this._textHeightDirty=!0,this.width=0,this.height=0,this.updateState(t,r)}get textHeight(){return this._textHeight}applyFillStroke(e){e.fillColor=this.fill.enabled?this.fill.color:Ri.transparent,e.strokeColor=this.stroke.enabled&&this.stroke.thickness>0?this.stroke.color:Ri.transparent,e.strokeMode="center",e.lineWidth=this.stroke.thickness}innerDraw(e){this._fontHolder?.arrayBuffer&&this._fontHolder.arrayBuffer.byteLength>1&&this.data.font&&e.registerFont(this._fontHolder.arrayBuffer,this.data.font);let t=this.data.textTransform,r=this.data.text.textValue.toString(),i=t===2?r.toUpperCase():t===3?r.toLowerCase():r,{height:n}=e.drawText(i,{x:0,y:0,width:this.width,height:this.height,fontSize:this.data.fontSize,lineHeight:this.data.lineHeight??1,letterSpacing:this.data.letterSpacing??0,horizontalAlign:this.data.horizontalAlign,verticalAlign:this.data.verticalAlign,font:this.data.font});this._textHeight=n}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateFontState(e,{shared:t}){e.font!==void 0&&(this._fontHolder=t.getFont(e.font),this._fontHolder&&!this._fontHolder.isLoaded&&this._fontHolder.loadingPromise.then(()=>{this.requestRender()}))}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateFontState(e,t)}clone(e){let t=new ZB(this.uuid,this.data,e);return t.parent=void 0,t}},noe=class extends Gs{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this.curves=[],this.extremasBBox={min:[0,0],max:[0,0]},this.updateState(t,r)}computeExtremas(){this.curves.length===0&&this.computeCurves();let e=this.curves.map(i=>JM.extremas(i)),t=[1/0,1/0],r=[-1/0,-1/0];for(let i=0,n=e.length;i<n;i++){let s=e[i];s[0][0]<t[0]&&(t[0]=s[0][0]),s[0][1]<t[1]&&(t[1]=s[0][1]),s[1][0]>r[0]&&(r[0]=s[1][0]),s[1][1]>r[1]&&(r[1]=s[1][1])}return this.extremasBBox.min=[t[0],t[1]],this.extremasBBox.max=[r[0],r[1]],this.extremasBBox}computeCurves(){this.curves=[];for(let r=1,i=this.data.points.length;r<i;r++){let n=this.data.points[r].data,s=this.data.points[r-1].data,a={start:s.position,cp1:s.controlNext.position,cp2:n.controlPrevious.position,end:n.position};this.curves.push(a)}let e=this.data.points[0].data,t=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let r={start:t.position,cp1:t.controlNext.position,cp2:e.controlPrevious.position,end:e.position};this.curves.push(r)}}getCenter(){let[e,t]=this.extremasBBox.min,[r,i]=this.getHalfSize();return[e+r,t+i]}getHalfSize(){let{min:e,max:t}=this.extremasBBox;return[(t[0]-e[0])*.5,(t[1]-e[1])*.5]}innerDraw(e){for(let i=0,n=this.data.points.length;i<n;i++){let s=this.data.points[i].data;if(i===0){let[a,o]=s.position;e.moveTo(a,o)}else{let a=this.data.points[i-1].data,[o,l]=a.controlNext.position,[c,u]=s.controlPrevious.position,[d,f]=s.position,m={start:a.position,cp1:a.controlNext.position,cp2:s.controlPrevious.position,end:s.position};JM.derive(m),e.bezierCurveTo(o,l,c,u,d,f)}}let t=this.data.points[0].data,r=this.data.points[this.data.points.length-1].data;if(this.data.isClosed){let[i,n]=r.controlNext.position,[s,a]=t.controlPrevious.position,[o,l]=t.position;e.bezierCurveTo(i,n,s,a,o,l)}}updateState(e,t){super.updateState(e,t),this.computeExtremas()}clone(e){let t=new noe(this.uuid,this.data,e);return t.parent=void 0,t}},JM;(e=>{function t(a){let o=a.start,l=a.cp1,c=a.cp2,u=a.end,d=[3*(l[0]-o[0]),3*(l[1]-o[1])],f=[3*(c[0]-l[0]),3*(c[1]-l[1])],m=[3*(u[0]-c[0]),3*(u[1]-c[1])],v={start:d,cp:f,end:m};return a.derivative=v,v.derivative=p5.derive(v),v}e.derive=t;function r(a,o,l,c=!1){let u=a-2*o+l;if(u!==0){let d=-Math.sqrt(Math.abs(o*o-a*l)),f=-a+o,m=-(d+f)/u,v=-(-d+f)/u;return[m,v]}else if(o!==l&&u===0)return[(2*o-l)/(2*(o-l))];return[]}function i(a){let o=a.derivative??e.derive(a),l=o.start,c=o.cp,u=o.end;return[r(l[0],c[0],u[0]),r(l[1],c[1],u[1])]}e.droot=i;function n(a){let[o,l]=e.droot(a),c=[a.start[0],a.end[0]],u=[a.start[1],a.end[1]];for(let d of o)c.push(e.compute(a,Math.min(1,Math.max(0,d)))[0]);for(let d of l)u.push(e.compute(a,Math.min(1,Math.max(0,d)))[1]);return c.sort((d,f)=>d-f),u.sort((d,f)=>d-f),[[c[0],u[0]],[c[c.length-1],u[u.length-1]]]}e.extremas=n;function s(a,o){if(o===0)return[...a.start];if(o===1)return[...a.end];let l=1-o,c=l*l,u=o*o,d=c*l,f=c*o*3,m=l*u*3,v=o*u;return[d*a.start[0]+f*a.cp1[0]+m*a.cp2[0]+v*a.end[0],d*a.start[1]+f*a.cp1[1]+m*a.cp2[1]+v*a.end[1]]}e.compute=s})(JM||(JM={}));var p5;(e=>{function t(n){let s=n.start,a=n.cp,o=n.end,l=[2*(a[0]-s[0]),2*(a[1]-s[1])],c=[2*(o[0]-a[0]),2*(o[1]-a[1])],u={start:l,end:c};return u.derivative=m5.derive(u),n.derivative=u,u}e.derive=t;function r(n){let s=n.derivative??e.derive(n),a=s.start,o=s.end;return[a[0]!==o[0]?a[0]/(a[0]-o[0]):0,a[1]!==o[1]?a[1]/(a[1]-o[1]):0]}e.droot=r;function i(n,s){if(s===0)return[...n.start];if(s===1)return[...n.end];let a=1-s,o=a*a,l=s*s,c=o,u=a*s*2,d=l;return[c*n.start[0]+u*n.cp[0]+d*n.end[0],c*n.start[1]+u*n.cp[1]+d*n.end[1]]}e.compute=i})(p5||(p5={}));var m5;(e=>{function t(i){let n=i.start,s=i.end,a=[s[0]-n[0],s[1]-n[1]];return i.derivative=a,i.derivative}e.derive=t;function r(i,n){if(n===0)return[...i.start];if(n===1)return[...i.end];let s=i.start,a=i.end;return[s[0]+(a[0]-s[0])*n,s[1]+(a[1]-s[1])*n]}e.compute=r})(m5||(m5={}));var Vu=class extends xc{constructor(e,t,r){super(e,t,r),this.uuid=e,this.width=0,this.height=0,this.clipped=!0,this.background=new q_(e+"-background",H2.defaultData,r),this.background.parent=this,this.updateState(t,r)}get fill(){return this.background.fill}get stroke(){return this.background.stroke}get backgroundBlur(){return this.background.backgroundBlur}get layerBlur(){return this.background.layerBlur}get dropShadow(){return this.background.dropShadow}get innerShadow(){return this.background.innerShadow}get cornerRadius(){return this.background.cornerRadius}set cornerRadius(e){this.background.cornerRadius=e}updateLocalMatrix(){super.updateLocalMatrix(),this.background?.updateLocalMatrix()}updateWorldMatrix(e,t,r){super.updateWorldMatrix(e,t,r),this.background?.updateWorldMatrix(e,t,r)}draw(e){if(!this.visible)return;e.save();let t=this.width,r=this.height;this.applyTransforms(e),this.background.width=t,this.background.height=r,this.background.draw(e),this.clipped&&e.clipRect(0,0,t,r,...this.cornerRadius),this.innerDrawChildren(e),e.restore()}getCenter(){return[this.width*.5,this.height*.5]}getHalfSize(){return[this.width*.5,this.height*.5]}updateCornerState(e){e.cornerRadius!==void 0&&(this.cornerRadius=e.cornerRadius)}updateSizeState(e){let t=!1;e.width!==void 0&&(this.width=typeof e.width=="number"?e.width:this.width,t=!0),e.height!==void 0&&(this.height=typeof e.height=="number"?e.height:this.height,t=!0),t&&this.updateWorldMatrix(!0,!1,!0)}updateState(e,t){super.updateState(e,t),this.updateSizeState(e),this.updateCornerState(e),e.fill!==void 0&&this.fill.update(e.fill),e.stroke!==void 0&&this.stroke.update(e.stroke),e.dropShadow!==void 0&&this.dropShadow.update(e.dropShadow),e.innerShadow!==void 0&&this.innerShadow.update(e.innerShadow),e.layerBlur!==void 0&&this.layerBlur.update(e.layerBlur),e.backgroundBlur!==void 0&&this.backgroundBlur.update(e.backgroundBlur),e.clipped!==void 0&&(this.clipped=e.clipped)}requestRender(){super.requestRender(),this.dispatchEvent({type:"render"})}dispose(){this.removeEventListener("render")}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),e.type===0&&(Vi(e.path,["fill"])?this.fill.update(e.props):Vi(e.path,["stroke"])?this.stroke.update(e.props):Vi(e.path,["dropShadow"])?this.dropShadow.update(e.props):Vi(e.path,["innerShadow"])?this.innerShadow.update(e.props):Vi(e.path,["layerBlur"])?this.layerBlur.update(e.props):Vi(e.path,["backgroundBlur"])?this.backgroundBlur.update(e.props):this.resetBBoxNeedsUpdate())}clone(e){let t=new Vu(this.uuid,this.data,e);t.parent=void 0;for(let r of this.children)t.add(r.clone(e));return t}},LUe=Jp(Qre(),1),K3=class extends Gs{constructor(e,t,r){super(e,t,r),this.uuid=e,this.data=t,this._pathBBox=new DOMRect,this.path="",this.updateState(t,r),this.autoClose=!1,this.computeSVGBBox()}computeSVGBBox(){let e=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");document.body.appendChild(e),t.setAttribute("d",this.path),e.appendChild(t),this._pathBBox=t.getBBox(),e.remove()}innerDraw(e){e.path(this.path)}intersectsInLocalSpace(e,t){return e>=this._pathBBox.x&&e<=this._pathBBox.x+this._pathBBox.width&&t>=this._pathBBox.y&&t<=this._pathBBox.y+this._pathBBox.height}getCenter(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}getHalfSize(){return[(this._pathBBox.x+this._pathBBox.width)/2,(this._pathBBox.y+this._pathBBox.height)/2]}updateState(e,t){super.updateState(e,t),e.path!==void 0&&(this.path=e.path,this.computeSVGBBox())}clone(e){let t=new K3(this.uuid,this.data,e);return t.parent=void 0,t}};function zUe(e,t=1,r=1){if(t<=0||r<=0)return e;let i=(0,LUe.parseSVG)(e).map(n=>{let s={...n};return"x"in s&&(s.x=s.x*t),"y"in s&&(s.y=s.y*r),"x1"in s&&(s.x1=s.x1*t),"x2"in s&&(s.x2=s.x2*t),"y1"in s&&(s.y1=s.y1*r),"y2"in s&&(s.y2=s.y2*r),"rx"in s&&(s.rx=s.rx*t),"ry"in s&&(s.ry=s.ry*r),s});return BUe(i)}function BUe(e){let t=["rx","ry","xAxisRotation","largeArc","sweep","x1","y1","x2","y2","x","y"],r;return e.map(i=>{let n=[];t.forEach(a=>{if(a in i){let o=i[a]*1;n.length&&o>=0&&n.push(","),n.push(o)}});let s=(r===i.code?n[0]<0?"":",":i.code)+n.join("");return r=i.code,s}).join("")}function FUe(e,t,r){switch(t.type){case"ellipse2d":return new QB(e,t,r);case"rectangle2d":return new q_(e,t,r);case"text2d":return new ZB(e,t,r);case"vector2d":return new noe(e,t,r);case"path2d":return new K3(e,t,r);case"frame2d":return new Vu(e,t,r);case"group2d":default:return new Lp(e,t,r)}}var soe=class{constructor(e,t,r){this.uuid=e,this.data=t,this.group=new Lp(soe.GROUP_ID,{...HM.defaultData},r),this.createChildrenObjects(t.objects,this.group,r)}createObject(e,t,r,i,n,s){let a=FUe(e,t,s);a&&(i.add(a),i.children.splice(n,0,i.children.pop()),a.updateWorldMatrix(),r.length>0&&(a instanceof Lp||a instanceof Vu)&&this.createChildrenObjects(r,a,s))}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}draw(e){this.group.draw(e)}updateEntityByOp(e,t,r,i){let n=this.find(e);if(n)try{n.updateByOp(t,r,{shared:i})}catch(s){console.error(s)}}updateTreeByOp(e,t){if(e.path.length===0&&e.type===7){let r=e.parent===null?this.group:this.find(e.parent);r!==void 0&&r instanceof xc&&(this.createObject(e.id,e.data,e.children,r,e.localIndex,t),r.requestRender())}else if(e.path.length===0&&e.type===8){let r=this.find(e.id);if(r!==void 0&&r.parent!==void 0&&r.parent instanceof xc){let i=r.parent;r.resetBBoxNeedsUpdate(),i?.remove(r),i?.requestRender()}}else if(e.path.length===0&&e.type===9){let r=this.find(e.id);if(r!==void 0){let i=r.parent,n=e.parent===null?this:this.find(e.parent);if(n instanceof xc||n===this){n.add(r);let s=e.localIndex;n.children.splice(s,0,n.children.pop()),r.updateWorldMatrix(!0,!1,!0),i?.requestRender(),r.requestRender()}r.resetBBoxNeedsUpdate()}}}add(e){this.group.add(e)}remove(e){this.group.remove(e)}traverse(e){this.group.traverse(t=>{t!==this.group&&e(t)})}intersectsChildren(e,t,r,i=!1,n=[]){return this.group.intersectsChildren(e,t,r,i,n,!0)}intersectsChildrenReverse(e,t,r,i=!1,n=[]){return this.group.intersectsChildrenReverse(e,t,r,i,n,!0)}find(e){return this.group.find(e)}get children(){return this.group.children}project(e,t){return this.group.project(e,t)}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this.group;){let n=i;i=i.parent;let s=i.children.indexOf(n);r.splice(0,0,s)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>Bne(r.sortKey,i.sortKey)),t.map(r=>r.entity)}},JB=soe;JB.GROUP_ID="scene2d";function aoe({constraints:e,newParentWidth:t,newParentHeight:r,initialParentWidth:i,initialParentHeight:n,objectInitialWidth:s,objectInitialHeight:a,objectInitialPosition:o}){let{horizontalConstraint:l,verticalConstraint:c}=e,u=t-i,d=r-n,f=s,m=a,v=o[0],y=o[1];if(l!==0){if(l===1)v+=u;else if(l===3)v+=u/2;else if(l===2)f=Math.max(1,f+u);else if(l===4){let x=t/i;f*=x,v*=x}}if(c!==0){if(c===1)y+=d;else if(c===3)y+=d/2;else if(c===2)m=Math.max(1,m+d);else if(c===4){let x=r/n;m*=x,y*=x}}return{width:f,height:m,position:[v,y]}}Jp(Qre(),1);var VUe=`
	varying vec2 vUv;
	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
	}`,UUe=`
	uniform sampler2D tDiffuse;
	varying vec2 vUv;
	void main() {
		vec4 texel = texture2D( tDiffuse, vUv );
		gl_FragColor = texel;
	}`,HUe=new M3(-1,1,1,-1,0,1),GUe=class extends Lt{constructor(){super(),this.setAttribute("position",new At([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new At([0,2,0,0,2,0],2))}},WUe=new GUe,qUe=class{constructor(e){this._mesh=new Yi(WUe,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,HUe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}},ooe=new Jr({defines:{},uniforms:{tDiffuse:new it(null)},vertexShader:VUe,fragmentShader:UUe}),YUe=new qUe(ooe),sI=null,aI=null,XUe=()=>(sI===null&&(sI=document.createElement("canvas")),sI),$Ue=e=>(aI===null&&(aI=new ioe(e)),aI),KUe=ci.identity(),loe=class{constructor(e,t,r,i){this.uuid=e,this.width=t,this.height=r,this.context=i,this.enabled=!0,this.isScreenSpace=!1,this.dpr=window.devicePixelRatio,this.isFrameDirty=!1,this.onRenderRequestedDownstream=()=>{this.isFrameDirty=!0,this.context.shared.requestRender()},this._innerApplySize=()=>{let n=this.width,s=this.height,a=this.dpr;this.renderer.dpr=this.isScreenSpace?a:Math.floor(2048/Math.max(n,s)),this.renderer.setSize(n,s)},this.onFrameOverrideObjectEvent=n=>{if(n.target?.uuid!==void 0){let s=this.frameRoot?.find(n.target.uuid);s&&s.dispatchEvent({...n,target:s})}},this.scene2d=new JB(Ct.generateUUID(),zL.defaultData,{dpr:window.devicePixelRatio,shared:i.shared}),this.canvas=XUe(),this.renderer=$Ue(this.canvas),this.promise=this.init(),this.renderTarget=new Zr(1,1,{type:Rh,stencilBuffer:!1,depthBuffer:!1}),i.shared.addUIBuffer(this.uuid,this.renderTarget),this.textureHolder=i.shared.uiBuffer(this.uuid)}get canvasTexture(){return this._canvasTexture||(this._canvasTexture=new JCe(this.canvas)),this._canvasTexture}async init(){this.renderer instanceof ioe&&(this.renderer.wasmURL=Nae.skiaWasmUrl),await this.renderer.init()}render(e){if(this.isFrameDirty){this.isFrameDirty=!1,this._innerApplySize(),this.renderer.clear(),this.frameOverride?.draw(this.renderer),this.renderer.render(),ooe.uniforms.tDiffuse.value=this.canvasTexture,this.canvasTexture.needsUpdate=!0;let t=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.clear(),YUe.render(e),e.setRenderTarget(t),this.textureHolder?.setNeedsUpdate(!0)}}updateEntity2DByOp(e,t,r,i){this.scene2d.updateEntityByOp(e,t,r,i),this.applySize()}updateTreeByOp(e,t){this.scene2d.updateTreeByOp(e,t),this.applySize()}applyOverrides(e){if(this.frameOverride&&this.frameRoot){this.frameOverride.position=[0,0],this.frameOverride.rotation=0;let t=e?.width??this.width,r=e?.height??this.height;this.frameOverride.width=t,this.frameOverride.height=r,this.frameOverride.localMatrix=KUe,this.isScreenSpace&&(this.frameOverride.fill.color=Ri.from0to1([0,0,0,0])),this.frameOverride.data={...this.frameOverride.data,width:t,height:r},coe({objectOverride:this.frameOverride,objectRoot:this.frameRoot,newParentWidth:this.frameOverride.width,newParentHeight:this.frameOverride.height,initialParentWidth:this.frameRoot.width,initialParentHeight:this.frameRoot.height}),this.frameOverride.updateWorldMatrix(!0,!1,!0)}}applySize(e,t=window.devicePixelRatio){let r=Math.max(1,e?.width??this.width),i=Math.max(1,e?.height??this.height);this.dpr=t,this.width=r,this.height=i,this._innerApplySize();let n=1,s=512,a=512;(r*t<s||i*t<a)&&(n=Math.max(s/(r*t),a/(i*t))),this.renderTarget.setSize(r*t*n,i*t*n),this._canvasTexture?.dispose(),this._canvasTexture=void 0,this.applyOverrides(e),this.frameOverride?.requestRender()}applyFrame(e){let t=this.context.scene.find2D(e);if(!(!t||!(t instanceof Vu)))return this.disposeFrameOverride(),this.frameRoot=t,this.frameOverride=t.clone({dpr:this.renderer.dpr,shared:this.context.shared}),this.scene2d.add(this.frameOverride),this.applySize(),this.frame?.addEventListener("render",this.onRenderRequestedDownstream),this.frameOverride.traverse(r=>{r.addEventListener("beginState",this.onFrameOverrideObjectEvent)}),this.frameOverride.traverse(r=>{r.addEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frame?.requestRender(),t}get frame(){return this.frameOverride}get frameId(){return this.frame?.uuid}find(e){return this.scene2d.find(e)}get texture(){return this.textureHolder?.getTexture(1001)}disposeFrameOverride(){this.frameOverride?.removeEventListener("render",this.onRenderRequestedDownstream),this.frameOverride?.traverse(e=>{e.removeEventListener("beginStateChange",this.onFrameOverrideObjectEvent)}),this.frameOverride?.traverse(e=>{e.removeEventListener("completeState",this.onFrameOverrideObjectEvent)}),this.frameOverride&&this.scene2d.remove(this.frameOverride)}};function coe({objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s}){if(e instanceof Vu&&t instanceof Vu||e instanceof Lp&&t instanceof Lp)for(let a=0,o=e.children.length;a<o;a++){let l=e.children[a],c=t.children[a];l&&c&&l.uuid===c.uuid&&ZUe({objectOverride:l,objectRoot:c,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s})}}function QUe(e){if(g5(e))return[e.width,e.height];if(e instanceof K3){let[t,r]=e.getHalfSize();return[t*2,r*2]}else if(e instanceof Lp){let[t,r]=e.recursiveBBox.getHalfSize();return[t*2,r*2]}return[0,0]}function ZUe({objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s}){let[a,o]=QUe(t),{width:l,height:c,position:u}=aoe({constraints:e.data,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s,objectInitialWidth:a,objectInitialHeight:o,objectInitialPosition:t.position});if(e.position=u,e.data={...e.data,position:u},e.states)for(let d in e.states)JUe({stateId:d,objectOverride:e,objectRoot:t,newParentWidth:r,newParentHeight:i,initialParentWidth:n,initialParentHeight:s});if(g5(e)||e instanceof Lp)g5(e)&&(e.width=l,e.height=c,e.data={...e.data,width:l,height:c}),coe({objectOverride:e,objectRoot:t,newParentWidth:l,newParentHeight:c,initialParentWidth:a,initialParentHeight:o});else if(e instanceof K3){let d=t,f=a!==0?l/a:1,m=o!==0?c/o:1;e.path=zUe(d.path,f,m),e.data={...e.data,path:e.path}}}function JUe({stateId:e,objectOverride:t,objectRoot:r,newParentWidth:i,newParentHeight:n,initialParentWidth:s,initialParentHeight:a}){let o=t.states?.[e],l=r.states?.[e];if(o&&l){let{width:c,height:u,position:d}=aoe({constraints:t.data,newParentWidth:i,newParentHeight:n,initialParentWidth:s,initialParentHeight:a,objectInitialWidth:Dg.isResizeable(l)?l.width:0,objectInitialHeight:Dg.isResizeable(l)?l.height:0,objectInitialPosition:l.position});Object.assign(t.states[e],{position:d}),Dg.isResizeable(o)&&Object.assign(t.states[e],{width:c,height:u})}}function g5(e){return e instanceof q_||e instanceof Vu||e instanceof QB||e instanceof ZB}var Hs=class extends PB(Ro){constructor(e,t,r){super(),this.data=t,this.bgColor=new xa(1,1,1,1),this.fog=null,this.backupFog=new Sie(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new Zt,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new Ba(rb,{...F2.defaultData,...t.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new BTe(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight),t.uiScene?this.uiScene=new JB((Array.isArray(e)?e[0]:e)+"-ui",t.uiScene,{dpr:window.devicePixelRatio,shared:r.shared}):t.uiFrame&&this.createUICanvas(t.uiFrame,r)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}get frameId(){return this.data.uiFrame}get frame(){return this.uiCanvas?.frame}createUICanvas(e,t){this.uiCanvas=new loe(this.uuid+"-uiscreen",window.innerWidth,window.innerHeight,t),this.uiCanvas.isScreenSpace=!0,this.uiCanvas.promise.then(()=>{this.uiCanvas?.applyFrame(e),this.uiCanvas?.applySize()})}updateVisible(){}setBackgroundColor(e){this.bgColor=e,this.fogUseBGColor===!0&&(this.backupFog.color=e)}entityChildrenCount(){return this.uiScene?this.uiScene.children.length:super.entityChildrenCount()}updateAmbientLight(e,t){e.color!==void 0&&(this.ambientLight.color=oo(e.color,t)),e.intensity!==void 0&&(this.ambientLight.intensity=e.intensity),e.enabled!==void 0&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.traverseEntity(t=>{t instanceof $g&&t.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(e=>{if(e instanceof sb)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()})}updateShadow(e){e.softShadowQuality!==void 0&&this.isActive&&gUe(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let r=this.scene;r.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=oo(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){e.aoColor!==void 0&&(this.aoColor=oo(e.aoColor,t))}updateByOp(e,t,r,i){let n=this.data.uiFrame;super.updateByOp(e,t,r,i);let s=t;Vi(e.path,["fog"])?this.updateFog(s.fog,r.shared):Vi(e.path,["ao"])?this.updateAo(s.ao,r.shared):Vi(e.path,["ambient"])?this.updateAmbientLight(s.ambient,r.shared):Vi(e.path,["shadow"])?this.updateShadow(s.shadow):e.type===0&&e.path.length===0&&(e.props.uiFrame!==void 0||n!==s.uiFrame)&&this.updateUIFrame(e.props.uiFrame,r)}updateUIFrame(e,t){e?(this.uiCanvas||this.createUICanvas(e,t),this.uiCanvas.enabled=!0,this.uiCanvas.applyFrame(e)):this.uiCanvas&&(this.uiCanvas.enabled=!1)}updateState(e,t){this.updateState_Entity(e,t),e.backgroundColor!==void 0&&this.setBackgroundColor(oo(e.backgroundColor,t.shared)),e.fog!==void 0&&this.updateFog(e.fog,t.shared),e.ambient!==void 0&&this.updateAmbientLight(e.ambient,t.shared),e.ao!==void 0&&this.updateAo(e.ao,t.shared),e.shadow!==void 0&&this.updateShadow(e.shadow)}createFrame(e,t){}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){return this.scene?.find(this.data.publish.playCamera)??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity(r=>{if(!r.visible)return!0;r instanceof Jae&&r.visible&&e<3&&(this.penumbraSizeArrayCache[e]=r.data.penumbraSize??.5,e+=1),r instanceof eoe&&r.visible&&e<2&&(this.penumbraSizeArrayCache[3+t]=r.data.penumbraSize??.5,t+=1)})}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let s=n.cloner;Xr.is(n)&&(n.visible||s?.object.data.visible)&&((yc(n)||a5(n)&&this.scene.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),v5(n,e,t,!0)),r(n))}};return r(this),t}updateEntity2DByOp(e,t,r,i){this.uiCanvas?.updateEntity2DByOp(e,t,r,i)}},e8e=class extends XB(HTe,Kae){constructor(t,r,i){super(),this.super_Entity(t,r),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=90,n.aspect=1,n.near=100,n.far=2500;let s=new V(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),a=new V(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z),o=new Wn(s,a),l=new pM(o,new Zt(16755200));l.visible=!1,this.gizmos.shadowmap=l,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let t in this.gizmos){let r=this.gizmos[t];if(r instanceof pM){let i=this.shadow.camera,n=new V(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new V(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z);r.box.set(n,s),r.updateMatrixWorld(!0)}}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,r){this.updateState_Light(t,r),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},t8e=class extends os{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?LB(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},eF=class extends os{constructor(e,t,r){super(e,t,r),this._shapeId=null,this._context=r}updateState(e,t){super.updateState(e,t),this.updateShape(),this.refreshAttachedCloners(t)}updateShape(){let e={...this.data.geometry.extrusion.shape};for(let i in e)typeof e[i]=="string"&&(e[i]=this._context.shared.getVariable(e[i],[this.uuid,"geometry","extrusion","shape",i]));let t;if(e.type==="Custom"){let i=e.shapeId;if(i!==this._shapeId&&this.detachShape(),i){this._shapeId=i;let n=this._context.scene.find(i);n?.data&&(n.attachedPaths.add(this),t=n.geometry.userData?.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let i;switch(e.type){case"Rectangle":i=jB;break;case"Ellipse":i=OB;break;case"Polygon":i=Yse;break;case"Star":i=Xse;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=i.create({parameters:e}).userData.shape}let r=this.geometry;t&&r.inputs&&(r.inputs.shapeData=t,r.build())}detachShape(){this._shapeId!==null&&this._context.scene.find(this._shapeId)?.attachedPaths.delete(this)}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e,t){return super.updateTransformState(e,t)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let r=this.geometry.getAttribute("position");r!==void 0?LB(r,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:r.count,e,t):super.updateEntityBoxSize(e,t)}},tF=class extends YB{constructor(e,t,r){super(e,t,r),this.data=t}},Uy=class extends ab(gh,G_){constructor(e,t,r){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,r)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let r=BM.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(r){let i,n;for(let s of hp.rootOverrideProps)e[s]===void 0?(i===void 0&&(i={...e}),i[s]=r.data[s]):(n===void 0&&(n={}),n[s]=e[s],i===void 0&&(i={...e}),i[s]=xp.apply(r.data[s],e[s]));return this.overrideData=n,i}else return{...Cs.defaultData,...e,...Bu(Cs.defaultData,hp.rootOverrideProps)}}updateByOp(e,t,r,i){let n;if(this.isInstanceRoot&&!i){if(t=this.transformAssignData(t,r),e.type===0&&e.path.length===0&&this.component)for(let s of hp.rootOverrideProps)s in e.props&&e.props[s]===void 0&&(n===void 0&&(n={...e,props:{...e.props}}),n.props[s]=this.component.data[s]);else if(e.type===0&&e.path.length>0&&hp.rootOverrideProps.includes(e.path[0])){let s=e.path[0];n===void 0&&(n={...e,path:[],props:{[s]:t[s]}})}}super.updateByOp(n??e,t,r,i)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){let r=e.scene.find(t.component)??null,i=!1;if(r!==this.oldComponent){if(this.oldComponent){let n=0;for(let s of this.children)if(Xr.is(s))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),rF(s),n+=1;else break;this.children.splice(0,n)}i=!0}if(r){let n={};uoe(e,[this.uuid],t.overrides,this,r,r,0,i,n);for(let s of this.children)if(Xr.is(s)){let a=s.data;a.type==="Empty"&&a.animations&&s.traverseEntity(o=>{let l=o.dataPatched;if(o instanceof os&&l.bones&&l.boneInverses){let c=o.dataPatched;if(c.bones&&c.boneInverses){let u=c.bones.map(m=>e.scene.find(n[m])),d=c.boneInverses.map(m=>new ot().fromArray(m)),f=new G6(u,d);o.bind(f,o.bindMatrix)}}else o.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function rF(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let r of e.children)Xr.is(r)&&rF(r)}}function ZX(e,t,r,i){return e.component===t&&gB(e.identity,i)?e.overrideData===r?2:1:0}function uoe(e,t,r,i,n,s,a,o,l){if(a>50)return!1;if(i.component!==n){if(i.component){let u=i.component.instances.indexOf(i);u>=0&&i.component.instances.splice(u,1)}n.instances.find(u=>u===i)||n.instances.push(i),i.component=n}n instanceof Uy&&n.isInstanceRoot&&n.expandInstanceChildren(e);let c=0;for(let u of n.children)if(Xr.is(u)){let d=[...t,...typeof u.identity=="string"?[u.identity]:u.identity],f=OM.resolve(r,d,1);f!=null&&!(f instanceof us)&&(Object.setPrototypeOf(f,us.prototype),console.error("wrong prototype"));let m=null,v;if(!o){let y=i.children[c];if(m=Xr.is(y)?y:null,m!==null){let x=ZX(m,u,f,d);v=x>=1?m.stateSelection:void 0,x!==2&&(m=null)}if(m===null&&(m=e.scene.findInstance(d)??null,m!==null)){let x=ZX(m,u,f,d);if(v=x>=1?m.stateSelection:void 0,x!==2)m=null;else{let w=m.parent.children.indexOf(m);m.parent.children.splice(w,1),i.children.splice(c,0,m),m.parent===i?w<=c&&console.error("not possible"):(m.parent=i,m.matrixWorldNeedsUpdate=!0,m.resetBBoxNeedsUpdate(),m.updateVisible(),e.pendingDeletes.delete(m))}}}if(m===null){let y=f?xp.apply(u.data,f):u.data;qg.is(y.type)&&(y={...y,type:"Empty"}),m=fp.createEntity(d,y,e),m.overrideData=f,i.add(m),i.children.splice(i.children.length-1,1),i.children.splice(c,0,m),m.updateState(m.data,e),v&&m.changeSelectedState(v,e),e.scene.registerInstanceAndSetUuid(m)}if(m.isBone){let y=m.identity[m.identity.length-1];l[y]=m.uuid}c+=1,uoe(e,t,r,m,u,s,a+1,o,l)}if(!o){let u=c;for(;;){let d=i.children[c];if(Xr.is(d))e.pendingDeletes.add(d);else break;c+=1}i.children.splice(u,c-u)}return!0}var r8e=class extends ab(Eie,G_){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}},ja=class extends os{constructor(e,t,r){super(e,t,r),this.onBeforeRender=i=>{this.uiCanvas.render(i)},this.uiCanvas=new loe(e+"-canvas",t.geometry.width,t.geometry.height,r),this.uiCanvas.promise.then(()=>{this.applyFrame(this.dataPatched.geometry.frame,r.shared)})}updateByPatchedOpGeometry(e,t,r){super.updateByPatchedOpGeometry(e,t,r),e.type===0&&(e.props.frame!==void 0&&this.applyFrame(e.props.frame,r.shared),(e.props.width!==void 0||e.props.height!==void 0)&&this.applySize(e.props,r.shared))}applySize(e,t){let r=e?.width??this.dataPatched.geometry.width,i=e?.height??this.dataPatched.geometry.height;this.uiCanvas.applySize({width:r,height:i}),this.applyGeometryParametersFromFrame(t)}applyFrame(e,t){this.uiCanvas.applyFrame(e),this.applyGeometryParametersFromFrame(t),this.applyMaterialParametersFromFrame({shared:t})}applyGeometryParametersFromFrame(e){let t=this.frame;t&&(Object.assign(this.data,{geometry:Object.assign(this.data.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),Object.assign(this.dataPatched,{geometry:Object.assign(this.dataPatched.geometry,{cornerRadius:t.cornerRadius,cornerType:0})}),this.localGeometry?.dispose(),this.localGeometry=Y2(this.dataPatched.geometry,e,this.data.flatShading,this))}applyMaterialParametersFromFrame(e){let t=this.frame;if(t){let r=t.data.backgroundBlur;Object.assign(this.data.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.data.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),Object.assign(this.dataPatched.material.layers[0].data.texture,{image:this.uiCanvas.uuid}),Object.assign(this.dataPatched.material.layers[1].data,{roughness:r.radius,alpha:r.enabled?1:0}),this.material.reset(this.dataPatched.material,e,!0)}}updateEntity2DByOp(e,t,r,i){this.uiCanvas.updateEntity2DByOp(e,t,r,i),e===this.frameId&&t.type===0&&(t.props.cornerRadius!==void 0?this.applyGeometryParametersFromFrame(i):Vi(t.path,["backgroundBlur"])&&this.applyMaterialParametersFromFrame({shared:i}))}get frame(){return this.uiCanvas.frame}get frameId(){return this.frame?.uuid}removeInteractionGeometry(e){super.removeInteractionGeometry(e),this.applySize({},e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.applySize({width:e.width,height:e.height},t)}},i8e=class{constructor(e,t,r){this.variables=[],this.currentTextureIndex=0;let i=Ni,n=new Ro,s=new em;s.position.z=1;let a={passThruTexture:{value:null}},o=u(f(),a),l=new Yi(new ed(2,2),o);n.add(l),this.setDataType=function(m){return i=m,this},this.addVariable=function(m,v,y){let x=this.createShaderMaterial(v),w={name:m,initialValueTexture:y,material:x,dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:jr,magFilter:jr};return this.variables.push(w),w},this.setVariableDependencies=function(m,v){m.dependencies=v},this.init=function(){if(r.capabilities.isWebGL2===!1&&r.extensions.has("OES_texture_float")===!1)return"No OES_texture_float support for float textures.";if(r.capabilities.maxVertexTextures===0)return"No support for vertex shader textures.";for(let m=0;m<this.variables.length;m++){let v=this.variables[m];v.renderTargets[0]=this.createRenderTarget(e,t,v.wrapS,v.wrapT,v.minFilter,v.magFilter),v.renderTargets[1]=this.createRenderTarget(e,t,v.wrapS,v.wrapT,v.minFilter,v.magFilter),this.renderTexture(v.initialValueTexture,v.renderTargets[0]),this.renderTexture(v.initialValueTexture,v.renderTargets[1]);let y=v.material,x=y.uniforms;if(v.dependencies!==null)for(let w=0;w<v.dependencies.length;w++){let _=v.dependencies[w];if(_.name!==v.name){let S=!1;for(let P=0;P<this.variables.length;P++)if(_.name===this.variables[P].name){S=!0;break}if(!S)return"Variable dependency not found. Variable="+v.name+", dependency="+_.name}x[_.name]={value:null},y.fragmentShader=`
uniform sampler2D `+_.name+`;
`+y.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){let m=this.currentTextureIndex,v=this.currentTextureIndex===0?1:0;for(let y=0,x=this.variables.length;y<x;y++){let w=this.variables[y];if(w.dependencies!==null){let _=w.material.uniforms;for(let S=0,P=w.dependencies.length;S<P;S++){let M=w.dependencies[S];_[M.name].value=M.renderTargets[m].texture}}this.doRenderTarget(w.material,w.renderTargets[v])}this.currentTextureIndex=v},this.getCurrentRenderTarget=function(m){return m.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(m){return m.renderTargets[this.currentTextureIndex===0?1:0]},this.dispose=function(){l.geometry.dispose(),l.material.dispose();let m=this.variables;for(let v=0;v<m.length;v++){let y=m[v];y.initialValueTexture&&y.initialValueTexture.dispose();let x=y.renderTargets;for(let w=0;w<x.length;w++)x[w].dispose()}};function c(m){m.defines.resolution="vec2( "+e.toFixed(1)+", "+t.toFixed(1)+" )"}this.addResolutionDefine=c;function u(m,v){v=v||{};let y=new Jr({uniforms:v,vertexShader:d(),fragmentShader:m});return c(y),y}this.createShaderMaterial=u,this.createRenderTarget=function(m,v,y,x,w,_){return m=m||e,v=v||t,y=y||an,x=x||an,w=w||jr,_=_||jr,new Zr(m,v,{wrapS:y,wrapT:x,minFilter:w,magFilter:_,format:dn,type:i,depthBuffer:!1})},this.createTexture=function(){let m=new Float32Array(e*t*4),v=new ao(m,e,t,dn,Ni);return v.needsUpdate=!0,v},this.renderTexture=function(m,v){a.passThruTexture.value=m,this.doRenderTarget(o,v),a.passThruTexture.value=null},this.doRenderTarget=function(m,v){let y=r.getRenderTarget(),x=r.xr.enabled,w=r.shadowMap.autoUpdate,_=r.outputEncoding,S=r.toneMapping;r.xr.enabled=!1,r.shadowMap.autoUpdate=!1,r.outputEncoding=Bc,r.toneMapping=zu,l.material=m,r.setRenderTarget(v),r.render(n,s),l.material=o,r.xr.enabled=x,r.shadowMap.autoUpdate=w,r.outputEncoding=_,r.toneMapping=S,r.setRenderTarget(y)};function d(){return`void main()	{

	gl_Position = vec4( position, 1.0 );

}
`}function f(){return`uniform sampler2D passThruTexture;

void main() {

	vec2 uv = gl_FragCoord.xy / resolution.xy;

	gl_FragColor = texture2D( passThruTexture, uv );

}
`}}},sa=new fa,sC=new V,n8e=class{constructor(e){let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(console.warn("THREE.MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.colorAttribute=this.geometry.getAttribute("color"),this.weightAttribute=null,this.distribution=null}setWeightAttribute(e){return this.weightAttribute=e?this.geometry.getAttribute(e):null,this}build(){let e=this.positionAttribute,t=this.weightAttribute,r=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let s=1;t&&(s=t.getX(n)+t.getX(n+1)+t.getX(n+2)),sa.a.fromBufferAttribute(e,n),sa.b.fromBufferAttribute(e,n+1),sa.c.fromBufferAttribute(e,n+2),s*=sa.getArea(),r[n/3]=s}this.distribution=new Float32Array(e.count/3);let i=0;for(let n=0;n<r.length;n++)i+=r[n],this.distribution[n]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t,r){let i=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*i);return this.sampleFace(n,e,t,r)}binarySearch(e){let t=this.distribution,r=0,i=t.length-1,n=-1;for(;r<=i;){let s=Math.ceil((r+i)/2);if(s===0||t[s-1]<=e&&t[s]>e){n=s;break}else e<t[s]?i=s-1:r=s+1}return n}sampleFace(e,t,r,i){let n=this.randomFunction(),s=this.randomFunction();return n+s>1&&(n=1-n,s=1-s),sa.a.fromBufferAttribute(this.positionAttribute,e*3),sa.b.fromBufferAttribute(this.positionAttribute,e*3+1),sa.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(sa.a,n).addScaledVector(sa.b,s).addScaledVector(sa.c,1-(n+s)),r!==void 0&&sa.getNormal(r),i!==void 0&&this.colorAttribute!==void 0&&(sa.a.fromBufferAttribute(this.colorAttribute,e*3),sa.b.fromBufferAttribute(this.colorAttribute,e*3+1),sa.c.fromBufferAttribute(this.colorAttribute,e*3+2),sC.set(0,0,0).addScaledVector(sa.a,n).addScaledVector(sa.b,s).addScaledVector(sa.c,1-(n+s)),i.r=sC.x,i.g=sC.y,i.b=sC.z),this}};function s8e(e){let t=new Float32Array(e*e*2);for(let r=0;r<e;r++)for(let i=0;i<e;i++){let n=r*e+i;t[n*2+0]=r/(e-1),t[n*2+1]=i/(e-1)}return t}function a8e(e){let t=Math.ceil(Math.sqrt(e));return Math.max(t,1)}function o8e(e,t){let r=new Yi(e.geometry,e.material),i=[],n=[],s=new V,a=new V;r.geometry.index!==null&&(r.geometry=r.geometry.toNonIndexed());let o=new n8e(r).build();for(let u=0;u<t;u++)o.sample(s,a),i.push(s.x,s.y,s.z),n.push(a.x,a.y,a.z);let l=new Float32Array(i),c=new Float32Array(n);return{positions:l,normals:c}}function JX(e,t){let r=e,i=new Float32Array(4*t*t);for(let s=0;s<t*t;s++)i[4*s]=r[3*s],i[4*s+1]=r[3*s+1],i[4*s+2]=r[3*s+2],i[4*s+3]=0;let n=new ao(i,t,t,dn,Ni);return n.needsUpdate=!0,n}function l8e({size:e}){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=i,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let r=new ao(t,e,e,dn,Ni);return r.needsUpdate=!0,r}function c8e(e){let t=new Float32Array(4*e*e);for(let i=0;i<e*e;i++)t[4*i]=0,t[4*i+1]=0,t[4*i+2]=0,t[4*i+3]=0;let r=new ao(t,e,e,dn,Ni);return r.needsUpdate=!0,r}var u8e=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform float uTime;
uniform float uSpeed;     // update speed of the particles
uniform vec3 uWorldOffset;    
uniform vec4 uWorldQuaternion;
uniform float uMaxLifeTime;
uniform vec3 uEmitterSize;
uniform float uFPSRatio;     // 1  for 60 FPS

float random (vec2 st) {
    return fract(sin(dot(st.xy,
        vec2(12.9898,78.233)))*
        43758.5453123);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
    vec3 acceleration = force / mass;
    
    return acceleration;
  }
  

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    float currentLife = texture2D( uCurrentPosition, vUv ).w;   // from 1 to 0
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).r;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;          // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;         // timeStart in seconds when the particle was emitted
    vec3 originalPosition = ((texture2D( uOriginalPosition, vUv ).xyz) * uEmitterSize);
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float collisionFlag = texture2D( uCurrentVelocity, vUv ).w;             // 1. = collided, 0. = not collided
    float lifeTime = uMaxLifeTime;

    // Calculate the position adjustment based on collision
    //     if (collisionFlag > .5) {  
    float isColliding = step(0.5, collisionFlag); // 1.0 if collisionFlag > 0.5, otherwise 0.0
    float bounceOffset = 3.0 * isColliding; // Becomes 3.0 if colliding, 0.0 otherwise
    vec3 collisionAdjustedVelocity = velocity * (1.0 + bounceOffset);

    // Update position based on collision or normal movement
    vec3 fpsVelocity = velocity * min(uFPSRatio, 5.0);
    position += mix(fpsVelocity, collisionAdjustedVelocity, isColliding);

    // EMISSION RATE - BIRTH
    // if (isSpawning == 1.0) {
    // Better Approach to avoid If statement
    vec3 newPosition = applyQuaternionToVector(uWorldQuaternion, originalPosition) + uWorldOffset;
    originalPosition = mix(originalPosition, newPosition, isSpawning);
    position = mix(position, originalPosition, isSpawning);;
    timeStart = mix(timeStart, uTime, isSpawning);

    // Calculate timeLeft for life normalization
    float timeLeft = max(lifeTime - (uTime - timeStart), 0.0);
    float life_Normalize = timeLeft / lifeTime;

    // Use isActive to blend between the calculated color and black
    vec4 activeColor = vec4(position, life_Normalize);
    // if (isActive == 1.0) {
    gl_FragColor = mix(vec4(0.0), activeColor, isActive);

}
`,d8e=`

    vec3 mod289(vec3 x) {
      return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 mod289(vec4 x) {
    return x - floor(x * (1.0 / 289.0)) * 289.0;
    }
    
    vec4 permute(vec4 x) {
        return mod289(((x*34.0)+1.0)*x);
    }
    
    vec4 taylorInvSqrt(vec4 r)
    {
    return 1.79284291400159 - 0.85373472095314 * r;
    }
    
    vec3 fade(vec3 t) {
  return t*t*t*(t*(t*6.0-15.0)+10.0);
}

    float snoise(vec3 v)
    {
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );
    vec3 x1 = x0 - i1 + C.xxx;
    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
    
    // Permutations
    i = mod289(i);
    vec4 p = permute( permute( permute(
                i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
              + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
              + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
    
    // Gradients: 7x7 points over a square, mapped onto an octahedron.
    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
    float n_ = 0.142857142857; // 1.0/7.0
    vec3  ns = n_ * D.wyz - D.xzx;
    
    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
    
    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
    
    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);
    
    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );
    
    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));
    
    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
    
    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);
    
    //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;
    
    // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
    }
    
    vec3 snoiseVec3( vec3 x ){
    
      float s  = snoise(vec3( x ));
      float s1 = snoise(vec3( x.y - 19.1 , x.z + 33.4 , x.x + 47.2 ));
      float s2 = snoise(vec3( x.z + 74.2 , x.x - 124.5 , x.y + 99.4 ));
      vec3 c = vec3( s , s1 , s2 );
      return c;
    
    }
    
      
    vec3 curlNoise( vec3 p, float seed){
      p += seed;
      const float e = .1;
      vec3 dx = vec3( e   , 0.0 , 0.0 );
      vec3 dy = vec3( 0.0 , e   , 0.0 );
      vec3 dz = vec3( 0.0 , 0.0 , e   );
    
      vec3 p_x0 = snoiseVec3( p - dx );
      vec3 p_x1 = snoiseVec3( p + dx );
      vec3 p_y0 = snoiseVec3( p - dy );
      vec3 p_y1 = snoiseVec3( p + dy );
      vec3 p_z0 = snoiseVec3( p - dz );
      vec3 p_z1 = snoiseVec3( p + dz );
    
      float x = p_y1.z - p_y0.z - p_z1.y + p_z0.y;
      float y = p_z1.x - p_z0.x - p_x1.z + p_x0.z;
      float z = p_x1.y - p_x0.y - p_y1.x + p_y0.x;
    
      const float divisor = 1.0 / ( 2.0 * e );
      return normalize( vec3( x , y , z ) * divisor );
    
    }


// Classic Perlin noise
float cnoise(vec3 P)
{
  vec3 Pi0 = floor(P); // Integer part for indexing
  vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1
  Pi0 = mod289(Pi0);
  Pi1 = mod289(Pi1);
  vec3 Pf0 = fract(P); // Fractional part for interpolation
  vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
  vec4 iy = vec4(Pi0.yy, Pi1.yy);
  vec4 iz0 = Pi0.zzzz;
  vec4 iz1 = Pi1.zzzz;

  vec4 ixy = permute(permute(ix) + iy);
  vec4 ixy0 = permute(ixy + iz0);
  vec4 ixy1 = permute(ixy + iz1);

  vec4 gx0 = ixy0 * (1.0 / 7.0);
  vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
  gx0 = fract(gx0);
  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
  vec4 sz0 = step(gz0, vec4(0.0));
  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
  gy0 -= sz0 * (step(0.0, gy0) - 0.5);

  vec4 gx1 = ixy1 * (1.0 / 7.0);
  vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
  gx1 = fract(gx1);
  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
  vec4 sz1 = step(gz1, vec4(0.0));
  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
  gy1 -= sz1 * (step(0.0, gy1) - 0.5);

  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);

  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
  g000 *= norm0.x;
  g010 *= norm0.y;
  g100 *= norm0.z;
  g110 *= norm0.w;
  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
  g001 *= norm1.x;
  g011 *= norm1.y;
  g101 *= norm1.z;
  g111 *= norm1.w;

  float n000 = dot(g000, Pf0);
  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
  float n111 = dot(g111, Pf1);

  vec3 fade_xyz = fade(Pf0);
  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
  return 2.2 * n_xyz;
}


vec3 fbm_vec3(vec3 p, float frequency, float offset)
{
  return vec3(
    cnoise((p+vec3(offset))*frequency),
    cnoise((p+vec3(offset+20.0))*frequency),
    cnoise((p+vec3(offset-30.0))*frequency)
  );
}

`,h8e=`
  #ifdef USE_COLLIDER
    float restitution = max(uBounce * 2., .01); // Energy Loss
    // SPHERE COLLIDER
    // **************************************************************
    #ifdef USE_SPHERE_COLLIDER       
      // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
      vec3 radii = uColliderSize;
      // Adjust position relative to collider
      vec3 relPos = position - uColliderPos;
      // Apply rotation of the collider to the relative position
      relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
      // Scale relative position by radii (for ellipsoid collision detection)
      vec3 scaledPos = relPos / radii;
      // Calculate ellipsoidal distance
      float dist = length(scaledPos); // Distance in terms of ellipsoid
      
      // Check for collision
      if (dist <= 1. + particleSize / length(radii) && collisionFlag == 0.0) {
          // Compute the normal at the collision point, accounting for particle size
        vec3 adjustedPos = scaledPos * (1.0 + particleSize / length(radii));          
        // Compute the normal at the collision point
        vec3 normal = ellipsoidNormal(adjustedPos, radii);
        // Rotate the normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);
        // Reflect the velocity vector off the normal
        velocity = reflect(velocity, normal) * restitution;

        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif

    // BOX COLLIDER or PLANE COLLIDER 
    // **************************************************************
    #ifdef USE_BOX_COLLIDER
      // Box dimensions and repulsion variables
      vec3 boxHalfSize = uColliderSize / 2.0;
      // Convert world position to box's local space
      vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
      // Collision detection
      vec3 localDistance = abs(localPos) - boxHalfSize;
      float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));    

      // Collision Detected
      if (distToSurface <= particleSize * 0.5 && collisionFlag == 0.0) {      
        // Find the nearest face normal for bounce direction
        vec3 normal;
        if (localDistance.x > localDistance.y && localDistance.x > localDistance.z) {
            normal = vec3(sign(localPos.x), 0.0, 0.0);
        } else if (localDistance.y > localDistance.z) {
            normal = vec3(0.0, sign(localPos.y), 0.0);
        } else {
            normal = vec3(0.0, 0.0, sign(localPos.z));
        }            
        // Rotate normal back to world space
        normal = applyQuaternionToVector(uColliderQuaternion, normal);      
        // Reflect velocity and apply repulsion force
        velocity = reflect(velocity, normal) * restitution;
        
        collisionFlag = 1.0;
      } else {
        collisionFlag = 0.0;
      }
    #endif      
  #endif      
  // END COLLIDER    
`,f8e=`
  #ifdef USE_ATTRACTOR

      #ifdef USE_SPHERE_COLLIDER      
        // Convert collider size to radii (assuming uColliderSize is the diameter in each axis)
        vec3 radii = uColliderSize;
        // Adjust position relative to collider
        vec3 relPos = position - uColliderPos;
        // Apply rotation of the collider to the relative position
        relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
        // Scale relative position by radii (for ellipsoid collision detection)
        vec3 scaledPos = relPos / radii;
        // Calculate ellipsoidal distance
        float distToSurface = length(scaledPos); // Distance in terms of ellipsoid
        float insideCheck = 1.0;

      #endif


      #ifdef USE_BOX_COLLIDER
        // Box dimensions
        vec3 boxHalfSize = uColliderSize / 2.0;
        // Convert world position to box's local space
        vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
        vec3 localDistance = abs(localPos) - boxHalfSize;
        float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));
        float insideCheck = particleSize;
      #endif      
  
      // Apply vortex force inside the Helper
      #ifdef USE_FORCE_LOCAL_SPACE
        if (distToSurface <= insideCheck ) {    
            // Define parameters for the attractor field
            #ifdef USE_SPHERE_COLLIDER      
              float attractorStrength = (1.0 - distToSurface ) * uForceIntensity; // Adjust as needed
            #endif

            #ifdef USE_BOX_COLLIDER
              float attractorStrength = max((1.0 - insideCheck / distToSurface), 0.) * uForceIntensity; // Adjust as needed
              #endif

            float attractorDamping = uForceDamping;  // Adjust as needed (higher values will attenuate velocity more)
          
            // Use the same radii calculation code as for the collider
            vec3 attractorRadii = uColliderSize;
            // Adjust position relative to attractor center
            vec3 relPos = position - uColliderPos;
            // Apply rotation of the collider to the relative position
            relPos = applyQuaternionToVector(uColliderQuaternionInvert, relPos);            
            // Scale relative position by radii (for ellipsoid attraction)
            vec3 scaledPos = relPos / attractorRadii;

            // Calculate ellipsoidal distance as attractor radius
            float attractorRadius = length(scaledPos);
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * attractorStrength;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= attractorDamping;
        }
      #else 
            // Calculate the distance from the attractor center
            vec3 relativePosition = position - uColliderPos;
            // Calculate the force vector towards the attractor center
            vec3 attractorForce = normalize(relativePosition) * uForceIntensity;
            // Apply the attractor force to the particle
            velocity -= attractorForce;
            // Attenuate the particle's velocity
            velocity *= uForceDamping;
      #endif    
  #endif      
`,p8e=`
  #ifdef USE_VORTEX
    // Box dimensions
    vec3 boxHalfSize = uColliderSize / 2.0;
    // Convert world position to box's local space
    vec3 localPos = applyQuaternionToVector(uColliderQuaternionInvert, position - uColliderPos);      
    vec3 localDistance = abs(localPos) - boxHalfSize;
    float distToSurface = max(localDistance.x, max(localDistance.y, localDistance.z));

    // Apply vortex force inside the box
    if (distToSurface <= particleSize) {
      float vortexStrength = uForceIntensity;
      vec3 localTopCenter = vec3(0.0, 0., 0.0);

      // Transform the local top center to the world space
      vec3 vortexCenter = uColliderPos + applyQuaternionToVector(uColliderQuaternion, localTopCenter);
      // Calculate the vector from particle to vortex center
      vec3 vortexVector = vortexCenter - position;

      // Calculate the rotation axis from the inverse of the collider's quaternion and the fixed up vector
      // Note: important to add a tiny z component to the up vector to avoid instability
      vec3 upVector = vec3(0.0, 1.0, 0.01);
      vec3 rotationAxis = cross(upVector, applyQuaternionToVector(uColliderQuaternion, vortexVector));
      rotationAxis = normalize(rotationAxis);

      // Add rotational component to velocity
      float rotationSpeed = length(vortexVector * vortexStrength * 3.0) ; 

      vec3 rotationVelocity = rotationAxis * rotationSpeed;
      // velocity += rotationVelocity * 0.005 ;
      velocity = rotationVelocity * 0.005 ;

      // Calculate vortex force
      // vec3 vortexForce = normalize(vortexVector) * uSpeed * .1 ;
      // Apply the vortex force to the particle
      vec3 originDirection = applyQuaternionToVector(uWorldQuaternion, directions);
      velocity += applyForce( originDirection * uSpeed * (1. - uForceDamping) , mass * .5);
    }
  #endif      
`,m8e=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU
uniform sampler2D uOriginalPosition;
uniform sampler2D uDirections;     
uniform vec3 uDirectionsAxis;
uniform vec4 uWorldQuaternion;
uniform vec3 uGravity;        
uniform float uNoiseStrength;     // Variation of the noise
uniform float uNoiseScale;        // Scale of the noise
uniform float uNoiseSeed;         // Seed of the noise
uniform float particleSize;
uniform float uSpeed;     // update speed of the particles
uniform float uRandomMassFactor;

// COLLIDER
uniform vec3 uColliderPos;                // Collider Position
uniform vec3 uColliderSize;               // Collider Dimension
uniform vec4 uColliderQuaternion;         // Collider Rotation
uniform vec4 uColliderQuaternionInvert;   // Collider Rotation
uniform float uBounce;                    // Bounce factor
uniform float uForceDamping;
uniform float uForceIntensity;


`+d8e+`
float rand(vec2 co){
    return fract(sin(dot(co, vec2(12.9898, 78.233))) * 43758.5453);
}
vec3 applyQuaternionToVector( vec4 q, vec3 v ){
    return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
 } 
vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
  
  return acceleration;
}

vec4 conjugate(vec4 q) {
  return vec4(q.w, -q.x, -q.y, -q.z);
}

// Function to compute the normal of the ellipsoid at a given point
vec3 ellipsoidNormal(vec3 p, vec3 radii) {
  return normalize(p / (radii * radii));
}

float friction = .3;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    vec3 position = texture2D( uCurrentPosition, vUv ).xyz;
    vec3 originalPosition = texture2D( uOriginalPosition, vUv ).xyz;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    vec3 directions = texture2D( uDirections, vUv ).xyz;    
    vec3 velocity = texture2D( uCurrentVelocity, vUv ).xyz;
    float mass = rand(originalPosition.xy) * 0.5 + 0.5;
    float isSpawning = texture2D( uCurrentEmissionRate, vUv ).x;        // 1. = spawning, 0. = not spawning
    float isActive = texture2D( uCurrentEmissionRate, vUv ).y;          // 1. = active, 0. = not active
    float collisionFlag =texture2D( uCurrentVelocity, vUv ).w;          // Indicate collision

    // Randomness Mass
    mass = (1.0 - (uRandomMassFactor * mass));
    
    if (isActive == 1.0) {
      // **************************************************************
      // FORCES NOISES
      // **************************************************************
      #ifdef USE_CURL_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = curlNoise(position * uNoiseScale * .002, uNoiseSeed) * ( uNoiseStrength + 1.0) * .05 * uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {
          velocity += curlNoise( position, uNoiseSeed)  * uNoiseStrength * 0.05 * uSpeed;
        }
      #endif
      // **************************************************************
      #ifdef USE_SIMPLEX_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = vec3(snoise(position * uNoiseScale * .001) * ( uNoiseStrength + 1.0) * .1);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0) {
          velocity += vec3(snoise(position * uNoiseStrength * .001) * .05 * uSpeed);
        }
      #endif
      // ************************************************************** 
      #ifdef USE_FBM_NOISE
        if (uNoiseScale > 0.0 ) {
          velocity = fbm_vec3(position * uNoiseScale * .001, ( uNoiseStrength + 1.0), uNoiseSeed);
          velocity *= uSpeed;
        }
        // Variation of the noise Over Time
        if (uNoiseStrength > 0.0 && uNoiseScale == 0.0 ) {      
          velocity += fbm_vec3(position * uNoiseStrength * .001, ( uNoiseStrength + 1.0), uNoiseSeed) * .1 * uSpeed;
        }
      #endif

      // COLLIDER
      ${h8e}
      // ATTRACTION
      ${f8e}  
      // VORTEX
      ${p8e}
    } 
    // End isActive

    // SPAWN BIRTH 
    // **************************************************************
    // if (isSpawning == 1.)
    #ifdef USE_NORMALS
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, directions) * uSpeed, isSpawning);
    #else
      velocity = mix(velocity, applyQuaternionToVector(uWorldQuaternion, uDirectionsAxis) * uSpeed, isSpawning);    
    #endif
    
    // if (collisionFlag == 0.0)
    velocity += applyForce(uGravity, mass * .5) * (1.0 - collisionFlag);

    gl_FragColor = vec4(velocity, collisionFlag);
}
`,doe=`

  // Linear Fade In
  float linearFadeIn(float t) {
    return t;
  }


  // linear fade out
  float linearFadeOut(float t) {
    return 1.0 - t;
  }
  
  float linearInOut(float t) {
    return t < 0.5 ? t :  (1.0 - t);  
  }

    // lerp
    float lerp(float a, float b, float t) {
      return a + (b - a) * t;
    }

  // Ease In Out Quart
  float exponentialInOut(float t) {
    return t < 0.4 ? lerp(0.0, 1.0, t / 0.4) :
    t > 0.6 ? lerp(1.0, 0.0, (t - 0.6) / 0.4) :
    1.0;
   }

  // constant
  float constant(float t) {
    return 1.0;
  } 
`,g8e=`

float rand(vec3 co){
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

vec3 applyQuaternionToVector( vec4 q, vec3 v ){
  return v + 2.0 * cross( q.xyz, cross( q.xyz, v ) + q.w * v );
}

vec3 applyForce(vec3 force, float mass) {
  vec3 acceleration = force / mass;
    
  return acceleration;
}
`,v8e=`
vec3 rgb2xyz (in vec3 rgb) {
    float r = rgb.r;
	float g = rgb.g;
	float b = rgb.b;

	r = r > 0.04045 ? pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);
	g = g > 0.04045 ? pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);
	b = b > 0.04045 ? pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);

	float x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);
	float y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);
	float z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);
    
    vec3 xyz = vec3(
        (r * 0.4124) + (g * 0.3576) + (b * 0.1805) * 100.0,
        (r * 0.2126) + (g * 0.7152) + (b * 0.0722) * 100.0,
        (r * 0.0193) + (g * 0.1192) + (b * 0.9505) * 100.0
    );
    return(xyz);
}

vec3 xyz2lab (in vec3 xyz) {
	float x = xyz.x / 95.047;
	float y = xyz.y / 100.0;
	float z = xyz.z / 108.883;

	x = x > 0.008856 ? pow(x, 1.0 / 3.0) : (7.787 * x) + (16.0 / 116.0);
	y = y > 0.008856 ? pow(y, 1.0 / 3.0) : (7.787 * y) + (16.0 / 116.0);
	z = z > 0.008856 ? pow(z, 1.0 / 3.0) : (7.787 * z) + (16.0 / 116.0);

    vec3 lab = vec3((116.0 * y) - 16.0, 500.0 * (x - y), 200.0 * (y - z));
    return(lab);
}

vec3 rgb2lab(in vec3 rgb) {
    vec3 xyz = rgb2xyz(rgb);
    vec3 lab = xyz2lab(xyz);
    return(lab);
}

vec3 xyz2rgb (in vec3 xyz) {
	float x = xyz.x / 100.0;
	float y = xyz.y / 100.0;
	float z = xyz.z / 100.0;
	
    
	float r = (x *  3.2406) + (y * -1.5372) + (z * -0.4986);
	float g = (x * -0.9689) + (y *  1.8758) + (z *  0.0415);
	float b = (x *  0.0557) + (y * -0.2040) + (z *  1.0570);

	r = r > 0.0031308 ? ((1.055 * pow(r, 1.0 / 2.4)) - 0.055) : r * 12.92;
	g = g > 0.0031308 ? ((1.055 * pow(g, 1.0 / 2.4)) - 0.055) : g * 12.92;
	b = b > 0.0031308 ? ((1.055 * pow(b, 1.0 / 2.4)) - 0.055) : b * 12.92;

	r = min(max(0.0, r), 1.0);
	g = min(max(0.0, g), 1.0);
	b = min(max(0.0, b), 1.0);

	return(vec3(r, g, b));
}

vec3 lab2xyz (in vec3 lab) {
    float l = lab.x;
	float a = lab.y;
	float b = lab.z;

  	float y = (l + 16.0) / 116.0;
	float x = a / 500.0 + y;
	float z = y - b / 200.0;

	float y2 = pow(y, 3.0);
	float x2 = pow(x, 3.0);
	float z2 = pow(z, 3.0);

  	y = y2 > 0.008856 ? y2 : (y - 16.0 / 116.0) / 7.787;
	x = x2 > 0.008856 ? x2 : (x - 16.0 / 116.0) / 7.787;
	z = z2 > 0.008856 ? z2 : (z - 16.0 / 116.0) / 7.787;

	x *= 95.047;
	y *= 100.0;
	z *= 108.883;

	return(vec3(x, y, z));
}
vec3 lab2rgb (in vec3 lab) {
    vec3 xyz = lab2xyz(lab);
    vec3 rgb = xyz2rgb(xyz);
    return(rgb);
}

`,y8e=`
  uniform sampler2D uPosition;
  uniform float uSize;
  uniform float uSizeEnd;
  uniform vec3 uWorldOffset;
  uniform vec4 uWorldQuaternion;
  // Billboard Behavior - Currently at Zero, but we can change that
  uniform float uRotation;
  uniform float uRotationEnd;
  uniform vec2 center;

  // Randomness
  uniform float uRandScaleFactor;
  uniform float uRandRotationFactor;

  attribute vec2 ref;

  varying float v_LifeLeft;    // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  ${g8e}
  ${doe}
`,x8e=({easeSize:e="linearFadeOut"})=>`
  vUv = uv;  
  vRef = ref;
  // Normalized LifeTime 1 to 0
  float lifeLeft = texture2D(uPosition, ref).w;
  v_LifeLeft = lifeLeft;
  // Position From DataTexture Simulation
  vec3 pos = texture2D(uPosition, ref).rgb - uWorldOffset;
  // Apply World Quaternion
  pos = applyQuaternionToVector(uWorldQuaternion, pos);  
            
  #ifdef  USE_SIZE_END
    // Scaled Over Time
    float t = 1. - lifeLeft;
    float currentSize = mix(uSize, uSizeEnd, t); // Linearly interpolate between uSize and uSizeEnd
    vec3 scaledPosition = position * vec3(currentSize);
  #else
    // Change Size Behavior over LifeTime
    float easeSize = ${e}(1. - lifeLeft);
    // Scaled Over Time
    vec3 scaledPosition = position * vec3(uSize * easeSize);
  #endif

  // Billboard Behavior
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );    
  // Randomness 
  float randRef = rand(ref);
  scale *= (1.0 - (uRandScaleFactor * randRef));
  // Rotation
  float randRotation =  2.0 * PI * ( uRandRotationFactor * randRef);
  float originalRotation = (1.0 - uRotation) * 2.0 * PI;
  float originalRotationEnd = (1.0 - uRotationEnd) * 2.0 * PI;
  // OverTime
  float finalRotation = mix(originalRotation + randRotation, originalRotationEnd + randRotation, lifeLeft);

  vec2 alignedPosition = ( scaledPosition.xy - ( center - vec2( 0.5 ) ) ) * scale;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( finalRotation ) * alignedPosition.x - sin( finalRotation ) * alignedPosition.y;
  rotatedPosition.y = sin( finalRotation ) * alignedPosition.x + cos( finalRotation ) * alignedPosition.y;
  
  mat4 instanceMatrix = mat4(
    vec4(1.0, 0.0, 0.0, 0.0),
    vec4(0.0, 1.0, 0.0, 0.0),
    vec4(0.0, 0.0, 1.0, 0.0),
    vec4(pos.x, pos.y, pos.z, 1.0)
  );  

  mvPosition = modelViewMatrix * instanceMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix  * mvPosition;   
`,b8e=`
  uniform vec4 uColor;                // start color
  uniform vec4 uColor2;               // end color
  uniform sampler2D uTexture;         // texture
  varying float v_LifeLeft;   // normalized lifetime 1 to 0
  varying vec2 vUv;
  varying vec2 vRef;

  float random(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
  }
  `+doe+`  
  ${v8e}

`,w8e=({easeOpacity:e="linearFadeOut"})=>`  
  // if Particle is dead, hide it
  if (v_LifeLeft <= 0.005 ) {
    discard;
  }

  #ifdef USE_RANDOM_COLORING
    float randVal = random(vRef); // Generate a random value based on the reference
    vec4 color = mix(uColor, uColor2, randVal); // Interpolate between the two colors
  #else
    vec4 color = mix(uColor, uColor2, 1. - v_LifeLeft);
  #endif

  // Opacity over Life Time
  float finalAlpha = ${e}(1. - v_LifeLeft);  
  vec4 textureColor = texture2D(uTexture, vUv).rgba; 
  finalColor = textureColor.rgb * color.rgb;
  finalAlpha = color.a * textureColor.a * finalAlpha;
  
  gl_FragColor = vec4(finalColor, finalAlpha);     

`,_8e=class extends Jr{constructor(e,t){super(),this.needsJitter=!0,this.type="ParticleMaterial",this.easeOpacity="linearFadeIn",this.easeSize="linearFadeIn",this.useSizeEnd=!1,this.isColoringRandom=!1,this.init(e,t),this.context=t}reset(){}init(e,t){this.transparent=!0,this.depthTest=!0,this.depthWrite=!1,this.easeOpacity=e.ease,this.easeSize=e.easeSize,this.layers=[],Ss.startContext(Ss.globalContext),this.lightLayer=new Cu(0,"",{...Vs.defaultData("light","phong"),visible:!1},new VB,{},t.shared),Ss.endContext(Ss.globalContext),this.build()}updateState(e){e.coloring!==void 0&&(this.isColoringRandom=e.coloring==="random"),e.color!==void 0&&(e.color instanceof Array?this.uniforms.uColor.value=e.color:this.uniforms.uColor.value=this.context.shared.color(e.color)),e.color2!==void 0&&(e.color2 instanceof Array?this.uniforms.uColor2.value=e.color2:this.uniforms.uColor2.value=this.context.shared.color(e.color2)),e.size!==void 0&&(this.uniforms.uSize.value=e.size[0],this.uniforms.uSizeEnd.value=e.size[1],e.size[0]!==e.size[1]?this.useSizeEnd=!0:this.useSizeEnd=!1),e.ease!==void 0&&(this.easeOpacity=e.ease,this.build()),e.easeSize!==void 0&&(this.easeSize=e.easeSize,this.build()),this.needsUpdate=!0}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader}build(){let e=new cae;return e.needsJitter=this.needsJitter,e.addFragmentParsCode(Jze),e.buildShader("vertex",this.fragment),e.buildShader("fragment",this.fragment),e.addFragmentFinalCode(e6e),this.isColoringRandom&&e.define("USE_RANDOM_COLORING"),this.useSizeEnd&&e.define("USE_SIZE_END"),e.addVertexParsCode(y8e),e.addFragmentParsCode(b8e),e.addVertexFinalCode(x8e({easeSize:this.easeSize})),e.addFragmentFinalCode(w8e({easeOpacity:this.easeOpacity})),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms={...e.uniforms,...this.uniforms},this.extensions=e.extensions,this}get nodeMaterial(){return this}get fragment(){return this.lightLayer.node}getDefines(){return this.defines}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose()}},oI=class{constructor(e,t,r,i){this.type="SphereEmitterShape",this.targetMesh=void 0,this.size=e,this.type=r,this.textureSize=a8e(t);let n=1;this.targetMesh=i?.geometry.type==="BufferGeometry"||i?.type==="Mesh"&&i&&i.geometry.hasAttribute("position")&&i.geometry.hasAttribute("normal")?i:this.getMesh(r,n);let{positions:s,dataTexture:a,dataTextureNormals:o}=this.createPositions(this.textureSize,this.targetMesh??this.getMesh(r,n));this.positionsTexture=a,this.positionsAttribute=s,this.directionsTexture=o}createPositions(e,t){let{positions:r,normals:i}=o8e(t,e*e),n=JX(r,e),s=JX(i,e);return{dataTexture:n,positions:r,dataTextureNormals:s}}getMesh(e,t){let r=null;switch(e){case"SphereEmitterShape":{r=new ky(t*.5,32,32);break}case"TorusEmitterShape":{r=new Iie(t*.5,.3,15,40);break}case"ConeEmitterShape":{r=new X6(t,t,15);break}case"BoxEmitterShape":{r=new Fc(t,t,t);break}case"PlaneEmitterShape":{r=new ed(t,t),r.rotateX(-Math.PI/2);break}case"MeshEmitterShape":{r=new ky(t,32,32);break}default:{r=new ky(t,32,32);break}}return new Yi(r,new Ih({color:16711680}))}applyToShader(e,t){this.size=new V().fromArray(t.size),e.uEmitterSize.value=this.size}dispose(){this.positionsTexture.dispose(),this.directionsTexture.dispose(),this.positionsAttribute=new Float32Array}};function sy(e){let t={...e},r=PM.defaultData;t.forceFieldObjectId&&(t.colliderEntityId=t.forceFieldObjectId);let i={...r.shape,...t.shape},n={...r.renderMaterial,...t.renderMaterial};return{...r,...t,shape:i,renderMaterial:n}}var S8e=`
// uniform sampler2D uCurrentPosition; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentVelocity; // Pass in the variable from GPGPU
// uniform sampler2D uCurrentEmissionRate; // Pass in the variable from GPGPU

uniform sampler2D uIndex; // Texture with corresponding index
uniform float uLastIndexEmitted; // Last emitted index
uniform float uParticlesToEmit; // Number of particles to emit on that frame
uniform float uTime;

void main() {
    vec2 vUv = gl_FragCoord.xy / resolution.xy;
    float particleIndex = texture(uIndex, vUv).x;
    float timeLeft = texture2D( uCurrentPosition, vUv ).w;
    float isActive = texture2D( uCurrentEmissionRate, vUv ).g;    // 1. = active, 0. = not active
    float timeStart = texture2D( uCurrentEmissionRate, vUv ).b;


    // ********** Detect Colision to Create a flag and use it in position **********
    // We are doing this here, so

    // ********** Emit Particles **********
    // X = isSpawning 0.0 or 1.0
    // Y = isActive 0.0 or 1.0
    // Check if the vertex index is between the first value and the last value
    // if (particleIndex >= uLastIndexEmitted && particleIndex < uLastIndexEmitted + uParticlesToEmit) {
    //     // Emit a particle by writing 1 to the red channel of the color output
    //     // r: 1. == emit the particle
    //     // g: 1. == particle is now active
    //     timeStart = uTime;
    //     gl_FragColor = vec4(1.0, 1.0, timeStart, 1.0);
    // } else {
    //     // The Particle is either already emitted or not in the range of the particles to emit
    //     // Do not emit a particle by writing 0 to the red channel of the color output        
    //     gl_FragColor = vec4(0.0, isActive, timeStart, 1.0);
    // }
    // Determine if the particle is within the emission range
    float emitLowerBound = step(uLastIndexEmitted, particleIndex);
    float emitUpperBound = step(particleIndex, uLastIndexEmitted + uParticlesToEmit - 1.0);
    float emitParticle = emitLowerBound * emitUpperBound; // 1.0 if in range, 0.0 otherwise

    // Set timeStart and color
    timeStart = mix(timeStart, uTime, emitParticle);
    gl_FragColor = vec4(emitParticle, mix(isActive, 1.0, emitParticle), timeStart, 1.0);


}
`,lI=10,E8e=class extends Ei{constructor(e,t){super(),this.type="ParticleEmitter",this.debugMode=!1,this.worldSpace=!0,this.rootObject=null,this.gpuCompute=null,this.positionSimRT=null,this.velocitySimRT=null,this.emissionRateSimRT=null,this.emitterShape=void 0,this.isEmitting=!1,this.hasBeenReset=!1,this.emittedParticlesAmount=0,this.lastEmitTime=0,this.globalTime=0,this.targetFPS=60,this.previousRatio=1,this.lerpFactor=.4,this.particlesAmount=0,this.noiseStrength=0,this.noiseScale=0,this.isBillboardBased=!0,this.simFeaturesDefinition={USE_COLLIDER:!1,USE_ATTRACTOR:!1,USE_VORTEX:!1,USE_SPHERE_COLLIDER:!1,USE_BOX_COLLIDER:!1,USE_FORCE_LOCAL_SPACE:!1,USE_NORMALS:!1,USE_CURL_NOISE:!0,USE_SIMPLEX_NOISE:!1,USE_FBM_NOISE:!1},this.textureLoader=new zTe,this.currentWorldPosition=new V,this.systemQuaternion=new ar,this.worldGravity=new V(0,0,0),this.directionAxis=new V(0,0,0),this.colliderV3=new V(0,0,0),this.colliderQuaternion=new ar(0,0,0,1),this.matrixAutoUpdate=!0,this.renderer=e,this.system=t,this.shared=t.context.shared;let r=t.data;this.material=new _8e(r.renderMaterial,t.context),this.material.uniforms={uSize:{value:0},uSizeEnd:{value:0},uColor:{value:r.renderMaterial.color},uColor2:{value:r.renderMaterial.color2},uPosition:{value:new V(0,0,0)},uEmissionData:{value:new V(0,0,0)},uTexture:{value:this.defaultTexture},uWorldOffset:{value:new V(0,0,0)},uWorldQuaternion:{value:new fr(0,0,0,1)},uRandScaleFactor:{value:r.randomScale??0},uRandRotationFactor:{value:r.randomRotation??0},uRotation:{value:r.renderMaterial.spriteRotation[0]??0},uRotationEnd:{value:r.renderMaterial.spriteRotation[1]??0}},this.setTexture(this.material.uniforms,r.renderMaterial.texture),this.init(r)}setTexture(e,t){let r=t.data;if(typeof t=="string"){let i=this.shared.image(t),n=new yn(i.img);n.needsUpdate=!0,e.uTexture.value=n;return}if(typeof r!="string"){let i=new Image;i.onload=()=>{let a=new yn(i);a.needsUpdate=!0,e.uTexture.value=a};let n=new Blob([r],{type:"image/*"}),s=URL.createObjectURL(n);i.src=s}}updateGeometryAttributes(e,t){let r=s8e(t);!this.emitterShape?.positionsAttribute||e.geometry.setAttribute("ref",new P2(r,2))}applyWorldSpace(){if(!this.system.started||!this.worldSpace||!this.positionSimRT||!this.velocitySimRT)return;let e=this.system;e.getWorldQuaternion(this.systemQuaternion),this.systemQuaternion.invert(),e.getWorldPosition(this.currentWorldPosition),this.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.positionSimRT.material.uniforms.uWorldOffset.value=this.currentWorldPosition,this.systemQuaternion.invert(),this.positionSimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize()),this.velocitySimRT.material.uniforms.uWorldQuaternion.value.copy(this.systemQuaternion.normalize())}update(e,t){if(!this.gpuCompute||!this.positionSimRT||!this.velocitySimRT||!this.emissionRateSimRT||this.hasBeenReset)return;if(this.checkIfAllParticlesAreDead()&&!this.hasBeenReset){this.reset();return}this.applyWorldSpace(),this.globalTime=e,this.positionSimRT.material.uniforms.uTime.value=e,this.emissionRateSimRT.material.uniforms.uTime.value=e;let r=1e3/t,i=this.targetFPS/r,n=this.previousRatio+(i-this.previousRatio)*this.lerpFactor;this.positionSimRT.material.uniforms.uFPSRatio.value=n,this.previousRatio=n;let s=this.isEmitting?this.GoEmitSomeParticles(e,this.system.data.birthRatePerSec):0;this.emissionRateSimRT.material.uniforms.uLastIndexEmitted.value=this.emittedParticlesAmount,this.emissionRateSimRT.material.uniforms.uParticlesToEmit.value=s,this.material.uniforms.uPosition.value=this.gpuCompute.getCurrentRenderTarget(this.positionSimRT)?.texture,this.system.colliderEntities.length>0&&this.renderColliders(),this.gpuCompute.compute()}renderColliders(){if(!this.velocitySimRT)return;let e=this.system.colliderEntities[0],t=this.simFeaturesDefinition.USE_COLLIDER||this.simFeaturesDefinition.USE_ATTRACTOR||this.simFeaturesDefinition.USE_VORTEX;if(e.destroyedInAction&&t&&this.init(sy({...this.system.data,colliderEntityId:null})),!e||e.destroyedInAction)return;e.getWorldPosition(this.colliderV3),this.colliderV3.y===0&&(this.colliderV3.y=1e-4),this.velocitySimRT.material.uniforms.uColliderPos.value.copy(this.colliderV3);let r=e.data.size;this.colliderV3.fromArray(r),this.velocitySimRT.material.uniforms.uColliderSize.value.copy(this.simFeaturesDefinition.USE_SPHERE_COLLIDER?this.colliderV3.multiplyScalar(.5):this.colliderV3),e.getWorldQuaternion(this.colliderQuaternion),this.velocitySimRT.material.uniforms.uColliderQuaternion.value.copy(this.colliderQuaternion.normalize()),this.velocitySimRT.material.uniforms.uColliderQuaternionInvert.value.copy(this.colliderQuaternion.normalize().invert())}updateState(e){!this.velocitySimRT||!this.positionSimRT||(e.renderMaterial&&this.updateMaterialState(e.renderMaterial),this.updateParticleState(e))}updateVariableState(e,t){if(!this.velocitySimRT||!this.positionSimRT)return;t[2]==="size"&&this.material.updateState({size:[e,this.material.uniforms.uSizeEnd.value]}),t[2]==="sizeEnd"&&this.material.updateState({size:[this.material.uniforms.uSize.value,e]});let r=(i,n)=>{let s=[...this.system.data.shape.size];s[i]=n,this.updateParticleState({shape:{...this.system.data.shape,size:s}})};t[2]==="shape_size_0"&&r(0,e),t[2]==="shape_size_1"&&r(1,e),t[2]==="shape_size_2"&&r(2,e),t[2]==="speed"&&(this.velocitySimRT.material.uniforms.uSpeed.value=e/lI),t[2]==="gravity"&&this.worldGravity.set(0,e/100,0),t[2]==="noiseStrength"&&(this.noiseStrength=e,this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),t[2]==="noiseScale"&&(this.noiseScale=e,this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),t[2]==="direction_x"&&(this.directionAxis=this.getDirectionAxis([Number(e),this.system.data.direction[1],this.system.data.direction[2]])),t[2]==="direction_y"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],Number(e),this.system.data.direction[2]])),t[2]==="direction_z"&&(this.directionAxis=this.getDirectionAxis([this.system.data.direction[0],this.system.data.direction[1],Number(e)]))}updateMaterialState(e){this.material.updateState({...e,size:e.size?[Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","size"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","sizeEnd"]))]:[0,0]}),e.texture&&(this.setTexture(this.material.uniforms,e.texture),this.material.needsUpdate=!0)}updateParticleState(e){if(!(!this.positionSimRT||!this.velocitySimRT)){if(this.shouldReInitGPUCompute(e)&&this.init(sy(this.system.data)),e.life!==void 0&&(this.positionSimRT.material.uniforms.uMaxLifeTime.value=e.life),e.speed!==void 0&&(this.velocitySimRT.material.uniforms.uSpeed.value=Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/lI),e.collisionBounce!==void 0&&(this.velocitySimRT.material.uniforms.uBounce.value=e.collisionBounce),e.noiseStrength!==void 0&&(this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.velocitySimRT.material.uniforms.uNoiseStrength.value=this.noiseStrength),e.noiseScale!==void 0&&(this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"])),this.velocitySimRT.material.uniforms.uNoiseScale.value=this.noiseScale),e.noiseSeed!==void 0&&(this.velocitySimRT.material.uniforms.uNoiseSeed.value=e.noiseSeed),e.randomMass!==void 0&&(this.velocitySimRT.material.uniforms.uRandomMassFactor.value=e.randomMass),e.renderMaterial?.size!==void 0){let t=this.shared.getVariable(e.renderMaterial.size[0],[this.uuid,"particles","size"]);this.velocitySimRT.material.uniforms.particleSize.value=Number(t)}if(e.renderMaterial?.spriteRotation!==void 0&&(this.material.uniforms.uRotation.value=e.renderMaterial.spriteRotation[0],this.material.uniforms.uRotationEnd.value=e.renderMaterial.spriteRotation[1]),e.shape!==void 0){let t=e.shape.size??this.system.data.shape.size,r=[Number(this.shared.getVariable(t[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(t[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(t[2],[this.uuid,"particles","shape_size_2"]))],i={...sy(this.system.data).shape,size:r};this.emitterShape?.applyToShader(this.positionSimRT.material.uniforms,i)}if(e.gravity!==void 0&&(this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.velocitySimRT.material.uniforms.uGravity={value:this.worldGravity}),e.direction!==void 0){let t=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(t),this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis}e.randomRotation!==void 0&&(this.material.uniforms.uRandRotationFactor.value=e.randomRotation),e.randomScale!==void 0&&(this.material.uniforms.uRandScaleFactor.value=e.randomScale)}}updateForceFieldParameters(e){!this.velocitySimRT||(e.forceIntensity!==void 0&&(this.velocitySimRT.material.uniforms.uForceIntensity.value=e.forceIntensity),e.forceDambing!==void 0&&(this.velocitySimRT.material.uniforms.uForceDamping.value=e.forceDambing))}getDirectionAxis(e){let t=[Number(e[0])*Ct.DEG2RAD,Number(e[1])*Ct.DEG2RAD,Number(e[2])*Ct.DEG2RAD],r=new Es(t[0],t[1],t[2],"XYZ");return this.directionAxis.set(0,1,0).applyEuler(r).normalize(),this.velocitySimRT&&(this.velocitySimRT.material.uniforms.uDirectionsAxis.value=this.directionAxis),this.directionAxis}shouldReInitGPUCompute(e){let{birthRatePerSec:t,rootObjectType:r,colliderEntityId:i,shape:n,emitTimeDuration:s,emitTimeCycle:a,life:o,directionMode:l,noiseType:c}=e;return t!==void 0||r!==void 0||i||i===null||a!==void 0||n!==void 0||o!==void 0||s!==void 0||l!==void 0||c!==void 0}init(e){this.dispose(),this.particlesAmount=this.getMaxParticlesAmount({birthRatePerSecond:e.birthRatePerSec,particleMaxLifeTime:e.life,loopDuration:e.emitTimeCycle==="infinity"?0:e.emitTimeDuration}),this.particlesAmount>1e5&&(console.warn("The maximum number of particles is limited to 100000."),this.particlesAmount=1e5),this.emitterShape=this.createShape(e.shape,this.particlesAmount);let t=setInterval(()=>{if(this.emitterShape)if(isNaN(this.emitterShape.positionsTexture.source.data.data[0])){this.init(e);return}else clearInterval(t)},100);if(!this.emitterShape)return;let r=new i8e(this.emitterShape.textureSize,this.emitterShape.textureSize,this.renderer),i=this.updateSimulationDefinition(e),n=r.addVariable("uCurrentPosition",i+u8e,this.emitterShape.positionsTexture),s=r.addVariable("uCurrentVelocity",i+m8e,this.emitterShape.directionsTexture),a=r.addVariable("uCurrentEmissionRate",S8e,c8e(this.emitterShape.textureSize));r.setVariableDependencies(n,[n,s,a]),r.setVariableDependencies(s,[n,s,a]),r.setVariableDependencies(a,[n,s,a]);let o=l8e({size:this.emitterShape.textureSize}),l={uOriginalPosition:{value:this.emitterShape.positionsTexture},uWorldOffset:{value:new V(0,0,0)},uWorldQuaternion:{value:new fr(0,0,0,1)},uTime:{value:0},uFPSRatio:{value:1},uMaxLifeTime:{value:e.life},uEmitterSize:{value:new V(Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"])))},particleSize:{value:0}};n.material.uniforms=l;let c=this.getDirectionFromVariable(e.direction);this.directionAxis=this.getDirectionAxis(c),this.worldGravity.set(0,Number(this.shared.getVariable(this.system.data.gravity,[this.uuid,"particles","gravity"]))/100,0),this.noiseStrength=Number(this.shared.getVariable(e.noiseStrength,[this.uuid,"particles","noiseStrength"])),this.noiseScale=Number(this.shared.getVariable(e.noiseScale,[this.uuid,"particles","noiseScale"]));let u=e.colliderEntityId&&this.system.getColliderData(e.colliderEntityId),d={uOriginalPosition:{value:this.emitterShape.positionsTexture},uDirections:{value:this.emitterShape.directionsTexture},uDirectionsAxis:{value:this.directionAxis},uWorldQuaternion:{value:new fr(0,0,0,1)},uColliderPos:{value:new V(0,0,0)},uColliderSize:{value:new V(0,0,0)},uForceIntensity:{value:u?u.forceIntensity:0},uForceDamping:{value:u?u.forceDambing:0},uColliderQuaternion:{value:new fr(0,0,0,1)},uColliderQuaternionInvert:{value:new fr(0,0,0,1)},particleSize:{value:0},uGravity:{value:this.worldGravity},uNoiseStrength:{value:this.noiseStrength},uNoiseScale:{value:this.noiseScale},uNoiseSeed:{value:e.noiseSeed},uRandomMassFactor:{value:e.randomMass},uBounce:{value:e.collisionBounce},uSpeed:{value:Number(this.shared.getVariable(e.speed,[this.uuid,"particles","speed"]))/lI}};s.material.uniforms=d;let f={uIndex:{value:o},uTime:{value:0},uLastIndexEmitted:{value:0},uParticlesToEmit:{value:0}};a.material.uniforms=f;let m=[Number(this.shared.getVariable(e.shape.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.shape.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.shape.size[2],[this.uuid,"particles","shape_size_2"]))],v={...sy(this.system.data).shape,size:m};this.emitterShape.applyToShader(n.material.uniforms,v),r.init(),this.gpuCompute=r,this.positionSimRT=n,this.velocitySimRT=s,this.emissionRateSimRT=a,this.rootObject=this.createPrimaryEmitter(this.emitterShape.textureSize),this.add(this.rootObject),this.material.needsUpdate=!0}getDirectionFromVariable(e){let t=Number(this.shared.getVariable(e[0],[this.uuid,"particles","direction_x"])),r=Number(this.shared.getVariable(e[1],[this.uuid,"particles","direction_y"])),i=Number(this.shared.getVariable(e[2],[this.uuid,"particles","direction_z"]));return[t,r,i]}updateSimulationDefinition(e){if(this.simFeaturesDefinition.USE_COLLIDER=!1,this.simFeaturesDefinition.USE_ATTRACTOR=!1,this.simFeaturesDefinition.USE_VORTEX=!1,this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!1,this.simFeaturesDefinition.USE_BOX_COLLIDER=!1,this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!1,this.simFeaturesDefinition.USE_NORMALS=!1,this.simFeaturesDefinition.USE_CURL_NOISE=!1,this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!1,this.simFeaturesDefinition.USE_FBM_NOISE=!1,e.colliderEntityId&&this.system.colliderEntities.length>0){let r=this.system.getColliderData(e.colliderEntityId);switch(r?.forceType){case"attractor":this.simFeaturesDefinition.USE_ATTRACTOR=!0;break;case"collider":this.simFeaturesDefinition.USE_COLLIDER=!0;break;case"vortex":this.simFeaturesDefinition.USE_VORTEX=!0;break}let i=r?.colliderType;i==="sphere"&&(this.simFeaturesDefinition.USE_SPHERE_COLLIDER=!0),i==="box"&&(this.simFeaturesDefinition.USE_BOX_COLLIDER=!0),r?.forceRange==="helper"&&(this.simFeaturesDefinition.USE_FORCE_LOCAL_SPACE=!0)}e.directionMode==="normals"&&(this.simFeaturesDefinition.USE_NORMALS=!0),e.noiseType==="curl"&&(this.simFeaturesDefinition.USE_CURL_NOISE=!0),e.noiseType==="simplex"&&(this.simFeaturesDefinition.USE_SIMPLEX_NOISE=!0),e.noiseType==="fbm"&&(this.simFeaturesDefinition.USE_FBM_NOISE=!0);let t="";for(let[r,i]of Object.entries(this.simFeaturesDefinition))i&&(t+=`#define ${r}
`);return t}createShape(e,t){this.emitterShape&&this.emitterShape.dispose();let r=new V(Number(this.shared.getVariable(e.size[0],[this.uuid,"particles","shape_size_0"])),Number(this.shared.getVariable(e.size[1],[this.uuid,"particles","shape_size_1"])),Number(this.shared.getVariable(e.size[2],[this.uuid,"particles","shape_size_2"])));if(e.type==="MeshEmitterShape"){let i=null;return this.system.context.scene.traverseEntity(n=>{n.uuid===e.fromMeshId&&(i=n)}),i?new oI(r,t,e.type,i):new oI(r,t,"SphereEmitterShape")}else return new oI(r,t,e.type)}createPrimaryEmitter(e){let t,r=e*e;return t=new QCe(new ed(1,1,1),this.material,r),this.updateGeometryAttributes(t,e),this.material.needsUpdate=!0,t.onBeforeRender=()=>{this.applyWorldSpace()},t}getMaxParticlesAmount({birthRatePerSecond:e,particleMaxLifeTime:t,loopDuration:r=0}){return Math.ceil(e*(t+r))}dispose(){!this.gpuCompute||(this.rootObject?.parent?.remove(this.rootObject),this.gpuCompute.dispose(),this.material.nodeMaterialDispose(),this.emitterShape?.dispose())}GoEmitSomeParticles(e,t){let r=e-this.lastEmitTime,i=1/t;if(r>=i){let n=Math.max(1,Math.floor(r/i));return this.lastEmitTime=e,this.emittedParticlesAmount+n>this.particlesAmount&&(this.emittedParticlesAmount=0),this.emittedParticlesAmount+=n,n}return 0}checkIfAllParticlesAreDead(){return this.lastEmitTime+this.system.data.life+1<this.globalTime}reset(){this.hasBeenReset=!0,this.lastEmitTime=0,this.emittedParticlesAmount=0,this.gpuCompute&&this.init(sy(this.system.data))}startEmitting(e){this.isEmitting=!0,this.hasBeenReset=!1,this.lastEmitTime=e}stopEmitting(){this.isEmitting=!1}},Zw=class extends uo{constructor(e,t,r){super(e,t),this.type="ParticleSystem",this.geometry=new Lt,this.actualTime=0,this.currentLoopTime=0,this.started=!1,this.stopped=!1,this.timeoutId=void 0,this.isFrozen=!1,this.isIdle=!0,this.emitter=null,this.colliderEntities=[],this.renderer=null,this.isPreWarm=!1,this._hasOnAfterRenderBeenCalled=!1,this.onAfterRender=i=>{this._hasOnAfterRenderBeenCalled||(this._hasOnAfterRenderBeenCalled=!0,this.init(i))},this.context=r,this.data={...t,...sy(t)},this.geometry.setAttribute("position",new At([],3)),this.material=new Ih({colorWrite:!1}),this.frustumCulled=!1}init(e){this.renderer=e,this.emitter=new E8e(e,this),this.add(this.emitter),this.updateParticleState(this.data)}update(e){if(!this.isReady||!this.started||this.isFrozen||this.isIdle)return;this.actualTime+=e,this.stopped||(this.currentLoopTime+=e);let t=this.data.emitTimeCycle==="one_time";if((this.data.emitTimeCycle==="loop"||t)&&this.currentLoopTime>this.data.emitTimeDuration*1e3&&(this.stopped||(this.stop(),t||this.start(this.data.emitTimeDelay*1e3))),this.emitter&&this.started){let r=this.actualTime/1e3;this.emitter.update(r,e)}this.scale.set(1,1,1),this.updateMatrix()}isReady(){return!!this.emitter}hasCollider(e){return this.colliderEntities.some(t=>t.identity===e)}getColliderData(e){let t=this.colliderEntities.find(r=>r.identity===e);return t?t.data:null}updateByPatchedOp(e,t,r){super.updateByPatchedOp(e,t,r),Vi(e.path,["renderMaterial"])&&this.updateParticleState({renderMaterial:{...this.data.renderMaterial,...Ws.drop(e,1).props}}),Vi(e.path,["shape"])&&this.updateParticleState({shape:{...this.data.shape,...Ws.drop(e,1).props}})}updateState(e,t){super.updateState(e,t),this.updateParticleState(e)}updateParticleState(e){if(this.emitter){if(e.colliderEntityId!==void 0&&e.colliderEntityId!==null){let t=this.context.scene.find(e.colliderEntityId);this.colliderEntities=t?[t]:[]}e.colliderEntityId===null&&(this.colliderEntities=[]),this.emitter.updateState(e),e.emitTimeCycle&&this.started&&this.start()}}updateFromColliderEntity(e){!this.emitter||(this.emitter.updateForceFieldParameters(e),this.stop(),this.start())}start(e=0){if(this.currentLoopTime=0,e){this.timeoutId=window.setTimeout(()=>{this.start(0)},e);return}this.started=!0,this.stopped=!1,this.isFrozen=!1,this.emitter?.startEmitting(this.actualTime/1e3)}froze(){this.isFrozen=!0}unFroze(){this.isFrozen=!1}stop(){this.stopped=!0,this.currentLoopTime=0,this.emitter?.stopEmitting(),clearTimeout(this.timeoutId)}reset(){this.started=!1,this.stopped=!1,this.emitter?.reset()}wakeUp(){this.isIdle=!1}sleep(){this.isIdle=!0,this.reset()}};function A8e(){try{let e=window.location.href;if(e.includes("reducesubdiv=")){let t=e.indexOf("reducesubdiv=")+13;return parseInt(e.slice(t,t+1))}}catch{}}var cI=A8e();function C8e(e,t,r){cI!==void 0&&(t?.geometry?.subdivisions??0)>cI&&(console.log("reducing subdivisions",t.name,t.geometry.subdivisions),t.geometry.subdivisions=cI);let i;return t.geometry.type==="TextGeometry"?new YB(e,t,r):t.geometry.type==="InputGeometry"?new tF(e,t,r):(t.geometry.type==="SubdivGeometry"?i=new X2(e,t,r):t.geometry.type==="PathGeometry"?i=new eF(e,t,r):t.geometry.type==="VectorGeometry"?i=new t8e(e,t,r):t.geometry.type==="BooleanGeometry"?i=new $g(e,t,r):t.geometry.type==="ShapeBlendGeometry"?i=new Kg(e,t,r):t.geometry.type==="UIGeometry"?i=new ja(e,t,r):i=new os(e,t,r),i)}function iF(e,t,r){return console.assert(t.type!==void 0),t.type==="Mesh"?C8e(e,t,r):t.type==="Empty"?new Vy(e,t):t.type==="Particle"?new Zw(e,t,r):t.type==="ParticleCollider"?new Qw(e,t,r):t.type==="Splat"?new Vy(e,t):t.type==="Bone"?new r8e(e,t):t.type==="Page"?new Hs(e,t,r):t.type==="PointLight"?new e8e(e,t,r):t.type==="SpotLight"?new eoe(e,t,r):t.type==="DirectionalLight"?new Jae(e,t,r):t.type==="Component"||t.type==="Instance"?new Uy(e,t,r):qg.is(t.type)?new Ba(e,t):(console.error(t),new Vy(e,t))}fp.createEntity=iF;function T8e(e,t,r){let i=iF(e.identity,t,r),n=e.children,s=e.attachedPaths,a=e.parent,o=e.component,l=e.instances,c=e.overrideData,u=e.uuid,d=e.stateSelection;e.dispose();for(let f of Object.keys(e))delete e[f];Object.setPrototypeOf(e,Object.getPrototypeOf(i));for(let f of Object.keys(i))e[f]=i[f];e.children=[...e.children,...n],e.attachedPaths=s,e.parent=a,e.component=o,e.instances=l,e.uuid=u,e.overrideData=c,e.updateState(e.data,r),d&&e.changeSelectedState(d,r),e.resetBBoxNeedsUpdate()}fp.changeEntityProptotype=T8e;fp.Cloner=Ul;function M8e(e,t,r,i){e.updateByOp(t,r,i,!1)}var lg=5,Jw=new Lt;Jw.setAttribute("position",new Jt(new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),3));var fT=class extends MTe{constructor(e){super({...e,depthTest:!1,depthWrite:!1,glslVersion:Dj,vertexShader:`
				precision highp float;
				in vec3 position;
				void main() {
					gl_Position = vec4(position, 1);
				}
			`})}customProgramCacheKey(){return""}};function P8e(){return{shapeInput:()=>`
			const float posRowCoord = ${.5/lg};  // vec4: px py pz opType
			const float quatRowCoord = ${1.5/lg};  // vec4: qx qy qz qw
			const float param1RowCoord = ${2.5/lg};// vec4: type param1 param2 param3
			const float param2RowCoord = ${3.5/lg};// vec4: blendRange roundness scale param4
			const float colorRowCoord = ${4.5/lg}; // vec4: r g b a
			uniform sampler2D shapesDataTexture;
			vec4 shapePos(float iin) { 
				vec4 r = texture(shapesDataTexture, vec2(iin, posRowCoord));
				return r;
			}
			vec4 shapeQuat(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, quatRowCoord));
				return r;
			}
			vec4 shapeParams1(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, param1RowCoord));
				return r;
			}
			vec4 shapeParams2(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, param2RowCoord));
				return r;
			}
			vec4 shapeColor(float iin) {
				vec4 r = texture(shapesDataTexture, vec2(iin, colorRowCoord));
				return r;
			}
		`,getxyzi:`
			// this code must complement lookup
			float xi = mod(gl_FragCoord.x - 0.5, VOXEL_RESOLUTION);
			float yi = mod(gl_FragCoord.y - 0.5, VOXEL_RESOLUTION);
			float zi = floor((gl_FragCoord.x - 0.5) * INV_VOXEL_RESOLUTION) + floor((gl_FragCoord.y - 0.5) * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;
		`,lookup:`
			uniform sampler2D potentialPassTexture;
			uniform sampler2D voxelPassTexture; // includes normal (in xyz) and key (in w)
			
			// box or marching cube lookup value in value texture, integer box coord inputs
			// this code must complement codebits.getxyzi
			vec4 look(float xi, float yi, float zi, sampler2D rt) {// range 0 .. numv etc
				vec2 uv = vec2(
					mod(zi, Z_LAYERS_PER_ROW) + (xi + 0.5) / VOXEL_RESOLUTION,
					floor(zi / Z_LAYERS_PER_ROW) + (yi + 0.5) / VOXEL_RESOLUTION
				); 
				uv /= Z_LAYERS_PER_ROW;
				return texture(rt, uv);
			}
		`,getpart:`
			float getpart(inout float a, float b) {
				float t = floor(a/b);
				float r = a - t*b;
				a = t;
				return r;
			}
		`,triTable:new Float32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,1,8,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,10,2,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,9,9,2,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,2,8,10,2,8,9,10,-1,-1,-1,-1,-1,-1,-1,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,0,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,1,11,9,1,11,8,9,-1,-1,-1,-1,-1,-1,-1,1,10,3,3,10,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,10,0,10,8,0,10,11,8,-1,-1,-1,-1,-1,-1,-1,0,9,3,9,11,3,9,10,11,-1,-1,-1,-1,-1,-1,-1,10,8,9,11,8,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,4,3,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,4,1,7,4,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,2,1,7,4,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,3,4,0,3,10,2,1,-1,-1,-1,-1,-1,-1,-1,10,2,9,2,0,9,7,4,8,-1,-1,-1,-1,-1,-1,-1,9,10,2,7,9,2,3,7,2,4,9,7,-1,-1,-1,-1,7,4,8,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,4,11,4,2,11,4,0,2,-1,-1,-1,-1,-1,-1,-1,1,0,9,7,4,8,11,3,2,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,9,2,11,9,1,2,9,-1,-1,-1,-1,1,10,3,10,11,3,4,8,7,-1,-1,-1,-1,-1,-1,-1,10,11,1,11,4,1,4,0,1,4,11,7,-1,-1,-1,-1,8,7,4,11,0,9,10,11,9,3,0,11,-1,-1,-1,-1,11,7,4,9,11,4,10,11,9,-1,-1,-1,-1,-1,-1,-1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,9,3,8,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,0,0,5,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,8,5,3,8,5,1,3,-1,-1,-1,-1,-1,-1,-1,10,2,1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,10,2,1,5,9,4,-1,-1,-1,-1,-1,-1,-1,10,2,5,2,4,5,2,0,4,-1,-1,-1,-1,-1,-1,-1,5,10,2,5,2,3,4,5,3,8,4,3,-1,-1,-1,-1,4,5,9,11,3,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,11,0,11,8,0,5,9,4,-1,-1,-1,-1,-1,-1,-1,4,5,0,5,1,0,11,3,2,-1,-1,-1,-1,-1,-1,-1,5,1,2,8,5,2,11,8,2,5,8,4,-1,-1,-1,-1,11,3,10,3,1,10,4,5,9,-1,-1,-1,-1,-1,-1,-1,5,9,4,1,8,0,1,10,8,10,11,8,-1,-1,-1,-1,0,4,5,11,0,5,10,11,5,3,0,11,-1,-1,-1,-1,8,4,5,10,8,5,11,8,10,-1,-1,-1,-1,-1,-1,-1,8,7,9,9,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,9,3,5,9,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,7,0,7,1,0,7,5,1,-1,-1,-1,-1,-1,-1,-1,3,5,1,7,5,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,7,9,7,5,9,2,1,10,-1,-1,-1,-1,-1,-1,-1,2,1,10,0,5,9,0,3,5,3,7,5,-1,-1,-1,-1,2,0,8,5,2,8,7,5,8,2,5,10,-1,-1,-1,-1,5,10,2,3,5,2,7,5,3,-1,-1,-1,-1,-1,-1,-1,5,9,7,9,8,7,2,11,3,-1,-1,-1,-1,-1,-1,-1,7,5,9,2,7,9,0,2,9,11,7,2,-1,-1,-1,-1,11,3,2,8,1,0,8,7,1,7,5,1,-1,-1,-1,-1,1,2,11,7,1,11,5,1,7,-1,-1,-1,-1,-1,-1,-1,8,5,9,7,5,8,3,1,10,11,3,10,-1,-1,-1,-1,0,7,5,9,0,5,0,11,7,10,0,1,0,10,11,-1,0,10,11,3,0,11,0,5,10,7,0,8,0,7,5,-1,5,10,11,5,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,9,6,10,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,1,8,9,1,6,10,5,-1,-1,-1,-1,-1,-1,-1,5,6,1,1,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,6,1,6,2,1,8,0,3,-1,-1,-1,-1,-1,-1,-1,5,6,9,6,0,9,6,2,0,-1,-1,-1,-1,-1,-1,-1,8,9,5,2,8,5,6,2,5,8,2,3,-1,-1,-1,-1,11,3,2,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,11,0,2,11,5,6,10,-1,-1,-1,-1,-1,-1,-1,9,1,0,11,3,2,6,10,5,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,9,1,2,11,9,11,8,9,-1,-1,-1,-1,11,3,6,3,5,6,3,1,5,-1,-1,-1,-1,-1,-1,-1,11,8,0,5,11,0,1,5,0,6,11,5,-1,-1,-1,-1,6,11,3,6,3,0,5,6,0,9,5,0,-1,-1,-1,-1,9,5,6,11,9,6,8,9,11,-1,-1,-1,-1,-1,-1,-1,6,10,5,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,4,3,7,4,10,5,6,-1,-1,-1,-1,-1,-1,-1,0,9,1,6,10,5,7,4,8,-1,-1,-1,-1,-1,-1,-1,5,6,10,7,9,1,3,7,1,4,9,7,-1,-1,-1,-1,2,1,6,1,5,6,8,7,4,-1,-1,-1,-1,-1,-1,-1,5,2,1,6,2,5,4,0,3,7,4,3,-1,-1,-1,-1,7,4,8,5,0,9,5,6,0,6,2,0,-1,-1,-1,-1,9,3,7,4,9,7,9,2,3,6,9,5,9,6,2,-1,2,11,3,4,8,7,5,6,10,-1,-1,-1,-1,-1,-1,-1,6,10,5,2,7,4,0,2,4,11,7,2,-1,-1,-1,-1,9,1,0,8,7,4,11,3,2,6,10,5,-1,-1,-1,-1,1,2,9,2,11,9,11,4,9,4,11,7,6,10,5,-1,7,4,8,5,11,3,1,5,3,6,11,5,-1,-1,-1,-1,11,1,5,6,11,5,11,0,1,4,11,7,11,4,0,-1,9,5,0,5,6,0,6,3,0,3,6,11,7,4,8,-1,9,5,6,11,9,6,9,7,4,9,11,7,-1,-1,-1,-1,9,4,10,10,4,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,4,10,9,4,3,8,0,-1,-1,-1,-1,-1,-1,-1,1,0,10,0,6,10,0,4,6,-1,-1,-1,-1,-1,-1,-1,1,3,8,6,1,8,4,6,8,10,1,6,-1,-1,-1,-1,9,4,1,4,2,1,4,6,2,-1,-1,-1,-1,-1,-1,-1,8,0,3,9,2,1,9,4,2,4,6,2,-1,-1,-1,-1,4,2,0,6,2,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,4,2,8,6,2,4,-1,-1,-1,-1,-1,-1,-1,9,4,10,4,6,10,3,2,11,-1,-1,-1,-1,-1,-1,-1,2,8,0,11,8,2,10,9,4,6,10,4,-1,-1,-1,-1,2,11,3,6,1,0,4,6,0,10,1,6,-1,-1,-1,-1,1,4,6,10,1,6,1,8,4,11,1,2,1,11,8,-1,4,6,9,6,3,9,3,1,9,3,6,11,-1,-1,-1,-1,1,11,8,0,1,8,1,6,11,4,1,9,1,4,6,-1,6,11,3,0,6,3,4,6,0,-1,-1,-1,-1,-1,-1,-1,8,4,6,8,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,10,7,10,8,7,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,7,0,7,10,0,10,9,0,10,7,6,-1,-1,-1,-1,7,6,10,7,10,1,8,7,1,0,8,1,-1,-1,-1,-1,7,6,10,1,7,10,3,7,1,-1,-1,-1,-1,-1,-1,-1,6,2,1,8,6,1,9,8,1,7,6,8,-1,-1,-1,-1,9,6,2,1,9,2,9,7,6,3,9,0,9,3,7,-1,0,8,7,6,0,7,2,0,6,-1,-1,-1,-1,-1,-1,-1,2,3,7,2,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,3,2,8,6,10,9,8,10,7,6,8,-1,-1,-1,-1,7,0,2,11,7,2,7,9,0,10,7,6,7,10,9,-1,0,8,1,8,7,1,7,10,1,10,7,6,11,3,2,-1,1,2,11,7,1,11,1,6,10,1,7,6,-1,-1,-1,-1,6,9,8,7,6,8,6,1,9,3,6,11,6,3,1,-1,1,9,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,6,0,7,0,11,3,0,6,11,-1,-1,-1,-1,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,3,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,0,6,7,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,1,8,1,3,8,6,7,11,-1,-1,-1,-1,-1,-1,-1,2,1,10,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,2,1,8,0,3,7,11,6,-1,-1,-1,-1,-1,-1,-1,0,9,2,9,10,2,7,11,6,-1,-1,-1,-1,-1,-1,-1,7,11,6,3,10,2,3,8,10,8,9,10,-1,-1,-1,-1,3,2,7,7,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,0,7,0,6,7,0,2,6,-1,-1,-1,-1,-1,-1,-1,6,7,2,7,3,2,9,1,0,-1,-1,-1,-1,-1,-1,-1,2,6,1,6,8,1,8,9,1,6,7,8,-1,-1,-1,-1,6,7,10,7,1,10,7,3,1,-1,-1,-1,-1,-1,-1,-1,6,7,10,10,7,1,7,8,1,8,0,1,-1,-1,-1,-1,7,3,0,10,7,0,9,10,0,7,10,6,-1,-1,-1,-1,10,6,7,8,10,7,9,10,8,-1,-1,-1,-1,-1,-1,-1,4,8,6,6,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,6,3,6,0,3,6,4,0,-1,-1,-1,-1,-1,-1,-1,11,6,8,6,4,8,1,0,9,-1,-1,-1,-1,-1,-1,-1,6,4,9,3,6,9,1,3,9,6,3,11,-1,-1,-1,-1,4,8,6,8,11,6,1,10,2,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,0,3,11,6,0,6,4,0,-1,-1,-1,-1,8,11,4,11,6,4,9,2,0,9,10,2,-1,-1,-1,-1,3,9,10,2,3,10,3,4,9,6,3,11,3,6,4,-1,3,2,8,2,4,8,2,6,4,-1,-1,-1,-1,-1,-1,-1,2,4,0,2,6,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,4,3,2,6,4,2,8,3,4,-1,-1,-1,-1,4,9,1,2,4,1,6,4,2,-1,-1,-1,-1,-1,-1,-1,3,1,8,1,6,8,6,4,8,1,10,6,-1,-1,-1,-1,0,1,10,6,0,10,4,0,6,-1,-1,-1,-1,-1,-1,-1,3,6,4,8,3,4,3,10,6,9,3,0,3,9,10,-1,4,9,10,4,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,9,4,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,8,0,5,9,4,6,7,11,-1,-1,-1,-1,-1,-1,-1,1,0,5,0,4,5,11,6,7,-1,-1,-1,-1,-1,-1,-1,6,7,11,4,3,8,4,5,3,5,1,3,-1,-1,-1,-1,4,5,9,2,1,10,11,6,7,-1,-1,-1,-1,-1,-1,-1,7,11,6,10,2,1,3,8,0,5,9,4,-1,-1,-1,-1,11,6,7,10,4,5,10,2,4,2,0,4,-1,-1,-1,-1,8,4,3,4,5,3,5,2,3,2,5,10,6,7,11,-1,3,2,7,2,6,7,9,4,5,-1,-1,-1,-1,-1,-1,-1,4,5,9,6,8,0,2,6,0,7,8,6,-1,-1,-1,-1,2,6,3,6,7,3,0,5,1,0,4,5,-1,-1,-1,-1,8,2,6,7,8,6,8,1,2,5,8,4,8,5,1,-1,4,5,9,6,1,10,6,7,1,7,3,1,-1,-1,-1,-1,10,6,1,6,7,1,7,0,1,0,7,8,4,5,9,-1,10,0,4,5,10,4,10,3,0,7,10,6,10,7,3,-1,10,6,7,8,10,7,10,4,5,10,8,4,-1,-1,-1,-1,5,9,6,9,11,6,9,8,11,-1,-1,-1,-1,-1,-1,-1,11,6,3,3,6,0,6,5,0,5,9,0,-1,-1,-1,-1,8,11,0,11,5,0,5,1,0,11,6,5,-1,-1,-1,-1,3,11,6,5,3,6,1,3,5,-1,-1,-1,-1,-1,-1,-1,10,2,1,11,5,9,8,11,9,6,5,11,-1,-1,-1,-1,3,11,0,11,6,0,6,9,0,9,6,5,10,2,1,-1,5,8,11,6,5,11,5,0,8,2,5,10,5,2,0,-1,3,11,6,5,3,6,3,10,2,3,5,10,-1,-1,-1,-1,9,8,5,8,2,5,2,6,5,2,8,3,-1,-1,-1,-1,6,5,9,0,6,9,2,6,0,-1,-1,-1,-1,-1,-1,-1,8,5,1,0,8,1,8,6,5,2,8,3,8,2,6,-1,6,5,1,6,1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,3,1,10,6,1,6,8,3,9,6,5,6,9,8,-1,0,1,10,6,0,10,0,5,9,0,6,5,-1,-1,-1,-1,8,3,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,6,5,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,11,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,11,5,7,11,0,3,8,-1,-1,-1,-1,-1,-1,-1,7,11,5,11,10,5,0,9,1,-1,-1,-1,-1,-1,-1,-1,5,7,10,7,11,10,1,8,9,1,3,8,-1,-1,-1,-1,2,1,11,1,7,11,1,5,7,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,2,1,5,7,1,11,2,7,-1,-1,-1,-1,5,7,9,7,2,9,2,0,9,7,11,2,-1,-1,-1,-1,2,5,7,11,2,7,2,9,5,8,2,3,2,8,9,-1,10,5,2,5,3,2,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,2,8,2,5,8,5,7,8,5,2,10,-1,-1,-1,-1,1,0,9,3,10,5,7,3,5,2,10,3,-1,-1,-1,-1,2,8,9,1,2,9,2,7,8,5,2,10,2,5,7,-1,5,3,1,5,7,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,1,7,0,5,7,1,-1,-1,-1,-1,-1,-1,-1,3,0,9,5,3,9,7,3,5,-1,-1,-1,-1,-1,-1,-1,7,8,9,7,9,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,5,8,10,5,8,11,10,-1,-1,-1,-1,-1,-1,-1,4,0,5,0,11,5,11,10,5,0,3,11,-1,-1,-1,-1,9,1,0,10,4,8,11,10,8,5,4,10,-1,-1,-1,-1,4,11,10,5,4,10,4,3,11,1,4,9,4,1,3,-1,1,5,2,5,8,2,8,11,2,8,5,4,-1,-1,-1,-1,11,4,0,3,11,0,11,5,4,1,11,2,11,1,5,-1,5,2,0,9,5,0,5,11,2,8,5,4,5,8,11,-1,5,4,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,2,2,5,3,5,4,3,4,8,3,-1,-1,-1,-1,2,10,5,4,2,5,0,2,4,-1,-1,-1,-1,-1,-1,-1,2,10,3,10,5,3,5,8,3,8,5,4,9,1,0,-1,2,10,5,4,2,5,2,9,1,2,4,9,-1,-1,-1,-1,5,4,8,3,5,8,1,5,3,-1,-1,-1,-1,-1,-1,-1,5,4,0,5,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,4,8,3,5,8,5,0,9,5,3,0,-1,-1,-1,-1,5,4,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,11,4,11,9,4,11,10,9,-1,-1,-1,-1,-1,-1,-1,3,8,0,7,9,4,7,11,9,11,10,9,-1,-1,-1,-1,11,10,1,4,11,1,0,4,1,11,4,7,-1,-1,-1,-1,4,1,3,8,4,3,4,10,1,11,4,7,4,11,10,-1,7,11,4,4,11,9,11,2,9,2,1,9,-1,-1,-1,-1,4,7,9,7,11,9,11,1,9,1,11,2,3,8,0,-1,4,7,11,2,4,11,0,4,2,-1,-1,-1,-1,-1,-1,-1,4,7,11,2,4,11,4,3,8,4,2,3,-1,-1,-1,-1,10,9,2,9,7,2,7,3,2,9,4,7,-1,-1,-1,-1,7,10,9,4,7,9,7,2,10,0,7,8,7,0,2,-1,10,7,3,2,10,3,10,4,7,0,10,1,10,0,4,-1,2,10,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,3,1,7,-1,-1,-1,-1,-1,-1,-1,1,9,4,7,1,4,1,8,0,1,7,8,-1,-1,-1,-1,3,0,4,3,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,10,9,8,11,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,10,9,11,-1,-1,-1,-1,-1,-1,-1,10,1,0,8,10,0,11,10,8,-1,-1,-1,-1,-1,-1,-1,10,1,3,10,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,1,9,11,1,8,11,9,-1,-1,-1,-1,-1,-1,-1,9,0,3,11,9,3,9,2,1,9,11,2,-1,-1,-1,-1,11,2,0,11,0,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,2,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,9,8,10,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,10,8,2,8,1,0,8,10,1,-1,-1,-1,-1,2,10,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),numTrisTable:new Float32Array([0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,2,3,4,4,3,3,4,4,3,4,5,5,2,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,2,3,3,4,3,4,2,3,3,4,4,5,4,5,3,2,3,4,4,3,4,5,3,2,4,5,5,4,5,2,4,1,1,2,2,3,2,3,3,4,2,3,3,4,3,4,4,3,2,3,3,4,3,4,4,5,3,2,4,3,4,3,5,2,2,3,3,4,3,4,4,5,3,4,4,5,4,5,5,4,3,4,4,3,4,5,5,4,4,3,5,2,5,4,2,1,2,3,3,4,3,4,4,5,3,4,4,5,2,3,3,2,3,4,4,5,4,5,5,2,4,3,5,4,3,2,4,1,3,4,4,5,4,5,3,4,4,5,5,2,3,4,2,1,2,3,3,2,3,4,2,1,3,2,4,1,2,1,1,0])}}var pT=new em,D8e=class{constructor(){this.pyramidPassScene=new Ro,this.pyramidPassMaterial=new fT({name:"PyramidPass"}),this.pyramidPassUniforms={inputTexture:{value:void 0},inputWidth:{value:0},inputHeight:{value:0},inputShiftX:{value:0},outputShiftX:{value:0}},this.pyramidTopLevelReadPixelBuffer=new Float32Array(4);let e=`
			precision highp float;
			precision highp sampler2D;
			layout(location = 0) out vec4 pc_FragColor;
			uniform sampler2D inputTexture;
			uniform float inputWidth;
			uniform float inputHeight;
			uniform float inputShiftX;
			uniform float outputShiftX;
			const vec2 half_unit_coord = vec2(0.5);
			const vec4 one = vec4(1.0);
			void main() {
				vec2 inputSize = vec2(inputWidth, inputHeight);
				vec2 input_pixel_uv = 1. / inputSize;
				vec2 coord = gl_FragCoord.xy - half_unit_coord;
				coord.x -= outputShiftX;
				coord = coord * 2. + half_unit_coord;
				coord.x += inputShiftX;

				// sample bottom left corner
				vec2 input_uv = coord / inputSize;
				float bl = texture(inputTexture, input_uv).r;

				// sample bottom right corner
				input_uv.x += input_pixel_uv.x;
				float br = texture(inputTexture, input_uv).r;

				// sample top right corner
				input_uv.y += input_pixel_uv.y;
				float tr = texture(inputTexture, input_uv).r;

				// sample top left corner
				input_uv.x -= input_pixel_uv.x;
				float tl = texture(inputTexture, input_uv).r;

				pc_FragColor.a = bl;
				pc_FragColor.b = pc_FragColor.a + br;
				pc_FragColor.g = pc_FragColor.b + tr;
				pc_FragColor.r = pc_FragColor.g + tl; 
			}
		`;this.pyramidPassMaterial.fragmentShader=e,this.pyramidPassMaterial.uniforms=this.pyramidPassUniforms,this.pyramidPassMaterial.depthTest=!1,this.pyramidPassMaterial.depthWrite=!1;let t=new Yi(Jw,this.pyramidPassMaterial);t.frustumCulled=!1,this.pyramidPassScene.add(t)}renderPyramid(e,t,r,i,n){new J6().min.setScalar(0);let s=t.length-1,a=new fr;r.getViewport(a),this.pyramidPassUniforms.inputShiftX.value=0,this.pyramidPassUniforms.outputShiftX.value=0;let o=s-1;for(let c=o;c>=0;c--){let u=c%2===o%2?n[0]:n[1],d=c===o?i:c%2===o%2?n[1]:n[0];this.pyramidPassUniforms.inputTexture.value=Array.isArray(d.texture)?d.texture[1]:d.texture,this.pyramidPassUniforms.inputWidth.value=d.width,this.pyramidPassUniforms.inputHeight.value=d.height,r.setRenderTarget(u);let f=t[c],m=r.getPixelRatio();r.setViewport(this.pyramidPassUniforms.outputShiftX.value/m,0,f/m,f/m),c===2&&e%2!==0&&r.setViewport(this.pyramidPassUniforms.outputShiftX.value/m,0,3/m,3/m),r.render(this.pyramidPassScene,pT);let v=this.pyramidPassUniforms.inputShiftX.value;this.pyramidPassUniforms.inputShiftX.value=this.pyramidPassUniforms.outputShiftX.value,this.pyramidPassUniforms.outputShiftX.value=v,c<o&&(this.pyramidPassUniforms.outputShiftX.value+=t[c+1])}r.setViewport(a);let l=t.length%2===0?0:1;return r.readRenderTargetPixelsAsync(n[l],n[l].width-1,0,1,1,this.pyramidTopLevelReadPixelBuffer).then(()=>this.pyramidTopLevelReadPixelBuffer[0])}},uc=24,oa=96,yu=P8e(),Hd=2,hoe=class extends os{constructor(e,t,r){super(e,t,r),this.data=t,this.needsRebuild=!0,this.customDepthMaterialNeedsUpdate=!1,this._npart=-1,this.spatialn=1,this.drawRangeNeedsForceUpdate=!0,this._resolutionLevel=-1,this.resolution=64,this.spatialDivisions=25,this.zLayersPerRow=8,this.basePyramidSize=512,this.pyramidTexture1Width=341,this.pyramidTexture1Height=256,this.pyramidTexture2Width=170,this.pyramidTexture2Height=128,this.numLevels=9,this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=0,this.bboxOffset=0,this.shapesDataTexture={value:void 0},this.spatialscene=new Ro,this.potentialPassScene=new Ro,this.voxelPassScene=new Ro,this._spatialPassRenderTargets=[],this._potentialPassRenderTargets=[],this._voxelPassRenderTargets=[],this._pyramidRenderTargets=[],this.geometry=new Lt,this.geometry.drawRange.count=0,this.spatialPassUniforms={span:{value:-1},shapesDataTexture:this.shapesDataTexture,npart:{value:this.npart},spatialn:{value:this.spatialn}},this.spatialMesh=new Yi(Jw,this.spatialPassMaterial()),this.spatialMesh.frustumCulled=!1,this.spatialscene.add(this.spatialMesh);let i=new ao(yu.triTable,16,256,rT,Ni);i.needsUpdate=!0;let n=new ao(yu.numTrisTable,256,1,rT,Ni);n.needsUpdate=!0,this.voxelPassUniforms={potentialPassTexture:{value:void 0},numTrisTable:{value:n}},this.voxelMesh=new Yi(Jw,this.voxelPassMaterial()),this.voxelMesh.frustumCulled=!1,this.voxelPassScene.add(this.voxelMesh),this.potentialPassUniforms={shapesDataTexture:this.shapesDataTexture,spatialPassTexture:{value:void 0},npart:{value:this.npart},spatialn:{value:this.spatialn}},this.potentialMesh=new Yi(Jw,this.potentialPassMaterial()),this.potentialMesh.frustumCulled=!1,this.potentialPassScene.add(this.potentialMesh),this.marchPassUniforms={triTable:{value:i},potentialPassTexture:{value:void 0},voxelPassTexture:{value:void 0},pyramidTexture1:{value:void 0},pyramidTexture1Size:{value:void 0},pyramidTexture2:{value:void 0},pyramidTexture2Size:{value:void 0}},this.frustumCulled=!1,this.onBeforeShadowPass=s=>{if(O8e.call(this),this.npart===0){this.geometry.drawRange.count=0;return}let a=this.material.root;if(!a.shadersPatchedForShapeBlend)this.patchVertexShaderForShapeBlend(a),a.shadersPatchedForShapeBlend=!0,this.customDepthMaterialNeedsUpdate=!0;else if(this.customDepthMaterialNeedsUpdate){this.customDepthMaterialNeedsUpdate=!1,this.customDepthMaterial=new Jr({vertexShader:a.vertexShader,fragmentShader:`
						#include <packing>
						void main()
						{
							gl_FragColor = packDepthToRGBA(gl_FragCoord.z);
						}
					`,uniforms:a.uniforms,defines:this.material.defines}),this.isMeshDepthMaterial=!0,this.customDistanceMaterial=new Jr({vertexShader:a.vertexShader,fragmentShader:`
					#include <common>
					#include <packing>
					uniform vec3 referencePosition;
					uniform float nearDistance;
					uniform float farDistance;
					// World-space position
					varying vec3 vWPosition;
					void main()
					{
						float dist = length(vWPosition - referencePosition);
						dist = (dist - nearDistance) / (farDistance - nearDistance);
						dist = saturate(dist);
						// Required by Three.js for this to work
						gl_FragColor = packDepthToRGBA( dist );
					}`,uniforms:{nearDistance:{value:0},farDistance:{value:0},referencePosition:{value:new V},opacity:{value:0},...a.uniforms},defines:this.material.defines});let c=this.customDistanceMaterial;c.referencePosition=new V,c.nearDistance=0,c.farDistance=0,c.opacity=1,c.isMeshDistanceMaterial=!0}if(this.spatialPassUniforms.npart.value=this.npart,this.spatialPassUniforms.spatialn.value=this.spatialn,this.potentialPassUniforms.npart.value=this.npart,this.potentialPassUniforms.spatialn.value=this.spatialn,this.needsRebuild){this.needsRebuild=!1,this.spatialMesh.material.defines.RES=this.resolutionLevel,this.spatialMesh.material.needsUpdate=!0,this.potentialMesh.material.defines.RES=this.resolutionLevel,this.potentialPassUniforms.spatialPassTexture.value=this.spatialPassRenderTarget.texture,this.potentialMesh.material.needsUpdate=!0,this.voxelMesh.material.defines.RES=this.resolutionLevel,this.voxelMesh.material.needsUpdate=!0,this.voxelPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.potentialPassTexture.value=this.potentialPassRenderTarget.texture,this.marchPassUniforms.voxelPassTexture.value=this.voxelPassRenderTarget.texture[0],this.material.defines.RES=this.resolutionLevel,this.material.defines.LEVELS=this.pyramidLevelSizes.length,this.material.defines.LOOP=this.pyramidLevelSizes.length%2===0?this.pyramidLevelSizes.length-3:this.pyramidLevelSizes.length-2,this.material.defines.HALF=this.pyramidLevelSizes.length%2===0?1:0,this.material.needsUpdate=!0;let c=this.pyramidLevelSizes.length%2===0?0:1,u=this.pyramidLevelSizes.length%2===0?1:0;this.marchPassUniforms.pyramidTexture2.value=this.pyramidRenderTarget[c].texture,this.marchPassUniforms.pyramidTexture2Size.value=new ge(this.pyramidRenderTarget[c].width,this.pyramidRenderTarget[c].height),this.marchPassUniforms.pyramidTexture1.value=this.pyramidRenderTarget[u].texture,this.marchPassUniforms.pyramidTexture1Size.value=new ge(this.pyramidRenderTarget[u].width,this.pyramidRenderTarget[u].height),Object.assign(this.material.uniforms,this.marchPassUniforms)}let o=s.shadowMap.enabled;s.shadowMap.enabled=!1;let l=s.getRenderTarget();s.setRenderTarget(this.spatialPassRenderTarget),s.render(this.spatialscene,pT),s.setRenderTarget(this.potentialPassRenderTarget),s.render(this.potentialPassScene,pT),s.setRenderTarget(this.voxelPassRenderTarget),s.render(this.voxelPassScene,pT),hoe.streamCompaction.renderPyramid(this.resolutionLevel,this.pyramidLevelSizes,s,this.voxelPassRenderTarget,this.pyramidRenderTarget).then(c=>{this.material.wireframe&&(c*3>this.geometry.attributes.position.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.dispose(),this.geometry=new Lt,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.geometry.attributes.position=new Jt(new Float32Array(c*3*2),3)),(c*3>this.geometry.drawRange.count||this.drawRangeNeedsForceUpdate)&&(this.geometry.drawRange.count=Math.floor(c*1.2)*3),this.drawRangeNeedsForceUpdate=!1}),s.shadowMap.enabled=o,s.setRenderTarget(l)}}set npart(e){e!==this._npart&&(this.drawRangeNeedsForceUpdate=!0,this._npart=e,this.spatialn=Math.ceil(e/(4*uc)))}get npart(){return this._npart}set resolutionLevel(e){let t=Math.min(8,Math.max(5,e));if(t!==this._resolutionLevel){switch(this._resolutionLevel=t,this.resolution=Math.pow(2,t),this.resolutionLevel){case 5:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192],this.bboxSize=31*8*Hd,this.bboxOffset=8*Hd*-1/2;break;case 6:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512],this.bboxSize=63*4*Hd,this.bboxOffset=4*Hd*-1/2;break;case 7:this.pyramidLevelSizes=[1,2,4,6,12,24,48,96,192,384,768,1536],this.bboxSize=127*2*Hd,this.bboxOffset=2*Hd*-1/2;break;case 8:this.pyramidLevelSizes=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096],this.bboxSize=255*Hd,this.bboxOffset=Hd*-1/2;break}this.pyramidTexture1Width=0,this.pyramidTexture2Width=0,this.pyramidTexture1Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-2],this.pyramidTexture2Height=this.pyramidLevelSizes[this.pyramidLevelSizes.length-3];for(let r=this.pyramidLevelSizes.length-2;r>=0;r--)(this.pyramidLevelSizes.length-2)%2===r%2?this.pyramidTexture1Width+=this.pyramidLevelSizes[r]:this.pyramidTexture2Width+=this.pyramidLevelSizes[r];this.basePyramidSize=this.pyramidLevelSizes[this.pyramidLevelSizes.length-1],this.zLayersPerRow=this.basePyramidSize/this.resolution,this.numLevels=this.pyramidLevelSizes.length-1,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]},this.needsRebuild=!0,this.customDepthMaterialNeedsUpdate=!0}}get resolutionLevel(){return this._resolutionLevel}get spatialPassRenderTarget(){let e=this._spatialPassRenderTargets[this.resolutionLevel];return e||(e=new Zr(this.spatialDivisions*this.spatialn,this.spatialDivisions**2,{format:dn,type:Ni,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:jr,magFilter:jr}),this._spatialPassRenderTargets[this.resolutionLevel]=e),e}get potentialPassRenderTarget(){let e=this._potentialPassRenderTargets[this.resolutionLevel];return e||(e=new Zr(this.basePyramidSize,this.basePyramidSize,{format:dn,type:Ni,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:jr,magFilter:jr}),this._potentialPassRenderTargets[this.resolutionLevel]=e),e}get voxelPassRenderTarget(){let e=this._voxelPassRenderTargets[this.resolutionLevel];return e||(e=new fie(this.basePyramidSize,this.basePyramidSize,2,{stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1,minFilter:jr,magFilter:jr}),e.texture[0].format=dn,e.texture[0].type=Ni,e.texture[1].format=rT,e.texture[1].type=Ni,this._voxelPassRenderTargets[this.resolutionLevel]=e),e}get pyramidRenderTarget(){let e=this._pyramidRenderTargets[this.resolutionLevel];if(!e){let t=new Zr(this.pyramidTexture1Width,this.pyramidTexture1Height,{format:dn,type:Ni,stencilBuffer:!1,depthBuffer:!1,magFilter:jr,minFilter:jr}),r=new Zr(this.pyramidTexture2Width,this.pyramidTexture2Height,{format:dn,type:Ni,stencilBuffer:!1,depthBuffer:!1,magFilter:jr,minFilter:jr});e=[t,r],this._pyramidRenderTargets[this.resolutionLevel]=e}return e}updateState(e,t){let r=this.material;super.updateState(e,t),r!==this.material&&(this.needsRebuild=!0),e.geometry&&(this.resolutionLevel=e.geometry.resolutionLevel,this.geometry.userData.parameters={width:this.bboxSize,height:this.bboxSize,depth:this.bboxSize,centerOffset:[this.bboxOffset,this.bboxOffset,this.bboxOffset]}),e.wireframe&&!this.geometry.getAttribute("position")?this.geometry.setAttribute("position",new Jt(new Float32Array(this.geometry.drawRange.count*3),3)):!e.wireframe&&this.geometry.getAttribute("position")&&this.geometry.deleteAttribute("position")}spatialPassMaterial(){let e=`
			precision highp float;
			out vec4 pc_FragColor;
			const float spatialDivisions = ${this.spatialDivisions}.;
			uniform float span;
			uniform float npart;
			uniform float spatialn;
			${yu.shapeInput()}

			vec3 low, high;     // range of current div; subset of -1 .. 1 with span border

			// lookup one element/channel's worth of spheres for current division
			// stating with low sphere number lowi
			// gives a key to which spheres from lowi..lowi+23 are active within given div (low..high)
			float spatialKey(float lowi) {
				float t = 0.;
				for (float ii = ${uc-1}.; ii >= 0.; ii--) {
					float i = ii + lowi;
					float iin = (i + 0.5) / ${oa}.;
					vec4 shape = shapePos(iin);
					vec3 d = shape.xyz;
					float op = shape.w;
	
					t *= 2.;
					t += (
						low.x < d.x && d.x < high.x &&
						low.y < d.y && d.y < high.y &&
						low.z < d.z && d.z < high.z &&
						i < npart || op == -2. // always include if op is -2, which is the intersection operation
					) ? 1. : 0.;
				}
				return t;
			}

			${yu.getpart}

			void main() {               // spatialial fragment shader
				// find active div
				vec3 div;                               // which div is current
				// out holds x=> x, lowi faster moving and y=> z, y faster moving
				float yz = float(gl_FragCoord.y - 0.5);     // contains  z, y faster moving
				div.y = getpart(yz, spatialDivisions);
				div.z = yz; // getpart(yz, spatialDivisions.z); // what's left, should be the same as getpart

				float lx = float(gl_FragCoord.x - 0.5);     // contains x, lowi faster moving
				float lowi = getpart(lx, spatialn) * ${4*uc}.;
				div.x = lx;

				low = div / spatialDivisions * 2. - 1. - span;
				high = (div+1.) / spatialDivisions * 2. - 1. + span;

				// find active range of spheres
				pc_FragColor.x = spatialKey(lowi);
				pc_FragColor.y = spatialKey(lowi+${uc}.);
				pc_FragColor.z = spatialKey(lowi+${2*uc}.);
				pc_FragColor.w = spatialKey(lowi+${3*uc}.);
			}
		`;return new fT({name:"Spatial Pass",fragmentShader:e,uniforms:this.spatialPassUniforms})}potentialPassMaterial(){let e=`
			precision highp float;
			out vec4 pc_FragColor;

			${yu.shapeInput()}
			uniform sampler2D spatialPassTexture;

			const float res = float(RES);
			const float VOXEL_RESOLUTION = pow(2., res);
			const float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));
			const float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.;
			const float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;

			uniform float npart;
			uniform float spatialn;
			const float spatialDivisions = ${this.spatialDivisions}.;
			const float spatialDivisions2 = spatialDivisions * spatialDivisions;
			const float spatialDivisionsSub1 = spatialDivisions - 1.;

			${yu.getpart}

			vec3 packRGBAToVec3(vec4 color) {
				uint r = uint(color.r * 255.);
				uint g = uint(color.g * 255.);
				uint combined = (r << 8) | g; 
				return vec3(float(combined) * 0.00001525902, color.b, color.a); // 1/65535
			}

			void applyQuaternionToVector(in vec4 q, inout vec3 v) {
				v += 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);
			}

			/**
			 * SDF functions (reference: https://iquilezles.org/articles/distfunctions/)
			 */

			// branchless version of "Smooth Union, Subtraction and Intersection - bound, bound, bound" in above reference
			float smoothOperation(float op, float sdf, float d, float k) {
			  //        union: op =  1 => signSubtract =  1, signIntersection =  1
			  //     subtract: op = -1 => signSubtract = -1, signIntersection =  1
				// intersection: op = -2 => signSubtract = -1, signIntersection = -1

				float signSubtract = clamp(op, -1., 1.);
				float signIntersection = 2. * (op - signSubtract) + 1.;
				float h = clamp(
					0.5 + signSubtract * 0.5 * (sdf - signSubtract * signIntersection * d) / k,
					0.0,
					1.0
				);
				return mix(sdf, signSubtract * signIntersection * d, h) - 
							 signSubtract * k * h * (1.0 - h);
			}

			float sdSphere( vec3 p, float s )
			{
				return length(p)-s;
			}

			float sdEllipsoid( vec3 p, vec3 r )
			{
				float k0 = length(p/r);
				float k1 = length(p/(r*r));
				return k0*(k0-1.0)/k1;
			}

			float sdBox( vec3 p, vec3 b )
			{
				vec3 q = abs(p) - b;
				return length(max(q,0.0)) + min(max(q.x,max(q.y,q.z)),0.0);
			}

			float sdTorus( vec3 p, vec2 t )
			{
				vec2 q = vec2(length(p.xy)-t.x,p.z);
				return length(q)-t.y;
			}

			float sdCappedTorus( vec3 p, vec2 sc, float ra, float rb)
			{
				p.x = abs(p.x);
				float k = (sc.y*p.x>sc.x*p.y) ? dot(p.xy,sc) : length(p.xy);
				return sqrt( dot(p,p) + ra*ra - 2.0*ra*k ) - rb;
			}

			float dot2( in vec2 v ) { return dot(v,v); }
			float sdCappedCone( vec3 p, float h, float r1, float r2 )
			{
				vec2 q = vec2( length(p.xz), p.y );
				vec2 k1 = vec2(r2,h);
				vec2 k2 = vec2(r2-r1,2.0*h);
				vec2 ca = vec2(q.x-min(q.x,(q.y<0.0)?r1:r2), abs(q.y)-h);
				vec2 cb = q - k1 + k2*clamp( dot(k1-q,k2)/dot2(k2), 0.0, 1.0 );
				float s = (cb.x<0.0 && ca.y<0.0) ? -1.0 : 1.0;
				return s*sqrt( min(dot2(ca),dot2(cb)) );
			}

			float sdCappedCylinder( vec3 p, float h, float r )
			{
				vec2 d = abs(vec2(length(p.xz),p.y)) - vec2(r,h);
				return min(max(d.x,d.y),0.0) + length(max(d,0.0));
			}

			float maxBlend = 0.0;
			// compute potential from A (=24) spheres, using the bit flags in 'activeKey'
			// to avoid lookup/compute for inactive spheres
			// return field potential, side effect updates track,
			// compute and return +ve and -ve values separately
			void fillSpatialInner(
				float ii,
				float activeKey,
				vec3 corner,
				inout float sdf,
				inout float colorDivisor,
				inout vec4 trackColor
			) {
				for (float i = 0.; i < ${uc}.; i++) {
					if (activeKey < 1.) break; // activeKey exhausted, no more active spheres
					activeKey *= 0.5;
					if (fract(activeKey) < 0.5) continue;

					float iin = (i + ii + 0.5) * ${1/oa};
					vec4 shape = shapePos(iin);
					vec4 quat = shapeQuat(iin);
					vec4 params1 = shapeParams1(iin);
					vec4 params2 = shapeParams2(iin);

					vec3 p = corner - shape.xyz;
					applyQuaternionToVector(quat, p);
					p /= params2.z; // scale
					float d; // d in -1..1 coordinates
					switch (int(params1.x)) {
						case 0: d = sdSphere(p, params1.y); break;
						case 1: d = sdEllipsoid(p, params1.yzw); break;
						case 2: d = sdBox(p, params1.yzw); break;
						case 3: d = sdCappedCylinder(p, params1.y, params1.z); break;
						case 4: d = sdCappedCone(p, params1.y, params1.z, params1.w); break;
						case 5: d = sdTorus(p, params1.yz); break;
						case 6: d = sdCappedTorus(p, params1.yz, params1.w, params2.w); break;
					}
					d -= params2.y; // rounded edge
					d *= params2.z; // scale

					float k = params2.x;
					float op = shape.w;

					sdf = smoothOperation(shape.w, sdf, d, k);

					float isNegativeOne = step(-1.5, op) * step(op, -0.5); // 1 when op == -1, 0 otherwise
					float colorCull = smoothstep(maxBlend, 0., -d);
					float cullFactor = mix(1.0, colorCull, isNegativeOne);
					trackColor *= cullFactor;
					colorDivisor *= cullFactor;

					maxBlend = max(maxBlend, k);

					k += 2. * INV_VOXEL_RESOLUTION; // avoid division by zero, and other color artifacts with very small k
					float nearness = smoothstep(k, 0., d);

					vec4 color = shapeColor(iin);
					nearness *= float(color.a >= 0.);

					colorDivisor += nearness;
					trackColor += color * nearness;
				}
			}

			vec3 div;
			// compute potential from all spheres; collect +ve and =ve values separately
			// work in blocks of A*4 (=96) spheres, using the bit flags in 4 float channel 'activeKey' values
			// TODO check if extra vec3 output useful, not really used at present
			float fillSpatial(vec3 corner, inout vec4 trackColor) {
				float sdf = 1e3; // hack: initialize to large value
				float colorDivisor = 0.;
				// spatialPassTexture holds x=> lowi, x faster moving and y=> z, y faster moving
				float divyz = (div.y + div.z * spatialDivisions + 0.5) / (spatialDivisions2);
				for (float ii = 0.; ii < spatialn; ii++) {
					float i = ii * ${4*uc}.;

					vec4 activeKey = texture(spatialPassTexture, vec2((div.x * spatialn + ii + 0.5)/(spatialn * spatialDivisions), divyz));
					fillSpatialInner(i, activeKey.x, corner, sdf, colorDivisor, trackColor);
					fillSpatialInner(i+${uc}., activeKey.y, corner, sdf, colorDivisor, trackColor);
					fillSpatialInner(i+${2*uc}., activeKey.z, corner, sdf, colorDivisor, trackColor);
					fillSpatialInner(i+${3*uc}., activeKey.w, corner, sdf, colorDivisor, trackColor);
				}

				trackColor /= colorDivisor;
				return mix(sdf, 0.0, step(1e20 - 0.1, sdf));
			}

			void main() {
				${yu.getxyzi}    // get xi yi zi from 2d position

				vec3 xyzi = vec3(xi,yi,zi);
				vec3 corner = xyzi / VOXEL_RESOLUTION_SUB1 * 2. - 1.;  // -1..1 coords

				div = floor(xyzi / VOXEL_RESOLUTION_SUB1 * spatialDivisionsSub1);

				vec4 c = vec4(0.);
				float t = fillSpatial(corner, c);

				pc_FragColor = vec4(t, packRGBAToVec3(c)); // RGB texture
			}
		`;return new fT({name:"PotentialPass",fragmentShader:e,uniforms:this.potentialPassUniforms})}voxelPassMaterial(){let e=`
			precision highp float;
			layout(location = 0) out vec4 pc_FragColor;
			layout(location = 1) out vec4 numTris;

			const float res = float(RES);
			const float VOXEL_RESOLUTION = pow(2., res);
			const float VOXEL_RESOLUTION_SUB1 = VOXEL_RESOLUTION - 1.; 
			const float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));
			const float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;
			uniform sampler2D numTrisTable; // 256 x 1

			float keyi(float f000, float f100, float f010, float f110, float f001, float f101, float f011, float f111) {
				return (float(f000 < 0.) * 1.) +
							 (float(f100 < 0.) * 2.) +
							 (float(f010 < 0.) * 8.) +
							 (float(f110 < 0.) * 4.) +
							 (float(f001 < 0.) * 16.) +
							 (float(f101 < 0.) * 32.) +
							 (float(f011 < 0.) * 128.) +
							 (float(f111 < 0.) * 64.);
			}

			${yu.lookup}

			vec3 compNormi(float xi, float yi, float zi) {
				float dx = look(xi + 1., yi, zi, potentialPassTexture).r - look(xi - 1., yi, zi, potentialPassTexture).r;
				float dy = look(xi, yi + 1., zi, potentialPassTexture).r - look(xi, yi - 1., zi, potentialPassTexture).r;
				float dz = look(xi, yi, zi + 1., potentialPassTexture).r - look(xi, yi, zi - 1., potentialPassTexture).r;
				// if we allow (common) 0,0,0 case through then NaN can spread
				// eg r = vec4(compNorm i(???), 1.) will pollute r.w
				if (dx == 0.0 && dy == 0.0 && dz == 0.0) {
					return vec3(0.199, 0.299, 0.399);
				}
				return normalize(vec3(dx, dy, dz));
			}

			void main() {
				${yu.getxyzi}    // get xi yi zi from 2d

				vec3 normal = compNormi(xi, yi, zi);  // even if our key is -1 this may be needed by a neighbouring voxel

				if (xi >= VOXEL_RESOLUTION_SUB1 || yi >= VOXEL_RESOLUTION_SUB1 || zi >= VOXEL_RESOLUTION_SUB1) {
					pc_FragColor = vec4(normal, 0.);
					numTris = vec4(0.);
					return;
				}

				float
					f000 = look(xi, yi, zi, potentialPassTexture).r,
					f100 = look(xi+1., yi, zi, potentialPassTexture).r,
					f010 = look(xi, yi+1., zi, potentialPassTexture).r,
					f110 = look(xi+1., yi+1., zi, potentialPassTexture).r,
					f001 = look(xi, yi, zi+1., potentialPassTexture).r,
					f101 = look(xi+1., yi, zi+1., potentialPassTexture).r,
					f011 = look(xi, yi+1., zi+1., potentialPassTexture).r,
					f111 = look(xi+1., yi+1., zi+1., potentialPassTexture).r;
				float key = keyi(f000, f100, f010, f110, f001, f101, f011, f111);

				pc_FragColor = vec4(normal, key);

				numTris = texture(numTrisTable, vec2((key + 0.5) / 256., 0.5));
			}
		`;return new fT({name:"VoxelPass",fragmentShader:e,uniforms:this.voxelPassUniforms})}patchVertexShaderForShapeBlend(e){let t=`
		#ifdef SHAPEBLEND 
			precision highp sampler2D;

			uniform float isol;

			uniform sampler2D triTable;     // 256 x 16
			uniform sampler2D pyramidTexture1;
			uniform vec2 pyramidTexture1Size;
			uniform sampler2D pyramidTexture2;
			uniform vec2 pyramidTexture2Size;

			const vec2 halfPixelOffset = vec2(0.5, 0.5);

			const vec2 rShift = vec2(0., 1.);
			const vec2 gShift = vec2(1., 1.);
			const vec2 bShift = vec2(1., 0.);

			const float res = float(RES);
			const float VOXEL_RESOLUTION = pow(2., res);
			const float Z_LAYERS_PER_ROW = ceil(pow(2., res / 2.));
			const float INV_VOXEL_RESOLUTION = 1.0 / VOXEL_RESOLUTION;

			const float scale_factor = ${Hd}.;

			#if SHAPEBLEND == 5
				const float levelShiftX[7] = float[7](4., 6., 12., 24., 48., 96., 192.);
				const float scale = 8. * scale_factor;
				const vec3 originOffset = vec3(16.);
			#elif SHAPEBLEND == 7
				const float levelShiftX[10] = float[10](4., 6., 12., 24., 48., 96., 192., 384., 768., 1536.); 
				const float scale = 2. * scale_factor;
				const vec3 originOffset = vec3(64.);
			#elif SHAPEBLEND == 8
				const float levelShiftX[11] = float[11](4., 8., 16., 32., 64., 128., 256., 512., 1024., 2048., 4096.);
				const float scale = scale_factor;
				const vec3 originOffset = vec3(128.);
			#else
				const float levelShiftX[8] = float[8](4., 8., 16., 32., 64., 128., 256., 512.);
				const float scale = 4. * scale_factor;
				const vec3 originOffset = vec3(32.);
			#endif

			${yu.lookup}

			const vec3 offsets[24] = vec3[](
				vec3(0., 0., 0.), vec3(1., 0., 0.),
				vec3(1., 0., 0.), vec3(1., 1., 0.),
				vec3(0., 1., 0.), vec3(1., 1., 0.),
				vec3(0., 0., 0.), vec3(0., 1., 0.),
				vec3(0., 0., 1.), vec3(1., 0., 1.),
				vec3(1., 0., 1.), vec3(1., 1., 1.),
				vec3(0., 1., 1.), vec3(1., 1., 1.),
				vec3(0., 0., 1.), vec3(0., 1., 1.),
				vec3(0., 0., 0.), vec3(0., 0., 1.),
				vec3(1., 0., 0.), vec3(1., 0., 1.),
				vec3(1., 1., 0.), vec3(1., 1., 1.),
				vec3(0., 1., 0.), vec3(0., 1., 1.)
			);

			vec2 computeShiftedPosition1(vec2 xy, float levelOriginX) {
				vec2 xyShifted = xy;
				xyShifted.x += levelOriginX;
				return (xyShifted + halfPixelOffset) / pyramidTexture1Size;
			}

			vec2 computeShiftedPosition2(vec2 xy, float levelOriginX) {
				vec2 xyShifted = xy;
				xyShifted.x += levelOriginX;
				return (xyShifted + halfPixelOffset) / pyramidTexture2Size;
			}

			vec4 unpackVec3ToRGBA(vec3 vec) {
				uint combined = uint(vec.x * 65535.0 + 0.5); // Add 0.5 for rounding
				float g = float(combined & uint(0xFF)) * 0.00392156862; // 1/255
				float r = float((combined >> 8) & uint(0xFF)) * 0.00392156862; 
		
				return vec4(r, g, vec.y, vec.z);
			}

			out vec4 marchColor;
			// end of marchvertPre
		#endif
		`,r=`
		#ifdef SHAPEBLEND
			float triIndex = floor(float(gl_VertexID/3));
			float vertexIndex = float(gl_VertexID);
			
			// Initial pyramid lookup
			float levelOriginX1 = pyramidTexture1Size.x - 2.;
			float levelOriginX2 = pyramidTexture2Size.x - 1.;
			vec2 xy = vec2(0.);
			vec4 lookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));
			
			// Early exit check
			if (triIndex >= lookUp.r) return;
			
			// Optimize loop variables
			float start = 0.;
			vec4 triIndexVec = vec4(triIndex);
			
			// Main position computation loop
			for (int i = 0; i < LOOP;) {
				// Compute boundaries
				vec4 ends = lookUp + vec4(start);
				vec4 starts = vec4(ends.gba, start);
				vec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * 
											vec4(lessThan(triIndexVec, ends));
				
				// Update position
				xy *= 2.;
				xy += check.r * rShift + check.g * gShift + check.b * bShift;
				
				// Update loop variables
				start = dot(check, starts);
				levelOriginX2 -= levelShiftX[i];
				
				// Update lookup
				lookUp = texture(pyramidTexture1, computeShiftedPosition1(xy, levelOriginX1));
				i++;

				ends = lookUp + vec4(start);
				starts = vec4(ends.gba, start);
				check = vec4(greaterThanEqual(triIndexVec, starts)) * 
											vec4(lessThan(triIndexVec, ends));
				
				// Update position
				xy *= 2.;
				xy += check.r * rShift + check.g * gShift + check.b * bShift;
				
				// Update loop variables
				start = dot(check, starts);
				levelOriginX1 -= levelShiftX[i];
				
				// Update lookup
				lookUp = texture(pyramidTexture2, computeShiftedPosition2(xy, levelOriginX2));

				i++;
			}

			#if HALF == 1
				vec4 ends = lookUp + vec4(start);
				vec4 starts = vec4(ends.gba, start);
				vec4 check = vec4(greaterThanEqual(triIndexVec, starts)) * vec4(lessThan(triIndexVec, ends));
			
				// Update position
				xy *= 2.;
				xy += check.r * rShift + check.g * gShift + check.b * bShift;
			
				// Update loop variables
				start = dot(check, starts);
			#endif
			
			// Compute final coordinates
			vec3 gridPos;
			gridPos.x = mod(xy.x, VOXEL_RESOLUTION);
			gridPos.y = mod(xy.y, VOXEL_RESOLUTION);
			gridPos.z = floor(xy.x * INV_VOXEL_RESOLUTION) + 
									floor(xy.y * INV_VOXEL_RESOLUTION) * Z_LAYERS_PER_ROW;
			
			// Vertex key computation
			vertexIndex -= start * 3.;
			float vk = vertexIndex * 0.0625 + 0.03125; // Optimized division by 16 and addition of 1/32
			
			// Voxel lookup and edge computation
			vec4 voxel = look(gridPos.x, gridPos.y, gridPos.z, voxelPassTexture);
			float key = (voxel.w + 0.5) * 0.00390625; // Optimized division by 256
			
			// Edge lookup and offset computation
			float edgeNum = texture(triTable, vec2(vk, key)).x;
			int edgeIndex = int(edgeNum) * 2;
			
			// Compute edge positions
			vec3 p1 = gridPos + offsets[edgeIndex];
			vec3 p2 = gridPos + offsets[edgeIndex + 1];
			
			// Compute potentials and normals
			vec4 potential1 = look(p1.x, p1.y, p1.z, potentialPassTexture);
			vec4 potential2 = look(p2.x, p2.y, p2.z, potentialPassTexture);
			
			// Final position and normal computation
			float mu = potential1.r / (potential1.r - potential2.r);

			marchColor = mix(
				unpackVec3ToRGBA(potential1.gba),
				unpackVec3ToRGBA(potential2.gba),
				mu
			);

			transformed = p1 + (p2 - p1) * mu;
			transformed -= originOffset;
			transformed *= scale;
			vec4 data1 = look(p1.x, p1.y, p1.z, voxelPassTexture);
			vec4 data2 = look(p2.x, p2.y, p2.z, voxelPassTexture);
			objectNormal = normalize(mix(data1.xyz, data2.xyz, mu));
			transformedNormal = normalMatrix * objectNormal;
			#ifndef FLAT_SHADED
				vNormal = transformedNormal;
			#endif
		#endif
		`;e.vertexShader=t+e.vertexShader.replace("#include <project_vertex>",r+`
#include <project_vertex>`);let i=e.fragmentShader.match(/vec3 diffuseColor[^\n]*\n/);if(!i)return;let n=`
		#ifdef SHAPEBLEND_C
			#if SHAPEBLEND_C == 1
				${i[0].replace(/nodeU0,/g,"marchColor.rgb,").replace(/nodeU\d+(?=,g_uid\d+_calpha\))/g,"marchColor.a")}
			#else
				${i[0]}
			#endif
		#else
			${i[0]}
		#endif
		`;e.fragmentShader=`in vec4 marchColor;
`+e.fragmentShader.replace(i[0],n),Object.assign(e.uniforms,this.marchPassUniforms)}initDebugPass(e){console.log("fboToDebug.width",e.width,e.height),this.geometry=new ed(e.width,e.height),this.geometry.userData={parameters:{width:4,height:4}};let t={inputTexture:{value:Array.isArray(e.texture)?e.texture[1]:e.texture},pyramidTextureSize:{value:void 0}},r=i=>{i.vertexShader=`
				precision highp float;

				varying vec2 vUv;

				void main() {
						gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
						vUv = uv;
				}
			`,i.fragmentShader=`
				layout(location = 1) out vec4 gVelocity;

				precision highp float;
				
				uniform sampler2D inputTexture;
				varying vec2 vUv;

				uniform vec2 pyramidTextureSize;

				void main() {
						// Sample the input texture using UV coordinates
						gl_FragColor = texture(inputTexture, vUv);
						gVelocity = vec4(0.0);
				}
			`,t.pyramidTextureSize.value=new ge(this.pyramidRenderTarget.width,this.pyramidRenderTarget.height),Object.assign(i.uniforms,t)};this.material.shapeBlendhack=r,this.material.root.shapeBlendhack=r}},Kg=hoe;Kg.streamCompaction=new D8e;var N8e=new ot,k8e=new ot,zv=new ar,Of=new V,aC=new V,R8e=new ar;function I8e(e,t=0){let r=this.children.length;for(;r--;){let i=this.children[r];Yg.is(i)&&foe.call(i,e,t+1)}}function foe(e,t=0){if(e(this,t)!==!0){let r=this.children.length;for(;r--;){let i=this.children[r];Yg.is(i)&&foe.call(i,e,t+1)}}}function O8e(){if(this.shapesDataTexture.value===void 0){let a=new ao(new Float32Array(4*oa*lg),oa,lg,dn,Ni);this.shapesDataTexture.value=a}let e=this.shapesDataTexture.value,t=e.image.data;e.needsUpdate=!0;let r=0,i=this.data.geometry.blendRange,n=N8e.copy(this.matrixWorld).invert(),s=0;I8e.call(this,a=>{if(a.visible===!1)return!0;let o;if(a instanceof Ul||a instanceof Qw||a instanceof Zw)return;a instanceof va?o=a.object:o=a;let l=a.data?.cloner;if(Xr.is(a)&&l&&!l.hideBase&&l.type!=="radial"&&l.disabled!==!0||!(o instanceof os))return;let c=o.geometry.userData.parameters,u=c.shapeBlendNode;if(u===void 0)return;if(k8e.multiplyMatrices(n,a.matrixWorld).decompose(aC,zv,Of),c.type==="TorusGeometry"&&c.arc!==360){let w=c.arc*Math.PI/180;w=w/4,zv.multiply(R8e.set(0,0,Math.sin(w),Math.cos(w)))}let d=u.overrideGlobalBlend?u.blendRange:i;d=d/this.bboxSize*2,t[s*4]=(aC.x-this.bboxOffset)/this.bboxSize*2,t[s*4+1]=(aC.y-this.bboxOffset)/this.bboxSize*2,t[s*4+2]=(aC.z-this.bboxOffset)/this.bboxSize*2,t[s*4+3]=u.operation===0?1:u.operation===2?-1:-2,t[oa*4+s*4]=-zv.x,t[oa*4+s*4+1]=-zv.y,t[oa*4+s*4+2]=-zv.z,t[oa*4+s*4+3]=zv.w;let f=new Float32Array(4),m=0;if(c.type==="SphereGeometry")c.width===c.height&&c.width===c.depth?f[0]=0:f[0]=1,f[1]=c.width/this.bboxSize,f[2]=c.height/this.bboxSize,f[3]=c.depth/this.bboxSize,r=Math.max(r,f[1]*Of.x+d,f[2]*Of.x+d,f[3]*Of.x+d);else if(c.type==="CubeGeometry"){m=c.cornerRadius;let w=c.width,_=c.height,S=c.depth;f[0]=2,f[1]=(w-2*m)/this.bboxSize,f[2]=(_-2*m)/this.bboxSize,f[3]=(S-2*m)/this.bboxSize,r=Math.max(r,Math.sqrt(w**2+_**2+S**2)/this.bboxSize*Of.x+d)}else if(c.type==="CylinderGeometry"){m=c.cornerRadius;let w=c.height,_=c.radiusBottom,S=c.radiusTop;if(S>=_){let P=Math.atan2(S-_,w),M=(Math.PI/2-P)/2;S-=m/Math.tan(M),_-=m*Math.tan(M)}else if(_>S){let P=Math.atan2(_-S,w),M=(Math.PI/2-P)/2;S-=m*Math.tan(M),_-=m/Math.tan(M)}f[1]=(c.height-2*m)/this.bboxSize,_===S?(f[0]=3,f[2]=_/this.bboxSize*2):(f[0]=4,f[2]=_/this.bboxSize*2,f[3]=S/this.bboxSize*2),r=Math.max(r,f[1]*4*Of.x+d)}else if(c.type==="TorusGeometry"){if(f[0]=5,f[1]=(c.width-c.depth)/this.bboxSize,f[2]=c.depth/this.bboxSize,c.arc!==360){f[0]=6,f[3]=f[1],t[oa*12+s*4+3]=f[2];let w=2*Math.atan2(f[2]/2,f[1]),_=c.arc*Math.PI/180/2-w;f[1]=Math.sin(_),f[2]=Math.cos(_)}r=Math.max(r,c.width*Of.x/this.bboxSize+d)}t.set(f,oa*8+s*4),t[oa*12+s*4]=d,t[oa*12+s*4+1]=m/this.bboxSize*2,t[oa*12+s*4+2]=Of.x;let v=o.material,y=v.uniforms.nodeU0.node.value,x=v.uniforms.nodeU1.value;u.operation!==0&&!u.useColor&&(x=-1),t[oa*16+s*4]=y.r,t[oa*16+s*4+1]=y.g,t[oa*16+s*4+2]=y.b,t[oa*16+s*4+3]=x,x<1&&this.material.defines.SHAPEBLEND_C===1&&(this.material.transparent=!0),s++}),this.npart=s,this.spatialPassUniforms.span.value=r*1.4}var poe=512;function e$(e,t){let r=!1,i=e.layers.mask&poe,n=t.getLayersOfType("transmission"),s=t.getLayersOfType("outline");return s.length>0&&(e.layers.set(8),n.length>0&&e.layers.enable(3),r=!0,qB(e),WB(e)),n.length===0&&s.length===0&&e.layers.set(0),i&&e.layers.set(9),e instanceof sb&&e.needsAO&&e.layers.enable(5),r}function t$(e,t){if(!t.layers)return!1;let r=e.layers.mask&poe,i=!1,n=t.getLayersOfType("transmission").filter(a=>a.data.visible),s=t.getLayersOfType("outline").filter(a=>a.data.visible);return n.length>0&&(e.layers.set(3),s.length>0&&e.layers.enable(8),i=!0),n.length===0&&s.length===0&&e.layers.set(0),r&&e.layers.set(9),e.needsAO&&e.layers.enable(5),i}function j8e(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof sb)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)e$(r,r.material[i])&&(t=!0);else e$(r,r.material)&&(t=!0)}),t}function L8e(e){let t=!1;return e.traverseEntity(r=>{if(r instanceof sb)if(Array.isArray(r.material))for(let i=0;i<r.material.length;i++)t$(r,r.material[i])&&(t=!0);else t$(r,r.material)&&(t=!0)}),t}var z8e=new Hie,B8e=new ot,F8e=new Wx;function v5(e,t,r,i=!1){let n=e.cloner;if(n)for(let s of n.children){let a=B8e.copy(s.matrixWorld).invert(),o=F8e.copy(t.ray).applyMatrix4(a),l=e.matrixWorld;o.applyMatrix4(l);let c=z8e;c.set(o.origin,o.direction),c.near=t.near,c.far=t.far;let u=c.intersectObject(e,!1);u.length>0&&r.push({...u[0],object:i?s:e})}}var V8e=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((r,i)=>{let n=[i,r],s=r;for(;this._constraints.has(s);){if(s=this._constraints.get(s),n.includes(s)){console.warn(`circular dependency detected: ${n.join(" -> ")}`);break}t.has(s)||n.push(s)}for(let a=n.length-2;a>=0;a--)if(!t.has(n[a])){let o=e.find(n[a]);o?o.applyPathSnapping(e):console.warn(`missing entity ${n[a]}`),t.add(n[a])}})}findDependency(e,t){let r=e;for(;this._constraints.has(r);)if(r=this._constraints.get(r),r===t)return!0;return!1}},U8e="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",mp=class{};gw(mp,"DepthMapRange",65536),gw(mp,"MemoryPageSize",65536),gw(mp,"BytesPerFloat",4),gw(mp,"BytesPerInt",4);function H8e(e){let t,r,i,n,s,a,o,l,c,u,d,f,m,v,y,x;function w(I){let j=new Float64Array(u,a,16);for(let B=0;B<16;B++)j[B]=I[B];let L;if(i>1){t.exports.sortIndexes(n,s,c,a,o,l,f.DepthMapRange,i);let B=new Uint32Array(i);L=B.buffer,B.set(new Uint32Array(u,l,i))}else if(i===1){let B=new Uint32Array(i);B[0]=new Uint32Array(u,n,r)[0],L=B.buffer}else L=new ArrayBuffer(0);e.postMessage({sortDone:!0,indexesBuffer:L},[L])}function _(I,j,L){let B=new Float32Array(u,s,r*3);i=0;let q=new Uint32Array(u,n,r);for(let G=0;G<L.length-1;G++){let Y=j[G],X=I[G].elements,re=Y.filter($=>$.enabled&&$.mode==="Include").map($=>$.type==="Box"?C($):N($)),F=Y.filter($=>$.enabled&&$.mode==="Exclude").map($=>$.type==="Box"?C($):N($));for(let $=L[G];$<L[G+1];$++){let se=m[$*3],H=m[$*3+1],ne=m[$*3+2];if((re.length===0||P(se,H,ne,re))&&(F.length===0||!P(se,H,ne,F))){let ce=1/(X[3]*se+X[7]*H+X[11]*ne+X[15]);B[i*3]=(X[0]*se+X[4]*H+X[8]*ne+X[12])*ce,B[i*3+1]=(X[1]*se+X[5]*H+X[9]*ne+X[13])*ce,B[i*3+2]=(X[2]*se+X[6]*H+X[10]*ne+X[14])*ce,q[i]=$,i++}}}}function S(I,j){let L=[],B=j.filter(Y=>Y.enabled&&Y.mode==="Include").map(Y=>Y.type==="Box"?C(Y):N(Y)),q=j.filter(Y=>Y.enabled&&Y.mode==="Exclude").map(Y=>Y.type==="Box"?C(Y):N(Y)),G=I.length;for(let Y=0;Y<G;Y+=3){let X=I[Y],re=I[Y+1],F=I[Y+2];(B.length===0||P(X,re,F,B))&&(q.length===0||!P(X,re,F,q))||L.push(Y/3)}return L}function P(I,j,L,B,q){return B[q==="Intersect"?"every":"some"](G=>{let Y=M(I,j,L,G.invRotationMatrix,G.cropCenter);return Array.isArray(G)?E(Y.x,Y.y,Y.z,G):D(Y.x,Y.y,Y.z,G)})}function M(I,j,L,B,q){let G=I-q[0],Y=j-q[1],X=L-q[2],re=1/(B[3]*G+B[7]*Y+B[11]*X+B[15]);return{x:(B[0]*G+B[4]*Y+B[8]*X+B[12])*re+q[0],y:(B[1]*G+B[5]*Y+B[9]*X+B[13])*re+q[1],z:(B[2]*G+B[6]*Y+B[10]*X+B[14])*re+q[2]}}function C(I){let j=I.cropSize[0]/2,L=I.cropSize[1]/2,B=I.cropSize[2]/2,q=[I.cropCenter[0]-j,I.cropCenter[1]-L,I.cropCenter[2]-B,I.cropCenter[0]+j,I.cropCenter[1]+L,I.cropCenter[2]+B],G=T(I.cropRotation);return Object.assign(q,{invRotationMatrix:G,cropCenter:I.cropCenter})}function T(I){let j=[],L=I[0]*Math.PI/180,B=I[1]*Math.PI/180,q=I[2]*Math.PI/180,G=Math.cos(L),Y=Math.sin(L),X=Math.cos(B),re=Math.sin(B),F=Math.cos(q),$=Math.sin(q),se=G*F,H=G*$,ne=Y*F,ce=Y*$;return j[0]=X*F,j[1]=-X*$,j[2]=re,j[4]=H+ne*re,j[5]=se-ce*re,j[6]=-Y*X,j[8]=ce-se*re,j[9]=ne+H*re,j[10]=G*X,j[12]=0,j[13]=0,j[14]=0,j[3]=0,j[7]=0,j[11]=0,j[15]=1,j}function E(I,j,L,B){return I>=B[0]&&I<=B[3]&&j>=B[1]&&j<=B[4]&&L>=B[2]&&L<=B[5]}function N(I){let j=2/I.cropSize[0],L=2/I.cropSize[1],B=2/I.cropSize[2],q=T(I.cropRotation);return{invRadiusX:j,invRadiusY:L,invRadiusZ:B,cropCenter:I.cropCenter,invRotationMatrix:q}}function D(I,j,L,B){let q=(I-B.cropCenter[0])*B.invRadiusX,G=(j-B.cropCenter[1])*B.invRadiusY,Y=(L-B.cropCenter[2])*B.invRadiusZ;return q*q+G*G+Y*Y<=1}e.onmessage=I=>{if(I.data.getCroppedIndexes){let j=new Uint32Array(S(new Float32Array(I.data.positions),I.data.crops)).buffer;e.postMessage({outOfBoundsIndexes:j},[j])}else if(I.data.positions)d=I.data.positions,m=new Float32Array(d),y=I.data.meshMatrixWorlds,x=I.data.cropsArray,v=I.data.meshIndexIntervals,_(y,x,v),e.postMessage({sortSetupComplete:!0});else if(I.data.sort||I.data.newMatrixWorlds||I.data.newCropsArray)(I.data.newMatrixWorlds||I.data.newCropsArray)&&(x=I.data.newCropsArray||x,y=I.data.newMatrixWorlds||y,_(y,x,v)),w(I.data.sort.view,I.data.sort.cameraPosition);else if(I.data.init){f=I.data.init.Constants,r=I.data.init.splatCount;let j=f.BytesPerInt,L=f.BytesPerFloat*3,B=new Uint8Array(I.data.init.sorterWasmBytes),q=j+L,G=r*q,Y=r*f.BytesPerInt*2+f.DepthMapRange*f.BytesPerInt*2,X=f.MemoryPageSize*32,re=G+Y+X,F=Math.floor(re/f.MemoryPageSize)+1,$={module:{},env:{memory:new WebAssembly.Memory({initial:F*2,maximum:F*3,shared:!0})}};WebAssembly.compile(B).then(se=>WebAssembly.instantiate(se,$)).then(se=>{t=se,n=0,s=r*j,a=s+r*L,c=a+16*f.BytesPerFloat*2,o=c+r*f.BytesPerInt,l=o+f.DepthMapRange*f.BytesPerInt,u=$.env.memory.buffer,e.postMessage({sortSetupPhase1Complete:!0})})}}}function G8e(e){let t=new Worker(URL.createObjectURL(new Blob(["(",H8e.toString(),")(self)"],{type:"application/javascript"}))),r=atob(U8e),i=new Uint8Array(r.length);for(let n=0;n<r.length;n++)i[n]=r.charCodeAt(n);return t.postMessage({init:{sorterWasmBytes:i.buffer,splatCount:e,Constants:{BytesPerFloat:mp.BytesPerFloat,BytesPerInt:mp.BytesPerInt,DepthMapRange:mp.DepthMapRange,MemoryPageSize:mp.MemoryPageSize}}}),t}var uI=function(){let e=new Float32Array(1),t=new Int32Array(e.buffer);return function(r){return e[0]=r,t[0]}}(),W8e=function(e,t,r,i){return e+(t<<8)+(r<<16)+(i<<24)},oC=new ge;function r$(e){let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.visible===!1)return!0;i.type==="Splat"&&(t=!0)}),t}var mT=class extends Yi{constructor(e,t,r,i,n=!1,s=1,a,o){super(r,i),this.splatCount=t,this.meshIndexIntervals=a,this.meshMatrixWorlds=o,this.splatBuffers=e,this.geometry=r,this.material=i,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=n,this.devicePixelRatio=s,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(e,t,r=!1,i=1,n,s){let a=mT.buildGeomtery(t),o=mT.buildMaterial(n);return new mT(e,t,a,o,r,i,n,s)}static buildMaterial(e){let t=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,r=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,i={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:e},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new ge},viewport:{type:"v2",value:new ge},basisViewport:{type:"v2",value:new ge},debugColor:{type:"v3",value:new Zt},covariancesTextureSize:{type:"v2",value:new ge(1024,1024)},centersColorsTextureSize:{type:"v2",value:new ge(1024,1024)},orthoZoom:{type:"f",value:-1}};return new Jr({uniforms:i,vertexShader:t,fragmentShader:r,transparent:!0,alphaTest:1,blending:Ag,depthTest:!0,depthWrite:!1,side:La})}static buildGeomtery(e){let t=new Lt;t.setIndex([0,1,2,0,2,3]);let r=new Float32Array(4*3),i=new Jt(r,3);t.setAttribute("position",i),i.setXYZ(0,-1,-1,0),i.setXYZ(1,-1,1,0),i.setXYZ(2,1,1,0),i.setXYZ(3,1,-1,0),i.needsUpdate=!0;let n=new Vie().copy(t),s=new Uint32Array(e),a=new P2(s,1,!1);return a.setUsage(j2e),n.setAttribute("splatIndex",a),n.instanceCount=e,n}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(i=>i.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let e=0,t=0,r=0;for(let i of this.splatBuffers){let n=i.nsplats;this.colors.subarray(e,e+n*4).set(i.colorsA),e+=n*4,this.centers.subarray(t,t+n*3).set(i.decoded.xyz.denormDequant().data),t+=n*3,this.covariances.subarray(r,r+n*6).set(new Float32Array(i.precomputedCovarianceBufferData)),r+=n*6}}allocateAndStoreLocalSplatDataInTextures(){let e=this.splatCount,t=new ge(4096,1024);for(;t.x*t.y*2<e*6;)t.y*=2;let r=new ge(4096,1024);for(;r.x*r.y*4<e*4;)r.y*=2;let i,n;if(this.halfPrecisionCovariancesOnGPU){n=new Uint16Array(t.x*t.y*2);for(let u=0;u<this.covariances.length;u++)n[u]=fMe.toHalfFloat(this.covariances[u]);i=new ao(n,t.x,t.y,tM,Rh)}else n=new Float32Array(t.x*t.y*2),n.set(this.covariances),i=new ao(n,t.x,t.y,tM,Ni);i.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=i,this.material.uniforms.covariancesTextureSize.value.copy(t);let s=new Uint32Array(r.x*r.y*4);for(let u=0;u<e;u++){let d=u*4,f=u*3,m=u*4;s[m]=W8e(this.colors[d],this.colors[d+1],this.colors[d+2],this.colors[d+3]),s[m+1]=uI(this.centers[f]),s[m+2]=uI(this.centers[f+1]),s[m+3]=uI(this.centers[f+2])}let a=new ao(s,r.x,r.y,iie,ph);a.internalFormat="RGBA32UI",a.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=a,this.material.uniforms.centersColorsTextureSize.value.copy(r);let o=256*4,l=new Float32Array(256*16);for(let u=0;u<this.meshMatrixWorlds.length;u++)l.set(this.meshMatrixWorlds[u].elements,u*16);let c=new ao(l,o,1,dn,Ni);c.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=c,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:n,texture:i,size:t},centerColors:{data:s,texture:a,size:r},meshMatrixWorlds:{data:l,texture:c}}}updateIndexes(e){let t=this.geometry;t.attributes.splatIndex.set(e),t.attributes.splatIndex.needsUpdate=!0,t.instanceCount=e.length}updateUniforms(e,t,r,i){this.splatCount>0&&(oC.set(e.x*this.devicePixelRatio,e.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(oC),this.material.uniforms.basisViewport.value.set(2/oC.x,2/oC.y),this.material.uniforms.focal.value.set(t,r),this.material.uniforms.orthoZoom.value=i,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose()),this.removeFromParent()}},moe,q8e=new Promise(e=>{moe=e}),i$=!1,lC;function Y8e(){if(i$)return;if(lC)return lC;async function e(){let t=await Zp(()=>import("./gaussian-splat-compression-CYQZ50o2.js"),[]);moe(t),i$=!0}return lC=e(),lC}var goe;q8e.then(e=>goe=e);var X8e=class{constructor(e={}){gw(this,"updateView",function(){let t=new ot,r=[],i=new V(0,0,-1),n=new V(0,0,-1),s=new V,a=new V;return function(o=!1,l){let c=this.updateMatrixWorldsInWorkerIfNeeded(),u=this.cropsChanged();if(!o){n.set(0,0,-1).applyQuaternion(l.quaternion);let f=!1,m=!1;if(n.dot(i)<=.95&&(f=!0),a.copy(l.position).sub(s).length()>=1&&(m=!0),!f&&!m&&!c&&!u&&!this.needsInitialRender)return}this.needsInitialRender=!1,s.copy(l.position),i.copy(n),t.copy(l.matrixWorld).invert(),t.premultiply(this.dummyPerspectiveMatrix),r[0]=l.position.x,r[1]=l.position.y,r[2]=l.position.z;let d={sort:{view:t.elements,cameraPosition:r,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...c?{newMatrixWorlds:this.meshMatrixWorlds}:{},...u?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=d:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(d))}}()),this.scene=e.scene,this.currentPage=null,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null,this.needsInitialRender=!0,this.dummyPerspectiveMatrix=new ot().makePerspective(-1,1,-1,1,.1,1e3)}updateSplatMeshUniforms(e,t){let r=new ge;this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(e.getSize(r),this.cameraFocalLengthX=t.projectionMatrix.elements[0]*this.devicePixelRatio*r.x*.45,this.cameraFocalLengthY=t.projectionMatrix.elements[5]*this.devicePixelRatio*r.y*.45,this.splatMesh.updateUniforms(r,this.cameraFocalLengthX,this.cameraFocalLengthY,t.isPerspectiveCamera?-1:t.zoom*this.devicePixelRatio))}loadSplat(e={}){this.activePage=this.scene.activePage,e.position&&(e.position=new V().fromArray(e.position)),e.orientation&&(e.orientation=new ar().fromArray(e.orientation)),e.halfPrecisionCovariances=!!e.halfPrecisionCovariances;let t=[];if(this.splatEntries=t,this.activePage.traverseVisibleEntity(s=>{s.data.type==="Splat"&&t.push(s)}),this.splatMesh&&this.splatMesh.dispose(),t.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=t.map(s=>s.matrixWorld),this.meshMatrixWorldsOld=t.map(s=>s.matrixWorld.clone()),this.cropsArray=t.map(s=>s.data.crops.map(a=>a.data));let r=t.map(s=>new goe.GSplineBuffer(new Uint8Array(s.data.buffer).buffer)),i=0,n=[0];for(let s of r)i+=s.getSplatCount(),n.push(i);return this.setupSplatMesh(r,i,e.position,e.orientation,e.halfPrecisionCovariances,this.devicePixelRatio,n,this.meshMatrixWorlds),this.setupSortWorker(i),!0}updateMatrixWorldsInWorkerIfNeeded(){let e=this.splatDataTextures.meshMatrixWorlds.data;for(let t=0;t<this.meshMatrixWorlds.length;t++)e.set(this.meshMatrixWorlds[t].elements,t*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((t,r)=>t.equals(this.meshMatrixWorldsOld[r]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(t=>t.clone()),!0)}cropsChanged(){let e=!1;return this.splatEntries.forEach((t,r)=>{t.data.crops.forEach((i,n)=>{this.cropsArray[r][n]===void 0?(e=!0,this.cropsArray[r][n]=i.data):Object.entries(i.data).forEach(([s,a])=>{Array.isArray(a)&&a.some((o,l)=>o!==this.cropsArray[r][n][s][l])?(e=!0,this.cropsArray[r][n][s]=a):a!==this.cropsArray[r][n]?.[s]&&(e=!0,this.cropsArray[r][n][s]=a)})}),t.data.crops.length!==this.cropsArray[r]?.length&&(this.cropsArray[r].length=t.data.crops.length,e=!0)}),e}setupSplatMesh(e,t,r=new V,i=new ar,n=!1,s=1,a,o){this.splatMesh=mT.buildMesh(e,t,n,s,a,o),this.splatMesh.position.copy(r),this.splatMesh.quaternion.copy(i),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=99999,this.splatRenderCount=t,this.splatMesh.onBeforeRender=(l,c,u)=>this.update(l,u)}setupSortWorker(e){this.sortWorker=G8e(e),this.sortWorker.onmessage=t=>{t.data.sortDone?(this.sortRunning=!1,this.splatMesh?.updateIndexes(new Uint32Array(t.data.indexesBuffer)),this.lastSortTime=t.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):t.data.sortCanceled?this.sortRunning=!1:t.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):t.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.scene.activePage.add(this.splatMesh),this.needsInitialRender=!0)}}update(e,t){this.splatMesh!==null&&(this.updateSplatMeshUniforms(e,t),this.updateView(!1,t))}getSplatMesh(){return this.splatMesh}},y5=new Ih;y5.wireframe=!0;var n$=new V,nF=class extends Ro{constructor(e,t){super(),this.data=e,this.sharedAssets=t,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.shapeBlendIntances=[],this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new V8e,this.invisibleObjects=new Vy("jflkdsafjasdifjaslk",{...AL.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1,this.errorPage=new Hs("fdasfa",{...mx.defaultData,name:""},{shared:t,scene:this})}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=L8e(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=j8e(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),r=this.entityIdentityToEntity[t];r&&(e.uuid=r.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof Hs&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let r=[],i=t;for(;i!==this;){let n=i;i=i.parent;let s=i.children.indexOf(n);r.splice(0,0,s)}return{entity:t,sortKey:r}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(i)}return t.sort((r,i)=>Bne(r.sortKey,i.sortKey)),t.map(r=>r.entity)}nonExistOrDescendantOf(e,t){let r=this.find(e);if(r===void 0)return!0;for(;r;){if(r.uuid===t)return!0;r=r.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if(e==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(e===rb)return this.activePage.personalCamera}if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}find2D(e){for(let t of this.children)if(t instanceof Hs&&t.uiScene){let r=t.uiScene.find(e);if(r)return r}}findScene2DfromObject2D(e){for(let t of this.children)if(t instanceof Hs&&t.uiScene&&t.uiScene.find(e))return t.uiScene}find2DInUIObjects(e){let t;return this.traverseEntity(r=>{t===void 0&&r instanceof ja&&(t=r.uiCanvas.find(e))}),t}traverse2D(e){for(let t of this.children)t instanceof Hs&&t.uiScene&&t.uiScene.traverse(e)}debugEnsureEntity(e){let t=this.find(e);if(t){if(Array.isArray(t.identity)&&this.findInstance(t.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{e.cloner?.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){e.path.length===1&&e.path[0]==="components"&&e.type===1&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){if(e.path.length===0&&e.type===7){let r=e.parent===null?this:this.find(e.parent);if(r===void 0)throw new Error("unexpected");let i=this.createObject(e.id,e.data,e.children,r,e.localIndex,t);i.updateVisible(this),i.resetBBoxNeedsUpdate(),yc(i)&&xh(i.parent)&&(i.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(i),this.markToExpandCloner(i),this.markPenumbraSizeDirty(),i.updatePathSnapping()}else if(e.path.length===0&&e.type===8){let r=this.find(e.id);if(r===void 0)throw new Error("unexpected");r.traverseEntity(n=>{n instanceof Kg&&(this.shapeBlendIntances=this.shapeBlendIntances.filter(s=>s!==n))}),this.markToExpandCloner(r),r.resetBBoxNeedsUpdate(),this.unregisterObject(r);let i=r.parent;this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(r),this.markPenumbraSizeDirty(),r.parent.remove(r),xh(r.parent)&&(r.parent.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),yc(r)&&(r.freeBooleanPointer(),i instanceof $g&&i.invalidateDownstreamBooleanData().recomputeBoolean()),r instanceof eF&&r.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),this.pathConstraints.removeDependencies(r.uuid),r.updatePathSnapping()}else if(e.path.length===0&&e.type===9){let r=this.find(e.id);if(r===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(r);let i=r.parent;this.markNeedsRecomputeInstancesForAncessors(i),r.cloner?.resetOnMove(),this.markToExpandCloner(r);let n=e.parent===null?this:this.find(e.parent);if(n===void 0)throw new Error("unexpected");n.add(r),this.markNeedsRecomputeInstancesForAncessors(n),this.markToExpandCloner(r),r.invalidateClonerTransform(r),r.updateVisible(this),r.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let s=e.localIndex;n.children.splice(s,0,n.children.pop()),yc(r)&&(r.invalidateUpstreamBooleanData(),xh(r.parent)?r.parent.invalidateDownstreamBooleanData().recomputeBoolean():i instanceof $g&&i.invalidateDownstreamBooleanData().recomputeBoolean()),r.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let t of this.children)t instanceof Hs&&(t.visible=t.uuid===e,t.visible&&(this.activePage=t,this.activePage.onActive(this)));this.activePage!==this.splatViewer?.activePage&&this.reloadSplats()}updateEntityByOp(e,t,r,i){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:s}=t.props;t={...t,props:s},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let n=this.find(e);if(n)try{M8e(n,t,r,{scene:this,shared:i}),n instanceof os&&n.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}updateEntity2DByOp(e,t,r,i,n,s=[]){e.updateEntityByOp(t,r,i,n),this.traverseEntity(a=>{(a instanceof ja||a instanceof Hs)&&(s.includes(a.frameId??"")||a.frameId===t)&&a.updateEntity2DByOp(t,r,i,n)})}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let r=Object.entries(t.data.lib.components).map((i,n)=>({data:i[1].asset.data,children:i[1].asset.children,id:i[0],fi:n}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(r,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(i=>{i instanceof Ba&&i.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){Xr.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{Xr.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,r,i,n,s,a){if(e){let o=i.find(e);o&&o!==i&&n.forInstancesRec(l=>{l.data=B2(l.data,c=>{let u=c.events.data(a.id),d=l.goUp(s);if(d){let f=[...zne(d.identity),e].join("-"),m=this.entityIdentityToEntity[f];if(m){let v=m.uuid,y=As.zoom(u,t);y[r]=v}else console.warn("cannot find instance")}}).data})}}rewriteActions(e,t,r,i,n,s){e.forEach(a=>{a.data.type==="Transition"?this.relativeizeInner(a.data.object,[...t,a.id],"object",r,i,n,s):a.data.type==="Animation"?this.relativeizeInner(a.data.object,[...t,a.id],"object",r,i,n,s):a.data.type==="Conditional"&&(this.rewriteActions(a.data.ifActions,[...t,a.id,"ifActions"],r,i,n,s),this.rewriteActions(a.data.elseActions,[...t,a.id,"elseActions"],r,i,n,s))})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof Uy&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,r)=>{t.data.events.forEach(i=>{if(i.data.type==="GameControl"){let n=!1;if(t.forInstancesRec(s=>{s.data=B2(s.data,a=>{s.isInstanceRoot||(a.events.delete(i.id),n=!0)}).data}),n===!1)for(let s of LM.list)this.rewriteActions(i.data.gameActions[s],["gameActions",s],e,t,r,i)}else i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",e,t,r,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",e,t,r,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",e,t,r,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,r,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,r,i)),this.rewriteActions(i.data.inActions,["inActions"],e,t,r,i),this.rewriteActions(i.data.outActions,["outActions"],e,t,r,i)):"actions"in i.data&&this.rewriteActions(i.data.actions,["actions"],e,t,r,i)})}),!0})}expandInstances(e,t,r){let i=new Set;this.traverseEntity(n=>{if(n instanceof Uy&&n.isInstanceRoot)return n.expandInstanceChildren({scene:this,shared:e,pendingDeletes:i}),t||n.resetBBoxNeedsUpdate(),r&&n.traverseEntity(s=>{r.addClip(s)}),!0});for(let n of i)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),rF(n)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(r=>{r instanceof Uy&&r.isInstanceRoot&&(r.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let r=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[r]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[r]),t.dispose()})}clearScene(){for(let e of this.children)Xr.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let r=[],i=n=>{for(let s of n.children){let a=s.cloner;if(Xr.is(s)&&!s.raycastLock&&(s.visible||a?.object.data.visible))if(t===!0&&s.isInstanceRoot){let o=[];if(e.intersectObject(s,!0,o),o.length){let l=o[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let c=s.matrixWorld.clone().invert();l.point.applyMatrix4(c),r.push(l)}}else(yc(s)||a5(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,r),v5(s,e,r)),i(s)}};return i(this.activePage),r}raycastWithClones(e){let t=[],r=i=>{for(let n of i.children){let s=n.cloner;Xr.is(n)&&(n.visible||s?.object.data.visible)&&((yc(n)||a5(n)&&this.enableHelpers&&n.objectHelper.visible)&&(e.intersectObject(n,!1,t),v5(n,e,t,!0)),r(n))}};return r(this),t}forEachEntity(e){for(let t of this.children)Xr.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)Xr.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)Xr.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(r=>{if(r instanceof os&&r.data.type==="Mesh"&&(r.data.geometry.type==="TextGeometry"||r.data.geometry.type==="InputGeometry")&&r.data.geometry.font===e){let i=r.geometry,n=r.data.geometry;i.updateFont(e,t).then(()=>{i.update(n,t);let s=r.invalidateDownstreamBooleanData();xh(s)&&s.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)Yg.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)Xr.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,r){let i=0;for(let n of e)this.createObject(n.id,n.data,n.children,t,i,r),i+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,r,i,n,s){let a={scene:this,shared:s},o=iF(e,t,a);return o instanceof Kg&&this.shapeBlendIntances.push(o),o&&(this.entityByUuid[e]=o,i.add(o),i.children.splice(n,0,i.children.pop()),r.length>0&&(o.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(r,o,s)),o.updateState(t,a),o instanceof os&&o.updateGeometryGroupsIfNeeded(),o.updateVisible(this),o.cloner&&this.toExpandCloner.add(o),t.pathSnapping?.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),t.type==="Empty"&&t.animations&&o.traverseEntity(l=>{let c=l.dataPatched;if(l instanceof os&&c.bones&&c.boneInverses){let u=c.bones.map(m=>this.find(m)),d=c.boneInverses.map(m=>new ot().fromArray(m)),f=new G6(u,d);l.bind(f,l.bindMatrix)}else l.matrixAutoUpdate=!0}),o}getCenter(e){let t=[];for(let i=0,n=e.length;i<n;++i){let{id:s,recursive:a}=e[i],o=this.find(s),l=a?o.recursiveBBox:o.singleBBox;t.push(...l.vertices)}let r=new Wn;return r.setFromPoints(t),r.getCenter(n$),n$}copyMatrixWorld(e,t){if(e===null){t.identity();return}let r=this.find(e);r?t.copy(r.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){if(e===null){t.identity();return}let r=this.find(e)?.parent;r?t.copy(r.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof uo)if(Array.isArray(t.material))for(let r=0;r<t.material.length;r++)t.material[r]instanceof jp&&e(t.material[r]);else t.material instanceof jp&&e(t.material)})}updateViewPlaneSize(e,t,r=!1){this.traverseConcreteEntity(i=>{i instanceof Ba&&i.setViewplaneSize(e,t,r)})}initializeSplatViewer(){this.splatViewer=new X8e({scene:this}),this.reloadSplats()}reloadSplats(){this.splatViewer?.loadSplat()}},gT=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)},$8e=(e,t)=>{let r=t.x-e.x,i=t.y-e.y;return Q8e(Math.atan2(i,r))},K8e=(e,t,r)=>{let i={x:0,y:0};return r=x5(r),i.x=e.x-t*Math.cos(r),i.y=e.y-t*Math.sin(r),i},x5=e=>e*(Math.PI/180),Q8e=e=>e*(180/Math.PI),Z8e=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,dI=new Map,s$=e=>{dI.has(e)&&clearTimeout(dI.get(e)),dI.set(e,setTimeout(e,100))},eP=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let s=0;s<i.length;s+=1)n=i[s],e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent&&e.attachEvent(n,r)},a$=(e,t,r)=>{let i=t.split(/[ ,]+/g),n;for(let s=0;s<i.length;s+=1)n=i[s],e.removeEventListener?e.removeEventListener(n,r):e.detachEvent&&e.detachEvent(n,r)},voe=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),o$=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},b5=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},sF=(e,t,r)=>{let i=yoe(e);for(let n in i)if(i.hasOwnProperty(n))if(typeof t=="string")i[n]=t+" "+r;else{let s="";for(let a=0,o=t.length;a<o;a+=1)s+=t[a]+" "+r+", ";i[n]=s.slice(0,-2)}return i},J8e=(e,t)=>{let r=yoe(e);for(let i in r)r.hasOwnProperty(i)&&(r[i]=t);return r},yoe=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(r){t[r+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},hI=(e,t)=>{for(let r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},e9e=(e,t)=>{let r={};for(let i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)?r[i]=t[i]:e.hasOwnProperty(i)&&(r[i]=e[i]);return r},w5=(e,t)=>{if(e.length)for(let r=0,i=e.length;r<i;r+=1)t(e[r]);else t(e)},t9e=(e,t,r)=>({x:Math.min(Math.max(e.x,t.x-r),t.x+r),y:Math.min(Math.max(e.y,t.y-r),t.y+r)});typeof window<"u"&&(xoe="ontouchstart"in window,boe=!!window.PointerEvent,woe=!!window.MSPointerEvent);var xoe,boe,woe,K1={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},by,$2={};boe?by=K1.pointer:woe?by=K1.MSPointer:xoe?(by=K1.touch,$2=K1.mouse):by=K1.mouse;function v0(){}v0.prototype.on=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],r._handlers_[n]=r._handlers_[n]||[],r._handlers_[n].push(t);return r};v0.prototype.off=function(e,t){var r=this;return r._handlers_=r._handlers_||{},e===void 0?r._handlers_={}:t===void 0?r._handlers_[e]=null:r._handlers_[e]&&r._handlers_[e].indexOf(t)>=0&&r._handlers_[e].splice(r._handlers_[e].indexOf(t),1),r};v0.prototype.trigger=function(e,t){var r=this,i=e.split(/[ ,]+/g),n;r._handlers_=r._handlers_||{};for(var s=0;s<i.length;s+=1)n=i[s],r._handlers_[n]&&r._handlers_[n].length&&r._handlers_[n].forEach(function(a){a.call(r,{type:n,target:r},t)})};v0.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=e9e(t.options,e))};v0.prototype.bindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[t]=function(){typeof r["on"+t]=="function"?r["on"+t].apply(r,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},eP(e,by[t],r._domHandlers_[t]),$2[t]&&eP(e,$2[t],r._domHandlers_[t]),r};v0.prototype.unbindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},a$(e,by[t],r._domHandlers_[t]),$2[t]&&a$(e,$2[t],r._domHandlers_[t]),delete r._domHandlers_[t],this};var aF=v0;function Ns(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=Ns.id,Ns.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}Ns.prototype=new aF;Ns.constructor=Ns;Ns.id=0;Ns.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};Ns.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=J8e("borderRadius","50%"),r=sF("transition","opacity",e),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},hI(i.el,r),this.options.shape==="circle"&&hI(i.back,t),hI(i.front,t),this.applyStyles(i),this};Ns.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var r in e[t])this.ui[t].style[r]=e[t][r];return this};Ns.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};Ns.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};Ns.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};Ns.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};Ns.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var r=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=r,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let r=t.options.restJoystick,i={};i.x=r===!0||r.x!==!1?0:t.instance.frontPosition.x,i.y=r===!0||r.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,i)}return t};Ns.prototype.setPosition=function(e,t){var r=this;r.frontPosition={x:t.x,y:t.y};var i=r.options.fadeTime+"ms",n={};n.front=sF("transition",["top","left"],i);var s={front:{}};s.front={left:r.frontPosition.x+"px",top:r.frontPosition.y+"px"},r.applyStyles(n),r.applyStyles(s),r.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(r),r.restCallback()},r.options.fadeTime)};Ns.prototype.restCallback=function(){var e=this,t={};t.front=sF("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};Ns.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};Ns.prototype.computeDirection=function(e){var t=e.angle.radian,r=Math.PI/4,i=Math.PI/2,n,s,a;if(t>r&&t<r*3&&!e.lockX?n="up":t>-r&&t<=r&&!e.lockY?n="left":t>-r*3&&t<=-r&&!e.lockX?n="down":e.lockY||(n="right"),e.lockY||(t>-i&&t<i?s="left":s="right"),e.lockX||(t>0?a="up":a="down"),e.force>this.options.threshold){var o={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(o[l]=this.direction[l]);var c={};this.direction={x:s,y:a,angle:n},e.direction=this.direction;for(l in o)o[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+s,e),c.y||this.trigger("plain:"+a,e),c.angle||this.trigger("dir dir:"+n,e)}else this.resetDirection();return e};var r9e=Ns;function qn(e,t){var r=this;r.nipples=[],r.idles=[],r.actives=[],r.ids=[],r.pressureIntervals={},r.manager=e,r.id=qn.id,qn.id+=1,r.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},r.config(t),(r.options.mode==="static"||r.options.mode==="semi")&&(r.options.multitouch=!1),r.options.multitouch||(r.options.maxNumberOfNipples=1);let i=getComputedStyle(r.options.zone.parentElement);return i&&i.display==="flex"&&(r.parentIsFlex=!0),r.updateBox(),r.prepareNipples(),r.bindings(),r.begin(),r.nipples}qn.prototype=new aF;qn.constructor=qn;qn.id=0;qn.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(r){if(r===void 0)return t[0];for(var i=0,n=t.length;i<n;i+=1)if(t[i].identifier===r)return t[i];return!1}};qn.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};qn.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var r=e.createNipple(t.position,e.manager.getIdentifier());r.add(),e.idles.push(r)}};qn.prototype.createNipple=function(e,t){var r=this,i=r.manager.scroll,n={},s=r.options,a={x:r.parentIsFlex?i.x:i.x+r.box.left,y:r.parentIsFlex?i.y:i.y+r.box.top};if(e.x&&e.y)n={x:e.x-a.x,y:e.y-a.y};else if(e.top||e.right||e.bottom||e.left){var o=document.createElement("DIV");o.style.display="hidden",o.style.top=e.top,o.style.right=e.right,o.style.bottom=e.bottom,o.style.left=e.left,o.style.position="absolute",s.zone.appendChild(o);var l=o.getBoundingClientRect();s.zone.removeChild(o),n=e,e={x:l.left+i.x,y:l.top+i.y}}var c=new r9e(r,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(b5(c.ui.el,n),b5(c.ui.front,c.frontPosition)),r.nipples.push(c),r.trigger("added "+c.identifier+":added",c),r.manager.trigger("added "+c.identifier+":added",c),r.bindNipple(c),c};qn.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};qn.prototype.bindNipple=function(e){var t=this,r,i=function(n,s){r=n.type+" "+s.id+":"+n.type,t.trigger(r,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};qn.prototype.pressureFn=function(e,t,r){var i=this,n=0;clearInterval(i.pressureIntervals[r]),i.pressureIntervals[r]=setInterval((function(){var s=e.force||e.pressure||e.webkitForce||0;s!==n&&(t.trigger("pressure",s),i.trigger("pressure "+t.identifier+":pressure",s),n=s)}).bind(i),100)};qn.prototype.onstart=function(e){var t=this,r=t.options,i=e;e=voe(e),t.updateBox();var n=function(s){t.actives.length<r.maxNumberOfNipples?t.processOnStart(s):i.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(a){if(Object.values(i.touches).findIndex(function(l){return l.identifier===a})<0){var o=[e[0]];o.identifier=a,t.processOnEnd(o)}}),t.actives.length<r.maxNumberOfNipples&&t.processOnStart(s))};return w5(e,n),t.manager.bindDocument(),!1};qn.prototype.processOnStart=function(e){var t=this,r=t.options,i,n=t.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},o=t.getOrCreate(n,a);o.identifier!==n&&t.manager.removeIdentifier(o.identifier),o.identifier=n;var l=function(u){u.trigger("start",u),t.trigger("start "+u.id+":start",u),u.show(),s>0&&t.pressureFn(e,u,u.identifier),t.processOnMove(e)};if((i=t.idles.indexOf(o))>=0&&t.idles.splice(i,1),t.actives.push(o),t.ids.push(o.identifier),r.mode!=="semi")l(o);else{var c=gT(a,o.position);if(c<=r.catchDistance)l(o);else{o.destroy(),t.processOnStart(e);return}}return o};qn.prototype.getOrCreate=function(e,t){var r=this,i=r.options,n;return/(semi|static)/.test(i.mode)?(n=r.idles[0],n?(r.idles.splice(0,1),n):i.mode==="semi"?r.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(n=r.createNipple(t,e),n)};qn.prototype.processOnMove=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),s=t.manager.scroll;if(!Z8e(e)){this.processOnEnd(e);return}if(!n){console.error("Found zombie joystick with ID "+i),t.manager.removeIdentifier(i);return}if(r.dynamicPage){var a=n.el.getBoundingClientRect();n.position={x:s.x+a.left,y:s.y+a.top}}n.identifier=i;var o=n.options.size/2,l={x:e.pageX,y:e.pageY};r.lockX&&(l.y=n.position.y),r.lockY&&(l.x=n.position.x);var c=gT(l,n.position),u=$8e(l,n.position),d=x5(u),f=c/o,m={distance:c,position:l},v,y;if(n.options.shape==="circle"?(v=Math.min(c,o),y=K8e(n.position,v,u)):(y=t9e(l,n.position,o),v=gT(y,n.position)),r.follow){if(c>o){let S=l.x-y.x,P=l.y-y.y;n.position.x+=S,n.position.y+=P,n.el.style.top=n.position.y-(t.box.top+s.y)+"px",n.el.style.left=n.position.x-(t.box.left+s.x)+"px",c=gT(l,n.position)}}else l=y,c=v;var x=l.x-n.position.x,w=l.y-n.position.y;n.frontPosition={x,y:w},r.dataOnly||b5(n.ui.front,n.frontPosition);var _={identifier:n.identifier,position:l,force:f,pressure:e.force||e.pressure||e.webkitForce||0,distance:c,angle:{radian:d,degree:u},vector:{x:x/o,y:-w/o},raw:m,instance:n,lockX:r.lockX,lockY:r.lockY};_=n.computeDirection(_),_.angle={radian:x5(180-u),degree:180-u},n.trigger("move",_),t.trigger("move "+n.id+":move",_)};qn.prototype.processOnEnd=function(e){var t=this,r=t.options,i=t.manager.getIdentifier(e),n=t.nipples.get(i),s=t.manager.removeIdentifier(n.identifier);!n||(r.dataOnly||n.hide(function(){r.mode==="dynamic"&&(n.trigger("removed",n),t.trigger("removed "+n.id+":removed",n),t.manager.trigger("removed "+n.id+":removed",n),n.destroy())}),clearInterval(t.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),t.trigger("end "+n.id+":end",n),t.ids.indexOf(n.identifier)>=0&&t.ids.splice(t.ids.indexOf(n.identifier),1),t.actives.indexOf(n)>=0&&t.actives.splice(t.actives.indexOf(n),1),/(semi|static)/.test(r.mode)?t.idles.push(n):t.nipples.indexOf(n)>=0&&t.nipples.splice(t.nipples.indexOf(n),1),t.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(t.manager.ids[s.id]=s.identifier))};qn.prototype.onDestroyed=function(e,t){var r=this;r.nipples.indexOf(t)>=0&&r.nipples.splice(r.nipples.indexOf(t),1),r.actives.indexOf(t)>=0&&r.actives.splice(r.actives.indexOf(t),1),r.idles.indexOf(t)>=0&&r.idles.splice(r.idles.indexOf(t),1),r.ids.indexOf(t.identifier)>=0&&r.ids.splice(r.ids.indexOf(t.identifier),1),r.manager.removeIdentifier(t.identifier),r.manager.unbindDocument()};qn.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(r){r.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var i9e=qn;function Zs(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=o$(),t.config(e),t.prepareCollections();var r=function(){var n;t.collections.forEach(function(s){s.forEach(function(a){n=a.el.getBoundingClientRect(),a.position={x:t.scroll.x+n.left,y:t.scroll.y+n.top}})})};if(typeof window>"u")return t.collections;eP(window,"resize",function(){s$(r)});var i=function(){t.scroll=o$()};return eP(window,"scroll",function(){s$(i)}),t.collections}Zs.prototype=new aF;Zs.constructor=Zs;Zs.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var r;return e.collections.every(function(i){return r=i.get(t),!r}),r}};Zs.prototype.create=function(e){return this.createCollection(e)};Zs.prototype.createCollection=function(e){var t=this,r=new i9e(t,e);return t.bindCollection(r),t.collections.push(r),r};Zs.prototype.bindCollection=function(e){var t=this,r,i=function(n,s){r=n.type+" "+s.id+":"+n.type,t.trigger(r,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",i),e.on("dir:up dir:right dir:down dir:left",i),e.on("plain:up plain:right plain:down plain:left",i)};Zs.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};Zs.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};Zs.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};Zs.prototype.removeIdentifier=function(e){var t={};for(var r in this.ids)if(this.ids[r]===e){t.id=r,t.identifier=this.ids[r],delete this.ids[r];break}return t};Zs.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};Zs.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};Zs.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};Zs.prototype.onAny=function(e,t){var r=this,i,n="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=voe(t);var s=function(o,l,c){c.ids.indexOf(l)>=0&&(c[n](o),o._found_=!0)},a=function(o){i=r.getIdentifier(o),w5(r.collections,s.bind(null,o,i)),o._found_||r.removeIdentifier(i)};return w5(t,a),!1};Zs.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};Zs.prototype.onDestroyed=function(e,t){var r=this;if(r.collections.indexOf(t)<0)return!1;r.collections.splice(r.collections.indexOf(t),1)};var n9e=Zs,l$=new n9e,s9e={create:function(e){return l$.create(e)},factory:l$},_oe=new Map,e2=new Map,gg=class{constructor(e,t,r,i){this.data=t;let{audio:n,volume:s,delay:a,loop:o}=t;if(!n)throw new Error("Missing property");let l=typeof n=="string"?i.getAudio(n).src:n.data;this.audioPlayer=new Cw({src:l,volume:s,delay:a,loop:o}),e2.has(r.uuid)?e2.get(r.uuid).push(this):e2.set(r.uuid,[this]),_oe.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},_5=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=_oe.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=e2.get(e);!t?.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...e2.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Soe=class{constructor(e,t,r,i,n){if(this.data=t,this.shared=i,this.condition=n,t.interaction==="play")this.interaction=new gg(e,t,r,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new _5(t);else throw new Error("Missing property")}dispatchBasic(){if(en(this.shared,this.condition)===!1)return!1;this.interaction instanceof gg?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(en(this.shared,this.condition)===!1)return!1;this.interaction instanceof gg?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){if(en(this.shared,this.condition)===!1)return!1;this.interaction instanceof gg&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},Eoe=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.delay=0,this.emission=e.emission,e.delay!==void 0&&(this.delay=e.delay),this.particleSystem=this.page.scene.find(this.data.emitterObjectId)}toggleEmitting(){this.particleSystem.started&&!this.particleSystem.stopped?this.stop(this.delay):this.start(this.delay)}toggleFroze(){this.particleSystem.started&&!this.particleSystem.isFrozen?this.freeze(this.delay):this.unFreeze(this.delay)}start(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.start(0),this.clearDelay()},e);return}this.particleSystem.start()}stop(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.stop(0),this.clearDelay()},e);return}this.particleSystem.stop()}freeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.freeze(0),this.clearDelay()},e);return}this.particleSystem.froze()}unFreeze(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.unFreeze(0),this.clearDelay()},e);return}this.particleSystem.unFroze()}reset(e=0){if(e){this.delayTimerId=window.setTimeout(()=>{this.reset(0),this.clearDelay()},e);return}this.particleSystem.reset()}reverseFromCurrent(){switch(this.emission){case"emitToggle":this.toggleEmitting();break;case"pauseToggle":this.toggleFroze();break}}dispatchBasic(){if(en(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"emitToggle":this.toggleEmitting();break;case"pause":this.freeze(this.delay);break;case"pauseToggle":this.toggleFroze();break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchConditional(){if(en(this.shared,this.condition)===!1||!this.particleSystem)return!1;switch(this.emission){case"start":this.start(this.delay);break;case"stop":this.stop(this.delay);break;case"reset":this.reset(this.delay);break}}dispatchGameControl(e){if(en(this.shared,this.condition)===!1||!this.particleSystem)return!1;e==="start"?this.start(this.delay):this.stop(this.delay)}dispose(){!this.particleSystem||(this.particleSystem.reset(),this.clearDelay())}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}},a9e="text/plain",o9e="us-ascii",c$=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),l9e=(e,{stripHash:t})=>{let r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!r)throw new Error(`Invalid URL: ${e}`);let{type:i,data:n,hash:s}=r.groups,a=i.split(";");s=t?"":s;let o=!1;a[a.length-1]==="base64"&&(a.pop(),o=!0);let l=(a.shift()||"").toLowerCase(),c=[...a.map(u=>{let[d,f=""]=u.split("=").map(m=>m.trim());return d==="charset"&&(f=f.toLowerCase(),f===o9e)?"":`${d}${f?`=${f}`:""}`}).filter(Boolean)];return o&&c.push("base64"),(c.length>0||l&&l!==a9e)&&c.unshift(l),`data:${c.join(";")},${o?n.trim():n}${s?`#${s}`:""}`};function c9e(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return l9e(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),t.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash?i.hash="":t.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,a=0,o="";for(;;){let c=s.exec(i.pathname);if(!c)break;let u=c[0],d=c.index,f=i.pathname.slice(a,d);o+=f.replace(/\/{2,}/g,"/"),o+=u,a=d+u.length}let l=i.pathname.slice(a,i.pathname.length);o+=l.replace(/\/{2,}/g,"/"),i.pathname=o}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let s=i.pathname.split("/"),a=s[s.length-1];c$(a,t.removeDirectoryIndex)&&(s=s.slice(0,-1),i.pathname=s.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...i.searchParams.keys()])c$(s,t.removeQueryParameters)&&i.searchParams.delete(s);if(t.removeQueryParameters===!0&&(i.search=""),t.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let n=e;return e=i.toString(),!t.removeSingleSlash&&i.pathname==="/"&&!n.endsWith("/")&&i.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var u9e=class{constructor({url:e,context:t},r,i,n){if(this.controlsManager=r,this.shared=i,this.condition=n,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:c9e(e,{removeTrailingSlash:!1,removeSingleSlash:!1,stripWWW:!1}),this.context=t??"tab"}dispatch(){if(en(this.shared,this.condition)===!1)return!1;B_?window.location.assign(this.url):(this.context==="tab"||Lne&&this.context==="none"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),this.controlsManager.orbitControls?.onPointerUp(nr[0]),EOe())}},Aoe=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.controlsManager=r,this.shared=i,this.condition=n,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=s=>{this.timeoutIdQueue.shift();let a=this.page.scene.find(s);if(a===void 0)return;let o=this.controlsManager.sharedGameControlGlobals.rapierWorld,l=o?a.dataPatched.physics?.fusedBody:!0;if(a.cloner){for(let c of a.cloner.children)l?(c.playModeVisible=!1,c.rigidBody&&a.dataPatched.physics?.rigidBody==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),o.removeRigidBody(c.rigidBody),c.rigidBody=void 0),c.bvhGeometry&&(c.bvhGeometry=void 0)):this.clone===void 0||this.clone===c?(c.playModeVisible=!1,c.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),o.removeRigidBody(c.rigidBody),c.rigidBody=void 0)):c.playModeVisible===void 0&&(c.playModeVisible=!0);(l||this.clone===void 0||this.clone===!1)&&(a.visible=!1,a.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(a.rigidBody.collider(0).handle),o.removeRigidBody(a.rigidBody),a.rigidBody=void 0),a.bvhGeometry&&(a.bvhGeometry=void 0))}else a.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(a.rigidBody.collider(0).handle),o.removeRigidBody(a.rigidBody),a.rigidBody=void 0),a.bvhGeometry&&(a.bvhGeometry=void 0),a.visible=!1;o===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.rigidBody!==void 0),a.destroyedInAction=!0,this.controlsManager.requestRender()},this.objects=[...e.objects]}dispatch(e){if(en(this.shared,this.condition)===!1)return!1;this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){if(en(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},Coe=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.shared=r,this.eventManager=i,this.condition=n,this.shared=r}dispatch(){if(en(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{this.shared.reset(this.shared.data,!0),vF(this.page,this.shared,!0),this.eventManager.reset(),this.eventManager.controlsManager.gameControl?.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Toe={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},oF={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},d9e=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],tP={CSS:{},springs:{}};function Cc(e,t,r){return Math.min(Math.max(e,t),r)}function t2(e,t){return e.indexOf(t)>-1}function fI(e,t){return e.apply(null,t)}var lr={arr:function(e){return Array.isArray(e)},obj:function(e){return t2(Object.prototype.toString.call(e),"Object")},pth:function(e){return lr.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||lr.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return lr.hex(e)||lr.rgb(e)||lr.hsl(e)},key:function(e){return!Toe.hasOwnProperty(e)&&!oF.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function Moe(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(r){return parseFloat(r)}):[]}function Poe(e,t){var r=Moe(e),i=Cc(lr.und(r[0])?1:r[0],.1,100),n=Cc(lr.und(r[1])?100:r[1],.1,100),s=Cc(lr.und(r[2])?10:r[2],.1,100),a=Cc(lr.und(r[3])?0:r[3],.1,100),o=Math.sqrt(n/i),l=s/(2*Math.sqrt(n*i)),c=l<1?o*Math.sqrt(1-l*l):0,u=1,d=l<1?(l*o+-a)/c:-a+o;function f(v){var y=t?t*v/1e3:v;return l<1?y=Math.exp(-y*l*o)*(u*Math.cos(c*y)+d*Math.sin(c*y)):y=(u+d*y)*Math.exp(-y*o),v===0||v===1?v:1-y}function m(){var v=tP.springs[e];if(v)return v;for(var y=1/6,x=0,w=0;;)if(x+=y,f(x)===1){if(w++,w>=16)break}else w=0;var _=x*y*1e3;return tP.springs[e]=_,_}return t?f:m}function h9e(e){return e===void 0&&(e=10),function(t){return Math.ceil(Cc(t,1e-6,1)*e)*(1/e)}}var f9e=function(){var e=11,t=1/(e-1);function r(u,d){return 1-3*d+3*u}function i(u,d){return 3*d-6*u}function n(u){return 3*u}function s(u,d,f){return((r(d,f)*u+i(d,f))*u+n(d))*u}function a(u,d,f){return 3*r(d,f)*u*u+2*i(d,f)*u+n(d)}function o(u,d,f,m,v){var y,x,w=0;do x=d+(f-d)/2,y=s(x,m,v)-u,y>0?f=x:d=x;while(Math.abs(y)>1e-7&&++w<10);return x}function l(u,d,f,m){for(var v=0;v<4;++v){var y=a(d,f,m);if(y===0)return d;var x=s(d,f,m)-u;d-=x/y}return d}function c(u,d,f,m){if(!(0<=u&&u<=1&&0<=f&&f<=1))return;var v=new Float32Array(e);if(u!==d||f!==m)for(var y=0;y<e;++y)v[y]=s(y*t,u,f);function x(w){for(var _=0,S=1,P=e-1;S!==P&&v[S]<=w;++S)_+=t;--S;var M=(w-v[S])/(v[S+1]-v[S]),C=_+M*t,T=a(C,u,f);return T>=.001?l(w,C,u,f):T===0?C:o(w,_,_+t,u,f)}return function(w){return u===d&&f===m||w===0||w===1?w:s(x(w),d,m)}}return c}(),Doe=function(){var e={linear:function(){return function(i){return i}}},t={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var n,s=4;i<((n=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((n*3-2)/22-i,2)}},Elastic:function(i,n){i===void 0&&(i=1),n===void 0&&(n=.5);var s=Cc(i,1,10),a=Cc(n,.1,2);return function(o){return o===0||o===1?o:-s*Math.pow(2,10*(o-1))*Math.sin((o-1-a/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/a)}}},r=["Quad","Cubic","Quart","Quint","Expo"];return r.forEach(function(i,n){t[i]=function(){return function(s){return Math.pow(s,n+2)}}}),Object.keys(t).forEach(function(i){var n=t[i];e["easeIn"+i]=n,e["easeOut"+i]=function(s,a){return function(o){return 1-n(s,a)(1-o)}},e["easeInOut"+i]=function(s,a){return function(o){return o<.5?n(s,a)(o*2)/2:1-n(s,a)(o*-2+2)/2}}}),e}();function lF(e,t){if(lr.fnc(e))return e;var r=e.split("(")[0],i=Doe[r],n=Moe(e);switch(r){case"spring":return Poe(e,t);case"cubicBezier":return fI(f9e,n);case"steps":return fI(h9e,n);default:return fI(i,n)}}function Noe(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function Q3(e,t){for(var r=e.length,i=arguments.length>=2?arguments[1]:void 0,n=[],s=0;s<r;s++)if(s in e){var a=e[s];t.call(i,a,s,e)&&n.push(a)}return n}function Z3(e){return e.reduce(function(t,r){return t.concat(lr.arr(r)?Z3(r):r)},[])}function u$(e){return lr.arr(e)?e:(lr.str(e)&&(e=Noe(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function cF(e,t){return e.some(function(r){return r===t})}function uF(e){var t={};for(var r in e)t[r]=e[r];return t}function S5(e,t){var r=uF(e);for(var i in e)r[i]=t.hasOwnProperty(i)?t[i]:e[i];return r}function J3(e,t){var r=uF(e);for(var i in t)r[i]=lr.und(e[i])?t[i]:e[i];return r}function p9e(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function m9e(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(t,function(o,l,c,u){return l+l+c+c+u+u}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r),n=parseInt(i[1],16),s=parseInt(i[2],16),a=parseInt(i[3],16);return"rgba("+n+","+s+","+a+",1)"}function g9e(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),r=parseInt(t[1],10)/360,i=parseInt(t[2],10)/100,n=parseInt(t[3],10)/100,s=t[4]||1;function a(f,m,v){return v<0&&(v+=1),v>1&&(v-=1),v<1/6?f+(m-f)*6*v:v<1/2?m:v<2/3?f+(m-f)*(2/3-v)*6:f}var o,l,c;if(i==0)o=l=c=n;else{var u=n<.5?n*(1+i):n+i-n*i,d=2*n-u;o=a(d,u,r+1/3),l=a(d,u,r),c=a(d,u,r-1/3)}return"rgba("+o*255+","+l*255+","+c*255+","+s+")"}function v9e(e){if(lr.rgb(e))return p9e(e);if(lr.hex(e))return m9e(e);if(lr.hsl(e))return g9e(e)}function Mh(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function y9e(e){if(t2(e,"translate")||e==="perspective")return"px";if(t2(e,"rotate")||t2(e,"skew"))return"deg"}function E5(e,t){return lr.fnc(e)?e(t.target,t.id,t.total):e}function Ou(e,t){return e.getAttribute(t)}function dF(e,t,r){var i=Mh(t);if(cF([r,"deg","rad","turn"],i))return t;var n=tP.CSS[t+r];if(!lr.und(n))return n;var s=100,a=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(a),a.style.position="absolute",a.style.width=s+r;var l=s/a.offsetWidth;o.removeChild(a);var c=l*parseFloat(t);return tP.CSS[t+r]=c,c}function koe(e,t,r){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return r?dF(e,n,r):n}}function hF(e,t){if(lr.dom(e)&&!lr.inp(e)&&(Ou(e,t)||lr.svg(e)&&e[t]))return"attribute";if(lr.dom(e)&&cF(d9e,t))return"transform";if(lr.dom(e)&&t!=="transform"&&koe(e,t))return"css";if(e[t]!=null)return"object"}function Roe(e){if(lr.dom(e)){for(var t=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map,n;n=r.exec(t);)i.set(n[1],n[2]);return i}}function x9e(e,t,r,i){var n=t2(t,"scale")?1:0+y9e(t),s=Roe(e).get(t)||n;return r&&(r.transforms.list.set(t,s),r.transforms.last=t),i?dF(e,s,i):s}function fF(e,t,r,i){switch(hF(e,t)){case"transform":return x9e(e,t,i,r);case"css":return koe(e,t,r);case"attribute":return Ou(e,t);default:return e[t]||0}}function pF(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var i=Mh(e)||0,n=parseFloat(t),s=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return n+s+i;case"-":return n-s+i;case"*":return n*s+i}}function Ioe(e,t){if(lr.col(e))return v9e(e);if(/\s/g.test(e))return e;var r=Mh(e),i=r?e.substr(0,e.length-r.length):e;return t?i+t:i}function mF(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function b9e(e){return Math.PI*2*Ou(e,"r")}function w9e(e){return Ou(e,"width")*2+Ou(e,"height")*2}function _9e(e){return mF({x:Ou(e,"x1"),y:Ou(e,"y1")},{x:Ou(e,"x2"),y:Ou(e,"y2")})}function Ooe(e){for(var t=e.points,r=0,i,n=0;n<t.numberOfItems;n++){var s=t.getItem(n);n>0&&(r+=mF(i,s)),i=s}return r}function S9e(e){var t=e.points;return Ooe(e)+mF(t.getItem(t.numberOfItems-1),t.getItem(0))}function joe(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return b9e(e);case"rect":return w9e(e);case"line":return _9e(e);case"polyline":return Ooe(e);case"polygon":return S9e(e)}}function E9e(e){var t=joe(e);return e.setAttribute("stroke-dasharray",t),t}function A9e(e){for(var t=e.parentNode;lr.svg(t)&&lr.svg(t.parentNode);)t=t.parentNode;return t}function Loe(e,t){var r=t||{},i=r.el||A9e(e),n=i.getBoundingClientRect(),s=Ou(i,"viewBox"),a=n.width,o=n.height,l=r.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function C9e(e,t){var r=lr.str(e)?Noe(e)[0]:e,i=t||100;return function(n){return{property:n,el:r,svg:Loe(r),totalLength:joe(r)*(i/100)}}}function T9e(e,t){function r(o){o===void 0&&(o=0);var l=t+o>=1?t+o:0;return e.el.getPointAtLength(l)}var i=Loe(e.el,e.svg),n=r(),s=r(-1),a=r(1);switch(e.property){case"x":return(n.x-i.x)*i.w;case"y":return(n.y-i.y)*i.h;case"angle":return Math.atan2(a.y-s.y,a.x-s.x)*180/Math.PI}}function d$(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=Ioe(lr.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(r)?i.match(r).map(Number):[0],strings:lr.str(e)||t?i.split(r):[]}}function zoe(e){var t=e?Z3(lr.arr(e)?e.map(u$):u$(e)):[];return Q3(t,function(r,i,n){return n.indexOf(r)===i})}function Boe(e){var t=zoe(e);return t.map(function(r,i){return{target:r,id:i,total:t.length,transforms:{list:Roe(r)}}})}function M9e(e,t){var r=uF(t);if(/^spring/.test(r.easing)&&(r.duration=Poe(r.easing)),lr.arr(e)){var i=e.length,n=i===2&&!lr.obj(e[0]);n?e={value:e}:lr.fnc(t.duration)||(r.duration=t.duration/i)}var s=lr.arr(e)?e:[e];return s.map(function(a,o){var l=lr.obj(a)&&!lr.pth(a)?a:{value:a};return lr.und(l.delay)&&(l.delay=o?0:t.delay),lr.und(l.endDelay)&&(l.endDelay=o===s.length-1?t.endDelay:0),l}).map(function(a){return J3(a,r)})}function P9e(e){for(var t=Q3(Z3(e.map(function(s){return Object.keys(s)})),function(s){return lr.key(s)}).reduce(function(s,a){return s.indexOf(a)<0&&s.push(a),s},[]),r={},i=function(s){var a=t[s];r[a]=e.map(function(o){var l={};for(var c in o)lr.key(c)?c==a&&(l.value=o[c]):l[c]=o[c];return l})},n=0;n<t.length;n++)i(n);return r}function D9e(e,t){var r=[],i=t.keyframes;i&&(t=J3(P9e(i),t));for(var n in t)lr.key(n)&&r.push({name:n,tweens:M9e(t[n],e)});return r}function N9e(e,t){var r={};for(var i in e){var n=E5(e[i],t);lr.arr(n)&&(n=n.map(function(s){return E5(s,t)}),n.length===1&&(n=n[0])),r[i]=n}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}function k9e(e,t){var r;return e.tweens.map(function(i){var n=N9e(i,t),s=n.value,a=lr.arr(s)?s[1]:s,o=Mh(a),l=fF(t.target,e.name,o,t),c=r?r.to.original:l,u=lr.arr(s)?s[0]:c,d=Mh(u)||Mh(l),f=o||d;return lr.und(a)&&(a=c),n.from=d$(u,f),n.to=d$(pF(a,u),f),n.start=r?r.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=lF(n.easing,n.duration),n.isPath=lr.pth(s),n.isColor=lr.col(n.from.original),n.isColor&&(n.round=1),r=n,n})}var Foe={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,i,n){if(i.list.set(t,r),t===i.last||n){var s="";i.list.forEach(function(a,o){s+=o+"("+a+") "}),e.style.transform=s}}};function Voe(e,t){var r=Boe(e);r.forEach(function(i){for(var n in t){var s=E5(t[n],i),a=i.target,o=Mh(s),l=fF(a,n,o,i),c=o||Mh(l),u=pF(Ioe(s,c),l),d=hF(a,n);Foe[d](a,n,u,i.transforms,!0)}})}function R9e(e,t){var r=hF(e.target,t.name);if(r){var i=k9e(t,e),n=i[i.length-1];return{type:r,property:t.name,animatable:e,tweens:i,duration:n.end,delay:i[0].delay,endDelay:n.endDelay}}}function I9e(e,t){return Q3(Z3(e.map(function(r){return t.map(function(i){return R9e(r,i)})})),function(r){return!lr.und(r)})}function Uoe(e,t){var r=e.length,i=function(s){return s.timelineOffset?s.timelineOffset:0},n={};return n.duration=r?Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+a+o+l+s.duration*(s.loop??1)})):t.duration,n.delay=r?Math.min.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0;return i(s)+a+o+s.delay})):t.delay,n.endDelay=r?n.duration-Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+a+o+s.duration*(s.loop??1)-s.endDelay-l})):t.endDelay,n}var h$=0;function O9e(e){var t=S5(Toe,e),r=S5(oF,e),i=D9e(r,e),n=Boe(e.targets),s=I9e(n,i),a=Uoe(s,r),o=h$;return h$++,J3(t,{id:o,children:[],animatables:n,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay,startOnceDelay:r.startOnceDelay,pingPongDelayCorrection:r.pingPongDelayCorrection,pingPongEndDelayCorrection:r.pingPongEndDelayCorrection})}var ql=[],f$=[],ay,p$=function(){let e=0,t=!0;function r(s){let a=ql.length;if(a){let o=0;for(;o<a;){let l=ql[o];l.paused?(ql.splice(o,1),a--):(l.tick(s),o++)}ay=requestAnimationFrame(r)}else ay&&(cancelAnimationFrame(ay),ay=null)}function i(){e=performance.now(),ay=requestAnimationFrame(r)}function n(s){e+=s,r(e)}return{isUsingInternalRaf:t,play:i,update:n}}();function j9e(e){document.hidden?(ql.forEach(function(t){return t.pause(e.timeStamp)}),f$=ql.slice(0),Un.running=ql=[]):f$.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",j9e);function Un(e){e===void 0&&(e={});var t=0,r=0,i=0,n,s,a=0,o=null;function l(C){var T=window.Promise&&new Promise(function(E){return o=E});return C.finished=T,T}var c=O9e(e);l(c);function u(){var C=c.direction;C!=="alternate"&&(c.direction=C!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(T){(T.loop===1||T.loop%2===0)&&(T.reversed=c.reversed)})}function d(){c.direction="normal",c.reversed=!1,s.forEach(function(C){return C.reversed=!1})}function f(C){return c.reversed?c.duration-C:C}function m(){t=0,r=f(c.currentTime)*(1/Un.speed)}function v(C,T,E=!1){T&&(c.reversed?T.seek(T.duration*T.loop-(C-T.timelineOffset-T.pingPongDelayCorrection),E):T.seek(C-T.timelineOffset-T.startOnceDelay-T.pingPongDelayCorrection,E))}function y(C,T=!1){if(c.reversed)for(var E=a;E--;)v(C,s[E],T);else for(var N=0;N<a;N++)v(C,s[N],T)}function x(C){var T=0,E=c.animations,N=E.length;for(c.direction!=="alternate"&&c.parent?.direction==="alternate"?c.parent?.rewind===!1&&c.reversePlayback===!0&&c.rewind===!1&&(c.parent?.reversed&&c.direction==="alternate"?C=c.duration-c.delay+c.endDelay-C:C=c.duration+c.delay-c.endDelay-C):P(!1,c.parent?.rewind,c.rewind,c.parent?.reversePlayback,c.reversePlayback)&&(c.parent?.reversed&&c.direction==="alternate"?C=c.duration-c.delay+c.endDelay-C:C=c.duration+c.delay-c.endDelay-C);T<N;){var D=E[T],I=D.animatable,j=D.tweens,L=j.length-1,B=j[L];L&&(B=Q3(j,function(Z){return C<Z.end})[0]||B);let ae;c.parent?.reversed&&c.direction==="alternate"?ae=Cc(C-B.start-B.endDelay,0,B.duration)/B.duration:ae=Cc(C-B.start-B.delay,0,B.duration)/B.duration;for(var q=isNaN(ae)?1:B.easing(ae),G=B.to.strings,Y=B.round,X=[],re=B.to.numbers.length,F=void 0,$=0;$<re;$++){var se=void 0;let Z,fe;c.direction!=="alternate"?c.parent?.rewind===!1&&c.reversePlayback===!0&&c.rewind===!1?(Z=B.to.numbers[$],fe=B.from.numbers[$]||0):(fe=B.to.numbers[$],Z=B.from.numbers[$]||0):P(!0,c.parent?.rewind,c.rewind,c.parent?.reversePlayback,c.reversePlayback)?(Z=B.to.numbers[$],fe=B.from.numbers[$]||0):(fe=B.to.numbers[$],Z=B.from.numbers[$]||0),B.isPath?se=T9e(B.value,q*fe):se=Z+q*(fe-Z),Y&&(B.isColor&&$>2||(se=Math.round(se*Y)/Y)),X.push(se)}var H=G.length;if(!H)F=X[0];else{F=G[0];for(var ne=0;ne<H;ne++){G[ne];var ce=G[ne+1],ie=X[ne];isNaN(ie)||(ce?F+=ie+ce:F+=ie+" ")}}Foe[D.type](I.target,D.property,F,I.transforms),D.currentValue=F,T++}}function w(C){c[C]&&!c.passThrough&&c[C](c)}function _(){c.remaining&&c.remaining!==!0&&c.remaining--}let S={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function P(C,T,E,N,D){return S[C<<4|T<<3|E<<2|N<<1|D]}function M(C,T=!1){var E=c.duration;let N=c.delay,D=E-c.endDelay;c.parent?.reversed&&c.direction==="alternate"&&(N=c.endDelay,D=E-c.delay);var I=f(C);if(c.progress=Cc(I/E*100,0,100),T||(c.reversePlayback=I<c.currentTime),a&&y(I,T),!c.began&&c.currentTime>=0&&(c.began=!0,w("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,w("loopBegin")),(c.reversed||I>=0)&&I<=N&&c.currentTime!==0&&(x(0),w("change")),(I>=D&&c.currentTime!==E+c.pingPongDelayCorrection||!E)&&(x(E),w("change")),I>N&&I<D?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,w("changeBegin")),x(I),w("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,w("change"),a&&w("timelineChangeComplete")):c.began&&I>D&&w("changeComplete"),c.currentTime=Cc(I,0,E+c.pingPongDelayCorrection),c.began&&w("update"),C>=E)if(_(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,w("loopComplete"),w("complete"),!c.passThrough&&"Promise"in window&&(o(),l(c)));else{a?t+=c.duration/Un.speed:t+=c.duration;for(let j of s)j.setStartTime(0),j.remaining=j.loop;w("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?u():a&&d()}}return c.reset=function(){var C=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=C==="reverse",c.remaining=c.loop,s=c.children,a=s.length;for(var T=a;T--;)c.children[T].reset();x(c.reversed?c.duration:0)},c.setStartTime=function(C){t=C},c.set=function(C,T){return Voe(C,T),c},c.tick=function(C){i=C,t||(t=i),M((i+(r-t))*Un.speed)},c.seek=function(C,T=!1){M(C-t,T)},c.pause=function(C){c.paused=!0,a&&(n=C??performance.now())},c.play=function(C){!c.paused||(c.completed&&c.reset(),c.paused=!1,ql.push(c),a&&n!==void 0&&(t+=(C??performance.now())-n),!ay&&p$.isUsingInternalRaf&&p$.play())},c.reverse=function(){u(),c.completed=!c.reversed,m()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function m$(e,t){for(var r=t.length;r--;)cF(e,t[r].animatable.target)&&t.splice(r,1)}function L9e(e){for(var t=zoe(e),r=ql.length;r--;){var i=ql[r],n=i.animations,s=i.children;m$(t,n);for(var a=s.length;a--;){var o=s[a],l=o.animations;m$(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!n.length&&!s.length&&i.pause()}}function z9e(e,t){t===void 0&&(t={});var r=t.direction||"normal",i=t.easing?lF(t.easing):null,n=t.grid,s=t.axis,a=t.from||0,o=a==="first",l=a==="center",c=a==="last",u=lr.arr(e),d=parseFloat(u?e[0]:e),f=u?parseFloat(e[1]):0,m=Mh(u?e[1]:e)||0,v=t.start||0+(u?d:0),y=[],x=0;return function(w,_,S){if(o&&(a=0),l&&(a=(S-1)/2),c&&(a=S-1),!y.length){for(var P=0;P<S;P++){if(!n)y.push(Math.abs(a-P));else{var M=l?(n[0]-1)/2:a%n[0],C=l?(n[1]-1)/2:Math.floor(a/n[0]),T=P%n[0],E=Math.floor(P/n[0]),N=M-T,D=C-E,I=Math.sqrt(N*N+D*D);s==="x"&&(I=-N),s==="y"&&(I=-D),y.push(I)}x=Math.max.apply(Math,y)}i&&(y=y.map(function(L){return i(L/x)*x})),r==="reverse"&&(y=y.map(function(L){return s?L<0?L*-1:-L:Math.abs(x-L)}))}var j=u?(f-d)/x:d;return v+j*(Math.round(y[_]*100)/100)+m}}function B9e(e){e===void 0&&(e={});var t=Un(e);return t.duration=0,t.add=function(r,i){var n=ql.indexOf(t),s=t.children;n>-1&&ql.splice(n,1);function a(f){f.passThrough=!0}for(var o=0;o<s.length;o++)a(s[o]);var l=J3(r,S5(oF,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=lr.und(i)?c:pF(i,c),a(t);var u=Un(l);a(u),s.push(u),u.parent=t;var d=Uoe(s,e);return t.delay=d.delay,t.endDelay=d.endDelay,t.duration=d.duration,u.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}Un.version="3.2.0";Un.speed=1;Un.running=ql;Un.remove=L9e;Un.get=fF;Un.set=Voe;Un.convertPx=dF;Un.path=C9e;Un.setDashoffset=E9e;Un.stagger=z9e;Un.timeline=B9e;Un.easing=lF;Un.penner=Doe;Un.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var r2=Un,g$=new V,v$=new V,y$=new ar;function F9e(e,t,r,i){if(i===0)return r.copy(e);if(i===1)return r.copy(t);let n=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(n>=1)return r.copy(e);let s=1-n*n;if(s<=Number.EPSILON){let u=1-i;return r.w=u*e.w+i*t.w,r.x=u*e.x+i*t.x,r.y=u*e.y+i*t.y,r.z=u*e.z+i*t.z,r.normalize(),r}let a=Math.sqrt(s),o=Math.atan2(a,n),l=Math.sin((1-i)*o)/a,c=Math.sin(i*o)/a;return r.w=e.w*l+t.w*c,r.x=e.x*l+t.x*c,r.y=e.y*l+t.y*c,r.z=e.z*l+t.z*c,r}function ua(e,t,r,i,n,s){let a=r[e]!==void 0?r[e]:void 0,o=i[e];if(o==null)return;let l=a!=null?typeof a=="string"?Number(n.getVariable(a)??0):a:t[e],c=typeof o=="string"?Number(n.getVariable(o)??0):o;if(l!==c)return{update:u=>{let d=Ct.lerp(l,c,u);s?t[e]=Math.trunc(d):t[e]=d},start:()=>{t[e]=l},end:()=>{t[e]=c}}}function gF(e,t,r,i,n,s){let a=r[e]?r[e]:void 0,o=i[e];if(!o)return;let l=t[e],c=[...a??l].map(d=>typeof d=="string"?Number(n.getVariable(d)??0):d),u=[...o].map(d=>typeof d=="string"?Number(n.getVariable(d)??0):d);if(!(c.length!==u.length||gB(c,u)))return{update:d=>{c.forEach((f,m)=>{let v=Ct.lerp(f,u[m],d);t[e][m]=s?Math.trunc(v):v})},start:()=>{Object.assign(t[e],c)},end:()=>{Object.assign(t[e],u)}}}function rP(e,t,r){return t.forEach((i,n)=>{e.setComponent(n,typeof i=="string"?Number(r.getVariable(i)??0):i)}),e}function x$(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?rP(new V,s,n):o.clone(),c=rP(new V,a,n);if(!l.equals(c))return{update:u=>{o.lerpVectors(l,c,u)},start:()=>{o.copy(l)},end:()=>{o.copy(c)}}}function b$(e,t,r){return t.forEach((i,n)=>{e.setComponent(n,typeof i=="string"?Number(r.getVariable(i)??0):i)}),e}function iP(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=!(o instanceof ge),c=o instanceof ge?o:new ge().fromArray(o),u=s?b$(new ge,s,n):c.clone(),d=b$(new ge,a,n);if(!u.equals(d))return{update:f=>{c.lerpVectors(u,d,f),l&&(t[e]=c.toArray())},start:()=>{c.copy(u),l&&(t[e]=c.toArray())},end:()=>{c.copy(d),l&&(t[e]=c.toArray())}}}function V9e(e,t,r,i){let n=r[e]?r[e]:void 0,s=i[e];if(!s)return;let a=t[e],o=n?new ot().fromArray(n):a.clone(),l=new V,c=new ar,u=new V;o.decompose(l,c,u);let d=new ot().fromArray(s),f=new V,m=new ar,v=new V;if(d.decompose(f,m,v),!o.equals(d))return{update:y=>{y$.slerpQuaternions(c,m,y),g$.lerpVectors(l,f,y),v$.lerpVectors(u,v,y),a.compose(g$,y$,v$)},start:()=>{a.compose(l,c,u)},end:()=>{a.compose(f,m,v)}}}function U9e(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=s?typeof s=="string"?n.getColor(s).clone():new Zt().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new Zt().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return{update:d=>{u.lerpColors(l,c,d),t[e]?.copy?.(u)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function cC(e,t,r,i,n){let s=r[e]?r[e]:void 0,a=i[e];if(!a)return;let o=t[e],l=new xa(o.r,o.g,o.b,o.a),c=s?typeof s=="string"?n.getColor(s).clone():new xa(s.r,s.g,s.b,s.a):l.clone(),u=typeof a=="string"?n.getColor(a).clone():new xa(a.r,a.g,a.b,a.a);if(!c.equals(u))return{update:d=>{l.lerpColors(c,u,d);let f=Ct.lerp(c.a,u.a,d);l.a=f,t[e]={r:l.r,g:l.g,b:l.b,a:l.a}},start:()=>{l.copy(c)},end:()=>{l.copy(u)}}}function rm(e,t,r,i,n){if(typeof t[e]=="number")return ua(e,t,r??{},i,n);if(Array.isArray(t[e]))return gF(e,t,r??{},i,n)}function H9e(e,t,r,i){let n=[],s=e.cameraType==="OrthographicCamera"?t.orthographic?.zoom:t.perspective?.zoom,a=e.cameraType==="OrthographicCamera"?r.orthographic?.zoom:r.perspective?.zoom;if(a!==void 0){let o=s??e.zoom,l=a;o!==l&&n.push({update:c=>{e.zoom=Ct.lerp(o,l,c),e.updateProjectionMatrix()},start:()=>{e.zoom=o,e.updateProjectionMatrix()},end:()=>{e.zoom=l,e.updateProjectionMatrix()}})}if(r.targetOffset!==void 0){let o=ua("targetOffset",e,t,r,i);o&&n.push(o)}return n}function G9e(e,t,r,i){if(r.scaleBaked===void 0)return;let n=(t.scaleBaked??e.data.geometry.scaleBaked).map(o=>typeof o=="string"?Number(i.getVariable(o)??0):o),s=r.scaleBaked.map(o=>typeof o=="string"?Number(i.getVariable(o)??0):o);if(Pg.isEqual(n,s))return;let a=[];return a.push({update:o=>{e.updateGeometryInteractions({scaleBaked:[Ct.lerp(n[0],s[0],o),Ct.lerp(n[1],s[1],o),Ct.lerp(n[2],s[2],o)]},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},start:()=>{e.updateGeometryInteractions({scaleBaked:n},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()},end:()=>{e.updateGeometryInteractions({scaleBaked:s},i),e.invalidateDownstreamBooleanData(),e.refreshAttachedClonersInteractions()}}),a}function W9e(e,t,r,i){if(!r.extrusion)return;let n=e.extrusion,s=t.extrusion??{},a=r.extrusion,o=[];return bse.forEach(l=>{let c=rm(l,n,s,a,i);c&&o.push(c)}),o}function q9e(e,t,r,i){let n=[];if(!("geometry"in r))return n;let s=e.geometry.userData.parameters,a="geometry"in t?t.geometry:{},o=r.geometry;if(e instanceof X2){let l=G9e(e,a,o,i);l&&n.push(...l)}else{let l={};if(Object.assign(l,Bu(s,x4),Bu(a,x4)),x4.forEach(c=>{let u=rm(c,l,a,o,i);u&&n.push(u)}),e instanceof eF){Object.assign(l,{extrusion:{...s.extrusion}});let c=W9e(l,a,o,i);c&&n.push(...c)}n.length&&n.push({update:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},start:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()},end:c=>{e.updateGeometryInteractions(l,i),e.updateGeometryGroupsIfNeeded(),e.refreshAttachedClonersInteractions()}})}return n}function Y9e(e,t,r,i){let n=[];if(r.intensity!==void 0){let s=ua("intensity",e,t,r,i);s&&n.push(s)}if(r.color!==void 0){let s=U9e("color",e,t,r,i);s&&n.push(s)}return n}function X9e(e,t,r,i){let n=[];if(Array.isArray(e.material)){if(!("materials"in r&&r.materials))return n;let s="materials"in t&&t.materials?t.materials:[],a=r.materials;e.material.forEach((o,l)=>{if(!a[l])return;let c=s[l]??{},u=a[l];typeof c=="string"||typeof u=="string"||n.push(...w$(o,c,u,i))})}else{if(!("material"in r&&r.material))return n;let s="material"in t&&t.material?t.material:{},a=r.material;if(typeof s=="string"||typeof a=="string")return n;n.push(...w$(e.material,s,a,i))}return n}function w$(e,t,r,i){let n=[],s=xy(r,i)||!!t.layers&&xy(t,i);n.push(i7e(e,s));for(let a of e.layers){let o=t.layers?.data(a.uuid),l=r.layers.data(a.uuid);if(!l||a.type!=="light"&&(!(a.visible??!0)||!(l.visible??!0)))continue;let c=a.getNames().filter(u=>!vse.some(d=>u.includes(d)));for(let u of c)try{let d=a.getValue(u),f;if(u==="colors")f=t7e(a,o,l,u);else if(Array.isArray(d))u==="steps"&&(f=e7e(a,o,l,u));else if(typeof d=="number")f=$9e(a,o,l,u,i);else{if(typeof d=="boolean")continue;d instanceof ge?f=K9e(a,o,l,u):d instanceof V?f=Q9e(a,o,l,u,i):d instanceof xa?f=J9e(a,o,l,u,i):d instanceof Zt?f=Z9e(a,o,l,u,i):"isTexture"in d&&(f=r7e(a,o,l,u))}f&&(Array.isArray(f)?n.push(...f):n.push(f))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${u}`,d)}}return n}function $9e(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:e.getValue(i),a=r[i],o=typeof s=="string"?Number(n.getVariable(s)??0):s,l=typeof a=="string"?Number(n.getVariable(a)??0):a;if(o!==l)return{update:c=>{e.setValue(i,Ct.lerp(o,l,c))},start:()=>{e.setValue(i,o)},end:()=>{e.setValue(i,l)}}}function K9e(e,t,r,i){if(!e.hasValue(i)||!(i in r))return;let n=e.getValue(i),s=t?new ge().fromArray(t[i]):n.clone(),a=new ge().fromArray(r[i]);if(!s.equals(a))return{update:o=>{n.lerpVectors(s,a,o)},start:()=>{n.copy(s)},end:()=>{n.copy(a)}}}function Q9e(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=e.getValue(i),a=t?t[i]:void 0,o=r[i],l=a?rP(new V,a,n):s.clone(),c=rP(new V,o,n);if(!l.equals(c))return{update:u=>{s.lerpVectors(l,c,u)},start:()=>{s.copy(l)},end:()=>{s.copy(c)}}}function Z9e(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:void 0,a=r[i],o=e.getValue(i),l=s?typeof s=="string"?n.getColor(s).clone():new Zt().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new Zt().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return{update:d=>{e.getValue(i)!==u&&e.setValue(i,u),u.lerpColors(l,c,d)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function J9e(e,t,r,i,n){if(!e.hasValue(i)||!(i in r))return;let s=t?t[i]:void 0,a=r[i],o=e.getValue(i),l=s?typeof s=="string"?n.getColor(s).clone():new Zt().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?n.getColor(a).clone():new xa(a.r,a.g,a.b,a.a);if(l.equals(c))return;let u=o.clone();return{update:d=>{e.getValue(i)!==u&&e.setValue(i,u),u.lerpColors(l,c,d)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function e7e(e,t,r,i="steps"){if(!e.hasValue(i)||!(i in r))return;let n=[],s=e.getValue(i),a=t?t[i]:s,o=r[i];return gB(a,o)||n.push({update:l=>{let c=[...s];for(let u=0;u<s.length;++u){let d=a[u],f=o[u];c[u]=Ct.lerp(d,f,l)}e.setValue(i,c)},start:()=>{e.setValue(i,a)},end:()=>{e.setValue(i,o)}}),n.length?n:void 0}function t7e(e,t,r,i="colors"){if(!e.hasValue(i)||!(i in r))return;let n=[],s=e.getValue(i),a=t?t[i]:s.map(l=>l.toArray()),o=r[i];for(let l=0;l<s.length;++l){let c=[...a[l]],u=[...o[l]];MM.isEqual(c,u)||n.push({update:d=>{s[l].fromArray(MM.lerp(c,u,d))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(u)}})}return n.length?n:void 0}function r7e(e,t,r,i="texture"){if(!e.hasValue(i)||!(i in r))return;let n=e.getNode("rotation"),s=t?.[i]?.rotation??0,a=r[i]?.rotation??0;if(n&&s!==a)return{update:x=>{n.value=Ct.lerp(s,a,x)*Ct.DEG2RAD},start:()=>{n.value=s*Ct.DEG2RAD},end:()=>{n.value=a*Ct.DEG2RAD}};let o=e.getNode("mat");if(!o)return;let l=t?t[i]:o,c=r[i],u=[...l.repeat],d=[...l.offset],f=[...c.repeat],m=[...c.offset],v=l.rotation??0,y=c.rotation??0;if(!vh.isEqual(u,f)||!vh.isEqual(d,m)||v!==y)return{update:x=>{o.repeat=vh.lerp(u,f,x),o.offset=vh.lerp(d,m,x),o.rotation=Ct.lerp(v,y,x),o.updateMatrix()},start:()=>{o.repeat=[...u],o.offset=[...d],o.rotation=v,o.updateMatrix()},end:()=>{o.repeat=[...f],o.offset=[...m],o.rotation=y,o.updateMatrix()}}}function i7e(e,t){return{update:()=>{e.transparent=t}}}var pI=new V,_$=new Es;function n7e(e,t,r,i,n){let s=[],a,o,l,c,u,d,f,m;if(e instanceof Qs?(a=iP("position",e,t,r,n),a&&s.push(a),l=ua("rotation",e,t,r,n),l&&s.push(l),c=iP("shear",e,t,r,n),c&&s.push(c)):(m={slide:t.pathSnapping?.slide??e.updatedPathSnapping?.slide??e.dataPatched.pathSnapping?.slide??0,offset:t.pathSnapping?.offset??e.updatedPathSnapping?.offset??e.dataPatched.pathSnapping?.offset??0},d=ua("slide",m,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping,n),d&&s.push(d),f=ua("offset",m,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,r.pathSnapping??e.dataPatched.pathSnapping,n),f&&s.push(f),!d&&!f&&(a=x$("position",e,t,r,n),a&&s.push(a),o=x$("scale",e,t,r,n),o&&s.push(o),l=s7e(e,t,r,i,n),l&&s.push(l),u=V9e("hiddenMatrix",e,t,r),u&&s.push(u))),a||o||l||u||d||f){let v=e instanceof Qs?()=>{e.updateWorldMatrix(!0,!1,!0),e.resetBBoxNeedsUpdate()}:()=>{e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),e.parent?.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),yc(e)&&xh(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,m))};s.push({update:v,start:v,end:v})}return s}function s7e(e,t,r,i,n){let s=t?.rotation?t.rotation.map(u=>(typeof u=="string"?Number(n.getVariable(u)??0):u)*Ct.DEG2RAD):void 0,a=r.rotation?.map(u=>(typeof u=="string"?Number(n.getVariable(u)??0):u)*Ct.DEG2RAD);if(!a)return;let o=s?new V().fromArray(s):new V().setFromEuler(e.rotation),l=new V().fromArray(a);if(o.equals(l))return;let c=pI.subVectors(l,o);if(i&&c.toArray().every(u=>Math.abs(u)<2*Math.PI)){let u=new ar().setFromEuler(_$.setFromVector3(o)),d=new ar().setFromEuler(_$.setFromVector3(l));return{update:f=>{F9e(u,d,e.quaternion,f)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}else return{update:u=>{pI.lerpVectors(o,l,u),e.rotation.setFromVector3(pI)},start:()=>{e.rotation.setFromVector3(o)},end:()=>{e.rotation.setFromVector3(l)}}}function a7e(e,t,r,i){let n=[];if(!("cloner"in r)||!e.cloner)return n;let s=e.cloner,a="cloner"in t?t.cloner:{},o=r.cloner;dse.forEach(m=>{let v;m==="count"?v=ua("count",s.parameters,a,o,i,!0):v=rm(m,s.parameters,a??{},o,i),v&&n.push(v)});let l=o7e(s,a,o,i);l?.length&&n.push(...l);let c=l7e(s,a,o,i);c?.length&&n.push(...c);let u=c7e(s,a,o,i);u?.length&&n.push(...u);let d=u7e(s,a,o,i);d?.length&&n.push(...d);let f=d7e(s,a,o,i);return f?.length&&n.push(...f),n.length&&n.push({update:()=>{s.update()}}),n}function o7e(e,t,r,i){if(e.parameters.type!=="radial")return;let n=t.radial,s=r.radial;if(!s)return;let a=e.parameters.radial,o=[];return hse.forEach(l=>{let c=rm(l,a,n??{},s,i);c&&o.push(c)}),o}function l7e(e,t,r,i){if(e.parameters.type!=="linear")return;let n=t.linear,s=r.linear;if(!s)return;let a=[],o=e.parameters.linear;return fse.forEach(l=>{let c=rm(l,o,n??{},s,i);c&&a.push(c)}),a}function c7e(e,t,r,i){if(e.parameters.type!=="grid")return;let n=t.grid,s=r.grid;if(!s)return;let a=[],o=e.parameters.grid;return pse.forEach(l=>{let c;l==="count"?c=gF(l,o,n??{},s,i,!0):c=rm(l,o,n??{},s,i),c&&a.push(c)}),a}function u7e(e,t,r,i){if(e.parameters.type!=="toObject")return;let n=t.toObject,s=r.toObject;if(!s)return;let a=[],o=e.parameters.toObject;return mse.forEach(l=>{let c;l==="count"?c=ua(l,o,n??{},s,i,!0):c=rm(l,o,n??{},s,i),c&&a.push(c)}),a}function d7e(e,t,r,i){if(!e.parameters.randomness)return;let n=t.randomnessObject,s=r.randomnessObject;if(!s)return;let a=[],o=e.parameters.randomnessObject;return gse.forEach(l=>{let c=rm(l,o,n??{},s,i);c&&a.push(c)}),a}function h7e(e,t){return{update:()=>{e instanceof Gs&&(e.fill.enabled=t)}}}function f7e(e,t){return{update:()=>{e instanceof Gs&&(e.stroke.enabled=t)}}}function p7e(e,t){return{update:()=>{e instanceof Gs&&(e.dropShadow.enabled=t)}}}function m7e(e,t){return{update:()=>{e instanceof Gs&&(e.innerShadow.enabled=t)}}}function g7e(e,t){return{update:()=>{e instanceof Gs&&(e.backgroundBlur.enabled=t)}}}function v7e(e,t){return{update:()=>{e instanceof Gs&&(e.layerBlur.enabled=t)}}}function y7e(e,t,r,i,n){let s=[],a,o,l,c,u,d,f,m,v,y,x,w,_,S,P;if("width"in e&&(a=ua("width",e,t,r,n),a&&s.push(a)),"height"in e&&(o=ua("height",e,t,r,n),o&&s.push(o)),e instanceof Gs||e instanceof Vu){let M={...t.fill},C={...r.fill};M.enabled!==void 0&&M.enabled!==C.enabled&&(s.push(h7e(e,!0)),M.enabled||Object.assign(M,{enabled:!0,color:{...M.color,a:0}}),C.enabled||Object.assign(C,{enabled:!0,color:{...C.color,a:0}})),l=cC("color",e.fill,M,C,n),l&&s.push(l)}if(e instanceof Gs){let M={...t.stroke},C={...r.stroke};(M.enabled||C.enabled)&&(s.push(f7e(e,!0)),M.enabled||Object.assign(M,{enabled:!0,color:{...M.color,a:0}}),C.enabled||Object.assign(C,{enabled:!0,color:{...C.color,a:0}})),c=cC("color",e.stroke,M,C,n),c&&s.push(c),u=ua("thickness",e.stroke,M,C,n),u&&s.push(u)}if(e instanceof Gs){let M={...t.dropShadow},C={...r.dropShadow};(M.enabled||C.enabled)&&(s.push(p7e(e,!0)),M.enabled||Object.assign(M,{enabled:!0,color:{...M.color,a:0}}),C.enabled||Object.assign(C,{enabled:!0,color:{...C.color,a:0}})),d=cC("color",e.dropShadow,M,C,n),d&&s.push(d),f=ua("blurRadius",e.dropShadow,M,C,n),f&&s.push(f),v=ua("spread",e.dropShadow,M,C,n),v&&s.push(v),m=iP("offset",e.dropShadow,M,C,n),m&&s.push(m)}if(e instanceof Gs){let M={...t.innerShadow},C={...r.innerShadow};(M.enabled||C.enabled)&&(s.push(m7e(e,!0)),M.enabled||Object.assign(M,{enabled:!0,color:{...M.color,a:0}}),C.enabled||Object.assign(C,{enabled:!0,color:{...C.color,a:0}})),y=cC("color",e.innerShadow,M,C,n),y&&s.push(y),x=ua("blurRadius",e.innerShadow,M,C,n),x&&s.push(x),_=ua("spread",e.innerShadow,M,C,n),_&&s.push(_),w=iP("offset",e.innerShadow,M,C,n),w&&s.push(w)}if(e instanceof Gs||e instanceof Vu){let M={...t.backgroundBlur},C={...r.backgroundBlur};(M.enabled||C.enabled)&&(s.push(g7e(e,!0)),M.enabled||Object.assign(M,{enabled:!0,radius:0}),C.enabled||Object.assign(C,{enabled:!0,radius:0})),S=ua("radius",e.backgroundBlur,M,C,n),S&&s.push(S)}if(e instanceof Gs){let M={...t.layerBlur},C={...r.layerBlur};(M.enabled||C.enabled)&&(s.push(v7e(e,!0)),M.enabled||Object.assign(M,{enabled:!0,radius:0}),C.enabled||Object.assign(C,{enabled:!0,radius:0})),P=ua("radius",e.layerBlur,M,C,n),P&&s.push(P)}if(e instanceof Vu||e instanceof q_){let M=gF("cornerRadius",e,t,r,n);M&&s.push(M)}return s}function S$(e,t,r,i,n){let s=[];return e.data.visible&&s.push(...n7e(e,t,r,n,i)),e instanceof Qs?s.push(...y7e(e,t,r,n,i)):(e.data.visible&&s.push(...a7e(e,t,r,i)),yc(e)?(e instanceof os&&e.data.visible&&s.push(...q9e(e,t,r,i)),e.data.visible&&s.push(...X9e(e,t,r,i))):nFe(e)?e.data.visible&&s.push(...Y9e(e,t,r,i)):iFe(e)&&s.push(...H9e(e,t,r,i))),s.length?{update:a=>{s.forEach(o=>o.update(a))},start:a=>{s.forEach(o=>o.start?.(a))},end:a=>{s.forEach(o=>o.end?.(a))}}:void 0}var E$=new V;function vF(e,t,r=!1){let i=[],n=s=>{let a=s.data;delete s.states,s.currentState=null,s.reversibleToState=null,s.currentTransitionEvent=null;for(let o of a.states){let l={...o.data};s.states||(s.states={}),s.states[o.id]=pg.patch(a,l)}C$(e.scene,s,null,t,a.events.find(o=>o.data.type==="Follow"||o.data.type==="LookAt")!==void 0),A$(e)};e.scene.traverse2D(n),e.traverseChildren(s=>{if(r&&(s.rigidBody?.setTranslation(s.position0,!0),s.rigidBody?.setRotation(s.rotation0,!0),s.rigidBody?.setLinvel(E$,!0),s.rigidBody?.setAngvel(E$,!0)),!Xr.is(s))return;let a=s.uuid,o=s.data;if(delete s.states,s.uuid===rb)return;let l=!1;i.some(c=>e.scene.find(a)?.isDescendantOf(c))?l=!0:o.physics?.fusedBody===!0&&o.physics.rigidBody==="dynamic"&&i.push(a),s.data=o,s.currentState=null,s.reversibleToState=null,s.currentTransitionEvent=null;for(let c of o.states){let u={...c.data};e.data.globalPhysics.usePhysics===!0&&o.physics&&(o.physics.rigidBody==="dynamic"||l)&&(c.data.position!==void 0&&delete u.position,c.data.rotation!==void 0&&delete u.rotation,c.data.hiddenMatrix!==void 0&&delete u.hiddenMatrix),s.states||(s.states={}),s.states[c.id]=dg.patch(o,u)}C$(e.scene,s,null,t,o.events.find(c=>c.data.type==="Follow"||c.data.type==="LookAt")!==void 0),s instanceof ja&&s.frame&&(s.frame.traverse(c=>n(c)),s.uiCanvas?.applySize())}),A$(e),e.frame&&(e.frame.traverse(s=>n(s)),e.uiCanvas?.applySize())}function A$(e){e.traverseEntity(t=>{for(let r of t.data.events){let i=[];switch(r.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":i.push(...r.data.actions);break;case"GameControl":for(let n of Object.values(r.data.gameActions))i.push(...n);break;case"DragDrop":i.push(...r.data.dragDropActions.drag,...r.data.dragDropActions.drop);break;case"Conditional":i.push(...r.data.inActions,...r.data.outActions);break}for(let n of i)if(n.data.type==="Create"&&n.data.hideBase==="Yes"){let s=e.scene.find(n.data.object);s&&(s.visible=!1)}}})}function C$(e,t,r,i,n=!1){if(t instanceof os&&!(t instanceof Kg)&&t.removeInteractionGeometry(i),t instanceof Qs?t.changeSelectedState(r,{shared:i},n):t.changeSelectedState(r,{scene:e,shared:i},n),t instanceof os&&t.updateGeometryGroupsIfNeeded(),t instanceof Ba&&t.updateCameraState(t.dataPatched,{scene:e,shared:i}),!(t instanceof Qs)){if(t.cloner)for(let s of t.cloner.children)s.playModeVisible=void 0;t.updateVisible()}}function Hoe(e){let t;if(e.easing===5){let{control1:r,control2:i}=e;t=`cubicBezier(
			${r[0]}, ${r[1]}, ${i[0]}, ${i[1]}
		)`}else if(e.easing===6){let{mass:r,stiffness:i,damping:n,velocity:s}=e;t=`spring( ${r}, ${i}, ${n}, ${s} )`}else{let r;switch(e.easing){case 0:r=Yf.linear;break;case 1:r=Yf.ease;break;case 2:r=Yf.easeIn;break;case 3:r=Yf.easeOut;break;case 4:r=Yf.easeInOut;break;default:r=Yf.linear}let[i,n,s,a]=r;t=`cubicBezier( ${i}, ${n}, ${s}, ${a} )`}return{duration:Math.max(e.duration,1e-4),easing:t}}function A5(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var x7e={type:"beginState"},b7e={type:"completeState",isfromEntity:!1},C5=class{constructor(e,t,r,i,n,s){if(this.object=e,this.data=i,this.sharedAssets=n,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.requestRender()),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let a=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"beginState",state:a}),this.object instanceof Qs||this.object.traverseEntity(o=>{o!==this.object&&o instanceof Ba&&o.dispatchEvent(x7e)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let a=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"completeState",state:a}),this.object instanceof Qs||this.object.traverseEntity(o=>{o!==this.object&&o instanceof Ba&&o.dispatchEvent(b7e)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=S$(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let a=vT(this.object,this.object.currentState===r?this.object.prevState:this.object.currentState);if(!a)throw new Error("Missing property");this.from=a}else{let a=vT(this.object,t);if(!a)throw new Error("Missing property");this.from=a}if(r===void 0)throw new Error("Missing property");{let a=vT(this.object,r);if(!a)throw new Error("Missing property");this.to=a}this.useCurrentState=t===void 0||r===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...A5(i),...Hoe(i),change:this.onChange},this.callback=S$(this.object,this.from?.data??{},r===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Goe=class extends wa{constructor(e,t,r,i,n){if(super(),this.eventType=e,this.data=t,this.page=r,this.shared=i,this.condition=n,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.hasPlayedOnce=!1,this.onTimelineChangeComplete=()=>{this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&(this.timeline?.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!1,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let s=this.page.scene.find(t.object)??this.page.uiCanvas?.find(t.object)??this.page.scene.find2DInUIObjects(t.object);if(!s)throw new Error("Missing property");if(!s.states)throw new Error("Missing property");if(this.object=s,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){return this.timeline?.paused===!1}get changeBegan(){return this.tweens.some(e=>e.changeBegan)??!1}init(){this.initialCurrentState=vT(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.data.runMode==="Toggle"&&Eq(this.eventType)?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,needsRebuild:t=!1,isRebuild:r=!1}={}){try{let i=A5(this.data.tweens[0].data);r&&typeof i.loop=="number"&&i.loop--,this.timeline?.pause(),this.timeline=r2.timeline({autoplay:!1,...i,...i.loop===!0||i.loop>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let n=this.tweens.findIndex(s=>s?.changeBegan);if(t===!0&&(this.timelineNeedsRebuild=!0),e){let s=n===-1?0:n;for(let a=s;a<this.data.tweens.length-1;a++){let o=this.data.tweens[a],l=this.data.tweens[a+1],c;a===s&&(this.object.wasMovedByUser===!0||this.object.previousAction?.changeBegan===!0)?(c=void 0,this.object instanceof Ba&&(this.object.wasMovedByUser=!1)):c=o.data.state===void 0?this.currentState:o.data.state;let u=new C5(this.object,c,l.data.state===void 0?this.currentState:l.data.state,l.data,this.shared,this.data.allowSlerp??!1);n!==-1&&a===s&&Object.assign(u.params,{startOnceDelay:0}),this.tweens[a]=u,this.timeline.add(u.params,this.timeline.duration+(a===s?i.delay:0))}this.timeline.duration+=i.endDelay}else{let s=n===-1?this.data.tweens.length-1:n+1;for(let a=s;a>0;a--){let o=this.data.tweens[a],l=this.data.tweens[a-1],c;a===s&&(this.object.wasMovedByUser===!0||this.object.previousAction?.changeBegan===!0)?(c=void 0,this.object instanceof Ba&&(this.object.wasMovedByUser=!1)):c=o.data.state===void 0?this.currentState:o.data.state;let u=new C5(this.object,c,l.data.state===void 0?this.currentState:l.data.state,o.data,this.shared,this.data.allowSlerp??!1);n!==-1&&a===s&&Object.assign(u.params,{startOnceDelay:0}),this.tweens[a-1]=u,this.timeline.add(u.params,this.timeline.duration+(a===s?i.endDelay:0))}this.timeline.duration+=i.delay}}catch(i){i instanceof Error&&console.error(i.message)}this.object.previousAction?.playing===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(en(this.shared,this.condition)===!1||Eq(this.eventType)&&this.data.runMode==="Once"&&this.hasPlayedOnce||(this.hasPlayedOnce=!0,this.playing))return!1;clearTimeout(this.timeoutId);let e=A5(this.data.tweens[0].data).pingPongDelayCorrection;r2({targets:{},duration:this.startOnceDelay+e,easing:"linear",complete:()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&console.error(t.message)}}})}pause(){this.timeline?.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object instanceof Qs?this.object.changeSelectedState(e,{shared:this.shared}):this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.shared}),this.object.currentState=e}seek(e){if(en(this.shared,this.condition)===!1)return!1;this.timeline===void 0&&this.buildTimeline(),this.timeline?.seek(e*this.timeline.duration,!0)}toggle(e){if(en(this.shared,this.condition)===!1)return!1;clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?(this.timeline?.pause(),this.buildTimeline({isForward:this.toggleIsForward,needsRebuild:!0}),this.timeline.play()):r2({targets:{},duration:this.startOnceDelay,easing:"linear",complete:()=>{this.timeline?.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()}})}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function vT(e,t){let r,i;if(typeof t=="string"?(r=t,i=e.states?.[r]):t===null&&(r=null,i=e.data),!(r===void 0||i===void 0))return{id:r,data:i}}var w7e={type:"beginState"},T$={type:"completeState",isfromEntity:!1},M$={type:"requestRender"},Woe=class extends wa{constructor(e,t,r,i){super(),this.data=e,this.page=t,this.shared=r,this.condition=i,this.toggleIsForward=!1,this.posStart=new V,this.posEnd=new V,this.qStart=new ar,this.qEnd=new ar,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t=this.page.scene.find(this.data.targetCamera);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");let r={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=r2({targets:r,t:1,...Hoe(this.data),update:()=>{r.t===0&&(this.data.runMode==="Toggle"&&!this.toggleIsForward?this.fromCamera&&(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(t.position),this.qEnd.copy(t.quaternion),this.zoomEnd=t.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(t.uuid)),this.page.activeCamera.dispatchEvent(w7e));let i=this.page.activeCamera;i.position.lerpVectors(this.posStart,this.posEnd,r.t),i.quaternion.slerpQuaternions(this.qStart,this.qEnd,r.t),i.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*r.t,i.wasMovedBySwitchCameraAction=!0,i.updateMatrix(),i.updateMatrixWorld(),i.updateProjectionMatrix(),i.dispatchEvent(M$),r.t===1&&i.dispatchEvent(T$)}})}switchCamera(e){let t=this.page.activeCamera,r=this.page.scene.find(e);if(!r||!r.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(r),t.dispatchEvent({type:"cameraChange",camera:r})}play(){if(en(this.shared,this.condition)===!1)return!1;if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{delete this.timeoutId,this.data.animate?(this.buildAnimation(),this.animation?.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){this.animation?.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){if(en(this.shared,this.condition)===!1)return!1;if(window.clearTimeout(this.timeoutId),delete this.timeoutId,e!==this.toggleIsForward)try{this.playing?(this.animation?.pause(),this.toggleIsForward=e??!this.toggleIsForward,this.buildAnimation(!0),this.animation?.play()):this.timeoutId=window.setTimeout(()=>{this.toggleIsForward=e??!this.toggleIsForward,this.data.animate?(this.animation?.pause(),this.buildAnimation(),this.animation?.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.fromCamera&&this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(T$),this.page.activeCamera.dispatchEvent(M$))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}};function qoe(e){let t=e?.tracks.filter(r=>r.ValueTypeName==="vector"||r.ValueTypeName==="quaternion").map(r=>r.times.length);if(t?.length){let r=GIe(t);return r&&r>2?r:2}return 2}var Yoe=class extends wa{constructor(e,t,r,i,n){super(),this.data=e,this.page=t,this.animationControls=r,this.shared=i,this.condition=n,this.startOnceDelay=0,this.toggleIsForward=!1;let s=e.object,a=t.scene.find(e.object);a&&Array.isArray(a.identity)&&(s=a.identity[0]),this.data={...e,object:s};let o=this.animationControls.clipIdToAction[e.clipId+"/"+s];if(this.duration=o?.getClip()?.duration??1,this.data.crop2){let l=qoe(o?.getClip());this.leftFrameTime=this.data.crop2[0]/(l-1)*this.duration,this.rightFrameTime=this.data.crop2[1]/(l-1)*this.duration}else{let l=o?.getClip()?.tracks[0]?.times.length;l&&l>1?(this.leftFrameTime=this.data.crop[0]/l*this.duration,this.rightFrameTime=this.data.crop[1]/l*this.duration):(this.leftFrameTime=0,this.rightFrameTime=this.duration)}this.startOnceDelay=e.delay}get playing(){return this.threeAnimAction?.isRunning()??!1}play(e=!1){if(en(this.shared,this.condition)===!1)return!1;window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([r,i])=>{let n=r.split("/")[1];this.threeAnimAction!==i&&n===t&&i.isRunning()&&(e?i.fadeOut(.2):i.stop())}),e&&this.threeAnimAction?.fadeIn(.2)},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){this.threeAnimAction?.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=Ct.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e,t=!1){if(en(this.shared,this.condition)===!1)return!1;this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let r=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([i,n])=>{let s=i.split("/")[1];this.threeAnimAction!==n&&s===r&&n.isRunning()&&(t?n.fadeOut(.2):n.stop())}),t&&this.threeAnimAction?.fadeIn(.2)}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){let e=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object]?.getClip();e&&(e.duration=this.duration),this.pause()}},Xoe=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.eventManager=r,this.shared=i,this.condition=n,this.timeOutId=-1,this.scene=t.scene}dispatch(){if(en(this.shared,this.condition)===!1)return!1;this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(t=>t.uuid!==this.data.target||t.data.uiScene))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.traverseVisibleEntity(t=>{t.type==="ParticleSystem"&&(t.sleep(),t.wakeUp(),t.data.autoPlay?t.start():t.stop())}),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),vF(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}},$oe=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.evaluatedCondition=!1}checkConditions(){this.evaluatedCondition=en(this.shared,this.condition)}dispatch(){if(this.evaluatedCondition===!1)return!1;let e=this.shared.getVariable(this.data.variableId),t=Qse(this.data.expression,this.shared,ga.typeOfVariable(e));t!==void 0&&this.shared.updateVariable(this.data.variableId,typeof t=="string"?{textValue:t}:t)}dispose(){}},Koe=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i,this.timeoutId=null}dispatchInner(){if(en(this.shared,this.condition)===!1)return!1;let e=this.shared.getDynamicVariablePlayState(this.data.variableId);if(this.data.mode==="PlayPause")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,e==="Playing"?"Paused":"Playing");else if(this.data.mode==="Play"&&e!=="Playing")this.shared.getDynamicVariableToggleIsForward(this.data.variableId)===void 0&&this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!0),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing");else if(this.data.mode==="Stop"&&e!=="Stopped")this.shared.setDynamicVariablePlayState(this.data.variableId,"Stopped");else if(this.data.mode==="Pause"&&e!=="Paused")this.shared.setDynamicVariablePlayState(this.data.variableId,"Paused");else if(this.data.mode==="Restart")this.shared.setDynamicVariablePlayState(this.data.variableId,"Restarted");else if(this.data.mode==="Toggle"){let t=this.shared.getDynamicVariableToggleIsForward(this.data.variableId);e==="Playing"?this.shared.setDynamicVariableToggleIsForward(this.data.variableId,t===void 0?!1:!t):(this.shared.setDynamicVariableToggleIsForward(this.data.variableId,!t),this.shared.setDynamicVariablePlayState(this.data.variableId,"Playing"))}}dispatch(){let e=this.data.delay,t=this.shared.getDynamicVariablePlayState(this.data.variableId);this.data.mode==="PlayPause"&&t==="Playing"&&(e=this.data.pauseDelay),e!==0?(this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.timeoutId=null,this.dispatchInner()},e)):this.dispatchInner()}dispose(){this.timeoutId&&window.clearTimeout(this.timeoutId)}},_7e=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i}dispatch(){if(en(this.shared,this.condition)===!1)return!1;(this.data.target==="single"?this.data.variableId?[this.data.variableId]:[]:Object.keys(this.shared.getVariables())).forEach(e=>{this.shared.getVariable(e);let t=this.shared.data.variables.data(e)?.value;t!==void 0&&this.shared.updateVariable(e,t),this.shared.enableLocalStorageForPersistentVariables&&localStorage.removeItem(i5(e))})}dispose(){}},S7e=class{constructor(e,t,r,i){this.data=e,this.page=t,this.shared=r,this.condition=i}dispatch(){if(en(this.shared,this.condition)===!1)return!1;this.data.userAPIId&&this.shared.getUserAPI(this.data.userAPIId)?.callUserAPI(this.shared)}dispose(){}};function en(e,t){if(t===void 0)return!0;if(t.expression.length===0)return!1;let r=Qse(t.expression,e,"boolean");return t.negate?!r:!!r}function ds(e,t,r,i,n,s){let a={Audio:[],Video:[],Particles:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[],SetVariable:[],DynamicVariablePlay:[],ClearLocalStorage:[],UserAPI:[]},o=l=>({id:c,data:u})=>{try{u.type==="Audio"?Ma[e.type].includes("Audio")&&a.Audio.push(new Soe(c,u,s,i,l)):u.type==="Video"&&!(s instanceof Qs)?Ma[e.type].includes("Video")&&a.Video.push(new Zoe(c,u,s,i,l)):u.type==="Particles"?Ma[e.type].includes("Particles")&&a.Particles.push(new Eoe(u,r,i,l)):u.type==="Link"?Ma[e.type].includes("Link")&&a.Link.push(new u9e(u,n.controlsManager,i,l)):u.type==="Create"?Ma[e.type].includes("Create")&&a.Create.push(new Joe(u,r,n.controlsManager,i,l)):u.type==="Destroy"?Ma[e.type].includes("Destroy")&&a.Destroy.push(new Aoe(u,r,n.controlsManager,i,l)):u.type==="Reset"?Ma[e.type].includes("Reset")&&a.Reset.push(new Coe(u,r,i,n,l)):u.type==="Transition"?Ma[e.type].includes("Transition")&&a.Transition.push(new Goe(e.type,u,r,i,l)):u.type==="SwitchCamera"?Ma[e.type].includes("SwitchCamera")&&a.SwitchCamera.push(new Woe(u,r,i,l)):u.type==="SceneTransition"?Ma[e.type].includes("SceneTransition")&&a.SceneTransition.push(new Xoe(u,r,n,i,l)):u.type==="Animation"?Ma[e.type].includes("Animation")&&a.Animation.push(new Yoe(u,r,n.animationControls,i,l)):u.type==="SetVariable"?Ma[e.type].includes("SetVariable")&&a.SetVariable.push(new $oe(u,r,i,l)):u.type==="DynamicVariablePlay"?Ma[e.type].includes("DynamicVariablePlay")&&a.DynamicVariablePlay.push(new Koe(u,r,i,l)):u.type==="Conditional"?Ma[e.type].includes("Conditional")&&(u.ifActions.forEach(o({expression:u.condition,negate:!1})),u.elseActions.forEach(o({expression:u.condition,negate:!0}))):u.type==="ClearLocalStorage"?Ma[e.type].includes("ClearLocalStorage")&&a.ClearLocalStorage.push(new _7e(u,r,i,l)):u.type==="UserAPI"&&Ma[e.type].includes("UserAPI")&&a.UserAPI.push(new S7e(u,r,i,l))}catch{}};return t.forEach(o()),a}function Xs(e){Object.values(e).forEach(t=>{t.forEach(r=>{(r instanceof Soe||r instanceof Zoe||r instanceof Eoe||r instanceof Yoe||r instanceof Goe||r instanceof Joe||r instanceof Aoe||r instanceof Woe||r instanceof Xoe||r instanceof Coe||r instanceof $oe||r instanceof Koe)&&r.dispose()})})}function E7e(e,t){let r;if("material"in e){let i=e.material;Array.isArray(i)?r=e.material[0].layers.find(n=>n.uuid===t):r=e.material.layers.find(n=>n.uuid===t)}if(r)return r.color.texture.image.img instanceof HTMLVideoElement?r.color.texture.image.img:void 0}var Qoe=new Map,i2=new Map,gp=class{constructor(e,t,r){this.data=t,this.delay=0,this.status="stopped";let{layerId:i,loop:n,volume:s,delay:a}=t;if(this.object=r,i===void 0)throw new Error("Missing property");let o=E7e(r,i);o&&(this.videoElement=o,this.videoElement.loop=n===1/0,B_&&(this.videoElement.autoplay=!0),s!==void 0&&(this.videoElement.volume=s)),a!==void 0&&(this.delay=a),i2.has(r.uuid)?i2.get(r.uuid).push(this):i2.set(r.uuid,[this]),Qoe.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let r=this.videoElement.play();r!==void 0&&r.then(i=>{}).catch(i=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}seek(e){return new Promise((t,r)=>{if(!this.videoElement)return r();let i=this.videoElement.duration;if(i>0){let n=e%i;this.videoElement.currentTime=n}this.videoElement.addEventListener("seeked",()=>t(),{once:!0})})}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},T5=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=Qoe.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=i2.get(e);!t?.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(r=>r[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(r=>r[this.data.interaction]()))}pauseAllVideos(){let e=[...i2.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(r=>{r[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Zoe=class{constructor(e,t,r,i,n){if(this.data=t,this.shared=i,this.condition=n,t.interaction==="play")this.interaction=new gp(e,t,r);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new T5(t);else throw new Error("Missing property")}dispatchBasic(){if(en(this.shared,this.condition)===!1)return!1;this.interaction instanceof gp?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){if(en(this.shared,this.condition)===!1)return!1;this.interaction instanceof gp?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},P$=(()=>{let e,t,r,i;function n(o){!e&&!D$()&&t?.sharedGameControlGlobals.createdObjects.length>0&&(e=requestAnimationFrame(s)),o&&(t=o,i=o.requestRender)}function s(o){let l=r?o-r:0,c=t.sharedGameControlGlobals.createdObjects,u=t.sharedGameControlGlobals.nCreatedPerAction,d=c.length,f=0;for(;f<d;){let m=c[f];m.userData.createdTime===void 0&&(m.userData.createdTime=o),m.userData.lifetime===void 0&&m.userData.quantity===void 0||m.userData.lifetime&&o-m.userData.createdTime<m.userData.lifetime||m.userData.quantity&&u[m.userData.actionId]<=m.userData.quantity?(m.userData.velocity&&(m.position.addScaledVector(m.userData.velocity,l/1e3),m.updateMatrix(),i()),f++):(u[m.userData.actionId]>m.userData.quantity&&u[m.userData.actionId]--,c.splice(f,1),m.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&m.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(m.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(m.rigidBody)):(m.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(v=>v.bvhGeometry!==void 0)),d--,i())}e=f>0?requestAnimationFrame(s):void 0,r=f>0?o:void 0}function a(){D$()?e&&(cancelAnimationFrame(e),e=void 0,r=void 0):n()}return typeof document<"u"&&document.addEventListener("visibilitychange",a),n})();function D$(){return!!document&&document.hidden}var N$=new ar,A7e=new V,C7e=new V,Joe=class{constructor(e,t,r,i,n){this.data=e,this.page=t,this.controlsManager=r,this.shared=i,this.condition=n,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=Ct.generateUUID(),this.dispatch=()=>{if(en(this.shared,this.condition)===!1)return!1;this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{if(en(this.shared,this.condition)===!1)return!1;this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=lOe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let a=new va(this.object);if(a.playModeVisible=!0,a.expand(),this.data.coordinateSystem!=="world"){let l=this.data.coordinateSystem,c=this.page.scene.find(l);c&&(c.updateMatrixWorldSVD(),a.hiddenMatrix.copy(c.matrixWorldRigid))}a.scale.copy(this.object.scale),a.position.fromArray(this.data.position),a.rotation.fromArray(this.data.rotation),a.updateMatrix(),this.page.add(a);let o=this.controlsManager.sharedGameControlGlobals;o.createdObjects.push(a),o.nCreatedPerAction[this.uniqueId]===void 0?o.nCreatedPerAction[this.uniqueId]=1:o.nCreatedPerAction[this.uniqueId]++,a.updateWorldMatrix(!0,!0),a.traverseObject(this.traverseObjectCB),P$(),this.controlsManager.requestRender()},this.traverseObjectCB=a=>{a.hasNonUniformScale&&a.updateMatrixWorldSVD();let o;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(a instanceof Ul)if(a.objectForSample){if(a.objectForSample.dataPatched.physics.fusedBody)return;o=a.object}else return a.object.dataPatched.physics.fusedBody===!0&&a.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(a instanceof va)o=a.object;else if(o=a,o.dataPatched.cloner?.hideBase)return!0}else{if(a instanceof Ul)return;a instanceof va?o=a.object:o=a}this.data.destroy==="Time"?a.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(a.userData.quantity=this.data.destroyAfterQuantity,a.userData.actionId=this.uniqueId);let l=new V().fromArray(this.data.velocity),c=o.dataPatched;if(!(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(a,o,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&(a.rigidBody?.collider(0).setActiveEvents(1),a.userData.hasCollisionDestroy=!0),a.matrixWorld.decompose(A7e,N$,C7e),l.applyQuaternion(N$),this.data.velocity.some(u=>u!==0)&&this.data.dynamic&&a.rigidBody?.setLinvel(l.divideScalar(this.controlsManager.pixelsPerMeter),!0)):("geometry"in a.object&&this.controlsManager.addBoundsTree(a),this.data.velocity.some(u=>u!==0)&&this.data.dynamic&&(a.userData.velocity=l)),o.dataPatched.physics?.fusedBody===!0))return!0};let s=this.page.scene.find(this.data.object);if(!s)throw new Error("Missing Property");if(this.object=s,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");P$(r)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},ele=200,mI=.02,gI=.3,T7e=65;new V;var k$=new V,R$=new V,M7e=new V,Qa=new V,xo=new V,jf=new V,vI=new ot,I$=new ot,P7e=new ot;new ot;var dc=new ar,Gd=new ar,xu=new Es(0,0,0,"YXZ"),D7e=new V(1,0,0),hc=new V(0,1,0),N7e=new V(0,0,1),O$=new V(1,1,1);new Oo;var k7e=1,R7e=.025,I7e=16e-6,j$=12,O7e=20,zs=new Wl,Tl=new Wn,j7e={type:"requestRender"},L7e={type:"updateMatrix"},L$=Math.PI/6,M5=class extends wa{constructor(e,t,r,i,n,s,a,o,l){super(),this.object=e,this.domElement=t,this.data=r,this.gloabalPhysics=i,this.controlsManager=n,this.cameraFollow=s,this.camera=a,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new ot,this.target0=new V,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=ele,this.euler0=new Es(0,0,0,"YXZ"),this.position0Cam=new V,this.quat0Cam=new ar,this.scale0Cam=new V,this.hiddenMatrix0Cam=new ot,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new Wl(new V(0,-40,0),new V(0,40,0)),matrix:new ot,position:new V,rotation:new ar},this.euler=new Es(0,0,0,"YXZ"),this.eulerDelta=new V,this.lastPosition=new V,this.lastCameraQuaternion=new ar,this.lastCameraPosition=new V,this.PI_2=Math.PI/2,this.prevMouse=new ge,this.velocityTarget=new V,this.velocity=new V,this.directionXZ=new V,this.rotVelocityStick=new V,this.rotVelocityTarget=new V,this.rotVelocity=new V,this.rotDirection=new V,this.nonColliderRotOffset=new ot,this.nonColliderPosOffset=new ot,this.firstPointerId=-1,this.rot=new V,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new ot,this.objectToTarget=new V,this.objectToTarget0=new V,this.objectToCamXZ=new V,this.objectToCamXZ0=new V,this.targetToCamera=new V,this.targetToCamera0=new V,this.cameraPolarAxis0=new V,this.targetPos=new V,this.targetQuat=new ar,this.lerpFactorPos=new V().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new ar,this.objXZQuatInv=new ar,this.objXZRotMat=new ot,this.isFirstPerson=!1,this.didHit=!1,this.groundVelocity=new V,this.pushedVelocity=new V,this.groundYRotation=0,this.objectRealQuat=new ar,this.colliderWorldQuat=new ar,this.groundNormal=new V,this.groundTilt=new ar,this.groundTiltInv=new ar,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new V,this.quaternion=new ar,this.scale=new V,this.initialAction=!0,this.onPointerDown=v=>{!(v.target===this.domElement||v.target instanceof HTMLElement&&v.target.tagName==="SPLINE-VIEWER"&&v.target.shadowRoot?.contains(this.domElement))||this.firstPointerId!==-1||(this.firstPointerId=v.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!nl&&!cq&&this.domElement.requestPointerLock(),this.prevMouse.set(v.clientX,v.clientY))},this.onPointerUp=v=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),v.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=v=>{if(v.pointerId!==this.firstPointerId)return;let y=v.clientX-this.prevMouse.x,x=v.clientY-this.prevMouse.y;this.prevMouse.set(v.clientX,v.clientY),v.pointerType==="mouse"&&this.rotBy!=="keys"&&(cq&&_Oe<15.5&&!nl?(this.eulerDelta.y=-y*this.mouseOrbitSensitivity,this.eulerDelta.x=-x*this.mouseOrbitSensitivity):(this.eulerDelta.y=-v.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-v.movementY*this.mouseOrbitSensitivity)),v.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-y*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-x*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=v=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?M5.isLocked=!0:M5.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document?.hidden)for(let v in this.movementState)this.movementState[v]=0},this.onKeyDown=v=>{!(v.target instanceof HTMLInputElement)&&(v.code==="ArrowLeft"||v.code==="ArrowUp"||v.code==="ArrowRight"||v.code==="ArrowDown"||v.code==="Space")&&v.preventDefault();for(let y of this.keyAssignments)if(v.key.toUpperCase()===y[1]||v.key===y[1]){this.movementState[y[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=v=>{for(let y of this.keyAssignments)if(v.key.toUpperCase()===y[1]||v.key===y[1]||v.code.slice(3,v.code.length).toUpperCase()===y[1]){this.movementState[y[0]]=0;break}},this.copyVRGamePadValues=(v,y)=>{for(let x=2;x<4;x++){let w=v.axes[x];y===0?x===2?this.movementState.movePosX=w:this.movementState.movePosZ=w:(v.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,x===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(w)>=.3&&(this.vrEulerYOffset+=w<0?1:-1),this.movementState.rotPosY=w):this.moveMode==="fly"&&(this.movementState.moveNegY=w))}},this.sharedGameControlGlobals=n.sharedGameControlGlobals,e===a&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),u=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,u,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy(this.camera?.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let v=new V(0,0,-1).applyQuaternion(this.camera.quaternion),y=new V().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(y),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let x,w;Math.abs(v.y)<1e-6?(y.y=0,v.y=0,w=y.projectOnVector(v)):y.y/v.y>0?w=v.multiplyScalar(y.y/v.y):w=v.multiplyScalar(y.length()),this.targetToCamera0.copy(w).negate(),x=this.camera.position.clone().add(w),this.objectToTarget0.subVectors(x,this.position);let _=new Es().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-_.x,_.x=0,_.z=0,_.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(_)}if(this.object instanceof Ba&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=r.rotByTouch??"joystick",this.rotBy=r.rotBy??"keys",this.rotationMode=r.rotationMode??"normal",this.moveMode=r.moveMode??"walk",this.collisionEnabled=r.collisionEnabled,this.speedTranslate=(r.speedTranslate??250)*k7e,this.speedOrbit=(r.speedRotate??100)*R7e,this.mouseOrbitSensitivity=(r.speedRotate??100)*I7e,this.keyAssignments=r.keyAssignments.map(v=>{let y=[v[0],v[1]];return y[1]==="▲"?y[1]="ArrowUp":y[1]==="◀"?y[1]="ArrowLeft":y[1]==="▼"?y[1]="ArrowDown":y[1]==="▶"?y[1]="ArrowRight":y[1]==="⇧"?y[1]="Shift":y[1]==="↵"?y[1]="Enter":y[1]==="Space"?y[1]=" ":y[1]==="⌘"?y[1]="Meta":y[1]==="Ctrl"?y[1]="Control":y[1]==="Esc"&&(y[1]="Escape"),y}),r.rotBy==="mouse"){let v;v=this.keyAssignments.findIndex(y=>y[0]==="rotNegX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(y=>y[0]==="rotPosX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(y=>y[0]==="rotPosY"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(y=>y[0]==="rotNegY"),v!==-1&&(this.keyAssignments[v][1]="")}this.lerpFactorPosStart=1-.02**(1/((r.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((r.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((r.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((r.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((r.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((r.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??fx.defaultData.gravity)*j$,this.usePhysics=this.gloabalPhysics.usePhysics??fx.defaultData.usePhysics,this.jumpPower=r.jumpPower*O7e,this.resetYPosition=this.position.y+Math.abs(r.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=r.alignToGround??!1,this.orientMode=r.autoOrientMove?r.orientMode:"none",this.orientWith=r.orientWith??zM.defaultDataThirdPerson.orientWith,this.slopeThresh=T7e*Math.PI/180,r.collider.type==="capsule"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=r.collider.height/2-r.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=r.collider.height*mI/this.pixelsPerMeter,this.stepThresh=r.collider.height*gI/this.pixelsPerMeter,this.colliderHeight=r.collider.height):r.collider.type==="sphere"?(this.collider.radius=r.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*r.collider.radius*mI/this.pixelsPerMeter,this.stepThresh=2*r.collider.radius*gI/this.pixelsPerMeter,this.colliderHeight=r.collider.radius*2):(this.offset=r.collider.height*mI/this.pixelsPerMeter,this.stepThresh=r.collider.height*gI/this.pixelsPerMeter,this.colliderHeight=r.collider.height),this.collider.type=r.collider.type;let d=new V().fromArray(r.collider.position),f=new ar().setFromEuler(new Es().fromArray([...r.collider.rotation,"XYZ"]));this.collider.position.copy(d).multiply(this.scale),this.collider.rotation.copy(f),this.collider.matrix.compose(d,f,O$),r.cameraXAxis!==void 0&&(this.cameraXAxis=r.cameraXAxis,this.cameraYAxis=r.cameraYAxis,this.minPolarAngle=r.cameraRotXLimits[0],this.maxPolarAngle=r.cameraRotXLimits[1],this.minAzimuthAngleRel=r.cameraRotYLimits[0],this.maxAzimuthAngleRel=r.cameraRotYLimits[1]),this.forwardDir=r.forwardDirection??"-z",this.isFirstPerson&&(this.forwardDir="-z"),this.runMultiplier=r.runMultiplier??2;let m=r.navmesh.destinationHelperRadius*2;if(m>0){let v=new Vt;v.push({fi:0,data:{...Vs.defaultData("light","phong"),alpha:0},id:"layer1"}),v.push({fi:0,data:{...Vs.defaultData("color"),color:r.navmesh.destinationHelperColor,alpha:r.navmesh.destinationHelperColor.a},id:"layer2"});let y=new UB({layers:v},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new Yi(Pse.create({parameters:{width:m,height:m/10,hollow:.7}}),y),this.navMeshPathDest.material.userData.opacity0=r.navmesh.destinationHelperColor.a}this.activate()}reset(e=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let t=new Es().setFromQuaternion(this.quaternion,"YXZ"),r=t.y;this.objectRealQuat.copy(this.quaternion),t.y=0,this.quaternion.setFromEuler(t),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),t.set(0,r,0),this.quaternion.setFromEuler(t),this.rot.setFromEuler(t),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof Ba?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){this.deactivate(),this.navMeshPathDest?.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.sharedAssets;e.gameActions!==void 0&&(this.actions={},LM.list.forEach(r=>{this.actions[r]=ds({...e,disabled:!1,type:"GameControl"},e.gameActions[r],this.page,t,this.controlsManager.eventManager,this.object)})),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),Xs(this.actions.idle),Xs(this.actions.move),Xs(this.actions.run),Xs(this.actions.jump)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].Transition.forEach(t=>{t.play()}),this.actions[e].Animation.forEach(t=>{t.play(this.initialAction===!1)}),this.actions[e].Create.forEach(t=>{t.dispatchStart()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("start")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].Transition.forEach(t=>{t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})}),this.actions[e].Create.forEach(t=>{t.dispatchStop()}),this.actions[e].Audio.forEach(t=>{t.dispatchGameControl("stop")}),this.actions[e].Particles.forEach(t=>{t.dispatchGameControl("stop")})))}get colliderWorldPosition(){return Qa.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,r){if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let n=i*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let o=xo.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*j$),1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),l=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,o,this.object.rigidBody?.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(l){this.onObject=!0,this.groundNormal.set(l.normal2.x,l.normal2.y,l.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),l.collider.parent()?.bodyType()===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let c=l.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let u of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(u.rigidBody===c&&u.userData.isFollowingObj!==this.object.uuid){(u.hasNonUniformScale?u.matrixWorldRigid:u.matrixWorld).decompose(Qa,Gd,xo),this.groundVelocity.subVectors(Qa,u.prevT),this.object.getWorldPosition(xo).add(this.collider.position).sub(Qa),this.groundYRotation=xu.setFromQuaternion(Gd).y-u.prevR.y,jf.copy(xo).applyAxisAngle(hc,this.groundYRotation),this.groundVelocity.add(jf.sub(xo)).divideScalar(i);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*n),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let o=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let l=Qa.subVectors(this.path[1],this.position),c=xo.subVectors(this.path[1],this.path[0]);l.dot(c)<0?this.path.shift():(this.directionXZ.x=c.x,this.directionXZ.z=c.z),o.opacity=o.userData.opacity0}else o.opacity-=.05*o.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**n),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**n),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**n)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let a=M7e.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let o=xo.copy(a);o.y=0,a.set(0,a.y,o.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none"&&this.isFirstPerson===!1)if(this.orientWith==="camera"&&this.path.length<=1){let o=Qa;this.camera.getWorldDirection(o);let l=jf.copy(hc).multiplyScalar(o.dot(hc));o.sub(l);let c=xo.copy(this.directionXZ);c.x*=-1,this.rot.y=o.angleTo(c)*(o.cross(c).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(xu.setFromVector3(this.rot),this.moveMode==="walk"&&(xu.x=0),a.applyEuler(xu),s&&(Gd.setFromUnitVectors(hc,this.groundNormal),a.applyQuaternion(Gd)),r){let o=xu.set(0,this.vrEulerYOffset*L$,0);r.applyEuler(o),a.x+=r.x,a.z+=r.z,this.nonColliderPosOffset.elements[13]+=r.y*i}if(this.usePhysics===!0){let o=xo;this.pushedVelocity.set(0,0,0);for(let l of this.sharedGameControlGlobals.entitiesWithTransformAnim){let c=jf.setFromMatrixPosition(l.matrixWorld).sub(l.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),u=l.rigidBody.collider(0).castCollider(c,this.object.rigidBody.collider(0),Qa.copy(a).divideScalar(this.pixelsPerMeter),i,!1);c.multiplyScalar(this.pixelsPerMeter);let d=Xr.is(l)?l:l.object;if(u!==null&&this.lastHitObj!==d){let f;l instanceof va&&(f=l);let m=this.sharedGameControlGlobals.entityToCollisionEvents[d.uuid];if(m)for(let v of m)v.data.target==="character"&&(v.dispatch(f),d.dispatchEvent(D5));this.lastHitObj=d}if(u!==null){this.pushedVelocity.copy(c),o.copy(u.normal1).applyQuaternion(l.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let l=o.dot(a);l<0&&a.addScaledVector(o,-l),a.add(this.pushedVelocity)}else a.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**n):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**n),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(hc,this.euler.y-this.euler0.y);let o=xo.copy(this.objectToCamXZ).normalize(),l=jf.copy(a).multiplyScalar(i);l.y=0;let c=l.sub(Qa.copy(o).multiplyScalar(l.dot(o))).cross(o).y;this.euler.y-=Math.atan2(c,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=Ct.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=Ct.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=Ct.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(xu.copy(t),xu.y=0):(xu.copy(this.euler),xu.y=0),this.nonColliderRotOffset.makeRotationFromEuler(xu)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*L$),dc.setFromAxisAngle(D7e,this.rot.x),Gd.setFromAxisAngle(hc,this.rot.y),Gd.multiply(dc),dc.setFromAxisAngle(N7e,this.rot.z),Gd.multiply(dc),this.quaternion.copy(Gd),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let o=xo.copy(a).multiplyScalar(i/this.pixelsPerMeter),l=null;this.didHit=!1;let c=new V;for(let u=0;u<5;u++){let d=o.length(),f=jf.copy(o).normalize();if(l=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(c),this.colliderWorldQuat,f,this.object.rigidBody?.collider(0).shape,d,!1,24,void 0,void 0,this.object.rigidBody),l!==null){this.didHit=!0;let m=this.sharedGameControlGlobals.colliderToEntity.get(l.collider.handle);if(m!==this.lastHitObj&&u===0){this.lastHitObj=m;let w=this.sharedGameControlGlobals.entityToCollisionEvents[m?.uuid];if(w){for(let _ of w)if(_.data.target==="character"){let S=(this.sharedGameControlGlobals.rapierWorld?.getCollider(l.collider.handle))._parent,P;if(m.cloner){for(let M of m.cloner.children)if(M.rigidBody===S){P=M;break}}_.dispatch(P),m.dispatchEvent(D5)}}}let v=k$.set(l.normal2.x,l.normal2.y,l.normal2.z).applyQuaternion(this.colliderWorldQuat),y=R$.copy(f).multiplyScalar(l.toi).dot(v),x=l.toi;if(x===0&&(this.position.y+=this.offset*this.pixelsPerMeter),y>this.offset&&(x=l.toi*(y-this.offset)/y,c.addScaledVector(f,x)),o.copy(f).multiplyScalar(d-x),Math.acos(-v.y)>this.slopeThresh){let w=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(c),_=jf.copy(l.witness2).applyQuaternion(this.colliderWorldQuat);_.y=0;let S=w.add(_);S.y+=this.stepThresh;let P=this.sharedGameControlGlobals.rapierWorld.castShape(S,this.colliderWorldQuat,o,this.object.rigidBody?.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);P!==null&&P.toi===0&&(v.y=0,v.normalize())}o.addScaledVector(v,-o.dot(v))}else{u===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),c.add(o);break}}this.position.addScaledVector(c,this.pixelsPerMeter),this.object.rigidBody?.setTranslation(Qa.copy(this.position).divideScalar(this.pixelsPerMeter),!0),this.object.rigidBody?.setRotation(dc.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let o=this.onObject?1:5,l=a.multiplyScalar(i/o);for(let c=0;c<o;c++)this.position.add(l),this.collisionAdjustment(i/o)}else this.position.addScaledVector(a,i);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let o=this.objectToTarget.add(this.position),l=this.targetToCamera.add(o);vI.lookAt(l,o,hc).setPosition(l),vI.decompose(this.targetPos,this.targetQuat,Qa),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**n),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**n),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=Ct.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=Ct.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(L7e),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&(this.navMeshPathDest===null||this.navMeshPathDest.material.opacity<-.04*this.navMeshPathDest?.material?.userData.opacity0)?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(j7e),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=dc.setFromAxisAngle(hc,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?Ct.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=Ct.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=Ct.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let r=Qa.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&r.applyQuaternion(e);let i=Gd.setFromAxisAngle(r,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(e){hc.angleTo(e)*180/Math.PI<15||hc.angleTo(e)*180/Math.PI>85?dc.identity():dc.setFromUnitVectors(hc,e),this.groundTilt.slerp(dc,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(e){let t=R$.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let r=vI.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(Qa,dc,xo).compose(Qa,dc,O$);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(n=>{if(n===this.object||n.isDescendantOf(this.object))return;Tl.makeEmpty(),n.updateMatrixWorldSVD();let s=n.matrixWorldRigid,a=I$.copy(s).invert(),o=P7e.copy(I$).multiply(r);zs.copy(this.collider.segment),zs.start.applyMatrix4(o),zs.end.applyMatrix4(o);let l=k$.copy(this.position).applyMatrix4(a);Tl.expandByPoint(zs.start),Tl.expandByPoint(zs.end),Tl.min.addScalar(-this.collider.radius),Tl.max.addScalar(this.collider.radius),n.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(c){return c.distanceToPoint(zs.end)},intersectsBounds:c=>c.intersectsBox(Tl),intersectsTriangle:c=>{let u=Qa,d=xo,f=c.closestPointToSegment(zs,u,d);if(f<this.collider.radius){let m=this.collider.radius-f,v=d.sub(u).normalize(),y=jf.copy(l);y.addScaledVector(v,m);let x=y.applyMatrix4(s).sub(this.position);t.add(x),zs.start.addScaledVector(v,m),zs.end.addScaledVector(v,m)}}})}),Tl.makeEmpty(),zs.copy(this.collider.segment),zs.start.applyMatrix4(r),zs.end.applyMatrix4(r),Tl.expandByPoint(zs.start),Tl.expandByPoint(zs.end),Tl.min.addScalar(-this.collider.radius),Tl.max.addScalar(this.collider.radius),this.sharedGameControlGlobals.staticMeshBVH?.shapecast({traverseBoundsOrder(n){return n.distanceToPoint(zs.end)},intersectsBounds:n=>n.intersectsBox(Tl),intersectsTriangle:n=>{let s=Qa,a=xo,o=n.closestPointToSegment(zs,s,a);if(o<this.collider.radius){let l=this.collider.radius-o,c=a.sub(s).normalize();this.alignToGround&&this.groundTiltAdjustment(c),t.addScaledVector(c,l),zs.start.addScaledVector(c,l),zs.end.addScaledVector(c,l)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(i),this.position.add(t)}pause(){this.firstPointerId=-1,this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.deactivate()}resume(){this.activate()}},tle=M5;tle.isLocked=!1;var z7e=Jp(Kre());function rle(e){let t=e.elements,r=t[0]**2+t[1]**2+t[2]**2,i=t[4]**2+t[5]**2+t[6]**2,n=t[8]**2+t[9]**2+t[10]**2,s=t[0]**2+t[4]**2+t[8]**2,a=t[1]**2+t[5]**2+t[9]**2,o=t[2]**2+t[6]**2+t[10]**2,l=1e-8;return r<l||i<l||n<l||s<l||a<l||o<l}function ah(e,t){let r=new Lt;if(t&&rle(t))return r.setAttribute("position",new At([],3)),r.setIndex([]),r;if(!e.getAttribute("position"))return r.setAttribute("position",new At([],3)),r.setIndex([]),r;let{positions:i,triIndices:n}=Y3(e.getAttribute("position"),e.getIndex());return r.setAttribute("position",new At(i,3)),r.setIndex(n),t&&r.applyMatrix4(t),r}var B7e=new ot,F7e=new ot,bu=[[0,0,0],[0,0,0],[0,0,0]];function ile(e){let t=e.elements;bu[0][0]=t[0],bu[0][1]=t[4],bu[0][2]=t[8],bu[1][0]=t[1],bu[1][1]=t[5],bu[1][2]=t[9],bu[2][0]=t[2],bu[2][1]=t[6],bu[2][2]=t[10];let{u:r,v:i}=(0,z7e.SVD)(bu),n=B7e.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),s=F7e.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return n.multiply(s.transpose())}var V7e=class extends Hie{constructor(){super(),this.layers.enable(3),this.layers.enable(8),this.layers.enable(9)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,r=[]){return e.forEach(i=>{i.visible&&this.intersectObject(i,t,r)}),r}createRaycastLineHelper(){let e=new tm({color:65280,linewidth:10}),t=new V(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),r=new V(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,n=new V().addVectors(t,r.multiplyScalar(i)),s=new Lt;return s.setFromPoints([t,n]),new oM(s,e)}},nle=e=>e instanceof Vy||e instanceof Uy;function U7e(e,t){return e.distance-t.distance}function sle(e,t,r){if(!(!sh(t)||!t.visible)){yc(t)&&t.raycast(e,r);for(let i of t.children)sle(e,i,r)}}function yT(e,t,r,i=!1){if(!i&&!r.some(s=>nP(e,s)!==void 0))return[];let n=[];return t.children.forEach(s=>sle(e,s,n)),n.sort(U7e),n}function P5(e){let t=[];if(e.length){let r=e[0].object;sh(r)&&t.push(r);let i=r.parent;for(;i;)nle(i)&&t.push(i),i=i.parent}return t}function oh(e,t,r,i){let n=e.frame;if(n){let s=t[0]*n.width,a=(1-t[1])*n.height;for(let o of r){let l=o===n.uuid?n:n.find(o);if(l?.intersects(s,a))return i(l),!0}}return!1}function nP(e,t){if(yc(t)){if(t.visible){let r=[];return t.raycast(e,r),r.length?r[0]:void 0}}else if(nle(t))return ale(e,t)}function ale(e,t){if(!(!sh(t)||!t.visible)){if(yc(t)){let r=[];if(t.raycast(e,r),r.length)return r[0]}for(let r of t.children){let i=ale(e,r);if(i)return i}}}function H7e(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width*2-1,y:-((t-(r.top+window.scrollY))/r.height)*2+1}}function G7e(e,t,r){return{x:(e-(r.left+window.scrollX))/r.width,y:1-(t-(r.top+window.scrollY))/r.height}}var W7e=class{constructor(e,t,r,i,n,s,a,o){this.renderer=e,this.publish=t,this.scene=r,this.getCamera=i,this.sharedAssets=n,this.requestRender=s,this.isExport=a,this.frame=o,this.raycaster=new V7e,this._useWindowEvents=!1,this.pointerWorld={x:0,y:0},this.pointerScreen={x:0,y:0},this._useWindowEvents=t.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement,this._domRect=this.domElement.getBoundingClientRect()}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}set domRect(e){this._domRect=e}get domRect(){return this._domRect}updateRaycaster(e){let{pageX:t,pageY:r}=e.touches?.length>0?e.touches[0]:e;this.pointerWorld=H7e(t,r,this._domRect),this.pointerScreen=G7e(t,r,this._domRect),this.raycaster.setFromCamera(this.pointerWorld,this.getCamera())}},Ha=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},yF=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],ole=e=>yF.find(([t,r])=>r===e)?.[0],Y_=e=>yF.find(([t])=>t===e)?.[1],q7e=(e,t)=>{let r=ole(e);if(r){let i=new CustomEvent(r,{bubbles:!0});return Object.defineProperty(i,"target",{writable:!1,value:t}),i}},Y7e=class extends Ha{constructor(){super(...arguments),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=e=>{if(!e.eventName||!e.target||e.eventName==="Scroll")return;let t=this.splineEvents[ole(e.eventName)]?.[e.target.uuid];if(!t)return;e.eventName==="Scroll"&&e.deltaY!==void 0&&Object.assign(t,{deltaY:e.deltaY});let{domElement:r}=this.eventContext;r.dispatchEvent(t)}}connect(){let{page:e}=this.eventContext;e.traverseEntity(t=>{if(t.data?.events.length){for(let[r,i]of yF)if(t.data.events.some(n=>n.data.type===i&&!n.data.disabled)){this.objectsPerEvents.has(r)?this.objectsPerEvents.get(r)?.push(t):this.objectsPerEvents.set(r,[t]);let n={id:t.uuid,name:t.name},s=q7e(i,n),a=this.splineEvents[r];a?a[t.uuid]=s:this.splineEvents[r]={[t.uuid]:s}}}}),this.objectsPerEvents.forEach(t=>{t.forEach(r=>{r.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},X7e=class{constructor(e,t,r,i,n,s){if(this.id=e,this.data=t,this.object=r,this.entered=!1,(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=ds(t,t.actions,i,n,s,r)}disconnect(){Xs(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStart())):(this.actions.Transition.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.SwitchCamera.some(t=>t.playing&&t.data.runMode!=="Toggle")||this.actions.SwitchCamera.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),e===!1&&this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},$7e=class extends Ha{constructor(e,t,r){super(e),this.eventManager=t,this.useForRaycastProperty=r,this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.sceneInterects=null,this.onCanvasRaycast=i=>{if(this.useForRaycastProperty===!0&&this.sceneInterects===null){this.eventContext.updateRaycaster(i);let{raycaster:n,page:s}=this.eventContext,a=yT(n,s,[],!0);this.sceneInterects=a,a.length&&(this.eventContext.sharedAssets.raycastProperty={x:a[0].point.x,y:a[0].point.y,z:a[0].point.z,objX:a[0].object.matrixWorld.elements[12],objY:a[0].object.matrixWorld.elements[13],objZ:a[0].object.matrixWorld.elements[14]})}},this.onCanvasMouseDown=i=>{(i.target===this.eventContext.domElement||i.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(n=>{(n.data.type==="MouseDown"||n.data.type==="MousePress")&&(this.onCanvasRaycast(i),n.dispatch())})},this.onCanvasMouseUp=i=>{(i.target===this.eventContext.domElement||i.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(n=>{n.data.type==="MouseUp"?(this.onCanvasRaycast(i),n.dispatch()):n.data.type==="MousePress"&&n.dispatchRelease()})},this.onMouseDown=i=>{nr.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseEvent("MouseDown"))},this.onMouseUp=i=>{nr.length>1||(this.eventContext.updateRaycaster(i),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=i=>{nr.length>1||(this.eventContext.updateRaycaster(i),this.handleMousePressEvent())},this.onMousePressRelease=i=>{nr.length>1||(this.eventContext.updateRaycaster(i),this.handleMousePressEvent(!0))},this.onKeyDown=i=>{this.heldKeys[i.key]||(this.handleKeyEvent(i,"KeyDown"),this.handleKeyEventHeld(i,"KeyDown",!0)),this.heldKeys[i.key]=!0},this.onKeyUp=i=>{this.handleKeyEvent(i,"KeyUp"),this.handleKeyEventHeld(i,"KeyUp",!0)},this.onKeyPressDown=i=>{this.heldKeysPress[i.key]?this.handleKeyEventHeld(i,"KeyPress"):(this.handleKeyEvent(i,"KeyPress"),this.handleKeyEventHeld(i,"KeyPress",!0)),this.heldKeysPress[i.key]=!0},this.onKeyPressUp=i=>{this.handleKeyEvent(i,"KeyPress",!0)},this.releaseHeldKey=i=>{delete this.heldKeys[i.key]},this.releaseHeldKeyPress=i=>{delete this.heldKeysPress[i.key]},this._onUserEvent=({eventName:i,target:n,reverse:s})=>{if(!i||!n)return;let a=Y_(i);a&&(a==="MouseDown"||a==="MouseUp"||a==="MousePress"?(n.dispatchEvent({type:"beginEvent",eventName:a}),this.eventsPerObjects[a]?.[n.uuid]?.forEach(o=>{o.dispatchUserEvent(s)})):(a==="KeyDown"||a==="KeyUp"||a==="KeyPress")&&(n.dispatchEvent({type:"beginEvent",eventName:a}),this.eventsPerObjects[a]?.[n.uuid]?.forEach(o=>{o.dispatchUserEvent()})))}}connect(){let{page:e,sharedAssets:t,domElement:r}=this.eventContext,i=(n,s)=>{if(!n.data?.events.length)return;let a=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let o of a){let l=this.eventsPerObjects[o];if(n.data.events.filter(({data:c})=>c.type===o&&c.disabled!==!0).forEach(({id:c,data:u})=>{try{let d=new X7e(c,u,n,e,t,this.eventManager);d.actions.Video.length&&(this.hasVideoAction=!0),(u.type==="MouseDown"||u.type==="MouseUp"||u.type==="MousePress")&&(u.mode==="Canvas"||u.mode==="Window")?this.canvasMouseEvents.push(d):(l[n.uuid]?l[n.uuid].some(f=>f.id===d.id)||l[n.uuid].push(d):l[n.uuid]=[d],n instanceof Kg&&n.traverseChildren(f=>{if(!f.visible)return!0;f instanceof os&&f.data.geometry.shapeBlendNode?.operation!==2&&(l[f.uuid]?l[f.uuid].push(d):l[f.uuid]=[d])}))}catch{}}),l[n.uuid]?.length&&(this.objectsPerTypes[o].push(n instanceof Qs&&(o==="MouseDown"||o==="MouseUp"||o==="MousePress")?s:n),n instanceof Kg)){let c=this.objectsPerTypes[o];n.traverseChildren(u=>{if(!u.visible)return!0;u instanceof os&&c.indexOf(u)===-1&&c.push(u)})}}};e.traverseEntity(n=>{(n instanceof ja||n instanceof Hs)&&n.frame?.traverse(s=>{i(s,n)}),i(n)}),this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),r.addEventListener("pointerdown",this.onCanvasMouseDown),r.addEventListener("pointerup",this.onCanvasMouseUp),(this.objectsPerTypes.MouseDown?.length||this.useForRaycastProperty)&&(this.domEventsNeeded.add("pointerdown"),r.addEventListener("pointerdown",this.onMouseDown)),this.objectsPerTypes.MouseUp?.length&&(this.domEventsNeeded.add("pointerup"),r.addEventListener("pointerup",this.onMouseUp)),this.objectsPerTypes.MousePress?.length&&(this.domEventsNeeded.add("pointerdown"),r.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),r.addEventListener("pointerup",this.onMousePressRelease)),this.objectsPerTypes.KeyDown?.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),this.objectsPerTypes.KeyUp?.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),this.objectsPerTypes.KeyPress?.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([n,s])=>{s.forEach(a=>{a.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},e.removeEventListener("pointerdown",this.onCanvasMouseDown),e.removeEventListener("pointerup",this.onCanvasMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(r=>{r.forEach(i=>{i.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,r])=>{r.forEach(i=>{i.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){let{stopRaycast:t,raycaster:r,page:i,pointerScreen:n}=this.eventContext,s=this.objectsPerTypes[e],a=s.filter(o=>!(o instanceof Qs));if(!(!s.length&&!this.useForRaycastProperty)&&!(i.uiCanvas&&oh(i,[n.x,n.y],Object.keys(this.eventsPerObjects[e]),o=>{this.handleObjectMouseEventDispatch(o,e)}))){if(t||this.useForRaycastProperty){let o;if(this.sceneInterects===null?o=yT(r,i,a,this.useForRaycastProperty):(o=this.sceneInterects,this.sceneInterects=null),this.useForRaycastProperty&&o.length&&(this.eventContext.sharedAssets.raycastProperty={x:o[0].point.x,y:o[0].point.y,z:o[0].point.z,objX:o[0].object.matrixWorld.elements[12],objY:o[0].object.matrixWorld.elements[13],objZ:o[0].object.matrixWorld.elements[14]}),t){let l=[o[0]?.uv?.x??0,o[0]?.uv?.y??0];P5(o).forEach(c=>{c instanceof ja&&oh(c,l,Object.keys(this.eventsPerObjects[e]),u=>{this.handleObjectMouseEventDispatch(u,e)}),this.eventsPerObjects[e][c.uuid]&&this.handleObjectMouseEventDispatch(c,e)})}}t||a.forEach(o=>{let l=nP(r,o);l&&(this.handleObjectMouseEventDispatch(o,e),o instanceof ja&&oh(o,[l?.uv?.x??0,l?.uv?.y??0],Object.keys(this.eventsPerObjects[e]),c=>{this.handleObjectMouseEventDispatch(c,e)}))})}}handleMousePressEvent(e=!1){let t="MousePress",r=this.objectsPerTypes[t],i=r.filter(s=>!(s instanceof Qs)),n=[];if(r.length){if(!e){let{stopRaycast:s,raycaster:a,page:o,pointerScreen:l}=this.eventContext,c=!1;if(o.uiCanvas&&(c=oh(o,[l.x,l.y],Object.keys(this.eventsPerObjects[t]),u=>{n.push(u)})),s&&!c){let u=yT(a,o,i);n=P5(u),u.forEach(d=>{d.object instanceof ja&&oh(d.object,[d?.uv?.x??0,d?.uv?.y??0],Object.keys(this.eventsPerObjects[t]),f=>{n.push(f)})})}else i.forEach(u=>{let d=nP(a,u);d&&(n.push(u),u instanceof ja&&oh(u,[d?.uv?.x??0,d?.uv?.y??0],Object.keys(this.eventsPerObjects[t]),f=>{n.push(f)}))})}this._prevObjects.length&&this._prevObjects.forEach(s=>{n.includes(s)||this.handleObjectMouseEventDispatchRelease(s,t)}),n.length&&n.forEach(s=>{this.handleObjectMouseEventDispatch(s,t)}),this._prevObjects=n}}handleObjectMouseEventDispatch(e,t){e.dispatchEvent({type:"beginEvent",eventName:t}),this.eventsPerObjects[t]?.[e.uuid]?.forEach(r=>{r.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){e.dispatchEvent({type:"beginEvent",eventName:t}),this.eventsPerObjects[t]?.[e.uuid]?.forEach(r=>{r.dispatchRelease()})}handleKeyEvent(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{let n=this.eventsPerObjects[t][i.uuid];n.some(({data:s})=>"key"in s&&s.key===e.key)&&i.dispatchEvent({type:"beginEvent",eventName:t}),n.forEach(s=>{"key"in s.data&&s.data.key===e.key&&(r?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(e,t,r=!1){this.objectsPerTypes[t].forEach(i=>{this.eventsPerObjects[t][i.uuid].forEach(n=>{"key"in n.data&&n.data.key===e.key&&n.dispatchHeld(r)})})}},K7e=new V,Q7e=new V,lle=class{constructor(e,t,r,i,n){this.actionsIn=ds(e,e.inActions,r,i,n,t),this.actionsOut=ds(e,e.outActions,r,i,n,t)}disconnect(){Xs(this.actionsIn),Xs(this.actionsOut)}},Z7e=class extends lle{constructor(e,t,r,i,n,s){super(t,r,i,n,s),this.id=e,this.data=t,this.object=r,this.stage="out",this.objects=[],this.onUpdateMatrixWorld=()=>{for(let f of this.objects)if(!f.visible)return;let c=K7e.setFromMatrixPosition(this.objects[0].matrixWorld),u=Q7e.setFromMatrixPosition(this.objects[1].matrixWorld),d=c.distanceTo(u)<=this.distance?"in":"out";if(this.stage!==d){this.stage=d;let f=d==="in"?this.actionsIn:this.actionsOut;f.Audio.forEach(m=>m.dispatchConditional()),f.Particles.forEach(m=>m.dispatchConditional()),f.Video.forEach(m=>m.dispatchConditional()),f.Link.forEach(m=>m.dispatch()),f.Create.forEach(m=>m.dispatch()),f.Destroy.forEach(m=>m.dispatch()),f.Reset.forEach(m=>m.dispatch()),f.Transition.forEach(m=>{m.object.currentTransitionEvent!==this&&(m.object.currentTransitionEvent=this),m.init()}),f.Transition.forEach(m=>m.play()),f.Animation.forEach(m=>m.play()),f.SwitchCamera.forEach(m=>m.play()),f.SceneTransition.forEach(m=>m.dispatch()),f.SetVariable.forEach(m=>m.checkConditions()),f.SetVariable.forEach(m=>m.dispatch()),f.DynamicVariablePlay.forEach(m=>m.dispatch()),f.ClearLocalStorage.forEach(m=>m.dispatch()),f.UserAPI.forEach(m=>m.dispatch())}};let{distance:a,fromObject:o,toObject:l}=t.condition;this.distance=a;for(let c of[o,l]){if(!c)throw new Error("Missing property");let u=i.find(c);if(!u)throw new Error("Missing property");this.objects.push(u)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)}),this.onUpdateMatrixWorld()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrixWorld",this.onUpdateMatrixWorld)})}},J7e=class extends lle{constructor(e,t,r,i,n,s){super(t,r,i,n,s),this.id=e,this.data=t,this.object=r,this.onBegin=({target:l,state:c})=>{this.toState!==c&&(this.actionsOut.Audio.forEach(u=>u.dispatchConditional()),this.actionsOut.Particles.forEach(u=>u.dispatchConditional()),this.actionsOut.Video.forEach(u=>u.dispatchConditional()),this.actionsOut.Link.forEach(u=>u.dispatch()),this.actionsOut.Create.forEach(u=>u.dispatch()),this.actionsOut.Destroy.forEach(u=>u.dispatch()),this.actionsOut.Reset.forEach(u=>u.dispatch()),this.actionsIn.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(u=>u.play()),this.actionsOut.Animation.forEach(u=>u.play()),this.actionsIn.SwitchCamera.forEach(u=>u.pause()),this.actionsOut.SwitchCamera.forEach(u=>u.play()),this.actionsOut.SceneTransition.forEach(u=>u.dispatch()),this.actionsOut.SetVariable.forEach(u=>u.checkConditions()),this.actionsOut.SetVariable.forEach(u=>u.dispatch()),this.actionsOut.DynamicVariablePlay.forEach(u=>u.dispatch()),this.actionsOut.ClearLocalStorage.forEach(u=>u.dispatch()),this.actionsOut.UserAPI.forEach(u=>u.dispatch()))},this.onComplete=({target:l,state:c})=>{this.toState===c&&(this.actionsIn.Audio.forEach(u=>u.dispatchConditional()),this.actionsIn.Particles.forEach(u=>u.dispatchConditional()),this.actionsIn.Video.forEach(u=>u.dispatchConditional()),this.actionsIn.Link.forEach(u=>u.dispatch()),this.actionsIn.Create.forEach(u=>u.dispatch()),this.actionsIn.Destroy.forEach(u=>u.dispatch()),this.actionsIn.Reset.forEach(u=>u.dispatch()),this.actionsOut.Transition.forEach(u=>u.pause()),this.actionsOut.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(u=>u.play()),this.actionsIn.Animation.forEach(u=>u.play()),this.actionsOut.SwitchCamera.forEach(u=>u.pause()),this.actionsIn.SwitchCamera.forEach(u=>u.play()),this.actionsIn.SceneTransition.forEach(u=>u.dispatch()),this.actionsIn.SetVariable.forEach(u=>u.checkConditions()),this.actionsIn.SetVariable.forEach(u=>u.dispatch()),this.actionsIn.DynamicVariablePlay.forEach(u=>u.dispatch()),this.actionsOut.ClearLocalStorage.forEach(u=>u.dispatch()),this.actionsOut.UserAPI.forEach(u=>u.dispatch()))};let{condition:a}=t;if(!a.object)throw new Error("Missing property");let o=i.find(a.object)??i.scene.find2D(a.object);if(!o)throw new Error("Missing property");if(this.toObject=o,a.state&&!this.toObject.states?.[a.state])throw new Error("Missing property");this.toState=a.state}connect(){ug(this.actionsOut).forEach(e=>{this.actionsOut[e]?.length&&this.toObject.addEventListener("beginState",this.onBegin)}),ug(this.actionsIn).forEach(e=>{this.actionsIn[e]?.length&&this.toObject.addEventListener("completeState",this.onComplete)})}disconnect(){super.disconnect(),ug(this.actionsOut).forEach(e=>{this.actionsIn[e]?.length&&this.toObject.removeEventListener("beginState",this.onBegin)}),ug(this.actionsIn).forEach(e=>{this.actionsIn[e]?.length&&this.toObject.removeEventListener("completeState",this.onComplete)})}},eHe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1}connect(){super.connect();let{page:e,sharedAssets:t}=this.eventContext;e.traverseEntity(r=>{if(r.data?.events.length){for(let{id:i,data:n}of r.data.events)if(!n.disabled&&n.type==="Conditional")try{let s;n.condition.type==="Comparison"||(n.condition.type==="Distance"?s=new Z7e(i,n,r,e,t,this.eventManager):n.condition.type==="State"&&(s=new J7e(i,n,r,e,t,this.eventManager))),s&&(this.eventsPerConditions[n.condition.type].push(s),(s.actionsIn.Video.length||s.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}}),Object.values(this.eventsPerConditions).forEach(r=>r.forEach(i=>i.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},Q1=new V,Lf=new V,Fm=new V,z$=new So,tHe=.01,yi=new V,_s=new V,B$=new V,vg=new ar,yI=new Es,rHe=new ot,xI=new as,Bv=new V,wu=new V,Fv=.2;function bI(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var iHe=function(){let e=new ot;return(t,r,i)=>{let n=t.obj;e.copy(n.hiddenMatrix),n.parent!==null&&e.premultiply(n.parent.matrixWorld),e.invert(),n.position.copy(r),t.reference==="global"&&bI(n.position,t.limits),n.position.applyMatrix4(e),t.reference==="parent"?bI(n.position,t.limits):t.reference==="local"&&(vg.copy(t.quat0).invert(),n.position.sub(t.position0),n.position.applyQuaternion(vg),bI(n.position,t.limits),vg.invert(),n.position.applyQuaternion(vg),n.position.add(t.position0)),e.multiply(i??n.matrixWorld).decompose(yi,n.quaternion,_s),n.updateMatrix(),n.hasNonUniformScale&&(n.updateMatrixWorld(),n.updateMatrixWorldSVD()),n instanceof uo&&xh(n.parent)&&n.invalidateDownstreamBooleanData(!0)}}(),nHe=class{constructor(e,t,r,i,n,s,a){this.object=e,this.id=t,this.data=r,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=ds(r,r.dragDropActions.drag,i,n,s,this.object),this.actionsDrop=ds(r,r.dragDropActions.drop,i,n,s,this.object);let o=[];this.data.objects.forEach(l=>{let c=i.find(l);!c||c.data.visible!==!1&&(o.push(c),a[c.uuid]&&a[c.uuid].forEach(u=>{let d=i.find(u);!d||d.data.visible!==!1&&o.push(d)}))}),this.data.dropDestinations.forEach(l=>{let c=i.find(l);!c||c.data.visible!==!1&&(this.dropDestIds.push(c.uuid),a[c.uuid]&&a[c.uuid].forEach(u=>{let d=i.find(u);!d||d.data.visible!==!1&&this.dropDestIds.push(d.uuid)}))}),this.dragItems=o.map(l=>(this.data.planeMode==="locked"&&(l.userData.lockedPlane=!0),l.userData.worldPosition0=new V().setFromMatrixPosition(l.matrixWorld),{obj:l,fromPosition:new V().setFromMatrixPosition(l.matrixWorld),pointStart:new V,pointEnd:new V,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new V().copy(l.position),quat0:new ar().copy(l.quaternion),snapped:!1,orientationMatrix:new ot,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){Xs(this.actionsDrag),Xs(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},sHe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=r=>{if(nr.length>1)return;this.eventContext.updateRaycaster(r);let{raycaster:i,page:n}=this.eventContext,s=n.raycastWithClones(i);if(this.lastDropDestination=null,s.length===0){this.activeEvent=null;return}for(let a of this.events){let o=0;for(let{obj:l,pointEnd:c,pointStart:u}of a.dragItems){if(l===s[0].object||l===s[0].object.object||Xr.is(l)&&l.isAncestorOf(s[0].object.uuid)){if(a.activeIdx=o,a.activeDragItem.reset=!1,a.activeDragItem.currentDampingFactor=a.data.dampingFactor,a.activeDragItem.snapped=!1,a.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){a.activeDragItem.obj.rigidBody&&a.activeDragItem.obj.rigidBody.setBodyType(2,!0);let d=a.activeDragItem.obj;l.hasNonUniformScale&&l.updateMatrixWorldSVD(),(d.hasNonUniformScale?d.matrixWorldRigid:d.matrixWorld).decompose(yi,vg,_s),yI.setFromQuaternion(vg),d.prevR===void 0?(d.prevR=yI.clone(),d.prevT=yi.clone()):(d.prevR.copy(yI),d.prevT.copy(yi)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(a.activeDragItem.obj)}this.calcPlaneIntersectPos(l,u,a.data.plane,a.data.referenceFrame),c.copy(u),(this.eventManager.controlsManager.usePhysics&&l.data.physics?.rigidBody==="dynamic"||a.data.drop===!1||a.data.resetOnSnapFail===!1)&&a.activeDragItem.fromPosition.setFromMatrixPosition(a.activeDragItem.obj.matrixWorld),this.activeEvent=a,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}o++}}this.activeEvent=null},this.onPointerMove=r=>{if(nr.length>1)return;this.eventContext.updateRaycaster(r);let{raycaster:i,page:n}=this.eventContext,s=n.raycastWithClones(i);if(nr.length===0){let a=!1;for(let o of this.events){for(let{obj:l}of o.dragItems)if(l===s[0]?.object||l===s[0]?.object?.object||Xr.is(l)&&l.isAncestorOf(s[0]?.object.uuid)){switch(a=!0,o.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(a)break}a||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let a=this.activeEvent.activeDragItem;a.snapped=!1;let o;if(this.activeEvent.data.drop&&(o=s.filter(l=>a.obj!==l.object&&!a.obj.isAncestorOf(l.object.uuid)&&!(l.object instanceof Vy)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(c=>c===l.object.uuid||n.scene.find(c).isAncestorOf(l.object.uuid))))[0]),o){let l=B$.copy(o.face.normal).applyMatrix3(xI.getNormalMatrix(o.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")a.fromPosition.setFromMatrixPosition(o.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(a.fromPosition.copy(o.point),this.activeEvent.data.snapSurfaceMode==="bbox"){yi.copy(l).applyMatrix3(xI.setFromMatrix4(a.obj.matrixWorld).transpose());let c=a.obj;yi.x>Fv?_s.x=-c.recursiveBBox.min.x:yi.x<-Fv&&(_s.x=-c.recursiveBBox.max.x),yi.y>Fv?_s.y=-c.recursiveBBox.min.y:yi.y<-Fv&&(_s.y=-c.recursiveBBox.max.y),yi.z>Fv?_s.z=-c.recursiveBBox.min.z:yi.z<-Fv&&(_s.z=-c.recursiveBBox.max.z),_s.applyMatrix3(xI.invert())}else _s.copy(l).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);a.fromPosition.add(_s)}this.activeEvent.data.autoOrient&&(yi.set(0,1,0).cross(l),yi.length()<1e-4&&yi.set(-1,0,0).cross(l),_s.crossVectors(B$,yi),a.orientationMatrix.makeBasis(yi,_s,l)),a.pointStart.copy(a.fromPosition),a.pointEnd.copy(a.pointStart),a.currentDampingFactor=this.activeEvent.snapDampingFactor,a.snapped=!0,this.lastDropDestination!==o.object&&(this.lastDropDestination=o.object,this.activeEvent.actionsDrop.Transition.forEach(c=>{c.play()}),this.activeEvent.actionsDrop.Animation.forEach(c=>{c.play()}),this.activeEvent.actionsDrop.Audio.forEach(c=>{c.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Particles.forEach(c=>{c.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(c=>{c.dispatchThrottled()}))}else a.orientationMatrix.makeRotationFromQuaternion(a.quat0),this.lastDropDestination=null,a.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(a.obj,a.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(l=>{l.stop(),l.object.currentState!==null&&l.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(l=>{l.stop()}),this.activeEvent.actionsDrop.Audio.forEach(l=>{l.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.Particles.forEach(l=>{l.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(l=>{l.dispatchThrottled()}),this.activeEvent.actionsDrag.SetVariable.forEach(l=>l.checkConditions()),this.activeEvent.actionsDrag.SetVariable.forEach(l=>l.dispatch()),this.activeEvent.actionsDrag.DynamicVariablePlay.forEach(l=>l.dispatch()),this.activeEvent.actionsDrag.ClearLocalStorage.forEach(l=>l.dispatch()),this.activeEvent.actionsDrag.UserAPI.forEach(l=>l.dispatch()),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(l=>{l.play()}),this.activeEvent.actionsDrag.Animation.forEach(l=>{l.play()}),this.activeEvent.actionsDrag.Audio.forEach(l=>{l.dispatchGameControl("start")}),this.activeEvent.actionsDrag.Particles.forEach(l=>{l.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(l=>{l.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(l=>{l.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(l=>{l.stop(),l.object.currentState!==null&&l.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(l=>{l.stop()}))},500),this.updateDragItem(a),a.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=r=>{if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let i=this.activeEvent.activeDragItem.obj.data.physics?.rigidBody==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!i)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&i&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(n=>{n.stop(),n.object.currentState!==null&&n.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(n=>{n.stop()}),this.activeEvent.actionsDrag.Audio.forEach(n=>{n.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Particles.forEach(n=>{n.dispatchGameControl("stop")}),this.activeEvent.actionsDrop.SetVariable.forEach(n=>n.checkConditions()),this.activeEvent.actionsDrop.SetVariable.forEach(n=>n.dispatch()),this.activeEvent.actionsDrop.DynamicVariablePlay.forEach(n=>n.dispatch()),this.activeEvent.actionsDrop.ClearLocalStorage.forEach(n=>n.dispatch()),this.activeEvent.actionsDrop.UserAPI.forEach(n=>n.dispatch())),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}}}connect(){let e={};if(this.eventContext.page.traverseEntity(r=>{r.component&&(e[r.component.uuid]?e[r.component.uuid].push(r.uuid):e[r.component.uuid]=[r.uuid])}),this.eventContext.page.traverseEntity(r=>{r.data?.events.filter(i=>i.data.type==="DragDrop"&&!i.data.disabled).forEach(i=>{this.events.push(new nHe(r,i.id,i.data,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager,e))})}),!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(t=>t.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,r,i){let{getCamera:n,raycaster:s}=this.eventContext;n().getWorldDirection(Lf),Lf.negate();let a=vg.identity();switch(i==="parent"?rHe.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(yi,a,_s):i==="local"&&e.matrixWorld.decompose(yi,a,_s),r){case"x":yi.set(1,0,0).applyQuaternion(a),Bv.copy(Lf).cross(yi),wu.copy(yi).cross(Bv);break;case"y":yi.set(0,1,0).applyQuaternion(a),Bv.copy(Lf).cross(yi),wu.copy(yi).cross(Bv);break;case"z":yi.set(0,0,1).applyQuaternion(a),Bv.copy(Lf).cross(yi),wu.copy(yi).cross(Bv);break;case"xy":wu.set(0,0,1).applyQuaternion(a);break;case"yz":wu.set(1,0,0).applyQuaternion(a);break;case"xz":wu.set(0,1,0).applyQuaternion(a);break;case"adaptive":Lf.angleTo(_s.set(0,1,0))>Math.PI/6?(yi.crossVectors(_s.set(0,1,0),Lf),wu.crossVectors(yi,_s)):wu.set(0,1,0);break;default:wu.copy(Lf);break}Fm.setFromMatrixPosition(e.matrixWorld);let o=e.userData.lockedPlane?e.userData.worldPosition0:Fm;if(z$.setFromNormalAndCoplanarPoint(wu,o),!!s.ray.intersectPlane(z$,t)&&(r==="x"||r==="y"||r==="z")){let l=_s.subVectors(t,o).dot(yi);t.copy(o).addScaledVector(yi,l)}}updateDragItem(e,t=!1){Fm.setFromMatrixPosition(e.obj.matrixWorld),e.reset==="current"?Q1.subVectors(e.fromPosition,Fm).divideScalar(e.currentDampingFactor):e.reset==="original"?(Q1.subVectors(e.obj.userData.worldPosition0,Fm).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):Q1.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(Fm).divideScalar(e.currentDampingFactor),e.paused=e.currentDampingFactor>1?Q1.length()<tHe:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||t)&&iHe(e,Q1.add(Fm),this.activeEvent?.data.drop&&this.activeEvent?.data.autoOrient?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},Vv=new V,wI=new V,Wd=new V,qd=new V,F$=new So,aHe=.01,oHe={type:"requestRender"},lHe=function(){let e=new V,t=new V;return(r,i,n)=>n>0?(e.subVectors(r,i),e.length()<=n?r:t.copy(i).add(e.normalize().multiplyScalar(n))):i}(),V$=function(){let e=new ot;return(t,r)=>{t.position.copy(r),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof uo&&xh(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),cHe=class{constructor(e,t,r,i,n,s){this.data=e,this.id=t,this.object=r,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new V,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...iL.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=ds(e,e.actions,i,n,s,r)}},uHe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.pairOfEventListeners=[],this.onMouseMove=r=>{if(!(nr.length>1)){this.eventContext.updateRaycaster(r);for(let i of this.events)i.target===void 0&&this.updateSingleEvent(i)}},this.onMouseEnter=r=>{for(let i of this.events)i.target===void 0&&(i.isReset=!1,i.currentDampingFactor=i.data.dampingFactor)},this.onMouseLeave=r=>{for(let i of this.events)i.target===void 0&&(i.data.resetOnPointerLeave&&(i.isReset=!0,i.currentDampingFactor=i.resetDampingFactor),this.updateSingleEvent(i))},this.onTargetChange=r=>()=>{this.updateSingleEvent(r)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(i=>{let n=i.data?.events.find(s=>s.data.type==="Follow"&&!s.data.disabled);n&&(!e.data.globalPhysics.usePhysics||i.dataPatched.physics?.rigidBody!=="dynamic")&&this.events.push(new cHe(n.data,n.id,i,e,this.eventContext.sharedAssets,this.eventManager))}),!this.events.length)return;let{domElement:t,eventElement:r}=this.eventContext;this.domEventsNeeded.clear(),nl&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(i.target!==void 0){let n=i.target,s=this.onTargetChange(i);this.pairOfEventListeners.push([n,s]),n.addEventListener("requestRender",s)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),nl&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let r of this.events)r.paused=!0,r.isReset=!1,Xs(r.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){this.events.forEach(a=>{a.actions.Create.forEach(o=>{o.dispatchThrottled()})});let{plane:r,limitDistance:i,limitDistanceEnabled:n}=e.data;if(e.object.getWorldPosition(Wd),e.isReset)qd.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(qd);else{let{getCamera:a,raycaster:o}=this.eventContext;if(r==="custom"?(a().getWorldDirection(wI),wI.negate(),Vv.copy(wI)):r==="xy"?Vv.set(0,0,1):r==="xz"?Vv.set(0,1,0):r==="yz"&&Vv.set(1,0,0),F$.setFromNormalAndCoplanarPoint(Vv,Wd),!o.ray.intersectPlane(F$,qd))return}if(!e.isReset){if(qd.distanceTo(e.worldPosition0)>i&&n&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)qd.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(qd.x=Wd.x),e.data.enabledTranslation[1]===!1&&(qd.y=Wd.y),e.data.enabledTranslation[2]===!1&&(qd.z=Wd.z);let s=lHe(Wd,qd,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let a=Vv.subVectors(s,Wd).divideScalar(e.currentDampingFactor);Wd.add(a),t&&V$(e.object,Wd),e.paused=a.length()<aHe}else V$(e.object,s),e.paused=!0;e.object?.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(oHe)}},Z1=new V,uC=new V,J1=new ot,Uv=new ar,zf=new ar,ew=new V,tw=new V,Vm=new V,Yd=new V,_I=new So,dHe=1e-6,hHe={type:"requestRender"},fHe={type:"changeRotation"},U$=function(){let e=new ot;return function(t,r){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),r.premultiply(ile(e).invert()),t.rotation.setFromRotationMatrix(r),t.updateMatrix(),t instanceof uo&&xh(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),pHe=class{constructor(e,t,r,i){this.id=t,this.object=r,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new ar,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...nL.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},mHe=class extends Ha{constructor(){super(...arguments),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=e=>{if(!(nr.length>1)){this._lastMouseEvent=e,this.eventContext.updateRaycaster(e);for(let t of this.events)t.target===void 0&&this.updateSingleEvent(t)}},this.onMouseEnter=e=>{for(let t of this.events)t.target===void 0&&(t.isReset=!1,t.currentDampingFactor=t.data.dampingFactor)},this.onMouseLeave=e=>{for(let t of this.events)t.target===void 0&&(t.data.resetOnPointerLeave&&(t.isReset=!0,t.currentDampingFactor=t.resetDampingFactor),this.updateSingleEvent(t))},this.onScroll=e=>{if(this._lastMouseEvent){let t=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(t)}},this.onTargetChange=e=>()=>{this.updateSingleEvent(e)},this.createUserEventListener=e=>({eventName:t,target:r})=>{if(!t||!r)return;let i=Y_(t);i&&i==="LookAt"&&this.updateSingleEvent(e)}}connect(){let{page:e}=this.eventContext;if(e.traverseEntity(i=>{let n=i.data?.events.find(s=>s.data.type==="LookAt"&&!s.data.disabled);n&&(!e.data.globalPhysics.usePhysics||i.dataPatched.physics?.rigidBody!=="dynamic")&&this.events.push(new pHe(n.data,n.id,i,e))}),!this.events.length)return;let{domElement:t,eventElement:r}=this.eventContext;this.domEventsNeeded.clear(),nl&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),r.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?r.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(i.target!==void 0){let a=this.onTargetChange(i),o=i.target;this.pairOfEventListeners.push([o,a]),o.addEventListener("requestRender",a)}let n=this.createUserEventListener(i),s=i.object;this.pairOfUserEventListeners.push([s,n]),s.addEventListener("userEvent",n)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),nl&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[r,i]of this.pairOfEventListeners)r.removeEventListener("requestRender",i);for(let[r,i]of this.pairOfUserEventListeners)r.removeEventListener("userEvent",i);for(let r of this.events)r.paused=!0,r.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){let{tilt:t,axis:r,distance:i,plane:n,limitDistance:s,enabledRotation:a,limitDistanceEnabled:o}=e.data,{getCamera:l,raycaster:c}=this.eventContext,{object:u,target:d}=e;if(u.getWorldPosition(ew),!e.isReset)if(e.target)e.target.getWorldPosition(tw);else{if(n==="custom"?(l().getWorldDirection(uC),uC.negate(),_I.setFromNormalAndCoplanarPoint(uC,ew)):(n==="xy"?Z1.set(0,0,1):n==="xz"?Z1.set(0,1,0):n==="yz"&&Z1.set(1,0,0),_I.setFromNormalAndCoplanarPoint(Z1,ew)),!c.ray.intersectPlane(_I,tw))return;i>0&&(n==="custom"||n===void 0)&&tw.addScaledVector(uC,i)}if(e.isReset||(d?t==="target"?Vm.copy(d.up).applyMatrix4(J1.extractRotation(d.matrixWorld)).normalize():a.some(f=>f===!1)?(r==="x"?(Yd.set(0,0,1),a[2]===!1&&Yd.set(0,1,0)):r==="y"?(Yd.set(1,0,0),a[0]===!1&&Yd.set(0,0,1)):(Yd.set(0,1,0),a[1]===!1&&Yd.set(1,0,0)),Vm.copy(Yd).applyQuaternion(e.worldQuaternion0).normalize()):Vm.set(0,1,0):n==="custom"?Vm.set(0,1,0):Vm.copy(Z1)),e.isReset)zf.copy(e.worldQuaternion0);else if(ew.distanceTo(tw)>s&&o&&d)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)zf.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;gHe(J1,tw,ew,Vm,r,Yd),zf.setFromRotationMatrix(J1),Uv.setFromUnitVectors(Yd.applyQuaternion(zf),Vm),a.some(f=>f===!1)&&t!=="target"&&zf.premultiply(Uv).normalize()}e.currentDampingFactor>1?(u.updateWorldMatrix(!0,!1),Uv.setFromRotationMatrix(ile(u.matrixWorld)),Uv.slerp(zf,1/e.currentDampingFactor),U$(u,J1.makeRotationFromQuaternion(Uv)),e.paused=8*(1-Uv.dot(zf))<dHe):(U$(u,J1.makeRotationFromQuaternion(zf)),e.paused=!0),e.object?.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),u.dispatchEvent(hHe),u.dispatchEvent(fHe)}},Ml=new V,bs=new V,jn=new V;function gHe(e,t,r,i,n,s){let a=e.elements;jn.subVectors(t,r),jn.lengthSq()===0&&(jn.z=1),jn.normalize(),bs.crossVectors(i,jn),bs.lengthSq()===0&&(Math.abs(i.z)===1?jn.x+=1e-4:jn.z+=1e-4,jn.normalize(),bs.crossVectors(i,jn)),bs.normalize(),Ml.crossVectors(jn,bs),n==="x"?s.z===1?[bs,Ml,jn]=[jn,bs,Ml]:(bs.negate(),[bs,jn]=[jn,bs]):n==="y"?s.x===1?[bs,Ml,jn]=[Ml,jn,bs]:(bs.negate(),[Ml,jn]=[jn,Ml]):s.x===1&&(bs.negate(),[bs,Ml]=[Ml,bs]),a[0]=bs.x,a[4]=Ml.x,a[8]=jn.x,a[1]=bs.y,a[5]=Ml.y,a[9]=jn.y,a[2]=bs.z,a[6]=Ml.z,a[10]=jn.z}var vHe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.entered=!1,this.actions=ds(t,t.actions,i,n,s,r)}disconnect(){Xs(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatchStart()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Create.forEach(e=>e.dispatchStop()),this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Particles.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Particles.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Particles.forEach(t=>t.dispatchBasic()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},yHe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObjects={},this.objects=[],this.objects2D=[],this._prevObjects=[],this.onMouseDown=r=>{nr.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onMouseUp=r=>{nr.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=r=>{nr.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{if(!r||!i)return;let s=Y_(r);s&&s==="MouseHover"&&(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),this.eventsPerObjects[i.uuid]?.forEach(a=>a.dispatchUserEvent(n)))}}connect(){let{page:e,sharedAssets:t}=this.eventContext,r=(n,s)=>{if(!(!n.visible||!n.data?.events.length)){for(let{id:a,data:o}of n.data.events)if(!o.disabled&&o.type==="MouseHover")try{let l=new vHe(a,o,n,e,t,this.eventManager);this.eventsPerObjects[n.uuid]?this.eventsPerObjects[n.uuid].push(l):this.eventsPerObjects[n.uuid]=[l]}catch{}this.eventsPerObjects[n.uuid]?.length&&this.objects.push(n instanceof Qs?s:n)}};if(e.traverseEntity(n=>{(n instanceof ja||n instanceof Hs)&&n.frame?.traverse(s=>{r(s,n)}),r(n)}),!this.objects.length)return;let{domElement:i}=this.eventContext;this.domEventsNeeded.clear(),nl&&(this.domEventsNeeded.add("pointerdown"),i.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),i.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),i.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(n=>{n.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),nl&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(r=>{r.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:r,raycaster:i,page:n,pointerScreen:s}=this.eventContext,a=!1;if(n.uiCanvas&&(a=oh(n,[s.x,s.y],Object.keys(this.eventsPerObjects),o=>{t.push(o)})),r&&!a){let o=yT(i,n,this.objects);t=P5(o),o.forEach(l=>{l.object instanceof ja&&oh(l.object,[l?.uv?.x??0,l?.uv?.y??0],Object.keys(this.eventsPerObjects),c=>{t.push(c)})})}else this.objects.forEach(o=>{let l=nP(i,o);l&&(t.push(o),o instanceof ja&&oh(o,[l?.uv?.x??0,l?.uv?.y??0],Object.keys(this.eventsPerObjects),c=>{t.push(c)}))})}this._prevObjects.length&&this._prevObjects.forEach(r=>{t.includes(r)||(r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),this.eventsPerObjects[r.uuid]?.forEach(i=>i.dispatchLeave()))}),t.length&&t.forEach(r=>{r.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),this.eventsPerObjects[r.uuid]?.forEach(i=>i.dispatchEnter())}),this._prevObjects=t}},xHe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.scrollCounter=0,this.actions=ds(t,t.actions,i,n,s,r)}connect(){this.scrollCounter=0}disconnect(){Xs(this.actions)}dispatch(e){this.actions.Transition.forEach(i=>{i.object.currentTransitionEvent!==this&&(i.object.currentTransitionEvent=this,i.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let r=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(i=>i.seek(r)),this.actions.Animation.forEach(i=>i.seek(t)),this.actions.Create.forEach(i=>i.dispatchThrottled()),this.actions.SetVariable.forEach(i=>i.checkConditions()),this.actions.SetVariable.forEach(i=>i.dispatch()),this.actions.DynamicVariablePlay.forEach(i=>i.dispatch()),this.actions.ClearLocalStorage.forEach(i=>i.dispatch()),this.actions.UserAPI.forEach(i=>i.dispatch())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},bHe=class{constructor(e,t,r,i,n,s,a){this.id=e,this.data=t,this.object=r,this.domElement=s,this.eventManager=a,this.scrollStart=0,this.scrollEnd=0,this.actions=ds(t,t.actions,i,n,a,r)}getStickyParentElement(){let e=this.domElement;for(;e;){if(window.getComputedStyle(e).position==="sticky")return e;e=e.parentElement}return null}computeScrollBounds(){let e=this.getStickyParentElement(),t=e?.parentElement,r=this.domElement.getBoundingClientRect(),i={top:r.top,bottom:r.bottom,left:r.left,right:r.right,width:r.width,height:r.height};if(t){let c=t.getBoundingClientRect(),u=window.getComputedStyle(e),d=parseFloat(u.marginTop)+parseFloat(u.marginBottom),f=parseFloat(u.top),m=parseFloat(u.bottom),v=c.height-d;if(!isNaN(f))r.top===f?(i.top+=c.top-f,i.bottom+=c.top-f):r.top<0&&(i.top-=v-r.height,i.bottom-=v-r.height);else if(!isNaN(m)){let y=document.body.clientHeight??window.innerHeight,x=window.innerWidth-(document.documentElement.clientWidth??window.innerWidth);r.bottom===y-m?(i.top+=c.top-r.height+m+x,i.bottom+=c.top-r.height+m+x):r.bottom<y-m&&(i.top-=v-r.height,i.bottom-=v-r.height)}}let n=document.body,s=document.documentElement,a=window.pageYOffset||s.scrollTop||n.scrollTop,o=s.clientTop||n.clientTop||0,l=Math.round(i.top+a-o);if(this.data.startFrom==="enter"){let c=window.innerHeight,u=i.height,d=this.data.enterAnchor,f=d==="top"?c:d==="bottom"?c-u:c-u*.5;this.scrollStart=l-f}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=i,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){Xs(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:e,y:t}){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let r=this.scrollEnd-this.scrollStart,i=Math.min(1,Math.max(0,(t-this.scrollStart)/r));this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Animation.forEach(n=>n.seek(i)),this.actions.Create.forEach(n=>n.dispatchThrottled()),this.actions.SetVariable.forEach(n=>n.checkConditions()),this.actions.SetVariable.forEach(n=>n.dispatch()),this.actions.DynamicVariablePlay.forEach(n=>n.dispatch()),this.actions.ClearLocalStorage.forEach(n=>n.dispatch()),this.actions.UserAPI.forEach(n=>n.dispatch())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch())}},wHe=class extends Ha{constructor(e,t){super(e),this.managers=t,this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([r,i])=>{i.forEach(n=>n.handleResize())})},this.onScroll=r=>{if(!this.isInview)return;let i={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([n,s])=>{n.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:i}),s.forEach(a=>a.dispatch(i))})},this.onWheel=r=>{!this.isInview||r.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:r.deltaY}),n.forEach(s=>s.dispatch(r.deltaY))})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{if(!r||!i)return;let s=Y_(r);s&&s==="Scroll"&&(i.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),this.wheelEventsPerObject.get(i)?.forEach(a=>{a.dispatchUserEvent(n)}))}}connect(){let{page:e,sharedAssets:t,domElement:r,isExport:i}=this.eventContext,n=s=>{if(s.data?.events.length){for(let{id:a,data:o}of s.data.events)if(!o.disabled&&o.type==="Scroll")if(o.trigger==="load"||!i){let l=new xHe(a,o,s,e,t,this.managers);this.wheelEventsPerObject.has(s)?this.wheelEventsPerObject.get(s)?.push(l):this.wheelEventsPerObject.set(s,[l])}else{let l=new bHe(a,o,s,e,t,r,this.managers);this.scrollEventsPerObject.has(s)?this.scrollEventsPerObject.get(s)?.push(l):this.scrollEventsPerObject.set(s,[l])}}};e.traverseEntity(s=>{(s instanceof ja||s instanceof Hs)&&s.frame?.traverse(a=>{n(a)}),n(s)}),this.intersectionObserver=new IntersectionObserver(s=>{let a=s[0];a&&(this.isInview=a.isIntersecting)},{root:null}),this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([s,a])=>{a.forEach(o=>o.connect()),s.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([s,a])=>{a.forEach(o=>o.connect()),s.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(s=>s.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(s=>s.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(r=>r.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},_He=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=ds(t,t.actions,i,n,s,r)}disconnect(){Xs(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof gg?t.interaction.audioPlayer.play():t.interaction instanceof _5&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let r=t.interaction.data.triggerAfter??"autoplay";r===e&&(t.interaction instanceof gp?t.interaction.play(r==="autoplay"):t.interaction instanceof T5&&t.interaction.dispatch())}),this.actions.Particles.forEach(t=>{(t.data.triggerAfter??"any")===e&&t.dispatchBasic()})}async seekVideos(e){let t=[];this.actions.Video.forEach(r=>{(r.interaction.data.triggerAfter??"autoplay")==="autoplay"&&r.interaction instanceof gp&&t.push(r.interaction.seek(e))}),await Promise.all(t)}pauseVideos(){this.actions.Video.forEach(e=>{e.interaction instanceof gp&&e.interaction.pause()})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.Reset.forEach(t=>t.dispatch()),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof gg?t.interaction.audioPlayer.play():t.interaction instanceof _5&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof gp?t.interaction.play():t.interaction instanceof T5&&t.interaction.dispatch()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()})}},SHe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:r,isExport:i}=this.eventContext,n=i?document:r;n.removeEventListener("pointerdown",this.onAny),n.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([s,a])=>{s.dispatchEvent({type:"beginEvent",eventName:"Start"}),a.forEach(o=>{o.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.actions.Audio.forEach(s=>{s.interaction instanceof gg&&s.interaction.audioPlayer.play()}),n.actions.Video.forEach(s=>{let a=s.interaction.data.triggerAfter??"autoplay";s.interaction instanceof gp&&s.interaction.play(a==="autoplay")}),n.actions.Particles.forEach(s=>{s.dispatchBasic()})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),i.forEach(n=>{n.dispatchAfter("autoplay")})})},this.seekVideos=async r=>{let i=[];[...this.eventsAfterPerObject.entries()].forEach(([n,s])=>{s.forEach(a=>{i.push(a.seekVideos(r))})}),await Promise.all(i)},this.pauseVideos=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,i])=>{i.forEach(n=>{n.pauseVideos()})})},this.onUserEvent=({eventName:r,target:i,reverse:n})=>{if(!r||!i)return;let s=Y_(r);s&&s==="Start"&&(i instanceof Qs||i.dispatchEvent({type:"beginEvent",eventName:"Start"}),this.eventsPerObject.get(i)?.forEach(a=>{a.dispatchUserEvent(n)}),this.eventsAfterPerObject.get(i)?.forEach(a=>{a.dispatchUserEvent(n)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext,r=i=>{if(i.data?.events.length)for(let{id:n,data:s}of i.data.events){if(s.disabled||s.type!=="Start")continue;let a=new _He(n,s,i,t,e,this.eventManager);(a.actions.Transition.length||a.actions.Animation.length||a.actions.SwitchCamera.length||a.actions.Create.length||a.actions.Destroy.length||a.actions.SceneTransition.length||a.actions.Reset.length||a.actions.SetVariable.length||a.actions.DynamicVariablePlay.length||a.actions.ClearLocalStorage.length||a.actions.UserAPI.length)&&(this.eventsPerObject.has(i)?this.eventsPerObject.get(i)?.push(a):this.eventsPerObject.set(i,[a])),a.actions.Audio.length&&(this.eventsAfterPerObject.has(i)?this.eventsAfterPerObject.get(i)?.push(a):this.eventsAfterPerObject.set(i,[a])),a.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(i)?this.eventsAfterPerObject.get(i)?.push(a):this.eventsAfterPerObject.set(i,[a])),a.actions.Particles.length&&(this.eventsAfterPerObject.has(i)?this.eventsAfterPerObject.get(i)?.push(a):this.eventsAfterPerObject.set(i,[a]))}};if(t.traverseEntity(i=>{(i instanceof ja||i instanceof Hs)&&i.frame?.traverse(n=>{r(n)}),r(i)}),[...this.eventsAfterPerObject.values()].some(i=>i.length)){if(this.eventManager.activateCount===0){let{domElement:i,isExport:n}=this.eventContext,s=n?document:i;s.addEventListener("pointerdown",this.onMouseDown,{once:!0}),s.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),s.addEventListener("pointerdown",this.onAny),s.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([a,o])=>{a.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(s=>s.dispatch()),i.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,r=t?document:e;r.removeEventListener("pointerdown",this.onMouseDown),r.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),r.removeEventListener("pointerdown",this.onAny),r.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.removeEventListener("userEvent",this.onUserEvent),n.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(r=>r.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},EHe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.initialDisabled=!1,this.actions=ds(t,t.actions,i,n,s,r),this.target=t.target}disconnect(){Xs(this.actions)}dispatch(e){this.initialDisabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.actions.Transition.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Animation.forEach(t=>{t.data.runMode==="Toggle"?t.toggle():t.play()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.SetVariable.forEach(t=>t.checkConditions()),this.actions.SetVariable.forEach(t=>t.dispatch()),this.actions.DynamicVariablePlay.forEach(t=>t.dispatch()),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Particles.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}),this.actions.ClearLocalStorage.forEach(t=>t.dispatch()),this.actions.UserAPI.forEach(t=>t.dispatch()))}},AHe=class extends Ha{constructor(e,t,r,i,n){super(e),this.sharedVariables=t,this.eventManager=r,this.needsMouse=i,this.needsRaycast=n,this.dynamicVars=[],this.variablesToWatch=[],this.prevMouseProperty=null,this.prevRaycastProperty=null,this.pauseTime=0,this.isOutOfFocus=!1,this.events=[],this.onFrame=s=>{let a=this.eventContext.sharedAssets;if(this.rafId=window.requestAnimationFrame(this.onFrame),this.isOutOfFocus)return;let o=new Date,l=[],c=[];for(let f=0;f<this.propertiesToWatch.length;f++){let{objectId:m,property:v,prevValue:y}=this.propertiesToWatch[f],x=this.eventContext.scene.find(m),w=aL.propertyPaths[v];if(w[0]==="width"||w[0]==="height"||w[0]==="depth")x=x.geometry.userData.parameters[w[0]];else for(let _=0;_<w.length;_++)x=x[w[_]];y===null?this.propertiesToWatch[f].prevValue=x instanceof V?x.clone():x:(x instanceof V?!x.equals(y):y!==x)&&(c.push({objId:m,property:v}),x instanceof V?this.propertiesToWatch[f].prevValue.copy(x):this.propertiesToWatch[f].prevValue=x)}for(let f=0;f<this.variablesToWatch.length;f++){let{id:m,prevValue:v}=this.variablesToWatch[f],y=a.getVariable(m);y!==v&&(l.push(m),this.variablesToWatch[f].prevValue=y)}for(let f=0;f<this.dynamicVars.length;f++){let{id:m,expectedTime:v,last:y,data:x,timerSeconds:w,startValue:_}=this.dynamicVars[f],S=1e3;if((x.dynamicVariableType==="timer"||x.dynamicVariableType==="stopwatch")&&x.format==="number3decimal"?S=1:x.dynamicVariableType==="counter"?S=x.updateInterval:x.dynamicVariableType==="random"&&(S=x.isStatic?1/0:x.updateInterval),v===-1){this.dynamicVars[f].last=s,this.dynamicVars[f].expectedTime=s+S;continue}if(!((a.getDynamicVariablePlayState(m)==="Stopped"||a.getDynamicVariablePlayState(m)==="Restarted")&&(this.dynamicVars[f].last=s,this.dynamicVars[f].expectedTime=s+S,x.dynamicVariableType==="counter"&&a.getVariable(m)!==_&&(a.updateVariable(m,_),this.eventManager.requestRender()),(x.dynamicVariableType==="timer"||x.dynamicVariableType==="stopwatch")&&this.dynamicVars[f].timerSeconds!==_&&(this.dynamicVars[f].timerSeconds=_,a.updateVariable(m,Il.getFormattedTimerTime(_,x)),this.eventManager.requestRender()),a.getDynamicVariablePlayState(m)==="Restarted"&&a.setDynamicVariablePlayState(m,"Playing"),a.getDynamicVariablePlayState(m)==="Stopped"))){if(a.getDynamicVariablePlayState(m)==="Paused"){this.dynamicVars[f].deltaToExpectedTime===void 0&&(this.dynamicVars[f].deltaToExpectedTime=Math.max(this.dynamicVars[f].expectedTime-s,0)),this.dynamicVars[f].last=s-(S-this.dynamicVars[f].deltaToExpectedTime),this.dynamicVars[f].expectedTime=s+this.dynamicVars[f].deltaToExpectedTime;continue}else this.dynamicVars[f].deltaToExpectedTime=void 0;if(s>=v)if(this.dynamicVars[f].last=s,this.dynamicVars[f].expectedTime+=S,x.dynamicVariableType==="random"){let P=x.min+Math.random()*(x.max-x.min),M=x.decimals;P=Math.round(P*Math.pow(10,M))/Math.pow(10,M),a.updateVariable(m,P),l.push(m),this.eventManager.requestRender()}else if(x.dynamicVariableType==="counter"){let P=a.getVariable(m),M=a.getDynamicVariableToggleIsForward(m)??!0,C=a.getVariable(m)+x.increment*(M?1:-1);x.hasEnd&&(C=x.increment>0?Ct.clamp(C,_,x.endValue):Ct.clamp(C,x.endValue,_),C===_&&a.setDynamicVariableToggleIsForward(m,void 0),x.repeat?C===x.endValue&&(C=_):(C===_||C===x.endValue)&&a.setDynamicVariablePlayState(m,"Paused")),C!==P&&(l.push(m),a.updateVariable(m,C),this.eventManager.requestRender())}else if(x.dynamicVariableType==="time"){let P=a.getVariable(m),M=rX(o,x);if(typeof P=="object"&&"textValue"in P&&typeof M=="object"&&"textValue"in M){if(Array.isArray(P.textValue)&&Array.isArray(M.textValue)){if(P.textValue.every((C,T)=>C===M.textValue[T]))continue}else if(P.textValue===M.textValue)continue}else if(P===M)continue;a.updateVariable(m,M),l.push(m),this.eventManager.requestRender()}else{let P=ga.isTextValue(x.endValue)?H$(x.endValue.textValue):x.endValue,M=a.getDynamicVariableToggleIsForward(m)??!0,C=w+(s-y)/1e3*(x.dynamicVariableType==="timer"?-1:1)*(M?1:-1);C=Math.max(C,0),x.hasEnd&&(C=x.dynamicVariableType==="stopwatch"?Ct.clamp(C,_,P):Ct.clamp(C,P,_),C===_&&a.setDynamicVariableToggleIsForward(m,void 0),x.repeat?Math.abs(C-P)<(x.format==="number3decimal"?1e-4:.1)&&(C=_):(Math.abs(C-_)<(x.format==="number3decimal"?1e-4:.1)||Math.abs(C-P)<(x.format==="number3decimal"?1e-4:.1))&&a.setDynamicVariablePlayState(m,"Paused")),C!==w&&(l.push(m),this.dynamicVars[f].timerSeconds=C,a.updateVariable(m,Il.getFormattedTimerTime(C,x)),this.eventManager.requestRender())}}}let u=!1;a.mouseProperty!==this.prevMouseProperty&&(this.prevMouseProperty=a.mouseProperty,u=!0);let d=!1;a.raycastProperty!==this.prevRaycastProperty&&(this.prevRaycastProperty=a.raycastProperty,d=!0),this.events.forEach(f=>{(l.includes(f.data.variableId)||c.find(m=>m.objId===f.data.objectId&&m.property===f.data.property)||f.data.variableId==="mouseProperty"&&u||f.data.variableId==="raycastProperty"&&d)&&(f.dispatch(),this.eventManager.requestRender())})},this.onBlur=()=>{this.pause()},this.onFocus=()=>{this.resume()}}pause(){this.isOutOfFocus||(this.isOutOfFocus=!0,this.pauseTime=Date.now())}resume(){if(!this.isOutOfFocus)return;this.isOutOfFocus=!1;let e=Date.now()-this.pauseTime;for(let t=0;t<this.dynamicVars.length;t++)this.dynamicVars[t].last+=e,this.dynamicVars[t].expectedTime+=e}connect(){this.eventContext.page.traverseEntity(t=>{t.data?.events.filter(r=>r.data.type==="VariableChange"&&!r.data.disabled).forEach(r=>{this.events.push(new CHe(r.id,r.data,t,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.propertiesToWatch=this.events.filter(t=>t.data.variableId==="objectProperty"&&t.data.objectId!==null).map(t=>({objectId:t.data.objectId,property:t.data.property,prevValue:null}));let e=this.eventContext.sharedAssets;this.sharedVariables.forEach(({id:t,data:r})=>{if(!("dynamicVariableType"in r)){this.events.find(n=>n.data.variableId===t)&&this.variablesToWatch.push({id:t,prevValue:e.getVariable(t)});return}let i;if(r.dynamicVariableType==="timer"||r.dynamicVariableType==="stopwatch"){let n;if(ga.isTextValue(r.value)&&Array.isArray(r.value.textValue)){let s=r.value.textValue;s.length===3?n=s[2]+s[1]*60+s[0]*3600:n=s[1]+s[0]*60}else n=r.value;i=n,this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:r,timerSeconds:n,startValue:i})}else r.dynamicVariableType==="time"&&e.updateVariable(t,rX(new Date,r)),r.dynamicVariableType==="counter"&&(i=ga.isTextValue(r.value)?H$(r.value.textValue):r.value),this.dynamicVars.push({id:t,last:-1,expectedTime:-1,data:r,startValue:i})}),this.rafId=window.requestAnimationFrame(this.onFrame),window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus)}disconnect(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),this.rafId&&(window.cancelAnimationFrame(this.rafId),this.rafId=void 0),this.events.forEach(e=>e.dispose())}},CHe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=ds(t,t.actions,i,n,s,r)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}dispose(){Xs(this.actions)}};function H$(e){return e.length===3?e[2]+e[1]*60+e[0]*3600:e[1]+e[0]*60}var THe="https://unpkg.com/@splinetool/runtime@1.10.37/build/",MHe="https://unpkg.com/@splinetool/navmesh-wasm@1.10.37/build/",PHe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${THe}' + 'navmesh.js'),
		fetch('${MHe}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,DHe=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,NHe=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,kHe=.001,RHe={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},cle,Hr,aa;TOe.then(e=>{cle=e,Hr=new e.Vec3,aa=new e.Vec3});var IHe=new V,OHe=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=r=>{if(nr.length!==1)return;let{raycaster:i,page:n}=this.eventContext;this.eventContext.updateRaycaster(r);let s=n.raycastWithClones(i);if(s.length!==0){if(this.gameControl){let a=IHe.copy(this.gameControl.colliderWorldPosition);a.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(a,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(r,i)=>n=>{let s;if(n instanceof Ul)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;s=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof va)s=n.object;else if(s=n,s.dataPatched.cloner?.disabled===!1&&s.dataPatched.cloner?.hideBase&&s.dataPatched.physics?.fusedBody!==!0)return!0;if(i&&!s.userData.navmesh)return;let a=s.dataPatched;if(!a.visible&&a.physics?.enabled!==!0)return!0;n.updateMatrixWorldSVD();let o=sP(a),l=s.userData.hasDestroy,c=s.userData.hasDrag,u=!1,d=!1;for(let f of a.events)f.data.disabled!==!0&&(f.data.type==="GameControl"?u=!0:f.data.type==="Follow"&&(d=!0));if(u||o||d||l||c)return!0;if(this.usePhysics&&a.physics?.rigidBody==="dynamic"){if(this.usePhysics&&a.physics?.fusedBody)return!0}else if("geometry"in n&&n.geometry&&r.push(ah(n.geometry,n.matrixWorld)),this.usePhysics&&a.physics?.fusedBody)return n.traverseObject((f,m)=>{if(m===0)return;let v;if(f instanceof Ul)if(f.objectForSample){if(f.objectForSample.dataPatched.physics.fusedBody)return;v=f.object}else return f.object.dataPatched.physics.fusedBody===!0&&f.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(f instanceof va)v=f.object;else if(v=f,f.dataPatched.cloner?.hideBase)return!0;let y=v.dataPatched;if(!y.visible&&y.physics?.enabled!==!0)return!0;"geometry"in f&&f.geometry&&r.push(ah(f.geometry,f.matrixWorld))}),!0},this.traverseNoPhysics=(r,i)=>n=>{let s;if(n instanceof Ul)return;n instanceof va?s=n.object:s=n;let a=s.dataPatched;if(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)return!0;if(i&&!s.userData.navmesh)return;let o=n.geometry,l=s.userData.hasDestroy===!0,c=s.userData.hasDrag===!0;if(sP(a)||l||c||s.dataPatched.events.some(u=>u.data.disabled!==!0&&u.data.type==="GameControl"))return!0;o&&r.push(ah(o,n.matrixWorld))},this.navmeshWasm=cle,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?PHe:DHe)+NHe])),this._worker=new Worker(this._workerURL)}init(e,t,r){this.gameControl=t,this.eventContext=r,this.setDefaultQueryExtent(new V().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(r.page,e,i=>{this.buildFromNavmeshData(i.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,r){t.objects.forEach(l=>{let c=e.scene.find(l);c.traverseEntity(u=>{u.userData.navmesh=!0}),c.cloner?.traverseObject(u=>{u.userData.navmesh=!0})});let i=[],n=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(i,t.zones==="custom");if(e.traverseChildren(n),t.objects.forEach(l=>{let c=e.scene.find(l);c.traverseEntity(u=>{u.userData.navmesh=void 0}),c.cloner?.traverseObject(u=>{u.userData.navmesh=void 0})}),i.length===0)return!1;let s=mg(i),{positions:a,triIndices:o}=Y3(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([a,a.length/3,o,o.length,{...RHe,...t}]),this._worker.onmessage=r,!0}createDebugNavGeometry(){let e,t,r=this.navMesh.getDebugNavMesh(),i=r.getTriangleCount(),n=new Uint32Array(i*3),s=new Float32Array(i*3*3);for(e=0;e<i*3;e++)n[e]=e;for(e=0;e<i;e++)for(t=0;t<3;t++){let o=r.getTriangle(e).getPoint(t);s[e*9+t*3+0]=o.x,s[e*9+t*3+1]=o.y,s[e*9+t*3+2]=o.z}let a=new Lt;return a.setIndex(new Jt(n,1)),a.setAttribute("position",new Jt(s,3)),a}getClosestPoint(e){return Hr.x=e.x,Hr.y=e.y,Hr.z=e.z,this.navMesh.getClosestPoint(Hr)}getClosestPointToRef(e,t){Hr.x=e.x,Hr.y=e.y,Hr.z=e.z;let r=this.navMesh.getClosestPoint(Hr);t.set(r.x,r.y,r.z)}getRandomPointAround(e,t){return Hr.x=e.x,Hr.y=e.y,Hr.z=e.z,this.navMesh.getRandomPointAround(Hr,t)}getRandomPointAroundToRef(e,t,r){Hr.x=e.x,Hr.y=e.y,Hr.z=e.z;let i=this.navMesh.getRandomPointAround(Hr,t);r.set(i.x,i.y,i.z)}moveAlong(e,t){return Hr.x=e.x,Hr.y=e.y,Hr.z=e.z,aa.x=t.x,aa.y=t.y,aa.z=t.z,this.navMesh.moveAlong(Hr,aa)}moveAlongToRef(e,t,r){return Hr.x=e.x,Hr.y=e.y,Hr.z=e.z,aa.x=t.x,aa.y=t.y,aa.z=t.z,this.navMesh.moveAlong(Hr,aa)}computePath(e,t){let r=this.getClosestPoint(t);if(aa.x=r.x,aa.y=r.y,aa.z=r.z,Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)+Math.pow(t.z-r.z,2))>this.getDefaultQueryExtent().y)return[];this.getClosestPoint(e);let i=this.navMesh.computePath(Hr,aa),n=i.getPointCount(),s=[];for(let a=0;a<n;a++){let o=i.getPoint(a);s.push(new V(o.x,o.y,o.z))}return s}createCrowd(e,t){return new jHe(this,e,t)}setDefaultQueryExtent(e){Hr.x=e.x,Hr.y=e.y,Hr.z=e.z,this.navMesh.setDefaultQueryExtent(Hr)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,r=this.navmeshWasm._malloc(t),i=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,r,t);i.set(e);let n=new this.navmeshWasm.NavmeshData;n.dataPointer=i.byteOffset,n.size=e.length,this.navMesh.buildFromNavmeshData(n),this.navmeshWasm._free(i.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),r=new Uint8Array(e.size);return r.set(t),this.navMesh.freeNavmeshData(e),r}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),this.eventContext?.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,r){return Hr.x=e.x,Hr.y=e.y,Hr.z=e.z,this.navMesh.addCylinderObstacle(Hr,t,r)}addBoxObstacle(e,t,r){return Hr.x=e.x,Hr.y=e.y,Hr.z=e.z,aa.x=t.x,aa.y=t.y,aa.z=t.z,this.navMesh.addBoxObstacle(Hr,aa,r)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},jHe=class{constructor(e,t,r){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,r,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,r){let i=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;i.radius=t.radius,i.height=t.height,i.maxAcceleration=t.maxAcceleration,i.maxSpeed=t.maxSpeed,i.collisionQueryRange=t.collisionQueryRange,i.pathOptimizationRange=t.pathOptimizationRange,i.separationWeight=t.separationWeight,i.updateFlags=7,i.obstacleAvoidanceType=0,i.queryFilterType=0,i.userData=0;let n=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),i);return this.transforms.push(r),this.agents.push(n),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new V(0,0,0)),n}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let r=this.crowd.getAgentPosition(e);t.set(r.x,r.y,r.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let r=this.crowd.getAgentVelocity(e);t.set(r.x,r.y,r.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let r=this.crowd.getAgentNextTargetPath(e);t.set(r.x,r.y,r.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let r=this.agents.indexOf(e);r>-1&&(this._agentDestinationArmed[r]=!0,this._agentDestination[r].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let r=this.crowd.getAgentParameters(e);t.radius!==void 0&&(r.radius=t.radius),t.height!==void 0&&(r.height=t.height),t.maxAcceleration!==void 0&&(r.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(r.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(r.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(r.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(r.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,r)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=kHe)return;let t=1/60,r=10;{let i=Math.floor(e/t);i>r&&(i=r),i<1&&(i=1);let n=e/i;for(let s=0;s<i;s++)this.crowd.update(n)}for(let i=0;i<this.agents.length;i++){let n=this.agents[i],s=this.getAgentPosition(n);if(this.transforms[i].copy(s),this._agentDestinationArmed[i]){let a=s.x-this._agentDestination[i].x,o=s.z-this._agentDestination[i].z,l=this.reachRadii[i],c=this._agentDestination[i].y-this.reachRadii[i],u=this._agentDestination[i].y+this.reachRadii[i],d=a*a+o*o;s.y>c&&s.y<u&&d<l*l&&(this.onReachTarget(n,this._agentDestination[i]),this._agentDestinationArmed[i]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,r=this.crowd.getCorners(e),i=r.getPointCount(),n=[];for(t=0;t<i;t++){let s=r.getPoint(t);n.push(new V(s.x,s.y,s.z))}return n}dispose(){this.crowd.destroy()}};function LHe(e){let t=!1;return e.scene.objects.forEach(r=>{r.data.type==="Page"&&!t&&r.data.publish.gameControlObject&&V2.traverseModuleInstances(e,r.id,(i,n,s)=>{for(let a of s)a.data.type==="GameControl"&&a.data.navmesh.enabled&&(t=!0)})}),t}var zHe={type:"change"},G$={type:"changeZoom"},BHe={type:"changePan"},Um={type:"start"},Hm={type:"end",changed:!0},FHe={type:"end",changed:!1},SI=new ar,W$=new ge,VHe=2*Math.PI,UHe=1e-8,HHe=.01,EI=new V,dC=new ge,AI=new V,hC=new ar,q$=new ot,GHe={type:"requestRender"},ule=class extends wa{constructor(e,t,r={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=r,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Sl.DOLLY_ROTATE,Sl.PAN],this.offset=new V,this.eye=new V,this.lastPosition=new V,this.lastQuaternion=new ar,this.current=new ge,this.overShoot=new ge,this.overRatio=new ge,this.spherical=new bW,this.sphericalDelta=new bW,this.panOffset=new V,this.panLeftV=new V,this.panUpV=new V,this.panV=new V,this.rotateStart=new ge,this.rotateEnd=new ge,this.rotateDelta=new ge,this.panStart=new ge,this.panEnd=new ge,this.panDelta=new ge,this.dollyStart=new ge,this.dollyEnd=new ge,this.dollyDelta=new ge,this.rotationRangeFactor=new ge,this.panRangeFactor=new ge,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.hoverRotateDamping=this.dampingFactor,this.isCurrentlyDamping=!1,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=i=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=i.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(AI,hC,EI),this.offset.copy(AI).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&this.object.isPerspectiveCamera&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(SI.copy(hC).invert()),this.panOffset.applyQuaternion(SI),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(hC),this.panOffset.applyQuaternion(hC)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),AI.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(q$.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(q$));let i=this.spherical.phi%VHe;if(this.eye.copy(this.offset).normalize(),this.object.up.copy(Ei.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),i>0&&i>Math.PI||i<0&&i>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0){let n=this.hoverRotatePanMode===1?this.hoverRotateDamping:this.dampingFactor;this.sphericalDelta.theta*=1-n,this.sphericalDelta.phi*=1-n}else this.sphericalDelta.set(0,0,0);if(this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>HHe||8*(1-this.lastQuaternion.dot(this.object.quaternion))>UHe){this.dispatchEvent(zHe),this.object.dispatchEvent(GHe),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,this.isCurrentlyDamping=!0;return}this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),this.isCurrentlyDamping=!1},this.onPointerDown=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&nl?this.onPointerDownTouch(i):this.onPointerDownMouse(i),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(Um),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&nl||this.domElement.setPointerCapture(i.pointerId)))},this.onPointerLeave=i=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,EI.subVectors(this.position0,this.target0),this.spherical.setFromVector3(EI),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=i},this.onPointerEnter=i=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?dC.set(i.clientX-this.domElement.clientWidth/2,i.clientY-this.domElement.clientHeight/2):dC.set(i.clientX-this.pointerLeaveEvent.clientX,i.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(dC).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(W$,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(i.clientX,i.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(dC).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(i.clientX,i.clientY)),this.update()},this.onPointerMove=i=>{this.enabled!==!1&&(this.checkRaycastLock()||(i.pointerType==="touch"||i.pointerType==="pen"&&nl?this.onPointerMoveTouch(i):this.onPointerMoveMouse(i),i.stopPropagation()))},this.onPointerUp=i=>{this.isPointerDown=!1,nr.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),nr.length>1&&i.preventDefault(),this.hasChange?this.dispatchEvent(Hm):this.dispatchEvent(FHe),this.state=-1,i&&(i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&nl||this.domElement.releasePointerCapture(i.pointerId))},this.onPointerDownMouse=i=>{let n;switch(this.useKeyEvents?n=this.mouseButtons[i.button]:n=this.mouseButtonsPlay[i.button],n){case 0:if(i.altKey===!0&&!i.shiftKey&&!_A(i)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2;break;case 3:if(_A(i)||i.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}break;case 5:if(_A(i)||i.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=i=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(i);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(i);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(i);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=i=>{switch(nr.length>1&&i.preventDefault(),this.touches[nr.length-1]){case Sl.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case Sl.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case Sl.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case Sl.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=i=>{switch(nr.length>1&&i.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(i),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(i),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(i),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(i),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=j2(()=>this.dispatchEvent(Hm),33),this.onMouseWheel=i=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&i.preventDefault(),this.dispatchEvent(Um),this.handleMouseWheel(i),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=i=>{if(i.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!B_)if(i.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(Um),i.scale>this.prevScale?this.dollyIn(this.getZoomScale()):i.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=i.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(Hm)},this.onContextMenu=i=>{i.preventDefault()},this.onTouchEnd=i=>{i.preventDefault()},this.onKeyDown=i=>{this.enabled!==!1&&(this.key=i.key,i.key===" "&&this.dispatchEvent(Um))},this.onKeyUp=i=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&i.key==="Alt"&&this.onPointerUp(nr[0]),i.key===" "&&this.dispatchEvent(Hm))},this.onPointerHover=i=>{i.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(i,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(i,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=i=>{i.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.initialSphericalRadius=this.spherical.radius,this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.hoverRotateDamping=e.hoverRotateDamping??this.dampingFactor,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let r=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=r**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/this.maxZoom,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let i=this.object.getTarget().applyQuaternion(SI.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+i.y,this.maxV=e.panVerticalOffset.max+i.y,this.minH=-e.panHorizontalOffset.min+i.x,this.maxH=e.panHorizontalOffset.max+i.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=_u(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=_u(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=_u(_u(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=_u(_u(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=Sl.ROTATE),e.panTouches===1&&(this.touches[0]=Sl.PAN),e.orbitTouches===2&&(this.touches[1]=Sl.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=Sl.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=Sl.ROTATE),e.panTouches===3&&(this.touches[2]=Sl.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,r,i,n,s,a,o){this.overShoot.set(0,0);let l,c,u;e instanceof V?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),u=!0):(l=e.theta,c=e.phi,this.current.set(_u(this.spherical.theta),_u(this.spherical.phi)),u=!1),r===0&&(this.current.x+=l,this.current.y+=c),(t===3||t===2)&&(!u&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<n&&this.current.x>0&&(this.overShoot.x=n-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<n&&(this.overShoot.x=n-this.current.x)),(t===3||t===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y)),u||(this.overShoot.x=_u(this.overShoot.x),this.overShoot.y=_u(this.overShoot.y)),r!==0?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),r===1&&(this.overRatio.x=Y$(Math.abs(this.overRatio.x)),this.overRatio.y=Y$(Math.abs(this.overRatio.y))),this.isPointerDown||r===1?r===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):r===2&&(!u&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||u&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),u?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):u?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof V?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let r=this.domElement;if(r&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let n=this.panV.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*n/r.clientHeight,this.object.matrixWorld),this.panUp(2*t*n/r.clientHeight,this.object.matrixWorld)}else r&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrixWorld));this.dispatchEvent(BHe)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(G$)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(G$)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(Um),this.dollyOut(e),this.dispatchEvent(Hm)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(Um),this.dollyIn(e),this.dispatchEvent(Hm)}setZoom(e){if(this.dispatchEvent(Um),this.object.isPerspectiveCamera){let t=this.initialSphericalRadius/e/this.spherical.radius;this.scale=t}else this.object.isOrthographicCamera&&(this.object.zoom=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0);this.dispatchEvent(Hm)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(W$,-this.object.angleOffsetFromUp);let r=this.domElement,i=this.useWindowEvents?window.innerHeight:r.clientHeight,n=2*Math.PI*this.rotateDelta.x/i,s=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(n),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(wOe===!1&&_A(e)===!1&&SOe(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1||this.gesture)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(nr.length===2){let e=.5*(nr[0].pageX+nr[1].pageX),t=.5*(nr[0].pageY+nr[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(nr[0].pageX,nr[0].pageY)}handleTouchStartPan(){if(nr.length===2){let e=.5*(nr[0].pageX+nr[1].pageX),t=.5*(nr[0].pageY+nr[1].pageY);this.panStart.set(e,t)}else this.panStart.set(nr[0].pageX,nr[0].pageY)}handleTouchStartDolly(){let e=nr[0].pageX-nr[1].pageX,t=nr[0].pageY-nr[1].pageY,r=Math.sqrt(e*e+t*t);this.dollyStart.set(0,r)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(nr.length===2){let r=p4(e),i=.5*(e.pageX+r.x),n=.5*(e.pageY+r.y);this.rotateEnd.set(i,n)}else{if(e.pointerId!==nr[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(nr.length===2){let t=p4(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.panEnd.set(r,i)}else{if(e.pointerId!==nr[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=p4(e),r=e.pageX-t.x,i=e.pageY-t.y,n=Math.sqrt(r*r+i*i);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let e=this.options?.showCameraLock;return e&&e(),!0}}else return!1}};function _u(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function Y$(e){return 1-Math.pow(1-e,4)}var X$=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.page=i,this.currentIntersectedObjects=[],this.actions=ds(t,t.actions,i,n,s,r),this.target=t.target,this.triggeringObjects=[];for(let a of t.triggeringObjects){let o=i.scene.find(a);o&&this.triggeringObjects.push(o)}}isValidTriggeringObject(e){return this.target==="all"?!0:this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){Xs(this.actions)}dispatch(){this.object.destroyedInAction||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.actions.Transition.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.SwitchCamera.forEach(e=>{e.data.runMode==="Toggle"?e.toggle():e.play()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Particles.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch()))}},ti;POe.then(e=>ti=e);var Zn=new V,fc=new ar,Bf=new V,CI=new Es(0,0,0,"YXZ"),$$=new Es(0,0,0,"XYZ"),pc=new V,TI=new V,MI=new V(1,1,1),Hv=new ar,fC=new ot,K$=new ot,WHe={type:"updateMatrix"},Q$=new ar,PI=new Oo,D5={type:"beginEvent",eventName:"Collision"},qHe={type:"beginEvent",eventName:"Trigger"};function YHe(e){if(V2.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((r,i)=>{if(i.events){if(Array.isArray(i.events)){for(let n of i.events)if(n.data.disabled!==!0&&n.data.type==="GameControl"&&n.data.collisionEnabled){t=!0;break}}else for(let n of Object.values(i.events))if(n.disabled!==!0&&n.type==="GameControl"&&n.collisionEnabled){t=!0;break}}}),t}var sP=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),XHe=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.skipRender=!0,this.processRigidBody=t=>{if(t.bodyType()!==ti.RigidBodyType.Dynamic)return;t.isSleeping()||this.nActiveRigidBodies++;let[r,i,n]=this.rigidBodyToMesh.get(t.handle);if(Zn.copy(t.translation()).multiplyScalar(this.pixelsPerMeter),fc.copy(t.rotation()),r.matrixWorld.compose(Zn,fc,i),r.hasNonUniformScale&&r.matrixWorld.multiply(r.shearScale),r.dispatchEvent(WHe),n){let s=r.cloner;if(s&&s.objectForSample===void 0){s.matrixWorld.copy(r.matrixWorld);for(let a of s.children)a.updateMatrixWorld(!0)}for(let a of r.children)a.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(t,r,i)=>{if(i===!1)return;let n,s;if(this.sensorToTriggerEvent[t]?(n=this.sensorToTriggerEvent[t],s=this.sharedGameControlGlobals.colliderToEntity.get(r)):this.sensorToTriggerEvent[r]&&(n=this.sensorToTriggerEvent[r],s=this.sharedGameControlGlobals.colliderToEntity.get(t)),n&&s&&n.isValidTriggeringObject(s)){n.dispatch();return}for(let a=this.sharedGameControlGlobals.createdObjects.length-1;a>=0;a--){let o=this.sharedGameControlGlobals.createdObjects[a];if(o.userData.hasCollisionDestroy&&(o.rigidBody?.collider(0).handle===t||o.rigidBody?.collider(0).handle===r)){this.sharedGameControlGlobals.createdObjects.splice(a,1),o.removeFromParent(),requestAnimationFrame(()=>this.sharedGameControlGlobals.rapierWorld?.removeRigidBody(o.rigidBody));break}}if(this.gameControl?.object!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(t)){let a=this.sharedGameControlGlobals.colliderToEntity.get(r),o=this.sharedGameControlGlobals.entityToCollisionEvents[a.uuid];if(o===void 0)return;for(let l of o)l.data.target==="character"&&this.dispatchCollisionEvent(l,a,r)}else if(this.gameControl?.object!==void 0&&this.gameControl.object===this.sharedGameControlGlobals.colliderToEntity.get(r)){let a=this.sharedGameControlGlobals.colliderToEntity.get(t),o=this.sharedGameControlGlobals.entityToCollisionEvents[a.uuid];if(o===void 0)return;for(let l of o)l.data.target==="character"&&this.dispatchCollisionEvent(l,a,t)}else{let a=this.sharedGameControlGlobals.colliderToEntity.get(t),o=this.sharedGameControlGlobals.entityToCollisionEvents[a.uuid];if(o!==void 0)for(let u of o)u.data.target==="scene"&&this.dispatchCollisionEvent(u,a,t);let l=this.sharedGameControlGlobals.colliderToEntity.get(r),c=this.sharedGameControlGlobals.entityToCollisionEvents[l?.uuid];if(c!==void 0)for(let u of c)u.data.target==="scene"&&this.dispatchCollisionEvent(u,l,r)}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=ele,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",r=>{"gamepad"in r.data&&"axes"in r.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(r.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let r of t.events){if(r.data.disabled===!0)continue;let i=r.data.actions?.find(n=>n.data.type==="Destroy")?.data;if(i)for(let n of i.objects){let s=this.page.scene.find(n);s&&(s.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let r of t.events)if(!(r.data.disabled===!0||r.data.type!=="DragDrop"))for(let i of r.data.objects){let n=this.page.scene.find(i);n&&(n.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{let r,i=t instanceof Qw,n=t instanceof Zw;if(t instanceof Ul||i||n)return;t instanceof va?r=t.object:r=t;let s=r.dataPatched;if(s.physics?.enabled==="visibility"?!s.visible:!s.physics?.enabled)return!0;let a=t.geometry,o=r.userData.hasDestroy===!0,l=r.userData.hasDrag===!0;if(sP(s)||o||l||r.dataPatched.events.some(c=>c.data.disabled!==!0&&(c.data.type==="GameControl"||c.data.type==="Follow")))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;a&&e.push(ah(a,t.matrixWorld))}),e.length>0){let t=mg(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new $w(t)}}addRigidBody(e,t,r){if(rle(e.matrixWorld))return;let i=[],n="geometry"in e?e.geometry:void 0,s=t.dataPatched;if(n?.getAttribute("position")!==void 0&&i.push(ah(n,e.shearScale)),s.physics.fusedBody){let a=this.gatherChildrenGeom(e,i);e.traverseObject(a),e.children.forEach(l=>l.updateMatrixWorld(!0));let o=e.cloner;o&&o.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(o.traverseObject(a),o.children.forEach(l=>l.updateMatrixWorld(!0)))}if(i.length>0){let a,o=!r.fromCreate&&s.physics.rigidBody==="dynamic"||r.fromCreate&&r.dynamic;o?(a=ti.RigidBodyDesc.dynamic(),a.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(r.hasTransformAnim||r.hasFollow||r.hasDrag)&&!r.fromCreate?(a=ti.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):a=ti.RigidBodyDesc.fixed();let l=mg(i);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Zn,fc,Bf),e.position0=Zn.clone().divideScalar(this.pixelsPerMeter),e.rotation0=fc.clone(),Zn.divideScalar(this.pixelsPerMeter),a.setTranslation(Zn.x,Zn.y,Zn.z).setRotation(fc),n?l?.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l?.scale(Bf.x/this.pixelsPerMeter,Bf.y/this.pixelsPerMeter,Bf.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(a);o&&this.rigidBodyToMesh.set(c.handle,[e,Bf.clone(),s.physics.fusedBody]);let u=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,t,u)}catch{try{this.addCollider(c,s.physics,l,t,!1)}catch(d){console.error(d)}}e.rigidBody=c}}addBoundsTree(e){let t=[];if(e.geometry?.getAttribute("position")!==void 0&&e.geometry?.getAttribute("position").count>0&&t.push(ah(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(r=>r.updateMatrixWorld(!0)),t.length>0){let r=mg(t,!1);e.bvhGeometry=r,r.getAttribute("position").count>0&&(e.bvhGeometry.boundsTree=new $w(r),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e))}}addCollider(e,t,r,i,n=!0){if(r?.getAttribute("position").count===0||r?.getIndex()?.count===0)return;let s;r&&(t.colliderType==="trimesh"?s=ti.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array):s=ti.ColliderDesc.convexMesh(r.getAttribute("position").array,n?r.getIndex().array:void 0)),s.setFrictionCombineRule(ti.CoefficientCombineRule.Average).setRestitutionCombineRule(ti.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let a=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e);this.sharedGameControlGlobals.colliderToEntity.set(a.handle,i),this.sharedGameControlGlobals.entityToCollisionEvents[i.uuid]?.some(o=>o.target==="scene")&&a.setActiveEvents(ti.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(r,i)=>{if(i===0)return;let n;if(r instanceof Ul)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;n=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof va)n=r.object;else if(n=r,n.dataPatched.cloner?.hideBase)return!0;let s=n.dataPatched;if(s.physics.enabled==="visibility"?!s.visible:!s.physics.enabled)return!0;i===1?e.hasNonUniformScale?r.matrixWorld.multiplyMatrices(e.shearScale,r.hiddenMatrix):r.matrixWorld.copy(r.hiddenMatrix):r.matrixWorld.multiplyMatrices(r.parent.matrixWorld,r.hiddenMatrix),r.matrixWorld.multiply(r.matrix);let a=r.geometry;a?.getAttribute("position")!==void 0&&t.push(ah(a,r.matrixWorld))}}activate(e){if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,r=!1,i=5,n=8,s=9,a="drag",o=this.page.data.publish.gameControlObject,l=o!==null?this.page.find(o):null,c=null;if(l)for(let f of l.data.events){if(f.data.disabled||f.data.type!=="GameControl")continue;let m=l;for(;this.usePhysics&&(m=m.parent)?.parent!==null;)m.data.physics?.fusedBody;f.data.collisionEnabled&&(this.needsCollisionDetection=!0),c===null&&(c=f.data)}if(this.page.traverseEntity(f=>{for(let m of f.dataPatched.events)if(m.data.disabled===!1&&m.data.type==="Trigger")return this.needsCollisionDetection=!0,!0}),l&&c&&(l.data.visible===!0||l.data.physics.enabled===!0)){r=r||c.camera===t.uuid||l.uuid===t.uuid;let f=new tle(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&c.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=f,i=c.joystickPosLoc,n=c.joystickRotLoc,s=c.jumpTouchButtonLoc,a=c.rotByTouch,nl&&c.touchControl&&(this.joystickToGameControls[i]="pos",c.moveMode==="walk"&&(this.joystickToGameControls[s]="jmp"),a==="joystick"&&(this.joystickToGameControls[n]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let f=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new OHe(this.usePhysics,this.isExport);let m;f.collider.type==="sphere"?m=f.collider.radius*2:m=f.collider.height,m=Math.floor(m/f.navmesh.ch-1),this.navigationMeshWrapper.init({...f.navmesh,walkableHeight:m},this.gameControl,this.eventContext)}}if(r===!1){let{enableRotate:f,enablePan:m,enableZoom:v,autoRotate:y,hoverRotatePanMode:x}=this.eventManager.publish.orbitControls;(f||m||v||y||x!==0)&&(this.orbitControls=new ule(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let u=this.renderer.domElement.width/this.renderer.getPixelRatio(),d=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((f,m)=>{let v=document.body.appendChild(document.createElement("div")),[y,x,w]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[m],_=(u-5*y)/4+y,S={},P=f==="jmp",M=P?0:y;m<10?(m<5?S.top=M/2:S.bottom=M/2,S.left=M/2+m%5*_):m===10?(S.left=M/2,S.top=d/2):(S.right=M/2,S.top=d/2),S.top?S.top-=x[1]:S.bottom+=x[1],S.left?S.left+=x[0]:S.right-=x[0];for(let E in S)S[E]+="px";if(P){let E=v.appendChild(document.createElement("div"));Object.assign(E.style,S,{position:"absolute",width:y+"px",height:y+"px",backgroundColor:`rgba(255,255,255,${w==="show"?.4:0})`,zIndex:"9999",borderRadius:y+"px",border:w==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let N=y/16*16*.4;w==="show"&&(E.innerHTML=`
						<svg width="${N}" height="${y*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),E.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),E.addEventListener("touchend",D=>D.preventDefault()),this.joysticks[m]=[void 0,v];return}let C={zone:v,mode:"static",position:S,size:y};w==="hide"&&(C.restOpacity=0);let T=s9e.create(C);T.on("move",(E,N)=>{let D=this.gameControl;f==="pos"?N.force<.2?D.moveForce=0:(D.movementState.movePosZ=Math.sin(-N.angle.radian),D.movementState.movePosX=Math.cos(-N.angle.radian),N.force>1.2?D.movementState.run=1:D.movementState.run=0,N.force<.3?D.moveForce=(N.force-.2)/.1:D.moveForce=1):f==="rot"&&(N.force<.2?D.rotForce=0:(D.movementState.rotPosX=N.vector.y,D.movementState.rotPosY=-N.vector.x,N.force<.3?D.rotForce=(N.force-.2)/.1:D.rotForce=1)),this.requestRender()}),T.on("end",(E,N)=>{let D=this.gameControl;f==="pos"?(D.movementState.movePosZ=0,D.movementState.movePosX=0,D.moveForce=1):f==="rot"&&(D.movementState.rotPosX=0,D.movementState.rotPosY=0,D.rotForce=1)}),this.joysticks[m]=[T,v]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(f=>f.initialDisabled=!1)},80)}initPhysics(){this.sharedGameControlGlobals.rapierWorld?.free(),this.sharedGameControlGlobals.rapierWorld=new ti.World(new ti.Vector3(0,this.gravity,0)),this.events=new ti.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren(a=>{let o;if(a instanceof Ul)if(a.objectForSample){if(a.objectForSample.dataPatched.physics.fusedBody)return;o=a.object}else return a.object.dataPatched.physics.fusedBody===!0&&a.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(a instanceof va)o=a.object;else{if(a instanceof Zw||a instanceof Qw)return;if(o=a,o.dataPatched.cloner?.disabled===!1&&o.dataPatched.cloner?.hideBase&&o.dataPatched.physics?.fusedBody!==!0)return!0}let l=o.dataPatched,c;for(let x of l.events)x.data.disabled!==!0&&x.data.type==="GameControl"&&(c=x.data);if(!l.physics||(l.physics.enabled==="visibility"?!l.visible:!l.physics.enabled))return!0;a.updateMatrixWorldSVD();let u=sP(l),d=!1,f=o.userData.hasDestroy,m=o.userData.hasDrag,v=!1;for(let x of l.events)if(x.data.disabled!==!0){if(x.data.type==="Collision"){d=!0;let w=new EHe(x.id,x.data,o,this.page,this.sharedAssets,this.eventManager);w.initialDisabled=!0,this.collisionEvents.push(w),this.sharedGameControlGlobals.entityToCollisionEvents[o.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[o.uuid].every(_=>_.id!==x.id)?this.sharedGameControlGlobals.entityToCollisionEvents[o.uuid].push(w):this.sharedGameControlGlobals.entityToCollisionEvents[o.uuid]=[w]}else if(x.data.type==="Follow"){v=!0;let w=x.data.target;a.traverseVisible(_=>{_.userData.isFollowingObj=w})}}l.physics.rigidBody==="dynamic"&&l.physics.fusedBody===!1&&(a.matrixWorldFusedFalse=a.matrixWorld.clone());let y=a.geometry;if(c!==void 0){let x=ti.RigidBodyDesc.kinematicPositionBased();(a.hasNonUniformScale?a.matrixWorldRigid:a.matrixWorld).decompose(Zn,fc,Bf),a.position0=Zn.clone().divideScalar(this.pixelsPerMeter),a.rotation0=fc.clone(),Zn.divideScalar(this.pixelsPerMeter),x.setTranslation(Zn.x,Zn.y,Zn.z).setRotation(fc);let w=this.sharedGameControlGlobals.rapierWorld.createRigidBody(x);a.rigidBody=w;let _;c.collider.type==="sphere"?_=ti.ColliderDesc.ball(c.collider.radius/this.pixelsPerMeter):c.collider.type==="capsule"?_=ti.ColliderDesc.capsule((c.collider.height/2-c.collider.radius)/this.pixelsPerMeter,c.collider.radius/this.pixelsPerMeter):_=ti.ColliderDesc.cuboid(c.collider.width/this.pixelsPerMeter/2,c.collider.height/this.pixelsPerMeter/2,c.collider.depth/this.pixelsPerMeter/2),_.setFrictionCombineRule(ti.CoefficientCombineRule.Average).setRestitutionCombineRule(ti.CoefficientCombineRule.Average).setDensity(l.physics.density).setFriction(l.physics.friction).setRestitution(l.physics.restitution);let S=this.sharedGameControlGlobals.rapierWorld.createCollider(_,w);this.sharedGameControlGlobals.colliderToEntity.set(S.handle,o),Zn.fromArray(c.collider.position).multiply(Bf.setFromMatrixScale(o.matrixWorld)).divideScalar(this.pixelsPerMeter),S.setTranslationWrtParent(Zn);let P=new ar().setFromEuler(new Es().setFromVector3(new V().fromArray(c.collider.rotation)));S.setRotationWrtParent(P),S.setActiveEvents(ti.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(o,!0)}else l.physics.rigidBody==="dynamic"||u||v||f||m||d?(this.addRigidBody(a,o,{hasFollow:v,hasTransformAnim:u,hasDrag:m}),this.generateSensorColliderDescs(o,l.physics.fusedBody)):(y&&e.push(ah(y,a.matrixWorld)),l.physics.fusedBody&&a.traverseObject((x,w)=>{if(w===0)return;let _;if(x instanceof Ul)if(x.objectForSample){if(x.objectForSample.dataPatched.physics.fusedBody)return;_=x.object}else return x.object.dataPatched.physics.fusedBody===!0&&x.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else{if(x instanceof Zw||x instanceof Qw)return;if(x instanceof va)_=x.object;else if(_=x,_.dataPatched.cloner?.hideBase)return!0}let S=_.dataPatched;if(S.physics.enabled==="visibility"?!S.visible:!S.physics.enabled)return!0;let P=x.geometry;P?.getAttribute("position")!==void 0&&e.push(ah(P,x.matrixWorld))}),this.generateSensorColliderDescs(o,l.physics.fusedBody,t));if(l.physics?.fusedBody===!0||c)return!0}),e.length===0)return;let r=mg(e);r.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let i=ti.RigidBodyDesc.fixed(),n=this.sharedGameControlGlobals.rapierWorld.createRigidBody(i),s=ti.ColliderDesc.trimesh(r.getAttribute("position").array,r.getIndex().array).setFrictionCombineRule(ti.CoefficientCombineRule.Multiply).setRestitutionCombineRule(ti.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,n);for(let[a,o]of t){let l=this.sharedGameControlGlobals.rapierWorld.createCollider(a,n);this.sensorToTriggerEvent[l.handle]=o}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(t.data.type==="Trigger"&&t.data.disabled!==!0){let r=new X$(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),i=new ot().compose(pc.fromArray(t.data.position),Hv.setFromEuler($$.fromArray(t.data.rotation)),MI);if(t.data.triggerZone==="box"){let n=new Wn;n.min.fromArray(t.data.size).multiplyScalar(-.5),n.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([n,i,e,r])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,i,e,r])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){if(this.isEnabled){this.isEnabled=!1,this.page.traverse(e=>{let t=e;t.matrixWorldFusedFalse&&(t.matrixWorldFusedFalse=void 0),t.rigidBody&&(t.rigidBody=void 0),t.position0&&(t.position0=void 0),t.rotation0&&(t.rotation0=void 0)}),this.sharedGameControlGlobals.rapierWorld?.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),this.gameControl?.reset(),this.gameControl?.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([e,t])=>{e?.destroy(),t.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),this.navigationMeshWrapper?.dispose(),this.navigationMeshWrapper=void 0;for(let e of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))e.forEach(t=>t.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,r){if(!this.isEnabled)return!0;let i=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(this.orbitControls.update(),i=!this.orbitControls.isCurrentlyDamping),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,i=!1):this.initializationCounter===2&&this.gameControl&&(i=!this.gameControl.update(e,t,r)&&i),this.usePhysics===!1&&this.checkTrigger(),this.usePhysics){let n=.016666666666666666;if(e===0)i=this.stepPhysics()&&i;else{let s=e/1e3;s<n&&s>n*.55&&(s=n),this.accumulator+=s;let a=performance.now(),o=0,l=6;for(;this.accumulator>=n&&o<l&&(i=this.stepPhysics()&&i,this.accumulator-=n,o++,!(performance.now()-a>n*1e3)););this.accumulator=this.accumulator%n}}this.skipRender=i}stepPhysics(){for(let e of this.sharedGameControlGlobals.entitiesWithTransformAnim){(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Zn,fc,Bf),CI.setFromQuaternion(fc);let t=e;t.prevR===void 0?(t.prevR=CI.clone(),t.prevT=Zn.clone()):(t.prevR.copy(CI),t.prevT.copy(Zn)),e.rigidBody&&(e.rigidBody.setNextKinematicTranslation(Zn.divideScalar(this.pixelsPerMeter)),e.rigidBody.setNextKinematicRotation(fc))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),this.events?.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,r){let i=(this.sharedGameControlGlobals.rapierWorld?.getCollider(r))._parent,n;if(t.cloner){for(let s of t.cloner.children)if(s.rigidBody===i){n=s;break}}e.dispatch(n),t.dispatchEvent(D5)}updateUseWindowEvents(e){this.orbitControls?.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,r){let i=K$.copy(e.matrixWorld).invert();e.traverseEntity((n,s)=>{if(t===!1&&s===1)return!0;for(let a of n.dataPatched.events)if(a.data.type==="Trigger"&&a.data.disabled!==!0){let o=new X$(a.id,a.data,n,this.page,this.sharedAssets,this.eventManager),l;if(a.data.triggerZone==="box"?l=ti.ColliderDesc.cuboid(...a.data.size.map(c=>c/(2*this.pixelsPerMeter))):l=ti.ColliderDesc.ball(a.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(ti.ActiveEvents.COLLISION_EVENTS),pc.fromArray(a.data.position),Hv.setFromEuler($$.fromArray(a.data.rotation)),fC.compose(pc,Hv,MI).premultiply(n.matrixWorld),r?(fC.decompose(pc,Hv,TI),l.setActiveCollisionTypes(ti.ActiveCollisionTypes.KINEMATIC_FIXED|ti.ActiveCollisionTypes.DYNAMIC_FIXED)):(fC.premultiply(i).decompose(pc,Hv,TI),e.rigidBody.bodyType()===ti.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===ti.RigidBodyType.Fixed?l.setActiveCollisionTypes(ti.ActiveCollisionTypes.KINEMATIC_FIXED|ti.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(ti.ActiveCollisionTypes.KINEMATIC_KINEMATIC|ti.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),pc.divideScalar(this.pixelsPerMeter),l.setTranslation(pc.x,pc.y,pc.z),l.setRotation(Hv),r)r.push([l,o]);else{let c=this.sharedGameControlGlobals.rapierWorld.createCollider(l,e.rigidBody);this.sensorToTriggerEvent[c.handle]=o}}})}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[r,i,n,s]=this.sharedGameControlGlobals.triggers[t];for(let a=0;a<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;a++){let o=this.sharedGameControlGlobals.entitiesWithTransformAnim[a];if(n===o||s.isValidTriggeringObject(Xr.is(o)?o:o.object)===!1)continue;let l=K$.copy(n.matrixWorld).decompose(pc,Q$,TI).compose(pc,Q$,MI).multiply(i),c=fC.copy(o.matrixWorld).invert().multiply(l);r instanceof Wn?e=o.bvhGeometry.boundsTree.intersectsBox(r,c):(PI.radius=r,PI.center.setFromMatrixPosition(c),e=o.bvhGeometry.boundsTree.intersectsSphere(PI)),e?s.currentIntersectedObjects.indexOf(o)===-1&&(s.currentIntersectedObjects.push(o),s.dispatch(),n.dispatchEvent(qHe)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter(u=>u!==o)}}}};function $He(e){let t=this._clip.duration,r=this._clip.start??0,i=this.loop,n=this.time+e,s=this._loopCount,a=i===L6;if(e===0)return s===-1?n:a&&(s&1)===1?t-(n-r):n;if(i===nie){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),n>=t||n<r){let o=Math.floor((n-r)/(t-r));n-=(t-r)*o,s+=Math.abs(o);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a||(n=e>0?t:r,this.repetitions===1&&(n=t)),this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=n;if(a&&(s&1)===1)return t-(n-r)}return n}var Z$=!1,KHe=class{constructor(e,t,r,i){this.scene=e,this.requestRender=t,this.updateDisplayProgress=r,this.animationInspectorState=i,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=n=>{n.data.type==="Empty"&&n.data.animations&&n.data.animations.forEach((s,a)=>{let o=s[0]+"/";if(Array.isArray(n.identity)?o+=n.identity[0]:o+=n.uuid,this.clipIdToAction[o])return;let l=Lj.parse(JSON.parse(s[2]));n.animations[a]=l;let c=this.mixer.clipAction(l,n);Z$===!1&&(Object.getPrototypeOf(c)._updateTime=$He,Z$=!0),c.clampWhenFinished=!0,this.clipIdToAction[o]=c})},this.mixer=new sMe(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let r=this.scene.find(t);if(!r)return;let i=r.animations.find(s=>s.uuid===e);if(!i)return;let n=this.clipIdToAction[e];!n||(n.stop(),this.mixer.uncacheClip(i),delete this.clipIdToAction[e],r.animations=r.animations.filter(s=>s.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=sie}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,r=this.clipIdToAction[t];if(r)return e&&(e.repeat>=0&&(r.repetitions=e.repeat+1),e.direction==="pingpong"&&e.repeat!==0&&(r.loop=L6)),r.play(),r.paused=!1,this.requestRender(),r}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||this.animationInspectorState?.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*(this.maxFrames-1)%(this.maxFrames-1))),this.requestRender()}get maxFrames(){return qoe(this.activeClip??void 0)}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let r=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(e/(this.maxFrames-1),.9999)*this.activeClip.duration),this.requestRender(),r&&(this.clipIdToAction[t].paused=!0)}},DI=new WeakMap,QHe=class extends O_{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){let n=new zj(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,s=>{this.decodeDracoFile(s,t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){let n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};return this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){let r=JSON.stringify(t);if(DI.has(e)){let o=DI.get(e);if(o.key===r)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,n=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(n,s).then(o=>(i=o,new Promise((l,c)=>{i._callbacks[n]={resolve:l,reject:c},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return a.catch(()=>!0).then(()=>{i&&n&&this._releaseTask(i,n)}),DI.set(e,{key:r,promise:a}),a}_createGeometry(e){let t=new Lt;e.index&&t.setIndex(new Jt(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let i=e.attributes[r],n=i.name,s=i.array,a=i.itemSize;t.setAttribute(n,new Jt(s,a))}return t}_loadLibrary(e,t){let r=new zj(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,n)=>{r.load(e,i,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{let i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);let n=ZHe.toString(),s=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(n){let s=n.data;switch(s.type){case"decode":i._callbacks[s.id].resolve(s);break;case"error":i._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,n){return i._taskLoad>n._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function ZHe(){let e,t;onmessage=function(a){let o=a.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(u){e.onModuleLoaded=function(d){u({draco:d})},DracoDecoderModule(e)});break;case"decode":let l=o.buffer,c=o.taskConfig;t.then(u=>{let d=u.draco,f=new d.Decoder,m=new d.DecoderBuffer;m.Init(new Int8Array(l),l.byteLength);try{let v=r(d,f,m,c),y=v.attributes.map(x=>x.array.buffer);v.index&&y.push(v.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:v},y)}catch(v){console.error(v),self.postMessage({type:"error",id:o.id,error:v.message})}finally{d.destroy(m),d.destroy(f)}});break}};function r(a,o,l,c){let u=c.attributeIDs,d=c.attributeTypes,f,m,v=o.GetEncodedGeometryType(l);if(v===a.TRIANGULAR_MESH)f=new a.Mesh,m=o.DecodeBufferToMesh(l,f);else if(v===a.POINT_CLOUD)f=new a.PointCloud,m=o.DecodeBufferToPointCloud(l,f);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||f.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());let y={index:null,attributes:[]};for(let x in u){let w=self[d[x]],_,S;if(c.useUniqueIDs)S=u[x],_=o.GetAttributeByUniqueId(f,S);else{if(S=o.GetAttributeId(f,a[u[x]]),S===-1)continue;_=o.GetAttribute(f,S)}y.attributes.push(n(a,o,f,x,w,_))}return v===a.TRIANGULAR_MESH&&(y.index=i(a,o,f)),a.destroy(f),y}function i(a,o,l){let c=l.num_faces()*3,u=c*4,d=a._malloc(u);o.GetTrianglesUInt32Array(l,u,d);let f=new Uint32Array(a.HEAPF32.buffer,d,c).slice();return a._free(d),{array:f,itemSize:1}}function n(a,o,l,c,u,d){let f=d.num_components(),m=l.num_points()*f,v=m*u.BYTES_PER_ELEMENT,y=s(a,u),x=a._malloc(v);o.GetAttributeDataArrayForAllPoints(l,d,y,v,x);let w=new u(a.HEAPF32.buffer,x,m).slice();return a._free(x),{name:c,array:w,itemSize:f}}function s(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}var vp;function JHe(e){return vp||(vp=new QHe,vp.setDecoderPath(e?`${e}/`:"https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),vp.decoderPending}async function eGe(e){if(vp){let t={attributeIDs:vp.defaultAttributeIDs,attributeTypes:vp.defaultAttributeTypes,useUniqueIDs:!1},r;try{r=await vp.decodeGeometry(new Int8Array(e).buffer,t)}catch(i){console.error(i)}if(r)return{index:r.index?{array:r.index.array}:void 0,attributes:Object.entries(r.attributes).map(([i,n])=>({name:i,itemSize:n.itemSize,array:n.array}))}}return null}async function tGe(e,t){let[r,i]=Zne(tL.deserialize(new Uint8Array(e)));return Sse(r),i.result().data}function rGe(e){let t=[];return e.scene.objects.traverse((r,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&i.geometry.data.draco!==void 0&&t.push(i)}),t}async function iGe(e){for(let t of e){let r=await eGe(t.geometry.data.draco);if(r){let i=t.geometry.data;r.index&&(i.index={array:r.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let n={};r.attributes.forEach(({name:s,array:a,itemSize:o})=>{n[s]={array:a,itemSize:o,type:"Float32Array",normalized:!1}}),i.attributes=n,i.draco=void 0}}}var nGe=class{constructor(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0],this._delay=500,this._distance=2,this._onMouseDown=e=>{let t=[e.clientX,e.clientY],r=new Date().getTime();if(this._clickCount>0){let i=t[0]-this._lastPosition[0],n=t[1]-this._lastPosition[1];Math.sqrt(i*i+n*n)>this._distance&&(this._clickCount=0)}this._lastPosition=t,this._clickCount=r-this._lastTime>this._delay?1:this._clickCount+1,this._lastTime=r},this._onMouseUp=e=>{}}start(e,t=500,r=2){this._target&&this.stop(),this.reset(),this._delay=t,this._distance=r,this._target=e,this._target.addEventListener("pointerdown",this._onMouseDown,!1),this._target.addEventListener("pointerup",this._onMouseUp,!1)}stop(){this._target&&(this._target.removeEventListener("pointerdown",this._onMouseDown,!1),this._target.removeEventListener("pointerup",this._onMouseUp,!1),this._target=void 0)}get clickCount(){return this._clickCount}reset(){this._clickCount=0,this._lastTime=0,this._lastPosition=[0,0]}},sGe=class{constructor(e,t,r,i,n,s,a,o){this.eventId=e,this.id=t,this.data=r,this.dataEvent=i,this.object=n,this.stage=!1,this.actions=ds(i,r.actions,s,a,o,n)}disconnect(){Xs(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Particles.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch()),this.actions.SetVariable.forEach(e=>e.checkConditions()),this.actions.SetVariable.forEach(e=>e.dispatch()),this.actions.DynamicVariablePlay.forEach(e=>e.dispatch()),this.actions.ClearLocalStorage.forEach(e=>e.dispatch()),this.actions.UserAPI.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},aGe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.resize=(r,i)=>{this.breakpoints.forEach(n=>{let s=sL.deviceToSize(n.data.size),a=n.dataEvent.orientation==="horizontal"?r:i,o;switch(n.data.operator){case"<":o=a<s[0];break;case">":o=a>s[0];break;case"<>":o=a>s[0]&&a<s[1];break}n.stage!==o&&(n.stage=o,n.stage?n.dispatchIn():n.dispatchOut())})},this.onResizeObserver=new ResizeObserver(r=>{for(let i of r){let{width:n,height:s}=i.contentRect;this.resize(n,s)}})}connect(){let{page:e,sharedAssets:t,domElement:r}=this.eventContext;this.onResizeObserver.observe(r);let i=n=>{if(!(!n.visible||!n.data?.events.length))for(let{data:s,id:a}of n.data.events)s.disabled||s.type==="Resize"&&s.breakpoints.forEach(({data:o,id:l})=>{try{let c=new sGe(a,l,o,s,n,e,t,this.eventManager);this.breakpoints.push(c)}catch{}})};e.traverseEntity(n=>{(n instanceof ja||n instanceof Hs)&&n.frame?.traverse(s=>{i(s)}),i(n)})}disconnect(){this.onResizeObserver.disconnect(),this.breakpoints.forEach(e=>{e.disconnect()}),this.breakpoints=[]}},oGe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this.userAPIs={},this.events=[],this.onSuccess=({userAPIId:r})=>{this.events.forEach(i=>{i.data.userAPIId===r&&i.dispatchSuccess()})},this.onError=({userAPIId:r})=>{this.events.forEach(i=>{i.data.userAPIId===r&&i.dispatchError()})},this.userAPIs=e.sharedAssets.getUserAPIs()}connect(){this.eventContext.page.traverseEntity(e=>{e.data?.events.filter(t=>t.data.type==="API"&&!t.data.disabled).forEach(t=>{this.events.push(new lGe(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userAPIs).forEach(([e,t])=>{t.on("success",this.onSuccess),t.on("error",this.onError),t.autostart&&t.callUserAPI(this.eventContext.sharedAssets)})}disconnect(){Object.entries(this.userAPIs).forEach(([e,t])=>{t.off("success",this.onSuccess),t.off("error",this.onError)})}},lGe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.successActions=ds(t,t.successActions,i,n,s,r),this.errorActions=ds(t,t.errorActions,i,n,s,r)}dispatchSuccess(){this.dispatchActions(this.successActions)}dispatchError(){this.dispatchActions(this.errorActions)}dispatchActions(e){e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}},cGe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this.userWebhooks={},this.events=[],this.onMessage=({userWebhookId:r})=>{this.events.forEach(i=>{i.data.userWebhookId===r&&i.dispatch()})},this.userWebhooks=e.sharedAssets.getUserWebhooks()}connect(){this.eventContext.page.traverseEntity(e=>{e.data?.events.filter(t=>t.data.type==="WEBHOOK"&&!t.data.disabled).forEach(t=>{this.events.push(new uGe(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),Object.entries(this.userWebhooks).forEach(([e,t])=>{t.connect(),t.on("message",this.onMessage)})}disconnect(){Object.entries(this.userWebhooks).forEach(([e,t])=>{t.off("message",this.onMessage),t.disconnect()})}},uGe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=ds(t,t.actions,i,n,s,r)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}};function dGe(){let e=document.createElement("textarea");return e.style.position="fixed",e.style.top="200px",e.style.left="400px",e.style.zIndex="-1",e.style.border="1px solid rgba(255,0,0,0.5)",e.style.width="10px",e.style.height="500px",e.style.color="white",e.style.opacity="0.5",e.style.background="transparent",e.style.display="none",e.style.margin="0px",e.style.padding="0px",e.style.boxSizing="content-box",e.style.pointerEvents="none",e}var hGe=new V(0,0,1),J$=new V,eK=new V,tK=new as,fGe=class{constructor(e,t,r,i,n){this.containerScene=e,this.raycaster=t,this.sharedAssets=r,this.requestRender=i,this.onExit=n,this.htmlInput=null,this.virtualInput=null,this.helper=new Zae,this.doubleClickHandler=new nGe,this.isDragging=!1,this.plane=new So,this.caretInterval=0,this.planeIntersection=new V,this.projected=new ge,this._lastIndex=0,this._isFirstDragMove=!1,this.selectionOnDragStart=0,this.onTextMaterialChanged=()=>{let s=this.virtualInput?.data;if(this.virtualInput!==void 0&&s){let a=s.material,o=typeof a=="string"?this.sharedAssets.data.materials[a]:a,l=wUe(o,this.sharedAssets);this.helper.setCaretColor(l)}},this.stopAnimateTextCursor=()=>{clearInterval(this.caretInterval),this.helper&&(this.helper.caretMesh.visible=!1)},this.startAnimateTextCursor=()=>{this.stopAnimateTextCursor(),this.helper&&(this.helper.caretMesh.visible=!0,this.caretInterval=setInterval(()=>{this.helper&&(this.helper.caretMesh.visible=!this.helper.caretMesh.visible),this.requestRender()},600))},this.handleCaretUpdate=s=>{if(!this.htmlInput||!this.virtualInput)return;let a=this.helper,o=s?.key==="ArrowLeft"||s?.key==="ArrowRight",l=s?.key==="ArrowUp"||s?.key==="ArrowDown";this.htmlInput.selectionStart===this.htmlInput.selectionEnd?(a.setCaretPosition(this.htmlInput.selectionStart,{horizontalKeyMove:o,verticalKeyMove:l}),this.startAnimateTextCursor()):a.setSelection(this.htmlInput.selectionStart,this.htmlInput.selectionEnd),this.requestRender()},this.containerScene.add(this.helper)}createInput(){return this.htmlInput=dGe(),this.htmlInput}connect(){}disconnect(){this.stopAnimateTextCursor(),this.helper.hide(),this.htmlInput?.remove(),this.doubleClickHandler.stop()}handleMouseDown(){if(!this.htmlInput||!this.virtualInput)return!0;this.getPointOnPlane();let e=this.doubleClickHandler.clickCount,{index:t,lineIndex:r,characterIndex:i}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,e>1?"inside":"previous")??{index:0,lineIndex:0,characterIndex:0};this.virtualInput?.wrappedText?.length&&this.virtualInput.wrappedText[r][Math.max(0,i-1)]===`
`&&(t--,i--),this._lastIndex=t,this._isFirstDragMove=!0;let n=this.checkClickedObject();if(e===1){if(n===null)return this.onExit(this.virtualInput),!0;this.selectionOnDragStart=t,this.isDragging=!0,this.setInputSelection(t)}else n===this.virtualInput&&(e===2?this.selectClosestWord(r,i):e>2&&(this.setInputSelection(0,this.htmlInput.value.length),this.doubleClickHandler.reset()))}handleMouseUp(){this.applyRangeToTextInput(),this.isDragging=!1,this._isFirstDragMove=!1}handleMouseMove(){!this.virtualInput||(this._isFirstDragMove&&this.doubleClickHandler.clickCount>1&&(this.selectionOnDragStart=this._lastIndex,this.isDragging=!0,this.setInputSelection(this._lastIndex)),this._isFirstDragMove=!1,this.getPointOnPlane(),this.applyRangeToTextInput())}focus(e){if(this.virtualInput=e,this.updateTextInputStyles(),this.htmlInput)if(e){let t=this.data?.geometry.text;this.htmlInput.value=typeof t=="string"?"":t?.textValue.toString()??""}else this.htmlInput.value=""}blur(){}get data(){let{virtualInput:e}=this;if(e)return e.dataPatched}applyRangeToTextInput(){if(!this.isDragging||!this.virtualInput||!this.htmlInput)return;let e=this.selectionOnDragStart,{index:t,lineIndex:r,characterIndex:i}=this.helper.getSelectionFromPosition(this.projected.x,this.projected.y,this.doubleClickHandler.clickCount>2?"inside":"previous")??{index:0};r!==void 0&&i!==void 0&&this.virtualInput?.wrappedText[r][i-1]===`
`&&t--,this.htmlInput.setSelectionRange(Math.min(e,t),Math.max(e,t))}checkClickedObject(){if(this.virtualInput){let e=this.raycaster.intersectObject(this.virtualInput,!1);if(e.length>0){let t=e[0];if(t.object instanceof tF)return t.object}}return null}selectClosestWord(e,t){if(!this.virtualInput)return;let r=this.virtualInput.wrappedText,i=r[e],n=t+1,s=t;i[t]!==" "&&(n=this.findNextCharOccurence(i,t,"forward"," "),s=this.findNextCharOccurence(i,t,"backward"," "),s>0&&s++,n>=i.length-1&&e===r.length-1&&n++);let a=this.helper,o=a.getGlobalIndexFromLineAndCharIndexes(r,e,s),l=a.getGlobalIndexFromLineAndCharIndexes(r,e,n);this.setInputSelection(o,l)}findNextCharOccurence(e,t,r,i=" "){let n=Math.max(0,e.length-1),s=r==="forward"?n:0,a=r==="forward"?1:-1,o=Math.max(Math.min(t,n),0);for(;o!==s;)if(o+=a,e.charAt(o)===i)return o;return s}getPointOnPlane(){let e=this.virtualInput?.data;if(!(!this.virtualInput||!e)&&this.raycaster.ray.intersectsPlane(this.plane)){this.planeIntersection===null&&(this.planeIntersection=new V);let t=this.raycaster.ray.intersectPlane(this.plane,this.planeIntersection);if(t){this.planeIntersection.copy(this.virtualInput.worldToLocal(t));let r=typeof e.geometry.width=="number"?e.geometry.width:1,i=typeof e.geometry.height=="number"?e.geometry.height:1;this.projected.set(t.x+r*.5,t.y-i*.5)}}}updatePlane(){let e=this.virtualInput?.data;this.virtualInput&&e&&(tK.getNormalMatrix(this.virtualInput.matrixWorld),J$.copy(hGe).applyMatrix3(tK).normalize(),this.virtualInput.localToWorld(eK.set(0,0,e.geometry.depth)),this.plane.setFromNormalAndCoplanarPoint(J$,eK))}setInputSelection(e,t=e){this.htmlInput?.setSelectionRange(e,t),setTimeout(()=>{this.htmlInput?.focus()})}updateTextInputStyles(){let e=this.virtualInput?.data;this.virtualInput&&e&&this.htmlInput&&(this.htmlInput.style.fontSize=e.geometry.fontSize+"px",this.htmlInput.style.letterSpacing=e.geometry.letterSpacing*e.geometry.fontSize+"px",this.htmlInput.style.lineHeight=e.geometry.fontSize*e.geometry.lineHeight+"px",this.htmlInput.style.width=e.geometry.width+"px",this.htmlInput.style.height=e.geometry.height+"px",this.htmlInput.style.textAlign=pGe(e.geometry.horizontalAlign))}};function pGe(e){return e===4?"justify":e===2?"right":e===3?"center":"left"}var dle=(e,t)=>{if(typeof e=="string"){let r=t.data(e);if(r)return dle(r.value,t)}return ga.getDisplayedValue(e)};function rK(e,t){let r=e.text,i="";if(typeof r=="string"){let n=t.variables.data(i);n&&(i=dle(n.value,t.variables))}else i=r.textValue.toString();return i}var mGe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this._textInputs=[],this.sceneHelpers=new Ro,this.helper=new Zae,this._onMouseDownFocusIn=r=>{if(nr.length>1)return;this.eventContext.updateRaycaster(r);let i=null;if(this.eventContext.raycaster){for(let n of this._textInputs)if(this.eventContext.raycaster.intersectObject(n,!0).length>0){i=n;break}}this.focusOnTextInput(i),this._onCaretUpdate(),this._onMouseUp(),this.textInputManager.doubleClickHandler.start(this.eventContext.domElement),this.textInputManager.doubleClickHandler._onMouseDown(r),this._onMouseDown(r)},this.onExit=()=>{let{virtualInput:r}=this.textInputManager;if(r===null)return;let i=this.textInputManager.htmlInput;this.helper.hide(),i?.setSelectionRange(i.value.length,i.value.length),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0);let{domElement:n}=this.eventContext;n.removeEventListener("pointerdown",this._onMouseDown,!1),n.removeEventListener("pointerup",this._onMouseUp,!1),n.removeEventListener("pointermove",this._onMouseMove,!1),window.removeEventListener("keydown",this._onKeyPress),this.textInputManager.doubleClickHandler.reset(),n.addEventListener("pointerdown",this._onMouseDownFocusIn),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers()},this._onMouseDown=r=>{this.eventContext.updateRaycaster(r),this.textInputManager.handleMouseDown(),this.textInputManager.virtualInput&&this.eventContext.raycaster.intersectObject(this.textInputManager.virtualInput,!0).length>0&&this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1)},this._onMouseUp=()=>{this.textInputManager.handleMouseUp(),this.eventManager.controlsManager.orbitControls&&!this.eventManager.controlsManager.orbitControls.enabled&&(this.eventManager.controlsManager.orbitControls.enabled=!0)},this._onMouseMove=r=>{this.eventContext.updateRaycaster(r),this.textInputManager.handleMouseMove()},this._onTextEdit=r=>{let{htmlInput:i,virtualInput:n,helper:s}=this.textInputManager;if(!i||!n)return;let a=i.value;n.textGeometry.setText(a,this.eventContext.sharedAssets).then(()=>{this.eventContext.requestRender()});let o=n.data;s.update();let l=o.geometry.text;if(typeof l=="string"){let c=l;this.eventContext.sharedAssets.updateVariable(c,{textValue:a})}this.textInputManager.updateTextInputStyles(),this._onCaretUpdate()},this._onCaretUpdate=r=>{this.textInputManager.handleCaretUpdate(r)},this._onKeyPress=r=>{r.key==="Escape"&&this.onExit()},this.textInputManager=new fGe(this.sceneHelpers,e.raycaster,e.sharedAssets,e.requestRender,this.onExit)}connect(){let e=[];if(this.eventContext.scene.traverseEntity(i=>{i instanceof tF&&e.push(i)}),this._textInputs=e,e.length===0)return;let{domElement:t}=this.eventContext;t.addEventListener("pointerdown",this._onMouseDownFocusIn),this.textInputManager.connect();let r=this.textInputManager.createInput();document.body.appendChild(r),r.style.display="none",r.addEventListener("keyup",this._onCaretUpdate),r.addEventListener("keydown",this._onCaretUpdate),r.addEventListener("beforeinput",this._onCaretUpdate),r.addEventListener("paste",this._onCaretUpdate),r.addEventListener("cut",this._onCaretUpdate),r.addEventListener("select",this._onCaretUpdate),r.addEventListener("selectstart",this._onCaretUpdate)}disconnect(){let e=this.textInputManager.htmlInput,{domElement:t,sharedAssets:r}=this.eventContext;t.removeEventListener("pointerdown",this._onMouseDownFocusIn),e?.removeEventListener("keyup",this._onCaretUpdate),e?.removeEventListener("keydown",this._onCaretUpdate),e?.removeEventListener("beforeinput",this._onCaretUpdate),e?.removeEventListener("paste",this._onCaretUpdate),e?.removeEventListener("cut",this._onCaretUpdate),e?.removeEventListener("select",this._onCaretUpdate),e?.removeEventListener("selectstart",this._onCaretUpdate),this._textInputs.forEach(i=>{let n=rK(i.data.geometry,this.eventContext.sharedAssets.data);i.textGeometry.setText(n,r)}),t.removeEventListener("pointerdown",this._onMouseDown,!1),t.removeEventListener("pointerup",this._onMouseUp,!1),t.removeEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress),this.eventContext.renderer.sceneHelpersOnTop=void 0,this.eventContext.renderer.pipeline.disableHelpers(),this.textInputManager.disconnect()}focusOnTextInput(e){this.textInputManager.focus(e),this.textInputManager.onTextMaterialChanged();let t=this.textInputManager.htmlInput;if(!t||e===null)return;this.textInputManager.updateTextInputStyles(),this.eventContext.renderer.sceneHelpersOnTop=this.sceneHelpers,this.eventContext.renderer.pipeline.enableHelpers(),this.textInputManager.isDragging=!1;let r=rK(e.textGeometry.userData.parameters,this.eventContext.sharedAssets.data);t.value=r,t.setSelectionRange(0,0),this.textInputManager.helper.show(e),t.style.display="block",t.addEventListener("input",this._onTextEdit),this.textInputManager.updatePlane();let{domElement:i}=this.eventContext;i.removeEventListener("pointerdown",this._onMouseDownFocusIn),i.addEventListener("pointerdown",this._onMouseDown,!1),i.addEventListener("pointerup",this._onMouseUp,!1),i.addEventListener("pointermove",this._onMouseMove,!1),window.addEventListener("keydown",this._onKeyPress)}},gGe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onVoice=({value:r,frequencies:i})=>{this.events.forEach(n=>{n.dispatch()})}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity(e=>{e.data?.events.filter(t=>t.data.type==="AIAssistantListener"&&!t.data.disabled).forEach(t=>{this.events.push(new vGe(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.openAIRealtime.on("voice",this.onVoice))}disconnect(){this.openAIRealtime?.off("voice",this.onVoice)}},vGe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=ds(t,t.actions,i,n,s,r)}dispatch(){this.dispatchActions(this.actions)}dispatchActions(e){e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}},yGe=class extends Ha{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.onTriggerEvent=({description:r,direction:i})=>{let n=this.events.find(s=>s.data.description===r);n&&(i==="backward"?n.dispatchReverse():n.dispatch())}}connect(){this.openAIRealtime=this.eventContext.sharedAssets.openAIRealtime,this.openAIRealtime&&(this.eventContext.page.traverseEntity(e=>{e.data?.events.filter(t=>t.data.type==="AIAssistantTrigger"&&!t.data.disabled).forEach(t=>{this.events.push(new xGe(t.id,t.data,e,this.eventContext.page,this.eventContext.sharedAssets,this.eventManager))})}),this.openAIRealtime.on("trigger_event",this.onTriggerEvent))}disconnect(){this.openAIRealtime?.off("trigger_event",this.onTriggerEvent)}},xGe=class{constructor(e,t,r,i,n,s){this.id=e,this.data=t,this.object=r,this.actions=ds(t,t.actions,i,n,s,r)}dispatch(){let e=this.actions;e.Audio.forEach(t=>t.dispatchConditional()),e.Particles.forEach(t=>t.dispatchConditional()),e.Video.forEach(t=>t.dispatchConditional()),e.Create.forEach(t=>t.dispatch()),e.Destroy.forEach(t=>t.dispatch()),e.Reset.forEach(t=>t.dispatch()),e.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this),t.init()}),e.Transition.forEach(t=>t.play()),e.Animation.forEach(t=>t.play()),e.SwitchCamera.forEach(t=>t.play()),e.SceneTransition.forEach(t=>t.dispatch()),e.SetVariable.forEach(t=>t.checkConditions()),e.SetVariable.forEach(t=>t.dispatch()),e.DynamicVariablePlay.forEach(t=>t.dispatch()),e.ClearLocalStorage.forEach(t=>t.dispatch()),e.UserAPI.forEach(t=>t.dispatch())}dispatchReverse(){let e=this.actions;e.Transition.forEach(t=>t.reverseFromCurrent()),e.Particles.forEach(t=>t.reverseFromCurrent()),e.Animation.forEach(t=>t.reverseFromCurrent()),e.SwitchCamera.forEach(t=>t.reverseFromCurrent()),e.Create.forEach(t=>t.dispatchStop())}},bGe=class{constructor(e,t,r,i,n){this.publish=e,this.controlsManager=t,this.animationControls=r,this.eventContext=i,this.sharedVariables=n,this.isEnabled=!1,this.activateCount=0,this.needsMouse=!1,this.needsRaycast=!1,this.onTouchMovePreventScroll=s=>{let a=window.parent!==window,o=document.documentElement.scrollHeight>document.documentElement.clientHeight||document.documentElement.scrollWidth>document.documentElement.clientWidth;(s.touches.length>1||this.preventTouchScroll||a===!1&&o===!1)&&s.preventDefault()},this.onMouseWheelPreventScroll=s=>{this.preventScroll&&s.preventDefault()},this.onMouseMove=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:s.buttons>0}},this.onMouseDown=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:!0}},this.onMouseUp=s=>{this.eventContext.sharedAssets.mouseProperty={...this.getMousePosition(s),pressed:!1}},this.getMousePosition=s=>{let{domRect:a}=this.eventContext,{pageX:o,pageY:l}=s.touches?.length>0?s.touches[0]:s;return{x:o-(a.left+window.scrollX),y:l-(a.top+window.scrollY)}},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=i.requestRender}activate(e=!1){if(this.isEnabled)return;this.isEnabled=!0,this.initializeActionsDependentStates(),this.needsMouse&&(this.eventContext.domElement.addEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.addEventListener("pointerdown",this.onMouseDown)),this.handlers={Spline:new Y7e(this.eventContext),VariableChange:new AHe(this.eventContext,this.sharedVariables,this,this.needsMouse,this.needsRaycast),API:new oGe(this.eventContext,this),WEBHOOK:new cGe(this.eventContext,this),AIAssistantListener:new gGe(this.eventContext,this),AIAssistantTrigger:new yGe(this.eventContext,this),Conditional:new eHe(this.eventContext,this),Start:new SHe(this.eventContext,this),Basic:new $7e(this.eventContext,this,this.needsRaycast),MouseHover:new yHe(this.eventContext,this),Scroll:new wHe(this.eventContext,this),Follow:new uHe(this.eventContext,this),DragDrop:new sHe(this.eventContext,this),LookAt:new mHe(this.eventContext),Resize:new aGe(this.eventContext,this),Textfields:new mGe(this.eventContext,this)};let{page:t,domElement:r}=this.eventContext;this.hideCursor&&(r.style.cursor="none"),t.traverseEntity(i=>{i.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(i=>i.connect()),r.addEventListener("wheel",this.onMouseWheelPreventScroll),r.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++,e||this.eventContext.sharedAssets.openAIRealtime?.connect()}deactivate(e=!1){if(!this.isEnabled)return;this.isEnabled=!1,this.eventContext.domElement.removeEventListener("pointermove",this.onMouseMove),this.eventContext.domElement.removeEventListener("pointerdown",this.onMouseDown),this.eventContext.domElement.removeEventListener("pointerup",this.onMouseUp),this.eventContext.sharedAssets.mouseProperty=null,this.eventContext.sharedAssets.raycastProperty=null;let{page:t,domElement:r}=this.eventContext;r.style.cursor="",Object.values(this.handlers).forEach(i=>i.disconnect()),this.controlsManager.gameControl?.disposeActions(),this.controlsManager.disconnectEvents(),t.traverseEntity(i=>{i.removeEventListener("requestRender",this.requestRender),i.destroyedInAction=!1}),r.removeEventListener("touchmove",this.onTouchMovePreventScroll),r.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode(),e||this.eventContext.sharedAssets.openAIRealtime?.disconnect()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(!0),this.activate(!0),this.controlsManager.deactivate(),this.controlsManager.activate(this),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}initializeActionsDependentStates(){let e=this.eventContext.sharedAssets;e.resetDynamicVariablePlayState();let t=r=>{if(r.data.type==="Conditional"&&(r.data.ifActions.forEach(t),r.data.elseActions.forEach(t)),r.data.type==="Conditional"||r.data.type==="SetVariable")for(let i of r.data.type==="Conditional"?r.data.condition:r.data.expression)"id"in i&&Array.isArray(i.id)&&(i.id[0]==="mouse"&&(this.needsMouse=!0),i.id[0]==="raycast"&&(this.needsRaycast=!0));r.data.type==="DynamicVariablePlay"&&r.data.variableId!==""&&(r.data.mode==="Play"||r.data.mode==="PlayPause"||r.data.mode==="Toggle")&&e.setDynamicVariablePlayState(r.data.variableId,"Stopped")};this.eventContext.page.traverseEntity(r=>{if(r.data?.events.length)for(let i of r.data.events)if(i.data.type==="VariableChange"&&(i.data.variableId==="mouseProperty"&&(this.needsMouse=!0),i.data.variableId==="raycastProperty"&&(this.needsRaycast=!0)),i.data.type==="Conditional")for(let n of["inActions","outActions"])i.data[n].forEach(t);else if(i.data.type==="DragDrop")for(let n of["drag","drop"])i.data.dragDropActions[n].forEach(t);else if(i.data.type==="GameControl")for(let n of["idle","move","jump","run"])i.data.gameActions[n].forEach(t);else if(i.data.type==="Resize")for(let n of i.data.breakpoints)n.data.actions.forEach(t);else i.data.type==="LookAt"||i.data.type==="API"||i.data.actions.forEach(t)})}},wGe=class{constructor(e,t,r,i,n){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=new ge().copy(r),this._editorSize=new ge().copy(i),this._aspect=t.aspect,this._fov=n??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.y;this._aspect=e/t,t<=r&&(this._camera.zoom*=r/t),this._renderer.setViewport(0,0,e,t)}updateCamera(e=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,r=this._editorSize.y,i=this._fov;if(e&&t>r){let n=_Ge(t,1080,2160,1,15)/100;i*=t/r,i*=1-n}this._camera.aspect=this._aspect,this._camera.fov=i,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};function _Ge(e,t,r,i,n){return(e-t)/(r-t)*(n-i)+i}var SGe=class{get sharedAssets(){return this.shared}constructor(e,t={},r=!0){this.shared=new GB(e.shared,t,!0,r),this.scene=new nF(e.scene,this.sharedAssets),this.shared.setEntityOpContext({scene:this.scene,shared:this.shared})}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof Hs&&!e.uiScene&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof os&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},EGe=class{constructor({x:e=10,y:t=10}){this._startTime=0;let r=document.getElementById("spe-perfs");r?this.element=r:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){this.element.parentElement?.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function AGe(e){let t;if(e.index)for(let r=0;r<e.index.array.length;r+=3)t=e.index.array[r],e.index.array[r]=e.index.array[r+2],e.index.array[r+2]=t}function n2(e){return e instanceof X2?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function CGe(e,t){let r={};return e.traverseEntity(i=>{if(!i.visible||!(i instanceof uo)||i.type!=="Mesh"||Array.isArray(i.material)||i.states&&Object.keys(i.states).length)return;let n=i.parent;for(;n;){if(n instanceof uo&&i.states&&Object.keys(i.states).length)return;n=n.parent}let s=i.material.uuid,a=t.shared.materials[s];if(a){if(!qs.isMergable(a))return}else{let l=t.scene.objects.get(i.uuid)?.data;if(l&&"material"in l&&typeof l.material!="string"){if(!qs.isMergable(l.material))return;s=qs.getHash(l.material)}}r[s]||(r[s]={});let o=r[s][n2(i)];if(o){if(o.push(i),i.cloner)for(let l of i.cloner.children)o.push(l)}else if(r[s][n2(i)]=[i],i.cloner)for(let l of i.cloner.children)r[s][n2(i)].push(l)}),r}function TGe(e){let t=0;return Object.values(e).forEach(r=>{Object.values(r).forEach(i=>{let n=i.length;n>t&&(t=n)})}),t}function MGe(e,t){let r=CGe(t,e),i=TGe(r),n=new Array(i),s=0,a=new Array(i),o=0,l=new Array(i),c=0,u=new Array(i),d=0;for(let[f,m]of Object.entries(r))for(let v of Object.values(m)){if(o=0,c=0,v.forEach(x=>{x instanceof uo&&(a[o++]=x.geometry.clone(),l[c++]=x)}),c<2)continue;for(let x=0;x<c;x++)l[x].updateWorldMatrix(!0,!1),a[x].applyMatrix4(l[x].matrixWorld),l[x].matrixWorld.determinant()<0&&AGe(a[x]);let y=mg(a.slice(0,o),!1);if(y){let x;switch(f){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),x=new Yi(y,l[0].material);break}default:{x=new Yi(y,l[0].material);break}}x.castShadow=l[0].castShadow,x.receiveShadow=l[0].receiveShadow,t.add(x);let w=_=>{d=0;for(let S of _)S.children&&w(S.children),S instanceof uo&&(Array.isArray(S.material)||r[S.material.uuid]&&r[S.material.uuid][n2(S)]&&r[S.material.uuid][n2(S)].length>1||(u[d++]=S));for(let S=0;S<d;S++)t.attach(u[S])};for(let _=0;_<c;_++){let S=l[_];w(S.children),n[s++]=S}}}for(let f=0;f<s;f++)n[f].removeFromParent()}var PGe=Jp(Hwe(),1),DGe=new ge;function NGe(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)}var kGe=class{constructor(e,{renderOnDemand:t,renderMode:r="auto",wasmPath:i}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._variablesCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=n=>{if(this.time=n,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,this._perfs?.start(),!this._renderer){this._perfs?.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){this._perfs?.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&(this._eventManager.handlers?.Start.hasVideoAction||this._eventManager.handlers?.Basic.hasVideoAction||this._eventManager.handlers?.Conditional.hasVideoAction)&&(this._skipRender=!1),this._animationControls?.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,this._scene?.traverseVisibleEntity(s=>{s.type==="ParticleSystem"&&(s.update(this.dt),this._skipRender=!1)}),this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),this._eventManager?.isEnabled&&((this._eventManager.handlers?.Follow).onAnimationFrameDamping(),(this._eventManager.handlers?.LookAt).onAnimationFrameDamping(),(this._eventManager.handlers?.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let s=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=s,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),this._perfs?.end()},this._resize=n=>{if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=DGe.set(this._viewportWidth,this._viewportHeight)),n){let s=this._viewportWidth,a=this._viewportHeight;this._renderer.setSize(s-1,a-1,!1),this._renderer.setSize(s,a,!1)}else this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1);if(this._camera=this._scene?.activeCamera,this._scene?.updateViewPlaneSize(this._frameView?.frameSize?.x??this._viewportWidth,this._frameView?.frameSize?.y??this._viewportHeight,this._frameView?.enableResponsive??!1),this._camera){let s=Object.values(this._data?.frames??{})[0].preset??"fullscreen";this._frameView?.setCamera(this._camera),this._frameView?.updateCamera(s!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect()),this._requestRenderAutoMode()}},this._debouncedResize=j2(this._resize,10),this._onScroll=n=>{this.eventManager&&(this.eventManager.eventContext.domRect=this.canvas.getBoundingClientRect())},this.canvas=e,this.renderMode=t?"auto":r,i&&(this._wasmPath=hOe(i,"/")),this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new EGe({x:10,y:10})),AOe(e)}async load(e,t,r){NGe(e),this.disposed=!1;let i=await(await fetch(e,r)).arrayBuffer();await this.start(i,{variables:t})}async start(e,{interactive:t=!0,variables:r}={}){if(this.disposed)return;let i=await tGe(e);this._data=i;let n=rGe(i);i.version&&(0,PGe.default)(i.version,"1.10.37")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),this._wasmPath&&this.setUIWasmUrl(`${this._wasmPath}/ui.wasm`),await Promise.all([n.length&&JHe(this._wasmPath),CX(i)&&Nze(this._wasmPath),jBe(i)&&Tze(this._wasmPath),V2.physicsEnabled(i.scene.objects)&&DOe(),_X(i)&&hBe(),r$(i)&&Y8e(),uBe(i)&&cBe(),YX(i)&&RUe(),LHe(i)&&MOe(this._wasmPath)].filter(Boolean)),n.length&&await iGe(n),this._eventManager?.deactivate(),this._controls?.deactivate(),this._scene?.dispose();let s=new SGe(i);if(s.resetPersonalCameraFromDocumentData(),this._scene=s.scene,this._sharedAssetsManager=s.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let l=performance.now();MGe(i,s.scene);let c=performance.now();console.log("Merged geometries in ",c-l," ms")}CX(i)&&this._scene.traverse(l=>{xh(l)&&l.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{this._requestRenderAutoMode(),this._scene?.traverse(l=>{l instanceof Ul&&l.pendingMediaLoad&&l.update()})}),this._scene?.traverse(l=>{l.type==="ParticleSystem"&&(l.wakeUp(),l.data.autoPlay?l.start():l.stop())});let a=Object.keys(i.shared.fonts).map(l=>this._sharedAssetsManager.getFont(l).loadingPromise);if(Promise.all(a).then(()=>{s.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),_X(i)&&YHe(i)&&await Promise.all(a),YX(i)){let l=[];this._scene.traverseEntity(c=>{(c instanceof ja||c instanceof Hs)&&c.uiCanvas&&l.push(c.uiCanvas)}),await Promise.all(l.map(c=>c.promise))}if(this._scene.rewriteEventsBeforeGoToPlayMode(),vF(this._scene.activePage,this._sharedAssetsManager),!this._renderer&&(this._renderer=new xUe({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=i.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.enableUIOverlay(),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode),i.shared.images.SplineWatermark)){let l=this._sharedAssetsManager.getImage("SplineWatermark");await l.loadPromise;let c=l.getTexture(1001);this._renderer.pipeline.setWatermark(c)}r$(i)&&this._scene.initializeSplatViewer(),i.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(i.scene.blueNoiseTextureData);let o=Object.values(i.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(o.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=o.size[0],this._viewportHeight=o.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new wGe(this._renderer,this._camera,new ge(this._viewportWidth,this._viewportHeight),new ge(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(o.allowResponsive??!1)&&o.preset==="fullscreen"),t){let l=new W7e(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,o);this._scene.updateMatrixWorld(!0),this._controls=new XHe(l),this._animationControls=new KHe(this._scene,this._requestRenderAutoMode),this._eventManager=new bGe(i.scene.publish,this._controls,this._animationControls,l,i.shared.variables),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this._scene.activePage.data.postprocessing.depthOfField.enabled&&Promise.all(this._sharedAssetsManager.getImageLoadPromises()).then(()=>{this._resize(!0)}),r!==void 0&&this.setVariables(r),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{this._renderer?.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300),document.addEventListener("scroll",this._onScroll)}setVariables(e){if(this._data!==void 0){let t=Object.entries(e);for(let[r,i]of t)this.setVariable(r,i)}}setVariable(e,t){let r=this._getVariableByName(e);if(r&&!("dynamicVariableType"in r.data)){let i=t;typeof r.data.value=="number"?i=typeof t=="number"?t:typeof t=="boolean"?t===!0?1:0:parseFloat(t):typeof r.data.value=="boolean"?i=typeof t=="number"?!!t:typeof t=="boolean"?t:t.toLocaleLowerCase()==="false"?!1:!!t:typeof r.data.value!="string"&&r.data.value.textValue!==void 0&&(i=t.toString());let n=typeof i=="string"?{textValue:i}:i;this._sharedAssetsManager?.updateVariable(r.id,n),this.requestRender(),this._requestRenderAutoMode()}else r===void 0?console.warn(`No variable named ${e} was found in your Spline file. Make sure to create it from Spline editor.`):"dynamicVariableType"in r.data&&console.warn(`Dynamic variables like ${e} cannot be updated from code.`)}getVariables(){let e={};return this._data&&this._data.shared.variables.forEach(t=>{e[t.data.name]===void 0&&(e[t.data.name]=this._getVariableValue(this._sharedAssetsManager.getVariable(t.id)))}),e}getVariable(e){let t=this._getVariableByName(e);if(t){let r=this._sharedAssetsManager.getVariable(t.id);return this._getVariableValue(r)}}_getVariableValue(e){return typeof e!="string"&&ga.isTextValue(e)?ga.getDisplayedValue(e):e}_getVariableByName(e){if(this._data){if(this._variablesCache.has(e))return this._variablesCache.get(e);let t=this._data.shared.variables.find(r=>r.data.name===e);return t&&this._variablesCache.set(e,t),t}}findObjectById(e){let t=this._scene?.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){let t=this._scene?.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){let e=[];return this._scene?.traverseEntity(t=>{if(t.uuid!==rb&&!this._scene.isInvisibleObjects(t)&&!(t instanceof Hs)){let r=this._createProxyObject(t);r&&e.push(r)}}),e}getSplineEvents(){return(this._eventManager?.handlers?.Spline).splineEvents}emitEvent(e,t){(this.findObjectById(t)||this.findObjectByName(t))?.emitEvent(e)}emitEventReverse(e,t){(this.findObjectById(t)||this.findObjectByName(t))?.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){this._controls?.orbitControls instanceof ule&&this._controls?.orbitControls.setZoom(e)}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){let{r:t,g:r,b:i,a:n}={r:0,g:0,b:0,a:1},s=new xa(t,r,i,n);try{s.setStyle(e)}catch{console.error("This is not a valid css color",e)}this._scene?.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){this.disposed=!0,this._eventManager?.deactivate(),this._scene?.dispose(),this._sharedAssetsManager?.dispose(),this._proxyObjectCache.forEach(e=>{DW.unsubscribe(e)}),this._variablesCache.clear(),this._renderer?.setAnimationLoop(null),this._renderer?.dispose(),this._renderer=void 0,this._sharedAssetsManager?.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),this._controls?.deactivate(),this.dt=0,COe(this.canvas),document.removeEventListener("scroll",this._onScroll)}get isStopped(){return this._isPaused}stop(){this._isPaused||(this._renderer?.setAnimationLoop(null),this._isPaused=!0,this._eventManager?.pause(),this._controls?.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){!this._isPaused||(this._isPaused=!1,this._eventManager?.resume(),this._controls?.orbitControls&&(this._controls.orbitControls.enabled=!0),this._renderer?.setAnimationLoop(this.render))}setGlobalEvents(e){this._eventManager?.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){if(!this._scene||e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors(o=>{o instanceof Hs&&(t=o.name)});let r=this._sharedAssetsManager,i={shared:r,scene:this._scene},n=o=>{if(o===null||o==="Base State")return null;if(o&&e.data.states){let l=e.data.states.find(c=>c.data.name===o);return l?l.id:void 0}},s={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof Hs||e instanceof nF?void 0:e.parent?.uuid,emitEvent(o){e.dispatchEvent({type:"userEvent",eventName:o})},emitEventReverse(o){e.dispatchEvent({type:"userEvent",eventName:o,reverse:!0})},hide(){e.visible&&(e.visible=!1,i.shared.requestRender())},show(){e.visible||(e.visible=!0,i.shared.requestRender())},get state(){let o=e.stateSelection;if(o!==null)return e.data.states.find(({id:l})=>l===o)?.data.name},set state(o){let l;if(o!==void 0){let c=typeof o=="string"?e.data.states.find(({id:u})=>u===o):e.data.states[o];if(c)l=c.id;else{let u=typeof o=="string"?n(o):void 0;u&&(l=u)}}e.changeSelectedState(l??null,i),e.currentState=l??null,e.dispatchEvent({type:"completeState",state:l??null}),i.shared.requestRender()},transition(o){let l=this,c,u=r2.timeline({autoplay:o.autoPlay??!0}),d={transition({from:f,to:m,duration:v,delay:y,...x}){let w=n(f);w===void 0&&(w=c);let _=n(m);c=_;let S=new C5(e,w,_,{state:_,repeat:0,delay:y??0,delayDirection:"start-once",direction:"normal",duration:v??1e3,...x,...x.easing===6?lL.defaultData:x.easing===5?cL.defaultData:{}},r,!1);return u.add({...S.params,begin:()=>{(f&&w||f==="Base State"&&!w)&&(l.state=w??void 0)},complete:()=>{l.state=_??void 0}},u.duration),this},play(){return u.play(),this},pause(){return u.pause(),this},reset(){return u.reset(),this},seek(f){return u.seek(f),this}};return d.transition(o),d}},a=DW(s,(o,l)=>{typeof e[o]!="object"&&Object.getOwnPropertyDescriptor(e,o)?.writable&&(e[o]=l),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,a),a}setUIWasmUrl(e){Nae.skiaWasmUrl=e}pauseGameControls(){this._eventManager?.controlsManager.gameControl?.pause()}resumeGameControls(){this._eventManager?.controlsManager.gameControl?.resume()}},NI,iK;function RGe(){if(iK)return NI;iK=1;var e="Expected a function",t=NaN,r="[object Symbol]",i=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,o=parseInt,l=typeof FE=="object"&&FE&&FE.Object===Object&&FE,c=typeof self=="object"&&self&&self.Object===Object&&self,u=l||c||Function("return this")(),d=Object.prototype,f=d.toString,m=Math.max,v=Math.min,y=function(){return u.Date.now()};function x(M,C,T){var E,N,D,I,j,L,B=0,q=!1,G=!1,Y=!0;if(typeof M!="function")throw new TypeError(e);C=P(C)||0,w(T)&&(q=!!T.leading,G="maxWait"in T,D=G?m(P(T.maxWait)||0,C):D,Y="trailing"in T?!!T.trailing:Y);function X(ae){var Z=E,fe=N;return E=N=void 0,B=ae,I=M.apply(fe,Z),I}function re(ae){return B=ae,j=setTimeout(se,C),q?X(ae):I}function F(ae){var Z=ae-L,fe=ae-B,he=C-Z;return G?v(he,D-fe):he}function $(ae){var Z=ae-L,fe=ae-B;return L===void 0||Z>=C||Z<0||G&&fe>=D}function se(){var ae=y();if($(ae))return H(ae);j=setTimeout(se,F(ae))}function H(ae){return j=void 0,Y&&E?X(ae):(E=N=void 0,I)}function ne(){j!==void 0&&clearTimeout(j),B=0,E=L=N=j=void 0}function ce(){return j===void 0?I:H(y())}function ie(){var ae=y(),Z=$(ae);if(E=arguments,N=this,L=ae,Z){if(j===void 0)return re(L);if(G)return j=setTimeout(se,C),X(L)}return j===void 0&&(j=setTimeout(se,C)),I}return ie.cancel=ne,ie.flush=ce,ie}function w(M){var C=typeof M;return!!M&&(C=="object"||C=="function")}function _(M){return!!M&&typeof M=="object"}function S(M){return typeof M=="symbol"||_(M)&&f.call(M)==r}function P(M){if(typeof M=="number")return M;if(S(M))return t;if(w(M)){var C=typeof M.valueOf=="function"?M.valueOf():M;M=w(C)?C+"":C}if(typeof M!="string")return M===0?M:+M;M=M.replace(i,"");var T=s.test(M);return T||a.test(M)?o(M.slice(2),T?2:8):n.test(M)?t:+M}return NI=x,NI}var IGe=RGe();const OGe=d0(IGe);function jGe(e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}const LGe=[],zGe={width:"100%",height:"100%"},BGe=O.forwardRef(function({className:e,children:t,debounceTime:r=300,ignoreDimensions:i=LGe,parentSizeStyles:n,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:a,...o},l){const c=O.useRef(null),u=O.useRef(0),[d,f]=O.useState({width:0,height:0,top:0,left:0}),m=O.useMemo(()=>{const v=Array.isArray(i)?i:[i];return OGe(y=>{f(x=>Object.keys(x).filter(w=>x[w]!==y[w]).every(w=>v.includes(w))?x:y)},r,{leading:s})},[r,s,i]);return O.useEffect(()=>{const v=a||window.ResizeObserver,y=new v(x=>{x.forEach(w=>{const{left:_,top:S,width:P,height:M}=w?.contentRect??{};u.current=window.requestAnimationFrame(()=>{m({width:P,height:M,top:S,left:_})})})});return c.current&&y.observe(c.current),()=>{window.cancelAnimationFrame(u.current),y.disconnect(),m.cancel()}},[m,a]),h.jsx("div",{style:{...zGe,...n},ref:jGe([l,c]),className:e,...o,children:t({...d,ref:c.current,resize:m})})}),FGe=O.forwardRef(({scene:e,style:t,onSplineMouseDown:r,onSplineMouseUp:i,onSplineMouseHover:n,onSplineKeyDown:s,onSplineKeyUp:a,onSplineStart:o,onSplineLookAt:l,onSplineFollow:c,onSplineScroll:u,onLoad:d,renderOnDemand:f=!0,wasmPath:m,children:v,...y},x)=>{const w=O.useRef(null),[_,S]=O.useState(!0),[P,M]=O.useState();if(P)throw P;return O.useEffect(()=>{S(!0);let C;const T=[{name:"mouseDown",cb:r},{name:"mouseUp",cb:i},{name:"mouseHover",cb:n},{name:"keyDown",cb:s},{name:"keyUp",cb:a},{name:"start",cb:o},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:u}];if(w.current){C=new kGe(w.current,{renderOnDemand:f,wasmPath:m});async function E(){await C.load(e);for(let N of T)N.cb&&C.addEventListener(N.name,N.cb);S(!1),d?.(C)}E().catch(N=>{M(N)})}return()=>{for(let E of T)E.cb&&C.removeEventListener(E.name,E.cb);C.dispose()}},[e]),h.jsx(BGe,{ref:x,parentSizeStyles:{overflow:"hidden",...t},debounceTime:50,...y,children:()=>h.jsxs(h.Fragment,{children:[_&&v,h.jsx("canvas",{ref:w,style:{display:_?"none":"block"}})]})})}),VGe=()=>h.jsx("div",{className:`w-full h-full flex items-center justify-center \r
                  animate-fade-in-up animation-delay-300`,children:h.jsx("div",{className:"w-full h-full transform scale-90 lg:scale-110 xl:scale-125 animate-float",children:h.jsx(FGe,{scene:"https://prod.spline.design/WIFA8Gu4KAAgMvdR/scene.splinecode"})})});function s2(e){let t=e[0],r=e[1],i=e[2];return Math.sqrt(t*t+r*r+i*i)}function N5(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function UGe(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e}function nK(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function sK(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function HGe(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function GGe(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function kI(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function WGe(e,t){let r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(r*r+i*i+n*n)}function qGe(e,t){let r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return r*r+i*i+n*n}function aK(e){let t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i}function YGe(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function XGe(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function k5(e,t){let r=t[0],i=t[1],n=t[2],s=r*r+i*i+n*n;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function hle(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function oK(e,t,r){let i=t[0],n=t[1],s=t[2],a=r[0],o=r[1],l=r[2];return e[0]=n*l-s*o,e[1]=s*a-i*l,e[2]=i*o-n*a,e}function $Ge(e,t,r,i){let n=t[0],s=t[1],a=t[2];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=a+i*(r[2]-a),e}function KGe(e,t,r,i,n){const s=Math.exp(-i*n);let a=t[0],o=t[1],l=t[2];return e[0]=r[0]+(a-r[0])*s,e[1]=r[1]+(o-r[1])*s,e[2]=r[2]+(l-r[2])*s,e}function QGe(e,t,r){let i=t[0],n=t[1],s=t[2],a=r[3]*i+r[7]*n+r[11]*s+r[15];return a=a||1,e[0]=(r[0]*i+r[4]*n+r[8]*s+r[12])/a,e[1]=(r[1]*i+r[5]*n+r[9]*s+r[13])/a,e[2]=(r[2]*i+r[6]*n+r[10]*s+r[14])/a,e}function ZGe(e,t,r){let i=t[0],n=t[1],s=t[2],a=r[3]*i+r[7]*n+r[11]*s+r[15];return a=a||1,e[0]=(r[0]*i+r[4]*n+r[8]*s)/a,e[1]=(r[1]*i+r[5]*n+r[9]*s)/a,e[2]=(r[2]*i+r[6]*n+r[10]*s)/a,e}function JGe(e,t,r){let i=t[0],n=t[1],s=t[2];return e[0]=i*r[0]+n*r[3]+s*r[6],e[1]=i*r[1]+n*r[4]+s*r[7],e[2]=i*r[2]+n*r[5]+s*r[8],e}function eWe(e,t,r){let i=t[0],n=t[1],s=t[2],a=r[0],o=r[1],l=r[2],c=r[3],u=o*s-l*n,d=l*i-a*s,f=a*n-o*i,m=o*f-l*d,v=l*u-a*f,y=a*d-o*u,x=c*2;return u*=x,d*=x,f*=x,m*=2,v*=2,y*=2,e[0]=i+u+m,e[1]=n+d+v,e[2]=s+f+y,e}const tWe=function(){const e=[0,0,0],t=[0,0,0];return function(r,i){N5(e,r),N5(t,i),k5(e,e),k5(t,t);let n=hle(e,t);return n>1?0:n<-1?Math.PI:Math.acos(n)}}();function rWe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}class is extends Array{constructor(t=0,r=t,i=t){return super(t,r,i),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this[0]=t}set y(t){this[1]=t}set z(t){this[2]=t}set(t,r=t,i=t){return t.length?this.copy(t):(UGe(this,t,r,i),this)}copy(t){return N5(this,t),this}add(t,r){return r?nK(this,t,r):nK(this,this,t),this}sub(t,r){return r?sK(this,t,r):sK(this,this,t),this}multiply(t){return t.length?HGe(this,this,t):kI(this,this,t),this}divide(t){return t.length?GGe(this,this,t):kI(this,this,1/t),this}inverse(t=this){return XGe(this,t),this}len(){return s2(this)}distance(t){return t?WGe(this,t):s2(this)}squaredLen(){return aK(this)}squaredDistance(t){return t?qGe(this,t):aK(this)}negate(t=this){return YGe(this,t),this}cross(t,r){return r?oK(this,t,r):oK(this,this,t),this}scale(t){return kI(this,this,t),this}normalize(){return k5(this,this),this}dot(t){return hle(this,t)}equals(t){return rWe(this,t)}applyMatrix3(t){return JGe(this,this,t),this}applyMatrix4(t){return QGe(this,this,t),this}scaleRotateMatrix4(t){return ZGe(this,this,t),this}applyQuaternion(t){return eWe(this,this,t),this}angle(t){return tWe(this,t)}lerp(t,r){return $Ge(this,this,t,r),this}smoothLerp(t,r,i){return KGe(this,this,t,r,i),this}clone(){return new is(this[0],this[1],this[2])}fromArray(t,r=0){return this[0]=t[r],this[1]=t[r+1],this[2]=t[r+2],this}toArray(t=[],r=0){return t[r]=this[0],t[r+1]=this[1],t[r+2]=this[2],t}transformDirection(t){const r=this[0],i=this[1],n=this[2];return this[0]=t[0]*r+t[4]*i+t[8]*n,this[1]=t[1]*r+t[5]*i+t[9]*n,this[2]=t[2]*r+t[6]*i+t[10]*n,this.normalize()}}const lK=new is;let iWe=1,nWe=1,cK=!1;class fle{constructor(t,r={}){t.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=t,this.attributes=r,this.id=iWe++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let i in r)this.addAttribute(i,r[i])}addAttribute(t,r){if(this.attributes[t]=r,r.id=nWe++,r.size=r.size||1,r.type=r.type||(r.data.constructor===Float32Array?this.gl.FLOAT:r.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),r.target=t==="index"?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,r.normalized=r.normalized||!1,r.stride=r.stride||0,r.offset=r.offset||0,r.count=r.count||(r.stride?r.data.byteLength/r.stride:r.data.length/r.size),r.divisor=r.instanced||0,r.needsUpdate=!1,r.usage=r.usage||this.gl.STATIC_DRAW,r.buffer||this.updateAttribute(r),r.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==r.count*r.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,r.count*r.divisor);this.instancedCount=r.count*r.divisor}else t==="index"?this.drawRange.count=r.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,r.count))}updateAttribute(t){const r=!t.buffer;r&&(t.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==t.buffer&&(this.gl.bindBuffer(t.target,t.buffer),this.glState.boundBuffer=t.buffer),r?this.gl.bufferData(t.target,t.data,t.usage):this.gl.bufferSubData(t.target,0,t.data),t.needsUpdate=!1}setIndex(t){this.addAttribute("index",t)}setDrawRange(t,r){this.drawRange.start=t,this.drawRange.count=r}setInstancedCount(t){this.instancedCount=t}createVAO(t){this.VAOs[t.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.bindAttributes(t)}bindAttributes(t){t.attributeLocations.forEach((r,{name:i,type:n})=>{if(!this.attributes[i]){console.warn(`active attribute ${i} not being supplied`);return}const s=this.attributes[i];this.gl.bindBuffer(s.target,s.buffer),this.glState.boundBuffer=s.buffer;let a=1;n===35674&&(a=2),n===35675&&(a=3),n===35676&&(a=4);const o=s.size/a,l=a===1?0:a*a*4,c=a===1?0:a*4;for(let u=0;u<a;u++)this.gl.vertexAttribPointer(r+u,o,s.type,s.normalized,s.stride+l,s.offset+u*c),this.gl.enableVertexAttribArray(r+u),this.gl.renderer.vertexAttribDivisor(r+u,s.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:t,mode:r=this.gl.TRIANGLES}){this.gl.renderer.currentGeometry!==`${this.id}_${t.attributeOrder}`&&(this.VAOs[t.attributeOrder]||this.createVAO(t),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${t.attributeOrder}`),t.attributeLocations.forEach((n,{name:s})=>{const a=this.attributes[s];a.needsUpdate&&this.updateAttribute(a)});let i=2;this.attributes.index?.type===this.gl.UNSIGNED_INT&&(i=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(r,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*i,this.instancedCount):this.gl.renderer.drawArraysInstanced(r,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(r,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*i):this.gl.drawArrays(r,this.drawRange.start,this.drawRange.count)}getPosition(){const t=this.attributes.position;if(t.data)return t;if(!cK)return console.warn("No position buffer data found to compute bounds"),cK=!0}computeBoundingBox(t){t||(t=this.getPosition());const r=t.data,i=t.size;this.bounds||(this.bounds={min:new is,max:new is,center:new is,scale:new is,radius:1/0});const n=this.bounds.min,s=this.bounds.max,a=this.bounds.center,o=this.bounds.scale;n.set(1/0),s.set(-1/0);for(let l=0,c=r.length;l<c;l+=i){const u=r[l],d=r[l+1],f=r[l+2];n.x=Math.min(u,n.x),n.y=Math.min(d,n.y),n.z=Math.min(f,n.z),s.x=Math.max(u,s.x),s.y=Math.max(d,s.y),s.z=Math.max(f,s.z)}o.sub(s,n),a.add(n,s).divide(2)}computeBoundingSphere(t){t||(t=this.getPosition());const r=t.data,i=t.size;this.bounds||this.computeBoundingBox(t);let n=0;for(let s=0,a=r.length;s<a;s+=i)lK.fromArray(r,s),n=Math.max(n,this.bounds.center.squaredDistance(lK));this.bounds.radius=Math.sqrt(n)}remove(){for(let t in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[t]),delete this.VAOs[t];for(let t in this.attributes)this.gl.deleteBuffer(this.attributes[t].buffer),delete this.attributes[t]}}let sWe=1;const uK={};class ple{constructor(t,{vertex:r,fragment:i,uniforms:n={},transparent:s=!1,cullFace:a=t.BACK,frontFace:o=t.CCW,depthTest:l=!0,depthWrite:c=!0,depthFunc:u=t.LEQUAL}={}){t.canvas||console.error("gl not passed as first argument to Program"),this.gl=t,this.uniforms=n,this.id=sWe++,r||console.warn("vertex shader not supplied"),i||console.warn("fragment shader not supplied"),this.transparent=s,this.cullFace=a,this.frontFace=o,this.depthTest=l,this.depthWrite=c,this.depthFunc=u,this.blendFunc={},this.blendEquation={},this.stencilFunc={},this.stencilOp={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=t.createShader(t.VERTEX_SHADER),this.fragmentShader=t.createShader(t.FRAGMENT_SHADER),this.program=t.createProgram(),t.attachShader(this.program,this.vertexShader),t.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:r,fragment:i})}setShaders({vertex:t,fragment:r}){if(t&&(this.gl.shaderSource(this.vertexShader,t),this.gl.compileShader(this.vertexShader),this.gl.getShaderInfoLog(this.vertexShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}
Vertex Shader
${dK(t)}`)),r&&(this.gl.shaderSource(this.fragmentShader,r),this.gl.compileShader(this.fragmentShader),this.gl.getShaderInfoLog(this.fragmentShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}
Fragment Shader
${dK(r)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let i=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let a=0;a<i;a++){let o=this.gl.getActiveUniform(this.program,a);this.uniformLocations.set(o,this.gl.getUniformLocation(this.program,o.name));const l=o.name.match(/(\w+)/g);o.uniformName=l[0],o.nameComponents=l.slice(1)}this.attributeLocations=new Map;const n=[],s=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let a=0;a<s;a++){const o=this.gl.getActiveAttrib(this.program,a),l=this.gl.getAttribLocation(this.program,o.name);l!==-1&&(n[l]=o.name,this.attributeLocations.set(o,l))}this.attributeOrder=n.join("")}setBlendFunc(t,r,i,n){this.blendFunc.src=t,this.blendFunc.dst=r,this.blendFunc.srcAlpha=i,this.blendFunc.dstAlpha=n,t&&(this.transparent=!0)}setBlendEquation(t,r){this.blendEquation.modeRGB=t,this.blendEquation.modeAlpha=r}setStencilFunc(t,r,i){this.stencilRef=r,this.stencilFunc.func=t,this.stencilFunc.ref=r,this.stencilFunc.mask=i}setStencilOp(t,r,i){this.stencilOp.stencilFail=t,this.stencilOp.depthFail=r,this.stencilOp.depthPass=i}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha),this.stencilFunc.func||this.stencilOp.stencilFail?this.gl.renderer.enable(this.gl.STENCIL_TEST):this.gl.renderer.disable(this.gl.STENCIL_TEST),this.gl.renderer.setStencilFunc(this.stencilFunc.func,this.stencilFunc.ref,this.stencilFunc.mask),this.gl.renderer.setStencilOp(this.stencilOp.stencilFail,this.stencilOp.depthFail,this.stencilOp.depthPass)}use({flipFaces:t=!1}={}){let r=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((n,s)=>{let a=this.uniforms[s.uniformName];for(const o of s.nameComponents){if(!a)break;if(o in a)a=a[o];else{if(Array.isArray(a.value))break;a=void 0;break}}if(!a)return hK(`Active uniform ${s.name} has not been supplied`);if(a&&a.value===void 0)return hK(`${s.name} uniform is missing a value parameter`);if(a.value.texture)return r=r+1,a.value.update(r),RI(this.gl,s.type,n,r);if(a.value.length&&a.value[0].texture){const o=[];return a.value.forEach(l=>{r=r+1,l.update(r),o.push(r)}),RI(this.gl,s.type,n,o)}RI(this.gl,s.type,n,a.value)}),this.applyState(),t&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function RI(e,t,r,i){i=i.length?aWe(i):i;const n=e.renderer.state.uniformLocations.get(r);if(i.length)if(n===void 0||n.length!==i.length)e.renderer.state.uniformLocations.set(r,i.slice(0));else{if(oWe(n,i))return;n.set?n.set(i):lWe(n,i),e.renderer.state.uniformLocations.set(r,n)}else{if(n===i)return;e.renderer.state.uniformLocations.set(r,i)}switch(t){case 5126:return i.length?e.uniform1fv(r,i):e.uniform1f(r,i);case 35664:return e.uniform2fv(r,i);case 35665:return e.uniform3fv(r,i);case 35666:return e.uniform4fv(r,i);case 35670:case 5124:case 35678:case 36306:case 35680:case 36289:return i.length?e.uniform1iv(r,i):e.uniform1i(r,i);case 35671:case 35667:return e.uniform2iv(r,i);case 35672:case 35668:return e.uniform3iv(r,i);case 35673:case 35669:return e.uniform4iv(r,i);case 35674:return e.uniformMatrix2fv(r,!1,i);case 35675:return e.uniformMatrix3fv(r,!1,i);case 35676:return e.uniformMatrix4fv(r,!1,i)}}function dK(e){let t=e.split(`
`);for(let r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join(`
`)}function aWe(e){const t=e.length,r=e[0].length;if(r===void 0)return e;const i=t*r;let n=uK[i];n||(uK[i]=n=new Float32Array(i));for(let s=0;s<t;s++)n.set(e[s],s*r);return n}function oWe(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function lWe(e,t){for(let r=0,i=e.length;r<i;r++)e[r]=t[r]}let II=0;function hK(e){II>100||(console.warn(e),II++,II>100&&console.warn("More than 100 program warnings - stopping logs."))}const OI=new is;let cWe=1;class mle{constructor({canvas:t=document.createElement("canvas"),width:r=300,height:i=150,dpr:n=1,alpha:s=!1,depth:a=!0,stencil:o=!1,antialias:l=!1,premultipliedAlpha:c=!1,preserveDrawingBuffer:u=!1,powerPreference:d="default",autoClear:f=!0,webgl:m=2}={}){const v={alpha:s,depth:a,stencil:o,antialias:l,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:d};this.dpr=n,this.alpha=s,this.color=!0,this.depth=a,this.stencil=o,this.premultipliedAlpha=c,this.autoClear=f,this.id=cWe++,m===2&&(this.gl=t.getContext("webgl2",v)),this.isWebgl2=!!this.gl,this.gl||(this.gl=t.getContext("webgl",v)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(r,i),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(t,r){this.width=t,this.height=r,this.gl.canvas.width=t*this.dpr,this.gl.canvas.height=r*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:t+"px",height:r+"px"})}setViewport(t,r,i=0,n=0){this.state.viewport.width===t&&this.state.viewport.height===r||(this.state.viewport.width=t,this.state.viewport.height=r,this.state.viewport.x=i,this.state.viewport.y=n,this.gl.viewport(i,n,t,r))}setScissor(t,r,i=0,n=0){this.gl.scissor(i,n,t,r)}enable(t){this.state[t]!==!0&&(this.gl.enable(t),this.state[t]=!0)}disable(t){this.state[t]!==!1&&(this.gl.disable(t),this.state[t]=!1)}setBlendFunc(t,r,i,n){this.state.blendFunc.src===t&&this.state.blendFunc.dst===r&&this.state.blendFunc.srcAlpha===i&&this.state.blendFunc.dstAlpha===n||(this.state.blendFunc.src=t,this.state.blendFunc.dst=r,this.state.blendFunc.srcAlpha=i,this.state.blendFunc.dstAlpha=n,i!==void 0?this.gl.blendFuncSeparate(t,r,i,n):this.gl.blendFunc(t,r))}setBlendEquation(t,r){t=t||this.gl.FUNC_ADD,!(this.state.blendEquation.modeRGB===t&&this.state.blendEquation.modeAlpha===r)&&(this.state.blendEquation.modeRGB=t,this.state.blendEquation.modeAlpha=r,r!==void 0?this.gl.blendEquationSeparate(t,r):this.gl.blendEquation(t))}setCullFace(t){this.state.cullFace!==t&&(this.state.cullFace=t,this.gl.cullFace(t))}setFrontFace(t){this.state.frontFace!==t&&(this.state.frontFace=t,this.gl.frontFace(t))}setDepthMask(t){this.state.depthMask!==t&&(this.state.depthMask=t,this.gl.depthMask(t))}setDepthFunc(t){this.state.depthFunc!==t&&(this.state.depthFunc=t,this.gl.depthFunc(t))}setStencilMask(t){this.state.stencilMask!==t&&(this.state.stencilMask=t,this.gl.stencilMask(t))}setStencilFunc(t,r,i){this.state.stencilFunc===t&&this.state.stencilRef===r&&this.state.stencilFuncMask===i||(this.state.stencilFunc=t||this.gl.ALWAYS,this.state.stencilRef=r||0,this.state.stencilFuncMask=i||0,this.gl.stencilFunc(t||this.gl.ALWAYS,r||0,i||0))}setStencilOp(t,r,i){this.state.stencilFail===t&&this.state.stencilDepthFail===r&&this.state.stencilDepthPass===i||(this.state.stencilFail=t,this.state.stencilDepthFail=r,this.state.stencilDepthPass=i,this.gl.stencilOp(t,r,i))}activeTexture(t){this.state.activeTextureUnit!==t&&(this.state.activeTextureUnit=t,this.gl.activeTexture(this.gl.TEXTURE0+t))}bindFramebuffer({target:t=this.gl.FRAMEBUFFER,buffer:r=null}={}){this.state.framebuffer!==r&&(this.state.framebuffer=r,this.gl.bindFramebuffer(t,r))}getExtension(t,r,i){return r&&this.gl[r]?this.gl[r].bind(this.gl):(this.extensions[t]||(this.extensions[t]=this.gl.getExtension(t)),r?this.extensions[t]?this.extensions[t][i].bind(this.extensions[t]):null:this.extensions[t])}sortOpaque(t,r){return t.renderOrder!==r.renderOrder?t.renderOrder-r.renderOrder:t.program.id!==r.program.id?t.program.id-r.program.id:t.zDepth!==r.zDepth?t.zDepth-r.zDepth:r.id-t.id}sortTransparent(t,r){return t.renderOrder!==r.renderOrder?t.renderOrder-r.renderOrder:t.zDepth!==r.zDepth?r.zDepth-t.zDepth:r.id-t.id}sortUI(t,r){return t.renderOrder!==r.renderOrder?t.renderOrder-r.renderOrder:t.program.id!==r.program.id?t.program.id-r.program.id:r.id-t.id}getRenderList({scene:t,camera:r,frustumCull:i,sort:n}){let s=[];if(r&&i&&r.updateFrustum(),t.traverse(a=>{if(!a.visible)return!0;a.draw&&(i&&a.frustumCulled&&r&&!r.frustumIntersectsMesh(a)||s.push(a))}),n){const a=[],o=[],l=[];s.forEach(c=>{c.program.transparent?c.program.depthTest?o.push(c):l.push(c):a.push(c),c.zDepth=0,!(c.renderOrder!==0||!c.program.depthTest||!r)&&(c.worldMatrix.getTranslation(OI),OI.applyMatrix4(r.projectionViewMatrix),c.zDepth=OI.z)}),a.sort(this.sortOpaque),o.sort(this.sortTransparent),l.sort(this.sortUI),s=a.concat(o,l)}return s}render({scene:t,camera:r,target:i=null,update:n=!0,sort:s=!0,frustumCull:a=!0,clear:o}){i===null?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(i),this.setViewport(i.width,i.height)),(o||this.autoClear&&o!==!1)&&(this.depth&&(!i||i.depth)&&(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),(this.stencil||!i||i.stencil)&&(this.enable(this.gl.STENCIL_TEST),this.setStencilMask(255)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),n&&t.updateMatrixWorld(),r&&r.updateMatrixWorld(),this.getRenderList({scene:t,camera:r,frustumCull:a,sort:s}).forEach(c=>{c.draw({camera:r})})}}function uWe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function dWe(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}function hWe(e,t){let r=t[0],i=t[1],n=t[2],s=t[3],a=r*r+i*i+n*n+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=i*a,e[2]=n*a,e[3]=s*a,e}function fWe(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function pWe(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function mWe(e,t,r){r=r*.5;let i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e}function fK(e,t,r){let i=t[0],n=t[1],s=t[2],a=t[3],o=r[0],l=r[1],c=r[2],u=r[3];return e[0]=i*u+a*o+n*c-s*l,e[1]=n*u+a*l+s*o-i*c,e[2]=s*u+a*c+i*l-n*o,e[3]=a*u-i*o-n*l-s*c,e}function gWe(e,t,r){r*=.5;let i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l+a*o,e[1]=n*l+s*o,e[2]=s*l-n*o,e[3]=a*l-i*o,e}function vWe(e,t,r){r*=.5;let i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l-s*o,e[1]=n*l+a*o,e[2]=s*l+i*o,e[3]=a*l-n*o,e}function yWe(e,t,r){r*=.5;let i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l+n*o,e[1]=n*l-i*o,e[2]=s*l+a*o,e[3]=a*l-s*o,e}function xWe(e,t,r,i){let n=t[0],s=t[1],a=t[2],o=t[3],l=r[0],c=r[1],u=r[2],d=r[3],f,m,v,y,x;return m=n*l+s*c+a*u+o*d,m<0&&(m=-m,l=-l,c=-c,u=-u,d=-d),1-m>1e-6?(f=Math.acos(m),v=Math.sin(f),y=Math.sin((1-i)*f)/v,x=Math.sin(i*f)/v):(y=1-i,x=i),e[0]=y*n+x*l,e[1]=y*s+x*c,e[2]=y*a+x*u,e[3]=y*o+x*d,e}function bWe(e,t){let r=t[0],i=t[1],n=t[2],s=t[3],a=r*r+i*i+n*n+s*s,o=a?1/a:0;return e[0]=-r*o,e[1]=-i*o,e[2]=-n*o,e[3]=s*o,e}function wWe(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function _We(e,t){let r=t[0]+t[4]+t[8],i;if(r>0)i=Math.sqrt(r+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{let n=0;t[4]>t[0]&&(n=1),t[8]>t[n*3+n]&&(n=2);let s=(n+1)%3,a=(n+2)%3;i=Math.sqrt(t[n*3+n]-t[s*3+s]-t[a*3+a]+1),e[n]=.5*i,i=.5/i,e[3]=(t[s*3+a]-t[a*3+s])*i,e[s]=(t[s*3+n]+t[n*3+s])*i,e[a]=(t[a*3+n]+t[n*3+a])*i}return e}function SWe(e,t,r="YXZ"){let i=Math.sin(t[0]*.5),n=Math.cos(t[0]*.5),s=Math.sin(t[1]*.5),a=Math.cos(t[1]*.5),o=Math.sin(t[2]*.5),l=Math.cos(t[2]*.5);return r==="XYZ"?(e[0]=i*a*l+n*s*o,e[1]=n*s*l-i*a*o,e[2]=n*a*o+i*s*l,e[3]=n*a*l-i*s*o):r==="YXZ"?(e[0]=i*a*l+n*s*o,e[1]=n*s*l-i*a*o,e[2]=n*a*o-i*s*l,e[3]=n*a*l+i*s*o):r==="ZXY"?(e[0]=i*a*l-n*s*o,e[1]=n*s*l+i*a*o,e[2]=n*a*o+i*s*l,e[3]=n*a*l-i*s*o):r==="ZYX"?(e[0]=i*a*l-n*s*o,e[1]=n*s*l+i*a*o,e[2]=n*a*o-i*s*l,e[3]=n*a*l+i*s*o):r==="YZX"?(e[0]=i*a*l+n*s*o,e[1]=n*s*l+i*a*o,e[2]=n*a*o-i*s*l,e[3]=n*a*l-i*s*o):r==="XZY"&&(e[0]=i*a*l-n*s*o,e[1]=n*s*l-i*a*o,e[2]=n*a*o+i*s*l,e[3]=n*a*l+i*s*o),e}const EWe=uWe,AWe=dWe,CWe=fWe,TWe=hWe;class MWe extends Array{constructor(t=0,r=0,i=0,n=1){super(t,r,i,n),this.onChange=()=>{},this._target=this;const s=["0","1","2","3"];return new Proxy(this,{set(a,o){const l=Reflect.set(...arguments);return l&&s.includes(o)&&a.onChange(),l}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(t){this._target[0]=t,this.onChange()}set y(t){this._target[1]=t,this.onChange()}set z(t){this._target[2]=t,this.onChange()}set w(t){this._target[3]=t,this.onChange()}identity(){return pWe(this._target),this.onChange(),this}set(t,r,i,n){return t.length?this.copy(t):(AWe(this._target,t,r,i,n),this.onChange(),this)}rotateX(t){return gWe(this._target,this._target,t),this.onChange(),this}rotateY(t){return vWe(this._target,this._target,t),this.onChange(),this}rotateZ(t){return yWe(this._target,this._target,t),this.onChange(),this}inverse(t=this._target){return bWe(this._target,t),this.onChange(),this}conjugate(t=this._target){return wWe(this._target,t),this.onChange(),this}copy(t){return EWe(this._target,t),this.onChange(),this}normalize(t=this._target){return TWe(this._target,t),this.onChange(),this}multiply(t,r){return r?fK(this._target,t,r):fK(this._target,this._target,t),this.onChange(),this}dot(t){return CWe(this._target,t)}fromMatrix3(t){return _We(this._target,t),this.onChange(),this}fromEuler(t,r){return SWe(this._target,t,t.order),r||this.onChange(),this}fromAxisAngle(t,r){return mWe(this._target,t,r),this.onChange(),this}slerp(t,r){return xWe(this._target,this._target,t,r),this.onChange(),this}fromArray(t,r=0){return this._target[0]=t[r],this._target[1]=t[r+1],this._target[2]=t[r+2],this._target[3]=t[r+3],this.onChange(),this}toArray(t=[],r=0){return t[r]=this[0],t[r+1]=this[1],t[r+2]=this[2],t[r+3]=this[3],t}}const PWe=1e-6;function DWe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function NWe(e,t,r,i,n,s,a,o,l,c,u,d,f,m,v,y,x){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e[9]=u,e[10]=d,e[11]=f,e[12]=m,e[13]=v,e[14]=y,e[15]=x,e}function kWe(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function RWe(e,t){let r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=t[8],d=t[9],f=t[10],m=t[11],v=t[12],y=t[13],x=t[14],w=t[15],_=r*o-i*a,S=r*l-n*a,P=r*c-s*a,M=i*l-n*o,C=i*c-s*o,T=n*c-s*l,E=u*y-d*v,N=u*x-f*v,D=u*w-m*v,I=d*x-f*y,j=d*w-m*y,L=f*w-m*x,B=_*L-S*j+P*I+M*D-C*N+T*E;return B?(B=1/B,e[0]=(o*L-l*j+c*I)*B,e[1]=(n*j-i*L-s*I)*B,e[2]=(y*T-x*C+w*M)*B,e[3]=(f*C-d*T-m*M)*B,e[4]=(l*D-a*L-c*N)*B,e[5]=(r*L-n*D+s*N)*B,e[6]=(x*P-v*T-w*S)*B,e[7]=(u*T-f*P+m*S)*B,e[8]=(a*j-o*D+c*E)*B,e[9]=(i*D-r*j-s*E)*B,e[10]=(v*C-y*P+w*_)*B,e[11]=(d*P-u*C-m*_)*B,e[12]=(o*N-a*I-l*E)*B,e[13]=(r*I-i*N+n*E)*B,e[14]=(y*S-v*M-x*_)*B,e[15]=(u*M-d*S+f*_)*B,e):null}function gle(e){let t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=e[9],d=e[10],f=e[11],m=e[12],v=e[13],y=e[14],x=e[15],w=t*a-r*s,_=t*o-i*s,S=t*l-n*s,P=r*o-i*a,M=r*l-n*a,C=i*l-n*o,T=c*v-u*m,E=c*y-d*m,N=c*x-f*m,D=u*y-d*v,I=u*x-f*v,j=d*x-f*y;return w*j-_*I+S*D+P*N-M*E+C*T}function pK(e,t,r){let i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],u=t[7],d=t[8],f=t[9],m=t[10],v=t[11],y=t[12],x=t[13],w=t[14],_=t[15],S=r[0],P=r[1],M=r[2],C=r[3];return e[0]=S*i+P*o+M*d+C*y,e[1]=S*n+P*l+M*f+C*x,e[2]=S*s+P*c+M*m+C*w,e[3]=S*a+P*u+M*v+C*_,S=r[4],P=r[5],M=r[6],C=r[7],e[4]=S*i+P*o+M*d+C*y,e[5]=S*n+P*l+M*f+C*x,e[6]=S*s+P*c+M*m+C*w,e[7]=S*a+P*u+M*v+C*_,S=r[8],P=r[9],M=r[10],C=r[11],e[8]=S*i+P*o+M*d+C*y,e[9]=S*n+P*l+M*f+C*x,e[10]=S*s+P*c+M*m+C*w,e[11]=S*a+P*u+M*v+C*_,S=r[12],P=r[13],M=r[14],C=r[15],e[12]=S*i+P*o+M*d+C*y,e[13]=S*n+P*l+M*f+C*x,e[14]=S*s+P*c+M*m+C*w,e[15]=S*a+P*u+M*v+C*_,e}function IWe(e,t,r){let i=r[0],n=r[1],s=r[2],a,o,l,c,u,d,f,m,v,y,x,w;return t===e?(e[12]=t[0]*i+t[4]*n+t[8]*s+t[12],e[13]=t[1]*i+t[5]*n+t[9]*s+t[13],e[14]=t[2]*i+t[6]*n+t[10]*s+t[14],e[15]=t[3]*i+t[7]*n+t[11]*s+t[15]):(a=t[0],o=t[1],l=t[2],c=t[3],u=t[4],d=t[5],f=t[6],m=t[7],v=t[8],y=t[9],x=t[10],w=t[11],e[0]=a,e[1]=o,e[2]=l,e[3]=c,e[4]=u,e[5]=d,e[6]=f,e[7]=m,e[8]=v,e[9]=y,e[10]=x,e[11]=w,e[12]=a*i+u*n+v*s+t[12],e[13]=o*i+d*n+y*s+t[13],e[14]=l*i+f*n+x*s+t[14],e[15]=c*i+m*n+w*s+t[15]),e}function OWe(e,t,r){let i=r[0],n=r[1],s=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function jWe(e,t,r,i){let n=i[0],s=i[1],a=i[2],o=Math.hypot(n,s,a),l,c,u,d,f,m,v,y,x,w,_,S,P,M,C,T,E,N,D,I,j,L,B,q;return Math.abs(o)<PWe?null:(o=1/o,n*=o,s*=o,a*=o,l=Math.sin(r),c=Math.cos(r),u=1-c,d=t[0],f=t[1],m=t[2],v=t[3],y=t[4],x=t[5],w=t[6],_=t[7],S=t[8],P=t[9],M=t[10],C=t[11],T=n*n*u+c,E=s*n*u+a*l,N=a*n*u-s*l,D=n*s*u-a*l,I=s*s*u+c,j=a*s*u+n*l,L=n*a*u+s*l,B=s*a*u-n*l,q=a*a*u+c,e[0]=d*T+y*E+S*N,e[1]=f*T+x*E+P*N,e[2]=m*T+w*E+M*N,e[3]=v*T+_*E+C*N,e[4]=d*D+y*I+S*j,e[5]=f*D+x*I+P*j,e[6]=m*D+w*I+M*j,e[7]=v*D+_*I+C*j,e[8]=d*L+y*B+S*q,e[9]=f*L+x*B+P*q,e[10]=m*L+w*B+M*q,e[11]=v*L+_*B+C*q,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function LWe(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function vle(e,t){let r=t[0],i=t[1],n=t[2],s=t[4],a=t[5],o=t[6],l=t[8],c=t[9],u=t[10];return e[0]=Math.hypot(r,i,n),e[1]=Math.hypot(s,a,o),e[2]=Math.hypot(l,c,u),e}function zWe(e){let t=e[0],r=e[1],i=e[2],n=e[4],s=e[5],a=e[6],o=e[8],l=e[9],c=e[10];const u=t*t+r*r+i*i,d=n*n+s*s+a*a,f=o*o+l*l+c*c;return Math.sqrt(Math.max(u,d,f))}const yle=function(){const e=[1,1,1];return function(t,r){let i=e;vle(i,r);let n=1/i[0],s=1/i[1],a=1/i[2],o=r[0]*n,l=r[1]*s,c=r[2]*a,u=r[4]*n,d=r[5]*s,f=r[6]*a,m=r[8]*n,v=r[9]*s,y=r[10]*a,x=o+d+y,w=0;return x>0?(w=Math.sqrt(x+1)*2,t[3]=.25*w,t[0]=(f-v)/w,t[1]=(m-c)/w,t[2]=(l-u)/w):o>d&&o>y?(w=Math.sqrt(1+o-d-y)*2,t[3]=(f-v)/w,t[0]=.25*w,t[1]=(l+u)/w,t[2]=(m+c)/w):d>y?(w=Math.sqrt(1+d-o-y)*2,t[3]=(m-c)/w,t[0]=(l+u)/w,t[1]=.25*w,t[2]=(f+v)/w):(w=Math.sqrt(1+y-o-d)*2,t[3]=(l-u)/w,t[0]=(m+c)/w,t[1]=(f+v)/w,t[2]=.25*w),t}}();function BWe(e,t,r,i){let n=s2([e[0],e[1],e[2]]);const s=s2([e[4],e[5],e[6]]),a=s2([e[8],e[9],e[10]]);gle(e)<0&&(n=-n),r[0]=e[12],r[1]=e[13],r[2]=e[14];const l=e.slice(),c=1/n,u=1/s,d=1/a;l[0]*=c,l[1]*=c,l[2]*=c,l[4]*=u,l[5]*=u,l[6]*=u,l[8]*=d,l[9]*=d,l[10]*=d,yle(t,l),i[0]=n,i[1]=s,i[2]=a}function FWe(e,t,r,i){const n=e,s=t[0],a=t[1],o=t[2],l=t[3],c=s+s,u=a+a,d=o+o,f=s*c,m=s*u,v=s*d,y=a*u,x=a*d,w=o*d,_=l*c,S=l*u,P=l*d,M=i[0],C=i[1],T=i[2];return n[0]=(1-(y+w))*M,n[1]=(m+P)*M,n[2]=(v-S)*M,n[3]=0,n[4]=(m-P)*C,n[5]=(1-(f+w))*C,n[6]=(x+_)*C,n[7]=0,n[8]=(v+S)*T,n[9]=(x-_)*T,n[10]=(1-(f+y))*T,n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n}function VWe(e,t){let r=t[0],i=t[1],n=t[2],s=t[3],a=r+r,o=i+i,l=n+n,c=r*a,u=i*a,d=i*o,f=n*a,m=n*o,v=n*l,y=s*a,x=s*o,w=s*l;return e[0]=1-d-v,e[1]=u+w,e[2]=f-x,e[3]=0,e[4]=u-w,e[5]=1-c-v,e[6]=m+y,e[7]=0,e[8]=f+x,e[9]=m-y,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function UWe(e,t,r,i,n){let s=1/Math.tan(t/2),a=1/(i-n);return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(n+i)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*n*i*a,e[15]=0,e}function HWe(e,t,r,i,n,s,a){let o=1/(t-r),l=1/(i-n),c=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*o,e[13]=(n+i)*l,e[14]=(a+s)*c,e[15]=1,e}function GWe(e,t,r,i){let n=t[0],s=t[1],a=t[2],o=i[0],l=i[1],c=i[2],u=n-r[0],d=s-r[1],f=a-r[2],m=u*u+d*d+f*f;m===0?f=1:(m=1/Math.sqrt(m),u*=m,d*=m,f*=m);let v=l*f-c*d,y=c*u-o*f,x=o*d-l*u;return m=v*v+y*y+x*x,m===0&&(c?o+=1e-6:l?c+=1e-6:l+=1e-6,v=l*f-c*d,y=c*u-o*f,x=o*d-l*u,m=v*v+y*y+x*x),m=1/Math.sqrt(m),v*=m,y*=m,x*=m,e[0]=v,e[1]=y,e[2]=x,e[3]=0,e[4]=d*x-f*y,e[5]=f*v-u*x,e[6]=u*y-d*v,e[7]=0,e[8]=u,e[9]=d,e[10]=f,e[11]=0,e[12]=n,e[13]=s,e[14]=a,e[15]=1,e}function mK(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function gK(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function WWe(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}class Ep extends Array{constructor(t=1,r=0,i=0,n=0,s=0,a=1,o=0,l=0,c=0,u=0,d=1,f=0,m=0,v=0,y=0,x=1){return super(t,r,i,n,s,a,o,l,c,u,d,f,m,v,y,x),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(t){this[12]=t}set y(t){this[13]=t}set z(t){this[14]=t}set w(t){this[15]=t}set(t,r,i,n,s,a,o,l,c,u,d,f,m,v,y,x){return t.length?this.copy(t):(NWe(this,t,r,i,n,s,a,o,l,c,u,d,f,m,v,y,x),this)}translate(t,r=this){return IWe(this,r,t),this}rotate(t,r,i=this){return jWe(this,i,t,r),this}scale(t,r=this){return OWe(this,r,typeof t=="number"?[t,t,t]:t),this}add(t,r){return r?mK(this,t,r):mK(this,this,t),this}sub(t,r){return r?gK(this,t,r):gK(this,this,t),this}multiply(t,r){return t.length?r?pK(this,t,r):pK(this,this,t):WWe(this,this,t),this}identity(){return kWe(this),this}copy(t){return DWe(this,t),this}fromPerspective({fov:t,aspect:r,near:i,far:n}={}){return UWe(this,t,r,i,n),this}fromOrthogonal({left:t,right:r,bottom:i,top:n,near:s,far:a}){return HWe(this,t,r,i,n,s,a),this}fromQuaternion(t){return VWe(this,t),this}setPosition(t){return this.x=t[0],this.y=t[1],this.z=t[2],this}inverse(t=this){return RWe(this,t),this}compose(t,r,i){return FWe(this,t,r,i),this}decompose(t,r,i){return BWe(this,t,r,i),this}getRotation(t){return yle(t,this),this}getTranslation(t){return LWe(t,this),this}getScaling(t){return vle(t,this),this}getMaxScaleOnAxis(){return zWe(this)}lookAt(t,r,i){return GWe(this,t,r,i),this}determinant(){return gle(this)}fromArray(t,r=0){return this[0]=t[r],this[1]=t[r+1],this[2]=t[r+2],this[3]=t[r+3],this[4]=t[r+4],this[5]=t[r+5],this[6]=t[r+6],this[7]=t[r+7],this[8]=t[r+8],this[9]=t[r+9],this[10]=t[r+10],this[11]=t[r+11],this[12]=t[r+12],this[13]=t[r+13],this[14]=t[r+14],this[15]=t[r+15],this}toArray(t=[],r=0){return t[r]=this[0],t[r+1]=this[1],t[r+2]=this[2],t[r+3]=this[3],t[r+4]=this[4],t[r+5]=this[5],t[r+6]=this[6],t[r+7]=this[7],t[r+8]=this[8],t[r+9]=this[9],t[r+10]=this[10],t[r+11]=this[11],t[r+12]=this[12],t[r+13]=this[13],t[r+14]=this[14],t[r+15]=this[15],t}}function qWe(e,t,r="YXZ"){return r==="XYZ"?(e[1]=Math.asin(Math.min(Math.max(t[8],-1),1)),Math.abs(t[8])<.99999?(e[0]=Math.atan2(-t[9],t[10]),e[2]=Math.atan2(-t[4],t[0])):(e[0]=Math.atan2(t[6],t[5]),e[2]=0)):r==="YXZ"?(e[0]=Math.asin(-Math.min(Math.max(t[9],-1),1)),Math.abs(t[9])<.99999?(e[1]=Math.atan2(t[8],t[10]),e[2]=Math.atan2(t[1],t[5])):(e[1]=Math.atan2(-t[2],t[0]),e[2]=0)):r==="ZXY"?(e[0]=Math.asin(Math.min(Math.max(t[6],-1),1)),Math.abs(t[6])<.99999?(e[1]=Math.atan2(-t[2],t[10]),e[2]=Math.atan2(-t[4],t[5])):(e[1]=0,e[2]=Math.atan2(t[1],t[0]))):r==="ZYX"?(e[1]=Math.asin(-Math.min(Math.max(t[2],-1),1)),Math.abs(t[2])<.99999?(e[0]=Math.atan2(t[6],t[10]),e[2]=Math.atan2(t[1],t[0])):(e[0]=0,e[2]=Math.atan2(-t[4],t[5]))):r==="YZX"?(e[2]=Math.asin(Math.min(Math.max(t[1],-1),1)),Math.abs(t[1])<.99999?(e[0]=Math.atan2(-t[9],t[5]),e[1]=Math.atan2(-t[2],t[0])):(e[0]=0,e[1]=Math.atan2(t[8],t[10]))):r==="XZY"&&(e[2]=Math.asin(-Math.min(Math.max(t[4],-1),1)),Math.abs(t[4])<.99999?(e[0]=Math.atan2(t[6],t[5]),e[1]=Math.atan2(t[8],t[0])):(e[0]=Math.atan2(-t[9],t[10]),e[1]=0)),e}const vK=new Ep;class YWe extends Array{constructor(t=0,r=t,i=t,n="YXZ"){super(t,r,i),this.order=n,this.onChange=()=>{},this._target=this;const s=["0","1","2"];return new Proxy(this,{set(a,o){const l=Reflect.set(...arguments);return l&&s.includes(o)&&a.onChange(),l}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this._target[0]=t,this.onChange()}set y(t){this._target[1]=t,this.onChange()}set z(t){this._target[2]=t,this.onChange()}set(t,r=t,i=t){return t.length?this.copy(t):(this._target[0]=t,this._target[1]=r,this._target[2]=i,this.onChange(),this)}copy(t){return this._target[0]=t[0],this._target[1]=t[1],this._target[2]=t[2],this.onChange(),this}reorder(t){return this._target.order=t,this.onChange(),this}fromRotationMatrix(t,r=this.order){return qWe(this._target,t,r),this.onChange(),this}fromQuaternion(t,r=this.order,i){return vK.fromQuaternion(t),this._target.fromRotationMatrix(vK,r),i||this.onChange(),this}fromArray(t,r=0){return this._target[0]=t[r],this._target[1]=t[r+1],this._target[2]=t[r+2],this}toArray(t=[],r=0){return t[r]=this[0],t[r+1]=this[1],t[r+2]=this[2],t}}class xle{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new Ep,this.worldMatrix=new Ep,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new is,this.quaternion=new MWe,this.scale=new is(1),this.rotation=new YWe,this.up=new is(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(t,r=!0){this.parent&&t!==this.parent&&this.parent.removeChild(this,!1),this.parent=t,r&&t&&t.addChild(this,!1)}addChild(t,r=!0){~this.children.indexOf(t)||this.children.push(t),r&&t.setParent(this,!1)}removeChild(t,r=!0){~this.children.indexOf(t)&&this.children.splice(this.children.indexOf(t),1),r&&t.setParent(null,!1)}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||t)&&(this.parent===null?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,t=!0);for(let r=0,i=this.children.length;r<i;r++)this.children[r].updateMatrixWorld(t)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(t){if(!t(this))for(let r=0,i=this.children.length;r<i;r++)this.children[r].traverse(t)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(t,r=!1){r?this.matrix.lookAt(this.position,t,this.up):this.matrix.lookAt(t,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}const XWe=new Ep,$We=new is,KWe=new is;class QWe extends xle{constructor(t,{near:r=.1,far:i=100,fov:n=45,aspect:s=1,left:a,right:o,bottom:l,top:c,zoom:u=1}={}){super(),Object.assign(this,{near:r,far:i,fov:n,aspect:s,left:a,right:o,bottom:l,top:c,zoom:u}),this.projectionMatrix=new Ep,this.viewMatrix=new Ep,this.projectionViewMatrix=new Ep,this.worldPosition=new is,this.type=a||o?"orthographic":"perspective",this.type==="orthographic"?this.orthographic():this.perspective()}perspective({near:t=this.near,far:r=this.far,fov:i=this.fov,aspect:n=this.aspect}={}){return Object.assign(this,{near:t,far:r,fov:i,aspect:n}),this.projectionMatrix.fromPerspective({fov:i*(Math.PI/180),aspect:n,near:t,far:r}),this.type="perspective",this}orthographic({near:t=this.near,far:r=this.far,left:i=this.left||-1,right:n=this.right||1,bottom:s=this.bottom||-1,top:a=this.top||1,zoom:o=this.zoom}={}){return Object.assign(this,{near:t,far:r,left:i,right:n,bottom:s,top:a,zoom:o}),i/=o,n/=o,s/=o,a/=o,this.projectionMatrix.fromOrthogonal({left:i,right:n,bottom:s,top:a,near:t,far:r}),this.type="orthographic",this}updateMatrixWorld(){return super.updateMatrixWorld(),this.viewMatrix.inverse(this.worldMatrix),this.worldMatrix.getTranslation(this.worldPosition),this.projectionViewMatrix.multiply(this.projectionMatrix,this.viewMatrix),this}updateProjectionMatrix(){return this.type==="perspective"?this.perspective():this.orthographic()}lookAt(t){return super.lookAt(t,!0),this}project(t){return t.applyMatrix4(this.viewMatrix),t.applyMatrix4(this.projectionMatrix),this}unproject(t){return t.applyMatrix4(XWe.inverse(this.projectionMatrix)),t.applyMatrix4(this.worldMatrix),this}updateFrustum(){this.frustum||(this.frustum=[new is,new is,new is,new is,new is,new is]);const t=this.projectionViewMatrix;this.frustum[0].set(t[3]-t[0],t[7]-t[4],t[11]-t[8]).constant=t[15]-t[12],this.frustum[1].set(t[3]+t[0],t[7]+t[4],t[11]+t[8]).constant=t[15]+t[12],this.frustum[2].set(t[3]+t[1],t[7]+t[5],t[11]+t[9]).constant=t[15]+t[13],this.frustum[3].set(t[3]-t[1],t[7]-t[5],t[11]-t[9]).constant=t[15]-t[13],this.frustum[4].set(t[3]-t[2],t[7]-t[6],t[11]-t[10]).constant=t[15]-t[14],this.frustum[5].set(t[3]+t[2],t[7]+t[6],t[11]+t[10]).constant=t[15]+t[14];for(let r=0;r<6;r++){const i=1/this.frustum[r].distance();this.frustum[r].multiply(i),this.frustum[r].constant*=i}}frustumIntersectsMesh(t,r=t.worldMatrix){if(!t.geometry.attributes.position||((!t.geometry.bounds||t.geometry.bounds.radius===1/0)&&t.geometry.computeBoundingSphere(),!t.geometry.bounds))return!0;const i=$We;i.copy(t.geometry.bounds.center),i.applyMatrix4(r);const n=t.geometry.bounds.radius*r.getMaxScaleOnAxis();return this.frustumIntersectsSphere(i,n)}frustumIntersectsSphere(t,r){const i=KWe;for(let n=0;n<6;n++){const s=this.frustum[n];if(i.copy(s).dot(t)+s.constant<-r)return!1}return!0}}function ZWe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function JWe(e,t){let r=t[0],i=t[1],n=t[2],s=t[3],a=r+r,o=i+i,l=n+n,c=r*a,u=i*a,d=i*o,f=n*a,m=n*o,v=n*l,y=s*a,x=s*o,w=s*l;return e[0]=1-d-v,e[3]=u-w,e[6]=f+x,e[1]=u+w,e[4]=1-c-v,e[7]=m-y,e[2]=f-x,e[5]=m+y,e[8]=1-c-d,e}function eqe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function tqe(e,t,r,i,n,s,a,o,l,c){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e}function rqe(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function iqe(e,t){let r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=t[8],d=u*a-o*c,f=-u*s+o*l,m=c*s-a*l,v=r*d+i*f+n*m;return v?(v=1/v,e[0]=d*v,e[1]=(-u*i+n*c)*v,e[2]=(o*i-n*a)*v,e[3]=f*v,e[4]=(u*r-n*l)*v,e[5]=(-o*r+n*s)*v,e[6]=m*v,e[7]=(-c*r+i*l)*v,e[8]=(a*r-i*s)*v,e):null}function yK(e,t,r){let i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],u=t[7],d=t[8],f=r[0],m=r[1],v=r[2],y=r[3],x=r[4],w=r[5],_=r[6],S=r[7],P=r[8];return e[0]=f*i+m*a+v*c,e[1]=f*n+m*o+v*u,e[2]=f*s+m*l+v*d,e[3]=y*i+x*a+w*c,e[4]=y*n+x*o+w*u,e[5]=y*s+x*l+w*d,e[6]=_*i+S*a+P*c,e[7]=_*n+S*o+P*u,e[8]=_*s+S*l+P*d,e}function nqe(e,t,r){let i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],u=t[7],d=t[8],f=r[0],m=r[1];return e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=o,e[5]=l,e[6]=f*i+m*a+c,e[7]=f*n+m*o+u,e[8]=f*s+m*l+d,e}function sqe(e,t,r){let i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],u=t[7],d=t[8],f=Math.sin(r),m=Math.cos(r);return e[0]=m*i+f*a,e[1]=m*n+f*o,e[2]=m*s+f*l,e[3]=m*a-f*i,e[4]=m*o-f*n,e[5]=m*l-f*s,e[6]=c,e[7]=u,e[8]=d,e}function aqe(e,t,r){let i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function oqe(e,t){let r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=t[8],d=t[9],f=t[10],m=t[11],v=t[12],y=t[13],x=t[14],w=t[15],_=r*o-i*a,S=r*l-n*a,P=r*c-s*a,M=i*l-n*o,C=i*c-s*o,T=n*c-s*l,E=u*y-d*v,N=u*x-f*v,D=u*w-m*v,I=d*x-f*y,j=d*w-m*y,L=f*w-m*x,B=_*L-S*j+P*I+M*D-C*N+T*E;return B?(B=1/B,e[0]=(o*L-l*j+c*I)*B,e[1]=(l*D-a*L-c*N)*B,e[2]=(a*j-o*D+c*E)*B,e[3]=(n*j-i*L-s*I)*B,e[4]=(r*L-n*D+s*N)*B,e[5]=(i*D-r*j-s*E)*B,e[6]=(y*T-x*C+w*M)*B,e[7]=(x*P-v*T-w*S)*B,e[8]=(v*C-y*P+w*_)*B,e):null}class lqe extends Array{constructor(t=1,r=0,i=0,n=0,s=1,a=0,o=0,l=0,c=1){return super(t,r,i,n,s,a,o,l,c),this}set(t,r,i,n,s,a,o,l,c){return t.length?this.copy(t):(tqe(this,t,r,i,n,s,a,o,l,c),this)}translate(t,r=this){return nqe(this,r,t),this}rotate(t,r=this){return sqe(this,r,t),this}scale(t,r=this){return aqe(this,r,t),this}multiply(t,r){return r?yK(this,t,r):yK(this,this,t),this}identity(){return rqe(this),this}copy(t){return eqe(this,t),this}fromMatrix4(t){return ZWe(this,t),this}fromQuaternion(t){return JWe(this,t),this}fromBasis(t,r,i){return this.set(t[0],t[1],t[2],r[0],r[1],r[2],i[0],i[1],i[2]),this}inverse(t=this){return iqe(this,t),this}getNormalMatrix(t){return oqe(this,t),this}}let cqe=0;class ble extends xle{constructor(t,{geometry:r,program:i,mode:n=t.TRIANGLES,frustumCulled:s=!0,renderOrder:a=0}={}){super(),t.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=t,this.id=cqe++,this.geometry=r,this.program=i,this.mode=n,this.frustumCulled=s,this.renderOrder=a,this.modelViewMatrix=new Ep,this.normalMatrix=new lqe,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(t){return this.beforeRenderCallbacks.push(t),this}onAfterRender(t){return this.afterRenderCallbacks.push(t),this}draw({camera:t}={}){t&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=t.projectionMatrix,this.program.uniforms.cameraPosition.value=t.worldPosition,this.program.uniforms.viewMatrix.value=t.viewMatrix,this.modelViewMatrix.multiply(t.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(i=>i&&i({mesh:this,camera:t}));let r=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:r}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(i=>i&&i({mesh:this,camera:t}))}}class uqe extends fle{constructor(t,{attributes:r={}}={}){Object.assign(r,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),super(t,r)}}const dqe="#ffffff",xK=e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255]:[1,1,1]},bK=(e,t,r)=>{switch(e){case"top-left":return{anchor:[0,-.2*r],dir:[0,1]};case"top-right":return{anchor:[t,-.2*r],dir:[0,1]};case"left":return{anchor:[-.2*t,.5*r],dir:[1,0]};case"right":return{anchor:[(1+.2)*t,.5*r],dir:[-1,0]};case"bottom-left":return{anchor:[0,(1+.2)*r],dir:[0,-1]};case"bottom-center":return{anchor:[.5*t,(1+.2)*r],dir:[0,-1]};case"bottom-right":return{anchor:[t,(1+.2)*r],dir:[0,-1]};default:return{anchor:[.5*t,-.2*r],dir:[0,1]}}},hqe=({raysOrigin:e="top-center",raysColor:t=dqe,raysSpeed:r=1,lightSpread:i=1,rayLength:n=2,pulsating:s=!1,fadeDistance:a=1,saturation:o=1,followMouse:l=!0,mouseInfluence:c=.1,noiseAmount:u=0,distortion:d=0,className:f=""})=>{const m=O.useRef(null),v=O.useRef(null),y=O.useRef(null),x=O.useRef({x:.5,y:.5}),w=O.useRef({x:.5,y:.5}),_=O.useRef(null),S=O.useRef(null),P=O.useRef(null),[M,C]=O.useState(!1),T=O.useRef(null);return O.useEffect(()=>{if(m.current)return T.current=new IntersectionObserver(E=>{const N=E[0];C(N.isIntersecting)},{threshold:.1}),T.current.observe(m.current),()=>{T.current&&(T.current.disconnect(),T.current=null)}},[]),O.useEffect(()=>!M||!m.current?void 0:(P.current&&(P.current(),P.current=null),(async()=>{if(!m.current||(await new Promise(re=>setTimeout(re,10)),!m.current))return;const N=new mle({dpr:Math.min(window.devicePixelRatio,2),alpha:!0});y.current=N;const D=N.gl;for(D.canvas.style.width="100%",D.canvas.style.height="100%";m.current.firstChild;)m.current.removeChild(m.current.firstChild);m.current.appendChild(D.canvas);const I=`
attribute vec2 position;
varying vec2 vUv;
void main() {
  vUv = position * 0.5 + 0.5;
  gl_Position = vec4(position, 0.0, 1.0);
}`,j=`precision highp float;

uniform float iTime;
uniform vec2  iResolution;

uniform vec2  rayPos;
uniform vec2  rayDir;
uniform vec3  raysColor;
uniform float raysSpeed;
uniform float lightSpread;
uniform float rayLength;
uniform float pulsating;
uniform float fadeDistance;
uniform float saturation;
uniform vec2  mousePos;
uniform float mouseInfluence;
uniform float noiseAmount;
uniform float distortion;

varying vec2 vUv;

float noise(vec2 st) {
  return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);
}

float rayStrength(vec2 raySource, vec2 rayRefDirection, vec2 coord,
                  float seedA, float seedB, float speed) {
  vec2 sourceToCoord = coord - raySource;
  vec2 dirNorm = normalize(sourceToCoord);
  float cosAngle = dot(dirNorm, rayRefDirection);

  float distortedAngle = cosAngle + distortion * sin(iTime * 2.0 + length(sourceToCoord) * 0.01) * 0.2;
  
  float spreadFactor = pow(max(distortedAngle, 0.0), 1.0 / max(lightSpread, 0.001));

  float distance = length(sourceToCoord);
  float maxDistance = iResolution.x * rayLength;
  float lengthFalloff = clamp((maxDistance - distance) / maxDistance, 0.0, 1.0);
  
  float fadeFalloff = clamp((iResolution.x * fadeDistance - distance) / (iResolution.x * fadeDistance), 0.5, 1.0);
  float pulse = pulsating > 0.5 ? (0.8 + 0.2 * sin(iTime * speed * 3.0)) : 1.0;

  float baseStrength = clamp(
    (0.45 + 0.15 * sin(distortedAngle * seedA + iTime * speed)) +
    (0.3 + 0.2 * cos(-distortedAngle * seedB + iTime * speed)),
    0.0, 1.0
  );

  return baseStrength * lengthFalloff * fadeFalloff * spreadFactor * pulse;
}

void mainImage(out vec4 fragColor, in vec2 fragCoord) {
  vec2 coord = vec2(fragCoord.x, iResolution.y - fragCoord.y);
  
  vec2 finalRayDir = rayDir;
  if (mouseInfluence > 0.0) {
    vec2 mouseScreenPos = mousePos * iResolution.xy;
    vec2 mouseDirection = normalize(mouseScreenPos - rayPos);
    finalRayDir = normalize(mix(rayDir, mouseDirection, mouseInfluence));
  }

  vec4 rays1 = vec4(1.0) *
               rayStrength(rayPos, finalRayDir, coord, 36.2214, 21.11349,
                           1.5 * raysSpeed);
  vec4 rays2 = vec4(1.0) *
               rayStrength(rayPos, finalRayDir, coord, 22.3991, 18.0234,
                           1.1 * raysSpeed);

  fragColor = rays1 * 0.5 + rays2 * 0.4;

  if (noiseAmount > 0.0) {
    float n = noise(coord * 0.01 + iTime * 0.1);
    fragColor.rgb *= (1.0 - noiseAmount + noiseAmount * n);
  }

  float brightness = 1.0 - (coord.y / iResolution.y);
  fragColor.x *= 0.1 + brightness * 0.8;
  fragColor.y *= 0.3 + brightness * 0.6;
  fragColor.z *= 0.5 + brightness * 0.5;

  if (saturation != 1.0) {
    float gray = dot(fragColor.rgb, vec3(0.299, 0.587, 0.114));
    fragColor.rgb = mix(vec3(gray), fragColor.rgb, saturation);
  }

  fragColor.rgb *= raysColor;
}

void main() {
  vec4 color;
  mainImage(color, gl_FragCoord.xy);
  gl_FragColor  = color;
}`,L={iTime:{value:0},iResolution:{value:[1,1]},rayPos:{value:[0,0]},rayDir:{value:[0,1]},raysColor:{value:xK(t)},raysSpeed:{value:r},lightSpread:{value:i},rayLength:{value:n},pulsating:{value:s?1:0},fadeDistance:{value:a},saturation:{value:o},mousePos:{value:[.5,.5]},mouseInfluence:{value:c},noiseAmount:{value:u},distortion:{value:d}};v.current=L;const B=new uqe(D),q=new ple(D,{vertex:I,fragment:j,uniforms:L}),G=new ble(D,{geometry:B,program:q});S.current=G;const Y=()=>{if(!m.current||!N)return;N.dpr=Math.min(window.devicePixelRatio,2);const{clientWidth:re,clientHeight:F}=m.current;N.setSize(re,F);const $=N.dpr,se=re*$,H=F*$;L.iResolution.value=[se,H];const{anchor:ne,dir:ce}=bK(e,se,H);L.rayPos.value=ne,L.rayDir.value=ce},X=re=>{if(!(!y.current||!v.current||!S.current)){L.iTime.value=re*.001,l&&c>0&&(w.current.x=w.current.x*.92+x.current.x*(1-.92),w.current.y=w.current.y*.92+x.current.y*(1-.92),L.mousePos.value=[w.current.x,w.current.y]);try{N.render({scene:G}),_.current=requestAnimationFrame(X)}catch(F){console.warn("WebGL rendering error:",F);return}}};window.addEventListener("resize",Y),Y(),_.current=requestAnimationFrame(X),P.current=()=>{if(_.current&&(cancelAnimationFrame(_.current),_.current=null),window.removeEventListener("resize",Y),N)try{const re=N.gl.canvas,F=N.gl.getExtension("WEBGL_lose_context");F&&F.loseContext(),re&&re.parentNode&&re.parentNode.removeChild(re)}catch(re){console.warn("Error during WebGL cleanup:",re)}y.current=null,v.current=null,S.current=null}})(),()=>{P.current&&(P.current(),P.current=null)}),[M,e,t,r,i,n,s,a,o,l,c,u,d]),O.useEffect(()=>{if(!v.current||!m.current||!y.current)return;const E=v.current,N=y.current;E.raysColor.value=xK(t),E.raysSpeed.value=r,E.lightSpread.value=i,E.rayLength.value=n,E.pulsating.value=s?1:0,E.fadeDistance.value=a,E.saturation.value=o,E.mouseInfluence.value=c,E.noiseAmount.value=u,E.distortion.value=d;const{clientWidth:D,clientHeight:I}=m.current,j=N.dpr,{anchor:L,dir:B}=bK(e,D*j,I*j);E.rayPos.value=L,E.rayDir.value=B},[t,r,i,e,n,s,a,o,c,u,d]),O.useEffect(()=>{const E=N=>{if(!m.current||!y.current)return;const D=m.current.getBoundingClientRect(),I=(N.clientX-D.left)/D.width,j=(N.clientY-D.top)/D.height;x.current={x:I,y:j}};if(l)return window.addEventListener("mousemove",E),()=>window.removeEventListener("mousemove",E)},[l]),h.jsx("div",{ref:m,className:`w-full h-full pointer-events-none z-[3] overflow-hidden relative ${f}`.trim()})},fqe=["#ffffff","#ffffff","#ffffff"],pqe=e=>{e=e.replace(/^#/,""),e.length===3&&(e=e.split("").map(s=>s+s).join(""));const t=parseInt(e,16),r=(t>>16&255)/255,i=(t>>8&255)/255,n=(t&255)/255;return[r,i,n]},mqe=`
  attribute vec3 position;
  attribute vec4 random;
  attribute vec3 color;
  
  uniform mat4 modelMatrix;
  uniform mat4 viewMatrix;
  uniform mat4 projectionMatrix;
  uniform float uTime;
  uniform float uSpread;
  uniform float uBaseSize;
  uniform float uSizeRandomness;
  
  varying vec4 vRandom;
  varying vec3 vColor;
  
  void main() {
    vRandom = random;
    vColor = color;
    
    vec3 pos = position * uSpread;
    pos.z *= 10.0;
    
    vec4 mPos = modelMatrix * vec4(pos, 1.0);
    float t = uTime;
    mPos.x += sin(t * random.z + 6.28 * random.w) * mix(0.1, 1.5, random.x);
    mPos.y += sin(t * random.y + 6.28 * random.x) * mix(0.1, 1.5, random.w);
    mPos.z += sin(t * random.w + 6.28 * random.y) * mix(0.1, 1.5, random.z);
    
    vec4 mvPos = viewMatrix * mPos;
    gl_PointSize = (uBaseSize * (1.0 + uSizeRandomness * (random.x - 0.5))) / length(mvPos.xyz);
    gl_Position = projectionMatrix * mvPos;
  }
`,gqe=`
  precision highp float;
  
  uniform float uTime;
  uniform float uAlphaParticles;
  varying vec4 vRandom;
  varying vec3 vColor;
  
  void main() {
    vec2 uv = gl_PointCoord.xy;
    float d = length(uv - vec2(0.5));
    
    if(uAlphaParticles < 0.5) {
      if(d > 0.5) {
        discard;
      }
      gl_FragColor = vec4(vColor + 0.2 * sin(uv.yxx + uTime + vRandom.y * 6.28), 1.0);
    } else {
      float circle = smoothstep(0.5, 0.4, d) * 0.8;
      gl_FragColor = vec4(vColor + 0.2 * sin(uv.yxx + uTime + vRandom.y * 6.28), circle);
    }
  }
`,_a=({particleCount:e=200,particleSpread:t=10,speed:r=.1,particleColors:i,moveParticlesOnHover:n=!1,particleHoverFactor:s=1,alphaParticles:a=!1,particleBaseSize:o=100,sizeRandomness:l=1,cameraDistance:c=20,disableRotation:u=!1,className:d})=>{const f=O.useRef(null),m=O.useRef({x:0,y:0});return O.useEffect(()=>{const v=f.current;if(!v)return;const y=new mle({depth:!1,alpha:!0}),x=y.gl;v.appendChild(x.canvas),x.clearColor(0,0,0,0);const w=new QWe(x,{fov:15});w.position.set(0,0,c);const _=()=>{const G=v.clientWidth,Y=v.clientHeight;y.setSize(G,Y),w.perspective({aspect:x.canvas.width/x.canvas.height})};window.addEventListener("resize",_,!1),_();const S=G=>{const Y=v.getBoundingClientRect(),X=(G.clientX-Y.left)/Y.width*2-1,re=-((G.clientY-Y.top)/Y.height*2-1);m.current={x:X,y:re}};n&&v.addEventListener("mousemove",S);const P=e,M=new Float32Array(P*3),C=new Float32Array(P*4),T=new Float32Array(P*3),E=i&&i.length>0?i:fqe;for(let G=0;G<P;G++){let Y,X,re,F;do Y=Math.random()*2-1,X=Math.random()*2-1,re=Math.random()*2-1,F=Y*Y+X*X+re*re;while(F>1||F===0);const $=Math.cbrt(Math.random());M.set([Y*$,X*$,re*$],G*3),C.set([Math.random(),Math.random(),Math.random(),Math.random()],G*4);const se=pqe(E[Math.floor(Math.random()*E.length)]);T.set(se,G*3)}const N=new fle(x,{position:{size:3,data:M},random:{size:4,data:C},color:{size:3,data:T}}),D=new ple(x,{vertex:mqe,fragment:gqe,uniforms:{uTime:{value:0},uSpread:{value:t},uBaseSize:{value:o},uSizeRandomness:{value:l},uAlphaParticles:{value:a?1:0}},transparent:!0,depthTest:!1}),I=new ble(x,{mode:x.POINTS,geometry:N,program:D});let j,L=performance.now(),B=0;const q=G=>{j=requestAnimationFrame(q);const Y=G-L;L=G,B+=Y*r,D.uniforms.uTime.value=B*.001,n?(I.position.x=-m.current.x*s,I.position.y=-m.current.y*s):(I.position.x=0,I.position.y=0),u||(I.rotation.x=Math.sin(B*2e-4)*.1,I.rotation.y=Math.cos(B*5e-4)*.15,I.rotation.z+=.01*r),y.render({scene:I,camera:w})};return j=requestAnimationFrame(q),()=>{window.removeEventListener("resize",_),n&&v.removeEventListener("mousemove",S),cancelAnimationFrame(j),v.contains(x.canvas)&&v.removeChild(x.canvas)}},[e,t,r,n,s,a,o,l,c,u]),h.jsx("div",{ref:f,className:`relative w-full h-full ${d}`})};var xT={exports:{}},vqe=xT.exports,wK;function yqe(){return wK||(wK=1,function(e,t){(function(r,i){e.exports=i()})(vqe,function(){return function(r){function i(s){if(n[s])return n[s].exports;var a=n[s]={exports:{},id:s,loaded:!1};return r[s].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}var n={};return i.m=r,i.c=n,i.p="dist/",i(0)}([function(r,i,n){function s(B){return B&&B.__esModule?B:{default:B}}var a=Object.assign||function(B){for(var q=1;q<arguments.length;q++){var G=arguments[q];for(var Y in G)Object.prototype.hasOwnProperty.call(G,Y)&&(B[Y]=G[Y])}return B},o=n(1),l=(s(o),n(6)),c=s(l),u=n(7),d=s(u),f=n(8),m=s(f),v=n(9),y=s(v),x=n(10),w=s(x),_=n(11),S=s(_),P=n(14),M=s(P),C=[],T=!1,E={offset:120,delay:0,easing:"ease",duration:400,disable:!1,once:!1,startEvent:"DOMContentLoaded",throttleDelay:99,debounceDelay:50,disableMutationObserver:!1},N=function(){var B=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(B&&(T=!0),T)return C=(0,S.default)(C,E),(0,w.default)(C,E.once),C},D=function(){C=(0,M.default)(),N()},I=function(){C.forEach(function(B,q){B.node.removeAttribute("data-aos"),B.node.removeAttribute("data-aos-easing"),B.node.removeAttribute("data-aos-duration"),B.node.removeAttribute("data-aos-delay")})},j=function(B){return B===!0||B==="mobile"&&y.default.mobile()||B==="phone"&&y.default.phone()||B==="tablet"&&y.default.tablet()||typeof B=="function"&&B()===!0},L=function(B){E=a(E,B),C=(0,M.default)();var q=document.all&&!window.atob;return j(E.disable)||q?I():(E.disableMutationObserver||m.default.isSupported()||(console.info(`
      aos: MutationObserver is not supported on this browser,
      code mutations observing has been disabled.
      You may have to call "refreshHard()" by yourself.
    `),E.disableMutationObserver=!0),document.querySelector("body").setAttribute("data-aos-easing",E.easing),document.querySelector("body").setAttribute("data-aos-duration",E.duration),document.querySelector("body").setAttribute("data-aos-delay",E.delay),E.startEvent==="DOMContentLoaded"&&["complete","interactive"].indexOf(document.readyState)>-1?N(!0):E.startEvent==="load"?window.addEventListener(E.startEvent,function(){N(!0)}):document.addEventListener(E.startEvent,function(){N(!0)}),window.addEventListener("resize",(0,d.default)(N,E.debounceDelay,!0)),window.addEventListener("orientationchange",(0,d.default)(N,E.debounceDelay,!0)),window.addEventListener("scroll",(0,c.default)(function(){(0,w.default)(C,E.once)},E.throttleDelay)),E.disableMutationObserver||m.default.ready("[data-aos]",D),C)};r.exports={init:L,refresh:N,refreshHard:D}},function(r,i){},,,,,function(r,i){(function(n){function s(j,L,B){function q(Be){var $e=ne,mt=ce;return ne=ce=void 0,he=Be,ae=j.apply(mt,$e)}function G(Be){return he=Be,Z=setTimeout(re,L),Ae?q(Be):ae}function Y(Be){var $e=Be-fe,mt=Be-he,dt=L-$e;return xe?D(dt,ie-mt):dt}function X(Be){var $e=Be-fe,mt=Be-he;return fe===void 0||$e>=L||$e<0||xe&&mt>=ie}function re(){var Be=I();return X(Be)?F(Be):void(Z=setTimeout(re,Y(Be)))}function F(Be){return Z=void 0,Ee&&ne?q(Be):(ne=ce=void 0,ae)}function $(){Z!==void 0&&clearTimeout(Z),he=0,ne=fe=ce=Z=void 0}function se(){return Z===void 0?ae:F(I())}function H(){var Be=I(),$e=X(Be);if(ne=arguments,ce=this,fe=Be,$e){if(Z===void 0)return G(fe);if(xe)return Z=setTimeout(re,L),q(fe)}return Z===void 0&&(Z=setTimeout(re,L)),ae}var ne,ce,ie,ae,Z,fe,he=0,Ae=!1,xe=!1,Ee=!0;if(typeof j!="function")throw new TypeError(f);return L=u(L)||0,o(B)&&(Ae=!!B.leading,xe="maxWait"in B,ie=xe?N(u(B.maxWait)||0,L):ie,Ee="trailing"in B?!!B.trailing:Ee),H.cancel=$,H.flush=se,H}function a(j,L,B){var q=!0,G=!0;if(typeof j!="function")throw new TypeError(f);return o(B)&&(q="leading"in B?!!B.leading:q,G="trailing"in B?!!B.trailing:G),s(j,L,{leading:q,maxWait:L,trailing:G})}function o(j){var L=typeof j>"u"?"undefined":d(j);return!!j&&(L=="object"||L=="function")}function l(j){return!!j&&(typeof j>"u"?"undefined":d(j))=="object"}function c(j){return(typeof j>"u"?"undefined":d(j))=="symbol"||l(j)&&E.call(j)==v}function u(j){if(typeof j=="number")return j;if(c(j))return m;if(o(j)){var L=typeof j.valueOf=="function"?j.valueOf():j;j=o(L)?L+"":L}if(typeof j!="string")return j===0?j:+j;j=j.replace(y,"");var B=w.test(j);return B||_.test(j)?S(j.slice(2),B?2:8):x.test(j)?m:+j}var d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},f="Expected a function",m=NaN,v="[object Symbol]",y=/^\s+|\s+$/g,x=/^[-+]0x[0-9a-f]+$/i,w=/^0b[01]+$/i,_=/^0o[0-7]+$/i,S=parseInt,P=(typeof n>"u"?"undefined":d(n))=="object"&&n&&n.Object===Object&&n,M=(typeof self>"u"?"undefined":d(self))=="object"&&self&&self.Object===Object&&self,C=P||M||Function("return this")(),T=Object.prototype,E=T.toString,N=Math.max,D=Math.min,I=function(){return C.Date.now()};r.exports=a}).call(i,function(){return this}())},function(r,i){(function(n){function s(I,j,L){function B(Ee){var Be=H,$e=ne;return H=ne=void 0,fe=Ee,ie=I.apply($e,Be)}function q(Ee){return fe=Ee,ae=setTimeout(X,j),he?B(Ee):ie}function G(Ee){var Be=Ee-Z,$e=Ee-fe,mt=j-Be;return Ae?N(mt,ce-$e):mt}function Y(Ee){var Be=Ee-Z,$e=Ee-fe;return Z===void 0||Be>=j||Be<0||Ae&&$e>=ce}function X(){var Ee=D();return Y(Ee)?re(Ee):void(ae=setTimeout(X,G(Ee)))}function re(Ee){return ae=void 0,xe&&H?B(Ee):(H=ne=void 0,ie)}function F(){ae!==void 0&&clearTimeout(ae),fe=0,H=Z=ne=ae=void 0}function $(){return ae===void 0?ie:re(D())}function se(){var Ee=D(),Be=Y(Ee);if(H=arguments,ne=this,Z=Ee,Be){if(ae===void 0)return q(Z);if(Ae)return ae=setTimeout(X,j),B(Z)}return ae===void 0&&(ae=setTimeout(X,j)),ie}var H,ne,ce,ie,ae,Z,fe=0,he=!1,Ae=!1,xe=!0;if(typeof I!="function")throw new TypeError(d);return j=c(j)||0,a(L)&&(he=!!L.leading,Ae="maxWait"in L,ce=Ae?E(c(L.maxWait)||0,j):ce,xe="trailing"in L?!!L.trailing:xe),se.cancel=F,se.flush=$,se}function a(I){var j=typeof I>"u"?"undefined":u(I);return!!I&&(j=="object"||j=="function")}function o(I){return!!I&&(typeof I>"u"?"undefined":u(I))=="object"}function l(I){return(typeof I>"u"?"undefined":u(I))=="symbol"||o(I)&&T.call(I)==m}function c(I){if(typeof I=="number")return I;if(l(I))return f;if(a(I)){var j=typeof I.valueOf=="function"?I.valueOf():I;I=a(j)?j+"":j}if(typeof I!="string")return I===0?I:+I;I=I.replace(v,"");var L=x.test(I);return L||w.test(I)?_(I.slice(2),L?2:8):y.test(I)?f:+I}var u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},d="Expected a function",f=NaN,m="[object Symbol]",v=/^\s+|\s+$/g,y=/^[-+]0x[0-9a-f]+$/i,x=/^0b[01]+$/i,w=/^0o[0-7]+$/i,_=parseInt,S=(typeof n>"u"?"undefined":u(n))=="object"&&n&&n.Object===Object&&n,P=(typeof self>"u"?"undefined":u(self))=="object"&&self&&self.Object===Object&&self,M=S||P||Function("return this")(),C=Object.prototype,T=C.toString,E=Math.max,N=Math.min,D=function(){return M.Date.now()};r.exports=s}).call(i,function(){return this}())},function(r,i){function n(u){var d=void 0,f=void 0;for(d=0;d<u.length;d+=1)if(f=u[d],f.dataset&&f.dataset.aos||f.children&&n(f.children))return!0;return!1}function s(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function a(){return!!s()}function o(u,d){var f=window.document,m=s(),v=new m(l);c=d,v.observe(f.documentElement,{childList:!0,subtree:!0,removedNodes:!0})}function l(u){u&&u.forEach(function(d){var f=Array.prototype.slice.call(d.addedNodes),m=Array.prototype.slice.call(d.removedNodes),v=f.concat(m);if(n(v))return c()})}Object.defineProperty(i,"__esModule",{value:!0});var c=function(){};i.default={isSupported:a,ready:o}},function(r,i){function n(f,m){if(!(f instanceof m))throw new TypeError("Cannot call a class as a function")}function s(){return navigator.userAgent||navigator.vendor||window.opera||""}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function f(m,v){for(var y=0;y<v.length;y++){var x=v[y];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(m,x.key,x)}}return function(m,v,y){return v&&f(m.prototype,v),y&&f(m,y),m}}(),o=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,l=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,c=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,u=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,d=function(){function f(){n(this,f)}return a(f,[{key:"phone",value:function(){var m=s();return!(!o.test(m)&&!l.test(m.substr(0,4)))}},{key:"mobile",value:function(){var m=s();return!(!c.test(m)&&!u.test(m.substr(0,4)))}},{key:"tablet",value:function(){return this.mobile()&&!this.phone()}}]),f}();i.default=new d},function(r,i){Object.defineProperty(i,"__esModule",{value:!0});var n=function(a,o,l){var c=a.node.getAttribute("data-aos-once");o>a.position?a.node.classList.add("aos-animate"):typeof c<"u"&&(c==="false"||!l&&c!=="true")&&a.node.classList.remove("aos-animate")},s=function(a,o){var l=window.pageYOffset,c=window.innerHeight;a.forEach(function(u,d){n(u,c+l,o)})};i.default=s},function(r,i,n){function s(c){return c&&c.__esModule?c:{default:c}}Object.defineProperty(i,"__esModule",{value:!0});var a=n(12),o=s(a),l=function(c,u){return c.forEach(function(d,f){d.node.classList.add("aos-init"),d.position=(0,o.default)(d.node,u.offset)}),c};i.default=l},function(r,i,n){function s(c){return c&&c.__esModule?c:{default:c}}Object.defineProperty(i,"__esModule",{value:!0});var a=n(13),o=s(a),l=function(c,u){var d=0,f=0,m=window.innerHeight,v={offset:c.getAttribute("data-aos-offset"),anchor:c.getAttribute("data-aos-anchor"),anchorPlacement:c.getAttribute("data-aos-anchor-placement")};switch(v.offset&&!isNaN(v.offset)&&(f=parseInt(v.offset)),v.anchor&&document.querySelectorAll(v.anchor)&&(c=document.querySelectorAll(v.anchor)[0]),d=(0,o.default)(c).top,v.anchorPlacement){case"top-bottom":break;case"center-bottom":d+=c.offsetHeight/2;break;case"bottom-bottom":d+=c.offsetHeight;break;case"top-center":d+=m/2;break;case"bottom-center":d+=m/2+c.offsetHeight;break;case"center-center":d+=m/2+c.offsetHeight/2;break;case"top-top":d+=m;break;case"bottom-top":d+=c.offsetHeight+m;break;case"center-top":d+=c.offsetHeight/2+m}return v.anchorPlacement||v.offset||isNaN(u)||(f=u),d+f};i.default=l},function(r,i){Object.defineProperty(i,"__esModule",{value:!0});var n=function(s){for(var a=0,o=0;s&&!isNaN(s.offsetLeft)&&!isNaN(s.offsetTop);)a+=s.offsetLeft-(s.tagName!="BODY"?s.scrollLeft:0),o+=s.offsetTop-(s.tagName!="BODY"?s.scrollTop:0),s=s.offsetParent;return{top:o,left:a}};i.default=n},function(r,i){Object.defineProperty(i,"__esModule",{value:!0});var n=function(s){return s=s||document.querySelectorAll("[data-aos]"),Array.prototype.map.call(s,function(a){return{node:a}})};i.default=n}])})}(xT)),xT.exports}var xqe=yqe();const Hn=d0(xqe),bqe=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 8l4 4m0 0l-4 4m4-4H3"})}),wqe=()=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),_qe=()=>{const e=ho(n=>n.auth.user),t=()=>h.jsx("span",{className:"font-bold bg-gradient-to-r from-[#6b10e2e8] via-[#a310e2d7] to-[#e210ded7]  dark:bg-gradient-to-r dark:from-[#10e2d4d7] dark:via-[#10b4e2d7] dark:to-[#106be2d7] bg-clip-text text-transparent",children:"CodeG"}),[r,i]=O.useState(!1);return O.useEffect(()=>{const n=()=>{const a=document.documentElement.getAttribute("data-theme");i(a?.includes("dark")||a==="dark")};n();const s=new MutationObserver(n);return s.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>s.disconnect()},[]),O.useEffect(()=>{Hn.init({duration:1e3,once:!1})},[]),h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"fixed inset-0 z-9 pointer-events-none from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-4 transition-colors ",children:h.jsx(hqe,{raysOrigin:"top-center",raysColor:r?"#00ffff":"#FD3DB5",raysSpeed:1.5,lightSpread:r?.8:.5,rayLength:r?1.2:.4,followMouse:!0,mouseInfluence:.1,noiseAmount:r?.1:.04,distortion:r?.05:.02,className:"absolute inset-0 w-full h-full"})}),h.jsx("div",{className:"fixed inset-0 z-9 pointer-events-none from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-4 transition-colors ",children:h.jsx(_a,{particleColors:r?["#ffffff","#ffffff"]:["#FD3DB5","#666666"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:r?100:60,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1})}),h.jsxs("div",{className:"min-h-screen from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-4 transition-colors overflow-hidden",children:[h.jsx("section",{className:"relative z-10 flex items-center justify-center from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-2 sm:p-4 transition-colors",children:h.jsxs("main",{className:"relative from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-2 sm:p-4 transition-colors flex flex-col lg:flex-row items-center justify-center lg:justify-between m-auto w-full px-3 sm:px-4 md:px-6 lg:px-12 xl:px-20 2xl:px-32 min-h-[60vh] sm:min-h-[70vh] lg:min-h-screen gap-2 sm:gap-4 md:gap-6 lg:gap-10",children:[h.jsx("div",{className:"z-10 w-full sm:w-full lg:w-1/2 flex justify-center lg:justify-start p-1 sm:p-2 md:p-4 lg:p-6 xl:p-8",children:h.jsxs("div",{className:"text-center lg:text-left max-w-full sm:max-w-xl lg:max-w-lg xl:max-w-xl 2xl:max-w-2xl",children:[h.jsxs("h1",{className:"text-3xl xs:text-4xl sm:text-5xl md:text-6xl lg:text-5xl xl:text-6xl 2xl:text-7xl font-black leading-tight tracking-tight animate-fade-in-down","data-aos":"fade-up",children:["Hey,",h.jsx("span",{className:"block bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent",children:e?e.first_name:"CodeSmith"})]}),h.jsx("p",{className:"mt-4 sm:mt-6 md:mt-8 text-sm sm:text-base md:text-lg lg:text-lg xl:text-xl text-base-content/70 leading-relaxed animate-fade-in-up px-2 sm:px-0","data-aos":"fade-up","data-aos-delay":"200",children:e?h.jsxs(h.Fragment,{children:["Ready to crush your next tech interview? Dive into our collection of algorithm problems and level up your skills today with ",h.jsx(t,{}),"."]}):h.jsxs(h.Fragment,{children:["Sign up or log in to ",h.jsx(t,{})," to start solving problems and track your progress!"]})}),h.jsx("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center lg:justify-start mt-4 sm:mt-6 md:mt-8 pt-2 sm:pt-4 animate-fade-in-up","data-aos":"fade-up","data-aos-delay":"400",children:h.jsxs(hr,{to:"/problems",className:"btn btn-primary btn-md sm:btn-lg shadow-xl hover:shadow-2xl transform hover:scale-105 transition-all duration-300 group w-full sm:w-auto",children:[h.jsx(wqe,{}),"Start Coding",h.jsx(bqe,{})]})})]})}),h.jsx("div",{className:`hidden sm:flex lg:w-1/2 w-full relative \r
               left-4 sm:left-8 md:left-20 lg:left-40 \r
               top-2 sm:top-4 md:top-6 lg:top-10 \r
               items-center justify-center lg:justify-start xl:justify-center \r
               pointer-events-auto \r
               mb-8 md:mb-12 lg:mb-16 xl:mb-20 \r
               mr-4 sm:mr-6 lg:mr-8 xl:mr-12 \r
               scale-90 sm:scale-100 md:scale-110 lg:scale-120 xl:scale-130 2xl:scale-200`,"data-aos":"fade-left","data-aos-delay":"600",children:h.jsx(VGe,{})})]})}),h.jsx("section",{className:"relative z-10 py-12 sm:py-16 lg:py-24 xl:py-32",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-24 items-stretch",children:[h.jsx("div",{className:"flex","data-aos":"fade-up","data-aos-delay":"100",children:h.jsxs("div",{className:"relative max-w-full sm:max-w-lg md:max-w-xl lg:max-w-2xl mx-auto group flex-1",children:[h.jsx("div",{className:"absolute -inset-6 bg-gradient-to-r from-primary/30 via-accent/20 to-secondary/30 rounded-3xl blur-3xl opacity-60 group-hover:opacity-90 transition-all duration-700 animate-pulse","data-aos":"fade-up","data-aos-delay":"150"}),h.jsx("div",{className:"absolute -inset-3 bg-gradient-to-r from-primary/25 to-secondary/25 rounded-2xl blur-xl opacity-40 group-hover:opacity-60 transition-all duration-500","data-aos":"fade-up","data-aos-delay":"175"}),h.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-primary/10 to-secondary/10 rounded-2xl blur-sm opacity-30","data-aos":"fade-up","data-aos-delay":"200"}),h.jsxs("div",{className:"relative bg-gradient-to-br from-base-100/95 via-base-100/90 to-base-200/80 backdrop-blur-xl shadow-2xl rounded-2xl p-6 border border-base-300/50 space-y-5 hover:shadow-3xl hover:scale-[1.02] transition-all duration-500 overflow-hidden h-full flex flex-col",children:[h.jsxs("div",{className:"absolute inset-0 opacity-5","data-aos":"fade-up","data-aos-delay":"225",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-primary/20 via-transparent to-secondary/20 rounded-2xl"}),h.jsx("div",{className:"absolute top-4 right-4 w-20 h-20 bg-primary/10 rounded-full blur-2xl animate-pulse"}),h.jsx("div",{className:"absolute bottom-6 left-6 w-16 h-16 bg-secondary/10 rounded-full blur-xl animate-pulse delay-1000"})]}),h.jsxs("div",{className:"relative flex justify-between items-start","data-aos":"fade-up","data-aos-delay":"250",children:[h.jsx("div",{className:"space-y-1",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-primary/20 to-accent/20 rounded-lg flex items-center justify-center border border-primary/30",children:h.jsx("svg",{className:"w-4 h-4 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-lg text-base-content group-hover:text-primary transition-colors duration-300",children:"CodeG Coding Clash"}),h.jsx("p",{className:"text-xs text-base-content/60 font-medium",children:"International Championship"})]})]})}),h.jsx("div",{className:"relative",children:h.jsxs("div",{className:"flex items-center space-x-2 bg-gradient-to-r from-emerald-500/20 to-green-500/20 text-emerald-400 text-xs font-bold px-3 py-2 rounded-full border border-emerald-400/30 shadow-lg backdrop-blur-sm",children:[h.jsxs("div",{className:"relative flex items-center",children:[h.jsx("span",{className:"animate-ping absolute w-2 h-2 bg-emerald-400 rounded-full opacity-75"}),h.jsx("span",{className:"relative w-2 h-2 bg-emerald-400 rounded-full shadow-lg"})]}),h.jsx("span",{className:"tracking-wide",children:"LIVE"})]})})]}),h.jsxs("div",{className:"relative grid grid-cols-2 gap-4","data-aos":"fade-up","data-aos-delay":"300",children:[h.jsxs("div",{className:"group/stat bg-gradient-to-br from-base-200/80 via-base-200/60 to-base-300/40 p-4 rounded-xl border border-base-300/30 hover:shadow-lg hover:scale-105 transition-all duration-300 cursor-pointer overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent opacity-0 group-hover/stat:opacity-100 transition-opacity duration-300"}),h.jsxs("div",{className:"relative flex items-center justify-between mb-2",children:[h.jsx("p",{className:"text-xs font-semibold text-base-content/70 uppercase tracking-wide",children:"Problems"}),h.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-primary/20 to-primary/10 rounded-lg flex items-center justify-center group-hover/stat:scale-110 transition-transform duration-300",children:h.jsx("svg",{className:"w-3 h-3 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]}),h.jsx("p",{className:"text-2xl font-black text-primary group-hover/stat:text-primary/80 transition-colors duration-300",children:"5"})]}),h.jsxs("div",{className:"group/stat bg-gradient-to-br from-base-200/80 via-base-200/60 to-base-300/40 p-4 rounded-xl border border-base-300/30 hover:shadow-lg hover:scale-105 transition-all duration-300 cursor-pointer overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-secondary/5 to-transparent opacity-0 group-hover/stat:opacity-100 transition-opacity duration-300"}),h.jsxs("div",{className:"relative flex items-center justify-between mb-2",children:[h.jsx("p",{className:"text-xs font-semibold text-base-content/70 uppercase tracking-wide",children:"Participants"}),h.jsx("div",{className:"w-6 h-6 bg-gradient-to-br from-secondary/20 to-secondary/10 rounded-lg flex items-center justify-center group-hover/stat:scale-110 transition-transform duration-300",children:h.jsx("svg",{className:"w-3 h-3 text-secondary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),h.jsxs("div",{className:"flex items-baseline space-x-1",children:[h.jsx("p",{className:"text-2xl font-black text-secondary group-hover/stat:text-secondary/80 transition-colors duration-300",children:"128"}),h.jsx("span",{className:"text-xs text-emerald-500 font-bold",children:"+12"})]})]})]}),h.jsxs("div",{className:"relative bg-gradient-to-r from-warning/15 via-orange/10 to-error/15 p-4 rounded-xl border border-warning/30 backdrop-blur-sm overflow-hidden","data-aos":"fade-up","data-aos-delay":"400",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-warning/5 to-error/5 opacity-50"}),h.jsxs("div",{className:"relative flex justify-between items-center mb-3",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-warning/30 to-orange/20 rounded-lg flex items-center justify-center border border-warning/40",children:h.jsx("svg",{className:"w-4 h-4 text-warning animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),h.jsx("span",{className:"text-xs font-bold text-base-content/90 uppercase tracking-wide",children:"Time Remaining"})]}),h.jsx("span",{className:"text-lg font-mono font-black text-warning drop-shadow-sm animate-pulse",children:"01:24:15"})]}),h.jsx("div",{className:"relative",children:h.jsx("div",{className:"w-full bg-base-300/50 rounded-full h-3 overflow-hidden backdrop-blur-sm",children:h.jsxs("div",{className:"relative h-full",children:[h.jsx("div",{className:"h-full bg-gradient-to-r from-warning via-orange-400 to-error rounded-full transition-all duration-1000 ease-out shadow-lg",style:{width:"40%"}}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent rounded-full animate-pulse"})]})})})]}),h.jsxs("div",{className:"relative flex items-center justify-between bg-gradient-to-r from-accent/10 to-primary/10 p-4 rounded-xl border border-accent/20 mt-auto","data-aos":"fade-up","data-aos-delay":"500",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-accent/30 to-primary/20 rounded-lg flex items-center justify-center border border-accent/40",children:h.jsx("svg",{className:"w-4 h-4 text-accent",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-semibold text-base-content/70",children:"Prize Pool"}),h.jsx("p",{className:"text-lg font-black text-accent",children:"$2,500"})]})]}),h.jsx("button",{className:"bg-gradient-to-r from-primary to-accent px-6 py-2 rounded-lg text-white font-bold text-sm hover:shadow-lg hover:scale-105 transition-all duration-300 group/btn",children:h.jsxs("span",{className:"flex items-center space-x-1",children:[h.jsx("span",{children:"Join Now"}),h.jsx("svg",{className:"w-4 h-4 group-hover/btn:translate-x-0.5 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})]})]})]})}),h.jsx("div",{className:"text-center lg:text-left flex flex-col justify-center","data-aos":"fade-up","data-aos-delay":"200",children:h.jsxs("div",{children:[h.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-primary/10 border border-primary/20 rounded-full text-primary font-medium text-sm mb-6","data-aos":"fade-up","data-aos-delay":"300",children:[h.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-pulse"}),"Live Competition"]}),h.jsxs("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold leading-tight","data-aos":"fade-up","data-aos-delay":"400",children:["Compete in"," ",h.jsxs("span",{className:"relative",children:[h.jsx("span",{className:"bg-gradient-to-r from-primary via-accent to-secondary bg-clip-text text-transparent",children:"Live Contests"}),h.jsx("div",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-gradient-to-r from-primary/30 via-accent/30 to-secondary/30 rounded-full"})]})]}),h.jsxs("p",{className:"mt-6 text-lg text-base-content/70 leading-relaxed","data-aos":"fade-up","data-aos-delay":"500",children:["Challenge yourself in a real-time, competitive environment. Solve problems against the clock and climb the leaderboard to"," ",h.jsx("span",{className:"text-base-content/90 font-medium",children:"prove your skills."})]}),h.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row gap-4 justify-center lg:justify-start","data-aos":"fade-up","data-aos-delay":"600",children:[h.jsxs(hr,{to:"/contest",className:"group btn btn-primary btn-lg shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 group-hover:rotate-12 transition-transform duration-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Browse All Contests"]}),h.jsxs("button",{className:"btn btn-outline btn-lg hover:btn-ghost transition-colors duration-300",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"View Leaderboard"]})]})]})})]})}),h.jsx("section",{className:"relative z-10 py-12 sm:py-16 lg:py-24 xl:py-32 overflow-hidden",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 grid grid-cols-1 lg:grid-cols-2 gap-16 lg:gap-24 items-center",children:[h.jsxs("div",{className:"text-center lg:text-left","data-aos":"fade-up","data-aos-delay":"100",children:[h.jsxs("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold leading-tight","data-aos":"fade-up","data-aos-delay":"200",children:["Code Together in ",h.jsx("span",{className:"bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Real-Time"})]}),h.jsx("p",{className:"mt-4 text-lg text-base-content/70","data-aos":"fade-up","data-aos-delay":"300",children:"Team up with a partner, tackle complex problems, and learn from each other in a live, shared editor. Features real-time code-sync, cursor sharing, and integrated voice chat."}),h.jsx("div",{className:"mt-8","data-aos":"fade-up","data-aos-delay":"400",children:h.jsxs(hr,{to:"/pair-mode",className:"btn btn-primary btn-lg shadow-lg",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:h.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})}),"Start a Collab Session"]})})]}),h.jsx("div",{"data-aos":"fade-up","data-aos-delay":"200",children:h.jsxs("div",{className:"relative max-w-full sm:max-w-lg md:max-w-xl lg:max-w-2xl",children:[h.jsx("div",{className:"absolute -inset-4 bg-gradient-to-r from-accent/20 to-primary/20 rounded-2xl blur-2xl opacity-80","data-aos":"fade-up","data-aos-delay":"250"}),h.jsx("div",{className:"absolute -top-5 -left-5 z-20","data-aos":"fade-up","data-aos-delay":"300",children:h.jsxs("div",{className:"avatar indicator",children:[h.jsx("span",{className:"indicator-item badge badge-success badge-xs"}),h.jsx("div",{className:"w-12 h-12 rounded-full ring-2 ring-primary ring-offset-base-100 ring-offset-2",children:e?h.jsx("img",{src:e.profile_pic_url,alt:"user"}):h.jsx("img",{src:"https://api.dicebear.com/7.x/initials/svg?seed=JD",alt:"user"})})]})}),h.jsx("div",{className:"absolute -top-5 -right-5 z-20","data-aos":"fade-up","data-aos-delay":"350",children:h.jsxs("div",{className:"avatar indicator",children:[h.jsx("span",{className:"indicator-item badge badge-success badge-xs"}),h.jsx("div",{className:"w-12 h-12 rounded-full ring-2 ring-accent ring-offset-base-100 ring-offset-2",children:h.jsx("img",{src:"https://drop.ndtv.com/albums/SPORTS/top-5-indian-sp_638705754632632253/638705754655810253.jpeg",alt:"Collaborator 2"})})]})}),h.jsxs("div",{className:"relative mockup-code bg-base-100/95 backdrop-blur-sm shadow-2xl text-xs sm:text-sm border border-base-300","data-aos":"fade-up","data-aos-delay":"400",children:[h.jsx("pre",{"data-prefix":"1",children:h.jsxs("code",{children:[h.jsx("span",{className:"text-purple-600",children:"function"})," ",h.jsx("span",{className:"text-blue-600",children:"mergeIntervals"}),"(intervals) ","{"]})}),h.jsxs("pre",{"data-prefix":"2",className:"bg-primary/10",children:[h.jsxs("code",{children:["  ",h.jsx("span",{className:"text-gray-500",children:"// User1 is typing..."})," "]}),h.jsx("span",{className:"bg-primary animate-pulse w-0.5 h-4 inline-block ml-1"})]}),h.jsx("pre",{"data-prefix":"3",children:h.jsx("code",{children:"  intervals.sort((a, b) = a.start - b.start);"})}),h.jsx("pre",{"data-prefix":"4",children:h.jsx("code",{children:"  "})}),h.jsx("pre",{"data-prefix":"5",children:h.jsxs("code",{children:["  ",h.jsx("span",{className:"text-purple-600",children:"const"})," merged = [intervals[0]];"]})}),h.jsxs("pre",{"data-prefix":"6",className:"bg-accent/10",children:[h.jsxs("code",{children:["  ",h.jsx("span",{className:"text-purple-600",children:"for"})," (let i = 1; i ","<"," intervals.length; i++) ","{"]}),h.jsx("span",{className:"bg-accent animate-pulse w-0.5 h-4 inline-block ml-1"})]}),h.jsx("pre",{"data-prefix":"7",children:h.jsxs("code",{children:["    ",h.jsx("span",{className:"text-purple-600",children:"..."})]})}),h.jsx("pre",{"data-prefix":"8",children:h.jsxs("code",{children:["  ","}"]})}),h.jsx("pre",{"data-prefix":"9",className:"text-success",children:h.jsxs("code",{children:["  ",h.jsx("span",{className:"text-purple-600",children:"return"})," merged;"]})}),h.jsx("pre",{"data-prefix":"10",children:h.jsx("code",{children:"}"})})]}),h.jsxs("div",{className:"absolute -bottom-4 left-4 flex items-center gap-2","data-aos":"fade-up","data-aos-delay":"450",children:[h.jsxs("span",{className:"flex h-3 w-3 relative",children:[h.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-error opacity-75"}),h.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-error"})]}),h.jsx("span",{className:"text-error font-semibold text-sm",children:"LIVE"})]}),h.jsxs("div",{className:"absolute -bottom-4 right-4 flex items-center gap-2 bg-base-300/50 backdrop-blur-sm px-3 py-1 rounded-full text-xs","data-aos":"fade-up","data-aos-delay":"500",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-success",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),h.jsx("span",{className:"font-semibold text-success",children:"Voice ON"})]})]})})]})}),h.jsx("section",{className:"relative z-10 py-12 sm:py-16 lg:py-24 xl:py-32",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-24 items-center",children:[h.jsx("div",{"data-aos":"fade-up","data-aos-delay":"100",children:h.jsxs("div",{className:"relative max-w-full sm:max-w-lg md:max-w-xl lg:max-w-2xl",children:[h.jsx("div",{className:"absolute -inset-4 bg-gradient-to-r from-primary/20 to-secondary/20 rounded-2xl blur-2xl opacity-75","data-aos":"fade-up","data-aos-delay":"150"}),h.jsxs("div",{className:"relative mockup-code bg-base-100/95 backdrop-blur-sm shadow-2xl text-xs sm:text-sm border border-base-300","data-aos":"fade-up","data-aos-delay":"200",children:[h.jsx("pre",{"data-prefix":"1",children:h.jsxs("code",{children:[h.jsx("span",{className:"text-purple-600",children:"function"})," ",h.jsx("span",{className:"text-blue-600",children:"twoSum"}),"(nums, target) ","{"]})}),h.jsx("pre",{"data-prefix":"2",children:h.jsxs("code",{children:["  ",h.jsx("span",{className:"text-purple-600",children:"const"})," map = ",h.jsx("span",{className:"text-purple-600",children:"new"})," ",h.jsx("span",{className:"text-green-500",children:"Map"}),"();"]})}),h.jsx("pre",{"data-prefix":"4",children:h.jsxs("code",{children:["  ",h.jsx("span",{className:"text-purple-600",children:"for"})," (...) ","{"]})}),h.jsx("pre",{"data-prefix":"6",children:h.jsxs("code",{children:["    ",h.jsx("span",{className:"text-purple-600",children:"if"})," (map.has(complement)) ","{"]})}),h.jsx("pre",{"data-prefix":"7",className:"text-success",children:h.jsx("code",{children:"      return [map.get(complement), i];"})}),h.jsx("pre",{"data-prefix":"8",children:h.jsxs("code",{children:["    ","}"]})}),h.jsx("pre",{"data-prefix":"9",children:h.jsx("code",{children:"    map.set(nums[i], i);"})}),h.jsx("pre",{"data-prefix":"10",children:h.jsxs("code",{children:["  ","}"]})}),h.jsx("pre",{"data-prefix":"11",children:h.jsx("code",{children:"}"})})]}),h.jsx("div",{className:"absolute -top-3 -right-3 bg-success text-success-content px-3 py-1 rounded-full text-xs font-semibold shadow-lg","data-aos":"fade-up","data-aos-delay":"250",children:"✓ Solved"})]})}),h.jsxs("div",{className:"text-center lg:text-left","data-aos":"fade-up","data-aos-delay":"200",children:[h.jsxs("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold leading-tight","data-aos":"fade-up","data-aos-delay":"300",children:["Solve the ",h.jsx("span",{className:"bg-gradient-to-r from-secondary to-accent bg-clip-text text-transparent",children:"Daily Challenge"})]}),h.jsx("p",{className:"mt-4 text-lg text-base-content/70","data-aos":"fade-up","data-aos-delay":"400",children:"A new problem is featured every day. Test your skills, compare solutions with the community, and earn points for your consistency."}),h.jsx("div",{className:"mt-8","data-aos":"fade-up","data-aos-delay":"500",children:h.jsx(hr,{to:"/problem/potd",className:"btn btn-outline btn-secondary btn-lg",children:"View Today's Challenge"})})]})]})}),h.jsx("section",{className:"relative z-10 py-16 sm:py-20 lg:py-28 xl:py-32",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20 items-center",children:[h.jsxs("div",{className:"text-center lg:text-left","data-aos":"fade-up","data-aos-delay":"100",children:[h.jsxs("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold leading-tight","data-aos":"fade-up","data-aos-delay":"200",children:["Ask. Answer. ",h.jsx("span",{className:"bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"Grow Together"})]}),h.jsx("p",{className:"mt-4 text-lg text-base-content/70","data-aos":"fade-up","data-aos-delay":"300",children:"Got a doubt? Share it with the community. Someone’s always there to help. Learn faster through real conversations."}),h.jsx("div",{className:"mt-8","data-aos":"fade-up","data-aos-delay":"400",children:h.jsx(hr,{to:"/discussion",className:"btn btn-outline btn-accent btn-lg",children:"Join Discussion"})})]}),h.jsxs("div",{className:"relative group","data-aos":"fade-up","data-aos-delay":"200",children:[h.jsx("div",{className:"absolute -inset-1.5 bg-gradient-to-r from-primary to-secondary rounded-xl blur opacity-30 group-hover:opacity-75 transition duration-500","data-aos":"fade-up","data-aos-delay":"250"}),h.jsxs("div",{className:"relative bg-base-100 shadow-xl border border-base-300 rounded-xl p-6 space-y-4","data-aos":"fade-up","data-aos-delay":"300",children:[h.jsxs("div",{className:"flex items-center gap-3","data-aos":"fade-up","data-aos-delay":"350",children:[h.jsx("div",{className:"avatar",children:h.jsx("div",{className:"w-10 rounded-full ring-2 ring-primary/50 group-hover:ring-primary transition-all duration-300",children:e?h.jsx("img",{src:e.profile_pic_url,alt:"user"}):h.jsx("img",{src:"https://api.dicebear.com/7.x/initials/svg?seed=JD",alt:"user"})})}),h.jsxs("div",{children:[h.jsx("p",{className:"font-semibold text-base-content",children:"John Doe"}),h.jsx("p",{className:"text-xs text-base-content/60",children:"2 hours ago"})]})]}),h.jsx("h3",{className:"text-2xl font-bold bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent py-1","data-aos":"fade-up","data-aos-delay":"400",children:"Stuck on Two Sum Optimization?"}),h.jsx("p",{className:"text-base-content/80","data-aos":"fade-up","data-aos-delay":"450",children:"My solution for Two Sum is timing out. Looking for tips or a cleaner approach than nested loops. What's the secret?"}),h.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-base-300/50","data-aos":"fade-up","data-aos-delay":"500",children:[h.jsxs("div",{className:"flex items-center gap-3 text-base-content/70",children:[h.jsx("span",{className:"font-bold text-sm",children:"Solved ✓"}),h.jsx("div",{className:"divider divider-horizontal m-0"}),h.jsx("span",{className:"text-sm",children:"5 replies"})]}),h.jsx(hr,{to:"/discussion",children:h.jsx("button",{className:"btn btn-sm btn-secondary btn-outline group-hover:btn-secondary group-hover:text-white transition-all",children:"Join Discussion"})})]})]})]})]})}),h.jsx("section",{className:"relative z-10 py-16 sm:py-20 lg:py-28 xl:py-32",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-20 items-center",children:[h.jsxs("div",{className:"relative","data-aos":"fade-up","data-aos-delay":"100",children:[h.jsxs("div",{className:"bg-base-200/50 border border-base-300 rounded-2xl p-6 space-y-4","data-aos":"fade-up","data-aos-delay":"150",children:[h.jsx("h4",{className:"font-semibold text-center text-base-content/60","data-aos":"fade-up","data-aos-delay":"200",children:"TSC Analysis Report"}),h.jsxs("div",{className:"mockup-code text-xs","data-aos":"fade-up","data-aos-delay":"250",children:[h.jsx("pre",{"data-prefix":"1",children:h.jsxs("code",{children:[h.jsx("span",{className:"text-purple-600",children:"function"})," ",h.jsx("span",{className:"text-blue-600",children:"findMax"}),"(numbers) ","{"]})}),h.jsx("pre",{"data-prefix":"2",children:h.jsxs("code",{children:[h.jsx("span",{className:"text-purple-600",children:"let"})," max = numbers[0];"]})}),h.jsx("pre",{"data-prefix":"3",children:h.jsxs("code",{children:[h.jsx("span",{className:"text-purple-600",children:"for"})," (",h.jsx("span",{className:"text-purple-600",children:"let"})," i=1; i ","<"," numbers.length; i++) ","{"]})}),h.jsx("pre",{"data-prefix":"4",className:"bg-warning/20",children:h.jsxs("code",{children:[h.jsx("span",{className:"text-purple-600",children:"if"})," (numbers[i] ",">"," max) max = numbers[i];"]})}),h.jsx("pre",{"data-prefix":"5",children:h.jsx("code",{children:"}"})}),h.jsx("pre",{"data-prefix":"6",children:h.jsxs("code",{children:[h.jsx("span",{className:"text-purple-600",children:"return"})," max;"]})}),h.jsx("pre",{"data-prefix":"7",children:h.jsx("code",{children:"}"})})]}),h.jsxs("div",{className:"flex justify-around pt-4 border-t border-base-300/50","data-aos":"fade-up","data-aos-delay":"300",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"font-bold text-sm text-base-content/70",children:"Time Complexity"}),h.jsx("div",{className:"badge badge-lg badge-warning mt-1",children:"O(n) - Linear"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"font-bold text-sm text-base-content/70",children:"Space Complexity"}),h.jsx("div",{className:"badge badge-lg badge-success mt-1",children:"O(1) - Constant"})]})]})]}),h.jsx("div",{className:"absolute top-4 right-4 z-20","data-aos":"fade-up","data-aos-delay":"350",children:h.jsx("div",{className:"badge badge-primary badge-outline text-sm font-semibold px-4 py-2",children:"Pro Feature"})})]}),h.jsxs("div",{className:" text-center lg:text-left","data-aos":"fade-up","data-aos-delay":"200",children:[h.jsxs("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold leading-tight","data-aos":"fade-up","data-aos-delay":"300",children:["From Code to Complexity,"," ",h.jsx("span",{className:"bg-gradient-to-r from-warning to-error bg-clip-text text-transparent",children:"Instantly"})]}),h.jsx("p",{className:"mt-4 text-lg text-base-content/70","data-aos":"fade-up","data-aos-delay":"400",children:"Stop guessing. Our TSC Assistant analyzes your code line-by-line to give you precise time and space complexity, helping you master optimization for technical interviews."}),h.jsx("div",{className:"mt-8","data-aos":"fade-up","data-aos-delay":"500",children:h.jsxs(hr,{to:"/tscassistant",className:"btn btn-primary btn-lg shadow-lg",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"TSC Assistant"]})})]})]})}),h.jsx("section",{className:"relative z-10 py-16 sm:py-20 lg:py-28 xl:py-32",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-12",children:[h.jsxs("div",{className:"text-center mb-12 lg:mb-20","data-aos":"fade-up",children:[h.jsx("h2",{className:"text-3xl sm:text-4xl lg:text-5xl font-bold",children:"Everything You Need to Ace the Interview"}),h.jsx("p",{className:"mt-4 text-lg text-base-content/70 max-w-3xl mx-auto",children:"Our platform is meticulously designed to provide the tools, community, and knowledge required to land your dream tech job."})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[h.jsxs("div",{className:`card bg-base-200/50 shadow-lg border border-transparent hover:border-primary/50 \r
                           transform hover:-translate-y-2 transition-all ease-in duration-500 p-8 text-center`,"data-aos":"fade-up","data-aos-delay":"100",children:[h.jsx("div",{className:"mx-auto w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mb-6",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16m-7 6h7"})})}),h.jsx("h3",{className:"text-xl font-bold mb-2",children:"Curated Problem Library"}),h.jsx("p",{className:"text-base-content/70",children:"Access 2000+ problems, filtered by company, topic, and difficulty. From FAANG to startups, we've got you covered."})]}),h.jsxs("div",{className:`card bg-base-200/50 shadow-lg border border-transparent hover:border-secondary/50 \r
                           transform hover:-translate-y-2 transition-all duration-300 p-8 text-center`,"data-aos":"fade-up","data-aos-delay":"200",children:[h.jsx("div",{className:"mx-auto w-16 h-16 bg-secondary/10 rounded-full flex items-center justify-center mb-6",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),h.jsx("h3",{className:"text-xl font-bold mb-2",children:"AI-Powered Analysis"}),h.jsx("p",{className:"text-base-content/70",children:"Get instant time & space complexity reports with our TSC Assistant to understand trade-offs and write optimal code."})]}),h.jsxs("div",{className:`card bg-base-200/50 shadow-lg border border-transparent hover:border-accent/50 \r
                           transform hover:-translate-y-2 transition-all duration-300 p-8 text-center`,"data-aos":"fade-up","data-aos-delay":"300",children:[h.jsx("div",{className:"mx-auto w-16 h-16 bg-accent/10 rounded-full flex items-center justify-center mb-6",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-accent",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),h.jsx("h3",{className:"text-xl font-bold mb-2",children:"A Thriving Community"}),h.jsx("p",{className:"text-base-content/70",children:"Join thousands of motivated developers. Ask questions, share solutions, and get unstuck faster in our active discussion forums."})]})]})]})}),h.jsx("footer",{className:"relative z-10 border-t border-base-300/50",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 py-12",children:[h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[h.jsxs("div",{className:"lg:col-span-1","data-aos":"fade-up",children:[h.jsx("h3",{className:"text-2xl font-bold",children:"Ready to Start Your Journey?"}),h.jsx("p",{className:"mt-2 text-base-content/70",children:"Create an account to track your progress, save problems, and join the best community of developers."}),h.jsx("div",{className:"mt-6",children:h.jsx(hr,{to:"/register",className:"btn btn-primary btn-wide",children:"Get Started for Free"})})]}),h.jsxs("div",{className:"lg:col-span-2 grid grid-cols-2 md:grid-cols-4 gap-8","data-aos":"fade-up","data-aos-delay":"100",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-base-content mb-3",children:"Product"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsx("li",{children:h.jsx(hr,{to:"/problems",className:"link link-hover text-base-content/70",children:"Problems"})}),h.jsx("li",{children:h.jsx(hr,{to:"/problem/potd",className:"link link-hover text-base-content/70",children:"Daily Challenge"})}),h.jsx("li",{children:h.jsx(hr,{to:"/pricing",className:"link link-hover text-base-content/70",children:"Pricing"})}),h.jsx("li",{children:h.jsx(hr,{to:"/discussion",className:"link link-hover text-base-content/70",children:"Discussions"})})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-base-content mb-3",children:"Company"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"About Us"})}),h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Careers"})}),h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Contact"})})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-base-content mb-3",children:"Resources"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Blog"})}),h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Help Center"})}),h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Sitemap"})})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-base-content mb-3",children:"Legal"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Privacy Policy"})}),h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Terms of Service"})})]})]})]})]}),h.jsxs("div",{className:"mt-12 pt-8 border-t border-base-300/50 flex flex-col sm:flex-row justify-between items-center",children:[h.jsxs("p",{className:"text-sm text-base-content/60 text-center sm:text-left",children:["© ",new Date().getFullYear()," CodeG. All Rights Reserved."]}),h.jsxs("div",{className:"flex items-center gap-4 mt-4 sm:mt-0",children:[h.jsx("a",{href:"#",className:"text-base-content/70 hover:text-primary transition-colors",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.91 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})}),h.jsx("a",{href:"#",className:"text-base-content/70 hover:text-primary transition-colors",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.85s-.011 3.585-.069 4.85c-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07s-3.585-.012-4.85-.07c-3.252-.148-4.771-1.691-4.919-4.919-.058-1.265-.07-1.645-.07-4.85s.012-3.585.07-4.85c.148-3.225 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.85-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.667.072 4.947c.2 4.358 2.618 6.78 6.98 6.98 1.281.059 1.689.073 4.948.073s3.667-.014 4.947-.072c4.358-.2 6.78-2.618 6.98-6.98.059-1.281.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.2-4.358-2.618-6.78-6.98-6.98-1.281-.059-1.689-.073-4.948-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.162 6.162 6.162 6.162-2.759 6.162-6.162-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.79 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.441 1.441 1.441 1.441-.645 1.441-1.441-.645-1.44-1.441-1.44z"})})}),h.jsx("a",{href:"#",className:"text-base-content/70 hover:text-primary transition-colors",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{d:"M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616v.064c0 2.295 1.616 4.22 3.765 4.664-.715.192-1.472.22-2.21.084.613 1.942 2.38 3.352 4.484 3.388-1.703 1.332-3.834 2.052-6.143 2.052-.4 0-.79-.023-1.17-.067 2.206 1.408 4.832 2.224 7.656 2.224 9.172 0 14.288-7.753 13.945-14.656.974-.698 1.82-1.572 2.486-2.584z"})})})]})]})]})})]})]})};var X_=e=>e.type==="checkbox",yg=e=>e instanceof Date,eo=e=>e==null;const wle=e=>typeof e=="object";var Gn=e=>!eo(e)&&!Array.isArray(e)&&wle(e)&&!yg(e),_le=e=>Gn(e)&&e.target?X_(e.target)?e.target.checked:e.target.value:e,Sqe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,Sle=(e,t)=>e.has(Sqe(t)),Eqe=e=>{const t=e.constructor&&e.constructor.prototype;return Gn(t)&&t.hasOwnProperty("isPrototypeOf")},xF=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function tn(e){let t;const r=Array.isArray(e),i=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(xF&&(e instanceof Blob||i))&&(r||Gn(e)))if(t=r?[]:{},!r&&!Eqe(e))t=e;else for(const n in e)e.hasOwnProperty(n)&&(t[n]=tn(e[n]));else return e;return t}var eD=e=>/^\w*$/.test(e),nn=e=>e===void 0,tD=e=>Array.isArray(e)?e.filter(Boolean):[],bF=e=>tD(e.replace(/["|']|\]/g,"").split(/\.|\[/)),St=(e,t,r)=>{if(!t||!Gn(e))return r;const i=(eD(t)?[t]:bF(t)).reduce((n,s)=>eo(n)?n:n[s],e);return nn(i)||i===e?nn(e[t])?r:e[t]:i},el=e=>typeof e=="boolean",xi=(e,t,r)=>{let i=-1;const n=eD(t)?[t]:bF(t),s=n.length,a=s-1;for(;++i<s;){const o=n[i];let l=r;if(i!==a){const c=e[o];l=Gn(c)||Array.isArray(c)?c:isNaN(+n[i+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;e[o]=l,e=e[o]}};const aP={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},zl={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Xd={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Ele=Ot.createContext(null);Ele.displayName="HookFormContext";const rD=()=>Ot.useContext(Ele);var Ale=(e,t,r,i=!0)=>{const n={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(n,s,{get:()=>{const a=s;return t._proxyFormState[a]!==zl.all&&(t._proxyFormState[a]=!i||zl.all),r&&(r[a]=!0),e[a]}});return n};const iD=typeof window<"u"?O.useLayoutEffect:O.useEffect;function Aqe(e){const t=rD(),{control:r=t.control,disabled:i,name:n,exact:s}=e||{},[a,o]=Ot.useState(r._formState),l=Ot.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return iD(()=>r._subscribe({name:n,formState:l.current,exact:s,callback:c=>{!i&&o({...r._formState,...c})}}),[n,i,s]),Ot.useEffect(()=>{l.current.isValid&&r._setValid(!0)},[r]),Ot.useMemo(()=>Ale(a,r,l.current,!1),[a,r])}var ju=e=>typeof e=="string",Cle=(e,t,r,i,n)=>ju(e)?(i&&t.watch.add(e),St(r,e,n)):Array.isArray(e)?e.map(s=>(i&&t.watch.add(s),St(r,s))):(i&&(t.watchAll=!0),r);function Cqe(e){const t=rD(),{control:r=t.control,name:i,defaultValue:n,disabled:s,exact:a}=e||{},o=Ot.useRef(n),[l,c]=Ot.useState(r._getWatch(i,o.current));return iD(()=>r._subscribe({name:i,formState:{values:!0},exact:a,callback:u=>!s&&c(Cle(i,r._names,u.values||r._formValues,!1,o.current))}),[i,r,s,a]),Ot.useEffect(()=>r._removeUnmounted()),l}function Tqe(e){const t=rD(),{name:r,disabled:i,control:n=t.control,shouldUnregister:s}=e,a=Sle(n._names.array,r),o=Cqe({control:n,name:r,defaultValue:St(n._formValues,r,St(n._defaultValues,r,e.defaultValue)),exact:!0}),l=Aqe({control:n,name:r,exact:!0}),c=Ot.useRef(e),u=Ot.useRef(n.register(r,{...e.rules,value:o,...el(e.disabled)?{disabled:e.disabled}:{}})),d=Ot.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!St(l.errors,r)},isDirty:{enumerable:!0,get:()=>!!St(l.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!St(l.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!St(l.validatingFields,r)},error:{enumerable:!0,get:()=>St(l.errors,r)}}),[l,r]),f=Ot.useCallback(x=>u.current.onChange({target:{value:_le(x),name:r},type:aP.CHANGE}),[r]),m=Ot.useCallback(()=>u.current.onBlur({target:{value:St(n._formValues,r),name:r},type:aP.BLUR}),[r,n._formValues]),v=Ot.useCallback(x=>{const w=St(n._fields,r);w&&x&&(w._f.ref={focus:()=>x.focus&&x.focus(),select:()=>x.select&&x.select(),setCustomValidity:_=>x.setCustomValidity(_),reportValidity:()=>x.reportValidity()})},[n._fields,r]),y=Ot.useMemo(()=>({name:r,value:o,...el(i)||l.disabled?{disabled:l.disabled||i}:{},onChange:f,onBlur:m,ref:v}),[r,i,l.disabled,f,m,v,o]);return Ot.useEffect(()=>{const x=n._options.shouldUnregister||s;n.register(r,{...c.current.rules,...el(c.current.disabled)?{disabled:c.current.disabled}:{}});const w=(_,S)=>{const P=St(n._fields,_);P&&P._f&&(P._f.mount=S)};if(w(r,!0),x){const _=tn(St(n._options.defaultValues,r));xi(n._defaultValues,r,_),nn(St(n._formValues,r))&&xi(n._formValues,r,_)}return!a&&n.register(r),()=>{(a?x&&!n._state.action:x)?n.unregister(r):w(r,!1)}},[r,n,a,s]),Ot.useEffect(()=>{n._setDisabledField({disabled:i,name:r})},[i,r,n]),Ot.useMemo(()=>({field:y,formState:l,fieldState:d}),[y,l,d])}const Mqe=e=>e.render(Tqe(e));var wF=(e,t,r,i,n)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[i]:n||!0}}:{},Po=e=>Array.isArray(e)?e:[e],_K=()=>{let e=[];return{get observers(){return e},next:n=>{for(const s of e)s.next&&s.next(n)},subscribe:n=>(e.push(n),{unsubscribe:()=>{e=e.filter(s=>s!==n)}}),unsubscribe:()=>{e=[]}}},R5=e=>eo(e)||!wle(e);function rp(e,t,r=new WeakSet){if(R5(e)||R5(t))return e===t;if(yg(e)&&yg(t))return e.getTime()===t.getTime();const i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;if(r.has(e)||r.has(t))return!0;r.add(e),r.add(t);for(const s of i){const a=e[s];if(!n.includes(s))return!1;if(s!=="ref"){const o=t[s];if(yg(a)&&yg(o)||Gn(a)&&Gn(o)||Array.isArray(a)&&Array.isArray(o)?!rp(a,o,r):a!==o)return!1}}return!0}var Ja=e=>Gn(e)&&!Object.keys(e).length,_F=e=>e.type==="file",bc=e=>typeof e=="function",oP=e=>{if(!xF)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Tle=e=>e.type==="select-multiple",SF=e=>e.type==="radio",Pqe=e=>SF(e)||X_(e),jI=e=>oP(e)&&e.isConnected;function Dqe(e,t){const r=t.slice(0,-1).length;let i=0;for(;i<r;)e=nn(e)?i++:e[t[i++]];return e}function Nqe(e){for(const t in e)if(e.hasOwnProperty(t)&&!nn(e[t]))return!1;return!0}function Ln(e,t){const r=Array.isArray(t)?t:eD(t)?[t]:bF(t),i=r.length===1?e:Dqe(e,r),n=r.length-1,s=r[n];return i&&delete i[s],n!==0&&(Gn(i)&&Ja(i)||Array.isArray(i)&&Nqe(i))&&Ln(e,r.slice(0,-1)),e}var Mle=e=>{for(const t in e)if(bc(e[t]))return!0;return!1};function lP(e,t={}){const r=Array.isArray(e);if(Gn(e)||r)for(const i in e)Array.isArray(e[i])||Gn(e[i])&&!Mle(e[i])?(t[i]=Array.isArray(e[i])?[]:{},lP(e[i],t[i])):eo(e[i])||(t[i]=!0);return t}function Ple(e,t,r){const i=Array.isArray(e);if(Gn(e)||i)for(const n in e)Array.isArray(e[n])||Gn(e[n])&&!Mle(e[n])?nn(t)||R5(r[n])?r[n]=Array.isArray(e[n])?lP(e[n],[]):{...lP(e[n])}:Ple(e[n],eo(t)?{}:t[n],r[n]):r[n]=!rp(e[n],t[n]);return r}var rw=(e,t)=>Ple(e,t,lP(t));const SK={value:!1,isValid:!1},EK={value:!0,isValid:!0};var Dle=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!nn(e[0].attributes.value)?nn(e[0].value)||e[0].value===""?EK:{value:e[0].value,isValid:!0}:EK:SK}return SK},Nle=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:i})=>nn(e)?e:t?e===""?NaN:e&&+e:r&&ju(e)?new Date(e):i?i(e):e;const AK={isValid:!1,value:null};var kle=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,AK):AK;function CK(e){const t=e.ref;return _F(t)?t.files:SF(t)?kle(e.refs).value:Tle(t)?[...t.selectedOptions].map(({value:r})=>r):X_(t)?Dle(e.refs).value:Nle(nn(t.value)?e.ref.value:t.value,e)}var kqe=(e,t,r,i)=>{const n={};for(const s of e){const a=St(t,s);a&&xi(n,s,a._f)}return{criteriaMode:r,names:[...e],fields:n,shouldUseNativeValidation:i}},cP=e=>e instanceof RegExp,iw=e=>nn(e)?e:cP(e)?e.source:Gn(e)?cP(e.value)?e.value.source:e.value:e,wy=e=>({isOnSubmit:!e||e===zl.onSubmit,isOnBlur:e===zl.onBlur,isOnChange:e===zl.onChange,isOnAll:e===zl.all,isOnTouch:e===zl.onTouched});const TK="AsyncFunction";var Rqe=e=>!!e&&!!e.validate&&!!(bc(e.validate)&&e.validate.constructor.name===TK||Gn(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===TK)),Iqe=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),I5=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(i=>e.startsWith(i)&&/^\.\w+/.test(e.slice(i.length))));const Hy=(e,t,r,i)=>{for(const n of r||Object.keys(e)){const s=St(e,n);if(s){const{_f:a,...o}=s;if(a){if(a.refs&&a.refs[0]&&t(a.refs[0],n)&&!i)return!0;if(a.ref&&t(a.ref,a.name)&&!i)return!0;if(Hy(o,t))break}else if(Gn(o)&&Hy(o,t))break}}};function MK(e,t,r){const i=St(e,r);if(i||eD(r))return{error:i,name:r};const n=r.split(".");for(;n.length;){const s=n.join("."),a=St(t,s),o=St(e,s);if(a&&!Array.isArray(a)&&r!==s)return{name:r};if(o&&o.type)return{name:s,error:o};if(o&&o.root&&o.root.type)return{name:`${s}.root`,error:o.root};n.pop()}return{name:r}}var Oqe=(e,t,r,i)=>{r(e);const{name:n,...s}=e;return Ja(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find(a=>t[a]===(!i||zl.all))},jqe=(e,t,r)=>!e||!t||e===t||Po(e).some(i=>i&&(r?i===t:i.startsWith(t)||t.startsWith(i))),Lqe=(e,t,r,i,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(t||e):(r?i.isOnBlur:n.isOnBlur)?!e:(r?i.isOnChange:n.isOnChange)?e:!0,zqe=(e,t)=>!tD(St(e,t)).length&&Ln(e,t),Rle=(e,t,r)=>{const i=Po(St(e,r));return xi(i,"root",t[r]),xi(e,r,i),e},bT=e=>ju(e);function PK(e,t,r="validate"){if(bT(e)||Array.isArray(e)&&e.every(bT)||el(e)&&!e)return{type:r,message:bT(e)?e:"",ref:t}}var Gv=e=>Gn(e)&&!cP(e)?e:{value:e,message:""},O5=async(e,t,r,i,n,s)=>{const{ref:a,refs:o,required:l,maxLength:c,minLength:u,min:d,max:f,pattern:m,validate:v,name:y,valueAsNumber:x,mount:w}=e._f,_=St(r,y);if(!w||t.has(y))return{};const S=o?o[0]:a,P=j=>{n&&S.reportValidity&&(S.setCustomValidity(el(j)?"":j||""),S.reportValidity())},M={},C=SF(a),T=X_(a),E=C||T,N=(x||_F(a))&&nn(a.value)&&nn(_)||oP(a)&&a.value===""||_===""||Array.isArray(_)&&!_.length,D=wF.bind(null,y,i,M),I=(j,L,B,q=Xd.maxLength,G=Xd.minLength)=>{const Y=j?L:B;M[y]={type:j?q:G,message:Y,ref:a,...D(j?q:G,Y)}};if(s?!Array.isArray(_)||!_.length:l&&(!E&&(N||eo(_))||el(_)&&!_||T&&!Dle(o).isValid||C&&!kle(o).isValid)){const{value:j,message:L}=bT(l)?{value:!!l,message:l}:Gv(l);if(j&&(M[y]={type:Xd.required,message:L,ref:S,...D(Xd.required,L)},!i))return P(L),M}if(!N&&(!eo(d)||!eo(f))){let j,L;const B=Gv(f),q=Gv(d);if(!eo(_)&&!isNaN(_)){const G=a.valueAsNumber||_&&+_;eo(B.value)||(j=G>B.value),eo(q.value)||(L=G<q.value)}else{const G=a.valueAsDate||new Date(_),Y=F=>new Date(new Date().toDateString()+" "+F),X=a.type=="time",re=a.type=="week";ju(B.value)&&_&&(j=X?Y(_)>Y(B.value):re?_>B.value:G>new Date(B.value)),ju(q.value)&&_&&(L=X?Y(_)<Y(q.value):re?_<q.value:G<new Date(q.value))}if((j||L)&&(I(!!j,B.message,q.message,Xd.max,Xd.min),!i))return P(M[y].message),M}if((c||u)&&!N&&(ju(_)||s&&Array.isArray(_))){const j=Gv(c),L=Gv(u),B=!eo(j.value)&&_.length>+j.value,q=!eo(L.value)&&_.length<+L.value;if((B||q)&&(I(B,j.message,L.message),!i))return P(M[y].message),M}if(m&&!N&&ju(_)){const{value:j,message:L}=Gv(m);if(cP(j)&&!_.match(j)&&(M[y]={type:Xd.pattern,message:L,ref:a,...D(Xd.pattern,L)},!i))return P(L),M}if(v){if(bc(v)){const j=await v(_,r),L=PK(j,S);if(L&&(M[y]={...L,...D(Xd.validate,L.message)},!i))return P(L.message),M}else if(Gn(v)){let j={};for(const L in v){if(!Ja(j)&&!i)break;const B=PK(await v[L](_,r),S,L);B&&(j={...B,...D(L,B.message)},P(B.message),i&&(M[y]=j))}if(!Ja(j)&&(M[y]={ref:S,...j},!i))return M}}return P(!0),M};const Bqe={mode:zl.onSubmit,reValidateMode:zl.onChange,shouldFocusError:!0};function Fqe(e={}){let t={...Bqe,...e},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:bc(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},i={},n=Gn(t.defaultValues)||Gn(t.values)?tn(t.defaultValues||t.values)||{}:{},s=t.shouldUnregister?{}:tn(n),a={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...u};const f={array:_K(),state:_K()},m=t.criteriaMode===zl.all,v=me=>_e=>{clearTimeout(c),c=setTimeout(me,_e)},y=async me=>{if(!t.disabled&&(u.isValid||d.isValid||me)){const _e=t.resolver?Ja((await T()).errors):await N(i,!0);_e!==r.isValid&&f.state.next({isValid:_e})}},x=(me,_e)=>{!t.disabled&&(u.isValidating||u.validatingFields||d.isValidating||d.validatingFields)&&((me||Array.from(o.mount)).forEach(te=>{te&&(_e?xi(r.validatingFields,te,_e):Ln(r.validatingFields,te))}),f.state.next({validatingFields:r.validatingFields,isValidating:!Ja(r.validatingFields)}))},w=(me,_e=[],te,J,ve=!0,Me=!0)=>{if(J&&te&&!t.disabled){if(a.action=!0,Me&&Array.isArray(St(i,me))){const W=te(St(i,me),J.argA,J.argB);ve&&xi(i,me,W)}if(Me&&Array.isArray(St(r.errors,me))){const W=te(St(r.errors,me),J.argA,J.argB);ve&&xi(r.errors,me,W),zqe(r.errors,me)}if((u.touchedFields||d.touchedFields)&&Me&&Array.isArray(St(r.touchedFields,me))){const W=te(St(r.touchedFields,me),J.argA,J.argB);ve&&xi(r.touchedFields,me,W)}(u.dirtyFields||d.dirtyFields)&&(r.dirtyFields=rw(n,s)),f.state.next({name:me,isDirty:I(me,_e),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else xi(s,me,_e)},_=(me,_e)=>{xi(r.errors,me,_e),f.state.next({errors:r.errors})},S=me=>{r.errors=me,f.state.next({errors:r.errors,isValid:!1})},P=(me,_e,te,J)=>{const ve=St(i,me);if(ve){const Me=St(s,me,nn(te)?St(n,me):te);nn(Me)||J&&J.defaultChecked||_e?xi(s,me,_e?Me:CK(ve._f)):B(me,Me),a.mount&&y()}},M=(me,_e,te,J,ve)=>{let Me=!1,W=!1;const Se={name:me};if(!t.disabled){if(!te||J){(u.isDirty||d.isDirty)&&(W=r.isDirty,r.isDirty=Se.isDirty=I(),Me=W!==Se.isDirty);const ze=rp(St(n,me),_e);W=!!St(r.dirtyFields,me),ze?Ln(r.dirtyFields,me):xi(r.dirtyFields,me,!0),Se.dirtyFields=r.dirtyFields,Me=Me||(u.dirtyFields||d.dirtyFields)&&W!==!ze}if(te){const ze=St(r.touchedFields,me);ze||(xi(r.touchedFields,me,te),Se.touchedFields=r.touchedFields,Me=Me||(u.touchedFields||d.touchedFields)&&ze!==te)}Me&&ve&&f.state.next(Se)}return Me?Se:{}},C=(me,_e,te,J)=>{const ve=St(r.errors,me),Me=(u.isValid||d.isValid)&&el(_e)&&r.isValid!==_e;if(t.delayError&&te?(l=v(()=>_(me,te)),l(t.delayError)):(clearTimeout(c),l=null,te?xi(r.errors,me,te):Ln(r.errors,me)),(te?!rp(ve,te):ve)||!Ja(J)||Me){const W={...J,...Me&&el(_e)?{isValid:_e}:{},errors:r.errors,name:me};r={...r,...W},f.state.next(W)}},T=async me=>{x(me,!0);const _e=await t.resolver(s,t.context,kqe(me||o.mount,i,t.criteriaMode,t.shouldUseNativeValidation));return x(me),_e},E=async me=>{const{errors:_e}=await T(me);if(me)for(const te of me){const J=St(_e,te);J?xi(r.errors,te,J):Ln(r.errors,te)}else r.errors=_e;return _e},N=async(me,_e,te={valid:!0})=>{for(const J in me){const ve=me[J];if(ve){const{_f:Me,...W}=ve;if(Me){const Se=o.array.has(Me.name),ze=ve._f&&Rqe(ve._f);ze&&u.validatingFields&&x([J],!0);const Ue=await O5(ve,o.disabled,s,m,t.shouldUseNativeValidation&&!_e,Se);if(ze&&u.validatingFields&&x([J]),Ue[Me.name]&&(te.valid=!1,_e))break;!_e&&(St(Ue,Me.name)?Se?Rle(r.errors,Ue,Me.name):xi(r.errors,Me.name,Ue[Me.name]):Ln(r.errors,Me.name))}!Ja(W)&&await N(W,_e,te)}}return te.valid},D=()=>{for(const me of o.unMount){const _e=St(i,me);_e&&(_e._f.refs?_e._f.refs.every(te=>!jI(te)):!jI(_e._f.ref))&&ae(me)}o.unMount=new Set},I=(me,_e)=>!t.disabled&&(me&&_e&&xi(s,me,_e),!rp(F(),n)),j=(me,_e,te)=>Cle(me,o,{...a.mount?s:nn(_e)?n:ju(me)?{[me]:_e}:_e},te,_e),L=me=>tD(St(a.mount?s:n,me,t.shouldUnregister?St(n,me,[]):[])),B=(me,_e,te={})=>{const J=St(i,me);let ve=_e;if(J){const Me=J._f;Me&&(!Me.disabled&&xi(s,me,Nle(_e,Me)),ve=oP(Me.ref)&&eo(_e)?"":_e,Tle(Me.ref)?[...Me.ref.options].forEach(W=>W.selected=ve.includes(W.value)):Me.refs?X_(Me.ref)?Me.refs.forEach(W=>{(!W.defaultChecked||!W.disabled)&&(Array.isArray(ve)?W.checked=!!ve.find(Se=>Se===W.value):W.checked=ve===W.value||!!ve)}):Me.refs.forEach(W=>W.checked=W.value===ve):_F(Me.ref)?Me.ref.value="":(Me.ref.value=ve,Me.ref.type||f.state.next({name:me,values:tn(s)})))}(te.shouldDirty||te.shouldTouch)&&M(me,ve,te.shouldTouch,te.shouldDirty,!0),te.shouldValidate&&re(me)},q=(me,_e,te)=>{for(const J in _e){if(!_e.hasOwnProperty(J))return;const ve=_e[J],Me=me+"."+J,W=St(i,Me);(o.array.has(me)||Gn(ve)||W&&!W._f)&&!yg(ve)?q(Me,ve,te):B(Me,ve,te)}},G=(me,_e,te={})=>{const J=St(i,me),ve=o.array.has(me),Me=tn(_e);xi(s,me,Me),ve?(f.array.next({name:me,values:tn(s)}),(u.isDirty||u.dirtyFields||d.isDirty||d.dirtyFields)&&te.shouldDirty&&f.state.next({name:me,dirtyFields:rw(n,s),isDirty:I(me,Me)})):J&&!J._f&&!eo(Me)?q(me,Me,te):B(me,Me,te),I5(me,o)&&f.state.next({...r}),f.state.next({name:a.mount?me:void 0,values:tn(s)})},Y=async me=>{a.mount=!0;const _e=me.target;let te=_e.name,J=!0;const ve=St(i,te),Me=ze=>{J=Number.isNaN(ze)||yg(ze)&&isNaN(ze.getTime())||rp(ze,St(s,te,ze))},W=wy(t.mode),Se=wy(t.reValidateMode);if(ve){let ze,Ue;const Ne=_e.type?CK(ve._f):_le(me),De=me.type===aP.BLUR||me.type===aP.FOCUS_OUT,We=!Iqe(ve._f)&&!t.resolver&&!St(r.errors,te)&&!ve._f.deps||Lqe(De,St(r.touchedFields,te),r.isSubmitted,Se,W),Je=I5(te,o,De);xi(s,te,Ne),De?(ve._f.onBlur&&ve._f.onBlur(me),l&&l(0)):ve._f.onChange&&ve._f.onChange(me);const et=M(te,Ne,De),qe=!Ja(et)||Je;if(!De&&f.state.next({name:te,type:me.type,values:tn(s)}),We)return(u.isValid||d.isValid)&&(t.mode==="onBlur"?De&&y():De||y()),qe&&f.state.next({name:te,...Je?{}:et});if(!De&&Je&&f.state.next({...r}),t.resolver){const{errors:ft}=await T([te]);if(Me(Ne),J){const kt=MK(r.errors,i,te),Mt=MK(ft,i,kt.name||te);ze=Mt.error,te=Mt.name,Ue=Ja(ft)}}else x([te],!0),ze=(await O5(ve,o.disabled,s,m,t.shouldUseNativeValidation))[te],x([te]),Me(Ne),J&&(ze?Ue=!1:(u.isValid||d.isValid)&&(Ue=await N(i,!0)));J&&(ve._f.deps&&re(ve._f.deps),C(te,Ue,ze,et))}},X=(me,_e)=>{if(St(r.errors,_e)&&me.focus)return me.focus(),1},re=async(me,_e={})=>{let te,J;const ve=Po(me);if(t.resolver){const Me=await E(nn(me)?me:ve);te=Ja(Me),J=me?!ve.some(W=>St(Me,W)):te}else me?(J=(await Promise.all(ve.map(async Me=>{const W=St(i,Me);return await N(W&&W._f?{[Me]:W}:W)}))).every(Boolean),!(!J&&!r.isValid)&&y()):J=te=await N(i);return f.state.next({...!ju(me)||(u.isValid||d.isValid)&&te!==r.isValid?{}:{name:me},...t.resolver||!me?{isValid:te}:{},errors:r.errors}),_e.shouldFocus&&!J&&Hy(i,X,me?ve:o.mount),J},F=me=>{const _e={...a.mount?s:n};return nn(me)?_e:ju(me)?St(_e,me):me.map(te=>St(_e,te))},$=(me,_e)=>({invalid:!!St((_e||r).errors,me),isDirty:!!St((_e||r).dirtyFields,me),error:St((_e||r).errors,me),isValidating:!!St(r.validatingFields,me),isTouched:!!St((_e||r).touchedFields,me)}),se=me=>{me&&Po(me).forEach(_e=>Ln(r.errors,_e)),f.state.next({errors:me?r.errors:{}})},H=(me,_e,te)=>{const J=(St(i,me,{_f:{}})._f||{}).ref,ve=St(r.errors,me)||{},{ref:Me,message:W,type:Se,...ze}=ve;xi(r.errors,me,{...ze,..._e,ref:J}),f.state.next({name:me,errors:r.errors,isValid:!1}),te&&te.shouldFocus&&J&&J.focus&&J.focus()},ne=(me,_e)=>bc(me)?f.state.subscribe({next:te=>me(j(void 0,_e),te)}):j(me,_e,!0),ce=me=>f.state.subscribe({next:_e=>{jqe(me.name,_e.name,me.exact)&&Oqe(_e,me.formState||u,dt,me.reRenderRoot)&&me.callback({values:{...s},...r,..._e})}}).unsubscribe,ie=me=>(a.mount=!0,d={...d,...me.formState},ce({...me,formState:d})),ae=(me,_e={})=>{for(const te of me?Po(me):o.mount)o.mount.delete(te),o.array.delete(te),_e.keepValue||(Ln(i,te),Ln(s,te)),!_e.keepError&&Ln(r.errors,te),!_e.keepDirty&&Ln(r.dirtyFields,te),!_e.keepTouched&&Ln(r.touchedFields,te),!_e.keepIsValidating&&Ln(r.validatingFields,te),!t.shouldUnregister&&!_e.keepDefaultValue&&Ln(n,te);f.state.next({values:tn(s)}),f.state.next({...r,..._e.keepDirty?{isDirty:I()}:{}}),!_e.keepIsValid&&y()},Z=({disabled:me,name:_e})=>{(el(me)&&a.mount||me||o.disabled.has(_e))&&(me?o.disabled.add(_e):o.disabled.delete(_e))},fe=(me,_e={})=>{let te=St(i,me);const J=el(_e.disabled)||el(t.disabled);return xi(i,me,{...te||{},_f:{...te&&te._f?te._f:{ref:{name:me}},name:me,mount:!0,..._e}}),o.mount.add(me),te?Z({disabled:el(_e.disabled)?_e.disabled:t.disabled,name:me}):P(me,!0,_e.value),{...J?{disabled:_e.disabled||t.disabled}:{},...t.progressive?{required:!!_e.required,min:iw(_e.min),max:iw(_e.max),minLength:iw(_e.minLength),maxLength:iw(_e.maxLength),pattern:iw(_e.pattern)}:{},name:me,onChange:Y,onBlur:Y,ref:ve=>{if(ve){fe(me,_e),te=St(i,me);const Me=nn(ve.value)&&ve.querySelectorAll&&ve.querySelectorAll("input,select,textarea")[0]||ve,W=Pqe(Me),Se=te._f.refs||[];if(W?Se.find(ze=>ze===Me):Me===te._f.ref)return;xi(i,me,{_f:{...te._f,...W?{refs:[...Se.filter(jI),Me,...Array.isArray(St(n,me))?[{}]:[]],ref:{type:Me.type,name:me}}:{ref:Me}}}),P(me,!1,void 0,Me)}else te=St(i,me,{}),te._f&&(te._f.mount=!1),(t.shouldUnregister||_e.shouldUnregister)&&!(Sle(o.array,me)&&a.action)&&o.unMount.add(me)}}},he=()=>t.shouldFocusError&&Hy(i,X,o.mount),Ae=me=>{el(me)&&(f.state.next({disabled:me}),Hy(i,(_e,te)=>{const J=St(i,te);J&&(_e.disabled=J._f.disabled||me,Array.isArray(J._f.refs)&&J._f.refs.forEach(ve=>{ve.disabled=J._f.disabled||me}))},0,!1))},xe=(me,_e)=>async te=>{let J;te&&(te.preventDefault&&te.preventDefault(),te.persist&&te.persist());let ve=tn(s);if(f.state.next({isSubmitting:!0}),t.resolver){const{errors:Me,values:W}=await T();r.errors=Me,ve=tn(W)}else await N(i);if(o.disabled.size)for(const Me of o.disabled)Ln(ve,Me);if(Ln(r.errors,"root"),Ja(r.errors)){f.state.next({errors:{}});try{await me(ve,te)}catch(Me){J=Me}}else _e&&await _e({...r.errors},te),he(),setTimeout(he);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ja(r.errors)&&!J,submitCount:r.submitCount+1,errors:r.errors}),J)throw J},Ee=(me,_e={})=>{St(i,me)&&(nn(_e.defaultValue)?G(me,tn(St(n,me))):(G(me,_e.defaultValue),xi(n,me,tn(_e.defaultValue))),_e.keepTouched||Ln(r.touchedFields,me),_e.keepDirty||(Ln(r.dirtyFields,me),r.isDirty=_e.defaultValue?I(me,tn(St(n,me))):I()),_e.keepError||(Ln(r.errors,me),u.isValid&&y()),f.state.next({...r}))},Be=(me,_e={})=>{const te=me?tn(me):n,J=tn(te),ve=Ja(me),Me=ve?n:J;if(_e.keepDefaultValues||(n=te),!_e.keepValues){if(_e.keepDirtyValues){const W=new Set([...o.mount,...Object.keys(rw(n,s))]);for(const Se of Array.from(W))St(r.dirtyFields,Se)?xi(Me,Se,St(s,Se)):G(Se,St(Me,Se))}else{if(xF&&nn(me))for(const W of o.mount){const Se=St(i,W);if(Se&&Se._f){const ze=Array.isArray(Se._f.refs)?Se._f.refs[0]:Se._f.ref;if(oP(ze)){const Ue=ze.closest("form");if(Ue){Ue.reset();break}}}}if(_e.keepFieldsRef)for(const W of o.mount)G(W,St(Me,W));else i={}}s=t.shouldUnregister?_e.keepDefaultValues?tn(n):{}:tn(Me),f.array.next({values:{...Me}}),f.state.next({values:{...Me}})}o={mount:_e.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!u.isValid||!!_e.keepIsValid||!!_e.keepDirtyValues,a.watch=!!t.shouldUnregister,f.state.next({submitCount:_e.keepSubmitCount?r.submitCount:0,isDirty:ve?!1:_e.keepDirty?r.isDirty:!!(_e.keepDefaultValues&&!rp(me,n)),isSubmitted:_e.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:ve?{}:_e.keepDirtyValues?_e.keepDefaultValues&&s?rw(n,s):r.dirtyFields:_e.keepDefaultValues&&me?rw(n,me):_e.keepDirty?r.dirtyFields:{},touchedFields:_e.keepTouched?r.touchedFields:{},errors:_e.keepErrors?r.errors:{},isSubmitSuccessful:_e.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},$e=(me,_e)=>Be(bc(me)?me(s):me,_e),mt=(me,_e={})=>{const te=St(i,me),J=te&&te._f;if(J){const ve=J.refs?J.refs[0]:J.ref;ve.focus&&(ve.focus(),_e.shouldSelect&&bc(ve.select)&&ve.select())}},dt=me=>{r={...r,...me}},ut={control:{register:fe,unregister:ae,getFieldState:$,handleSubmit:xe,setError:H,_subscribe:ce,_runSchema:T,_focusError:he,_getWatch:j,_getDirty:I,_setValid:y,_setFieldArray:w,_setDisabledField:Z,_setErrors:S,_getFieldArray:L,_reset:Be,_resetDefaultValues:()=>bc(t.defaultValues)&&t.defaultValues().then(me=>{$e(me,t.resetOptions),f.state.next({isLoading:!1})}),_removeUnmounted:D,_disableForm:Ae,_subjects:f,_proxyFormState:u,get _fields(){return i},get _formValues(){return s},get _state(){return a},set _state(me){a=me},get _defaultValues(){return n},get _names(){return o},set _names(me){o=me},get _formState(){return r},get _options(){return t},set _options(me){t={...t,...me}}},subscribe:ie,trigger:re,register:fe,handleSubmit:xe,watch:ne,setValue:G,getValues:F,reset:$e,resetField:Ee,clearErrors:se,unregister:ae,setError:H,setFocus:mt,getFieldState:$};return{...ut,formControl:ut}}var Ff=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const e=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const r=(Math.random()*16+e)%16|0;return(t=="x"?r:r&3|8).toString(16)})},LI=(e,t,r={})=>r.shouldFocus||nn(r.shouldFocus)?r.focusName||`${e}.${nn(r.focusIndex)?t:r.focusIndex}.`:"",zI=(e,t)=>[...e,...Po(t)],BI=e=>Array.isArray(e)?e.map(()=>{}):void 0;function FI(e,t,r){return[...e.slice(0,t),...Po(r),...e.slice(t)]}var VI=(e,t,r)=>Array.isArray(e)?(nn(e[r])&&(e[r]=void 0),e.splice(r,0,e.splice(t,1)[0]),e):[],UI=(e,t)=>[...Po(t),...Po(e)];function Vqe(e,t){let r=0;const i=[...e];for(const n of t)i.splice(n-r,1),r++;return tD(i).length?i:[]}var HI=(e,t)=>nn(t)?[]:Vqe(e,Po(t).sort((r,i)=>r-i)),GI=(e,t,r)=>{[e[t],e[r]]=[e[r],e[t]]},DK=(e,t,r)=>(e[t]=r,e);function pC(e){const t=rD(),{control:r=t.control,name:i,keyName:n="id",shouldUnregister:s,rules:a}=e,[o,l]=Ot.useState(r._getFieldArray(i)),c=Ot.useRef(r._getFieldArray(i).map(Ff)),u=Ot.useRef(o),d=Ot.useRef(i),f=Ot.useRef(!1);d.current=i,u.current=o,r._names.array.add(i),a&&r.register(i,a),iD(()=>r._subjects.array.subscribe({next:({values:C,name:T})=>{if(T===d.current||!T){const E=St(C,d.current);Array.isArray(E)&&(l(E),c.current=E.map(Ff))}}}).unsubscribe,[r]);const m=Ot.useCallback(C=>{f.current=!0,r._setFieldArray(i,C)},[r,i]),v=(C,T)=>{const E=Po(tn(C)),N=zI(r._getFieldArray(i),E);r._names.focus=LI(i,N.length-1,T),c.current=zI(c.current,E.map(Ff)),m(N),l(N),r._setFieldArray(i,N,zI,{argA:BI(C)})},y=(C,T)=>{const E=Po(tn(C)),N=UI(r._getFieldArray(i),E);r._names.focus=LI(i,0,T),c.current=UI(c.current,E.map(Ff)),m(N),l(N),r._setFieldArray(i,N,UI,{argA:BI(C)})},x=C=>{const T=HI(r._getFieldArray(i),C);c.current=HI(c.current,C),m(T),l(T),!Array.isArray(St(r._fields,i))&&xi(r._fields,i,void 0),r._setFieldArray(i,T,HI,{argA:C})},w=(C,T,E)=>{const N=Po(tn(T)),D=FI(r._getFieldArray(i),C,N);r._names.focus=LI(i,C,E),c.current=FI(c.current,C,N.map(Ff)),m(D),l(D),r._setFieldArray(i,D,FI,{argA:C,argB:BI(T)})},_=(C,T)=>{const E=r._getFieldArray(i);GI(E,C,T),GI(c.current,C,T),m(E),l(E),r._setFieldArray(i,E,GI,{argA:C,argB:T},!1)},S=(C,T)=>{const E=r._getFieldArray(i);VI(E,C,T),VI(c.current,C,T),m(E),l(E),r._setFieldArray(i,E,VI,{argA:C,argB:T},!1)},P=(C,T)=>{const E=tn(T),N=DK(r._getFieldArray(i),C,E);c.current=[...N].map((D,I)=>!D||I===C?Ff():c.current[I]),m(N),l([...N]),r._setFieldArray(i,N,DK,{argA:C,argB:E},!0,!1)},M=C=>{const T=Po(tn(C));c.current=T.map(Ff),m([...T]),l([...T]),r._setFieldArray(i,[...T],E=>E,{},!0,!1)};return Ot.useEffect(()=>{if(r._state.action=!1,I5(i,r._names)&&r._subjects.state.next({...r._formState}),f.current&&(!wy(r._options.mode).isOnSubmit||r._formState.isSubmitted)&&!wy(r._options.reValidateMode).isOnSubmit)if(r._options.resolver)r._runSchema([i]).then(C=>{const T=St(C.errors,i),E=St(r._formState.errors,i);(E?!T&&E.type||T&&(E.type!==T.type||E.message!==T.message):T&&T.type)&&(T?xi(r._formState.errors,i,T):Ln(r._formState.errors,i),r._subjects.state.next({errors:r._formState.errors}))});else{const C=St(r._fields,i);C&&C._f&&!(wy(r._options.reValidateMode).isOnSubmit&&wy(r._options.mode).isOnSubmit)&&O5(C,r._names.disabled,r._formValues,r._options.criteriaMode===zl.all,r._options.shouldUseNativeValidation,!0).then(T=>!Ja(T)&&r._subjects.state.next({errors:Rle(r._formState.errors,T,i)}))}r._subjects.state.next({name:i,values:tn(r._formValues)}),r._names.focus&&Hy(r._fields,(C,T)=>{if(r._names.focus&&T.startsWith(r._names.focus)&&C.focus)return C.focus(),1}),r._names.focus="",r._setValid(),f.current=!1},[o,i,r]),Ot.useEffect(()=>(!St(r._formValues,i)&&r._setFieldArray(i),()=>{const C=(T,E)=>{const N=St(r._fields,T);N&&N._f&&(N._f.mount=E)};r._options.shouldUnregister||s?r.unregister(i):C(i,!1)}),[i,r,n,s]),{swap:Ot.useCallback(_,[m,i,r]),move:Ot.useCallback(S,[m,i,r]),prepend:Ot.useCallback(y,[m,i,r]),append:Ot.useCallback(v,[m,i,r]),remove:Ot.useCallback(x,[m,i,r]),insert:Ot.useCallback(w,[m,i,r]),update:Ot.useCallback(P,[m,i,r]),replace:Ot.useCallback(M,[m,i,r]),fields:Ot.useMemo(()=>o.map((C,T)=>({...C,[n]:c.current[T]||Ff()})),[o,n])}}function $c(e={}){const t=Ot.useRef(void 0),r=Ot.useRef(void 0),[i,n]=Ot.useState({isDirty:!1,isValidating:!1,isLoading:bc(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:bc(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:i},e.defaultValues&&!bc(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:a,...o}=Fqe(e);t.current={...o,formState:i}}const s=t.current.control;return s._options=e,iD(()=>{const a=s._subscribe({formState:s._proxyFormState,callback:()=>n({...s._formState}),reRenderRoot:!0});return n(o=>({...o,isReady:!0})),s._formState.isReady=!0,a},[s]),Ot.useEffect(()=>s._disableForm(e.disabled),[s,e.disabled]),Ot.useEffect(()=>{e.mode&&(s._options.mode=e.mode),e.reValidateMode&&(s._options.reValidateMode=e.reValidateMode)},[s,e.mode,e.reValidateMode]),Ot.useEffect(()=>{e.errors&&(s._setErrors(e.errors),s._focusError())},[s,e.errors]),Ot.useEffect(()=>{e.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[s,e.shouldUnregister]),Ot.useEffect(()=>{if(s._proxyFormState.isDirty){const a=s._getDirty();a!==i.isDirty&&s._subjects.state.next({isDirty:a})}},[s,i.isDirty]),Ot.useEffect(()=>{e.values&&!rp(e.values,r.current)?(s._reset(e.values,{keepFieldsRef:!0,...s._options.resetOptions}),r.current=e.values,n(a=>({...a}))):s._resetDefaultValues()},[s,e.values]),Ot.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),t.current.formState=Ale(i,s),t.current}const NK=(e,t,r)=>{if(e&&"reportValidity"in e){const i=St(r,t);e.setCustomValidity(i&&i.message||""),e.reportValidity()}},j5=(e,t)=>{for(const r in t.fields){const i=t.fields[r];i&&i.ref&&"reportValidity"in i.ref?NK(i.ref,r,e):i&&i.refs&&i.refs.forEach(n=>NK(n,r,e))}},kK=(e,t)=>{t.shouldUseNativeValidation&&j5(e,t);const r={};for(const i in e){const n=St(t.fields,i),s=Object.assign(e[i]||{},{ref:n&&n.ref});if(Uqe(t.names||Object.keys(e),i)){const a=Object.assign({},St(r,i));xi(a,"root",s),xi(r,i,a)}else xi(r,i,s)}return r},Uqe=(e,t)=>{const r=RK(t);return e.some(i=>RK(i).match(`^${r}\\.\\d+`))};function RK(e){return e.replace(/\]|\[/g,"")}function Ile(e,t,r){function i(o,l){var c;Object.defineProperty(o,"_zod",{value:o._zod??{},enumerable:!1}),(c=o._zod).traits??(c.traits=new Set),o._zod.traits.add(e),t(o,l);for(const u in a.prototype)u in o||Object.defineProperty(o,u,{value:a.prototype[u].bind(o)});o._zod.constr=a,o._zod.def=l}const n=r?.Parent??Object;class s extends n{}Object.defineProperty(s,"name",{value:e});function a(o){var l;const c=r?.Parent?new s:this;i(c,o),(l=c._zod).deferred??(l.deferred=[]);for(const u of c._zod.deferred)u();return c}return Object.defineProperty(a,"init",{value:i}),Object.defineProperty(a,Symbol.hasInstance,{value:o=>r?.Parent&&o instanceof r.Parent?!0:o?._zod?.traits?.has(e)}),Object.defineProperty(a,"name",{value:e}),a}class Hqe extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const Gqe={};function Ole(e){return Gqe}function Wqe(e,t){return typeof t=="bigint"?t.toString():t}const jle=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function mC(e){return typeof e=="string"?e:e?.message}function Lle(e,t,r){const i={...e,path:e.path??[]};if(!e.message){const n=mC(e.inst?._zod.def?.error?.(e))??mC(t?.error?.(e))??mC(r.customError?.(e))??mC(r.localeError?.(e))??"Invalid input";i.message=n}return delete i.inst,delete i.continue,t?.reportInput||delete i.input,i}const zle=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get(){return JSON.stringify(t,Wqe,2)},enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},qqe=Ile("$ZodError",zle),Ble=Ile("$ZodError",zle,{Parent:Error}),Yqe=e=>(t,r,i,n)=>{const s=i?Object.assign(i,{async:!1}):{async:!1},a=t._zod.run({value:r,issues:[]},s);if(a instanceof Promise)throw new Hqe;if(a.issues.length){const o=new(n?.Err??e)(a.issues.map(l=>Lle(l,s,Ole())));throw jle(o,n?.callee),o}return a.value},Xqe=Yqe(Ble),$qe=e=>async(t,r,i,n)=>{const s=i?Object.assign(i,{async:!0}):{async:!0};let a=t._zod.run({value:r,issues:[]},s);if(a instanceof Promise&&(a=await a),a.issues.length){const o=new(n?.Err??e)(a.issues.map(l=>Lle(l,s,Ole())));throw jle(o,n?.callee),o}return a.value},Kqe=$qe(Ble);function IK(e,t){try{var r=e()}catch(i){return t(i)}return r&&r.then?r.then(void 0,t):r}function Qqe(e,t){for(var r={};e.length;){var i=e[0],n=i.code,s=i.message,a=i.path.join(".");if(!r[a])if("unionErrors"in i){var o=i.unionErrors[0].errors[0];r[a]={message:o.message,type:o.code}}else r[a]={message:s,type:n};if("unionErrors"in i&&i.unionErrors.forEach(function(u){return u.errors.forEach(function(d){return e.push(d)})}),t){var l=r[a].types,c=l&&l[i.code];r[a]=wF(a,t,r,n,c?[].concat(c,i.message):i.message)}e.shift()}return r}function Zqe(e,t){for(var r={};e.length;){var i=e[0],n=i.code,s=i.message,a=i.path.join(".");if(!r[a])if(i.code==="invalid_union"){var o=i.errors[0][0];r[a]={message:o.message,type:o.code}}else r[a]={message:s,type:n};if(i.code==="invalid_union"&&i.errors.forEach(function(u){return u.forEach(function(d){return e.push(d)})}),t){var l=r[a].types,c=l&&l[i.code];r[a]=wF(a,t,r,n,c?[].concat(c,i.message):i.message)}e.shift()}return r}function y0(e,t,r){if(r===void 0&&(r={}),function(i){return"_def"in i&&typeof i._def=="object"&&"typeName"in i._def}(e))return function(i,n,s){try{return Promise.resolve(IK(function(){return Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](i,t)).then(function(a){return s.shouldUseNativeValidation&&j5({},s),{errors:{},values:r.raw?Object.assign({},i):a}})},function(a){if(function(o){return Array.isArray(o?.issues)}(a))return{values:{},errors:kK(Qqe(a.errors,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw a}))}catch(a){return Promise.reject(a)}};if(function(i){return"_zod"in i&&typeof i._zod=="object"}(e))return function(i,n,s){try{return Promise.resolve(IK(function(){return Promise.resolve((r.mode==="sync"?Xqe:Kqe)(e,i,t)).then(function(a){return s.shouldUseNativeValidation&&j5({},s),{errors:{},values:r.raw?Object.assign({},i):a}})},function(a){if(function(o){return o instanceof qqe}(a))return{values:{},errors:kK(Zqe(a.issues,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw a}))}catch(a){return Promise.reject(a)}};throw new Error("Invalid input: not a Zod schema")}var mi;(function(e){e.assertEqual=n=>{};function t(n){}e.assertIs=t;function r(n){throw new Error}e.assertNever=r,e.arrayToEnum=n=>{const s={};for(const a of n)s[a]=a;return s},e.getValidEnumValues=n=>{const s=e.objectKeys(n).filter(o=>typeof n[n[o]]!="number"),a={};for(const o of s)a[o]=n[o];return e.objectValues(a)},e.objectValues=n=>e.objectKeys(n).map(function(s){return n[s]}),e.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const s=[];for(const a in n)Object.prototype.hasOwnProperty.call(n,a)&&s.push(a);return s},e.find=(n,s)=>{for(const a of n)if(s(a))return a},e.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function i(n,s=" | "){return n.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}e.joinValues=i,e.jsonStringifyReplacer=(n,s)=>typeof s=="bigint"?s.toString():s})(mi||(mi={}));var OK;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(OK||(OK={}));const Ut=mi.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),$f=e=>{switch(typeof e){case"undefined":return Ut.undefined;case"string":return Ut.string;case"number":return Number.isNaN(e)?Ut.nan:Ut.number;case"boolean":return Ut.boolean;case"function":return Ut.function;case"bigint":return Ut.bigint;case"symbol":return Ut.symbol;case"object":return Array.isArray(e)?Ut.array:e===null?Ut.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?Ut.promise:typeof Map<"u"&&e instanceof Map?Ut.map:typeof Set<"u"&&e instanceof Set?Ut.set:typeof Date<"u"&&e instanceof Date?Ut.date:Ut.object;default:return Ut.unknown}},yt=mi.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Bh extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(s){return s.message},i={_errors:[]},n=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(n);else if(a.code==="invalid_return_type")n(a.returnTypeError);else if(a.code==="invalid_arguments")n(a.argumentsError);else if(a.path.length===0)i._errors.push(r(a));else{let o=i,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(r(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return n(this),i}static assert(t){if(!(t instanceof Bh))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,mi.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},i=[];for(const n of this.issues)if(n.path.length>0){const s=n.path[0];r[s]=r[s]||[],r[s].push(t(n))}else i.push(t(n));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}}Bh.create=e=>new Bh(e);const L5=(e,t)=>{let r;switch(e.code){case yt.invalid_type:e.received===Ut.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case yt.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,mi.jsonStringifyReplacer)}`;break;case yt.unrecognized_keys:r=`Unrecognized key(s) in object: ${mi.joinValues(e.keys,", ")}`;break;case yt.invalid_union:r="Invalid input";break;case yt.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${mi.joinValues(e.options)}`;break;case yt.invalid_enum_value:r=`Invalid enum value. Expected ${mi.joinValues(e.options)}, received '${e.received}'`;break;case yt.invalid_arguments:r="Invalid function arguments";break;case yt.invalid_return_type:r="Invalid function return type";break;case yt.invalid_date:r="Invalid date";break;case yt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:mi.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case yt.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case yt.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case yt.custom:r="Invalid input";break;case yt.invalid_intersection_types:r="Intersection results could not be merged";break;case yt.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case yt.not_finite:r="Number must be finite";break;default:r=t.defaultError,mi.assertNever(e)}return{message:r}};let Jqe=L5;function eYe(){return Jqe}const tYe=e=>{const{data:t,path:r,errorMaps:i,issueData:n}=e,s=[...r,...n.path||[]],a={...n,path:s};if(n.message!==void 0)return{...n,path:s,message:n.message};let o="";const l=i.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...n,path:s,message:o}};function Rt(e,t){const r=eYe(),i=tYe({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===L5?void 0:L5].filter(n=>!!n)});e.common.issues.push(i)}class dl{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const i=[];for(const n of r){if(n.status==="aborted")return Mr;n.status==="dirty"&&t.dirty(),i.push(n.value)}return{status:t.value,value:i}}static async mergeObjectAsync(t,r){const i=[];for(const n of r){const s=await n.key,a=await n.value;i.push({key:s,value:a})}return dl.mergeObjectSync(t,i)}static mergeObjectSync(t,r){const i={};for(const n of r){const{key:s,value:a}=n;if(s.status==="aborted"||a.status==="aborted")return Mr;s.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||n.alwaysSet)&&(i[s.value]=a.value)}return{status:t.value,value:i}}}const Mr=Object.freeze({status:"aborted"}),Tw=e=>({status:"dirty",value:e}),Ql=e=>({status:"valid",value:e}),jK=e=>e.status==="aborted",LK=e=>e.status==="dirty",xx=e=>e.status==="valid",uP=e=>typeof Promise<"u"&&e instanceof Promise;var Ht;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(Ht||(Ht={}));class zp{constructor(t,r,i,n){this._cachedPath=[],this.parent=t,this.data=r,this._path=i,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const zK=(e,t)=>{if(xx(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Bh(e.common.issues);return this._error=r,this._error}}};function Gr(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:i,description:n}=e;if(t&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:n}:{errorMap:(a,o)=>{const{message:l}=e;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??i??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??r??o.defaultError}},description:n}}class hi{get description(){return this._def.description}_getType(t){return $f(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:$f(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new dl,ctx:{common:t.parent.common,data:t.data,parsedType:$f(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(uP(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const i=this.safeParse(t,r);if(i.success)return i.data;throw i.error}safeParse(t,r){const i={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:$f(t)},n=this._parseSync({data:t,path:i.path,parent:i});return zK(i,n)}"~validate"(t){const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:$f(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:r});return xx(i)?{value:i.value}:{issues:r.common.issues}}catch(i){i?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(i=>xx(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(t,r){const i=await this.safeParseAsync(t,r);if(i.success)return i.data;throw i.error}async safeParseAsync(t,r){const i={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:$f(t)},n=this._parse({data:t,path:i.path,parent:i}),s=await(uP(n)?n:Promise.resolve(n));return zK(i,s)}refine(t,r){const i=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,s)=>{const a=t(n),o=()=>s.addIssue({code:yt.custom,...i(n)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,r){return this._refinement((i,n)=>t(i)?!0:(n.addIssue(typeof r=="function"?r(i,n):r),!1))}_refinement(t){return new _x({schema:this,typeName:Dr.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ap.create(this,this._def)}nullable(){return Sx.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Uu.create(this)}promise(){return pP.create(this,this._def)}or(t){return hP.create([this,t],this._def)}and(t){return fP.create(this,t,this._def)}transform(t){return new _x({...Gr(this._def),schema:this,typeName:Dr.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new B5({...Gr(this._def),innerType:this,defaultValue:r,typeName:Dr.ZodDefault})}brand(){return new EYe({typeName:Dr.ZodBranded,type:this,...Gr(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new F5({...Gr(this._def),innerType:this,catchValue:r,typeName:Dr.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return EF.create(this,t)}readonly(){return V5.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const rYe=/^c[^\s-]{8,}$/i,iYe=/^[0-9a-z]+$/,nYe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,sYe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,aYe=/^[a-z0-9_-]{21}$/i,oYe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,lYe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,cYe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,uYe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let WI;const dYe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,hYe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,fYe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,pYe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,mYe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,gYe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Fle="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",vYe=new RegExp(`^${Fle}$`);function Vle(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function yYe(e){return new RegExp(`^${Vle(e)}$`)}function xYe(e){let t=`${Fle}T${Vle(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function bYe(e,t){return!!((t==="v4"||!t)&&dYe.test(e)||(t==="v6"||!t)&&fYe.test(e))}function wYe(e,t){if(!oYe.test(e))return!1;try{const[r]=e.split(".");if(!r)return!1;const i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));return!(typeof n!="object"||n===null||"typ"in n&&n?.typ!=="JWT"||!n.alg||t&&n.alg!==t)}catch{return!1}}function _Ye(e,t){return!!((t==="v4"||!t)&&hYe.test(e)||(t==="v6"||!t)&&pYe.test(e))}class bh extends hi{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==Ut.string){const s=this._getOrReturnCtx(t);return Rt(s,{code:yt.invalid_type,expected:Ut.string,received:s.parsedType}),Mr}const i=new dl;let n;for(const s of this._def.checks)if(s.kind==="min")t.data.length<s.value&&(n=this._getOrReturnCtx(t,n),Rt(n,{code:yt.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="max")t.data.length>s.value&&(n=this._getOrReturnCtx(t,n),Rt(n,{code:yt.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="length"){const a=t.data.length>s.value,o=t.data.length<s.value;(a||o)&&(n=this._getOrReturnCtx(t,n),a?Rt(n,{code:yt.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&Rt(n,{code:yt.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),i.dirty())}else if(s.kind==="email")cYe.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"email",code:yt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="emoji")WI||(WI=new RegExp(uYe,"u")),WI.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"emoji",code:yt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="uuid")sYe.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"uuid",code:yt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="nanoid")aYe.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"nanoid",code:yt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid")rYe.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"cuid",code:yt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid2")iYe.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"cuid2",code:yt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="ulid")nYe.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"ulid",code:yt.invalid_string,message:s.message}),i.dirty());else if(s.kind==="url")try{new URL(t.data)}catch{n=this._getOrReturnCtx(t,n),Rt(n,{validation:"url",code:yt.invalid_string,message:s.message}),i.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"regex",code:yt.invalid_string,message:s.message}),i.dirty())):s.kind==="trim"?t.data=t.data.trim():s.kind==="includes"?t.data.includes(s.value,s.position)||(n=this._getOrReturnCtx(t,n),Rt(n,{code:yt.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),i.dirty()):s.kind==="toLowerCase"?t.data=t.data.toLowerCase():s.kind==="toUpperCase"?t.data=t.data.toUpperCase():s.kind==="startsWith"?t.data.startsWith(s.value)||(n=this._getOrReturnCtx(t,n),Rt(n,{code:yt.invalid_string,validation:{startsWith:s.value},message:s.message}),i.dirty()):s.kind==="endsWith"?t.data.endsWith(s.value)||(n=this._getOrReturnCtx(t,n),Rt(n,{code:yt.invalid_string,validation:{endsWith:s.value},message:s.message}),i.dirty()):s.kind==="datetime"?xYe(s).test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{code:yt.invalid_string,validation:"datetime",message:s.message}),i.dirty()):s.kind==="date"?vYe.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{code:yt.invalid_string,validation:"date",message:s.message}),i.dirty()):s.kind==="time"?yYe(s).test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{code:yt.invalid_string,validation:"time",message:s.message}),i.dirty()):s.kind==="duration"?lYe.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"duration",code:yt.invalid_string,message:s.message}),i.dirty()):s.kind==="ip"?bYe(t.data,s.version)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"ip",code:yt.invalid_string,message:s.message}),i.dirty()):s.kind==="jwt"?wYe(t.data,s.alg)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"jwt",code:yt.invalid_string,message:s.message}),i.dirty()):s.kind==="cidr"?_Ye(t.data,s.version)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"cidr",code:yt.invalid_string,message:s.message}),i.dirty()):s.kind==="base64"?mYe.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"base64",code:yt.invalid_string,message:s.message}),i.dirty()):s.kind==="base64url"?gYe.test(t.data)||(n=this._getOrReturnCtx(t,n),Rt(n,{validation:"base64url",code:yt.invalid_string,message:s.message}),i.dirty()):mi.assertNever(s);return{status:i.value,value:t.data}}_regex(t,r,i){return this.refinement(n=>t.test(n),{validation:r,code:yt.invalid_string,...Ht.errToObj(i)})}_addCheck(t){return new bh({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Ht.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Ht.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Ht.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Ht.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Ht.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Ht.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Ht.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Ht.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Ht.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Ht.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Ht.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Ht.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Ht.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...Ht.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...Ht.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...Ht.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...Ht.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r?.position,...Ht.errToObj(r?.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...Ht.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...Ht.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...Ht.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...Ht.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...Ht.errToObj(r)})}nonempty(t){return this.min(1,Ht.errToObj(t))}trim(){return new bh({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new bh({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new bh({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}bh.create=e=>new bh({checks:[],typeName:Dr.ZodString,coerce:e?.coerce??!1,...Gr(e)});function SYe(e,t){const r=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,n=r>i?r:i,s=Number.parseInt(e.toFixed(n).replace(".","")),a=Number.parseInt(t.toFixed(n).replace(".",""));return s%a/10**n}class Qg extends hi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==Ut.number){const s=this._getOrReturnCtx(t);return Rt(s,{code:yt.invalid_type,expected:Ut.number,received:s.parsedType}),Mr}let i;const n=new dl;for(const s of this._def.checks)s.kind==="int"?mi.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),Rt(i,{code:yt.invalid_type,expected:"integer",received:"float",message:s.message}),n.dirty()):s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(i=this._getOrReturnCtx(t,i),Rt(i,{code:yt.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),n.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(i=this._getOrReturnCtx(t,i),Rt(i,{code:yt.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),n.dirty()):s.kind==="multipleOf"?SYe(t.data,s.value)!==0&&(i=this._getOrReturnCtx(t,i),Rt(i,{code:yt.not_multiple_of,multipleOf:s.value,message:s.message}),n.dirty()):s.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),Rt(i,{code:yt.not_finite,message:s.message}),n.dirty()):mi.assertNever(s);return{status:n.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,Ht.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Ht.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Ht.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Ht.toString(r))}setLimit(t,r,i,n){return new Qg({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:Ht.toString(n)}]})}_addCheck(t){return new Qg({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Ht.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ht.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ht.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ht.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ht.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Ht.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:Ht.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ht.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ht.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&mi.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(t===null||i.value<t)&&(t=i.value)}return Number.isFinite(r)&&Number.isFinite(t)}}Qg.create=e=>new Qg({checks:[],typeName:Dr.ZodNumber,coerce:e?.coerce||!1,...Gr(e)});class Zg extends hi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==Ut.bigint)return this._getInvalidInput(t);let i;const n=new dl;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(i=this._getOrReturnCtx(t,i),Rt(i,{code:yt.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),n.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(i=this._getOrReturnCtx(t,i),Rt(i,{code:yt.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),n.dirty()):s.kind==="multipleOf"?t.data%s.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),Rt(i,{code:yt.not_multiple_of,multipleOf:s.value,message:s.message}),n.dirty()):mi.assertNever(s);return{status:n.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return Rt(r,{code:yt.invalid_type,expected:Ut.bigint,received:r.parsedType}),Mr}gte(t,r){return this.setLimit("min",t,!0,Ht.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Ht.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Ht.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Ht.toString(r))}setLimit(t,r,i,n){return new Zg({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:Ht.toString(n)}]})}_addCheck(t){return new Zg({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ht.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ht.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ht.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ht.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Ht.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Zg.create=e=>new Zg({checks:[],typeName:Dr.ZodBigInt,coerce:e?.coerce??!1,...Gr(e)});class dP extends hi{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==Ut.boolean){const i=this._getOrReturnCtx(t);return Rt(i,{code:yt.invalid_type,expected:Ut.boolean,received:i.parsedType}),Mr}return Ql(t.data)}}dP.create=e=>new dP({typeName:Dr.ZodBoolean,coerce:e?.coerce||!1,...Gr(e)});class bx extends hi{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==Ut.date){const s=this._getOrReturnCtx(t);return Rt(s,{code:yt.invalid_type,expected:Ut.date,received:s.parsedType}),Mr}if(Number.isNaN(t.data.getTime())){const s=this._getOrReturnCtx(t);return Rt(s,{code:yt.invalid_date}),Mr}const i=new dl;let n;for(const s of this._def.checks)s.kind==="min"?t.data.getTime()<s.value&&(n=this._getOrReturnCtx(t,n),Rt(n,{code:yt.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),i.dirty()):s.kind==="max"?t.data.getTime()>s.value&&(n=this._getOrReturnCtx(t,n),Rt(n,{code:yt.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),i.dirty()):mi.assertNever(s);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new bx({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:Ht.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:Ht.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}bx.create=e=>new bx({checks:[],coerce:e?.coerce||!1,typeName:Dr.ZodDate,...Gr(e)});class BK extends hi{_parse(t){if(this._getType(t)!==Ut.symbol){const i=this._getOrReturnCtx(t);return Rt(i,{code:yt.invalid_type,expected:Ut.symbol,received:i.parsedType}),Mr}return Ql(t.data)}}BK.create=e=>new BK({typeName:Dr.ZodSymbol,...Gr(e)});class FK extends hi{_parse(t){if(this._getType(t)!==Ut.undefined){const i=this._getOrReturnCtx(t);return Rt(i,{code:yt.invalid_type,expected:Ut.undefined,received:i.parsedType}),Mr}return Ql(t.data)}}FK.create=e=>new FK({typeName:Dr.ZodUndefined,...Gr(e)});class VK extends hi{_parse(t){if(this._getType(t)!==Ut.null){const i=this._getOrReturnCtx(t);return Rt(i,{code:yt.invalid_type,expected:Ut.null,received:i.parsedType}),Mr}return Ql(t.data)}}VK.create=e=>new VK({typeName:Dr.ZodNull,...Gr(e)});class UK extends hi{constructor(){super(...arguments),this._any=!0}_parse(t){return Ql(t.data)}}UK.create=e=>new UK({typeName:Dr.ZodAny,...Gr(e)});class HK extends hi{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ql(t.data)}}HK.create=e=>new HK({typeName:Dr.ZodUnknown,...Gr(e)});class Bp extends hi{_parse(t){const r=this._getOrReturnCtx(t);return Rt(r,{code:yt.invalid_type,expected:Ut.never,received:r.parsedType}),Mr}}Bp.create=e=>new Bp({typeName:Dr.ZodNever,...Gr(e)});class GK extends hi{_parse(t){if(this._getType(t)!==Ut.undefined){const i=this._getOrReturnCtx(t);return Rt(i,{code:yt.invalid_type,expected:Ut.void,received:i.parsedType}),Mr}return Ql(t.data)}}GK.create=e=>new GK({typeName:Dr.ZodVoid,...Gr(e)});class Uu extends hi{_parse(t){const{ctx:r,status:i}=this._processInputParams(t),n=this._def;if(r.parsedType!==Ut.array)return Rt(r,{code:yt.invalid_type,expected:Ut.array,received:r.parsedType}),Mr;if(n.exactLength!==null){const a=r.data.length>n.exactLength.value,o=r.data.length<n.exactLength.value;(a||o)&&(Rt(r,{code:a?yt.too_big:yt.too_small,minimum:o?n.exactLength.value:void 0,maximum:a?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),i.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(Rt(r,{code:yt.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),i.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(Rt(r,{code:yt.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),i.dirty()),r.common.async)return Promise.all([...r.data].map((a,o)=>n.type._parseAsync(new zp(r,a,r.path,o)))).then(a=>dl.mergeArray(i,a));const s=[...r.data].map((a,o)=>n.type._parseSync(new zp(r,a,r.path,o)));return dl.mergeArray(i,s)}get element(){return this._def.type}min(t,r){return new Uu({...this._def,minLength:{value:t,message:Ht.toString(r)}})}max(t,r){return new Uu({...this._def,maxLength:{value:t,message:Ht.toString(r)}})}length(t,r){return new Uu({...this._def,exactLength:{value:t,message:Ht.toString(r)}})}nonempty(t){return this.min(1,t)}}Uu.create=(e,t)=>new Uu({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Dr.ZodArray,...Gr(t)});function oy(e){if(e instanceof ts){const t={};for(const r in e.shape){const i=e.shape[r];t[r]=Ap.create(oy(i))}return new ts({...e._def,shape:()=>t})}else return e instanceof Uu?new Uu({...e._def,type:oy(e.element)}):e instanceof Ap?Ap.create(oy(e.unwrap())):e instanceof Sx?Sx.create(oy(e.unwrap())):e instanceof Jg?Jg.create(e.items.map(t=>oy(t))):e}class ts extends hi{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=mi.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==Ut.object){const c=this._getOrReturnCtx(t);return Rt(c,{code:yt.invalid_type,expected:Ut.object,received:c.parsedType}),Mr}const{status:i,ctx:n}=this._processInputParams(t),{shape:s,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof Bp&&this._def.unknownKeys==="strip"))for(const c in n.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=s[c],d=n.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new zp(n,d,n.path,c)),alwaysSet:c in n.data})}if(this._def.catchall instanceof Bp){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:n.data[u]}});else if(c==="strict")o.length>0&&(Rt(n,{code:yt.unrecognized_keys,keys:o}),i.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=n.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new zp(n,d,n.path,u)),alwaysSet:u in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,f=await u.value;c.push({key:d,value:f,alwaysSet:u.alwaysSet})}return c}).then(c=>dl.mergeObjectSync(i,c)):dl.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(t){return Ht.errToObj,new ts({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,i)=>{const n=this._def.errorMap?.(r,i).message??i.defaultError;return r.code==="unrecognized_keys"?{message:Ht.errToObj(t).message??n}:{message:n}}}:{}})}strip(){return new ts({...this._def,unknownKeys:"strip"})}passthrough(){return new ts({...this._def,unknownKeys:"passthrough"})}extend(t){return new ts({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new ts({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Dr.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new ts({...this._def,catchall:t})}pick(t){const r={};for(const i of mi.objectKeys(t))t[i]&&this.shape[i]&&(r[i]=this.shape[i]);return new ts({...this._def,shape:()=>r})}omit(t){const r={};for(const i of mi.objectKeys(this.shape))t[i]||(r[i]=this.shape[i]);return new ts({...this._def,shape:()=>r})}deepPartial(){return oy(this)}partial(t){const r={};for(const i of mi.objectKeys(this.shape)){const n=this.shape[i];t&&!t[i]?r[i]=n:r[i]=n.optional()}return new ts({...this._def,shape:()=>r})}required(t){const r={};for(const i of mi.objectKeys(this.shape))if(t&&!t[i])r[i]=this.shape[i];else{let s=this.shape[i];for(;s instanceof Ap;)s=s._def.innerType;r[i]=s}return new ts({...this._def,shape:()=>r})}keyof(){return Ule(mi.objectKeys(this.shape))}}ts.create=(e,t)=>new ts({shape:()=>e,unknownKeys:"strip",catchall:Bp.create(),typeName:Dr.ZodObject,...Gr(t)});ts.strictCreate=(e,t)=>new ts({shape:()=>e,unknownKeys:"strict",catchall:Bp.create(),typeName:Dr.ZodObject,...Gr(t)});ts.lazycreate=(e,t)=>new ts({shape:e,unknownKeys:"strip",catchall:Bp.create(),typeName:Dr.ZodObject,...Gr(t)});class hP extends hi{_parse(t){const{ctx:r}=this._processInputParams(t),i=this._def.options;function n(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return r.common.issues.push(...o.ctx.common.issues),o.result;const a=s.map(o=>new Bh(o.ctx.common.issues));return Rt(r,{code:yt.invalid_union,unionErrors:a}),Mr}if(r.common.async)return Promise.all(i.map(async s=>{const a={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}})).then(n);{let s;const a=[];for(const l of i){const c={...r,common:{...r.common,issues:[]},parent:null},u=l._parseSync({data:r.data,path:r.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(l=>new Bh(l));return Rt(r,{code:yt.invalid_union,unionErrors:o}),Mr}}get options(){return this._def.options}}hP.create=(e,t)=>new hP({options:e,typeName:Dr.ZodUnion,...Gr(t)});function z5(e,t){const r=$f(e),i=$f(t);if(e===t)return{valid:!0,data:e};if(r===Ut.object&&i===Ut.object){const n=mi.objectKeys(t),s=mi.objectKeys(e).filter(o=>n.indexOf(o)!==-1),a={...e,...t};for(const o of s){const l=z5(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(r===Ut.array&&i===Ut.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let s=0;s<e.length;s++){const a=e[s],o=t[s],l=z5(a,o);if(!l.valid)return{valid:!1};n.push(l.data)}return{valid:!0,data:n}}else return r===Ut.date&&i===Ut.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class fP extends hi{_parse(t){const{status:r,ctx:i}=this._processInputParams(t),n=(s,a)=>{if(jK(s)||jK(a))return Mr;const o=z5(s.value,a.value);return o.valid?((LK(s)||LK(a))&&r.dirty(),{status:r.value,value:o.data}):(Rt(i,{code:yt.invalid_intersection_types}),Mr)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([s,a])=>n(s,a)):n(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}fP.create=(e,t,r)=>new fP({left:e,right:t,typeName:Dr.ZodIntersection,...Gr(r)});class Jg extends hi{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Ut.array)return Rt(i,{code:yt.invalid_type,expected:Ut.array,received:i.parsedType}),Mr;if(i.data.length<this._def.items.length)return Rt(i,{code:yt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Mr;!this._def.rest&&i.data.length>this._def.items.length&&(Rt(i,{code:yt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const s=[...i.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new zp(i,a,i.path,o)):null}).filter(a=>!!a);return i.common.async?Promise.all(s).then(a=>dl.mergeArray(r,a)):dl.mergeArray(r,s)}get items(){return this._def.items}rest(t){return new Jg({...this._def,rest:t})}}Jg.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Jg({items:e,typeName:Dr.ZodTuple,rest:null,...Gr(t)})};class WK extends hi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Ut.map)return Rt(i,{code:yt.invalid_type,expected:Ut.map,received:i.parsedType}),Mr;const n=this._def.keyType,s=this._def.valueType,a=[...i.data.entries()].map(([o,l],c)=>({key:n._parse(new zp(i,o,i.path,[c,"key"])),value:s._parse(new zp(i,l,i.path,[c,"value"]))}));if(i.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return Mr;(c.status==="dirty"||u.status==="dirty")&&r.dirty(),o.set(c.value,u.value)}return{status:r.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return Mr;(c.status==="dirty"||u.status==="dirty")&&r.dirty(),o.set(c.value,u.value)}return{status:r.value,value:o}}}}WK.create=(e,t,r)=>new WK({valueType:t,keyType:e,typeName:Dr.ZodMap,...Gr(r)});class K2 extends hi{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==Ut.set)return Rt(i,{code:yt.invalid_type,expected:Ut.set,received:i.parsedType}),Mr;const n=this._def;n.minSize!==null&&i.data.size<n.minSize.value&&(Rt(i,{code:yt.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&i.data.size>n.maxSize.value&&(Rt(i,{code:yt.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());const s=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return Mr;u.status==="dirty"&&r.dirty(),c.add(u.value)}return{status:r.value,value:c}}const o=[...i.data.values()].map((l,c)=>s._parse(new zp(i,l,i.path,c)));return i.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,r){return new K2({...this._def,minSize:{value:t,message:Ht.toString(r)}})}max(t,r){return new K2({...this._def,maxSize:{value:t,message:Ht.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}K2.create=(e,t)=>new K2({valueType:e,minSize:null,maxSize:null,typeName:Dr.ZodSet,...Gr(t)});class qK extends hi{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}qK.create=(e,t)=>new qK({getter:e,typeName:Dr.ZodLazy,...Gr(t)});class YK extends hi{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return Rt(r,{received:r.data,code:yt.invalid_literal,expected:this._def.value}),Mr}return{status:"valid",value:t.data}}get value(){return this._def.value}}YK.create=(e,t)=>new YK({value:e,typeName:Dr.ZodLiteral,...Gr(t)});function Ule(e,t){return new wx({values:e,typeName:Dr.ZodEnum,...Gr(t)})}class wx extends hi{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),i=this._def.values;return Rt(r,{expected:mi.joinValues(i),received:r.parsedType,code:yt.invalid_type}),Mr}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),i=this._def.values;return Rt(r,{received:r.data,code:yt.invalid_enum_value,options:i}),Mr}return Ql(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return wx.create(t,{...this._def,...r})}exclude(t,r=this._def){return wx.create(this.options.filter(i=>!t.includes(i)),{...this._def,...r})}}wx.create=Ule;class XK extends hi{_parse(t){const r=mi.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(t);if(i.parsedType!==Ut.string&&i.parsedType!==Ut.number){const n=mi.objectValues(r);return Rt(i,{expected:mi.joinValues(n),received:i.parsedType,code:yt.invalid_type}),Mr}if(this._cache||(this._cache=new Set(mi.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const n=mi.objectValues(r);return Rt(i,{received:i.data,code:yt.invalid_enum_value,options:n}),Mr}return Ql(t.data)}get enum(){return this._def.values}}XK.create=(e,t)=>new XK({values:e,typeName:Dr.ZodNativeEnum,...Gr(t)});class pP extends hi{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==Ut.promise&&r.common.async===!1)return Rt(r,{code:yt.invalid_type,expected:Ut.promise,received:r.parsedType}),Mr;const i=r.parsedType===Ut.promise?r.data:Promise.resolve(r.data);return Ql(i.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}}pP.create=(e,t)=>new pP({type:e,typeName:Dr.ZodPromise,...Gr(t)});class _x extends hi{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Dr.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:i}=this._processInputParams(t),n=this._def.effect||null,s={addIssue:a=>{Rt(i,a),a.fatal?r.abort():r.dirty()},get path(){return i.path}};if(s.addIssue=s.addIssue.bind(s),n.type==="preprocess"){const a=n.transform(i.data,s);if(i.common.async)return Promise.resolve(a).then(async o=>{if(r.value==="aborted")return Mr;const l=await this._def.schema._parseAsync({data:o,path:i.path,parent:i});return l.status==="aborted"?Mr:l.status==="dirty"||r.value==="dirty"?Tw(l.value):l});{if(r.value==="aborted")return Mr;const o=this._def.schema._parseSync({data:a,path:i.path,parent:i});return o.status==="aborted"?Mr:o.status==="dirty"||r.value==="dirty"?Tw(o.value):o}}if(n.type==="refinement"){const a=o=>{const l=n.refinement(o,s);if(i.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(i.common.async===!1){const o=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return o.status==="aborted"?Mr:(o.status==="dirty"&&r.dirty(),a(o.value),{status:r.value,value:o.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(o=>o.status==="aborted"?Mr:(o.status==="dirty"&&r.dirty(),a(o.value).then(()=>({status:r.value,value:o.value}))))}if(n.type==="transform")if(i.common.async===!1){const a=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!xx(a))return Mr;const o=n.transform(a.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:o}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(a=>xx(a)?Promise.resolve(n.transform(a.value,s)).then(o=>({status:r.value,value:o})):Mr);mi.assertNever(n)}}_x.create=(e,t,r)=>new _x({schema:e,typeName:Dr.ZodEffects,effect:t,...Gr(r)});_x.createWithPreprocess=(e,t,r)=>new _x({schema:t,effect:{type:"preprocess",transform:e},typeName:Dr.ZodEffects,...Gr(r)});class Ap extends hi{_parse(t){return this._getType(t)===Ut.undefined?Ql(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ap.create=(e,t)=>new Ap({innerType:e,typeName:Dr.ZodOptional,...Gr(t)});class Sx extends hi{_parse(t){return this._getType(t)===Ut.null?Ql(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Sx.create=(e,t)=>new Sx({innerType:e,typeName:Dr.ZodNullable,...Gr(t)});class B5 extends hi{_parse(t){const{ctx:r}=this._processInputParams(t);let i=r.data;return r.parsedType===Ut.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}B5.create=(e,t)=>new B5({innerType:e,typeName:Dr.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Gr(t)});class F5 extends hi{_parse(t){const{ctx:r}=this._processInputParams(t),i={...r,common:{...r.common,issues:[]}},n=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return uP(n)?n.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Bh(i.common.issues)},input:i.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Bh(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}F5.create=(e,t)=>new F5({innerType:e,typeName:Dr.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Gr(t)});class $K extends hi{_parse(t){if(this._getType(t)!==Ut.nan){const i=this._getOrReturnCtx(t);return Rt(i,{code:yt.invalid_type,expected:Ut.nan,received:i.parsedType}),Mr}return{status:"valid",value:t.data}}}$K.create=e=>new $K({typeName:Dr.ZodNaN,...Gr(e)});class EYe extends hi{_parse(t){const{ctx:r}=this._processInputParams(t),i=r.data;return this._def.type._parse({data:i,path:r.path,parent:r})}unwrap(){return this._def.type}}class EF extends hi{_parse(t){const{status:r,ctx:i}=this._processInputParams(t);if(i.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return s.status==="aborted"?Mr:s.status==="dirty"?(r.dirty(),Tw(s.value)):this._def.out._parseAsync({data:s.value,path:i.path,parent:i})})();{const n=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return n.status==="aborted"?Mr:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:i.path,parent:i})}}static create(t,r){return new EF({in:t,out:r,typeName:Dr.ZodPipeline})}}class V5 extends hi{_parse(t){const r=this._def.innerType._parse(t),i=n=>(xx(n)&&(n.value=Object.freeze(n.value)),n);return uP(r)?r.then(n=>i(n)):i(r)}unwrap(){return this._def.innerType}}V5.create=(e,t)=>new V5({innerType:e,typeName:Dr.ZodReadonly,...Gr(t)});var Dr;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Dr||(Dr={}));const on=bh.create;Qg.create;Zg.create;dP.create;bx.create;Bp.create;const Hle=Uu.create,x0=ts.create;hP.create;fP.create;Jg.create;const AYe=wx.create;pP.create;Ap.create;Sx.create;const Gle={string:e=>bh.create({...e,coerce:!0}),number:e=>Qg.create({...e,coerce:!0}),boolean:e=>dP.create({...e,coerce:!0}),bigint:e=>Zg.create({...e,coerce:!0}),date:e=>bx.create({...e,coerce:!0})};var Wle={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},KK=Ot.createContext&&Ot.createContext(Wle),CYe=["attr","size","title"];function TYe(e,t){if(e==null)return{};var r=MYe(e,t),i,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function MYe(e,t){if(e==null)return{};var r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;r[i]=e[i]}return r}function mP(){return mP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},mP.apply(this,arguments)}function QK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function gP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QK(Object(r),!0).forEach(function(i){PYe(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QK(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function PYe(e,t,r){return t=DYe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DYe(e){var t=NYe(e,"string");return typeof t=="symbol"?t:t+""}function NYe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var i=r.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qle(e){return e&&e.map((t,r)=>Ot.createElement(t.tag,gP({key:r},t.attr),qle(t.child)))}function wn(e){return t=>Ot.createElement(kYe,mP({attr:gP({},e.attr)},t),qle(e.child))}function kYe(e){var t=r=>{var{attr:i,size:n,title:s}=e,a=TYe(e,CYe),o=n||r.size||"1em",l;return r.className&&(l=r.className),e.className&&(l=(l?l+" ":"")+e.className),Ot.createElement("svg",mP({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:l,style:gP(gP({color:e.color||r.color},r.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&Ot.createElement("title",null,s),e.children)};return KK!==void 0?Ot.createElement(KK.Consumer,null,r=>t(r)):t(Wle)}function Yle(e){return wn({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 0 0 0-51.5zm-63.57-320.64L836 122.88a8 8 0 0 0-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 0 0 0 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 0 0 0 11.31L155.17 889a8 8 0 0 0 11.31 0l712.15-712.12a8 8 0 0 0 0-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 0 0-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 0 1 146.2-106.69L401.31 546.2A112 112 0 0 1 396 512z"},child:[]},{tag:"path",attr:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 0 0 227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 0 1-112 112z"},child:[]}]})(e)}function Xle(e){return wn({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 0 0 0 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"},child:[]}]})(e)}function $le(e){return wn({attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`},child:[]},{tag:"path",attr:{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`},child:[]},{tag:"path",attr:{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`},child:[]},{tag:"path",attr:{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`},child:[]}]})(e)}function Kle(e){return wn({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(e)}function RYe(e){return wn({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M277.74 312.9c9.8-6.7 23.4-12.5 23.4-12.5s-38.7 7-77.2 10.2c-47.1 3.9-97.7 4.7-123.1 1.3-60.1-8 33-30.1 33-30.1s-36.1-2.4-80.6 19c-52.5 25.4 130 37 224.5 12.1zm-85.4-32.1c-19-42.7-83.1-80.2 0-145.8C296 53.2 242.84 0 242.84 0c21.5 84.5-75.6 110.1-110.7 162.6-23.9 35.9 11.7 74.4 60.2 118.2zm114.6-176.2c.1 0-175.2 43.8-91.5 140.2 24.7 28.4-6.5 54-6.5 54s62.7-32.4 33.9-72.9c-26.9-37.8-47.5-56.6 64.1-121.3zm-6.1 270.5a12.19 12.19 0 0 1-2 2.6c128.3-33.7 81.1-118.9 19.8-97.3a17.33 17.33 0 0 0-8.2 6.3 70.45 70.45 0 0 1 11-3c31-6.5 75.5 41.5-20.6 91.4zM348 437.4s14.5 11.9-15.9 21.2c-57.9 17.5-240.8 22.8-291.6.7-18.3-7.9 16-19 26.8-21.3 11.2-2.4 17.7-2 17.7-2-20.3-14.3-131.3 28.1-56.4 40.2C232.84 509.4 401 461.3 348 437.4zM124.44 396c-78.7 22 47.9 67.4 148.1 24.5a185.89 185.89 0 0 1-28.2-13.8c-44.7 8.5-65.4 9.1-106 4.5-33.5-3.8-13.9-15.2-13.9-15.2zm179.8 97.2c-78.7 14.8-175.8 13.1-233.3 3.6 0-.1 11.8 9.7 72.4 13.6 92.2 5.9 233.8-3.3 237.1-46.9 0 0-6.4 16.5-76.2 29.7zM260.64 353c-59.2 11.4-93.5 11.1-136.8 6.6-33.5-3.5-11.6-19.7-11.6-19.7-86.8 28.8 48.2 61.4 169.5 25.9a60.37 60.37 0 0 1-21.1-12.8z"},child:[]}]})(e)}function IYe(e){return wn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM243.8 381.4c0 43.6-25.6 63.5-62.9 63.5-33.7 0-53.2-17.4-63.2-38.5l34.3-20.7c6.6 11.7 12.6 21.6 27.1 21.6 13.8 0 22.6-5.4 22.6-26.5V237.7h42.1v143.7zm99.6 63.5c-39.1 0-64.4-18.6-76.7-43l34.3-19.8c9 14.7 20.8 25.6 41.5 25.6 17.4 0 28.6-8.7 28.6-20.8 0-14.4-11.4-19.5-30.7-28l-10.5-4.5c-30.4-12.9-50.5-29.2-50.5-63.5 0-31.6 24.1-55.6 61.6-55.6 26.8 0 46 9.3 59.8 33.7L368 290c-7.2-12.9-15-18-27.1-18-12.3 0-20.1 7.8-20.1 18 0 12.6 7.8 17.7 25.9 25.6l10.5 4.5c35.8 15.3 55.9 31 55.9 66.2 0 37.8-29.8 58.6-69.7 58.6z"},child:[]}]})(e)}function OYe(e){return wn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"},child:[]}]})(e)}function jYe(e){return wn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function LYe(e){return wn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z"},child:[]}]})(e)}function Qle(e){return wn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(e)}function Zle(e){return wn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"},child:[]}]})(e)}function zYe(e){return wn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function BYe(e){return wn({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M216 23.86c0-23.8-30.65-32.77-44.15-13.04C48 191.85 224 200 224 288c0 35.63-29.11 64.46-64.85 63.99-35.17-.45-63.15-29.77-63.15-64.94v-85.51c0-21.7-26.47-32.23-41.43-16.5C27.8 213.16 0 261.33 0 320c0 105.87 86.13 192 192 192s192-86.13 192-192c0-170.29-168-193-168-296.14z"},child:[]}]})(e)}function ZK(e){return wn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 176.001C512 273.203 433.202 352 336 352c-11.22 0-22.19-1.062-32.827-3.069l-24.012 27.014A23.999 23.999 0 0 1 261.223 384H224v40c0 13.255-10.745 24-24 24h-40v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-78.059c0-6.365 2.529-12.47 7.029-16.971l161.802-161.802C163.108 213.814 160 195.271 160 176 160 78.798 238.797.001 335.999 0 433.488-.001 512 78.511 512 176.001zM336 128c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z"},child:[]}]})(e)}function FYe(e){return wn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(e)}function Jle(e){return wn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"},child:[]}]})(e)}function VYe(e){return wn({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function UYe(e){return wn({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M552 64H448V24c0-13.3-10.7-24-24-24H152c-13.3 0-24 10.7-24 24v40H24C10.7 64 0 74.7 0 88v56c0 35.7 22.5 72.4 61.9 100.7 31.5 22.7 69.8 37.1 110 41.7C203.3 338.5 240 360 240 360v72h-48c-35.3 0-64 20.7-64 56v12c0 6.6 5.4 12 12 12h296c6.6 0 12-5.4 12-12v-12c0-35.3-28.7-56-64-56h-48v-72s36.7-21.5 68.1-73.6c40.3-4.6 78.6-19 110-41.7 39.3-28.3 61.9-65 61.9-100.7V88c0-13.3-10.7-24-24-24zM99.3 192.8C74.9 175.2 64 155.6 64 144v-16h64.2c1 32.6 5.8 61.2 12.8 86.2-15.1-5.2-29.2-12.4-41.7-21.4zM512 144c0 16.1-17.7 36.1-35.3 48.8-12.5 9-26.7 16.2-41.8 21.4 7-25 11.8-53.6 12.8-86.2H512v16z"},child:[]}]})(e)}function HYe(e){return wn({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.8 458.1L362.3 248.3C412.1 230.7 448 183.8 448 128 448 57.3 390.7 0 320 0c-67.1 0-121.5 51.8-126.9 117.4L45.5 3.4C38.5-2 28.5-.8 23 6.2L3.4 31.4c-5.4 7-4.2 17 2.8 22.4l588.4 454.7c7 5.4 17 4.2 22.5-2.8l19.6-25.3c5.4-6.8 4.1-16.9-2.9-22.3zM96 422.4V464c0 26.5 21.5 48 48 48h350.2L207.4 290.3C144.2 301.3 96 356 96 422.4z"},child:[]}]})(e)}function GYe(e){return wn({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}const nD="/assets/logo-BTsHBo5O.png",WYe=()=>{};var JK={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ece=function(e){const t=[];let r=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);n<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=n&63|128):(n&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(n=65536+((n&1023)<<10)+(e.charCodeAt(++i)&1023),t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=n&63|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=n&63|128)}return t},qYe=function(e){const t=[];let r=0,i=0;for(;r<e.length;){const n=e[r++];if(n<128)t[i++]=String.fromCharCode(n);else if(n>191&&n<224){const s=e[r++];t[i++]=String.fromCharCode((n&31)<<6|s&63)}else if(n>239&&n<365){const s=e[r++],a=e[r++],o=e[r++],l=((n&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{const s=e[r++],a=e[r++];t[i++]=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63)}}return t.join("")},tce={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let n=0;n<e.length;n+=3){const s=e[n],a=n+1<e.length,o=a?e[n+1]:0,l=n+2<e.length,c=l?e[n+2]:0,u=s>>2,d=(s&3)<<4|o>>4;let f=(o&15)<<2|c>>6,m=c&63;l||(m=64,a||(f=64)),i.push(r[u],r[d],r[f],r[m])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(ece(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):qYe(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let n=0;n<e.length;){const s=r[e.charAt(n++)],o=n<e.length?r[e.charAt(n)]:0;++n;const c=n<e.length?r[e.charAt(n)]:64;++n;const d=n<e.length?r[e.charAt(n)]:64;if(++n,s==null||o==null||c==null||d==null)throw new YYe;const f=s<<2|o>>4;if(i.push(f),c!==64){const m=o<<4&240|c>>2;if(i.push(m),d!==64){const v=c<<6&192|d;i.push(v)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class YYe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const XYe=function(e){const t=ece(e);return tce.encodeByteArray(t,!0)},vP=function(e){return XYe(e).replace(/\./g,"")},rce=function(e){try{return tce.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $Ye(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KYe=()=>$Ye().__FIREBASE_DEFAULTS__,QYe=()=>{if(typeof process>"u"||typeof JK>"u")return;const e=JK.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},ZYe=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&rce(e[1]);return t&&JSON.parse(t)},sD=()=>{try{return WYe()||KYe()||QYe()||ZYe()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},ice=e=>{var t,r;return(r=(t=sD())===null||t===void 0?void 0:t.emulatorHosts)===null||r===void 0?void 0:r[e]},JYe=e=>{const t=ice(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(r+1),10);return t[0]==="["?[t.substring(1,r-1),i]:[t.substring(0,r),i]},nce=()=>{var e;return(e=sD())===null||e===void 0?void 0:e.config},sce=e=>{var t;return(t=sD())===null||t===void 0?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eXe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}wrapCallback(t){return(r,i)=>{r?this.reject(r):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(r):t(r,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ob(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ace(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tXe(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},i=t||"demo-project",n=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:n,exp:n+3600,auth_time:n,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[vP(JSON.stringify(r)),vP(JSON.stringify(a)),""].join(".")}const a2={};function rXe(){const e={prod:[],emulator:[]};for(const t of Object.keys(a2))a2[t]?e.emulator.push(t):e.prod.push(t);return e}function iXe(e){let t=document.getElementById(e),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),r=!0),{created:r,element:t}}let eQ=!1;function oce(e,t){if(typeof window>"u"||typeof document>"u"||!ob(window.location.host)||a2[e]===t||a2[e]||eQ)return;a2[e]=t;function r(f){return`__firebase__banner__${f}`}const i="__firebase__banner",s=rXe().prod.length>0;function a(){const f=document.getElementById(i);f&&f.remove()}function o(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{eQ=!0,a()},f}function u(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=iXe(i),m=r("text"),v=document.getElementById(m)||document.createElement("span"),y=r("learnmore"),x=document.getElementById(y)||document.createElement("a"),w=r("preprendIcon"),_=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const S=f.element;o(S),u(x,y);const P=c();l(_,w),S.append(_,v,x,P),document.body.appendChild(S)}s?(v.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,v.innerText="Preview backend running in this workspace."),v.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nXe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Va())}function sXe(){var e;const t=(e=sD())===null||e===void 0?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function aXe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function oXe(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function lXe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cXe(){const e=Va();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function uXe(){return!sXe()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function dXe(){try{return typeof indexedDB=="object"}catch{return!1}}function hXe(){return new Promise((e,t)=>{try{let r=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(i),e(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{var s;t(((s=n.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){t(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fXe="FirebaseError";class Zh extends Error{constructor(t,r,i){super(r),this.code=t,this.customData=i,this.name=fXe,Object.setPrototypeOf(this,Zh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$_.prototype.create)}}class $_{constructor(t,r,i){this.service=t,this.serviceName=r,this.errors=i}create(t,...r){const i=r[0]||{},n=`${this.service}/${t}`,s=this.errors[t],a=s?pXe(s,i):"Error",o=`${this.serviceName}: ${a} (${n}).`;return new Zh(n,o,i)}}function pXe(e,t){return e.replace(mXe,(r,i)=>{const n=t[i];return n!=null?String(n):`<${i}?>`})}const mXe=/\{\$([^}]+)}/g;function gXe(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Fp(e,t){if(e===t)return!0;const r=Object.keys(e),i=Object.keys(t);for(const n of r){if(!i.includes(n))return!1;const s=e[n],a=t[n];if(tQ(s)&&tQ(a)){if(!Fp(s,a))return!1}else if(s!==a)return!1}for(const n of i)if(!r.includes(n))return!1;return!0}function tQ(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K_(e){const t=[];for(const[r,i]of Object.entries(e))Array.isArray(i)?i.forEach(n=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function vXe(e,t){const r=new yXe(e,t);return r.subscribe.bind(r)}class yXe{constructor(t,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(r=>{r.next(t)})}error(t){this.forEachObserver(r=>{r.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,r,i){let n;if(t===void 0&&r===void 0&&i===void 0)throw new Error("Missing Observer.");xXe(t,["next","error","complete"])?n=t:n={next:t,error:r,complete:i},n.next===void 0&&(n.next=qI),n.error===void 0&&(n.error=qI),n.complete===void 0&&(n.complete=qI);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch{}}),this.observers.push(n),s}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,t)}sendOne(t,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{r(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xXe(e,t){if(typeof e!="object"||e===null)return!1;for(const r of t)if(r in e&&typeof e[r]=="function")return!0;return!1}function qI(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jo(e){return e&&e._delegate?e._delegate:e}class e0{constructor(t,r,i){this.name=t,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jm="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bXe{constructor(t,r){this.name=t,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const r=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(r)){const i=new eXe;if(this.instancesDeferred.set(r,i),this.isInitialized(r)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:r});n&&i.resolve(n)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(t){var r;const i=this.normalizeInstanceIdentifier(t?.identifier),n=(r=t?.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(_Xe(t))try{this.getOrInitializeService({instanceIdentifier:Jm})}catch{}for(const[r,i]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(r);try{const s=this.getOrInitializeService({instanceIdentifier:n});i.resolve(s)}catch{}}}}clearInstance(t=Jm){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Jm){return this.instances.has(t)}getOptions(t=Jm){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:r={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const n=this.getOrInitializeService({instanceIdentifier:i,options:r});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);i===o&&a.resolve(n)}return n}onInit(t,r){var i;const n=this.normalizeInstanceIdentifier(r),s=(i=this.onInitCallbacks.get(n))!==null&&i!==void 0?i:new Set;s.add(t),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&t(a,n),()=>{s.delete(t)}}invokeOnInitCallbacks(t,r){const i=this.onInitCallbacks.get(r);if(i)for(const n of i)try{n(t,r)}catch{}}getOrInitializeService({instanceIdentifier:t,options:r={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:wXe(t),options:r}),this.instances.set(t,i),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Jm){return this.component?this.component.multipleInstances?t:Jm:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wXe(e){return e===Jm?void 0:e}function _Xe(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SXe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const r=this.getProvider(t.name);if(r.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);r.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const r=new bXe(t,this);return this.providers.set(t,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kr;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Kr||(Kr={}));const EXe={debug:Kr.DEBUG,verbose:Kr.VERBOSE,info:Kr.INFO,warn:Kr.WARN,error:Kr.ERROR,silent:Kr.SILENT},AXe=Kr.INFO,CXe={[Kr.DEBUG]:"log",[Kr.VERBOSE]:"log",[Kr.INFO]:"info",[Kr.WARN]:"warn",[Kr.ERROR]:"error"},TXe=(e,t,...r)=>{if(t<e.logLevel)return;const i=new Date().toISOString(),n=CXe[t];if(n)console[n](`[${i}]  ${e.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class AF{constructor(t){this.name=t,this._logLevel=AXe,this._logHandler=TXe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Kr))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?EXe[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Kr.DEBUG,...t),this._logHandler(this,Kr.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Kr.VERBOSE,...t),this._logHandler(this,Kr.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Kr.INFO,...t),this._logHandler(this,Kr.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Kr.WARN,...t),this._logHandler(this,Kr.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Kr.ERROR,...t),this._logHandler(this,Kr.ERROR,...t)}}const MXe=(e,t)=>t.some(r=>e instanceof r);let rQ,iQ;function PXe(){return rQ||(rQ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DXe(){return iQ||(iQ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lce=new WeakMap,U5=new WeakMap,cce=new WeakMap,YI=new WeakMap,CF=new WeakMap;function NXe(e){const t=new Promise((r,i)=>{const n=()=>{e.removeEventListener("success",s),e.removeEventListener("error",a)},s=()=>{r(Cp(e.result)),n()},a=()=>{i(e.error),n()};e.addEventListener("success",s),e.addEventListener("error",a)});return t.then(r=>{r instanceof IDBCursor&&lce.set(r,e)}).catch(()=>{}),CF.set(t,e),t}function kXe(e){if(U5.has(e))return;const t=new Promise((r,i)=>{const n=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",a),e.removeEventListener("abort",a)},s=()=>{r(),n()},a=()=>{i(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",s),e.addEventListener("error",a),e.addEventListener("abort",a)});U5.set(e,t)}let H5={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return U5.get(e);if(t==="objectStoreNames")return e.objectStoreNames||cce.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Cp(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function RXe(e){H5=e(H5)}function IXe(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...r){const i=e.call(XI(this),t,...r);return cce.set(i,t.sort?t.sort():[t]),Cp(i)}:DXe().includes(e)?function(...t){return e.apply(XI(this),t),Cp(lce.get(this))}:function(...t){return Cp(e.apply(XI(this),t))}}function OXe(e){return typeof e=="function"?IXe(e):(e instanceof IDBTransaction&&kXe(e),MXe(e,PXe())?new Proxy(e,H5):e)}function Cp(e){if(e instanceof IDBRequest)return NXe(e);if(YI.has(e))return YI.get(e);const t=OXe(e);return t!==e&&(YI.set(e,t),CF.set(t,e)),t}const XI=e=>CF.get(e);function jXe(e,t,{blocked:r,upgrade:i,blocking:n,terminated:s}={}){const a=indexedDB.open(e,t),o=Cp(a);return i&&a.addEventListener("upgradeneeded",l=>{i(Cp(a.result),l.oldVersion,l.newVersion,Cp(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{s&&l.addEventListener("close",()=>s()),n&&l.addEventListener("versionchange",c=>n(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const LXe=["get","getKey","getAll","getAllKeys","count"],zXe=["put","add","delete","clear"],$I=new Map;function nQ(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if($I.get(t))return $I.get(t);const r=t.replace(/FromIndex$/,""),i=t!==r,n=zXe.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(n||LXe.includes(r)))return;const s=async function(a,...o){const l=this.transaction(a,n?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),n&&l.done]))[0]};return $I.set(t,s),s}RXe(e=>({...e,get:(t,r,i)=>nQ(t,r)||e.get(t,r,i),has:(t,r)=>!!nQ(t,r)||e.has(t,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BXe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(FXe(r)){const i=r.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(r=>r).join(" ")}}function FXe(e){const t=e.getComponent();return t?.type==="VERSION"}const G5="@firebase/app",sQ="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh=new AF("@firebase/app"),VXe="@firebase/app-compat",UXe="@firebase/analytics-compat",HXe="@firebase/analytics",GXe="@firebase/app-check-compat",WXe="@firebase/app-check",qXe="@firebase/auth",YXe="@firebase/auth-compat",XXe="@firebase/database",$Xe="@firebase/data-connect",KXe="@firebase/database-compat",QXe="@firebase/functions",ZXe="@firebase/functions-compat",JXe="@firebase/installations",e$e="@firebase/installations-compat",t$e="@firebase/messaging",r$e="@firebase/messaging-compat",i$e="@firebase/performance",n$e="@firebase/performance-compat",s$e="@firebase/remote-config",a$e="@firebase/remote-config-compat",o$e="@firebase/storage",l$e="@firebase/storage-compat",c$e="@firebase/firestore",u$e="@firebase/ai",d$e="@firebase/firestore-compat",h$e="firebase",f$e="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W5="[DEFAULT]",p$e={[G5]:"fire-core",[VXe]:"fire-core-compat",[HXe]:"fire-analytics",[UXe]:"fire-analytics-compat",[WXe]:"fire-app-check",[GXe]:"fire-app-check-compat",[qXe]:"fire-auth",[YXe]:"fire-auth-compat",[XXe]:"fire-rtdb",[$Xe]:"fire-data-connect",[KXe]:"fire-rtdb-compat",[QXe]:"fire-fn",[ZXe]:"fire-fn-compat",[JXe]:"fire-iid",[e$e]:"fire-iid-compat",[t$e]:"fire-fcm",[r$e]:"fire-fcm-compat",[i$e]:"fire-perf",[n$e]:"fire-perf-compat",[s$e]:"fire-rc",[a$e]:"fire-rc-compat",[o$e]:"fire-gcs",[l$e]:"fire-gcs-compat",[c$e]:"fire-fst",[d$e]:"fire-fst-compat",[u$e]:"fire-vertex","fire-js":"fire-js",[h$e]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP=new Map,m$e=new Map,q5=new Map;function aQ(e,t){try{e.container.addComponent(t)}catch(r){Fh.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function Ex(e){const t=e.name;if(q5.has(t))return Fh.debug(`There were multiple attempts to register component ${t}.`),!1;q5.set(t,e);for(const r of yP.values())aQ(r,e);for(const r of m$e.values())aQ(r,e);return!0}function TF(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function wc(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g$e={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Tp=new $_("app","Firebase",g$e);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v$e{constructor(t,r,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new e0("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Tp.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lb=f$e;function uce(e,t={}){let r=e;typeof t!="object"&&(t={name:t});const i=Object.assign({name:W5,automaticDataCollectionEnabled:!0},t),n=i.name;if(typeof n!="string"||!n)throw Tp.create("bad-app-name",{appName:String(n)});if(r||(r=nce()),!r)throw Tp.create("no-options");const s=yP.get(n);if(s){if(Fp(r,s.options)&&Fp(i,s.config))return s;throw Tp.create("duplicate-app",{appName:n})}const a=new SXe(n);for(const l of q5.values())a.addComponent(l);const o=new v$e(r,i,a);return yP.set(n,o),o}function dce(e=W5){const t=yP.get(e);if(!t&&e===W5&&nce())return uce();if(!t)throw Tp.create("no-app",{appName:e});return t}function Mp(e,t,r){var i;let n=(i=p$e[e])!==null&&i!==void 0?i:e;r&&(n+=`-${r}`);const s=n.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const o=[`Unable to register library "${n}" with version "${t}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Fh.warn(o.join(" "));return}Ex(new e0(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y$e="firebase-heartbeat-database",x$e=1,Q2="firebase-heartbeat-store";let KI=null;function hce(){return KI||(KI=jXe(y$e,x$e,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Q2)}catch(r){console.warn(r)}}}}).catch(e=>{throw Tp.create("idb-open",{originalErrorMessage:e.message})})),KI}async function b$e(e){try{const r=(await hce()).transaction(Q2),i=await r.objectStore(Q2).get(fce(e));return await r.done,i}catch(t){if(t instanceof Zh)Fh.warn(t.message);else{const r=Tp.create("idb-get",{originalErrorMessage:t?.message});Fh.warn(r.message)}}}async function oQ(e,t){try{const i=(await hce()).transaction(Q2,"readwrite");await i.objectStore(Q2).put(t,fce(e)),await i.done}catch(r){if(r instanceof Zh)Fh.warn(r.message);else{const i=Tp.create("idb-set",{originalErrorMessage:r?.message});Fh.warn(i.message)}}}function fce(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w$e=1024,_$e=30;class S$e{constructor(t){this.container=t,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new A$e(r),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,r;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=lQ();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats.length>_$e){const a=C$e(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Fh.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=lQ(),{heartbeatsToSend:i,unsentEntries:n}=E$e(this._heartbeatsCache.heartbeats),s=vP(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=r,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(r){return Fh.warn(r),""}}}function lQ(){return new Date().toISOString().substring(0,10)}function E$e(e,t=w$e){const r=[];let i=e.slice();for(const n of e){const s=r.find(a=>a.agent===n.agent);if(s){if(s.dates.push(n.date),cQ(r)>t){s.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),cQ(r)>t){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}class A$e{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dXe()?hXe().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await b$e(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var r;if(await this._canUseIndexedDBPromise){const n=await this.read();return oQ(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var r;if(await this._canUseIndexedDBPromise){const n=await this.read();return oQ(this.app,{lastSentHeartbeatDate:(r=t.lastSentHeartbeatDate)!==null&&r!==void 0?r:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function cQ(e){return vP(JSON.stringify({version:2,heartbeats:e})).length}function C$e(e){if(e.length===0)return-1;let t=0,r=e[0].date;for(let i=1;i<e.length;i++)e[i].date<r&&(r=e[i].date,t=i);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T$e(e){Ex(new e0("platform-logger",t=>new BXe(t),"PRIVATE")),Ex(new e0("heartbeat",t=>new S$e(t),"PRIVATE")),Mp(G5,sQ,e),Mp(G5,sQ,"esm2017"),Mp("fire-js","")}T$e("");var Ru=function(){return Ru=Object.assign||function(t){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ru.apply(this,arguments)};function Q_(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r}function M$e(e,t,r){if(r||arguments.length===2)for(var i=0,n=t.length,s;i<n;i++)(s||!(i in t))&&(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return e.concat(s||Array.prototype.slice.call(t))}function pce(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const P$e=pce,mce=new $_("auth","Firebase",pce());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP=new AF("@firebase/auth");function D$e(e,...t){xP.logLevel<=Kr.WARN&&xP.warn(`Auth (${lb}): ${e}`,...t)}function wT(e,...t){xP.logLevel<=Kr.ERROR&&xP.error(`Auth (${lb}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(e,...t){throw PF(e,...t)}function kc(e,...t){return PF(e,...t)}function MF(e,t,r){const i=Object.assign(Object.assign({},P$e()),{[t]:r});return new $_("auth","Firebase",i).create(t,{appName:e.name})}function kg(e){return MF(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function N$e(e,t,r){const i=r;if(!(t instanceof i))throw i.name!==t.constructor.name&&nd(e,"argument-error"),MF(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function PF(e,...t){if(typeof e!="string"){const r=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(r,...i)}return mce.create(e,...t)}function _r(e,t,...r){if(!e)throw PF(t,...r)}function wh(e){const t="INTERNAL ASSERTION FAILED: "+e;throw wT(t),new Error(t)}function Vh(e,t){e||wh(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.href)||""}function k$e(){return uQ()==="http:"||uQ()==="https:"}function uQ(){var e;return typeof self<"u"&&((e=self.location)===null||e===void 0?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R$e(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(k$e()||oXe()||"connection"in navigator)?navigator.onLine:!0}function I$e(){if(typeof navigator>"u")return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(t,r){this.shortDelay=t,this.longDelay=r,Vh(r>t,"Short delay should be less than long delay!"),this.isMobile=nXe()||lXe()}get(){return R$e()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DF(e,t){Vh(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gce{static initialize(t,r,i){this.fetchImpl=t,r&&(this.headersImpl=r),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wh("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wh("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wh("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O$e={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j$e=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],L$e=new Z_(3e4,6e4);function NF(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function cb(e,t,r,i,n={}){return vce(e,n,async()=>{let s={},a={};i&&(t==="GET"?a=i:s={body:JSON.stringify(i)});const o=K_(Object.assign({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},s);return aXe()||(c.referrerPolicy="no-referrer"),e.emulatorConfig&&ob(e.emulatorConfig.host)&&(c.credentials="include"),gce.fetch()(await yce(e,e.config.apiHost,r,o),c)})}async function vce(e,t,r){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},O$e),t);try{const n=new B$e(e),s=await Promise.race([r(),n.promise]);n.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw gC(e,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw gC(e,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw gC(e,"email-already-in-use",a);if(l==="USER_DISABLED")throw gC(e,"user-disabled",a);const u=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw MF(e,u,c);nd(e,u)}}catch(n){if(n instanceof Zh)throw n;nd(e,"network-request-failed",{message:String(n)})}}async function z$e(e,t,r,i,n={}){const s=await cb(e,t,r,i,n);return"mfaPendingCredential"in s&&nd(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function yce(e,t,r,i){const n=`${t}${r}?${i}`,s=e,a=s.config.emulator?DF(e.config,n):`${e.config.apiScheme}://${n}`;return j$e.includes(r)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}class B$e{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((r,i)=>{this.timer=setTimeout(()=>i(kc(this.auth,"network-request-failed")),L$e.get())})}}function gC(e,t,r){const i={appName:e.name};r.email&&(i.email=r.email),r.phoneNumber&&(i.phoneNumber=r.phoneNumber);const n=kc(e,t,i);return n.customData._tokenResponse=r,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F$e(e,t){return cb(e,"POST","/v1/accounts:delete",t)}async function bP(e,t){return cb(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function V$e(e,t=!1){const r=jo(e),i=await r.getIdToken(t),n=kF(i);_r(n&&n.exp&&n.auth_time&&n.iat,r.auth,"internal-error");const s=typeof n.firebase=="object"?n.firebase:void 0,a=s?.sign_in_provider;return{claims:n,token:i,authTime:o2(QI(n.auth_time)),issuedAtTime:o2(QI(n.iat)),expirationTime:o2(QI(n.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}}function QI(e){return Number(e)*1e3}function kF(e){const[t,r,i]=e.split(".");if(t===void 0||r===void 0||i===void 0)return wT("JWT malformed, contained fewer than 3 sections"),null;try{const n=rce(r);return n?JSON.parse(n):(wT("Failed to decode base64 JWT payload"),null)}catch(n){return wT("Caught error parsing JWT payload as JSON",n?.toString()),null}}function dQ(e){const t=kF(e);return _r(t,"internal-error"),_r(typeof t.exp<"u","internal-error"),_r(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z2(e,t,r=!1){if(r)return t;try{return await t}catch(i){throw i instanceof Zh&&U$e(i)&&e.auth.currentUser===e&&await e.auth.signOut(),i}}function U$e({code:e}){return e==="auth/user-disabled"||e==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H$e{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var r;if(t){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const n=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,n)}}schedule(t=!1){if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(t,r){this.createdAt=t,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=o2(this.lastLoginAt),this.creationTime=o2(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wP(e){var t;const r=e.auth,i=await e.getIdToken(),n=await Z2(e,bP(r,{idToken:i}));_r(n?.users.length,r,"internal-error");const s=n.users[0];e._notifyReloadListener(s);const a=!((t=s.providerUserInfo)===null||t===void 0)&&t.length?xce(s.providerUserInfo):[],o=W$e(e.providerData,a),l=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!o?.length,u=l?c:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new X5(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(e,d)}async function G$e(e){const t=jo(e);await wP(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function W$e(e,t){return[...e.filter(i=>!t.some(n=>n.providerId===i.providerId)),...t]}function xce(e){return e.map(t=>{var{providerId:r}=t,i=Q_(t,["providerId"]);return{providerId:r,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q$e(e,t){const r=await vce(e,{},async()=>{const i=K_({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:s}=e.config,a=await yce(e,n,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:i};return e.emulatorConfig&&ob(e.emulatorConfig.host)&&(l.credentials="include"),gce.fetch()(a,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function Y$e(e,t){return cb(e,"POST","/v2/accounts:revokeToken",NF(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){_r(t.idToken,"internal-error"),_r(typeof t.idToken<"u","internal-error"),_r(typeof t.refreshToken<"u","internal-error");const r="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):dQ(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,r)}updateFromIdToken(t){_r(t.length!==0,"internal-error");const r=dQ(t);this.updateTokensAndExpiration(t,null,r)}async getToken(t,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(_r(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,r){const{accessToken:i,refreshToken:n,expiresIn:s}=await q$e(t,r);this.updateTokensAndExpiration(i,n,Number(s))}updateTokensAndExpiration(t,r,i){this.refreshToken=r||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,r){const{refreshToken:i,accessToken:n,expirationTime:s}=r,a=new Gy;return i&&(_r(typeof i=="string","internal-error",{appName:t}),a.refreshToken=i),n&&(_r(typeof n=="string","internal-error",{appName:t}),a.accessToken=n),s&&(_r(typeof s=="number","internal-error",{appName:t}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Gy,this.toJSON())}_performRefresh(){return wh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(e,t){_r(typeof e=="string"||typeof e>"u","internal-error",{appName:t})}class Tc{constructor(t){var{uid:r,auth:i,stsTokenManager:n}=t,s=Q_(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new H$e(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=i,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new X5(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const r=await Z2(this,this.stsTokenManager.getToken(this.auth,t));return _r(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(t){return V$e(this,t)}reload(){return G$e(this)}_assign(t){this!==t&&(_r(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(r=>Object.assign({},r)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const r=new Tc(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(t){_r(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,r=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),r&&await wP(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wc(this.auth.app))return Promise.reject(kg(this.auth));const t=await this.getIdToken();return await Z2(this,F$e(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,r){var i,n,s,a,o,l,c,u;const d=(i=r.displayName)!==null&&i!==void 0?i:void 0,f=(n=r.email)!==null&&n!==void 0?n:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,v=(a=r.photoURL)!==null&&a!==void 0?a:void 0,y=(o=r.tenantId)!==null&&o!==void 0?o:void 0,x=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,w=(c=r.createdAt)!==null&&c!==void 0?c:void 0,_=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:S,emailVerified:P,isAnonymous:M,providerData:C,stsTokenManager:T}=r;_r(S&&T,t,"internal-error");const E=Gy.fromJSON(this.name,T);_r(typeof S=="string",t,"internal-error"),Vf(d,t.name),Vf(f,t.name),_r(typeof P=="boolean",t,"internal-error"),_r(typeof M=="boolean",t,"internal-error"),Vf(m,t.name),Vf(v,t.name),Vf(y,t.name),Vf(x,t.name),Vf(w,t.name),Vf(_,t.name);const N=new Tc({uid:S,auth:t,email:f,emailVerified:P,displayName:d,isAnonymous:M,photoURL:v,phoneNumber:m,tenantId:y,stsTokenManager:E,createdAt:w,lastLoginAt:_});return C&&Array.isArray(C)&&(N.providerData=C.map(D=>Object.assign({},D))),x&&(N._redirectEventId=x),N}static async _fromIdTokenResponse(t,r,i=!1){const n=new Gy;n.updateFromServerResponse(r);const s=new Tc({uid:r.localId,auth:t,stsTokenManager:n,isAnonymous:i});return await wP(s),s}static async _fromGetAccountInfoResponse(t,r,i){const n=r.users[0];_r(n.localId!==void 0,"internal-error");const s=n.providerUserInfo!==void 0?xce(n.providerUserInfo):[],a=!(n.email&&n.passwordHash)&&!s?.length,o=new Gy;o.updateFromIdToken(i);const l=new Tc({uid:n.localId,auth:t,stsTokenManager:o,isAnonymous:a}),c={uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:s,metadata:new X5(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!s?.length};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hQ=new Map;function _h(e){Vh(e instanceof Function,"Expected a class definition");let t=hQ.get(e);return t?(Vh(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,hQ.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bce{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){const r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}bce.type="NONE";const fQ=bce;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(e,t,r){return`firebase:${e}:${t}:${r}`}class Wy{constructor(t,r,i){this.persistence=t,this.auth=r,this.userKey=i;const{config:n,name:s}=this.auth;this.fullUserKey=_T(this.userKey,n.apiKey,s),this.fullPersistenceKey=_T("persistence",n.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const r=await bP(this.auth,{idToken:t}).catch(()=>{});return r?Tc._fromGetAccountInfoResponse(this.auth,r,t):null}return Tc._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,r,i="authUser"){if(!r.length)return new Wy(_h(fQ),t,i);const n=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=n[0]||_h(fQ);const a=_T(i,t.config.apiKey,t.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){let d;if(typeof u=="string"){const f=await bP(t,{idToken:u}).catch(()=>{});if(!f)break;d=await Tc._fromGetAccountInfoResponse(t,f,u)}else d=Tc._fromJSON(t,u);c!==s&&(o=d),s=c;break}}catch{}const l=n.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Wy(s,t,i):(s=l[0],o&&await s._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==s)try{await c._remove(a)}catch{}})),new Wy(s,t,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pQ(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ece(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(wce(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Cce(t))return"Blackberry";if(Tce(t))return"Webos";if(_ce(t))return"Safari";if((t.includes("chrome/")||Sce(t))&&!t.includes("edge/"))return"Chrome";if(Ace(t))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=e.match(r);if(i?.length===2)return i[1]}return"Other"}function wce(e=Va()){return/firefox\//i.test(e)}function _ce(e=Va()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Sce(e=Va()){return/crios\//i.test(e)}function Ece(e=Va()){return/iemobile/i.test(e)}function Ace(e=Va()){return/android/i.test(e)}function Cce(e=Va()){return/blackberry/i.test(e)}function Tce(e=Va()){return/webos/i.test(e)}function RF(e=Va()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function X$e(e=Va()){var t;return RF(e)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function $$e(){return cXe()&&document.documentMode===10}function Mce(e=Va()){return RF(e)||Ace(e)||Tce(e)||Cce(e)||/windows phone/i.test(e)||Ece(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pce(e,t=[]){let r;switch(e){case"Browser":r=pQ(Va());break;case"Worker":r=`${pQ(Va())}-${e}`;break;default:r=e}const i=t.length?t.join(","):"FirebaseCore-web";return`${r}/JsCore/${lb}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K$e{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,r){const i=s=>new Promise((a,o)=>{try{const l=t(s);a(l)}catch(l){o(l)}});i.onAbort=r,this.queue.push(i);const n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const r=[];try{for(const i of this.queue)await i(t),i.onAbort&&r.push(i.onAbort)}catch(i){r.reverse();for(const n of r)try{n()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q$e(e,t={}){return cb(e,"GET","/v2/passwordPolicy",NF(e,t))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z$e=6;class J$e{constructor(t){var r,i,n,s;const a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:Z$e,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(n=(i=t.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&n!==void 0?n:"",this.forceUpgradeOnSignin=(s=t.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var r,i,n,s,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,l),this.validatePasswordCharacterOptions(t,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(n=l.containsLowercaseLetter)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(t,r){const i=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;i&&(r.meetsMinPasswordLength=t.length>=i),n&&(r.meetsMaxPasswordLength=t.length<=n)}validatePasswordCharacterOptions(t,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let i;for(let n=0;n<t.length;n++)i=t.charAt(n),this.updatePasswordCharacterOptionsStatuses(r,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,r,i,n,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eKe{constructor(t,r,i,n){this.app=t,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=i,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mQ(this),this.idTokenSubscription=new mQ(this),this.beforeStateQueue=new K$e(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mce,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=n.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(t,r){return r&&(this._popupRedirectResolver=_h(r)),this._initializationPromise=this.queue(async()=>{var i,n,s;if(!this._deleted&&(this.persistenceManager=await Wy.create(this,t),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const r=await bP(this,{idToken:t}),i=await Tc._fromGetAccountInfoResponse(this,r,t);await this.directlySetCurrentUser(i)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var r;if(wc(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let n=i,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=n?._redirectEventId,l=await this.tryRedirectSignIn(t);(!a||a===o)&&l?.user&&(n=l.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(a){n=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return _r(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(t){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(t){try{await wP(t)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=I$e()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(wc(this.app))return Promise.reject(kg(this));const r=t?jo(t):null;return r&&_r(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(t,r=!1){if(!this._deleted)return t&&_r(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return wc(this.app)?Promise.reject(kg(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return wc(this.app)?Promise.reject(kg(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_h(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await Q$e(this),r=new J$e(t);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new $_("auth","Firebase",t())}onAuthStateChanged(t,r,i){return this.registerStateListener(this.authStateSubscription,t,r,i)}beforeAuthStateChanged(t,r){return this.beforeStateQueue.pushCallback(t,r)}onIdTokenChanged(t,r,i){return this.registerStateListener(this.idTokenSubscription,t,r,i)}authStateReady(){return new Promise((t,r)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},r)}})}async revokeAccessToken(t){if(this.currentUser){const r=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:r};this.tenantId!=null&&(i.tenantId=this.tenantId),await Y$e(this,i)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,r){const i=await this.getOrInitRedirectPersistenceManager(r);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const r=t&&_h(t)||this._popupRedirectResolver;_r(r,this,"argument-error"),this.redirectPersistenceManager=await Wy.create(this,[_h(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var r,i;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===t?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(r=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,r,i,n){if(this._deleted)return()=>{};const s=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(_r(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){const l=t.addObserver(r,i,n);return()=>{a=!0,l()}}else{const l=t.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return _r(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Pce(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const i=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());i&&(r["X-Firebase-Client"]=i);const n=await this._getAppCheckToken();return n&&(r["X-Firebase-AppCheck"]=n),r}async _getAppCheckToken(){var t;if(wc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return r?.error&&D$e(`Error while retrieving App Check token: ${r.error}`),r?.token}}function aD(e){return jo(e)}class mQ{constructor(t){this.auth=t,this.observer=null,this.addObserver=vXe(r=>this.observer=r)}get next(){return _r(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let IF={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tKe(e){IF=e}function rKe(e){return IF.loadJS(e)}function iKe(){return IF.gapiScript}function nKe(e){return`__${e}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sKe(e,t){const r=TF(e,"auth");if(r.isInitialized()){const n=r.getImmediate(),s=r.getOptions();if(Fp(s,t??{}))return n;nd(n,"already-initialized")}return r.initialize({options:t})}function aKe(e,t){const r=t?.persistence||[],i=(Array.isArray(r)?r:[r]).map(_h);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,t?.popupRedirectResolver)}function oKe(e,t,r){const i=aD(e);_r(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const n=!1,s=Dce(t),{host:a,port:o}=lKe(t),l=o===null?"":`:${o}`,c={url:`${s}//${a}${l}/`},u=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:n})});if(!i._canInitEmulator){_r(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),_r(Fp(c,i.config.emulator)&&Fp(u,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=c,i.emulatorConfig=u,i.settings.appVerificationDisabledForTesting=!0,ob(a)?(ace(`${s}//${a}${l}`),oce("Auth",!0)):cKe()}function Dce(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function lKe(e){const t=Dce(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const i=r[2].split("@").pop()||"",n=/^(\[[^\]]+\])(:|$)/.exec(i);if(n){const s=n[1];return{host:s,port:gQ(i.substr(s.length+1))}}else{const[s,a]=i.split(":");return{host:s,port:gQ(a)}}}function gQ(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function cKe(){function e(){const t=document.createElement("p"),r=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",e):e())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nce{constructor(t,r){this.providerId=t,this.signInMethod=r}toJSON(){return wh("not implemented")}_getIdTokenResponse(t){return wh("not implemented")}_linkToIdToken(t,r){return wh("not implemented")}_getReauthenticationResolver(t){return wh("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qy(e,t){return z$e(e,"POST","/v1/accounts:signInWithIdp",NF(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uKe="http://localhost";class t0 extends Nce{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const r=new t0(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(r.idToken=t.idToken),t.accessToken&&(r.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(r.nonce=t.nonce),t.pendingToken&&(r.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(r.accessToken=t.oauthToken,r.secret=t.oauthTokenSecret):nd("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const r=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:n}=r,s=Q_(r,["providerId","signInMethod"]);if(!i||!n)return null;const a=new t0(i,n);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(t){const r=this.buildRequest();return qy(t,r)}_linkToIdToken(t,r){const i=this.buildRequest();return i.idToken=r,qy(t,i)}_getReauthenticationResolver(t){const r=this.buildRequest();return r.autoCreate=!1,qy(t,r)}buildRequest(){const t={requestUri:uKe,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),t.postBody=K_(r)}return t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OF{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_ extends OF{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip extends J_{constructor(){super("facebook.com")}static credential(t){return t0._fromParams({providerId:ip.PROVIDER_ID,signInMethod:ip.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return ip.credentialFromTaggedObject(t)}static credentialFromError(t){return ip.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return ip.credential(t.oauthAccessToken)}catch{return null}}}ip.FACEBOOK_SIGN_IN_METHOD="facebook.com";ip.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh extends J_{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return t0._fromParams({providerId:uh.PROVIDER_ID,signInMethod:uh.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return uh.credentialFromTaggedObject(t)}static credentialFromError(t){return uh.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return uh.credential(r,i)}catch{return null}}}uh.GOOGLE_SIGN_IN_METHOD="google.com";uh.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh extends J_{constructor(){super("github.com")}static credential(t){return t0._fromParams({providerId:dh.PROVIDER_ID,signInMethod:dh.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return dh.credentialFromTaggedObject(t)}static credentialFromError(t){return dh.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return dh.credential(t.oauthAccessToken)}catch{return null}}}dh.GITHUB_SIGN_IN_METHOD="github.com";dh.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np extends J_{constructor(){super("twitter.com")}static credential(t,r){return t0._fromParams({providerId:np.PROVIDER_ID,signInMethod:np.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:r})}static credentialFromResult(t){return np.credentialFromTaggedObject(t)}static credentialFromError(t){return np.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:i}=t;if(!r||!i)return null;try{return np.credential(r,i)}catch{return null}}}np.TWITTER_SIGN_IN_METHOD="twitter.com";np.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,r,i,n=!1){const s=await Tc._fromIdTokenResponse(t,i,n),a=vQ(i);return new Ax({user:s,providerId:a,_tokenResponse:i,operationType:r})}static async _forOperation(t,r,i){await t._updateTokensIfNecessary(i,!0);const n=vQ(i);return new Ax({user:t,providerId:n,_tokenResponse:i,operationType:r})}}function vQ(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P extends Zh{constructor(t,r,i,n){var s;super(r.code,r.message),this.operationType=i,this.user=n,Object.setPrototypeOf(this,_P.prototype),this.customData={appName:t.name,tenantId:(s=t.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,r,i,n){return new _P(t,r,i,n)}}function kce(e,t,r,i){return(t==="reauthenticate"?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?_P._fromErrorAndOperation(e,s,t,i):s})}async function dKe(e,t,r=!1){const i=await Z2(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return Ax._forOperation(e,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hKe(e,t,r=!1){const{auth:i}=e;if(wc(i.app))return Promise.reject(kg(i));const n="reauthenticate";try{const s=await Z2(e,kce(i,n,t,e),r);_r(s.idToken,i,"internal-error");const a=kF(s.idToken);_r(a,i,"internal-error");const{sub:o}=a;return _r(e.uid===o,i,"user-mismatch"),Ax._forOperation(e,n,s)}catch(s){throw s?.code==="auth/user-not-found"&&nd(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fKe(e,t,r=!1){if(wc(e.app))return Promise.reject(kg(e));const i="signIn",n=await kce(e,i,t),s=await Ax._fromIdTokenResponse(e,i,n);return r||await e._updateCurrentUser(s.user),s}function pKe(e,t,r,i){return jo(e).onIdTokenChanged(t,r,i)}function mKe(e,t,r){return jo(e).beforeAuthStateChanged(t,r)}const SP="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rce{constructor(t,r){this.storageRetriever=t,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(SP,"1"),this.storage.removeItem(SP),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,r){return this.storage.setItem(t,JSON.stringify(r)),Promise.resolve()}_get(t){const r=this.storage.getItem(t);return Promise.resolve(r?JSON.parse(r):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gKe=1e3,vKe=10;class Ice extends Rce{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mce(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const i=this.storage.getItem(r),n=this.localCache[r];i!==n&&t(r,n,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const i=t.key;r?this.detachListener():this.stopPolling();const n=()=>{const a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);$$e()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(n,vKe):n()}notifyListeners(t,r){this.localCache[t]=r;const i=this.listeners[t];if(i)for(const n of Array.from(i))n(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},gKe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){const r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}Ice.type="LOCAL";const yKe=Ice;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oce extends Rce{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}Oce.type="SESSION";const jce=Oce;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xKe(e){return Promise.all(e.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(n=>n.isListeningto(t));if(r)return r;const i=new oD(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const r=t,{eventId:i,eventType:n,data:s}=r.data,a=this.handlersMap[n];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:n});const o=Array.from(a).map(async c=>c(r.origin,s)),l=await xKe(o);r.ports[0].postMessage({status:"done",eventId:i,eventType:n,response:l})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}oD.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jF(e="",t=10){let r="";for(let i=0;i<t;i++)r+=Math.floor(Math.random()*10);return e+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bKe{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,r,i=50){const n=typeof MessageChannel<"u"?new MessageChannel:null;if(!n)throw new Error("connection_unavailable");let s,a;return new Promise((o,l)=>{const c=jF("",20);n.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},i);a={messageChannel:n,onMessage(d){const f=d;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(u),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(f.data.response);break;default:clearTimeout(u),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),n.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:t,eventId:c,data:r},[n.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(){return window}function wKe(e){Hu().location.href=e}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lce(){return typeof Hu().WorkerGlobalScope<"u"&&typeof Hu().importScripts=="function"}async function _Ke(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function SKe(){var e;return((e=navigator?.serviceWorker)===null||e===void 0?void 0:e.controller)||null}function EKe(){return Lce()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zce="firebaseLocalStorageDb",AKe=1,EP="firebaseLocalStorage",Bce="fbase_key";class eS{constructor(t){this.request=t}toPromise(){return new Promise((t,r)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function lD(e,t){return e.transaction([EP],t?"readwrite":"readonly").objectStore(EP)}function CKe(){const e=indexedDB.deleteDatabase(zce);return new eS(e).toPromise()}function $5(){const e=indexedDB.open(zce,AKe);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const i=e.result;try{i.createObjectStore(EP,{keyPath:Bce})}catch(n){r(n)}}),e.addEventListener("success",async()=>{const i=e.result;i.objectStoreNames.contains(EP)?t(i):(i.close(),await CKe(),t(await $5()))})})}async function yQ(e,t,r){const i=lD(e,!0).put({[Bce]:t,value:r});return new eS(i).toPromise()}async function TKe(e,t){const r=lD(e,!1).get(t),i=await new eS(r).toPromise();return i===void 0?null:i.value}function xQ(e,t){const r=lD(e,!0).delete(t);return new eS(r).toPromise()}const MKe=800,PKe=3;class Fce{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await $5(),this.db)}async _withRetries(t){let r=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(r++>PKe)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Lce()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=oD._getInstance(EKe()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await _Ke(),!this.activeServiceWorker)return;this.sender=new bKe(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||SKe()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await $5();return await yQ(t,SP,"1"),await xQ(t,SP),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>yQ(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){const r=await this._withRetries(i=>TKe(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>xQ(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(n=>{const s=lD(n,!1).getAll();return new eS(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const r=[],i=new Set;if(t.length!==0)for(const{fbase_key:n,value:s}of t)i.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(s)&&(this.notifyListeners(n,s),r.push(n));for(const n of Object.keys(this.localCache))this.localCache[n]&&!i.has(n)&&(this.notifyListeners(n,null),r.push(n));return r}notifyListeners(t,r){this.localCache[t]=r;const i=this.listeners[t];if(i)for(const n of Array.from(i))n(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),MKe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Fce.type="LOCAL";const DKe=Fce;new Z_(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vce(e,t){return t?_h(t):(_r(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF extends Nce{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return qy(t,this._buildIdpRequest())}_linkToIdToken(t,r){return qy(t,this._buildIdpRequest(r))}_getReauthenticationResolver(t){return qy(t,this._buildIdpRequest())}_buildIdpRequest(t){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(r.idToken=t),r}}function NKe(e){return fKe(e.auth,new LF(e),e.bypassAuthState)}function kKe(e){const{auth:t,user:r}=e;return _r(r,t,"internal-error"),hKe(r,new LF(e),e.bypassAuthState)}async function RKe(e){const{auth:t,user:r}=e;return _r(r,t,"internal-error"),dKe(r,new LF(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uce{constructor(t,r,i,n,s=!1){this.auth=t,this.resolver=i,this.user=n,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(t,r)=>{this.pendingPromise={resolve:t,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:r,sessionId:i,postBody:n,tenantId:s,error:a,type:o}=t;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:i,tenantId:s||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return NKe;case"linkViaPopup":case"linkViaRedirect":return RKe;case"reauthViaPopup":case"reauthViaRedirect":return kKe;default:nd(this.auth,"internal-error")}}resolve(t){Vh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Vh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IKe=new Z_(2e3,1e4);async function Hce(e,t,r){if(wc(e.app))return Promise.reject(kc(e,"operation-not-supported-in-this-environment"));const i=aD(e);N$e(e,t,OF);const n=Vce(i,r);return new xg(i,"signInViaPopup",t,n).executeNotNull()}class xg extends Uce{constructor(t,r,i,n,s){super(t,r,n,s),this.provider=i,this.authWindow=null,this.pollId=null,xg.currentPopupAction&&xg.currentPopupAction.cancel(),xg.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return _r(t,this.auth,"internal-error"),t}async onExecution(){Vh(this.filter.length===1,"Popup operations only handle one event");const t=jF();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(kc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(kc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xg.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,IKe.get())};t()}}xg.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OKe="pendingRedirect",ST=new Map;class jKe extends Uce{constructor(t,r,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i),this.eventId=null}async execute(){let t=ST.get(this.auth._key());if(!t){try{const i=await LKe(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(r){t=()=>Promise.reject(r)}ST.set(this.auth._key(),t)}return this.bypassAuthState||ST.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const r=await this.auth._redirectUserForId(t.eventId);if(r)return this.user=r,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function LKe(e,t){const r=FKe(t),i=BKe(e);if(!await i._isAvailable())return!1;const n=await i._get(r)==="true";return await i._remove(r),n}function zKe(e,t){ST.set(e._key(),t)}function BKe(e){return _h(e._redirectPersistence)}function FKe(e){return _T(OKe,e.config.apiKey,e.name)}async function VKe(e,t,r=!1){if(wc(e.app))return Promise.reject(kg(e));const i=aD(e),n=Vce(i,t),a=await new jKe(i,n,r).execute();return a&&!r&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,t)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UKe=10*60*1e3;class HKe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let r=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(r=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!GKe(t)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=t,r=!0)),r}sendToConsumer(t,r){var i;if(t.error&&!Gce(t)){const n=((i=t.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";r.onError(kc(this.auth,n))}else r.onAuthEvent(t)}isEventForConsumer(t,r){const i=r.eventId===null||!!t.eventId&&t.eventId===r.eventId;return r.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=UKe&&this.cachedEventUids.clear(),this.cachedEventUids.has(bQ(t))}saveEventToCache(t){this.cachedEventUids.add(bQ(t)),this.lastProcessedEventTime=Date.now()}}function bQ(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(t=>t).join("-")}function Gce({type:e,error:t}){return e==="unknown"&&t?.code==="auth/no-auth-event"}function GKe(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Gce(e);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WKe(e,t={}){return cb(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qKe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,YKe=/^https?/;async function XKe(e){if(e.config.emulator)return;const{authorizedDomains:t}=await WKe(e);for(const r of t)try{if($Ke(r))return}catch{}nd(e,"unauthorized-domain")}function $Ke(e){const t=Y5(),{protocol:r,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return a.hostname===""&&i===""?r==="chrome-extension:"&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===i}if(!YKe.test(r))return!1;if(qKe.test(e))return i===e;const n=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+n+"|"+n+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KKe=new Z_(3e4,6e4);function wQ(){const e=Hu().___jsl;if(e?.H){for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}function QKe(e){return new Promise((t,r)=>{var i,n,s;function a(){wQ(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{wQ(),r(kc(e,"network-request-failed"))},timeout:KKe.get()})}if(!((n=(i=Hu().gapi)===null||i===void 0?void 0:i.iframes)===null||n===void 0)&&n.Iframe)t(gapi.iframes.getContext());else if(!((s=Hu().gapi)===null||s===void 0)&&s.load)a();else{const o=nKe("iframefcb");return Hu()[o]=()=>{gapi.load?a():r(kc(e,"network-request-failed"))},rKe(`${iKe()}?onload=${o}`).catch(l=>r(l))}}).catch(t=>{throw ET=null,t})}let ET=null;function ZKe(e){return ET=ET||QKe(e),ET}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JKe=new Z_(5e3,15e3),eQe="__/auth/iframe",tQe="emulator/auth/iframe",rQe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},iQe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function nQe(e){const t=e.config;_r(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?DF(t,tQe):`https://${e.config.authDomain}/${eQe}`,i={apiKey:t.apiKey,appName:e.name,v:lb},n=iQe.get(e.config.apiHost);n&&(i.eid=n);const s=e._getFrameworks();return s.length&&(i.fw=s.join(",")),`${r}?${K_(i).slice(1)}`}async function sQe(e){const t=await ZKe(e),r=Hu().gapi;return _r(r,e,"internal-error"),t.open({where:document.body,url:nQe(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rQe,dontclear:!0},i=>new Promise(async(n,s)=>{await i.restyle({setHideOnLeave:!1});const a=kc(e,"network-request-failed"),o=Hu().setTimeout(()=>{s(a)},JKe.get());function l(){Hu().clearTimeout(o),n(i)}i.ping(l).then(l,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aQe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},oQe=500,lQe=600,cQe="_blank",uQe="http://localhost";class _Q{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function dQe(e,t,r,i=oQe,n=lQe){const s=Math.max((window.screen.availHeight-n)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let o="";const l=Object.assign(Object.assign({},aQe),{width:i.toString(),height:n.toString(),top:s,left:a}),c=Va().toLowerCase();r&&(o=Sce(c)?cQe:r),wce(c)&&(t=t||uQe,l.scrollbars="yes");const u=Object.entries(l).reduce((f,[m,v])=>`${f}${m}=${v},`,"");if(X$e(c)&&o!=="_self")return hQe(t||"",o),new _Q(null);const d=window.open(t||"",o,u);_r(d,e,"popup-blocked");try{d.focus()}catch{}return new _Q(d)}function hQe(e,t){const r=document.createElement("a");r.href=e,r.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fQe="__/auth/handler",pQe="emulator/auth/handler",mQe=encodeURIComponent("fac");async function SQ(e,t,r,i,n,s){_r(e.config.authDomain,e,"auth-domain-config-required"),_r(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:i,v:lb,eventId:n};if(t instanceof OF){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",gXe(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,d]of Object.entries({}))a[u]=d}if(t instanceof J_){const u=t.getScopes().filter(d=>d!=="");u.length>0&&(a.scopes=u.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${mQe}=${encodeURIComponent(l)}`:"";return`${gQe(e)}?${K_(o).slice(1)}${c}`}function gQe({config:e}){return e.emulator?DF(e,pQe):`https://${e.authDomain}/${fQe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI="webStorageSupport";class vQe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=jce,this._completeRedirectFn=VKe,this._overrideRedirectResult=zKe}async _openPopup(t,r,i,n){var s;Vh((s=this.eventManagers[t._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await SQ(t,r,i,Y5(),n);return dQe(t,a,jF())}async _openRedirect(t,r,i,n){await this._originValidation(t);const s=await SQ(t,r,i,Y5(),n);return wKe(s),new Promise(()=>{})}_initialize(t){const r=t._key();if(this.eventManagers[r]){const{manager:n,promise:s}=this.eventManagers[r];return n?Promise.resolve(n):(Vh(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(t);return this.eventManagers[r]={promise:i},i.catch(()=>{delete this.eventManagers[r]}),i}async initAndGetManager(t){const r=await sQe(t),i=new HKe(t);return r.register("authEvent",n=>(_r(n?.authEvent,t,"invalid-auth-event"),{status:i.onEvent(n.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=r,i}_isIframeWebStorageSupported(t,r){this.iframes[t._key()].send(ZI,{type:ZI},n=>{var s;const a=(s=n?.[0])===null||s===void 0?void 0:s[ZI];a!==void 0&&r(!!a),nd(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const r=t._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=XKe(t)),this.originValidationPromises[r]}get _shouldInitProactively(){return Mce()||_ce()||RF()}}const yQe=vQe;var EQ="@firebase/auth",AQ="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xQe{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const r=this.auth.onIdTokenChanged(i=>{t(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,r),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const r=this.internalListeners.get(t);r&&(this.internalListeners.delete(t),r(),this.updateProactiveRefresh())}assertAuthConfigured(){_r(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bQe(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function wQe(e){Ex(new e0("auth",(t,{options:r})=>{const i=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=i.options;_r(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:a,authDomain:o,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Pce(e)},c=new eKe(i,n,s,l);return aKe(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,r,i)=>{t.getProvider("auth-internal").initialize()})),Ex(new e0("auth-internal",t=>{const r=aD(t.getProvider("auth").getImmediate());return(i=>new xQe(i))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Mp(EQ,AQ,bQe(e)),Mp(EQ,AQ,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _Qe=5*60,SQe=sce("authIdTokenMaxAge")||_Qe;let CQ=null;const EQe=e=>async t=>{const r=t&&await t.getIdTokenResult(),i=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(i&&i>SQe)return;const n=r?.token;CQ!==n&&(CQ=n,await fetch(e,{method:n?"POST":"DELETE",headers:n?{Authorization:`Bearer ${n}`}:{}}))};function AQe(e=dce()){const t=TF(e,"auth");if(t.isInitialized())return t.getImmediate();const r=sKe(e,{popupRedirectResolver:yQe,persistence:[DKe,yKe,jce]}),i=sce("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const a=EQe(s.toString());mKe(r,a,()=>a(r.currentUser)),pKe(r,o=>a(o))}}const n=ice("auth");return n&&oKe(r,`http://${n}`),r}function CQe(){var e,t;return(t=(e=document.getElementsByTagName("head"))===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:document}tKe({loadJS(e){return new Promise((t,r)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=n=>{const s=kc("internal-error");s.customData=n,r(s)},i.type="text/javascript",i.charset="UTF-8",CQe().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});wQe("Browser");var TQe="firebase",MQe="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mp(TQe,MQe,"app");var TQ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pp,Wce;(function(){var e;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(T,E){function N(){}N.prototype=E.prototype,T.D=E.prototype,T.prototype=new N,T.prototype.constructor=T,T.C=function(D,I,j){for(var L=Array(arguments.length-2),B=2;B<arguments.length;B++)L[B-2]=arguments[B];return E.prototype[I].apply(D,L)}}function r(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,r),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function n(T,E,N){N||(N=0);var D=Array(16);if(typeof E=="string")for(var I=0;16>I;++I)D[I]=E.charCodeAt(N++)|E.charCodeAt(N++)<<8|E.charCodeAt(N++)<<16|E.charCodeAt(N++)<<24;else for(I=0;16>I;++I)D[I]=E[N++]|E[N++]<<8|E[N++]<<16|E[N++]<<24;E=T.g[0],N=T.g[1],I=T.g[2];var j=T.g[3],L=E+(j^N&(I^j))+D[0]+3614090360&4294967295;E=N+(L<<7&4294967295|L>>>25),L=j+(I^E&(N^I))+D[1]+3905402710&4294967295,j=E+(L<<12&4294967295|L>>>20),L=I+(N^j&(E^N))+D[2]+606105819&4294967295,I=j+(L<<17&4294967295|L>>>15),L=N+(E^I&(j^E))+D[3]+3250441966&4294967295,N=I+(L<<22&4294967295|L>>>10),L=E+(j^N&(I^j))+D[4]+4118548399&4294967295,E=N+(L<<7&4294967295|L>>>25),L=j+(I^E&(N^I))+D[5]+1200080426&4294967295,j=E+(L<<12&4294967295|L>>>20),L=I+(N^j&(E^N))+D[6]+2821735955&4294967295,I=j+(L<<17&4294967295|L>>>15),L=N+(E^I&(j^E))+D[7]+4249261313&4294967295,N=I+(L<<22&4294967295|L>>>10),L=E+(j^N&(I^j))+D[8]+1770035416&4294967295,E=N+(L<<7&4294967295|L>>>25),L=j+(I^E&(N^I))+D[9]+2336552879&4294967295,j=E+(L<<12&4294967295|L>>>20),L=I+(N^j&(E^N))+D[10]+4294925233&4294967295,I=j+(L<<17&4294967295|L>>>15),L=N+(E^I&(j^E))+D[11]+2304563134&4294967295,N=I+(L<<22&4294967295|L>>>10),L=E+(j^N&(I^j))+D[12]+1804603682&4294967295,E=N+(L<<7&4294967295|L>>>25),L=j+(I^E&(N^I))+D[13]+4254626195&4294967295,j=E+(L<<12&4294967295|L>>>20),L=I+(N^j&(E^N))+D[14]+2792965006&4294967295,I=j+(L<<17&4294967295|L>>>15),L=N+(E^I&(j^E))+D[15]+1236535329&4294967295,N=I+(L<<22&4294967295|L>>>10),L=E+(I^j&(N^I))+D[1]+4129170786&4294967295,E=N+(L<<5&4294967295|L>>>27),L=j+(N^I&(E^N))+D[6]+3225465664&4294967295,j=E+(L<<9&4294967295|L>>>23),L=I+(E^N&(j^E))+D[11]+643717713&4294967295,I=j+(L<<14&4294967295|L>>>18),L=N+(j^E&(I^j))+D[0]+3921069994&4294967295,N=I+(L<<20&4294967295|L>>>12),L=E+(I^j&(N^I))+D[5]+3593408605&4294967295,E=N+(L<<5&4294967295|L>>>27),L=j+(N^I&(E^N))+D[10]+38016083&4294967295,j=E+(L<<9&4294967295|L>>>23),L=I+(E^N&(j^E))+D[15]+3634488961&4294967295,I=j+(L<<14&4294967295|L>>>18),L=N+(j^E&(I^j))+D[4]+3889429448&4294967295,N=I+(L<<20&4294967295|L>>>12),L=E+(I^j&(N^I))+D[9]+568446438&4294967295,E=N+(L<<5&4294967295|L>>>27),L=j+(N^I&(E^N))+D[14]+3275163606&4294967295,j=E+(L<<9&4294967295|L>>>23),L=I+(E^N&(j^E))+D[3]+4107603335&4294967295,I=j+(L<<14&4294967295|L>>>18),L=N+(j^E&(I^j))+D[8]+1163531501&4294967295,N=I+(L<<20&4294967295|L>>>12),L=E+(I^j&(N^I))+D[13]+2850285829&4294967295,E=N+(L<<5&4294967295|L>>>27),L=j+(N^I&(E^N))+D[2]+4243563512&4294967295,j=E+(L<<9&4294967295|L>>>23),L=I+(E^N&(j^E))+D[7]+1735328473&4294967295,I=j+(L<<14&4294967295|L>>>18),L=N+(j^E&(I^j))+D[12]+2368359562&4294967295,N=I+(L<<20&4294967295|L>>>12),L=E+(N^I^j)+D[5]+4294588738&4294967295,E=N+(L<<4&4294967295|L>>>28),L=j+(E^N^I)+D[8]+2272392833&4294967295,j=E+(L<<11&4294967295|L>>>21),L=I+(j^E^N)+D[11]+1839030562&4294967295,I=j+(L<<16&4294967295|L>>>16),L=N+(I^j^E)+D[14]+4259657740&4294967295,N=I+(L<<23&4294967295|L>>>9),L=E+(N^I^j)+D[1]+2763975236&4294967295,E=N+(L<<4&4294967295|L>>>28),L=j+(E^N^I)+D[4]+1272893353&4294967295,j=E+(L<<11&4294967295|L>>>21),L=I+(j^E^N)+D[7]+4139469664&4294967295,I=j+(L<<16&4294967295|L>>>16),L=N+(I^j^E)+D[10]+3200236656&4294967295,N=I+(L<<23&4294967295|L>>>9),L=E+(N^I^j)+D[13]+681279174&4294967295,E=N+(L<<4&4294967295|L>>>28),L=j+(E^N^I)+D[0]+3936430074&4294967295,j=E+(L<<11&4294967295|L>>>21),L=I+(j^E^N)+D[3]+3572445317&4294967295,I=j+(L<<16&4294967295|L>>>16),L=N+(I^j^E)+D[6]+76029189&4294967295,N=I+(L<<23&4294967295|L>>>9),L=E+(N^I^j)+D[9]+3654602809&4294967295,E=N+(L<<4&4294967295|L>>>28),L=j+(E^N^I)+D[12]+3873151461&4294967295,j=E+(L<<11&4294967295|L>>>21),L=I+(j^E^N)+D[15]+530742520&4294967295,I=j+(L<<16&4294967295|L>>>16),L=N+(I^j^E)+D[2]+3299628645&4294967295,N=I+(L<<23&4294967295|L>>>9),L=E+(I^(N|~j))+D[0]+4096336452&4294967295,E=N+(L<<6&4294967295|L>>>26),L=j+(N^(E|~I))+D[7]+1126891415&4294967295,j=E+(L<<10&4294967295|L>>>22),L=I+(E^(j|~N))+D[14]+2878612391&4294967295,I=j+(L<<15&4294967295|L>>>17),L=N+(j^(I|~E))+D[5]+4237533241&4294967295,N=I+(L<<21&4294967295|L>>>11),L=E+(I^(N|~j))+D[12]+1700485571&4294967295,E=N+(L<<6&4294967295|L>>>26),L=j+(N^(E|~I))+D[3]+2399980690&4294967295,j=E+(L<<10&4294967295|L>>>22),L=I+(E^(j|~N))+D[10]+4293915773&4294967295,I=j+(L<<15&4294967295|L>>>17),L=N+(j^(I|~E))+D[1]+2240044497&4294967295,N=I+(L<<21&4294967295|L>>>11),L=E+(I^(N|~j))+D[8]+1873313359&4294967295,E=N+(L<<6&4294967295|L>>>26),L=j+(N^(E|~I))+D[15]+4264355552&4294967295,j=E+(L<<10&4294967295|L>>>22),L=I+(E^(j|~N))+D[6]+2734768916&4294967295,I=j+(L<<15&4294967295|L>>>17),L=N+(j^(I|~E))+D[13]+1309151649&4294967295,N=I+(L<<21&4294967295|L>>>11),L=E+(I^(N|~j))+D[4]+4149444226&4294967295,E=N+(L<<6&4294967295|L>>>26),L=j+(N^(E|~I))+D[11]+3174756917&4294967295,j=E+(L<<10&4294967295|L>>>22),L=I+(E^(j|~N))+D[2]+718787259&4294967295,I=j+(L<<15&4294967295|L>>>17),L=N+(j^(I|~E))+D[9]+3951481745&4294967295,T.g[0]=T.g[0]+E&4294967295,T.g[1]=T.g[1]+(I+(L<<21&4294967295|L>>>11))&4294967295,T.g[2]=T.g[2]+I&4294967295,T.g[3]=T.g[3]+j&4294967295}i.prototype.u=function(T,E){E===void 0&&(E=T.length);for(var N=E-this.blockSize,D=this.B,I=this.h,j=0;j<E;){if(I==0)for(;j<=N;)n(this,T,j),j+=this.blockSize;if(typeof T=="string"){for(;j<E;)if(D[I++]=T.charCodeAt(j++),I==this.blockSize){n(this,D),I=0;break}}else for(;j<E;)if(D[I++]=T[j++],I==this.blockSize){n(this,D),I=0;break}}this.h=I,this.o+=E},i.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var E=1;E<T.length-8;++E)T[E]=0;var N=8*this.o;for(E=T.length-8;E<T.length;++E)T[E]=N&255,N/=256;for(this.u(T),T=Array(16),E=N=0;4>E;++E)for(var D=0;32>D;D+=8)T[N++]=this.g[E]>>>D&255;return T};function s(T,E){var N=o;return Object.prototype.hasOwnProperty.call(N,T)?N[T]:N[T]=E(T)}function a(T,E){this.h=E;for(var N=[],D=!0,I=T.length-1;0<=I;I--){var j=T[I]|0;D&&j==E||(N[I]=j,D=!1)}this.g=N}var o={};function l(T){return-128<=T&&128>T?s(T,function(E){return new a([E|0],0>E?-1:0)}):new a([T|0],0>T?-1:0)}function c(T){if(isNaN(T)||!isFinite(T))return d;if(0>T)return x(c(-T));for(var E=[],N=1,D=0;T>=N;D++)E[D]=T/N|0,N*=4294967296;return new a(E,0)}function u(T,E){if(T.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(T.charAt(0)=="-")return x(u(T.substring(1),E));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=c(Math.pow(E,8)),D=d,I=0;I<T.length;I+=8){var j=Math.min(8,T.length-I),L=parseInt(T.substring(I,I+j),E);8>j?(j=c(Math.pow(E,j)),D=D.j(j).add(c(L))):(D=D.j(N),D=D.add(c(L)))}return D}var d=l(0),f=l(1),m=l(16777216);e=a.prototype,e.m=function(){if(y(this))return-x(this).m();for(var T=0,E=1,N=0;N<this.g.length;N++){var D=this.i(N);T+=(0<=D?D:4294967296+D)*E,E*=4294967296}return T},e.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(v(this))return"0";if(y(this))return"-"+x(this).toString(T);for(var E=c(Math.pow(T,6)),N=this,D="";;){var I=P(N,E).g;N=w(N,I.j(E));var j=((0<N.g.length?N.g[0]:N.h)>>>0).toString(T);if(N=I,v(N))return j+D;for(;6>j.length;)j="0"+j;D=j+D}},e.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function v(T){if(T.h!=0)return!1;for(var E=0;E<T.g.length;E++)if(T.g[E]!=0)return!1;return!0}function y(T){return T.h==-1}e.l=function(T){return T=w(this,T),y(T)?-1:v(T)?0:1};function x(T){for(var E=T.g.length,N=[],D=0;D<E;D++)N[D]=~T.g[D];return new a(N,~T.h).add(f)}e.abs=function(){return y(this)?x(this):this},e.add=function(T){for(var E=Math.max(this.g.length,T.g.length),N=[],D=0,I=0;I<=E;I++){var j=D+(this.i(I)&65535)+(T.i(I)&65535),L=(j>>>16)+(this.i(I)>>>16)+(T.i(I)>>>16);D=L>>>16,j&=65535,L&=65535,N[I]=L<<16|j}return new a(N,N[N.length-1]&-2147483648?-1:0)};function w(T,E){return T.add(x(E))}e.j=function(T){if(v(this)||v(T))return d;if(y(this))return y(T)?x(this).j(x(T)):x(x(this).j(T));if(y(T))return x(this.j(x(T)));if(0>this.l(m)&&0>T.l(m))return c(this.m()*T.m());for(var E=this.g.length+T.g.length,N=[],D=0;D<2*E;D++)N[D]=0;for(D=0;D<this.g.length;D++)for(var I=0;I<T.g.length;I++){var j=this.i(D)>>>16,L=this.i(D)&65535,B=T.i(I)>>>16,q=T.i(I)&65535;N[2*D+2*I]+=L*q,_(N,2*D+2*I),N[2*D+2*I+1]+=j*q,_(N,2*D+2*I+1),N[2*D+2*I+1]+=L*B,_(N,2*D+2*I+1),N[2*D+2*I+2]+=j*B,_(N,2*D+2*I+2)}for(D=0;D<E;D++)N[D]=N[2*D+1]<<16|N[2*D];for(D=E;D<2*E;D++)N[D]=0;return new a(N,0)};function _(T,E){for(;(T[E]&65535)!=T[E];)T[E+1]+=T[E]>>>16,T[E]&=65535,E++}function S(T,E){this.g=T,this.h=E}function P(T,E){if(v(E))throw Error("division by zero");if(v(T))return new S(d,d);if(y(T))return E=P(x(T),E),new S(x(E.g),x(E.h));if(y(E))return E=P(T,x(E)),new S(x(E.g),E.h);if(30<T.g.length){if(y(T)||y(E))throw Error("slowDivide_ only works with positive integers.");for(var N=f,D=E;0>=D.l(T);)N=M(N),D=M(D);var I=C(N,1),j=C(D,1);for(D=C(D,2),N=C(N,2);!v(D);){var L=j.add(D);0>=L.l(T)&&(I=I.add(N),j=L),D=C(D,1),N=C(N,1)}return E=w(T,I.j(E)),new S(I,E)}for(I=d;0<=T.l(E);){for(N=Math.max(1,Math.floor(T.m()/E.m())),D=Math.ceil(Math.log(N)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),j=c(N),L=j.j(E);y(L)||0<L.l(T);)N-=D,j=c(N),L=j.j(E);v(j)&&(j=f),I=I.add(j),T=w(T,L)}return new S(I,T)}e.A=function(T){return P(this,T).h},e.and=function(T){for(var E=Math.max(this.g.length,T.g.length),N=[],D=0;D<E;D++)N[D]=this.i(D)&T.i(D);return new a(N,this.h&T.h)},e.or=function(T){for(var E=Math.max(this.g.length,T.g.length),N=[],D=0;D<E;D++)N[D]=this.i(D)|T.i(D);return new a(N,this.h|T.h)},e.xor=function(T){for(var E=Math.max(this.g.length,T.g.length),N=[],D=0;D<E;D++)N[D]=this.i(D)^T.i(D);return new a(N,this.h^T.h)};function M(T){for(var E=T.g.length+1,N=[],D=0;D<E;D++)N[D]=T.i(D)<<1|T.i(D-1)>>>31;return new a(N,T.h)}function C(T,E){var N=E>>5;E%=32;for(var D=T.g.length-N,I=[],j=0;j<D;j++)I[j]=0<E?T.i(j+N)>>>E|T.i(j+N+1)<<32-E:T.i(j+N);return new a(I,T.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,Wce=i,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,Pp=a}).apply(typeof TQ<"u"?TQ:typeof self<"u"?self:typeof window<"u"?window:{});var vC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qce,Mw,Yce,AT,K5,Xce,$ce,Kce;(function(){var e,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(k,U,K){return k==Array.prototype||k==Object.prototype||(k[U]=K.value),k};function r(k){k=[typeof globalThis=="object"&&globalThis,k,typeof window=="object"&&window,typeof self=="object"&&self,typeof vC=="object"&&vC];for(var U=0;U<k.length;++U){var K=k[U];if(K&&K.Math==Math)return K}throw Error("Cannot find global object")}var i=r(this);function n(k,U){if(U)e:{var K=i;k=k.split(".");for(var ue=0;ue<k.length-1;ue++){var Re=k[ue];if(!(Re in K))break e;K=K[Re]}k=k[k.length-1],ue=K[k],U=U(ue),U!=ue&&U!=null&&t(K,k,{configurable:!0,writable:!0,value:U})}}function s(k,U){k instanceof String&&(k+="");var K=0,ue=!1,Re={next:function(){if(!ue&&K<k.length){var Ye=K++;return{value:U(Ye,k[Ye]),done:!1}}return ue=!0,{done:!0,value:void 0}}};return Re[Symbol.iterator]=function(){return Re},Re}n("Array.prototype.values",function(k){return k||function(){return s(this,function(U,K){return K})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(k){var U=typeof k;return U=U!="object"?U:k?Array.isArray(k)?"array":U:"null",U=="array"||U=="object"&&typeof k.length=="number"}function c(k){var U=typeof k;return U=="object"&&k!=null||U=="function"}function u(k,U,K){return k.call.apply(k.bind,arguments)}function d(k,U,K){if(!k)throw Error();if(2<arguments.length){var ue=Array.prototype.slice.call(arguments,2);return function(){var Re=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Re,ue),k.apply(U,Re)}}return function(){return k.apply(U,arguments)}}function f(k,U,K){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,f.apply(null,arguments)}function m(k,U){var K=Array.prototype.slice.call(arguments,1);return function(){var ue=K.slice();return ue.push.apply(ue,arguments),k.apply(this,ue)}}function v(k,U){function K(){}K.prototype=U.prototype,k.aa=U.prototype,k.prototype=new K,k.prototype.constructor=k,k.Qb=function(ue,Re,Ye){for(var wt=Array(arguments.length-2),ii=2;ii<arguments.length;ii++)wt[ii-2]=arguments[ii];return U.prototype[Re].apply(ue,wt)}}function y(k){const U=k.length;if(0<U){const K=Array(U);for(let ue=0;ue<U;ue++)K[ue]=k[ue];return K}return[]}function x(k,U){for(let K=1;K<arguments.length;K++){const ue=arguments[K];if(l(ue)){const Re=k.length||0,Ye=ue.length||0;k.length=Re+Ye;for(let wt=0;wt<Ye;wt++)k[Re+wt]=ue[wt]}else k.push(ue)}}class w{constructor(U,K){this.i=U,this.j=K,this.h=0,this.g=null}get(){let U;return 0<this.h?(this.h--,U=this.g,this.g=U.next,U.next=null):U=this.i(),U}}function _(k){return/^[\s\xa0]*$/.test(k)}function S(){var k=o.navigator;return k&&(k=k.userAgent)?k:""}function P(k){return P[" "](k),k}P[" "]=function(){};var M=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function C(k,U,K){for(const ue in k)U.call(K,k[ue],ue,k)}function T(k,U){for(const K in k)U.call(void 0,k[K],K,k)}function E(k){const U={};for(const K in k)U[K]=k[K];return U}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(k,U){let K,ue;for(let Re=1;Re<arguments.length;Re++){ue=arguments[Re];for(K in ue)k[K]=ue[K];for(let Ye=0;Ye<N.length;Ye++)K=N[Ye],Object.prototype.hasOwnProperty.call(ue,K)&&(k[K]=ue[K])}}function I(k){var U=1;k=k.split(":");const K=[];for(;0<U&&k.length;)K.push(k.shift()),U--;return k.length&&K.push(k.join(":")),K}function j(k){o.setTimeout(()=>{throw k},0)}function L(){var k=re;let U=null;return k.g&&(U=k.g,k.g=k.g.next,k.g||(k.h=null),U.next=null),U}class B{constructor(){this.h=this.g=null}add(U,K){const ue=q.get();ue.set(U,K),this.h?this.h.next=ue:this.g=ue,this.h=ue}}var q=new w(()=>new G,k=>k.reset());class G{constructor(){this.next=this.g=this.h=null}set(U,K){this.h=U,this.g=K,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,X=!1,re=new B,F=()=>{const k=o.Promise.resolve(void 0);Y=()=>{k.then($)}};var $=()=>{for(var k;k=L();){try{k.h.call(k.g)}catch(K){j(K)}var U=q;U.j(k),100>U.h&&(U.h++,k.next=U.g,U.g=k)}X=!1};function se(){this.s=this.s,this.C=this.C}se.prototype.s=!1,se.prototype.ma=function(){this.s||(this.s=!0,this.N())},se.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(k,U){this.type=k,this.g=this.target=U,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var ne=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var k=!1,U=Object.defineProperty({},"passive",{get:function(){k=!0}});try{const K=()=>{};o.addEventListener("test",K,U),o.removeEventListener("test",K,U)}catch{}return k}();function ce(k,U){if(H.call(this,k?k.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,k){var K=this.type=k.type,ue=k.changedTouches&&k.changedTouches.length?k.changedTouches[0]:null;if(this.target=k.target||k.srcElement,this.g=U,U=k.relatedTarget){if(M){e:{try{P(U.nodeName);var Re=!0;break e}catch{}Re=!1}Re||(U=null)}}else K=="mouseover"?U=k.fromElement:K=="mouseout"&&(U=k.toElement);this.relatedTarget=U,ue?(this.clientX=ue.clientX!==void 0?ue.clientX:ue.pageX,this.clientY=ue.clientY!==void 0?ue.clientY:ue.pageY,this.screenX=ue.screenX||0,this.screenY=ue.screenY||0):(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0),this.button=k.button,this.key=k.key||"",this.ctrlKey=k.ctrlKey,this.altKey=k.altKey,this.shiftKey=k.shiftKey,this.metaKey=k.metaKey,this.pointerId=k.pointerId||0,this.pointerType=typeof k.pointerType=="string"?k.pointerType:ie[k.pointerType]||"",this.state=k.state,this.i=k,k.defaultPrevented&&ce.aa.h.call(this)}}v(ce,H);var ie={2:"touch",3:"pen",4:"mouse"};ce.prototype.h=function(){ce.aa.h.call(this);var k=this.i;k.preventDefault?k.preventDefault():k.returnValue=!1};var ae="closure_listenable_"+(1e6*Math.random()|0),Z=0;function fe(k,U,K,ue,Re){this.listener=k,this.proxy=null,this.src=U,this.type=K,this.capture=!!ue,this.ha=Re,this.key=++Z,this.da=this.fa=!1}function he(k){k.da=!0,k.listener=null,k.proxy=null,k.src=null,k.ha=null}function Ae(k){this.src=k,this.g={},this.h=0}Ae.prototype.add=function(k,U,K,ue,Re){var Ye=k.toString();k=this.g[Ye],k||(k=this.g[Ye]=[],this.h++);var wt=Ee(k,U,ue,Re);return-1<wt?(U=k[wt],K||(U.fa=!1)):(U=new fe(U,this.src,Ye,!!ue,Re),U.fa=K,k.push(U)),U};function xe(k,U){var K=U.type;if(K in k.g){var ue=k.g[K],Re=Array.prototype.indexOf.call(ue,U,void 0),Ye;(Ye=0<=Re)&&Array.prototype.splice.call(ue,Re,1),Ye&&(he(U),k.g[K].length==0&&(delete k.g[K],k.h--))}}function Ee(k,U,K,ue){for(var Re=0;Re<k.length;++Re){var Ye=k[Re];if(!Ye.da&&Ye.listener==U&&Ye.capture==!!K&&Ye.ha==ue)return Re}return-1}var Be="closure_lm_"+(1e6*Math.random()|0),$e={};function mt(k,U,K,ue,Re){if(Array.isArray(U)){for(var Ye=0;Ye<U.length;Ye++)mt(k,U[Ye],K,ue,Re);return null}return K=Me(K),k&&k[ae]?k.K(U,K,c(ue)?!!ue.capture:!1,Re):dt(k,U,K,!1,ue,Re)}function dt(k,U,K,ue,Re,Ye){if(!U)throw Error("Invalid event type");var wt=c(Re)?!!Re.capture:!!Re,ii=J(k);if(ii||(k[Be]=ii=new Ae(k)),K=ii.add(U,K,ue,wt,Ye),K.proxy)return K;if(ue=ct(),K.proxy=ue,ue.src=k,ue.listener=K,k.addEventListener)ne||(Re=wt),Re===void 0&&(Re=!1),k.addEventListener(U.toString(),ue,Re);else if(k.attachEvent)k.attachEvent(_e(U.toString()),ue);else if(k.addListener&&k.removeListener)k.addListener(ue);else throw Error("addEventListener and attachEvent are unavailable.");return K}function ct(){function k(K){return U.call(k.src,k.listener,K)}const U=te;return k}function ut(k,U,K,ue,Re){if(Array.isArray(U))for(var Ye=0;Ye<U.length;Ye++)ut(k,U[Ye],K,ue,Re);else ue=c(ue)?!!ue.capture:!!ue,K=Me(K),k&&k[ae]?(k=k.i,U=String(U).toString(),U in k.g&&(Ye=k.g[U],K=Ee(Ye,K,ue,Re),-1<K&&(he(Ye[K]),Array.prototype.splice.call(Ye,K,1),Ye.length==0&&(delete k.g[U],k.h--)))):k&&(k=J(k))&&(U=k.g[U.toString()],k=-1,U&&(k=Ee(U,K,ue,Re)),(K=-1<k?U[k]:null)&&me(K))}function me(k){if(typeof k!="number"&&k&&!k.da){var U=k.src;if(U&&U[ae])xe(U.i,k);else{var K=k.type,ue=k.proxy;U.removeEventListener?U.removeEventListener(K,ue,k.capture):U.detachEvent?U.detachEvent(_e(K),ue):U.addListener&&U.removeListener&&U.removeListener(ue),(K=J(U))?(xe(K,k),K.h==0&&(K.src=null,U[Be]=null)):he(k)}}}function _e(k){return k in $e?$e[k]:$e[k]="on"+k}function te(k,U){if(k.da)k=!0;else{U=new ce(U,this);var K=k.listener,ue=k.ha||k.src;k.fa&&me(k),k=K.call(ue,U)}return k}function J(k){return k=k[Be],k instanceof Ae?k:null}var ve="__closure_events_fn_"+(1e9*Math.random()>>>0);function Me(k){return typeof k=="function"?k:(k[ve]||(k[ve]=function(U){return k.handleEvent(U)}),k[ve])}function W(){se.call(this),this.i=new Ae(this),this.M=this,this.F=null}v(W,se),W.prototype[ae]=!0,W.prototype.removeEventListener=function(k,U,K,ue){ut(this,k,U,K,ue)};function Se(k,U){var K,ue=k.F;if(ue)for(K=[];ue;ue=ue.F)K.push(ue);if(k=k.M,ue=U.type||U,typeof U=="string")U=new H(U,k);else if(U instanceof H)U.target=U.target||k;else{var Re=U;U=new H(ue,k),D(U,Re)}if(Re=!0,K)for(var Ye=K.length-1;0<=Ye;Ye--){var wt=U.g=K[Ye];Re=ze(wt,ue,!0,U)&&Re}if(wt=U.g=k,Re=ze(wt,ue,!0,U)&&Re,Re=ze(wt,ue,!1,U)&&Re,K)for(Ye=0;Ye<K.length;Ye++)wt=U.g=K[Ye],Re=ze(wt,ue,!1,U)&&Re}W.prototype.N=function(){if(W.aa.N.call(this),this.i){var k=this.i,U;for(U in k.g){for(var K=k.g[U],ue=0;ue<K.length;ue++)he(K[ue]);delete k.g[U],k.h--}}this.F=null},W.prototype.K=function(k,U,K,ue){return this.i.add(String(k),U,!1,K,ue)},W.prototype.L=function(k,U,K,ue){return this.i.add(String(k),U,!0,K,ue)};function ze(k,U,K,ue){if(U=k.i.g[String(U)],!U)return!0;U=U.concat();for(var Re=!0,Ye=0;Ye<U.length;++Ye){var wt=U[Ye];if(wt&&!wt.da&&wt.capture==K){var ii=wt.listener,ps=wt.ha||wt.src;wt.fa&&xe(k.i,wt),Re=ii.call(ps,ue)!==!1&&Re}}return Re&&!ue.defaultPrevented}function Ue(k,U,K){if(typeof k=="function")K&&(k=f(k,K));else if(k&&typeof k.handleEvent=="function")k=f(k.handleEvent,k);else throw Error("Invalid listener argument");return 2147483647<Number(U)?-1:o.setTimeout(k,U||0)}function Ne(k){k.g=Ue(()=>{k.g=null,k.i&&(k.i=!1,Ne(k))},k.l);const U=k.h;k.h=null,k.m.apply(null,U)}class De extends se{constructor(U,K){super(),this.m=U,this.l=K,this.h=null,this.i=!1,this.g=null}j(U){this.h=arguments,this.g?this.i=!0:Ne(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function We(k){se.call(this),this.h=k,this.g={}}v(We,se);var Je=[];function et(k){C(k.g,function(U,K){this.g.hasOwnProperty(K)&&me(U)},k),k.g={}}We.prototype.N=function(){We.aa.N.call(this),et(this)},We.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var qe=o.JSON.stringify,ft=o.JSON.parse,kt=class{stringify(k){return o.JSON.stringify(k,void 0)}parse(k){return o.JSON.parse(k,void 0)}};function Mt(){}Mt.prototype.h=null;function ye(k){return k.h||(k.h=k.i())}function He(){}var tt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xt(){H.call(this,"d")}v(xt,H);function Wt(){H.call(this,"c")}v(Wt,H);var gr={},Ui=null;function Hi(){return Ui=Ui||new W}gr.La="serverreachability";function Js(k){H.call(this,gr.La,k)}v(Js,H);function ei(k){const U=Hi();Se(U,new Js(U))}gr.STAT_EVENT="statevent";function Sa(k,U){H.call(this,gr.STAT_EVENT,k),this.stat=U}v(Sa,H);function zr(k){const U=Hi();Se(U,new Sa(U,k))}gr.Ma="timingevent";function $i(k,U){H.call(this,gr.Ma,k),this.size=U}v($i,H);function ln(k,U){if(typeof k!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){k()},U)}function Ea(){this.g=!0}Ea.prototype.xa=function(){this.g=!1};function Zl(k,U,K,ue,Re,Ye){k.info(function(){if(k.g)if(Ye)for(var wt="",ii=Ye.split("&"),ps=0;ps<ii.length;ps++){var ni=ii[ps].split("=");if(1<ni.length){var Rs=ni[0];ni=ni[1];var ms=Rs.split("_");wt=2<=ms.length&&ms[1]=="type"?wt+(Rs+"="+ni+"&"):wt+(Rs+"=redacted&")}}else wt=null;else wt=Ye;return"XMLHTTP REQ ("+ue+") [attempt "+Re+"]: "+U+`
`+K+`
`+wt})}function pe(k,U,K,ue,Re,Ye,wt){k.info(function(){return"XMLHTTP RESP ("+ue+") [ attempt "+Re+"]: "+U+`
`+K+`
`+Ye+" "+wt})}function je(k,U,K,ue){k.info(function(){return"XMLHTTP TEXT ("+U+"): "+ke(k,K)+(ue?" "+ue:"")})}function Ke(k,U){k.info(function(){return"TIMEOUT: "+U})}Ea.prototype.info=function(){};function ke(k,U){if(!k.g)return U;if(!U)return null;try{var K=JSON.parse(U);if(K){for(k=0;k<K.length;k++)if(Array.isArray(K[k])){var ue=K[k];if(!(2>ue.length)){var Re=ue[1];if(Array.isArray(Re)&&!(1>Re.length)){var Ye=Re[0];if(Ye!="noop"&&Ye!="stop"&&Ye!="close")for(var wt=1;wt<Re.length;wt++)Re[wt]=""}}}}return qe(K)}catch{return U}}var Qe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Tt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Gt;function qt(){}v(qt,Mt),qt.prototype.g=function(){return new XMLHttpRequest},qt.prototype.i=function(){return{}},Gt=new qt;function Dt(k,U,K,ue){this.j=k,this.i=U,this.l=K,this.R=ue||1,this.U=new We(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new er}function er(){this.i=null,this.g="",this.h=!1}var wr={},vr={};function Xt(k,U,K){k.L=1,k.v=dm(Vo(U)),k.m=K,k.P=!0,Ci(k,null)}function Ci(k,U){k.F=Date.now(),gi(k),k.A=Vo(k.v);var K=k.A,ue=k.R;Array.isArray(ue)||(ue=[String(ue)]),Pb(K.i,"t",ue),k.C=0,K=k.j.J,k.h=new er,k.g=jS(k.j,K?U:null,!k.m),0<k.O&&(k.M=new De(f(k.Y,k,k.g),k.O)),U=k.U,K=k.g,ue=k.ca;var Re="readystatechange";Array.isArray(Re)||(Re&&(Je[0]=Re.toString()),Re=Je);for(var Ye=0;Ye<Re.length;Ye++){var wt=mt(K,Re[Ye],ue||U.handleEvent,!1,U.h||U);if(!wt)break;U.g[wt.key]=wt}U=k.H?E(k.H):{},k.m?(k.u||(k.u="POST"),U["Content-Type"]="application/x-www-form-urlencoded",k.g.ea(k.A,k.u,k.m,U)):(k.u="GET",k.g.ea(k.A,k.u,null,U)),ei(),Zl(k.i,k.u,k.A,k.l,k.R,k.m)}Dt.prototype.ca=function(k){k=k.target;const U=this.M;U&&ml(k)==3?U.j():this.Y(k)},Dt.prototype.Y=function(k){try{if(k==this.g)e:{const ms=ml(this.g);var U=this.g.Ba();const Sd=this.g.Z();if(!(3>ms)&&(ms!=3||this.g&&(this.h.h||this.g.oa()||MS(this.g)))){this.J||ms!=4||U==7||(U==8||0>=Sd?ei(3):ei(2)),Yn(this);var K=this.g.Z();this.X=K;t:if(ea(this)){var ue=MS(this.g);k="";var Re=ue.length,Ye=ml(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gi(this),ur(this);var wt="";break t}this.h.i=new o.TextDecoder}for(U=0;U<Re;U++)this.h.h=!0,k+=this.h.i.decode(ue[U],{stream:!(Ye&&U==Re-1)});ue.length=0,this.h.g+=k,this.C=0,wt=this.h.g}else wt=this.g.oa();if(this.o=K==200,pe(this.i,this.u,this.A,this.l,this.R,ms,K),this.o){if(this.T&&!this.K){t:{if(this.g){var ii,ps=this.g;if((ii=ps.g?ps.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(ii)){var ni=ii;break t}}ni=null}if(K=ni)je(this.i,this.l,K,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wa(this,K);else{this.o=!1,this.s=3,zr(12),Gi(this),ur(this);break e}}if(this.P){K=!0;let ta;for(;!this.J&&this.C<wt.length;)if(ta=mo(this,wt),ta==vr){ms==4&&(this.s=4,zr(14),K=!1),je(this.i,this.l,null,"[Incomplete Response]");break}else if(ta==wr){this.s=4,zr(15),je(this.i,this.l,wt,"[Invalid Chunk]"),K=!1;break}else je(this.i,this.l,ta,null),Wa(this,ta);if(ea(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ms!=4||wt.length!=0||this.h.h||(this.s=1,zr(16),K=!1),this.o=this.o&&K,!K)je(this.i,this.l,wt,"[Invalid Chunked Response]"),Gi(this),ur(this);else if(0<wt.length&&!this.W){this.W=!0;var Rs=this.j;Rs.g==this&&Rs.ba&&!Rs.M&&(Rs.j.info("Great, no buffering proxy detected. Bytes received: "+wt.length),xm(Rs),Rs.M=!0,zr(11))}}else je(this.i,this.l,wt,null),Wa(this,wt);ms==4&&Gi(this),this.o&&!this.J&&(ms==4?RS(this.j,this):(this.o=!1,gi(this)))}else vN(this.g),K==400&&0<wt.indexOf("Unknown SID")?(this.s=3,zr(12)):(this.s=0,zr(13)),Gi(this),ur(this)}}}catch{}finally{}};function ea(k){return k.g?k.u=="GET"&&k.L!=2&&k.j.Ca:!1}function mo(k,U){var K=k.C,ue=U.indexOf(`
`,K);return ue==-1?vr:(K=Number(U.substring(K,ue)),isNaN(K)?wr:(ue+=1,ue+K>U.length?vr:(U=U.slice(ue,ue+K),k.C=ue+K,U)))}Dt.prototype.cancel=function(){this.J=!0,Gi(this)};function gi(k){k.S=Date.now()+k.I,kr(k,k.I)}function kr(k,U){if(k.B!=null)throw Error("WatchDog timer not null");k.B=ln(f(k.ba,k),U)}function Yn(k){k.B&&(o.clearTimeout(k.B),k.B=null)}Dt.prototype.ba=function(){this.B=null;const k=Date.now();0<=k-this.S?(Ke(this.i,this.A),this.L!=2&&(ei(),zr(17)),Gi(this),this.s=2,ur(this)):kr(this,this.S-k)};function ur(k){k.j.G==0||k.J||RS(k.j,k)}function Gi(k){Yn(k);var U=k.M;U&&typeof U.ma=="function"&&U.ma(),k.M=null,et(k.U),k.g&&(U=k.g,k.g=null,U.abort(),U.ma())}function Wa(k,U){try{var K=k.j;if(K.G!=0&&(K.g==k||be(K.h,k))){if(!k.K&&be(K.h,k)&&K.G==3){try{var ue=K.Da.g.parse(U)}catch{ue=null}if(Array.isArray(ue)&&ue.length==3){var Re=ue;if(Re[0]==0){e:if(!K.u){if(K.g)if(K.g.F+3e3<k.F)O0(K),R0(K);else break e;Ib(K),zr(18)}}else K.za=Re[1],0<K.za-K.T&&37500>Re[2]&&K.F&&K.v==0&&!K.C&&(K.C=ln(f(K.Za,K),6e3));if(1>=oe(K.h)&&K.ca){try{K.ca()}catch{}K.ca=void 0}}else _d(K,11)}else if((k.K||K.g==k)&&O0(K),!_(U))for(Re=K.Da.g.parse(U),U=0;U<Re.length;U++){let ni=Re[U];if(K.T=ni[0],ni=ni[1],K.G==2)if(ni[0]=="c"){K.K=ni[1],K.ia=ni[2];const Rs=ni[3];Rs!=null&&(K.la=Rs,K.j.info("VER="+K.la));const ms=ni[4];ms!=null&&(K.Aa=ms,K.j.info("SVER="+K.Aa));const Sd=ni[5];Sd!=null&&typeof Sd=="number"&&0<Sd&&(ue=1.5*Sd,K.L=ue,K.j.info("backChannelRequestTimeoutMs_="+ue)),ue=K;const ta=k.g;if(ta){const nu=ta.g?ta.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(nu){var Ye=ue.h;Ye.g||nu.indexOf("spdy")==-1&&nu.indexOf("quic")==-1&&nu.indexOf("h2")==-1||(Ye.j=Ye.l,Ye.g=new Set,Ye.h&&(de(Ye,Ye.h),Ye.h=null))}if(ue.D){const jb=ta.g?ta.g.getResponseHeader("X-HTTP-Session-Id"):null;jb&&(ue.ya=jb,Oi(ue.I,ue.D,jb))}}K.G=3,K.l&&K.l.ua(),K.ba&&(K.R=Date.now()-k.F,K.j.info("Handshake RTT: "+K.R+"ms")),ue=K;var wt=k;if(ue.qa=OS(ue,ue.J?ue.ia:null,ue.W),wt.K){Ce(ue.h,wt);var ii=wt,ps=ue.L;ps&&(ii.I=ps),ii.B&&(Yn(ii),gi(ii)),ue.g=wt}else NS(ue);0<K.i.length&&I0(K)}else ni[0]!="stop"&&ni[0]!="close"||_d(K,7);else K.G==3&&(ni[0]=="stop"||ni[0]=="close"?ni[0]=="stop"?_d(K,7):kb(K):ni[0]!="noop"&&K.l&&K.l.ta(ni),K.v=0)}}ei(4)}catch{}}var Bo=class{constructor(k,U){this.g=k,this.map=U}};function Xn(k){this.l=k||10,o.PerformanceNavigationTiming?(k=o.performance.getEntriesByType("navigation"),k=0<k.length&&(k[0].nextHopProtocol=="hq"||k[0].nextHopProtocol=="h2")):k=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=k?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ee(k){return k.h?!0:k.g?k.g.size>=k.j:!1}function oe(k){return k.h?1:k.g?k.g.size:0}function be(k,U){return k.h?k.h==U:k.g?k.g.has(U):!1}function de(k,U){k.g?k.g.add(U):k.h=U}function Ce(k,U){k.h&&k.h==U?k.h=null:k.g&&k.g.has(U)&&k.g.delete(U)}Xn.prototype.cancel=function(){if(this.i=ht(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const k of this.g.values())k.cancel();this.g.clear()}};function ht(k){if(k.h!=null)return k.i.concat(k.h.D);if(k.g!=null&&k.g.size!==0){let U=k.i;for(const K of k.g.values())U=U.concat(K.D);return U}return y(k.i)}function Fo(k){if(k.V&&typeof k.V=="function")return k.V();if(typeof Map<"u"&&k instanceof Map||typeof Set<"u"&&k instanceof Set)return Array.from(k.values());if(typeof k=="string")return k.split("");if(l(k)){for(var U=[],K=k.length,ue=0;ue<K;ue++)U.push(k[ue]);return U}U=[],K=0;for(ue in k)U[K++]=k[ue];return U}function Kc(k){if(k.na&&typeof k.na=="function")return k.na();if(!k.V||typeof k.V!="function"){if(typeof Map<"u"&&k instanceof Map)return Array.from(k.keys());if(!(typeof Set<"u"&&k instanceof Set)){if(l(k)||typeof k=="string"){var U=[];k=k.length;for(var K=0;K<k;K++)U.push(K);return U}U=[],K=0;for(const ue in k)U[K++]=ue;return U}}}function Qc(k,U){if(k.forEach&&typeof k.forEach=="function")k.forEach(U,void 0);else if(l(k)||typeof k=="string")Array.prototype.forEach.call(k,U,void 0);else for(var K=Kc(k),ue=Fo(k),Re=ue.length,Ye=0;Ye<Re;Ye++)U.call(void 0,ue[Ye],K&&K[Ye],k)}var Jl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ef(k,U){if(k){k=k.split("&");for(var K=0;K<k.length;K++){var ue=k[K].indexOf("="),Re=null;if(0<=ue){var Ye=k[K].substring(0,ue);Re=k[K].substring(ue+1)}else Ye=k[K];U(Ye,Re?decodeURIComponent(Re.replace(/\+/g," ")):"")}}}function cn(k){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,k instanceof cn){this.h=k.h,um(this,k.j),this.o=k.o,this.g=k.g,tf(this,k.s),this.l=k.l;var U=k.i,K=new yd;K.i=U.i,U.g&&(K.g=new Map(U.g),K.h=U.h),vd(this,K),this.m=k.m}else k&&(U=String(k).match(Jl))?(this.h=!1,um(this,U[1]||"",!0),this.o=hl(U[2]||""),this.g=hl(U[3]||"",!0),tf(this,U[4]),this.l=hl(U[5]||"",!0),vd(this,U[6]||"",!0),this.m=hl(U[7]||"")):(this.h=!1,this.i=new yd(null,this.h))}cn.prototype.toString=function(){var k=[],U=this.j;U&&k.push(hm(U,Tb,!0),":");var K=this.g;return(K||U=="file")&&(k.push("//"),(U=this.o)&&k.push(hm(U,Tb,!0),"@"),k.push(encodeURIComponent(String(K)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),K=this.s,K!=null&&k.push(":",String(K))),(K=this.l)&&(this.g&&K.charAt(0)!="/"&&k.push("/"),k.push(hm(K,K.charAt(0)=="/"?mN:Mb,!0))),(K=this.i.toString())&&k.push("?",K),(K=this.m)&&k.push("#",hm(K,M0)),k.join("")};function Vo(k){return new cn(k)}function um(k,U,K){k.j=K?hl(U,!0):U,k.j&&(k.j=k.j.replace(/:$/,""))}function tf(k,U){if(U){if(U=Number(U),isNaN(U)||0>U)throw Error("Bad port number "+U);k.s=U}else k.s=null}function vd(k,U,K){U instanceof yd?(k.i=U,CS(k.i,k.h)):(K||(U=hm(U,gN)),k.i=new yd(U,k.h))}function Oi(k,U,K){k.i.set(U,K)}function dm(k){return Oi(k,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),k}function hl(k,U){return k?U?decodeURI(k.replace(/%25/g,"%2525")):decodeURIComponent(k):""}function hm(k,U,K){return typeof k=="string"?(k=encodeURI(k).replace(U,AS),K&&(k=k.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k):null}function AS(k){return k=k.charCodeAt(0),"%"+(k>>4&15).toString(16)+(k&15).toString(16)}var Tb=/[#\/\?@]/g,Mb=/[#\?:]/g,mN=/[#\?]/g,gN=/[#\?@]/g,M0=/#/g;function yd(k,U){this.h=this.g=null,this.i=k||null,this.j=!!U}function fl(k){k.g||(k.g=new Map,k.h=0,k.i&&ef(k.i,function(U,K){k.add(decodeURIComponent(U.replace(/\+/g," ")),K)}))}e=yd.prototype,e.add=function(k,U){fl(this),this.i=null,k=Zc(this,k);var K=this.g.get(k);return K||this.g.set(k,K=[]),K.push(U),this.h+=1,this};function xd(k,U){fl(k),U=Zc(k,U),k.g.has(U)&&(k.i=null,k.h-=k.g.get(U).length,k.g.delete(U))}function bd(k,U){return fl(k),U=Zc(k,U),k.g.has(U)}e.forEach=function(k,U){fl(this),this.g.forEach(function(K,ue){K.forEach(function(Re){k.call(U,Re,ue,this)},this)},this)},e.na=function(){fl(this);const k=Array.from(this.g.values()),U=Array.from(this.g.keys()),K=[];for(let ue=0;ue<U.length;ue++){const Re=k[ue];for(let Ye=0;Ye<Re.length;Ye++)K.push(U[ue])}return K},e.V=function(k){fl(this);let U=[];if(typeof k=="string")bd(this,k)&&(U=U.concat(this.g.get(Zc(this,k))));else{k=Array.from(this.g.values());for(let K=0;K<k.length;K++)U=U.concat(k[K])}return U},e.set=function(k,U){return fl(this),this.i=null,k=Zc(this,k),bd(this,k)&&(this.h-=this.g.get(k).length),this.g.set(k,[U]),this.h+=1,this},e.get=function(k,U){return k?(k=this.V(k),0<k.length?String(k[0]):U):U};function Pb(k,U,K){xd(k,U),0<K.length&&(k.i=null,k.g.set(Zc(k,U),y(K)),k.h+=K.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const k=[],U=Array.from(this.g.keys());for(var K=0;K<U.length;K++){var ue=U[K];const Ye=encodeURIComponent(String(ue)),wt=this.V(ue);for(ue=0;ue<wt.length;ue++){var Re=Ye;wt[ue]!==""&&(Re+="="+encodeURIComponent(String(wt[ue]))),k.push(Re)}}return this.i=k.join("&")};function Zc(k,U){return U=String(U),k.j&&(U=U.toLowerCase()),U}function CS(k,U){U&&!k.j&&(fl(k),k.i=null,k.g.forEach(function(K,ue){var Re=ue.toLowerCase();ue!=Re&&(xd(this,ue),Pb(this,Re,K))},k)),k.j=U}function fm(k,U){const K=new Ea;if(o.Image){const ue=new Image;ue.onload=m(pl,K,"TestLoadImage: loaded",!0,U,ue),ue.onerror=m(pl,K,"TestLoadImage: error",!1,U,ue),ue.onabort=m(pl,K,"TestLoadImage: abort",!1,U,ue),ue.ontimeout=m(pl,K,"TestLoadImage: timeout",!1,U,ue),o.setTimeout(function(){ue.ontimeout&&ue.ontimeout()},1e4),ue.src=k}else U(!1)}function ec(k,U){const K=new Ea,ue=new AbortController,Re=setTimeout(()=>{ue.abort(),pl(K,"TestPingServer: timeout",!1,U)},1e4);fetch(k,{signal:ue.signal}).then(Ye=>{clearTimeout(Re),Ye.ok?pl(K,"TestPingServer: ok",!0,U):pl(K,"TestPingServer: server error",!1,U)}).catch(()=>{clearTimeout(Re),pl(K,"TestPingServer: error",!1,U)})}function pl(k,U,K,ue,Re){try{Re&&(Re.onload=null,Re.onerror=null,Re.onabort=null,Re.ontimeout=null),ue(K)}catch{}}function pm(){this.g=new kt}function Jc(k,U,K){const ue=K||"";try{Qc(k,function(Re,Ye){let wt=Re;c(Re)&&(wt=qe(Re)),U.push(ue+Ye+"="+encodeURIComponent(wt))})}catch(Re){throw U.push(ue+"type="+encodeURIComponent("_badmap")),Re}}function rf(k){this.l=k.Ub||null,this.j=k.eb||!1}v(rf,Mt),rf.prototype.g=function(){return new wd(this.l,this.j)},rf.prototype.i=function(k){return function(){return k}}({});function wd(k,U){W.call(this),this.D=k,this.o=U,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(wd,W),e=wd.prototype,e.open=function(k,U){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=k,this.A=U,this.readyState=1,tu(this)},e.send=function(k){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const U={headers:this.u,method:this.B,credentials:this.m,cache:void 0};k&&(U.body=k),(this.D||o).fetch(new Request(this.A,U)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,eu(this)),this.readyState=0},e.Sa=function(k){if(this.g&&(this.l=k,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=k.headers,this.readyState=2,tu(this)),this.g&&(this.readyState=3,tu(this),this.g)))if(this.responseType==="arraybuffer")k.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in k){if(this.j=k.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Db(this)}else k.text().then(this.Ra.bind(this),this.ga.bind(this))};function Db(k){k.j.read().then(k.Pa.bind(k)).catch(k.ga.bind(k))}e.Pa=function(k){if(this.g){if(this.o&&k.value)this.response.push(k.value);else if(!this.o){var U=k.value?k.value:new Uint8Array(0);(U=this.v.decode(U,{stream:!k.done}))&&(this.response=this.responseText+=U)}k.done?eu(this):tu(this),this.readyState==3&&Db(this)}},e.Ra=function(k){this.g&&(this.response=this.responseText=k,eu(this))},e.Qa=function(k){this.g&&(this.response=k,eu(this))},e.ga=function(){this.g&&eu(this)};function eu(k){k.readyState=4,k.l=null,k.j=null,k.v=null,tu(k)}e.setRequestHeader=function(k,U){this.u.append(k,U)},e.getResponseHeader=function(k){return this.h&&this.h.get(k.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const k=[],U=this.h.entries();for(var K=U.next();!K.done;)K=K.value,k.push(K[0]+": "+K[1]),K=U.next();return k.join(`\r
`)};function tu(k){k.onreadystatechange&&k.onreadystatechange.call(k)}Object.defineProperty(wd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(k){this.m=k?"include":"same-origin"}});function Nb(k){let U="";return C(k,function(K,ue){U+=ue,U+=":",U+=K,U+=`\r
`}),U}function ks(k,U,K){e:{for(ue in K){var ue=!1;break e}ue=!0}ue||(K=Nb(K),typeof k=="string"?K!=null&&encodeURIComponent(String(K)):Oi(k,U,K))}function wi(k){W.call(this),this.headers=new Map,this.o=k||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(wi,W);var P0=/^https?$/i,mm=["POST","PUT"];e=wi.prototype,e.Ha=function(k){this.J=k},e.ea=function(k,U,K,ue){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+k);U=U?U.toUpperCase():"GET",this.D=k,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Gt.g(),this.v=this.o?ye(this.o):ye(Gt),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(U,String(k),!0),this.B=!1}catch(Ye){TS(this,Ye);return}if(k=K||"",K=new Map(this.headers),ue)if(Object.getPrototypeOf(ue)===Object.prototype)for(var Re in ue)K.set(Re,ue[Re]);else if(typeof ue.keys=="function"&&typeof ue.get=="function")for(const Ye of ue.keys())K.set(Ye,ue.get(Ye));else throw Error("Unknown input type for opt_headers: "+String(ue));ue=Array.from(K.keys()).find(Ye=>Ye.toLowerCase()=="content-type"),Re=o.FormData&&k instanceof o.FormData,!(0<=Array.prototype.indexOf.call(mm,U,void 0))||ue||Re||K.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ye,wt]of K)this.g.setRequestHeader(Ye,wt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{gm(this),this.u=!0,this.g.send(k),this.u=!1}catch(Ye){TS(this,Ye)}};function TS(k,U){k.h=!1,k.g&&(k.j=!0,k.g.abort(),k.j=!1),k.l=U,k.m=5,D0(k),ru(k)}function D0(k){k.A||(k.A=!0,Se(k,"complete"),Se(k,"error"))}e.abort=function(k){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=k||7,Se(this,"complete"),Se(this,"abort"),ru(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ru(this,!0)),wi.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?N0(this):this.bb())},e.bb=function(){N0(this)};function N0(k){if(k.h&&typeof a<"u"&&(!k.v[1]||ml(k)!=4||k.Z()!=2)){if(k.u&&ml(k)==4)Ue(k.Ea,0,k);else if(Se(k,"readystatechange"),ml(k)==4){k.h=!1;try{const wt=k.Z();e:switch(wt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var U=!0;break e;default:U=!1}var K;if(!(K=U)){var ue;if(ue=wt===0){var Re=String(k.D).match(Jl)[1]||null;!Re&&o.self&&o.self.location&&(Re=o.self.location.protocol.slice(0,-1)),ue=!P0.test(Re?Re.toLowerCase():"")}K=ue}if(K)Se(k,"complete"),Se(k,"success");else{k.m=6;try{var Ye=2<ml(k)?k.g.statusText:""}catch{Ye=""}k.l=Ye+" ["+k.Z()+"]",D0(k)}}finally{ru(k)}}}}function ru(k,U){if(k.g){gm(k);const K=k.g,ue=k.v[0]?()=>{}:null;k.g=null,k.v=null,U||Se(k,"ready");try{K.onreadystatechange=ue}catch{}}}function gm(k){k.I&&(o.clearTimeout(k.I),k.I=null)}e.isActive=function(){return!!this.g};function ml(k){return k.g?k.g.readyState:0}e.Z=function(){try{return 2<ml(this)?this.g.status:-1}catch{return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},e.Oa=function(k){if(this.g){var U=this.g.responseText;return k&&U.indexOf(k)==0&&(U=U.substring(k.length)),ft(U)}};function MS(k){try{if(!k.g)return null;if("response"in k.g)return k.g.response;switch(k.H){case"":case"text":return k.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in k.g)return k.g.mozResponseArrayBuffer}return null}catch{return null}}function vN(k){const U={};k=(k.g&&2<=ml(k)&&k.g.getAllResponseHeaders()||"").split(`\r
`);for(let ue=0;ue<k.length;ue++){if(_(k[ue]))continue;var K=I(k[ue]);const Re=K[0];if(K=K[1],typeof K!="string")continue;K=K.trim();const Ye=U[Re]||[];U[Re]=Ye,Ye.push(K)}T(U,function(ue){return ue.join(", ")})}e.Ba=function(){return this.m},e.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function vm(k,U,K){return K&&K.internalChannelParams&&K.internalChannelParams[k]||U}function k0(k){this.Aa=0,this.i=[],this.j=new Ea,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=vm("failFast",!1,k),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=vm("baseRetryDelayMs",5e3,k),this.cb=vm("retryDelaySeedMs",1e4,k),this.Wa=vm("forwardChannelMaxRetries",2,k),this.wa=vm("forwardChannelRequestTimeoutMs",2e4,k),this.pa=k&&k.xmlHttpFactory||void 0,this.Xa=k&&k.Tb||void 0,this.Ca=k&&k.useFetchStreams||!1,this.L=void 0,this.J=k&&k.supportsCrossDomainXhr||!1,this.K="",this.h=new Xn(k&&k.concurrentRequestLimit),this.Da=new pm,this.P=k&&k.fastHandshake||!1,this.O=k&&k.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=k&&k.Rb||!1,k&&k.xa&&this.j.xa(),k&&k.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&k&&k.detectBufferingProxy||!1,this.ja=void 0,k&&k.longPollingTimeout&&0<k.longPollingTimeout&&(this.ja=k.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}e=k0.prototype,e.la=8,e.G=1,e.connect=function(k,U,K,ue){zr(0),this.W=k,this.H=U||{},K&&ue!==void 0&&(this.H.OSID=K,this.H.OAID=ue),this.F=this.X,this.I=OS(this,null,this.W),I0(this)};function kb(k){if(PS(k),k.G==3){var U=k.U++,K=Vo(k.I);if(Oi(K,"SID",k.K),Oi(K,"RID",U),Oi(K,"TYPE","terminate"),ym(k,K),U=new Dt(k,k.j,U),U.L=2,U.v=dm(Vo(K)),K=!1,o.navigator&&o.navigator.sendBeacon)try{K=o.navigator.sendBeacon(U.v.toString(),"")}catch{}!K&&o.Image&&(new Image().src=U.v,K=!0),K||(U.g=jS(U.j,null),U.g.ea(U.v)),U.F=Date.now(),gi(U)}IS(k)}function R0(k){k.g&&(xm(k),k.g.cancel(),k.g=null)}function PS(k){R0(k),k.u&&(o.clearTimeout(k.u),k.u=null),O0(k),k.h.cancel(),k.s&&(typeof k.s=="number"&&o.clearTimeout(k.s),k.s=null)}function I0(k){if(!ee(k.h)&&!k.s){k.s=!0;var U=k.Ga;Y||F(),X||(Y(),X=!0),re.add(U,k),k.B=0}}function yN(k,U){return oe(k.h)>=k.h.j-(k.s?1:0)?!1:k.s?(k.i=U.D.concat(k.i),!0):k.G==1||k.G==2||k.B>=(k.Va?0:k.Wa)?!1:(k.s=ln(f(k.Ga,k,U),Ob(k,k.B)),k.B++,!0)}e.Ga=function(k){if(this.s)if(this.s=null,this.G==1){if(!k){this.U=Math.floor(1e5*Math.random()),k=this.U++;const Re=new Dt(this,this.j,k);let Ye=this.o;if(this.S&&(Ye?(Ye=E(Ye),D(Ye,this.S)):Ye=this.S),this.m!==null||this.O||(Re.H=Ye,Ye=null),this.P)e:{for(var U=0,K=0;K<this.i.length;K++){t:{var ue=this.i[K];if("__data__"in ue.map&&(ue=ue.map.__data__,typeof ue=="string")){ue=ue.length;break t}ue=void 0}if(ue===void 0)break;if(U+=ue,4096<U){U=K;break e}if(U===4096||K===this.i.length-1){U=K+1;break e}}U=1e3}else U=1e3;U=DS(this,Re,U),K=Vo(this.I),Oi(K,"RID",k),Oi(K,"CVER",22),this.D&&Oi(K,"X-HTTP-Session-Id",this.D),ym(this,K),Ye&&(this.O?U="headers="+encodeURIComponent(String(Nb(Ye)))+"&"+U:this.m&&ks(K,this.m,Ye)),de(this.h,Re),this.Ua&&Oi(K,"TYPE","init"),this.P?(Oi(K,"$req",U),Oi(K,"SID","null"),Re.T=!0,Xt(Re,K,null)):Xt(Re,K,U),this.G=2}}else this.G==3&&(k?Rb(this,k):this.i.length==0||ee(this.h)||Rb(this))};function Rb(k,U){var K;U?K=U.l:K=k.U++;const ue=Vo(k.I);Oi(ue,"SID",k.K),Oi(ue,"RID",K),Oi(ue,"AID",k.T),ym(k,ue),k.m&&k.o&&ks(ue,k.m,k.o),K=new Dt(k,k.j,K,k.B+1),k.m===null&&(K.H=k.o),U&&(k.i=U.D.concat(k.i)),U=DS(k,K,1e3),K.I=Math.round(.5*k.wa)+Math.round(.5*k.wa*Math.random()),de(k.h,K),Xt(K,ue,U)}function ym(k,U){k.H&&C(k.H,function(K,ue){Oi(U,ue,K)}),k.l&&Qc({},function(K,ue){Oi(U,ue,K)})}function DS(k,U,K){K=Math.min(k.i.length,K);var ue=k.l?f(k.l.Na,k.l,k):null;e:{var Re=k.i;let Ye=-1;for(;;){const wt=["count="+K];Ye==-1?0<K?(Ye=Re[0].g,wt.push("ofs="+Ye)):Ye=0:wt.push("ofs="+Ye);let ii=!0;for(let ps=0;ps<K;ps++){let ni=Re[ps].g;const Rs=Re[ps].map;if(ni-=Ye,0>ni)Ye=Math.max(0,Re[ps].g-100),ii=!1;else try{Jc(Rs,wt,"req"+ni+"_")}catch{ue&&ue(Rs)}}if(ii){ue=wt.join("&");break e}}}return k=k.i.splice(0,K),U.D=k,ue}function NS(k){if(!k.g&&!k.u){k.Y=1;var U=k.Fa;Y||F(),X||(Y(),X=!0),re.add(U,k),k.v=0}}function Ib(k){return k.g||k.u||3<=k.v?!1:(k.Y++,k.u=ln(f(k.Fa,k),Ob(k,k.v)),k.v++,!0)}e.Fa=function(){if(this.u=null,kS(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var k=2*this.R;this.j.info("BP detection timer enabled: "+k),this.A=ln(f(this.ab,this),k)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,zr(10),R0(this),kS(this))};function xm(k){k.A!=null&&(o.clearTimeout(k.A),k.A=null)}function kS(k){k.g=new Dt(k,k.j,"rpc",k.Y),k.m===null&&(k.g.H=k.o),k.g.O=0;var U=Vo(k.qa);Oi(U,"RID","rpc"),Oi(U,"SID",k.K),Oi(U,"AID",k.T),Oi(U,"CI",k.F?"0":"1"),!k.F&&k.ja&&Oi(U,"TO",k.ja),Oi(U,"TYPE","xmlhttp"),ym(k,U),k.m&&k.o&&ks(U,k.m,k.o),k.L&&(k.g.I=k.L);var K=k.g;k=k.ia,K.L=1,K.v=dm(Vo(U)),K.m=null,K.P=!0,Ci(K,k)}e.Za=function(){this.C!=null&&(this.C=null,R0(this),Ib(this),zr(19))};function O0(k){k.C!=null&&(o.clearTimeout(k.C),k.C=null)}function RS(k,U){var K=null;if(k.g==U){O0(k),xm(k),k.g=null;var ue=2}else if(be(k.h,U))K=U.D,Ce(k.h,U),ue=1;else return;if(k.G!=0){if(U.o)if(ue==1){K=U.m?U.m.length:0,U=Date.now()-U.F;var Re=k.B;ue=Hi(),Se(ue,new $i(ue,K)),I0(k)}else NS(k);else if(Re=U.s,Re==3||Re==0&&0<U.X||!(ue==1&&yN(k,U)||ue==2&&Ib(k)))switch(K&&0<K.length&&(U=k.h,U.i=U.i.concat(K)),Re){case 1:_d(k,5);break;case 4:_d(k,10);break;case 3:_d(k,6);break;default:_d(k,2)}}}function Ob(k,U){let K=k.Ta+Math.floor(Math.random()*k.cb);return k.isActive()||(K*=2),K*U}function _d(k,U){if(k.j.info("Error code "+U),U==2){var K=f(k.fb,k),ue=k.Xa;const Re=!ue;ue=new cn(ue||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||um(ue,"https"),dm(ue),Re?fm(ue.toString(),K):ec(ue.toString(),K)}else zr(2);k.G=0,k.l&&k.l.sa(U),IS(k),PS(k)}e.fb=function(k){k?(this.j.info("Successfully pinged google.com"),zr(2)):(this.j.info("Failed to ping google.com"),zr(1))};function IS(k){if(k.G=0,k.ka=[],k.l){const U=ht(k.h);(U.length!=0||k.i.length!=0)&&(x(k.ka,U),x(k.ka,k.i),k.h.i.length=0,y(k.i),k.i.length=0),k.l.ra()}}function OS(k,U,K){var ue=K instanceof cn?Vo(K):new cn(K);if(ue.g!="")U&&(ue.g=U+"."+ue.g),tf(ue,ue.s);else{var Re=o.location;ue=Re.protocol,U=U?U+"."+Re.hostname:Re.hostname,Re=+Re.port;var Ye=new cn(null);ue&&um(Ye,ue),U&&(Ye.g=U),Re&&tf(Ye,Re),K&&(Ye.l=K),ue=Ye}return K=k.D,U=k.ya,K&&U&&Oi(ue,K,U),Oi(ue,"VER",k.la),ym(k,ue),ue}function jS(k,U,K){if(U&&!k.J)throw Error("Can't create secondary domain capable XhrIo object.");return U=k.Ca&&!k.pa?new wi(new rf({eb:K})):new wi(k.pa),U.Ha(k.J),U}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function LS(){}e=LS.prototype,e.ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){};function j0(){}j0.prototype.g=function(k,U){return new qa(k,U)};function qa(k,U){W.call(this),this.g=new k0(U),this.l=k,this.h=U&&U.messageUrlParams||null,k=U&&U.messageHeaders||null,U&&U.clientProtocolHeaderRequired&&(k?k["X-Client-Protocol"]="webchannel":k={"X-Client-Protocol":"webchannel"}),this.g.o=k,k=U&&U.initMessageHeaders||null,U&&U.messageContentType&&(k?k["X-WebChannel-Content-Type"]=U.messageContentType:k={"X-WebChannel-Content-Type":U.messageContentType}),U&&U.va&&(k?k["X-WebChannel-Client-Profile"]=U.va:k={"X-WebChannel-Client-Profile":U.va}),this.g.S=k,(k=U&&U.Sb)&&!_(k)&&(this.g.m=k),this.v=U&&U.supportsCrossDomainXhr||!1,this.u=U&&U.sendRawJson||!1,(U=U&&U.httpSessionIdParam)&&!_(U)&&(this.g.D=U,k=this.h,k!==null&&U in k&&(k=this.h,U in k&&delete k[U])),this.j=new iu(this)}v(qa,W),qa.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qa.prototype.close=function(){kb(this.g)},qa.prototype.o=function(k){var U=this.g;if(typeof k=="string"){var K={};K.__data__=k,k=K}else this.u&&(K={},K.__data__=qe(k),k=K);U.i.push(new Bo(U.Ya++,k)),U.G==3&&I0(U)},qa.prototype.N=function(){this.g.l=null,delete this.j,kb(this.g),delete this.g,qa.aa.N.call(this)};function zS(k){xt.call(this),k.__headers__&&(this.headers=k.__headers__,this.statusCode=k.__status__,delete k.__headers__,delete k.__status__);var U=k.__sm__;if(U){e:{for(const K in U){k=K;break e}k=void 0}(this.i=k)&&(k=this.i,U=U!==null&&k in U?U[k]:void 0),this.data=U}else this.data=k}v(zS,xt);function BS(){Wt.call(this),this.status=1}v(BS,Wt);function iu(k){this.g=k}v(iu,LS),iu.prototype.ua=function(){Se(this.g,"a")},iu.prototype.ta=function(k){Se(this.g,new zS(k))},iu.prototype.sa=function(k){Se(this.g,new BS)},iu.prototype.ra=function(){Se(this.g,"b")},j0.prototype.createWebChannel=j0.prototype.g,qa.prototype.send=qa.prototype.o,qa.prototype.open=qa.prototype.m,qa.prototype.close=qa.prototype.close,Kce=function(){return new j0},$ce=function(){return Hi()},Xce=gr,K5={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Qe.NO_ERROR=0,Qe.TIMEOUT=8,Qe.HTTP_ERROR=6,AT=Qe,Tt.COMPLETE="complete",Yce=Tt,He.EventType=tt,tt.OPEN="a",tt.CLOSE="b",tt.ERROR="c",tt.MESSAGE="d",W.prototype.listen=W.prototype.K,Mw=He,wi.prototype.listenOnce=wi.prototype.L,wi.prototype.getLastError=wi.prototype.Ka,wi.prototype.getLastErrorCode=wi.prototype.Ba,wi.prototype.getStatus=wi.prototype.Z,wi.prototype.getResponseJson=wi.prototype.Oa,wi.prototype.getResponseText=wi.prototype.oa,wi.prototype.send=wi.prototype.ea,wi.prototype.setWithCredentials=wi.prototype.Ha,qce=wi}).apply(typeof vC<"u"?vC:typeof self<"u"?self:typeof window<"u"?window:{});const MQ="@firebase/firestore",PQ="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Na=class{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}};Na.UNAUTHENTICATED=new Na(null),Na.GOOGLE_CREDENTIALS=new Na("google-credentials-uid"),Na.FIRST_PARTY=new Na("first-party-uid"),Na.MOCK_USER=new Na("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ub="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r0=new AF("@firebase/firestore");function ly(){return r0.logLevel}function It(e,...t){if(r0.logLevel<=Kr.DEBUG){const r=t.map(zF);r0.debug(`Firestore (${ub}): ${e}`,...r)}}function Uh(e,...t){if(r0.logLevel<=Kr.ERROR){const r=t.map(zF);r0.error(`Firestore (${ub}): ${e}`,...r)}}function Vp(e,...t){if(r0.logLevel<=Kr.WARN){const r=t.map(zF);r0.warn(`Firestore (${ub}): ${e}`,...r)}}function zF(e){if(typeof e=="string")return e;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(e)}catch{return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,Qce(e,i,r)}function Qce(e,t,r){let i=`FIRESTORE (${ub}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(r!==void 0)try{i+=" CONTEXT: "+JSON.stringify(r)}catch{i+=" CONTEXT: "+r}throw Uh(i),new Error(i)}function Ai(e,t,r,i){let n="Unexpected state";typeof r=="string"?n=r:i=r,e||Qce(t,n,i)}function Nr(e,t){return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Kt extends Zh{constructor(t,r){super(t,r),this.code=t,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(){this.promise=new Promise((t,r)=>{this.resolve=t,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zce{constructor(t,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class PQe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,r){t.enqueueRetryable(()=>r(Na.UNAUTHENTICATED))}shutdown(){}}class DQe{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,r){this.changeListener=r,t.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class NQe{constructor(t){this.t=t,this.currentUser=Na.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,r){Ai(this.o===void 0,42304);let i=this.i;const n=l=>this.i!==i?(i=this.i,r(l)):Promise.resolve();let s=new Rg;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Rg,t.enqueueRetryable(()=>n(this.currentUser))};const a=()=>{const l=s;t.enqueueRetryable(async()=>{await l.promise,await n(this.currentUser)})},o=l=>{It("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(It("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Rg)}},0),a()}getToken(){const t=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(i=>this.i!==t?(It("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ai(typeof i.accessToken=="string",31837,{l:i}),new Zce(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return Ai(t===null||typeof t=="string",2055,{h:t}),new Na(t)}}class kQe{constructor(t,r,i){this.P=t,this.T=r,this.I=i,this.type="FirstParty",this.user=Na.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class RQe{constructor(t,r,i){this.P=t,this.T=r,this.I=i}getToken(){return Promise.resolve(new kQe(this.P,this.T,this.I))}start(t,r){t.enqueueRetryable(()=>r(Na.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class DQ{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class IQe{constructor(t,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wc(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,r){Ai(this.o===void 0,3512);const i=s=>{s.error!=null&&It("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,It("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>i(s))};const n=s=>{It("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>n(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?n(s):It("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new DQ(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(r=>r?(Ai(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new DQ(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OQe(e){const t=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(r);else for(let i=0;i<e;i++)r[i]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jce(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const n=OQe(40);for(let s=0;s<n.length;++s)i.length<20&&n[s]<r&&(i+=t.charAt(n[s]%62))}return i}}function Vr(e,t){return e<t?-1:e>t?1:0}function Q5(e,t){let r=0;for(;r<e.length&&r<t.length;){const i=e.codePointAt(r),n=t.codePointAt(r);if(i!==n){if(i<128&&n<128)return Vr(i,n);{const s=Jce(),a=jQe(s.encode(NQ(e,r)),s.encode(NQ(t,r)));return a!==0?a:Vr(i,n)}}r+=i>65535?2:1}return Vr(e.length,t.length)}function NQ(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function jQe(e,t){for(let r=0;r<e.length&&r<t.length;++r)if(e[r]!==t[r])return Vr(e[r],t[r]);return Vr(e.length,t.length)}function Cx(e,t,r){return e.length===t.length&&e.every((i,n)=>r(i,t[n]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kQ="__name__";class Tu{constructor(t,r,i){r===void 0?r=0:r>t.length&&mr(637,{offset:r,range:t.length}),i===void 0?i=t.length-r:i>t.length-r&&mr(1746,{length:i,range:t.length-r}),this.segments=t,this.offset=r,this.len=i}get length(){return this.len}isEqual(t){return Tu.comparator(this,t)===0}child(t){const r=this.segments.slice(this.offset,this.limit());return t instanceof Tu?t.forEach(i=>{r.push(i)}):r.push(t),this.construct(r)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==t.get(r))return!1;return!0}forEach(t){for(let r=this.offset,i=this.limit();r<i;r++)t(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,r){const i=Math.min(t.length,r.length);for(let n=0;n<i;n++){const s=Tu.compareSegments(t.get(n),r.get(n));if(s!==0)return s}return Vr(t.length,r.length)}static compareSegments(t,r){const i=Tu.isNumericId(t),n=Tu.isNumericId(r);return i&&!n?-1:!i&&n?1:i&&n?Tu.extractNumericId(t).compare(Tu.extractNumericId(r)):Q5(t,r)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Pp.fromString(t.substring(4,t.length-2))}}class mn extends Tu{construct(t,r,i){return new mn(t,r,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const r=[];for(const i of t){if(i.indexOf("//")>=0)throw new Kt(pt.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);r.push(...i.split("/").filter(n=>n.length>0))}return new mn(r)}static emptyPath(){return new mn([])}}const LQe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pa extends Tu{construct(t,r,i){return new pa(t,r,i)}static isValidIdentifier(t){return LQe.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pa.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===kQ}static keyField(){return new pa([kQ])}static fromServerFormat(t){const r=[];let i="",n=0;const s=()=>{if(i.length===0)throw new Kt(pt.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(i),i=""};let a=!1;for(;n<t.length;){const o=t[n];if(o==="\\"){if(n+1===t.length)throw new Kt(pt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const l=t[n+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Kt(pt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=l,n+=2}else o==="`"?(a=!a,n++):o!=="."||a?(i+=o,n++):(s(),n++)}if(s(),a)throw new Kt(pt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new pa(r)}static emptyPath(){return new pa([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(t){this.path=t}static fromPath(t){return new cr(mn.fromString(t))}static fromName(t){return new cr(mn.fromString(t).popFirst(5))}static empty(){return new cr(mn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&mn.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,r){return mn.comparator(t.path,r.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new cr(new mn(t.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zQe(e,t,r){if(!r)throw new Kt(pt.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function BQe(e,t,r,i){if(t===!0&&i===!0)throw new Kt(pt.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)}function RQ(e){if(!cr.isDocumentKey(e))throw new Kt(pt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function eue(e){return typeof e=="object"&&e!==null&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function FF(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return typeof e=="function"?"a function":mr(12329,{type:typeof e})}function Yy(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Kt(pt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=FF(e);throw new Kt(pt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(e,t){const r={typeString:e};return t&&(r.value=t),r}function tS(e,t){if(!eue(e))throw new Kt(pt.INVALID_ARGUMENT,"JSON must be an object");let r;for(const i in t)if(t[i]){const n=t[i].typeString,s="value"in t[i]?{value:t[i].value}:void 0;if(!(i in e)){r=`JSON missing required field: '${i}'`;break}const a=e[i];if(n&&typeof a!==n){r=`JSON field '${i}' must be a ${n}.`;break}if(s!==void 0&&a!==s.value){r=`Expected '${i}' field to equal '${s.value}'`;break}}if(r)throw new Kt(pt.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IQ=-62135596800,OQ=1e6;class sn{static now(){return sn.fromMillis(Date.now())}static fromDate(t){return sn.fromMillis(t.getTime())}static fromMillis(t){const r=Math.floor(t/1e3),i=Math.floor((t-1e3*r)*OQ);return new sn(r,i)}constructor(t,r){if(this.seconds=t,this.nanoseconds=r,r<0)throw new Kt(pt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Kt(pt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(t<IQ)throw new Kt(pt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Kt(pt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/OQ}_compareTo(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:sn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(tS(t,sn._jsonSchema))return new sn(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-IQ;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}sn._jsonSchemaVersion="firestore/timestamp/1.0",sn._jsonSchema={type:ls("string",sn._jsonSchemaVersion),seconds:ls("number"),nanoseconds:ls("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{static fromTimestamp(t){return new Cr(t)}static min(){return new Cr(new sn(0,0))}static max(){return new Cr(new sn(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J2=-1;function FQe(e,t){const r=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1,n=Cr.fromTimestamp(i===1e9?new sn(r+1,0):new sn(r,i));return new Up(n,cr.empty(),t)}function VQe(e){return new Up(e.readTime,e.key,J2)}class Up{constructor(t,r,i){this.readTime=t,this.documentKey=r,this.largestBatchId=i}static min(){return new Up(Cr.min(),cr.empty(),J2)}static max(){return new Up(Cr.max(),cr.empty(),J2)}}function UQe(e,t){let r=e.readTime.compareTo(t.readTime);return r!==0?r:(r=cr.comparator(e.documentKey,t.documentKey),r!==0?r:Vr(e.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HQe="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class GQe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function db(e){if(e.code!==pt.FAILED_PRECONDITION||e.message!==HQe)throw e;It("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(t){return this.next(void 0,t)}next(t,r){return this.callbackAttached&&mr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(t,this.result):new lt((i,n)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(i,n)},this.catchCallback=s=>{this.wrapFailure(r,s).next(i,n)}})}toPromise(){return new Promise((t,r)=>{this.next(t,r)})}wrapUserFunction(t){try{const r=t();return r instanceof lt?r:lt.resolve(r)}catch(r){return lt.reject(r)}}wrapSuccess(t,r){return t?this.wrapUserFunction(()=>t(r)):lt.resolve(r)}wrapFailure(t,r){return t?this.wrapUserFunction(()=>t(r)):lt.reject(r)}static resolve(t){return new lt((r,i)=>{r(t)})}static reject(t){return new lt((r,i)=>{i(t)})}static waitFor(t){return new lt((r,i)=>{let n=0,s=0,a=!1;t.forEach(o=>{++n,o.next(()=>{++s,a&&s===n&&r()},l=>i(l))}),a=!0,s===n&&r()})}static or(t){let r=lt.resolve(!1);for(const i of t)r=r.next(n=>n?lt.resolve(n):i());return r}static forEach(t,r){const i=[];return t.forEach((n,s)=>{i.push(r.call(this,n,s))}),this.waitFor(i)}static mapArray(t,r){return new lt((i,n)=>{const s=t.length,a=new Array(s);let o=0;for(let l=0;l<s;l++){const c=l;r(t[c]).next(u=>{a[c]=u,++o,o===s&&i(a)},u=>n(u))}})}static doWhile(t,r){return new lt((i,n)=>{const s=()=>{t()===!0?r().next(()=>{s()},n):i()};s()})}}function WQe(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function hb(e){return e.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}cD.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VF=-1;function uD(e){return e==null}function AP(e){return e===0&&1/e==-1/0}function qQe(e){return typeof e=="number"&&Number.isInteger(e)&&!AP(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tue="";function YQe(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t=jQ(t)),t=XQe(e.get(r),t);return jQ(t)}function XQe(e,t){let r=t;const i=e.length;for(let n=0;n<i;n++){const s=e.charAt(n);switch(s){case"\0":r+="";break;case tue:r+="";break;default:r+=s}}return r}function jQ(e){return e+tue+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LQ(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function im(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function rue(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(t,r){this.comparator=t,this.root=r||da.EMPTY}insert(t,r){return new bn(this.comparator,this.root.insert(t,r,this.comparator).copy(null,null,da.BLACK,null,null))}remove(t){return new bn(this.comparator,this.root.remove(t,this.comparator).copy(null,null,da.BLACK,null,null))}get(t){let r=this.root;for(;!r.isEmpty();){const i=this.comparator(t,r.key);if(i===0)return r.value;i<0?r=r.left:i>0&&(r=r.right)}return null}indexOf(t){let r=0,i=this.root;for(;!i.isEmpty();){const n=this.comparator(t,i.key);if(n===0)return r+i.left.size;n<0?i=i.left:(r+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((r,i)=>(t(r,i),!1))}toString(){const t=[];return this.inorderTraversal((r,i)=>(t.push(`${r}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new yC(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new yC(this.root,t,this.comparator,!1)}getReverseIterator(){return new yC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new yC(this.root,t,this.comparator,!0)}}class yC{constructor(t,r,i,n){this.isReverse=n,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=r?i(t.key,r):1,r&&n&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const r={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class da{constructor(t,r,i,n,s){this.key=t,this.value=r,this.color=i??da.RED,this.left=n??da.EMPTY,this.right=s??da.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,r,i,n,s){return new da(t??this.key,r??this.value,i??this.color,n??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let n=this;const s=i(t,n.key);return n=s<0?n.copy(null,null,null,n.left.insert(t,r,i),null):s===0?n.copy(null,r,null,null,null):n.copy(null,null,null,null,n.right.insert(t,r,i)),n.fixUp()}removeMin(){if(this.left.isEmpty())return da.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,r){let i,n=this;if(r(t,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(t,r),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),r(t,n.key)===0){if(n.right.isEmpty())return da.EMPTY;i=n.right.min(),n=n.copy(i.key,i.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(t,r))}return n.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,da.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,da.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw mr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw mr(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw mr(27949);return t+(this.isRed()?0:1)}}da.EMPTY=null,da.RED=!0,da.BLACK=!1;da.EMPTY=new class{constructor(){this.size=0}get key(){throw mr(57766)}get value(){throw mr(16141)}get color(){throw mr(16727)}get left(){throw mr(29726)}get right(){throw mr(36894)}copy(t,r,i,n,s){return this}insert(t,r,i){return new da(t,r)}remove(t,r){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(t){this.comparator=t,this.data=new bn(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((r,i)=>(t(r),!1))}forEachInRange(t,r){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const n=i.getNext();if(this.comparator(n.key,t[1])>=0)return;r(n.key)}}forEachWhile(t,r){let i;for(i=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const r=this.data.getIteratorFrom(t);return r.hasNext()?r.getNext().key:null}getIterator(){return new zQ(this.data.getIterator())}getIteratorFrom(t){return new zQ(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let r=this;return r.size<t.size&&(r=t,t=this),t.forEach(i=>{r=r.add(i)}),r}isEqual(t){if(!(t instanceof Ms)||this.size!==t.size)return!1;const r=this.data.getIterator(),i=t.data.getIterator();for(;r.hasNext();){const n=r.getNext().key,s=i.getNext().key;if(this.comparator(n,s)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(r=>{t.push(r)}),t}toString(){const t=[];return this.forEach(r=>t.push(r)),"SortedSet("+t.toString()+")"}copy(t){const r=new Ms(this.comparator);return r.data=t,r}}class zQ{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(t){this.fields=t,t.sort(pa.comparator)}static empty(){return new Mc([])}unionWith(t){let r=new Ms(pa.comparator);for(const i of this.fields)r=r.add(i);for(const i of t)r=r.add(i);return new Mc(r.toArray())}covers(t){for(const r of this.fields)if(r.isPrefixOf(t))return!0;return!1}isEqual(t){return Cx(this.fields,t.fields,(r,i)=>r.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iue extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(t){this.binaryString=t}static fromBase64String(t){const r=function(n){try{return atob(n)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new iue("Invalid base64 string: "+s):s}}(t);return new ba(r)}static fromUint8Array(t){const r=function(n){let s="";for(let a=0;a<n.length;++a)s+=String.fromCharCode(n[a]);return s}(t);return new ba(r)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const i=new Uint8Array(r.length);for(let n=0;n<r.length;n++)i[n]=r.charCodeAt(n);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Vr(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}ba.EMPTY_BYTE_STRING=new ba("");const $Qe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hp(e){if(Ai(!!e,39018),typeof e=="string"){let t=0;const r=$Qe.exec(e);if(Ai(!!r,46558,{timestamp:e}),r[1]){let n=r[1];n=(n+"000000000").substr(0,9),t=Number(n)}const i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Bn(e.seconds),nanos:Bn(e.nanos)}}function Bn(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Gp(e){return typeof e=="string"?ba.fromBase64String(e):ba.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nue="server_timestamp",sue="__type__",aue="__previous_value__",oue="__local_write_time__";function UF(e){var t,r;return((r=(((t=e?.mapValue)===null||t===void 0?void 0:t.fields)||{})[sue])===null||r===void 0?void 0:r.stringValue)===nue}function dD(e){const t=e.mapValue.fields[aue];return UF(t)?dD(t):t}function e_(e){const t=Hp(e.mapValue.fields[oue].timestampValue);return new sn(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KQe{constructor(t,r,i,n,s,a,o,l,c,u){this.databaseId=t,this.appId=r,this.persistenceKey=i,this.host=n,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const CP="(default)";class t_{constructor(t,r){this.projectId=t,this.database=r||CP}static empty(){return new t_("","")}get isDefaultDatabase(){return this.database===CP}isEqual(t){return t instanceof t_&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lue="__type__",QQe="__max__",xC={mapValue:{}},cue="__vector__",TP="value";function Wp(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?UF(e)?4:JQe(e)?9007199254740991:ZQe(e)?10:11:mr(28295,{value:e})}function sd(e,t){if(e===t)return!0;const r=Wp(e);if(r!==Wp(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return e_(e).isEqual(e_(t));case 3:return function(n,s){if(typeof n.timestampValue=="string"&&typeof s.timestampValue=="string"&&n.timestampValue.length===s.timestampValue.length)return n.timestampValue===s.timestampValue;const a=Hp(n.timestampValue),o=Hp(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(n,s){return Gp(n.bytesValue).isEqual(Gp(s.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(n,s){return Bn(n.geoPointValue.latitude)===Bn(s.geoPointValue.latitude)&&Bn(n.geoPointValue.longitude)===Bn(s.geoPointValue.longitude)}(e,t);case 2:return function(n,s){if("integerValue"in n&&"integerValue"in s)return Bn(n.integerValue)===Bn(s.integerValue);if("doubleValue"in n&&"doubleValue"in s){const a=Bn(n.doubleValue),o=Bn(s.doubleValue);return a===o?AP(a)===AP(o):isNaN(a)&&isNaN(o)}return!1}(e,t);case 9:return Cx(e.arrayValue.values||[],t.arrayValue.values||[],sd);case 10:case 11:return function(n,s){const a=n.mapValue.fields||{},o=s.mapValue.fields||{};if(LQ(a)!==LQ(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!sd(a[l],o[l])))return!1;return!0}(e,t);default:return mr(52216,{left:e})}}function r_(e,t){return(e.values||[]).find(r=>sd(r,t))!==void 0}function Tx(e,t){if(e===t)return 0;const r=Wp(e),i=Wp(t);if(r!==i)return Vr(r,i);switch(r){case 0:case 9007199254740991:return 0;case 1:return Vr(e.booleanValue,t.booleanValue);case 2:return function(s,a){const o=Bn(s.integerValue||s.doubleValue),l=Bn(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(e,t);case 3:return BQ(e.timestampValue,t.timestampValue);case 4:return BQ(e_(e),e_(t));case 5:return Q5(e.stringValue,t.stringValue);case 6:return function(s,a){const o=Gp(s),l=Gp(a);return o.compareTo(l)}(e.bytesValue,t.bytesValue);case 7:return function(s,a){const o=s.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=Vr(o[c],l[c]);if(u!==0)return u}return Vr(o.length,l.length)}(e.referenceValue,t.referenceValue);case 8:return function(s,a){const o=Vr(Bn(s.latitude),Bn(a.latitude));return o!==0?o:Vr(Bn(s.longitude),Bn(a.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return FQ(e.arrayValue,t.arrayValue);case 10:return function(s,a){var o,l,c,u;const d=s.fields||{},f=a.fields||{},m=(o=d[TP])===null||o===void 0?void 0:o.arrayValue,v=(l=f[TP])===null||l===void 0?void 0:l.arrayValue,y=Vr(((c=m?.values)===null||c===void 0?void 0:c.length)||0,((u=v?.values)===null||u===void 0?void 0:u.length)||0);return y!==0?y:FQ(m,v)}(e.mapValue,t.mapValue);case 11:return function(s,a){if(s===xC.mapValue&&a===xC.mapValue)return 0;if(s===xC.mapValue)return 1;if(a===xC.mapValue)return-1;const o=s.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const f=Q5(l[d],u[d]);if(f!==0)return f;const m=Tx(o[l[d]],c[u[d]]);if(m!==0)return m}return Vr(l.length,u.length)}(e.mapValue,t.mapValue);default:throw mr(23264,{le:r})}}function BQ(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return Vr(e,t);const r=Hp(e),i=Hp(t),n=Vr(r.seconds,i.seconds);return n!==0?n:Vr(r.nanos,i.nanos)}function FQ(e,t){const r=e.values||[],i=t.values||[];for(let n=0;n<r.length&&n<i.length;++n){const s=Tx(r[n],i[n]);if(s)return s}return Vr(r.length,i.length)}function Mx(e){return Z5(e)}function Z5(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){const i=Hp(r);return`time(${i.seconds},${i.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(r){return Gp(r).toBase64()}(e.bytesValue):"referenceValue"in e?function(r){return cr.fromName(r).toString()}(e.referenceValue):"geoPointValue"in e?function(r){return`geo(${r.latitude},${r.longitude})`}(e.geoPointValue):"arrayValue"in e?function(r){let i="[",n=!0;for(const s of r.values||[])n?n=!1:i+=",",i+=Z5(s);return i+"]"}(e.arrayValue):"mapValue"in e?function(r){const i=Object.keys(r.fields||{}).sort();let n="{",s=!0;for(const a of i)s?s=!1:n+=",",n+=`${a}:${Z5(r.fields[a])}`;return n+"}"}(e.mapValue):mr(61005,{value:e})}function CT(e){switch(Wp(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=dD(e);return t?16+CT(t):16;case 5:return 2*e.stringValue.length;case 6:return Gp(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((n,s)=>n+CT(s),0)}(e.arrayValue);case 10:case 11:return function(i){let n=0;return im(i.fields,(s,a)=>{n+=s.length+CT(a)}),n}(e.mapValue);default:throw mr(13486,{value:e})}}function J5(e){return!!e&&"integerValue"in e}function HF(e){return!!e&&"arrayValue"in e}function VQ(e){return!!e&&"nullValue"in e}function UQ(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function TT(e){return!!e&&"mapValue"in e}function ZQe(e){var t,r;return((r=(((t=e?.mapValue)===null||t===void 0?void 0:t.fields)||{})[lue])===null||r===void 0?void 0:r.stringValue)===cue}function l2(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&typeof e.timestampValue=="object")return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return im(e.mapValue.fields,(r,i)=>t.mapValue.fields[r]=l2(i)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=l2(e.arrayValue.values[r]);return t}return Object.assign({},e)}function JQe(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===QQe}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(t){this.value=t}static empty(){return new il({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let r=this.value;for(let i=0;i<t.length-1;++i)if(r=(r.mapValue.fields||{})[t.get(i)],!TT(r))return null;return r=(r.mapValue.fields||{})[t.lastSegment()],r||null}}set(t,r){this.getFieldsMap(t.popLast())[t.lastSegment()]=l2(r)}setAll(t){let r=pa.emptyPath(),i={},n=[];t.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,i,n),i={},n=[],r=o.popLast()}a?i[o.lastSegment()]=l2(a):n.push(o.lastSegment())});const s=this.getFieldsMap(r);this.applyChanges(s,i,n)}delete(t){const r=this.field(t.popLast());TT(r)&&r.mapValue.fields&&delete r.mapValue.fields[t.lastSegment()]}isEqual(t){return sd(this.value,t.value)}getFieldsMap(t){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let i=0;i<t.length;++i){let n=r.mapValue.fields[t.get(i)];TT(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},r.mapValue.fields[t.get(i)]=n),r=n}return r.mapValue.fields}applyChanges(t,r,i){im(r,(n,s)=>t[n]=s);for(const n of i)delete t[n]}clone(){return new il(l2(this.value))}}function uue(e){const t=[];return im(e.fields,(r,i)=>{const n=new pa([r]);if(TT(i)){const s=uue(i.mapValue).fields;if(s.length===0)t.push(n);else for(const a of s)t.push(n.child(a))}else t.push(n)}),new Mc(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(t,r,i,n,s,a,o){this.key=t,this.documentType=r,this.version=i,this.readTime=n,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(t){return new Ia(t,0,Cr.min(),Cr.min(),Cr.min(),il.empty(),0)}static newFoundDocument(t,r,i,n){return new Ia(t,1,r,Cr.min(),i,n,0)}static newNoDocument(t,r){return new Ia(t,2,r,Cr.min(),Cr.min(),il.empty(),0)}static newUnknownDocument(t,r){return new Ia(t,3,r,Cr.min(),Cr.min(),il.empty(),2)}convertToFoundDocument(t,r){return!this.createTime.isEqual(Cr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=il.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=il.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Cr.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Ia&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Ia(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(t,r){this.position=t,this.inclusive=r}}function HQ(e,t,r){let i=0;for(let n=0;n<e.position.length;n++){const s=t[n],a=e.position[n];if(s.field.isKeyField()?i=cr.comparator(cr.fromName(a.referenceValue),r.key):i=Tx(a,r.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function GQ(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!sd(e.position[r],t.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(t,r="asc"){this.field=t,this.dir=r}}function eZe(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class due{}class Ts extends due{constructor(t,r,i){super(),this.field=t,this.op=r,this.value=i}static create(t,r,i){return t.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(t,r,i):new rZe(t,r,i):r==="array-contains"?new sZe(t,i):r==="in"?new aZe(t,i):r==="not-in"?new oZe(t,i):r==="array-contains-any"?new lZe(t,i):new Ts(t,r,i)}static createKeyFieldInFilter(t,r,i){return r==="in"?new iZe(t,i):new nZe(t,i)}matches(t){const r=t.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(Tx(r,this.value)):r!==null&&Wp(this.value)===Wp(r)&&this.matchesComparison(Tx(r,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return mr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ad extends due{constructor(t,r){super(),this.filters=t,this.op=r,this.he=null}static create(t,r){return new ad(t,r)}matches(t){return hue(this)?this.filters.find(r=>!r.matches(t))===void 0:this.filters.find(r=>r.matches(t))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((t,r)=>t.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function hue(e){return e.op==="and"}function fue(e){return tZe(e)&&hue(e)}function tZe(e){for(const t of e.filters)if(t instanceof ad)return!1;return!0}function ez(e){if(e instanceof Ts)return e.field.canonicalString()+e.op.toString()+Mx(e.value);if(fue(e))return e.filters.map(t=>ez(t)).join(",");{const t=e.filters.map(r=>ez(r)).join(",");return`${e.op}(${t})`}}function pue(e,t){return e instanceof Ts?function(i,n){return n instanceof Ts&&i.op===n.op&&i.field.isEqual(n.field)&&sd(i.value,n.value)}(e,t):e instanceof ad?function(i,n){return n instanceof ad&&i.op===n.op&&i.filters.length===n.filters.length?i.filters.reduce((s,a,o)=>s&&pue(a,n.filters[o]),!0):!1}(e,t):void mr(19439)}function mue(e){return e instanceof Ts?function(r){return`${r.field.canonicalString()} ${r.op} ${Mx(r.value)}`}(e):e instanceof ad?function(r){return r.op.toString()+" {"+r.getFilters().map(mue).join(" ,")+"}"}(e):"Filter"}class rZe extends Ts{constructor(t,r,i){super(t,r,i),this.key=cr.fromName(i.referenceValue)}matches(t){const r=cr.comparator(t.key,this.key);return this.matchesComparison(r)}}class iZe extends Ts{constructor(t,r){super(t,"in",r),this.keys=gue("in",r)}matches(t){return this.keys.some(r=>r.isEqual(t.key))}}class nZe extends Ts{constructor(t,r){super(t,"not-in",r),this.keys=gue("not-in",r)}matches(t){return!this.keys.some(r=>r.isEqual(t.key))}}function gue(e,t){var r;return(((r=t.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(i=>cr.fromName(i.referenceValue))}class sZe extends Ts{constructor(t,r){super(t,"array-contains",r)}matches(t){const r=t.data.field(this.field);return HF(r)&&r_(r.arrayValue,this.value)}}class aZe extends Ts{constructor(t,r){super(t,"in",r)}matches(t){const r=t.data.field(this.field);return r!==null&&r_(this.value.arrayValue,r)}}class oZe extends Ts{constructor(t,r){super(t,"not-in",r)}matches(t){if(r_(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=t.data.field(this.field);return r!==null&&r.nullValue===void 0&&!r_(this.value.arrayValue,r)}}class lZe extends Ts{constructor(t,r){super(t,"array-contains-any",r)}matches(t){const r=t.data.field(this.field);return!(!HF(r)||!r.arrayValue.values)&&r.arrayValue.values.some(i=>r_(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cZe{constructor(t,r=null,i=[],n=[],s=null,a=null,o=null){this.path=t,this.collectionGroup=r,this.orderBy=i,this.filters=n,this.limit=s,this.startAt=a,this.endAt=o,this.Pe=null}}function WQ(e,t=null,r=[],i=[],n=null,s=null,a=null){return new cZe(e,t,r,i,n,s,a)}function GF(e){const t=Nr(e);if(t.Pe===null){let r=t.path.canonicalString();t.collectionGroup!==null&&(r+="|cg:"+t.collectionGroup),r+="|f:",r+=t.filters.map(i=>ez(i)).join(","),r+="|ob:",r+=t.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),uD(t.limit)||(r+="|l:",r+=t.limit),t.startAt&&(r+="|lb:",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Mx(i)).join(",")),t.endAt&&(r+="|ub:",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Mx(i)).join(",")),t.Pe=r}return t.Pe}function WF(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!eZe(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!pue(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!GQ(e.startAt,t.startAt)&&GQ(e.endAt,t.endAt)}function tz(e){return cr.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(t,r=null,i=[],n=[],s=null,a="F",o=null,l=null){this.path=t,this.collectionGroup=r,this.explicitOrderBy=i,this.filters=n,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=l,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function uZe(e,t,r,i,n,s,a,o){return new hD(e,t,r,i,n,s,a,o)}function qF(e){return new hD(e)}function qQ(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function dZe(e){return e.collectionGroup!==null}function c2(e){const t=Nr(e);if(t.Te===null){t.Te=[];const r=new Set;for(const s of t.explicitOrderBy)t.Te.push(s),r.add(s.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Ms(pa.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(t).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||t.Te.push(new PP(s,i))}),r.has(pa.keyField().canonicalString())||t.Te.push(new PP(pa.keyField(),i))}return t.Te}function Gu(e){const t=Nr(e);return t.Ie||(t.Ie=hZe(t,c2(e))),t.Ie}function hZe(e,t){if(e.limitType==="F")return WQ(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(n=>{const s=n.dir==="desc"?"asc":"desc";return new PP(n.field,s)});const r=e.endAt?new MP(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new MP(e.startAt.position,e.startAt.inclusive):null;return WQ(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}}function rz(e,t,r){return new hD(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function fD(e,t){return WF(Gu(e),Gu(t))&&e.limitType===t.limitType}function vue(e){return`${GF(Gu(e))}|lt:${e.limitType}`}function cy(e){return`Query(target=${function(r){let i=r.path.canonicalString();return r.collectionGroup!==null&&(i+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(i+=`, filters: [${r.filters.map(n=>mue(n)).join(", ")}]`),uD(r.limit)||(i+=", limit: "+r.limit),r.orderBy.length>0&&(i+=`, orderBy: [${r.orderBy.map(n=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(n)).join(", ")}]`),r.startAt&&(i+=", startAt: ",i+=r.startAt.inclusive?"b:":"a:",i+=r.startAt.position.map(n=>Mx(n)).join(",")),r.endAt&&(i+=", endAt: ",i+=r.endAt.inclusive?"a:":"b:",i+=r.endAt.position.map(n=>Mx(n)).join(",")),`Target(${i})`}(Gu(e))}; limitType=${e.limitType})`}function pD(e,t){return t.isFoundDocument()&&function(i,n){const s=n.key.path;return i.collectionGroup!==null?n.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):cr.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(e,t)&&function(i,n){for(const s of c2(i))if(!s.field.isKeyField()&&n.data.field(s.field)===null)return!1;return!0}(e,t)&&function(i,n){for(const s of i.filters)if(!s.matches(n))return!1;return!0}(e,t)&&function(i,n){return!(i.startAt&&!function(a,o,l){const c=HQ(a,o,l);return a.inclusive?c<=0:c<0}(i.startAt,c2(i),n)||i.endAt&&!function(a,o,l){const c=HQ(a,o,l);return a.inclusive?c>=0:c>0}(i.endAt,c2(i),n))}(e,t)}function fZe(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function yue(e){return(t,r)=>{let i=!1;for(const n of c2(e)){const s=pZe(n,t,r);if(s!==0)return s;i=i||n.field.isKeyField()}return 0}}function pZe(e,t,r){const i=e.field.isKeyField()?cr.comparator(t.key,r.key):function(s,a,o){const l=a.data.field(s),c=o.data.field(s);return l!==null&&c!==null?Tx(l,c):mr(42886)}(e.field,t,r);switch(e.dir){case"asc":return i;case"desc":return-1*i;default:return mr(19790,{direction:e.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(t,r){this.mapKeyFn=t,this.equalsFn=r,this.inner={},this.innerSize=0}get(t){const r=this.mapKeyFn(t),i=this.inner[r];if(i!==void 0){for(const[n,s]of i)if(this.equalsFn(n,t))return s}}has(t){return this.get(t)!==void 0}set(t,r){const i=this.mapKeyFn(t),n=this.inner[i];if(n===void 0)return this.inner[i]=[[t,r]],void this.innerSize++;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],t))return void(n[s]=[t,r]);n.push([t,r]),this.innerSize++}delete(t){const r=this.mapKeyFn(t),i=this.inner[r];if(i===void 0)return!1;for(let n=0;n<i.length;n++)if(this.equalsFn(i[n][0],t))return i.length===1?delete this.inner[r]:i.splice(n,1),this.innerSize--,!0;return!1}forEach(t){im(this.inner,(r,i)=>{for(const[n,s]of i)t(n,s)})}isEmpty(){return rue(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mZe=new bn(cr.comparator);function Hh(){return mZe}const xue=new bn(cr.comparator);function Pw(...e){let t=xue;for(const r of e)t=t.insert(r.key,r);return t}function bue(e){let t=xue;return e.forEach((r,i)=>t=t.insert(r,i.overlayedDocument)),t}function bg(){return u2()}function wue(){return u2()}function u2(){return new b0(e=>e.toString(),(e,t)=>e.isEqual(t))}const gZe=new bn(cr.comparator),vZe=new Ms(cr.comparator);function Qr(...e){let t=vZe;for(const r of e)t=t.add(r);return t}const yZe=new Ms(Vr);function xZe(){return yZe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YF(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:AP(t)?"-0":t}}function _ue(e){return{integerValue:""+e}}function bZe(e,t){return qQe(t)?_ue(t):YF(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(){this._=void 0}}function wZe(e,t,r){return e instanceof DP?function(n,s){const a={fields:{[sue]:{stringValue:nue},[oue]:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return s&&UF(s)&&(s=dD(s)),s&&(a.fields[aue]=s),{mapValue:a}}(r,t):e instanceof Px?Eue(e,t):e instanceof i_?Aue(e,t):function(n,s){const a=Sue(n,s),o=YQ(a)+YQ(n.Ee);return J5(a)&&J5(n.Ee)?_ue(o):YF(n.serializer,o)}(e,t)}function _Ze(e,t,r){return e instanceof Px?Eue(e,t):e instanceof i_?Aue(e,t):r}function Sue(e,t){return e instanceof NP?function(i){return J5(i)||function(s){return!!s&&"doubleValue"in s}(i)}(t)?t:{integerValue:0}:null}class DP extends mD{}class Px extends mD{constructor(t){super(),this.elements=t}}function Eue(e,t){const r=Cue(t);for(const i of e.elements)r.some(n=>sd(n,i))||r.push(i);return{arrayValue:{values:r}}}class i_ extends mD{constructor(t){super(),this.elements=t}}function Aue(e,t){let r=Cue(t);for(const i of e.elements)r=r.filter(n=>!sd(n,i));return{arrayValue:{values:r}}}class NP extends mD{constructor(t,r){super(),this.serializer=t,this.Ee=r}}function YQ(e){return Bn(e.integerValue||e.doubleValue)}function Cue(e){return HF(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SZe{constructor(t,r){this.field=t,this.transform=r}}function EZe(e,t){return e.field.isEqual(t.field)&&function(i,n){return i instanceof Px&&n instanceof Px||i instanceof i_&&n instanceof i_?Cx(i.elements,n.elements,sd):i instanceof NP&&n instanceof NP?sd(i.Ee,n.Ee):i instanceof DP&&n instanceof DP}(e.transform,t.transform)}class AZe{constructor(t,r){this.version=t,this.transformResults=r}}class Ph{constructor(t,r){this.updateTime=t,this.exists=r}static none(){return new Ph}static exists(t){return new Ph(void 0,t)}static updateTime(t){return new Ph(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function MT(e,t){return e.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t.isFoundDocument()}class gD{}function Tue(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new Pue(e.key,Ph.none()):new vD(e.key,e.data,Ph.none());{const r=e.data,i=il.empty();let n=new Ms(pa.comparator);for(let s of t.fields)if(!n.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?i.delete(s):i.set(s,a),n=n.add(s)}return new w0(e.key,i,new Mc(n.toArray()),Ph.none())}}function CZe(e,t,r){e instanceof vD?function(n,s,a){const o=n.value.clone(),l=$Q(n.fieldTransforms,s,a.transformResults);o.setAll(l),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(e,t,r):e instanceof w0?function(n,s,a){if(!MT(n.precondition,s))return void s.convertToUnknownDocument(a.version);const o=$Q(n.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Mue(n)),l.setAll(o),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(e,t,r):function(n,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,t,r)}function d2(e,t,r,i){return e instanceof vD?function(s,a,o,l){if(!MT(s.precondition,a))return o;const c=s.value.clone(),u=KQ(s.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(e,t,r,i):e instanceof w0?function(s,a,o,l){if(!MT(s.precondition,a))return o;const c=KQ(s.fieldTransforms,l,a),u=a.data;return u.setAll(Mue(s)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(e,t,r,i):function(s,a,o){return MT(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(e,t,r)}function TZe(e,t){let r=null;for(const i of e.fieldTransforms){const n=t.data.field(i.field),s=Sue(i.transform,n||null);s!=null&&(r===null&&(r=il.empty()),r.set(i.field,s))}return r||null}function XQ(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(i,n){return i===void 0&&n===void 0||!(!i||!n)&&Cx(i,n,(s,a)=>EZe(s,a))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class vD extends gD{constructor(t,r,i,n=[]){super(),this.key=t,this.value=r,this.precondition=i,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class w0 extends gD{constructor(t,r,i,n,s=[]){super(),this.key=t,this.data=r,this.fieldMask=i,this.precondition=n,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Mue(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const i=e.data.field(r);t.set(r,i)}}),t}function $Q(e,t,r){const i=new Map;Ai(e.length===r.length,32656,{Ae:r.length,Re:e.length});for(let n=0;n<r.length;n++){const s=e[n],a=s.transform,o=t.data.field(s.field);i.set(s.field,_Ze(a,o,r[n]))}return i}function KQ(e,t,r){const i=new Map;for(const n of e){const s=n.transform,a=r.data.field(n.field);i.set(n.field,wZe(s,a,t))}return i}class Pue extends gD{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class MZe extends gD{constructor(t,r){super(),this.key=t,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PZe{constructor(t,r,i,n){this.batchId=t,this.localWriteTime=r,this.baseMutations=i,this.mutations=n}applyToRemoteDocument(t,r){const i=r.mutationResults;for(let n=0;n<this.mutations.length;n++){const s=this.mutations[n];s.key.isEqual(t.key)&&CZe(s,t,i[n])}}applyToLocalView(t,r){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(r=d2(i,t,r,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(r=d2(i,t,r,this.localWriteTime));return r}applyToLocalDocumentSet(t,r){const i=wue();return this.mutations.forEach(n=>{const s=t.get(n.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=r.has(n.key)?null:o;const l=Tue(a,o);l!==null&&i.set(n.key,l),a.isValidDocument()||a.convertToNoDocument(Cr.min())}),i}keys(){return this.mutations.reduce((t,r)=>t.add(r.key),Qr())}isEqual(t){return this.batchId===t.batchId&&Cx(this.mutations,t.mutations,(r,i)=>XQ(r,i))&&Cx(this.baseMutations,t.baseMutations,(r,i)=>XQ(r,i))}}class XF{constructor(t,r,i,n){this.batch=t,this.commitVersion=r,this.mutationResults=i,this.docVersions=n}static from(t,r,i){Ai(t.mutations.length===i.length,58842,{Ve:t.mutations.length,me:i.length});let n=function(){return gZe}();const s=t.mutations;for(let a=0;a<s.length;a++)n=n.insert(s[a].key,i[a].version);return new XF(t,r,i,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DZe{constructor(t,r){this.largestBatchId=t,this.mutation=r}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NZe{constructor(t,r){this.count=t,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jn,ai;function kZe(e){switch(e){case pt.OK:return mr(64938);case pt.CANCELLED:case pt.UNKNOWN:case pt.DEADLINE_EXCEEDED:case pt.RESOURCE_EXHAUSTED:case pt.INTERNAL:case pt.UNAVAILABLE:case pt.UNAUTHENTICATED:return!1;case pt.INVALID_ARGUMENT:case pt.NOT_FOUND:case pt.ALREADY_EXISTS:case pt.PERMISSION_DENIED:case pt.FAILED_PRECONDITION:case pt.ABORTED:case pt.OUT_OF_RANGE:case pt.UNIMPLEMENTED:case pt.DATA_LOSS:return!0;default:return mr(15467,{code:e})}}function Due(e){if(e===void 0)return Uh("GRPC error has no .code"),pt.UNKNOWN;switch(e){case Jn.OK:return pt.OK;case Jn.CANCELLED:return pt.CANCELLED;case Jn.UNKNOWN:return pt.UNKNOWN;case Jn.DEADLINE_EXCEEDED:return pt.DEADLINE_EXCEEDED;case Jn.RESOURCE_EXHAUSTED:return pt.RESOURCE_EXHAUSTED;case Jn.INTERNAL:return pt.INTERNAL;case Jn.UNAVAILABLE:return pt.UNAVAILABLE;case Jn.UNAUTHENTICATED:return pt.UNAUTHENTICATED;case Jn.INVALID_ARGUMENT:return pt.INVALID_ARGUMENT;case Jn.NOT_FOUND:return pt.NOT_FOUND;case Jn.ALREADY_EXISTS:return pt.ALREADY_EXISTS;case Jn.PERMISSION_DENIED:return pt.PERMISSION_DENIED;case Jn.FAILED_PRECONDITION:return pt.FAILED_PRECONDITION;case Jn.ABORTED:return pt.ABORTED;case Jn.OUT_OF_RANGE:return pt.OUT_OF_RANGE;case Jn.UNIMPLEMENTED:return pt.UNIMPLEMENTED;case Jn.DATA_LOSS:return pt.DATA_LOSS;default:return mr(39323,{code:e})}}(ai=Jn||(Jn={}))[ai.OK=0]="OK",ai[ai.CANCELLED=1]="CANCELLED",ai[ai.UNKNOWN=2]="UNKNOWN",ai[ai.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ai[ai.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ai[ai.NOT_FOUND=5]="NOT_FOUND",ai[ai.ALREADY_EXISTS=6]="ALREADY_EXISTS",ai[ai.PERMISSION_DENIED=7]="PERMISSION_DENIED",ai[ai.UNAUTHENTICATED=16]="UNAUTHENTICATED",ai[ai.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ai[ai.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ai[ai.ABORTED=10]="ABORTED",ai[ai.OUT_OF_RANGE=11]="OUT_OF_RANGE",ai[ai.UNIMPLEMENTED=12]="UNIMPLEMENTED",ai[ai.INTERNAL=13]="INTERNAL",ai[ai.UNAVAILABLE=14]="UNAVAILABLE",ai[ai.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RZe=new Pp([4294967295,4294967295],0);function QQ(e){const t=Jce().encode(e),r=new Wce;return r.update(t),new Uint8Array(r.digest())}function ZQ(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),i=t.getUint32(4,!0),n=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Pp([r,i],0),new Pp([n,s],0)]}class $F{constructor(t,r,i){if(this.bitmap=t,this.padding=r,this.hashCount=i,r<0||r>=8)throw new Dw(`Invalid padding: ${r}`);if(i<0)throw new Dw(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new Dw(`Invalid hash count: ${i}`);if(t.length===0&&r!==0)throw new Dw(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*t.length-r,this.ge=Pp.fromNumber(this.fe)}pe(t,r,i){let n=t.add(r.multiply(Pp.fromNumber(i)));return n.compare(RZe)===1&&(n=new Pp([n.getBits(0),n.getBits(1)],0)),n.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.fe===0)return!1;const r=QQ(t),[i,n]=ZQ(r);for(let s=0;s<this.hashCount;s++){const a=this.pe(i,n,s);if(!this.ye(a))return!1}return!0}static create(t,r,i){const n=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),a=new $F(s,n,r);return i.forEach(o=>a.insert(o)),a}insert(t){if(this.fe===0)return;const r=QQ(t),[i,n]=ZQ(r);for(let s=0;s<this.hashCount;s++){const a=this.pe(i,n,s);this.we(a)}}we(t){const r=Math.floor(t/8),i=t%8;this.bitmap[r]|=1<<i}}class Dw extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(t,r,i,n,s){this.snapshotVersion=t,this.targetChanges=r,this.targetMismatches=i,this.documentUpdates=n,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,r,i){const n=new Map;return n.set(t,rS.createSynthesizedTargetChangeForCurrentChange(t,r,i)),new yD(Cr.min(),n,new bn(Vr),Hh(),Qr())}}class rS{constructor(t,r,i,n,s){this.resumeToken=t,this.current=r,this.addedDocuments=i,this.modifiedDocuments=n,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,r,i){return new rS(i,r,Qr(),Qr(),Qr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(t,r,i,n){this.Se=t,this.removedTargetIds=r,this.key=i,this.be=n}}class Nue{constructor(t,r){this.targetId=t,this.De=r}}class kue{constructor(t,r,i=ba.EMPTY_BYTE_STRING,n=null){this.state=t,this.targetIds=r,this.resumeToken=i,this.cause=n}}class JQ{constructor(){this.ve=0,this.Ce=eZ(),this.Fe=ba.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=Qr(),r=Qr(),i=Qr();return this.Ce.forEach((n,s)=>{switch(s){case 0:t=t.add(n);break;case 2:r=r.add(n);break;case 1:i=i.add(n);break;default:mr(38017,{changeType:s})}}),new rS(this.Fe,this.Me,t,r,i)}ke(){this.xe=!1,this.Ce=eZ()}qe(t,r){this.xe=!0,this.Ce=this.Ce.insert(t,r)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,Ai(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class IZe{constructor(t){this.We=t,this.Ge=new Map,this.ze=Hh(),this.je=bC(),this.Je=bC(),this.He=new bn(Vr)}Ye(t){for(const r of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(r,t.be):this.Xe(r,t.key,t.be);for(const r of t.removedTargetIds)this.Xe(r,t.key,t.be)}et(t){this.forEachTarget(t,r=>{const i=this.tt(r);switch(t.state){case 0:this.nt(r)&&i.Be(t.resumeToken);break;case 1:i.Ue(),i.Oe||i.ke(),i.Be(t.resumeToken);break;case 2:i.Ue(),i.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(i.Ke(),i.Be(t.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),i.Be(t.resumeToken));break;default:mr(56790,{state:t.state})}})}forEachTarget(t,r){t.targetIds.length>0?t.targetIds.forEach(r):this.Ge.forEach((i,n)=>{this.nt(n)&&r(n)})}it(t){const r=t.targetId,i=t.De.count,n=this.st(r);if(n){const s=n.target;if(tz(s))if(i===0){const a=new cr(s.path);this.Xe(r,a,Ia.newNoDocument(a,Cr.min()))}else Ai(i===1,20013,{expectedCount:i});else{const a=this.ot(r);if(a!==i){const o=this._t(t),l=o?this.ut(o,t,a):1;if(l!==0){this.rt(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(r,c)}}}}}_t(t){const r=t.De.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:i="",padding:n=0},hashCount:s=0}=r;let a,o;try{a=Gp(i).toUint8Array()}catch(l){if(l instanceof iue)return Vp("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new $F(a,n,s)}catch(l){return Vp(l instanceof Dw?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.fe===0?null:o}ut(t,r,i){return r.De.count===i-this.ht(t,r.targetId)?0:2}ht(t,r){const i=this.We.getRemoteKeysForTarget(r);let n=0;return i.forEach(s=>{const a=this.We.lt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;t.mightContain(o)||(this.Xe(r,s,null),n++)}),n}Pt(t){const r=new Map;this.Ge.forEach((s,a)=>{const o=this.st(a);if(o){if(s.current&&tz(o.target)){const l=new cr(o.target.path);this.Tt(l).has(a)||this.It(a,l)||this.Xe(a,l,Ia.newNoDocument(l,t))}s.Ne&&(r.set(a,s.Le()),s.ke())}});let i=Qr();this.Je.forEach((s,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.st(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(i=i.add(s))}),this.ze.forEach((s,a)=>a.setReadTime(t));const n=new yD(t,r,this.He,this.ze,i);return this.ze=Hh(),this.je=bC(),this.Je=bC(),this.He=new bn(Vr),n}Ze(t,r){if(!this.nt(t))return;const i=this.It(t,r.key)?2:0;this.tt(t).qe(r.key,i),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(t)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(t))}Xe(t,r,i){if(!this.nt(t))return;const n=this.tt(t);this.It(t,r)?n.qe(r,1):n.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(t)),this.Je=this.Je.insert(r,this.dt(r).add(t)),i&&(this.ze=this.ze.insert(r,i))}removeTarget(t){this.Ge.delete(t)}ot(t){const r=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+r.addedDocuments.size-r.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let r=this.Ge.get(t);return r||(r=new JQ,this.Ge.set(t,r)),r}dt(t){let r=this.Je.get(t);return r||(r=new Ms(Vr),this.Je=this.Je.insert(t,r)),r}Tt(t){let r=this.je.get(t);return r||(r=new Ms(Vr),this.je=this.je.insert(t,r)),r}nt(t){const r=this.st(t)!==null;return r||It("WatchChangeAggregator","Detected inactive target",t),r}st(t){const r=this.Ge.get(t);return r&&r.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new JQ),this.We.getRemoteKeysForTarget(t).forEach(r=>{this.Xe(t,r,null)})}It(t,r){return this.We.getRemoteKeysForTarget(t).has(r)}}function bC(){return new bn(cr.comparator)}function eZ(){return new bn(cr.comparator)}const OZe={asc:"ASCENDING",desc:"DESCENDING"},jZe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LZe={and:"AND",or:"OR"};class zZe{constructor(t,r){this.databaseId=t,this.useProto3Json=r}}function iz(e,t){return e.useProto3Json||uD(t)?t:{value:t}}function kP(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Rue(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function BZe(e,t){return kP(e,t.toTimestamp())}function Wu(e){return Ai(!!e,49232),Cr.fromTimestamp(function(r){const i=Hp(r);return new sn(i.seconds,i.nanos)}(e))}function KF(e,t){return nz(e,t).canonicalString()}function nz(e,t){const r=function(n){return new mn(["projects",n.projectId,"databases",n.database])}(e).child("documents");return t===void 0?r:r.child(t)}function Iue(e){const t=mn.fromString(e);return Ai(Bue(t),10190,{key:t.toString()}),t}function sz(e,t){return KF(e.databaseId,t.path)}function JI(e,t){const r=Iue(t);if(r.get(1)!==e.databaseId.projectId)throw new Kt(pt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Kt(pt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new cr(jue(r))}function Oue(e,t){return KF(e.databaseId,t)}function FZe(e){const t=Iue(e);return t.length===4?mn.emptyPath():jue(t)}function az(e){return new mn(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function jue(e){return Ai(e.length>4&&e.get(4)==="documents",29091,{key:e.toString()}),e.popFirst(5)}function tZ(e,t,r){return{name:sz(e,t),fields:r.value.mapValue.fields}}function VZe(e,t){let r;if("targetChange"in t){t.targetChange;const i=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:mr(39313,{state:c})}(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(Ai(u===void 0||typeof u=="string",58123),ba.fromBase64String(u||"")):(Ai(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),ba.fromUint8Array(u||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(c){const u=c.code===void 0?pt.UNKNOWN:Due(c.code);return new Kt(u,c.message||"")}(a);r=new kue(i,n,s,o||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const n=JI(e,i.document.name),s=Wu(i.document.updateTime),a=i.document.createTime?Wu(i.document.createTime):Cr.min(),o=new il({mapValue:{fields:i.document.fields}}),l=Ia.newFoundDocument(n,s,a,o),c=i.targetIds||[],u=i.removedTargetIds||[];r=new PT(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const n=JI(e,i.document),s=i.readTime?Wu(i.readTime):Cr.min(),a=Ia.newNoDocument(n,s),o=i.removedTargetIds||[];r=new PT([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const n=JI(e,i.document),s=i.removedTargetIds||[];r=new PT([],s,n,null)}else{if(!("filter"in t))return mr(11601,{At:t});{t.filter;const i=t.filter;i.targetId;const{count:n=0,unchangedNames:s}=i,a=new NZe(n,s),o=i.targetId;r=new Nue(o,a)}}return r}function UZe(e,t){let r;if(t instanceof vD)r={update:tZ(e,t.key,t.value)};else if(t instanceof Pue)r={delete:sz(e,t.key)};else if(t instanceof w0)r={update:tZ(e,t.key,t.data),updateMask:QZe(t.fieldMask)};else{if(!(t instanceof MZe))return mr(16599,{Rt:t.type});r={verify:sz(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(i=>function(s,a){const o=a.transform;if(o instanceof DP)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Px)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof i_)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof NP)return{fieldPath:a.field.canonicalString(),increment:o.Ee};throw mr(20930,{transform:a.transform})}(0,i))),t.precondition.isNone||(r.currentDocument=function(n,s){return s.updateTime!==void 0?{updateTime:BZe(n,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:mr(27497)}(e,t.precondition)),r}function HZe(e,t){return e&&e.length>0?(Ai(t!==void 0,14353),e.map(r=>function(n,s){let a=n.updateTime?Wu(n.updateTime):Wu(s);return a.isEqual(Cr.min())&&(a=Wu(s)),new AZe(a,n.transformResults||[])}(r,t))):[]}function GZe(e,t){return{documents:[Oue(e,t.path)]}}function WZe(e,t){const r={structuredQuery:{}},i=t.path;let n;t.collectionGroup!==null?(n=i,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n=i.popLast(),r.structuredQuery.from=[{collectionId:i.lastSegment()}]),r.parent=Oue(e,n);const s=function(c){if(c.length!==0)return zue(ad.create(c,"and"))}(t.filters);s&&(r.structuredQuery.where=s);const a=function(c){if(c.length!==0)return c.map(u=>function(f){return{field:uy(f.field),direction:XZe(f.dir)}}(u))}(t.orderBy);a&&(r.structuredQuery.orderBy=a);const o=iz(e,t.limit);return o!==null&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(t.endAt)),{Vt:r,parent:n}}function qZe(e){let t=FZe(e.parent);const r=e.structuredQuery,i=r.from?r.from.length:0;let n=null;if(i>0){Ai(i===1,65062);const u=r.from[0];u.allDescendants?n=u.collectionId:t=t.child(u.collectionId)}let s=[];r.where&&(s=function(d){const f=Lue(d);return f instanceof ad&&fue(f)?f.getFilters():[f]}(r.where));let a=[];r.orderBy&&(a=function(d){return d.map(f=>function(v){return new PP(dy(v.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(f))}(r.orderBy));let o=null;r.limit&&(o=function(d){let f;return f=typeof d=="object"?d.value:d,uD(f)?null:f}(r.limit));let l=null;r.startAt&&(l=function(d){const f=!!d.before,m=d.values||[];return new MP(m,f)}(r.startAt));let c=null;return r.endAt&&(c=function(d){const f=!d.before,m=d.values||[];return new MP(m,f)}(r.endAt)),uZe(t,n,a,s,o,"F",l,c)}function YZe(e,t){const r=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return mr(28987,{purpose:n})}}(t.purpose);return r==null?null:{"goog-listen-tags":r}}function Lue(e){return e.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const i=dy(r.unaryFilter.field);return Ts.create(i,"==",{doubleValue:NaN});case"IS_NULL":const n=dy(r.unaryFilter.field);return Ts.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=dy(r.unaryFilter.field);return Ts.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=dy(r.unaryFilter.field);return Ts.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return mr(61313);default:return mr(60726)}}(e):e.fieldFilter!==void 0?function(r){return Ts.create(dy(r.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return mr(58110);default:return mr(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(e):e.compositeFilter!==void 0?function(r){return ad.create(r.compositeFilter.filters.map(i=>Lue(i)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return mr(1026)}}(r.compositeFilter.op))}(e):mr(30097,{filter:e})}function XZe(e){return OZe[e]}function $Ze(e){return jZe[e]}function KZe(e){return LZe[e]}function uy(e){return{fieldPath:e.canonicalString()}}function dy(e){return pa.fromServerFormat(e.fieldPath)}function zue(e){return e instanceof Ts?function(r){if(r.op==="=="){if(UQ(r.value))return{unaryFilter:{field:uy(r.field),op:"IS_NAN"}};if(VQ(r.value))return{unaryFilter:{field:uy(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(UQ(r.value))return{unaryFilter:{field:uy(r.field),op:"IS_NOT_NAN"}};if(VQ(r.value))return{unaryFilter:{field:uy(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:uy(r.field),op:$Ze(r.op),value:r.value}}}(e):e instanceof ad?function(r){const i=r.getFilters().map(n=>zue(n));return i.length===1?i[0]:{compositeFilter:{op:KZe(r.op),filters:i}}}(e):mr(54877,{filter:e})}function QZe(e){const t=[];return e.fields.forEach(r=>t.push(r.canonicalString())),{fieldPaths:t}}function Bue(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(t,r,i,n,s=Cr.min(),a=Cr.min(),o=ba.EMPTY_BYTE_STRING,l=null){this.target=t,this.targetId=r,this.purpose=i,this.sequenceNumber=n,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(t){return new yp(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,r){return new yp(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new yp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new yp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZZe{constructor(t){this.gt=t}}function JZe(e){const t=qZe({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?rz(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eJe{constructor(){this.Dn=new tJe}addToCollectionParentIndex(t,r){return this.Dn.add(r),lt.resolve()}getCollectionParents(t,r){return lt.resolve(this.Dn.getEntries(r))}addFieldIndex(t,r){return lt.resolve()}deleteFieldIndex(t,r){return lt.resolve()}deleteAllFieldIndexes(t){return lt.resolve()}createTargetIndexes(t,r){return lt.resolve()}getDocumentsMatchingTarget(t,r){return lt.resolve(null)}getIndexType(t,r){return lt.resolve(0)}getFieldIndexes(t,r){return lt.resolve([])}getNextCollectionGroupToUpdate(t){return lt.resolve(null)}getMinOffset(t,r){return lt.resolve(Up.min())}getMinOffsetFromCollectionGroup(t,r){return lt.resolve(Up.min())}updateCollectionGroup(t,r,i){return lt.resolve()}updateIndexEntries(t,r){return lt.resolve()}}class tJe{constructor(){this.index={}}add(t){const r=t.lastSegment(),i=t.popLast(),n=this.index[r]||new Ms(mn.comparator),s=!n.has(i);return this.index[r]=n.add(i),s}has(t){const r=t.lastSegment(),i=t.popLast(),n=this.index[r];return n&&n.has(i)}getEntries(t){return(this.index[t]||new Ms(mn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rZ={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Fue=41943040;class _o{static withCacheSize(t){return new _o(t,_o.DEFAULT_COLLECTION_PERCENTILE,_o.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,r,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_o.DEFAULT_COLLECTION_PERCENTILE=10,_o.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_o.DEFAULT=new _o(Fue,_o.DEFAULT_COLLECTION_PERCENTILE,_o.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_o.DISABLED=new _o(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new Dx(0)}static ur(){return new Dx(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iZ="LruGarbageCollector",rJe=1048576;function nZ([e,t],[r,i]){const n=Vr(e,r);return n===0?Vr(t,i):n}class iJe{constructor(t){this.Tr=t,this.buffer=new Ms(nZ),this.Ir=0}dr(){return++this.Ir}Er(t){const r=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{const i=this.buffer.last();nZ(r,i)<0&&(this.buffer=this.buffer.delete(i).add(r))}}get maxValue(){return this.buffer.last()[0]}}class nJe{constructor(t,r,i){this.garbageCollector=t,this.asyncQueue=r,this.localStore=i,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(t){It(iZ,`Garbage collection scheduled in ${t}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){hb(r)?It(iZ,"Ignoring IndexedDB error during garbage collection: ",r):await db(r)}await this.Rr(3e5)})}}class sJe{constructor(t,r){this.Vr=t,this.params=r}calculateTargetCount(t,r){return this.Vr.mr(t).next(i=>Math.floor(r/100*i))}nthSequenceNumber(t,r){if(r===0)return lt.resolve(cD.ue);const i=new iJe(r);return this.Vr.forEachTarget(t,n=>i.Er(n.sequenceNumber)).next(()=>this.Vr.gr(t,n=>i.Er(n))).next(()=>i.maxValue)}removeTargets(t,r,i){return this.Vr.removeTargets(t,r,i)}removeOrphanedDocuments(t,r){return this.Vr.removeOrphanedDocuments(t,r)}collect(t,r){return this.params.cacheSizeCollectionThreshold===-1?(It("LruGarbageCollector","Garbage collection skipped; disabled"),lt.resolve(rZ)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(It("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rZ):this.pr(t,r))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,r){let i,n,s,a,o,l,c;const u=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(It("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),n=this.params.maximumSequenceNumbersToCollect):n=d,a=Date.now(),this.nthSequenceNumber(t,n))).next(d=>(i=d,o=Date.now(),this.removeTargets(t,i,r))).next(d=>(s=d,l=Date.now(),this.removeOrphanedDocuments(t,i))).next(d=>(c=Date.now(),ly()<=Kr.DEBUG&&It("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-u}ms
	Determined least recently used ${n} in `+(o-a)+`ms
	Removed ${s} targets in `+(l-o)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),lt.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:s,documentsRemoved:d})))}}function aJe(e,t){return new sJe(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oJe{constructor(){this.changes=new b0(t=>t.toString(),(t,r)=>t.isEqual(r)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,r){this.assertNotApplied(),this.changes.set(t,Ia.newInvalidDocument(t).setReadTime(r))}getEntry(t,r){this.assertNotApplied();const i=this.changes.get(r);return i!==void 0?lt.resolve(i):this.getFromCache(t,r)}getEntries(t,r){return this.getAllFromCache(t,r)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lJe{constructor(t,r){this.overlayedDocument=t,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cJe{constructor(t,r,i,n){this.remoteDocumentCache=t,this.mutationQueue=r,this.documentOverlayCache=i,this.indexManager=n}getDocument(t,r){let i=null;return this.documentOverlayCache.getOverlay(t,r).next(n=>(i=n,this.remoteDocumentCache.getEntry(t,r))).next(n=>(i!==null&&d2(i.mutation,n,Mc.empty(),sn.now()),n))}getDocuments(t,r){return this.remoteDocumentCache.getEntries(t,r).next(i=>this.getLocalViewOfDocuments(t,i,Qr()).next(()=>i))}getLocalViewOfDocuments(t,r,i=Qr()){const n=bg();return this.populateOverlays(t,n,r).next(()=>this.computeViews(t,r,n,i).next(s=>{let a=Pw();return s.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(t,r){const i=bg();return this.populateOverlays(t,i,r).next(()=>this.computeViews(t,r,i,Qr()))}populateOverlays(t,r,i){const n=[];return i.forEach(s=>{r.has(s)||n.push(s)}),this.documentOverlayCache.getOverlays(t,n).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(t,r,i,n){let s=Hh();const a=u2(),o=function(){return u2()}();return r.forEach((l,c)=>{const u=i.get(c.key);n.has(c.key)&&(u===void 0||u.mutation instanceof w0)?s=s.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),d2(u.mutation,c,u.mutation.getFieldMask(),sn.now())):a.set(c.key,Mc.empty())}),this.recalculateAndSaveOverlays(t,s).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var d;return o.set(c,new lJe(u,(d=a.get(c))!==null&&d!==void 0?d:null))}),o))}recalculateAndSaveOverlays(t,r){const i=u2();let n=new bn((a,o)=>a-o),s=Qr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=i.get(l)||Mc.empty();u=o.applyToLocalView(c,u),i.set(l,u);const d=(n.get(o.batchId)||Qr()).add(l);n=n.insert(o.batchId,d)})}).next(()=>{const a=[],o=n.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,d=wue();u.forEach(f=>{if(!s.has(f)){const m=Tue(r.get(f),i.get(f));m!==null&&d.set(f,m),s=s.add(f)}}),a.push(this.documentOverlayCache.saveOverlays(t,c,d))}return lt.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,r){return this.remoteDocumentCache.getEntries(t,r).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,r,i,n){return function(a){return cr.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(t,r.path):dZe(r)?this.getDocumentsMatchingCollectionGroupQuery(t,r,i,n):this.getDocumentsMatchingCollectionQuery(t,r,i,n)}getNextDocuments(t,r,i,n){return this.remoteDocumentCache.getAllFromCollectionGroup(t,r,i,n).next(s=>{const a=n-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,r,i.largestBatchId,n-s.size):lt.resolve(bg());let o=J2,l=s;return a.next(c=>lt.forEach(c,(u,d)=>(o<d.largestBatchId&&(o=d.largestBatchId),s.get(u)?lt.resolve():this.remoteDocumentCache.getEntry(t,u).next(f=>{l=l.insert(u,f)}))).next(()=>this.populateOverlays(t,c,s)).next(()=>this.computeViews(t,l,c,Qr())).next(u=>({batchId:o,changes:bue(u)})))})}getDocumentsMatchingDocumentQuery(t,r){return this.getDocument(t,new cr(r)).next(i=>{let n=Pw();return i.isFoundDocument()&&(n=n.insert(i.key,i)),n})}getDocumentsMatchingCollectionGroupQuery(t,r,i,n){const s=r.collectionGroup;let a=Pw();return this.indexManager.getCollectionParents(t,s).next(o=>lt.forEach(o,l=>{const c=function(d,f){return new hD(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,l.child(s));return this.getDocumentsMatchingCollectionQuery(t,c,i,n).next(u=>{u.forEach((d,f)=>{a=a.insert(d,f)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(t,r,i,n){let s;return this.documentOverlayCache.getOverlaysForCollection(t,r.path,i.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(t,r,i,s,n))).next(a=>{s.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,Ia.newInvalidDocument(u)))});let o=Pw();return a.forEach((l,c)=>{const u=s.get(l);u!==void 0&&d2(u.mutation,c,Mc.empty(),sn.now()),pD(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uJe{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,r){return lt.resolve(this.Br.get(r))}saveBundleMetadata(t,r){return this.Br.set(r.id,function(n){return{id:n.id,version:n.version,createTime:Wu(n.createTime)}}(r)),lt.resolve()}getNamedQuery(t,r){return lt.resolve(this.Lr.get(r))}saveNamedQuery(t,r){return this.Lr.set(r.name,function(n){return{name:n.name,query:JZe(n.bundledQuery),readTime:Wu(n.readTime)}}(r)),lt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dJe{constructor(){this.overlays=new bn(cr.comparator),this.kr=new Map}getOverlay(t,r){return lt.resolve(this.overlays.get(r))}getOverlays(t,r){const i=bg();return lt.forEach(r,n=>this.getOverlay(t,n).next(s=>{s!==null&&i.set(n,s)})).next(()=>i)}saveOverlays(t,r,i){return i.forEach((n,s)=>{this.wt(t,r,s)}),lt.resolve()}removeOverlaysForBatchId(t,r,i){const n=this.kr.get(i);return n!==void 0&&(n.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(i)),lt.resolve()}getOverlaysForCollection(t,r,i){const n=bg(),s=r.length+1,a=new cr(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>i&&n.set(l.getKey(),l)}return lt.resolve(n)}getOverlaysForCollectionGroup(t,r,i,n){let s=new bn((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>i){let u=s.get(c.largestBatchId);u===null&&(u=bg(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=bg(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=n)););return lt.resolve(o)}wt(t,r,i){const n=this.overlays.get(i.key);if(n!==null){const a=this.kr.get(n.largestBatchId).delete(i.key);this.kr.set(n.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new DZe(r,i));let s=this.kr.get(r);s===void 0&&(s=Qr(),this.kr.set(r,s)),this.kr.set(r,s.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hJe{constructor(){this.sessionToken=ba.EMPTY_BYTE_STRING}getSessionToken(t){return lt.resolve(this.sessionToken)}setSessionToken(t,r){return this.sessionToken=r,lt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{constructor(){this.qr=new Ms(Us.Qr),this.$r=new Ms(Us.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,r){const i=new Us(t,r);this.qr=this.qr.add(i),this.$r=this.$r.add(i)}Kr(t,r){t.forEach(i=>this.addReference(i,r))}removeReference(t,r){this.Wr(new Us(t,r))}Gr(t,r){t.forEach(i=>this.removeReference(i,r))}zr(t){const r=new cr(new mn([])),i=new Us(r,t),n=new Us(r,t+1),s=[];return this.$r.forEachInRange([i,n],a=>{this.Wr(a),s.push(a.key)}),s}jr(){this.qr.forEach(t=>this.Wr(t))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const r=new cr(new mn([])),i=new Us(r,t),n=new Us(r,t+1);let s=Qr();return this.$r.forEachInRange([i,n],a=>{s=s.add(a.key)}),s}containsKey(t){const r=new Us(t,0),i=this.qr.firstAfterOrEqual(r);return i!==null&&t.isEqual(i.key)}}class Us{constructor(t,r){this.key=t,this.Hr=r}static Qr(t,r){return cr.comparator(t.key,r.key)||Vr(t.Hr,r.Hr)}static Ur(t,r){return Vr(t.Hr,r.Hr)||cr.comparator(t.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fJe{constructor(t,r){this.indexManager=t,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new Ms(Us.Qr)}checkEmpty(t){return lt.resolve(this.mutationQueue.length===0)}addMutationBatch(t,r,i,n){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new PZe(s,r,i,n);this.mutationQueue.push(a);for(const o of n)this.Yr=this.Yr.add(new Us(o.key,s)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return lt.resolve(a)}lookupMutationBatch(t,r){return lt.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(t,r){const i=r+1,n=this.Xr(i),s=n<0?0:n;return lt.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return lt.resolve(this.mutationQueue.length===0?VF:this.er-1)}getAllMutationBatches(t){return lt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,r){const i=new Us(r,0),n=new Us(r,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([i,n],a=>{const o=this.Zr(a.Hr);s.push(o)}),lt.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,r){let i=new Ms(Vr);return r.forEach(n=>{const s=new Us(n,0),a=new Us(n,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,a],o=>{i=i.add(o.Hr)})}),lt.resolve(this.ei(i))}getAllMutationBatchesAffectingQuery(t,r){const i=r.path,n=i.length+1;let s=i;cr.isDocumentKey(s)||(s=s.child(""));const a=new Us(new cr(s),0);let o=new Ms(Vr);return this.Yr.forEachWhile(l=>{const c=l.key.path;return!!i.isPrefixOf(c)&&(c.length===n&&(o=o.add(l.Hr)),!0)},a),lt.resolve(this.ei(o))}ei(t){const r=[];return t.forEach(i=>{const n=this.Zr(i);n!==null&&r.push(n)}),r}removeMutationBatch(t,r){Ai(this.ti(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Yr;return lt.forEach(r.mutations,n=>{const s=new Us(n.key,r.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,n.key)}).next(()=>{this.Yr=i})}rr(t){}containsKey(t,r){const i=new Us(r,0),n=this.Yr.firstAfterOrEqual(i);return lt.resolve(r.isEqual(n&&n.key))}performConsistencyCheck(t){return this.mutationQueue.length,lt.resolve()}ti(t,r){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const r=this.Xr(t);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pJe{constructor(t){this.ni=t,this.docs=function(){return new bn(cr.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,r){const i=r.key,n=this.docs.get(i),s=n?n.size:0,a=this.ni(r);return this.docs=this.docs.insert(i,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const r=this.docs.get(t);r&&(this.docs=this.docs.remove(t),this.size-=r.size)}getEntry(t,r){const i=this.docs.get(r);return lt.resolve(i?i.document.mutableCopy():Ia.newInvalidDocument(r))}getEntries(t,r){let i=Hh();return r.forEach(n=>{const s=this.docs.get(n);i=i.insert(n,s?s.document.mutableCopy():Ia.newInvalidDocument(n))}),lt.resolve(i)}getDocumentsMatchingQuery(t,r,i,n){let s=Hh();const a=r.path,o=new cr(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||UQe(VQe(u),i)<=0||(n.has(u.key)||pD(r,u))&&(s=s.insert(u.key,u.mutableCopy()))}return lt.resolve(s)}getAllFromCollectionGroup(t,r,i,n){mr(9500)}ri(t,r){return lt.forEach(this.docs,i=>r(i))}newChangeBuffer(t){return new mJe(this)}getSize(t){return lt.resolve(this.size)}}class mJe extends oJe{constructor(t){super(),this.Or=t}applyChanges(t){const r=[];return this.changes.forEach((i,n)=>{n.isValidDocument()?r.push(this.Or.addEntry(t,n)):this.Or.removeEntry(i)}),lt.waitFor(r)}getFromCache(t,r){return this.Or.getEntry(t,r)}getAllFromCache(t,r){return this.Or.getEntries(t,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gJe{constructor(t){this.persistence=t,this.ii=new b0(r=>GF(r),WF),this.lastRemoteSnapshotVersion=Cr.min(),this.highestTargetId=0,this.si=0,this.oi=new QF,this.targetCount=0,this._i=Dx.ar()}forEachTarget(t,r){return this.ii.forEach((i,n)=>r(n)),lt.resolve()}getLastRemoteSnapshotVersion(t){return lt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return lt.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),lt.resolve(this.highestTargetId)}setTargetsMetadata(t,r,i){return i&&(this.lastRemoteSnapshotVersion=i),r>this.si&&(this.si=r),lt.resolve()}hr(t){this.ii.set(t.target,t);const r=t.targetId;r>this.highestTargetId&&(this._i=new Dx(r),this.highestTargetId=r),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,r){return this.hr(r),this.targetCount+=1,lt.resolve()}updateTargetData(t,r){return this.hr(r),lt.resolve()}removeTargetData(t,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,lt.resolve()}removeTargets(t,r,i){let n=0;const s=[];return this.ii.forEach((a,o)=>{o.sequenceNumber<=r&&i.get(o.targetId)===null&&(this.ii.delete(a),s.push(this.removeMatchingKeysForTargetId(t,o.targetId)),n++)}),lt.waitFor(s).next(()=>n)}getTargetCount(t){return lt.resolve(this.targetCount)}getTargetData(t,r){const i=this.ii.get(r)||null;return lt.resolve(i)}addMatchingKeys(t,r,i){return this.oi.Kr(r,i),lt.resolve()}removeMatchingKeys(t,r,i){this.oi.Gr(r,i);const n=this.persistence.referenceDelegate,s=[];return n&&r.forEach(a=>{s.push(n.markPotentiallyOrphaned(t,a))}),lt.waitFor(s)}removeMatchingKeysForTargetId(t,r){return this.oi.zr(r),lt.resolve()}getMatchingKeysForTargetId(t,r){const i=this.oi.Jr(r);return lt.resolve(i)}containsKey(t,r){return lt.resolve(this.oi.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vue{constructor(t,r){this.ai={},this.overlays={},this.ui=new cD(0),this.ci=!1,this.ci=!0,this.li=new hJe,this.referenceDelegate=t(this),this.hi=new gJe(this),this.indexManager=new eJe,this.remoteDocumentCache=function(n){return new pJe(n)}(i=>this.referenceDelegate.Pi(i)),this.serializer=new ZZe(r),this.Ti=new uJe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let r=this.overlays[t.toKey()];return r||(r=new dJe,this.overlays[t.toKey()]=r),r}getMutationQueue(t,r){let i=this.ai[t.toKey()];return i||(i=new fJe(r,this.referenceDelegate),this.ai[t.toKey()]=i),i}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,r,i){It("MemoryPersistence","Starting transaction:",t);const n=new vJe(this.ui.next());return this.referenceDelegate.Ii(),i(n).next(s=>this.referenceDelegate.di(n).next(()=>s)).toPromise().then(s=>(n.raiseOnCommittedEvent(),s))}Ei(t,r){return lt.or(Object.values(this.ai).map(i=>()=>i.containsKey(t,r)))}}class vJe extends GQe{constructor(t){super(),this.currentSequenceNumber=t}}class ZF{constructor(t){this.persistence=t,this.Ai=new QF,this.Ri=null}static Vi(t){return new ZF(t)}get mi(){if(this.Ri)return this.Ri;throw mr(60996)}addReference(t,r,i){return this.Ai.addReference(i,r),this.mi.delete(i.toString()),lt.resolve()}removeReference(t,r,i){return this.Ai.removeReference(i,r),this.mi.add(i.toString()),lt.resolve()}markPotentiallyOrphaned(t,r){return this.mi.add(r.toString()),lt.resolve()}removeTarget(t,r){this.Ai.zr(r.targetId).forEach(n=>this.mi.add(n.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,r.targetId).next(n=>{n.forEach(s=>this.mi.add(s.toString()))}).next(()=>i.removeTargetData(t,r))}Ii(){this.Ri=new Set}di(t){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return lt.forEach(this.mi,i=>{const n=cr.fromPath(i);return this.fi(t,n).next(s=>{s||r.removeEntry(n,Cr.min())})}).next(()=>(this.Ri=null,r.apply(t)))}updateLimboDocument(t,r){return this.fi(t,r).next(i=>{i?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(t){return 0}fi(t,r){return lt.or([()=>lt.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(t,r),()=>this.persistence.Ei(t,r)])}}class RP{constructor(t,r){this.persistence=t,this.gi=new b0(i=>YQe(i.path),(i,n)=>i.isEqual(n)),this.garbageCollector=aJe(this,r)}static Vi(t,r){return new RP(t,r)}Ii(){}di(t){return lt.resolve()}forEachTarget(t,r){return this.persistence.getTargetCache().forEachTarget(t,r)}mr(t){const r=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next(i=>r.next(n=>i+n))}yr(t){let r=0;return this.gr(t,i=>{r++}).next(()=>r)}gr(t,r){return lt.forEach(this.gi,(i,n)=>this.Sr(t,i,n).next(s=>s?lt.resolve():r(n)))}removeTargets(t,r,i){return this.persistence.getTargetCache().removeTargets(t,r,i)}removeOrphanedDocuments(t,r){let i=0;const n=this.persistence.getRemoteDocumentCache(),s=n.newChangeBuffer();return n.ri(t,a=>this.Sr(t,a,r).next(o=>{o||(i++,s.removeEntry(a,Cr.min()))})).next(()=>s.apply(t)).next(()=>i)}markPotentiallyOrphaned(t,r){return this.gi.set(r,t.currentSequenceNumber),lt.resolve()}removeTarget(t,r){const i=r.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,r,i){return this.gi.set(i,t.currentSequenceNumber),lt.resolve()}removeReference(t,r,i){return this.gi.set(i,t.currentSequenceNumber),lt.resolve()}updateLimboDocument(t,r){return this.gi.set(r,t.currentSequenceNumber),lt.resolve()}Pi(t){let r=t.key.toString().length;return t.isFoundDocument()&&(r+=CT(t.data.value)),r}Sr(t,r,i){return lt.or([()=>this.persistence.Ei(t,r),()=>this.persistence.getTargetCache().containsKey(t,r),()=>{const n=this.gi.get(r);return lt.resolve(n!==void 0&&n>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(t,r,i,n){this.targetId=t,this.fromCache=r,this.Is=i,this.ds=n}static Es(t,r){let i=Qr(),n=Qr();for(const s of r.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:n=n.add(s.doc.key)}return new JF(t,r.fromCache,i,n)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yJe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xJe{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return uXe()?8:WQe(Va())>0?6:4}()}initialize(t,r){this.gs=t,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(t,r,i,n){const s={result:null};return this.ps(t,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ys(t,r,n,i).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new yJe;return this.ws(t,r,a).next(o=>{if(s.result=o,this.Rs)return this.Ss(t,r,a,o.size)})}).next(()=>s.result)}Ss(t,r,i,n){return i.documentReadCount<this.Vs?(ly()<=Kr.DEBUG&&It("QueryEngine","SDK will not create cache indexes for query:",cy(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),lt.resolve()):(ly()<=Kr.DEBUG&&It("QueryEngine","Query:",cy(r),"scans",i.documentReadCount,"local documents and returns",n,"documents as results."),i.documentReadCount>this.fs*n?(ly()<=Kr.DEBUG&&It("QueryEngine","The SDK decides to create cache indexes for query:",cy(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Gu(r))):lt.resolve())}ps(t,r){if(qQ(r))return lt.resolve(null);let i=Gu(r);return this.indexManager.getIndexType(t,i).next(n=>n===0?null:(r.limit!==null&&n===1&&(r=rz(r,null,"F"),i=Gu(r)),this.indexManager.getDocumentsMatchingTarget(t,i).next(s=>{const a=Qr(...s);return this.gs.getDocuments(t,a).next(o=>this.indexManager.getMinOffset(t,i).next(l=>{const c=this.bs(r,o);return this.Ds(r,c,a,l.readTime)?this.ps(t,rz(r,null,"F")):this.vs(t,c,r,l)}))})))}ys(t,r,i,n){return qQ(r)||n.isEqual(Cr.min())?lt.resolve(null):this.gs.getDocuments(t,i).next(s=>{const a=this.bs(r,s);return this.Ds(r,a,i,n)?lt.resolve(null):(ly()<=Kr.DEBUG&&It("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),cy(r)),this.vs(t,a,r,FQe(n,J2)).next(o=>o))})}bs(t,r){let i=new Ms(yue(t));return r.forEach((n,s)=>{pD(t,s)&&(i=i.add(s))}),i}Ds(t,r,i,n){if(t.limit===null)return!1;if(i.size!==r.size)return!0;const s=t.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(n)>0)}ws(t,r,i){return ly()<=Kr.DEBUG&&It("QueryEngine","Using full collection scan to execute query:",cy(r)),this.gs.getDocumentsMatchingQuery(t,r,Up.min(),i)}vs(t,r,i,n){return this.gs.getDocumentsMatchingQuery(t,i,n).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eV="LocalStore",bJe=3e8;class wJe{constructor(t,r,i,n){this.persistence=t,this.Cs=r,this.serializer=n,this.Fs=new bn(Vr),this.Ms=new b0(s=>GF(s),WF),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(i)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new cJe(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>t.collect(r,this.Fs))}}function _Je(e,t,r,i){return new wJe(e,t,r,i)}async function Uue(e,t){const r=Nr(e);return await r.persistence.runTransaction("Handle user change","readonly",i=>{let n;return r.mutationQueue.getAllMutationBatches(i).next(s=>(n=s,r.Ns(t),r.mutationQueue.getAllMutationBatches(i))).next(s=>{const a=[],o=[];let l=Qr();for(const c of n){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(i,l).next(c=>({Bs:c,removedBatchIds:a,addedBatchIds:o}))})})}function SJe(e,t){const r=Nr(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const n=t.batch.keys(),s=r.Os.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const d=c.batch,f=d.keys();let m=lt.resolve();return f.forEach(v=>{m=m.next(()=>u.getEntry(l,v)).next(y=>{const x=c.docVersions.get(v);Ai(x!==null,48541),y.version.compareTo(x)<0&&(d.applyToRemoteDocument(y,c),y.isValidDocument()&&(y.setReadTime(c.commitVersion),u.addEntry(y)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,d))}(r,i,t,s).next(()=>s.apply(i)).next(()=>r.mutationQueue.performConsistencyCheck(i)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(i,n,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(o){let l=Qr();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(t))).next(()=>r.localDocuments.getDocuments(i,n))})}function Hue(e){const t=Nr(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",r=>t.hi.getLastRemoteSnapshotVersion(r))}function EJe(e,t){const r=Nr(e),i=t.snapshotVersion;let n=r.Fs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=r.Os.newChangeBuffer({trackRemovals:!0});n=r.Fs;const o=[];t.targetChanges.forEach((u,d)=>{const f=n.get(d);if(!f)return;o.push(r.hi.removeMatchingKeys(s,u.removedDocuments,d).next(()=>r.hi.addMatchingKeys(s,u.addedDocuments,d)));let m=f.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(d)!==null?m=m.withResumeToken(ba.EMPTY_BYTE_STRING,Cr.min()).withLastLimboFreeSnapshotVersion(Cr.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,i)),n=n.insert(d,m),function(y,x,w){return y.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=bJe?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(f,m,u)&&o.push(r.hi.updateTargetData(s,m))});let l=Hh(),c=Qr();if(t.documentUpdates.forEach(u=>{t.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(s,u))}),o.push(AJe(s,a,t.documentUpdates).next(u=>{l=u.Ls,c=u.ks})),!i.isEqual(Cr.min())){const u=r.hi.getLastRemoteSnapshotVersion(s).next(d=>r.hi.setTargetsMetadata(s,s.currentSequenceNumber,i));o.push(u)}return lt.waitFor(o).next(()=>a.apply(s)).next(()=>r.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(r.Fs=n,s))}function AJe(e,t,r){let i=Qr(),n=Qr();return r.forEach(s=>i=i.add(s)),t.getEntries(e,i).next(s=>{let a=Hh();return r.forEach((o,l)=>{const c=s.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(n=n.add(o)),l.isNoDocument()&&l.version.isEqual(Cr.min())?(t.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(t.addEntry(l),a=a.insert(o,l)):It(eV,"Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ls:a,ks:n}})}function CJe(e,t){const r=Nr(e);return r.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=VF),r.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function TJe(e,t){const r=Nr(e);return r.persistence.runTransaction("Allocate target","readwrite",i=>{let n;return r.hi.getTargetData(i,t).next(s=>s?(n=s,lt.resolve(n)):r.hi.allocateTargetId(i).next(a=>(n=new yp(t,a,"TargetPurposeListen",i.currentSequenceNumber),r.hi.addTargetData(i,n).next(()=>n))))}).then(i=>{const n=r.Fs.get(i.targetId);return(n===null||i.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(r.Fs=r.Fs.insert(i.targetId,i),r.Ms.set(t,i.targetId)),i})}async function oz(e,t,r){const i=Nr(e),n=i.Fs.get(t),s=r?"readwrite":"readwrite-primary";try{r||await i.persistence.runTransaction("Release target",s,a=>i.persistence.referenceDelegate.removeTarget(a,n))}catch(a){if(!hb(a))throw a;It(eV,`Failed to update sequence numbers for target ${t}: ${a}`)}i.Fs=i.Fs.remove(t),i.Ms.delete(n.target)}function sZ(e,t,r){const i=Nr(e);let n=Cr.min(),s=Qr();return i.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const d=Nr(l),f=d.Ms.get(u);return f!==void 0?lt.resolve(d.Fs.get(f)):d.hi.getTargetData(c,u)}(i,a,Gu(t)).next(o=>{if(o)return n=o.lastLimboFreeSnapshotVersion,i.hi.getMatchingKeysForTargetId(a,o.targetId).next(l=>{s=l})}).next(()=>i.Cs.getDocumentsMatchingQuery(a,t,r?n:Cr.min(),r?s:Qr())).next(o=>(MJe(i,fZe(t),o),{documents:o,qs:s})))}function MJe(e,t,r){let i=e.xs.get(t)||Cr.min();r.forEach((n,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),e.xs.set(t,i)}class aZ{constructor(){this.activeTargetIds=xZe()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class PJe{constructor(){this.Fo=new aZ,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,r,i){}addLocalQueryTarget(t,r=!0){return r&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,r,i){this.Mo[t]=r}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new aZ,Promise.resolve()}handleUserChange(t,r,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DJe{xo(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oZ="ConnectivityMonitor";class lZ{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){It(oZ,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){It(oZ,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wC=null;function lz(){return wC===null?wC=function(){return 268435456+Math.round(2147483648*Math.random())}():wC++,"0x"+wC.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eO="RestConnection",NJe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class kJe{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+t.host,this.Uo=`projects/${i}/databases/${n}`,this.Ko=this.databaseId.database===CP?`project_id=${i}`:`project_id=${i}&database_id=${n}`}Wo(t,r,i,n,s){const a=lz(),o=this.Go(t,r.toUriEncodedString());It(eO,`Sending RPC '${t}' ${a}:`,o,i);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(l,n,s);const{host:c}=new URL(o),u=ob(c);return this.jo(t,o,l,i,u).then(d=>(It(eO,`Received RPC '${t}' ${a}: `,d),d),d=>{throw Vp(eO,`RPC '${t}' ${a} failed with error: `,d,"url: ",o,"request:",i),d})}Jo(t,r,i,n,s,a){return this.Wo(t,r,i,n,s)}zo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ub}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((n,s)=>t[s]=n),i&&i.headers.forEach((n,s)=>t[s]=n)}Go(t,r){const i=NJe[t];return`${this.$o}/v1/${r}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RJe{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa="WebChannelConnection";class IJe extends kJe{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,r,i,n,s){const a=lz();return new Promise((o,l)=>{const c=new qce;c.setWithCredentials(!0),c.listenOnce(Yce.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case AT.NO_ERROR:const d=c.getResponseJson();It(Pa,`XHR for RPC '${t}' ${a} received:`,JSON.stringify(d)),o(d);break;case AT.TIMEOUT:It(Pa,`RPC '${t}' ${a} timed out`),l(new Kt(pt.DEADLINE_EXCEEDED,"Request time out"));break;case AT.HTTP_ERROR:const f=c.getStatus();if(It(Pa,`RPC '${t}' ${a} failed with status:`,f,"response text:",c.getResponseText()),f>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const v=m?.error;if(v&&v.status&&v.message){const y=function(w){const _=w.toLowerCase().replace(/_/g,"-");return Object.values(pt).indexOf(_)>=0?_:pt.UNKNOWN}(v.status);l(new Kt(y,v.message))}else l(new Kt(pt.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new Kt(pt.UNAVAILABLE,"Connection failed."));break;default:mr(9055,{c_:t,streamId:a,l_:c.getLastErrorCode(),h_:c.getLastError()})}}finally{It(Pa,`RPC '${t}' ${a} completed.`)}});const u=JSON.stringify(n);It(Pa,`RPC '${t}' ${a} sending request:`,n),c.send(r,"POST",u,i,15)})}P_(t,r,i){const n=lz(),s=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],a=Kce(),o=$ce(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.zo(l.initMessageHeaders,r,i),l.encodeInitMessageHeaders=!0;const u=s.join("");It(Pa,`Creating RPC '${t}' stream ${n}: ${u}`,l);const d=a.createWebChannel(u,l);this.T_(d);let f=!1,m=!1;const v=new RJe({Ho:x=>{m?It(Pa,`Not sending because RPC '${t}' stream ${n} is closed:`,x):(f||(It(Pa,`Opening RPC '${t}' stream ${n} transport.`),d.open(),f=!0),It(Pa,`RPC '${t}' stream ${n} sending:`,x),d.send(x))},Yo:()=>d.close()}),y=(x,w,_)=>{x.listen(w,S=>{try{_(S)}catch(P){setTimeout(()=>{throw P},0)}})};return y(d,Mw.EventType.OPEN,()=>{m||(It(Pa,`RPC '${t}' stream ${n} transport opened.`),v.s_())}),y(d,Mw.EventType.CLOSE,()=>{m||(m=!0,It(Pa,`RPC '${t}' stream ${n} transport closed`),v.__(),this.I_(d))}),y(d,Mw.EventType.ERROR,x=>{m||(m=!0,Vp(Pa,`RPC '${t}' stream ${n} transport errored. Name:`,x.name,"Message:",x.message),v.__(new Kt(pt.UNAVAILABLE,"The operation could not be completed")))}),y(d,Mw.EventType.MESSAGE,x=>{var w;if(!m){const _=x.data[0];Ai(!!_,16349);const S=_,P=S?.error||((w=S[0])===null||w===void 0?void 0:w.error);if(P){It(Pa,`RPC '${t}' stream ${n} received error:`,P);const M=P.status;let C=function(N){const D=Jn[N];if(D!==void 0)return Due(D)}(M),T=P.message;C===void 0&&(C=pt.INTERNAL,T="Unknown error status: "+M+" with message "+P.message),m=!0,v.__(new Kt(C,T)),d.close()}else It(Pa,`RPC '${t}' stream ${n} received:`,_),v.a_(_)}}),y(o,Xce.STAT_EVENT,x=>{x.stat===K5.PROXY?It(Pa,`RPC '${t}' stream ${n} detected buffering proxy`):x.stat===K5.NOPROXY&&It(Pa,`RPC '${t}' stream ${n} detected no buffering proxy`)}),setTimeout(()=>{v.o_()},0),v}terminate(){this.u_.forEach(t=>t.close()),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter(r=>r===t)}}function tO(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xD(e){return new zZe(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gue{constructor(t,r,i=1e3,n=1.5,s=6e4){this.Fi=t,this.timerId=r,this.d_=i,this.E_=n,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const r=Math.floor(this.R_+this.p_()),i=Math.max(0,Date.now()-this.m_),n=Math.max(0,r-i);n>0&&It("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${i} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,n,()=>(this.m_=Date.now(),t())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cZ="PersistentStream";class Wue{constructor(t,r,i,n,s,a,o,l){this.Fi=t,this.w_=i,this.S_=n,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Gue(t,r)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,t!==4?this.F_.reset():r&&r.code===pt.RESOURCE_EXHAUSTED?(Uh(r.toString()),Uh("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===pt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(r)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,n])=>{this.b_===r&&this.W_(i,n)},i=>{t(()=>{const n=new Kt(pt.UNKNOWN,"Fetching auth token failed: "+i.message);return this.G_(n)})})}W_(t,r){const i=this.K_(this.b_);this.stream=this.z_(t,r),this.stream.Zo(()=>{i(()=>this.listener.Zo())}),this.stream.e_(()=>{i(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(n=>{i(()=>this.G_(n))}),this.stream.onMessage(n=>{i(()=>++this.C_==1?this.j_(n):this.onNext(n))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(t){return It(cZ,`close with error: ${t}`),this.stream=null,this.close(4,t)}K_(t){return r=>{this.Fi.enqueueAndForget(()=>this.b_===t?r():(It(cZ,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class OJe extends Wue{constructor(t,r,i,n,s,a){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,n,a),this.serializer=s}z_(t,r){return this.connection.P_("Listen",t,r)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const r=VZe(this.serializer,t),i=function(s){if(!("targetChange"in s))return Cr.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?Cr.min():a.readTime?Wu(a.readTime):Cr.min()}(t);return this.listener.J_(r,i)}H_(t){const r={};r.database=az(this.serializer),r.addTarget=function(s,a){let o;const l=a.target;if(o=tz(l)?{documents:GZe(s,l)}:{query:WZe(s,l).Vt},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=Rue(s,a.resumeToken);const c=iz(s,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Cr.min())>0){o.readTime=kP(s,a.snapshotVersion.toTimestamp());const c=iz(s,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,t);const i=YZe(this.serializer,t);i&&(r.labels=i),this.k_(r)}Y_(t){const r={};r.database=az(this.serializer),r.removeTarget=t,this.k_(r)}}class jJe extends Wue{constructor(t,r,i,n,s,a){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,n,a),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(t,r){return this.connection.P_("Write",t,r)}j_(t){return Ai(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,Ai(!t.writeResults||t.writeResults.length===0,55816),this.listener.ea()}onNext(t){Ai(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.F_.reset();const r=HZe(t.writeResults,t.commitTime),i=Wu(t.commitTime);return this.listener.ta(i,r)}na(){const t={};t.database=az(this.serializer),this.k_(t)}X_(t){const r={streamToken:this.lastStreamToken,writes:t.map(i=>UZe(this.serializer,i))};this.k_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LJe{}class zJe extends LJe{constructor(t,r,i,n){super(),this.authCredentials=t,this.appCheckCredentials=r,this.connection=i,this.serializer=n,this.ra=!1}ia(){if(this.ra)throw new Kt(pt.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,r,i,n){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Wo(t,nz(r,i),n,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===pt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Kt(pt.UNKNOWN,s.toString())})}Jo(t,r,i,n,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Jo(t,nz(r,i),n,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===pt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Kt(pt.UNKNOWN,a.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class BJe{constructor(t,r){this.asyncQueue=t,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(t){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ua("Offline")))}set(t){this.ha(),this.sa=0,t==="Online"&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const r=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Uh(r),this._a=!1):It("OnlineStateTracker",r)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0="RemoteStore";class FJe{constructor(t,r,i,n,s){this.localStore=t,this.datastore=r,this.asyncQueue=i,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(a=>{i.enqueueAndForget(async()=>{_0(this)&&(It(i0,"Restarting streams for network reachability change."),await async function(l){const c=Nr(l);c.Ia.add(4),await iS(c),c.Aa.set("Unknown"),c.Ia.delete(4),await bD(c)}(this))})}),this.Aa=new BJe(i,n)}}async function bD(e){if(_0(e))for(const t of e.da)await t(!0)}async function iS(e){for(const t of e.da)await t(!1)}function que(e,t){const r=Nr(e);r.Ta.has(t.targetId)||(r.Ta.set(t.targetId,t),nV(r)?iV(r):fb(r).x_()&&rV(r,t))}function tV(e,t){const r=Nr(e),i=fb(r);r.Ta.delete(t),i.x_()&&Yue(r,t),r.Ta.size===0&&(i.x_()?i.B_():_0(r)&&r.Aa.set("Unknown"))}function rV(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Cr.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}fb(e).H_(t)}function Yue(e,t){e.Ra.$e(t),fb(e).Y_(t)}function iV(e){e.Ra=new IZe({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),fb(e).start(),e.Aa.aa()}function nV(e){return _0(e)&&!fb(e).M_()&&e.Ta.size>0}function _0(e){return Nr(e).Ia.size===0}function Xue(e){e.Ra=void 0}async function VJe(e){e.Aa.set("Online")}async function UJe(e){e.Ta.forEach((t,r)=>{rV(e,t)})}async function HJe(e,t){Xue(e),nV(e)?(e.Aa.la(t),iV(e)):e.Aa.set("Unknown")}async function GJe(e,t,r){if(e.Aa.set("Online"),t instanceof kue&&t.state===2&&t.cause)try{await async function(n,s){const a=s.cause;for(const o of s.targetIds)n.Ta.has(o)&&(await n.remoteSyncer.rejectListen(o,a),n.Ta.delete(o),n.Ra.removeTarget(o))}(e,t)}catch(i){It(i0,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await IP(e,i)}else if(t instanceof PT?e.Ra.Ye(t):t instanceof Nue?e.Ra.it(t):e.Ra.et(t),!r.isEqual(Cr.min()))try{const i=await Hue(e.localStore);r.compareTo(i)>=0&&await function(s,a){const o=s.Ra.Pt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=s.Ta.get(c);u&&s.Ta.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=s.Ta.get(l);if(!u)return;s.Ta.set(l,u.withResumeToken(ba.EMPTY_BYTE_STRING,u.snapshotVersion)),Yue(s,l);const d=new yp(u.target,l,c,u.sequenceNumber);rV(s,d)}),s.remoteSyncer.applyRemoteEvent(o)}(e,r)}catch(i){It(i0,"Failed to raise snapshot:",i),await IP(e,i)}}async function IP(e,t,r){if(!hb(t))throw t;e.Ia.add(1),await iS(e),e.Aa.set("Offline"),r||(r=()=>Hue(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{It(i0,"Retrying IndexedDB access"),await r(),e.Ia.delete(1),await bD(e)})}function $ue(e,t){return t().catch(r=>IP(e,r,t))}async function wD(e){const t=Nr(e),r=qp(t);let i=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:VF;for(;WJe(t);)try{const n=await CJe(t.localStore,i);if(n===null){t.Pa.length===0&&r.B_();break}i=n.batchId,qJe(t,n)}catch(n){await IP(t,n)}Kue(t)&&Que(t)}function WJe(e){return _0(e)&&e.Pa.length<10}function qJe(e,t){e.Pa.push(t);const r=qp(e);r.x_()&&r.Z_&&r.X_(t.mutations)}function Kue(e){return _0(e)&&!qp(e).M_()&&e.Pa.length>0}function Que(e){qp(e).start()}async function YJe(e){qp(e).na()}async function XJe(e){const t=qp(e);for(const r of e.Pa)t.X_(r.mutations)}async function $Je(e,t,r){const i=e.Pa.shift(),n=XF.from(i,t,r);await $ue(e,()=>e.remoteSyncer.applySuccessfulWrite(n)),await wD(e)}async function KJe(e,t){t&&qp(e).Z_&&await async function(i,n){if(function(a){return kZe(a)&&a!==pt.ABORTED}(n.code)){const s=i.Pa.shift();qp(i).N_(),await $ue(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,n)),await wD(i)}}(e,t),Kue(e)&&Que(e)}async function uZ(e,t){const r=Nr(e);r.asyncQueue.verifyOperationInProgress(),It(i0,"RemoteStore received new credentials");const i=_0(r);r.Ia.add(3),await iS(r),i&&r.Aa.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.Ia.delete(3),await bD(r)}async function QJe(e,t){const r=Nr(e);t?(r.Ia.delete(2),await bD(r)):t||(r.Ia.add(2),await iS(r),r.Aa.set("Unknown"))}function fb(e){return e.Va||(e.Va=function(r,i,n){const s=Nr(r);return s.ia(),new OJe(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(e.datastore,e.asyncQueue,{Zo:VJe.bind(null,e),e_:UJe.bind(null,e),n_:HJe.bind(null,e),J_:GJe.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),nV(e)?iV(e):e.Aa.set("Unknown")):(await e.Va.stop(),Xue(e))})),e.Va}function qp(e){return e.ma||(e.ma=function(r,i,n){const s=Nr(r);return s.ia(),new jJe(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,n)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:YJe.bind(null,e),n_:KJe.bind(null,e),ea:XJe.bind(null,e),ta:$Je.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await wD(e)):(await e.ma.stop(),e.Pa.length>0&&(It(i0,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(t,r,i,n,s){this.asyncQueue=t,this.timerId=r,this.targetTimeMs=i,this.op=n,this.removalCallback=s,this.deferred=new Rg,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,r,i,n,s){const a=Date.now()+i,o=new sV(t,r,a,n,s);return o.start(i),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Kt(pt.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function aV(e,t){if(Uh("AsyncQueue",`${t}: ${e}`),hb(e))return new Kt(pt.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{static emptySet(t){return new Xy(t.comparator)}constructor(t){this.comparator=t?(r,i)=>t(r,i)||cr.comparator(r.key,i.key):(r,i)=>cr.comparator(r.key,i.key),this.keyedMap=Pw(),this.sortedSet=new bn(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const r=this.keyedMap.get(t);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((r,i)=>(t(r),!1))}add(t){const r=this.delete(t.key);return r.copy(r.keyedMap.insert(t.key,t),r.sortedSet.insert(t,null))}delete(t){const r=this.get(t);return r?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(r)):this}isEqual(t){if(!(t instanceof Xy)||this.size!==t.size)return!1;const r=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;r.hasNext();){const n=r.getNext().key,s=i.getNext().key;if(!n.isEqual(s))return!1}return!0}toString(){const t=[];return this.forEach(r=>{t.push(r.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,r){const i=new Xy;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=r,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dZ{constructor(){this.fa=new bn(cr.comparator)}track(t){const r=t.doc.key,i=this.fa.get(r);i?t.type!==0&&i.type===3?this.fa=this.fa.insert(r,t):t.type===3&&i.type!==1?this.fa=this.fa.insert(r,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.fa=this.fa.insert(r,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.fa=this.fa.insert(r,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.fa=this.fa.remove(r):t.type===1&&i.type===2?this.fa=this.fa.insert(r,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.fa=this.fa.insert(r,{type:2,doc:t.doc}):mr(63341,{At:t,ga:i}):this.fa=this.fa.insert(r,t)}pa(){const t=[];return this.fa.inorderTraversal((r,i)=>{t.push(i)}),t}}class Nx{constructor(t,r,i,n,s,a,o,l,c){this.query=t,this.docs=r,this.oldDocs=i,this.docChanges=n,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(t,r,i,n,s){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Nx(t,r,Xy.emptySet(r),a,i,n,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&fD(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const r=this.docChanges,i=t.docChanges;if(r.length!==i.length)return!1;for(let n=0;n<r.length;n++)if(r[n].type!==i[n].type||!r[n].doc.isEqual(i[n].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZJe{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(t=>t.ba())}}class JJe{constructor(){this.queries=hZ(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(r,i){const n=Nr(r),s=n.queries;n.queries=hZ(),s.forEach((a,o)=>{for(const l of o.wa)l.onError(i)})})(this,new Kt(pt.ABORTED,"Firestore shutting down"))}}function hZ(){return new b0(e=>vue(e),fD)}async function eet(e,t){const r=Nr(e);let i=3;const n=t.query;let s=r.queries.get(n);s?!s.Sa()&&t.ba()&&(i=2):(s=new ZJe,i=t.ba()?0:1);try{switch(i){case 0:s.ya=await r.onListen(n,!0);break;case 1:s.ya=await r.onListen(n,!1);break;case 2:await r.onFirstRemoteStoreListen(n)}}catch(a){const o=aV(a,`Initialization of query '${cy(t.query)}' failed`);return void t.onError(o)}r.queries.set(n,s),s.wa.push(t),t.va(r.onlineState),s.ya&&t.Ca(s.ya)&&oV(r)}async function tet(e,t){const r=Nr(e),i=t.query;let n=3;const s=r.queries.get(i);if(s){const a=s.wa.indexOf(t);a>=0&&(s.wa.splice(a,1),s.wa.length===0?n=t.ba()?0:1:!s.Sa()&&t.ba()&&(n=2))}switch(n){case 0:return r.queries.delete(i),r.onUnlisten(i,!0);case 1:return r.queries.delete(i),r.onUnlisten(i,!1);case 2:return r.onLastRemoteStoreUnlisten(i);default:return}}function ret(e,t){const r=Nr(e);let i=!1;for(const n of t){const s=n.query,a=r.queries.get(s);if(a){for(const o of a.wa)o.Ca(n)&&(i=!0);a.ya=n}}i&&oV(r)}function iet(e,t,r){const i=Nr(e),n=i.queries.get(t);if(n)for(const s of n.wa)s.onError(r);i.queries.delete(t)}function oV(e){e.Da.forEach(t=>{t.next()})}var cz,fZ;(fZ=cz||(cz={})).Fa="default",fZ.Cache="cache";class net{constructor(t,r,i){this.query=t,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=i||{}}Ca(t){if(!this.options.includeMetadataChanges){const i=[];for(const n of t.docChanges)n.type!==3&&i.push(n);t=new Nx(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let r=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),r=!0):this.Ba(t,this.onlineState)&&(this.La(t),r=!0),this.Oa=t,r}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),r=!0),r}Ba(t,r){if(!t.fromCache||!this.ba())return!0;const i=r!=="Offline";return(!this.options.ka||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||r==="Offline")}Na(t){if(t.docChanges.length>0)return!0;const r=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}La(t){t=Nx.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==cz.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zue{constructor(t){this.key=t}}class Jue{constructor(t){this.key=t}}class set{constructor(t,r){this.query=t,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Qr(),this.mutatedKeys=Qr(),this.Xa=yue(t),this.eu=new Xy(this.Xa)}get tu(){return this.Ha}nu(t,r){const i=r?r.ru:new dZ,n=r?r.eu:this.eu;let s=r?r.mutatedKeys:this.mutatedKeys,a=n,o=!1;const l=this.query.limitType==="F"&&n.size===this.query.limit?n.last():null,c=this.query.limitType==="L"&&n.size===this.query.limit?n.first():null;if(t.inorderTraversal((u,d)=>{const f=n.get(u),m=pD(this.query,d)?d:null,v=!!f&&this.mutatedKeys.has(f.key),y=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let x=!1;f&&m?f.data.isEqual(m.data)?v!==y&&(i.track({type:3,doc:m}),x=!0):this.iu(f,m)||(i.track({type:2,doc:m}),x=!0,(l&&this.Xa(m,l)>0||c&&this.Xa(m,c)<0)&&(o=!0)):!f&&m?(i.track({type:0,doc:m}),x=!0):f&&!m&&(i.track({type:1,doc:f}),x=!0,(l||c)&&(o=!0)),x&&(m?(a=a.add(m),s=y?s.add(u):s.delete(u)):(a=a.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),s=s.delete(u.key),i.track({type:1,doc:u})}return{eu:a,ru:i,Ds:o,mutatedKeys:s}}iu(t,r){return t.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(t,r,i,n){const s=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const a=t.ru.pa();a.sort((u,d)=>function(m,v){const y=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return mr(20277,{At:x})}};return y(m)-y(v)}(u.type,d.type)||this.Xa(u.doc,d.doc)),this.su(i),n=n!=null&&n;const o=r&&!n?this.ou():[],l=this.Za.size===0&&this.current&&!n?1:0,c=l!==this.Ya;return this.Ya=l,a.length!==0||c?{snapshot:new Nx(this.query,t.eu,s,a,t.mutatedKeys,l===0,c,!1,!!i&&i.resumeToken.approximateByteSize()>0),_u:o}:{_u:o}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new dZ,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),t.modifiedDocuments.forEach(r=>{}),t.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=Qr(),this.eu.forEach(i=>{this.au(i.key)&&(this.Za=this.Za.add(i.key))});const r=[];return t.forEach(i=>{this.Za.has(i)||r.push(new Jue(i))}),this.Za.forEach(i=>{t.has(i)||r.push(new Zue(i))}),r}uu(t){this.Ha=t.qs,this.Za=Qr();const r=this.nu(t.documents);return this.applyChanges(r,!0)}cu(){return Nx.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const lV="SyncEngine";class aet{constructor(t,r,i){this.query=t,this.targetId=r,this.view=i}}class oet{constructor(t){this.key=t,this.lu=!1}}class cet{constructor(t,r,i,n,s,a){this.localStore=t,this.remoteStore=r,this.eventManager=i,this.sharedClientState=n,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new b0(o=>vue(o),fD),this.Tu=new Map,this.Iu=new Set,this.du=new bn(cr.comparator),this.Eu=new Map,this.Au=new QF,this.Ru={},this.Vu=new Map,this.mu=Dx.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function uet(e,t,r=!0){const i=sde(e);let n;const s=i.Pu.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),n=s.view.cu()):n=await ede(i,t,r,!0),n}async function det(e,t){const r=sde(e);await ede(r,t,!0,!1)}async function ede(e,t,r,i){const n=await TJe(e.localStore,Gu(t)),s=n.targetId,a=e.sharedClientState.addLocalQueryTarget(s,r);let o;return i&&(o=await het(e,t,s,a==="current",n.resumeToken)),e.isPrimaryClient&&r&&que(e.remoteStore,n),o}async function het(e,t,r,i,n){e.gu=(d,f,m)=>async function(y,x,w,_){let S=x.view.nu(w);S.Ds&&(S=await sZ(y.localStore,x.query,!1).then(({documents:T})=>x.view.nu(T,S)));const P=_&&_.targetChanges.get(x.targetId),M=_&&_.targetMismatches.get(x.targetId)!=null,C=x.view.applyChanges(S,y.isPrimaryClient,P,M);return mZ(y,x.targetId,C._u),C.snapshot}(e,d,f,m);const s=await sZ(e.localStore,t,!0),a=new set(t,s.qs),o=a.nu(s.documents),l=rS.createSynthesizedTargetChangeForCurrentChange(r,i&&e.onlineState!=="Offline",n),c=a.applyChanges(o,e.isPrimaryClient,l);mZ(e,r,c._u);const u=new aet(t,r,a);return e.Pu.set(t,u),e.Tu.has(r)?e.Tu.get(r).push(t):e.Tu.set(r,[t]),c.snapshot}async function fet(e,t,r){const i=Nr(e),n=i.Pu.get(t),s=i.Tu.get(n.targetId);if(s.length>1)return i.Tu.set(n.targetId,s.filter(a=>!fD(a,t))),void i.Pu.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(n.targetId),i.sharedClientState.isActiveQueryTarget(n.targetId)||await oz(i.localStore,n.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(n.targetId),r&&tV(i.remoteStore,n.targetId),uz(i,n.targetId)}).catch(db)):(uz(i,n.targetId),await oz(i.localStore,n.targetId,!0))}async function pet(e,t){const r=Nr(e),i=r.Pu.get(t),n=r.Tu.get(i.targetId);r.isPrimaryClient&&n.length===1&&(r.sharedClientState.removeLocalQueryTarget(i.targetId),tV(r.remoteStore,i.targetId))}async function met(e,t,r){const i=_et(e);try{const n=await function(a,o){const l=Nr(a),c=sn.now(),u=o.reduce((m,v)=>m.add(v.key),Qr());let d,f;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let v=Hh(),y=Qr();return l.Os.getEntries(m,u).next(x=>{v=x,v.forEach((w,_)=>{_.isValidDocument()||(y=y.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,v)).next(x=>{d=x;const w=[];for(const _ of o){const S=TZe(_,d.get(_.key).overlayedDocument);S!=null&&w.push(new w0(_.key,S,uue(S.value.mapValue),Ph.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,w,o)}).next(x=>{f=x;const w=x.applyToLocalDocumentSet(d,y);return l.documentOverlayCache.saveOverlays(m,x.batchId,w)})}).then(()=>({batchId:f.batchId,changes:bue(d)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(n.batchId),function(a,o,l){let c=a.Ru[a.currentUser.toKey()];c||(c=new bn(Vr)),c=c.insert(o,l),a.Ru[a.currentUser.toKey()]=c}(i,n.batchId,r),await nS(i,n.changes),await wD(i.remoteStore)}catch(n){const s=aV(n,"Failed to persist write");r.reject(s)}}async function tde(e,t){const r=Nr(e);try{const i=await EJe(r.localStore,t);t.targetChanges.forEach((n,s)=>{const a=r.Eu.get(s);a&&(Ai(n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size<=1,22616),n.addedDocuments.size>0?a.lu=!0:n.modifiedDocuments.size>0?Ai(a.lu,14607):n.removedDocuments.size>0&&(Ai(a.lu,42227),a.lu=!1))}),await nS(r,i,t)}catch(i){await db(i)}}function pZ(e,t,r){const i=Nr(e);if(i.isPrimaryClient&&r===0||!i.isPrimaryClient&&r===1){const n=[];i.Pu.forEach((s,a)=>{const o=a.view.va(t);o.snapshot&&n.push(o.snapshot)}),function(a,o){const l=Nr(a);l.onlineState=o;let c=!1;l.queries.forEach((u,d)=>{for(const f of d.wa)f.va(o)&&(c=!0)}),c&&oV(l)}(i.eventManager,t),n.length&&i.hu.J_(n),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function get(e,t,r){const i=Nr(e);i.sharedClientState.updateQueryState(t,"rejected",r);const n=i.Eu.get(t),s=n&&n.key;if(s){let a=new bn(cr.comparator);a=a.insert(s,Ia.newNoDocument(s,Cr.min()));const o=Qr().add(s),l=new yD(Cr.min(),new Map,new bn(Vr),a,o);await tde(i,l),i.du=i.du.remove(s),i.Eu.delete(t),cV(i)}else await oz(i.localStore,t,!1).then(()=>uz(i,t,r)).catch(db)}async function vet(e,t){const r=Nr(e),i=t.batch.batchId;try{const n=await SJe(r.localStore,t);ide(r,i,null),rde(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),await nS(r,n)}catch(n){await db(n)}}async function yet(e,t,r){const i=Nr(e);try{const n=await function(a,o){const l=Nr(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(d=>(Ai(d!==null,37113),u=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(i.localStore,t);ide(i,t,r),rde(i,t),i.sharedClientState.updateMutationState(t,"rejected",r),await nS(i,n)}catch(n){await db(n)}}function rde(e,t){(e.Vu.get(t)||[]).forEach(r=>{r.resolve()}),e.Vu.delete(t)}function ide(e,t,r){const i=Nr(e);let n=i.Ru[i.currentUser.toKey()];if(n){const s=n.get(t);s&&(r?s.reject(r):s.resolve(),n=n.remove(t)),i.Ru[i.currentUser.toKey()]=n}}function uz(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const i of e.Tu.get(t))e.Pu.delete(i),r&&e.hu.pu(i,r);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(i=>{e.Au.containsKey(i)||nde(e,i)})}function nde(e,t){e.Iu.delete(t.path.canonicalString());const r=e.du.get(t);r!==null&&(tV(e.remoteStore,r),e.du=e.du.remove(t),e.Eu.delete(r),cV(e))}function mZ(e,t,r){for(const i of r)i instanceof Zue?(e.Au.addReference(i.key,t),xet(e,i)):i instanceof Jue?(It(lV,"Document no longer in limbo: "+i.key),e.Au.removeReference(i.key,t),e.Au.containsKey(i.key)||nde(e,i.key)):mr(19791,{yu:i})}function xet(e,t){const r=t.key,i=r.path.canonicalString();e.du.get(r)||e.Iu.has(i)||(It(lV,"New document in limbo: "+r),e.Iu.add(i),cV(e))}function cV(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const r=new cr(mn.fromString(t)),i=e.mu.next();e.Eu.set(i,new oet(r)),e.du=e.du.insert(r,i),que(e.remoteStore,new yp(Gu(qF(r.path)),i,"TargetPurposeLimboResolution",cD.ue))}}async function nS(e,t,r){const i=Nr(e),n=[],s=[],a=[];i.Pu.isEmpty()||(i.Pu.forEach((o,l)=>{a.push(i.gu(l,t,r).then(c=>{var u;if((c||r)&&i.isPrimaryClient){const d=c?!c.fromCache:(u=r?.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;i.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){n.push(c);const d=JF.Es(l.targetId,c);s.push(d)}}))}),await Promise.all(a),i.hu.J_(n),await async function(l,c){const u=Nr(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>lt.forEach(c,f=>lt.forEach(f.Is,m=>u.persistence.referenceDelegate.addReference(d,f.targetId,m)).next(()=>lt.forEach(f.ds,m=>u.persistence.referenceDelegate.removeReference(d,f.targetId,m)))))}catch(d){if(!hb(d))throw d;It(eV,"Failed to update sequence numbers: "+d)}for(const d of c){const f=d.targetId;if(!d.fromCache){const m=u.Fs.get(f),v=m.snapshotVersion,y=m.withLastLimboFreeSnapshotVersion(v);u.Fs=u.Fs.insert(f,y)}}}(i.localStore,s))}async function bet(e,t){const r=Nr(e);if(!r.currentUser.isEqual(t)){It(lV,"User change. New user:",t.toKey());const i=await Uue(r.localStore,t);r.currentUser=t,function(s,a){s.Vu.forEach(o=>{o.forEach(l=>{l.reject(new Kt(pt.CANCELLED,a))})}),s.Vu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await nS(r,i.Bs)}}function wet(e,t){const r=Nr(e),i=r.Eu.get(t);if(i&&i.lu)return Qr().add(i.key);{let n=Qr();const s=r.Tu.get(t);if(!s)return n;for(const a of s){const o=r.Pu.get(a);n=n.unionWith(o.view.tu)}return n}}function sde(e){const t=Nr(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=tde.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=wet.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=get.bind(null,t),t.hu.J_=ret.bind(null,t.eventManager),t.hu.pu=iet.bind(null,t.eventManager),t}function _et(e){const t=Nr(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=vet.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=yet.bind(null,t),t}class OP{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=xD(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,r){return null}Fu(t,r){return null}vu(t){return _Je(this.persistence,new xJe,t.initialUser,this.serializer)}Du(t){return new Vue(ZF.Vi,this.serializer)}bu(t){return new PJe}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}OP.provider={build:()=>new OP};class Eet extends OP{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,r){Ai(this.persistence.referenceDelegate instanceof RP,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new nJe(i,t.asyncQueue,r)}Du(t){const r=this.cacheSizeBytes!==void 0?_o.withCacheSize(this.cacheSizeBytes):_o.DEFAULT;return new Vue(i=>RP.Vi(i,r),this.serializer)}}class dz{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>pZ(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=bet.bind(null,this.syncEngine),await QJe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new JJe}()}createDatastore(t){const r=xD(t.databaseInfo.databaseId),i=function(s){return new IJe(s)}(t.databaseInfo);return function(s,a,o,l){return new zJe(s,a,o,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,n,s,a,o){return new FJe(i,n,s,a,o)}(this.localStore,this.datastore,t.asyncQueue,r=>pZ(this.syncEngine,r,0),function(){return lZ.C()?new lZ:new DJe}())}createSyncEngine(t,r){return function(n,s,a,o,l,c,u){const d=new cet(n,s,a,o,l,c);return u&&(d.fu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await async function(n){const s=Nr(n);It(i0,"RemoteStore shutting down."),s.Ia.add(5),await iS(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}dz.provider={build:()=>new dz};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aet{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):Uh("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,r){setTimeout(()=>{this.muted||t(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="FirestoreClient";class Cet{constructor(t,r,i,n,s){this.authCredentials=t,this.appCheckCredentials=r,this.asyncQueue=i,this.databaseInfo=n,this.user=Na.UNAUTHENTICATED,this.clientId=BF.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,async a=>{It(Yp,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(i,a=>(It(Yp,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Rg;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=aV(r,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function rO(e,t){e.asyncQueue.verifyOperationInProgress(),It(Yp,"Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let i=r.initialUser;e.setCredentialChangeListener(async n=>{i.isEqual(n)||(await Uue(t.localStore,n),i=n)}),t.persistence.setDatabaseDeletedListener(()=>{Vp("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{It("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(n=>{Vp("Terminating Firestore due to IndexedDb database deletion failed",n)})}),e._offlineComponents=t}async function gZ(e,t){e.asyncQueue.verifyOperationInProgress();const r=await Tet(e);It(Yp,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(i=>uZ(t.remoteStore,i)),e.setAppCheckTokenChangeListener((i,n)=>uZ(t.remoteStore,n)),e._onlineComponents=t}async function Tet(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){It(Yp,"Using user provided OfflineComponentProvider");try{await rO(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(n){return n.name==="FirebaseError"?n.code===pt.FAILED_PRECONDITION||n.code===pt.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}(r))throw r;Vp("Error using user provided cache. Falling back to memory cache: "+r),await rO(e,new OP)}}else It(Yp,"Using default OfflineComponentProvider"),await rO(e,new Eet(void 0));return e._offlineComponents}async function ade(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(It(Yp,"Using user provided OnlineComponentProvider"),await gZ(e,e._uninitializedComponentsProvider._online)):(It(Yp,"Using default OnlineComponentProvider"),await gZ(e,new dz))),e._onlineComponents}function Met(e){return ade(e).then(t=>t.syncEngine)}async function vZ(e){const t=await ade(e),r=t.eventManager;return r.onListen=uet.bind(null,t.syncEngine),r.onUnlisten=fet.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=det.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=pet.bind(null,t.syncEngine),r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ode(e){const t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yZ=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lde="firestore.googleapis.com",xZ=!0;class bZ{constructor(t){var r,i;if(t.host===void 0){if(t.ssl!==void 0)throw new Kt(pt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=lde,this.ssl=xZ}else this.host=t.host,this.ssl=(r=t.ssl)!==null&&r!==void 0?r:xZ;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=Fue;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<rJe)throw new Kt(pt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}BQe("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ode((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Kt(pt.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Kt(pt.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Kt(pt.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,n){return i.timeoutSeconds===n.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class uV{constructor(t,r,i,n){this._authCredentials=t,this._appCheckCredentials=r,this._databaseId=i,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bZ({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Kt(pt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Kt(pt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bZ(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new PQe;switch(i.type){case"firstParty":return new RQe(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Kt(pt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const i=yZ.get(r);i&&(It("ComponentProvider","Removing Datastore"),yZ.delete(r),i.terminate())}(this),Promise.resolve()}}function Pet(e,t,r,i={}){var n;e=Yy(e,uV);const s=ob(t),a=e._getSettings(),o=Object.assign(Object.assign({},a),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${r}`;s&&(ace(`https://${l}`),oce("Firestore",!0)),a.host!==lde&&a.host!==l&&Vp("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},a),{host:l,ssl:s,emulatorOptions:i});if(!Fp(c,o)&&(e._setSettings(c),i.mockUserToken)){let u,d;if(typeof i.mockUserToken=="string")u=i.mockUserToken,d=Na.MOCK_USER;else{u=tXe(i.mockUserToken,(n=e._app)===null||n===void 0?void 0:n.options.projectId);const f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new Kt(pt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Na(f)}e._authCredentials=new DQe(new Zce(u,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _D{constructor(t,r,i){this.converter=r,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new _D(this.firestore,t,this._query)}}class $s{constructor(t,r,i){this.converter=r,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new n_(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new $s(this.firestore,t,this._key)}toJSON(){return{type:$s._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,r,i){if(tS(r,$s._jsonSchema))return new $s(t,i||null,new cr(mn.fromString(r.referencePath)))}}$s._jsonSchemaVersion="firestore/documentReference/1.0",$s._jsonSchema={type:ls("string",$s._jsonSchemaVersion),referencePath:ls("string")};class n_ extends _D{constructor(t,r,i){super(t,r,qF(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new $s(this.firestore,null,new cr(t))}withConverter(t){return new n_(this.firestore,t,this._path)}}function $d(e,t,...r){if(e=jo(e),arguments.length===1&&(t=BF.newId()),zQe("doc","path",t),e instanceof uV){const i=mn.fromString(t,...r);return RQ(i),new $s(e,null,new cr(i))}{if(!(e instanceof $s||e instanceof n_))throw new Kt(pt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=e._path.child(mn.fromString(t,...r));return RQ(i),new $s(e.firestore,e instanceof n_?e.converter:null,new cr(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wZ="AsyncQueue";class _Z{constructor(t=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Gue(this,"async_queue_retry"),this.oc=()=>{const i=tO();i&&It(wZ,"Visibility state changed to "+i.visibilityState),this.F_.y_()},this._c=t;const r=tO();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const r=tO();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise(()=>{});const r=new Rg;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(t().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Zu.push(t),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(t){if(!hb(t))throw t;It(wZ,"Operation failed with retryable error: "+t)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(t){const r=this._c.then(()=>(this.nc=!0,t().catch(i=>{throw this.tc=i,this.nc=!1,Uh("INTERNAL UNHANDLED ERROR: ",SZ(i)),i}).then(i=>(this.nc=!1,i))));return this._c=r,r}enqueueAfterDelay(t,r,i){this.ac(),this.sc.indexOf(t)>-1&&(r=0);const n=sV.createAndSchedule(this,t,r,i,s=>this.lc(s));return this.ec.push(n),n}ac(){this.tc&&mr(47125,{hc:SZ(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do t=this._c,await t;while(t!==this._c)}Tc(t){for(const r of this.ec)if(r.timerId===t)return!0;return!1}Ic(t){return this.Pc().then(()=>{this.ec.sort((r,i)=>r.targetTimeMs-i.targetTimeMs);for(const r of this.ec)if(r.skipDelay(),t!=="all"&&r.timerId===t)break;return this.Pc()})}dc(t){this.sc.push(t)}lc(t){const r=this.ec.indexOf(t);this.ec.splice(r,1)}}function SZ(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EZ(e){return function(r,i){if(typeof r!="object"||r===null)return!1;const n=r;for(const s of i)if(s in n&&typeof n[s]=="function")return!0;return!1}(e,["next","error","complete"])}class jP extends uV{constructor(t,r,i,n){super(t,r,i,n),this.type="firestore",this._queue=new _Z,this._persistenceKey=n?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new _Z(t),this._firestoreClient=void 0,await t}}}function Det(e,t){const r=typeof e=="object"?e:dce(),i=typeof e=="string"?e:CP,n=TF(r,"firestore").getImmediate({identifier:i});if(!n._initialized){const s=JYe("firestore");s&&Pet(n,...s)}return n}function cde(e){if(e._terminated)throw new Kt(pt.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Net(e),e._firestoreClient}function Net(e){var t,r,i;const n=e._freezeSettings(),s=function(o,l,c,u){return new KQe(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,ode(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)}(e._databaseId,((t=e._app)===null||t===void 0?void 0:t.options.appId)||"",e._persistenceKey,n);e._componentsProvider||!((r=n.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((i=n.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(e._componentsProvider={_offline:n.localCache._offlineComponentProvider,_online:n.localCache._onlineComponentProvider}),e._firestoreClient=new Cet(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(o){const l=o?._online.build();return{_offline:o?._offline.build(l),_online:l}}(e._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Bl(ba.fromBase64String(t))}catch(r){throw new Kt(pt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(t){return new Bl(ba.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:Bl._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(tS(t,Bl._jsonSchema))return Bl.fromBase64String(t.bytes)}}Bl._jsonSchemaVersion="firestore/bytes/1.0",Bl._jsonSchema={type:ls("string",Bl._jsonSchemaVersion),bytes:ls("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(...t){for(let r=0;r<t.length;++r)if(t[r].length===0)throw new Kt(pt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pa(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(t,r){if(!isFinite(t)||t<-90||t>90)throw new Kt(pt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(r)||r<-180||r>180)throw new Kt(pt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=t,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Vr(this._lat,t._lat)||Vr(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:qu._jsonSchemaVersion}}static fromJSON(t){if(tS(t,qu._jsonSchema))return new qu(t.latitude,t.longitude)}}qu._jsonSchemaVersion="firestore/geoPoint/1.0",qu._jsonSchema={type:ls("string",qu._jsonSchemaVersion),latitude:ls("number"),longitude:ls("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(t){this._values=(t||[]).map(r=>r)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,n){if(i.length!==n.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==n[s])return!1;return!0}(this._values,t._values)}toJSON(){return{type:Yu._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(tS(t,Yu._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(r=>typeof r=="number"))return new Yu(t.vectorValues);throw new Kt(pt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Yu._jsonSchemaVersion="firestore/vectorValue/1.0",Yu._jsonSchema={type:ls("string",Yu._jsonSchemaVersion),vectorValues:ls("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ket=/^__.*__$/;class ude{constructor(t,r,i){this.data=t,this.fieldMask=r,this.fieldTransforms=i}toMutation(t,r){return new w0(t,this.data,this.fieldMask,r,this.fieldTransforms)}}function dde(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw mr(40011,{Ec:e})}}class AD{constructor(t,r,i,n,s,a){this.settings=t,this.databaseId=r,this.serializer=i,this.ignoreUndefinedProperties=n,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(t){return new AD(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(t){var r;const i=(r=this.path)===null||r===void 0?void 0:r.child(t),n=this.Rc({path:i,mc:!1});return n.fc(t),n}gc(t){var r;const i=(r=this.path)===null||r===void 0?void 0:r.child(t),n=this.Rc({path:i,mc:!1});return n.Ac(),n}yc(t){return this.Rc({path:void 0,mc:!0})}wc(t){return LP(t,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(t){return this.fieldMask.find(r=>t.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>t.isPrefixOf(r.field))!==void 0}Ac(){if(this.path)for(let t=0;t<this.path.length;t++)this.fc(this.path.get(t))}fc(t){if(t.length===0)throw this.wc("Document fields must not be empty");if(dde(this.Ec)&&ket.test(t))throw this.wc('Document fields cannot begin and end with "__"')}}class Ret{constructor(t,r,i){this.databaseId=t,this.ignoreUndefinedProperties=r,this.serializer=i||xD(t)}Dc(t,r,i,n=!1){return new AD({Ec:t,methodName:r,bc:i,path:pa.emptyPath(),mc:!1,Sc:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Iet(e){const t=e._freezeSettings(),r=xD(e._databaseId);return new Ret(e._databaseId,!!t.ignoreUndefinedProperties,r)}class CD extends ED{_toFieldTransform(t){if(t.Ec!==2)throw t.Ec===1?t.wc(`${this._methodName}() can only appear at the top level of your update data`):t.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof CD}}function Oet(e,t,r){return new AD({Ec:3,bc:t.settings.bc,methodName:e._methodName,mc:r},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class dV extends ED{constructor(t,r){super(t),this.vc=r}_toFieldTransform(t){const r=Oet(this,t,!0),i=this.vc.map(s=>sS(s,r)),n=new Px(i);return new SZe(t.path,n)}isEqual(t){return t instanceof dV&&Fp(this.vc,t.vc)}}function jet(e,t,r,i){const n=e.Dc(1,t,r);fde("Data must be an object, but it was:",n,i);const s=[],a=il.empty();im(i,(l,c)=>{const u=hV(t,l,r);c=jo(c);const d=n.gc(u);if(c instanceof CD)s.push(u);else{const f=sS(c,d);f!=null&&(s.push(u),a.set(u,f))}});const o=new Mc(s);return new ude(a,o,n.fieldTransforms)}function Let(e,t,r,i,n,s){const a=e.Dc(1,t,r),o=[AZ(t,i,r)],l=[n];if(s.length%2!=0)throw new Kt(pt.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)o.push(AZ(t,s[f])),l.push(s[f+1]);const c=[],u=il.empty();for(let f=o.length-1;f>=0;--f)if(!Fet(c,o[f])){const m=o[f];let v=l[f];v=jo(v);const y=a.gc(m);if(v instanceof CD)c.push(m);else{const x=sS(v,y);x!=null&&(c.push(m),u.set(m,x))}}const d=new Mc(c);return new ude(u,d,a.fieldTransforms)}function sS(e,t){if(hde(e=jo(e)))return fde("Unsupported field value:",t,e),zet(e,t);if(e instanceof ED)return function(i,n){if(!dde(n.Ec))throw n.wc(`${i._methodName}() can only be used with update() and set()`);if(!n.path)throw n.wc(`${i._methodName}() is not currently supported inside arrays`);const s=i._toFieldTransform(n);s&&n.fieldTransforms.push(s)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&t.Ec!==4)throw t.wc("Nested arrays are not supported");return function(i,n){const s=[];let a=0;for(const o of i){let l=sS(o,n.yc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(e,t)}return function(i,n){if((i=jo(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return bZe(n.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const s=sn.fromDate(i);return{timestampValue:kP(n.serializer,s)}}if(i instanceof sn){const s=new sn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:kP(n.serializer,s)}}if(i instanceof qu)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Bl)return{bytesValue:Rue(n.serializer,i._byteString)};if(i instanceof $s){const s=n.databaseId,a=i.firestore._databaseId;if(!a.isEqual(s))throw n.wc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:KF(i.firestore._databaseId||n.databaseId,i._key.path)}}if(i instanceof Yu)return function(a,o){return{mapValue:{fields:{[lue]:{stringValue:cue},[TP]:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw o.wc("VectorValues must only contain numeric values.");return YF(o.serializer,c)})}}}}}}(i,n);throw n.wc(`Unsupported field value: ${FF(i)}`)}(e,t)}function zet(e,t){const r={};return rue(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):im(e,(i,n)=>{const s=sS(n,t.Vc(i));s!=null&&(r[i]=s)}),{mapValue:{fields:r}}}function hde(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof sn||e instanceof qu||e instanceof Bl||e instanceof $s||e instanceof ED||e instanceof Yu)}function fde(e,t,r){if(!hde(r)||!eue(r)){const i=FF(r);throw i==="an object"?t.wc(e+" a custom object"):t.wc(e+" "+i)}}function AZ(e,t,r){if((t=jo(t))instanceof SD)return t._internalPath;if(typeof t=="string")return hV(e,t);throw LP("Field path arguments must be of type string or ",e,!1,void 0,r)}const Bet=new RegExp("[~\\*/\\[\\]]");function hV(e,t,r){if(t.search(Bet)>=0)throw LP(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new SD(...t.split("."))._internalPath}catch{throw LP(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function LP(e,t,r,i,n){const s=i&&!i.isEmpty(),a=n!==void 0;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${i}`),a&&(l+=` in document ${n}`),l+=")"),new Kt(pt.INVALID_ARGUMENT,o+e+l)}function Fet(e,t){return e.some(r=>r.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pde{constructor(t,r,i,n,s){this._firestore=t,this._userDataWriter=r,this._key=i,this._document=n,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new $s(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new Vet(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const r=this._document.data.field(mde("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r)}}}class Vet extends pde{data(){return super.data()}}function mde(e,t){return typeof t=="string"?hV(e,t):t instanceof SD?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uet(e){if(e.limitType==="L"&&e.explicitOrderBy.length===0)throw new Kt(pt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Het{convertValue(t,r="none"){switch(Wp(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Bn(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,r);case 5:return t.stringValue;case 6:return this.convertBytes(Gp(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,r);case 11:return this.convertObject(t.mapValue,r);case 10:return this.convertVectorValue(t.mapValue);default:throw mr(62114,{value:t})}}convertObject(t,r){return this.convertObjectMap(t.fields,r)}convertObjectMap(t,r="none"){const i={};return im(t,(n,s)=>{i[n]=this.convertValue(s,r)}),i}convertVectorValue(t){var r,i,n;const s=(n=(i=(r=t.fields)===null||r===void 0?void 0:r[TP].arrayValue)===null||i===void 0?void 0:i.values)===null||n===void 0?void 0:n.map(a=>Bn(a.doubleValue));return new Yu(s)}convertGeoPoint(t){return new qu(Bn(t.latitude),Bn(t.longitude))}convertArray(t,r){return(t.values||[]).map(i=>this.convertValue(i,r))}convertServerTimestamp(t,r){switch(r){case"previous":const i=dD(t);return i==null?null:this.convertValue(i,r);case"estimate":return this.convertTimestamp(e_(t));default:return null}}convertTimestamp(t){const r=Hp(t);return new sn(r.seconds,r.nanos)}convertDocumentKey(t,r){const i=mn.fromString(t);Ai(Bue(i),9688,{name:t});const n=new t_(i.get(1),i.get(3)),s=new cr(i.popFirst(5));return n.isEqual(r)||Uh(`Document ${s} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),s}}class Nw{constructor(t,r){this.hasPendingWrites=t,this.fromCache=r}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Ig extends pde{constructor(t,r,i,n,s,a){super(t,r,i,n,a),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const r=new DT(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,r={}){if(this._document){const i=this._document.data.field(mde("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Kt(pt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,r={};return r.type=Ig._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Ig._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ig._jsonSchema={type:ls("string",Ig._jsonSchemaVersion),bundleSource:ls("string","DocumentSnapshot"),bundleName:ls("string"),bundle:ls("string")};class DT extends Ig{data(t={}){return super.data(t)}}class $y{constructor(t,r,i,n){this._firestore=t,this._userDataWriter=r,this._snapshot=n,this.metadata=new Nw(n.hasPendingWrites,n.fromCache),this.query=i}get docs(){const t=[];return this.forEach(r=>t.push(r)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,r){this._snapshot.docs.forEach(i=>{t.call(r,new DT(this._firestore,this._userDataWriter,i.key,i,new Nw(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const r=!!t.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Kt(pt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(n,s){if(n._snapshot.oldDocs.isEmpty()){let a=0;return n._snapshot.docChanges.map(o=>{const l=new DT(n._firestore,n._userDataWriter,o.doc.key,o.doc,new Nw(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const l=new DT(n._firestore,n._userDataWriter,o.doc.key,o.doc,new Nw(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:Get(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Kt(pt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=$y._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=BF.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],i=[],n=[];return this.docs.forEach(s=>{s._document!==null&&(r.push(s._document),i.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),n.push(s.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function Get(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return mr(61501,{type:e})}}$y._jsonSchemaVersion="firestore/querySnapshot/1.0",$y._jsonSchema={type:ls("string",$y._jsonSchemaVersion),bundleSource:ls("string","QuerySnapshot"),bundleName:ls("string"),bundle:ls("string")};class gde extends Het{constructor(t){super(),this.firestore=t}convertBytes(t){return new Bl(t)}convertReference(t){const r=this.convertDocumentKey(t,this.firestore._databaseId);return new $s(this.firestore,null,r)}}function Da(e,t,r,...i){e=Yy(e,$s);const n=Yy(e.firestore,jP),s=Iet(n);let a;return a=typeof(t=jo(t))=="string"||t instanceof SD?Let(s,"updateDoc",e._key,t,r,i):jet(s,"updateDoc",e._key,t),Wet(n,[a.toMutation(e._key,Ph.exists(!0))])}function CZ(e,...t){var r,i,n;e=jo(e);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof t[a]!="object"||EZ(t[a])||(s=t[a++]);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(EZ(t[a])){const d=t[a];t[a]=(r=d.next)===null||r===void 0?void 0:r.bind(d),t[a+1]=(i=d.error)===null||i===void 0?void 0:i.bind(d),t[a+2]=(n=d.complete)===null||n===void 0?void 0:n.bind(d)}let l,c,u;if(e instanceof $s)c=Yy(e.firestore,jP),u=qF(e._key.path),l={next:d=>{t[a]&&t[a](qet(c,e,d))},error:t[a+1],complete:t[a+2]};else{const d=Yy(e,_D);c=Yy(d.firestore,jP),u=d._query;const f=new gde(c);l={next:m=>{t[a]&&t[a](new $y(c,f,d,m))},error:t[a+1],complete:t[a+2]},Uet(e._query)}return function(f,m,v,y){const x=new Aet(y),w=new net(m,x,v);return f.asyncQueue.enqueueAndForget(async()=>eet(await vZ(f),w)),()=>{x.Ou(),f.asyncQueue.enqueueAndForget(async()=>tet(await vZ(f),w))}}(cde(c),u,o,l)}function Wet(e,t){return function(i,n){const s=new Rg;return i.asyncQueue.enqueueAndForget(async()=>met(await Met(i),n,s)),s.promise}(cde(e),t)}function qet(e,t,r){const i=r.docs.get(t._key),n=new gde(e);return new Ig(e,n,t._key,i,new Nw(r.hasPendingWrites,r.fromCache),t.converter)}function iO(...e){return new dV("arrayUnion",e)}(function(t,r=!0){(function(n){ub=n})(lb),Ex(new e0("firestore",(i,{instanceIdentifier:n,options:s})=>{const a=i.getProvider("app").getImmediate(),o=new jP(new NQe(i.getProvider("auth-internal")),new IQe(a,i.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Kt(pt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new t_(c.options.projectId,u)}(a,n),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Mp(MQ,PQ,t),Mp(MQ,PQ,"esm2017")})();const Yet={apiKey:"AIzaSyCjfwIsEyxda_jRGVXYDEwCJ7LPDZzv11c",authDomain:"codeg-ab973.firebaseapp.com",projectId:"codeg-ab973",storageBucket:"codeg-ab973.appspot.com",messagingSenderId:"127690237199",appId:"1:127690237199:web:f2439080604fa73198ca7a",measurementId:"G-S92V431DPL"},vde=uce(Yet),yde=AQe(vde),Kd=Det(vde),Xet=new uh,$et=new dh,xde=()=>Hce(yde,Xet),bde=()=>Hce(yde,$et),Ket=x0({email_id:on().email("Invalid email address"),password:on().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must include at least one uppercase letter").regex(/[0-9]/,"Password must include at least one number").regex(/[^A-Za-z0-9]/,"Password must include at least one special character")});function Qet(){const e=g3(),t=fs(),{is_authenticated:r,loading:i,error:n}=ho(v=>v.auth),[s,a]=O.useState(!1),[o,l]=O.useState(null),{register:c,handleSubmit:u,formState:{errors:d}}=$c({resolver:y0(Ket)});O.useEffect(()=>{Hn.init({duration:800,once:!0,easing:"ease-out-cubic"})},[]),O.useEffect(()=>{r&&t("/")},[r,t]);const f=async v=>{try{await e(JC(v)).unwrap()}catch{window.alert("Invalid credentials.")}},m=async v=>{try{const x=await(await v()).user.getIdToken();e(Vw(x))}catch(y){console.error("Social login failed",y)}};return h.jsxs("div",{className:"relative min-h-screen flex items-center justify-center p-4  overflow-hidden bg-gradient-to-br from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-800  transition-colors",children:[h.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsxs("div",{"data-aos":"zoom-in-up",className:"relative z-10 w-full max-w-md bg-base-100/10 backdrop-blur-md border border-gray-700 p-6 sm:p-8 rounded-2xl shadow-2xl",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("img",{src:nD,alt:"CodeG Logo",className:"h-16 w-16 mx-auto mb-4 rounded-xl shadow-lg"}),h.jsx("h2",{className:"text-3xl font-bold text-black dark:text-white ",children:"Welcome Back"}),h.jsx("p",{className:"text-gray-400 mt-2",children:"Sign in to continue your journey."})]}),o&&h.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-700 dark:text-red-400 px-4 py-3 rounded-lg relative text-center mb-6",role:"alert",children:h.jsx("span",{className:"block sm:inline",children:o})}),h.jsxs("div",{className:"flex justify-center gap-4",children:[h.jsx("button",{onClick:()=>m(xde),"aria-label":"Continue with Google",className:"btn btn-outline btn-square border-gray-600 hover:bg-white/10 transition-all duration-300",children:h.jsx($le,{size:24})}),h.jsx("button",{onClick:()=>m(bde),"aria-label":"Continue with GitHub",className:"btn btn-outline btn-square border-gray-600 hover:bg-white/10 transition-all duration-300",children:h.jsx(Kle,{size:24,className:" text-black dark:text-white"})})]}),h.jsxs("div",{className:"relative flex py-5 items-center",children:[h.jsx("div",{className:"flex-grow border-t border-gray-700"}),h.jsx("span",{className:"flex-shrink mx-4 text-xs text-gray-500 font-semibold uppercase",children:"Or continue with"}),h.jsx("div",{className:"flex-grow border-t border-gray-700"})]}),h.jsxs("form",{onSubmit:u(f),className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("input",{type:"email",placeholder:"Email Address",className:`input input-bordered w-full bg-base-300/20 ${d.email_id?"input-error":""}`,...c("email_id")}),d.email_id&&h.jsx("p",{className:"text-error text-sm mt-1",children:d.email_id.message})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:s?"text":"password",placeholder:"Password",className:`input input-bordered w-full bg-base-300/20 pr-10 ${d.password?"input-error":""}`,...c("password")}),h.jsx("button",{type:"button",onClick:()=>a(!s),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 cursor-pointer hover:text-black dark:hover:text-white",children:s?h.jsx(Yle,{size:22}):h.jsx(Xle,{size:22})})]}),d.password&&h.jsx("p",{className:"text-error text-sm mt-1",children:d.password.message}),h.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Must be at least 8 characters, include a capital letter, a number, and a special character."})]}),h.jsx("div",{className:"pt-2",children:h.jsx("button",{type:"submit",disabled:i,className:`btn btn-primary w-full text-base font-semibold ${i?"loading":""}`,children:i?"Logging In...":"Login"})})]}),h.jsxs("p",{className:"text-center text-sm text-gray-400 mt-8",children:["Don’t have an account?"," ",h.jsx("a",{href:"/signup",className:"font-semibold text-primary hover:underline",children:"Create one"})]})]})]})}const Zet=x0({first_name:on().min(3,"Name must be at least 3 characters"),email_id:on().email("Invalid email address"),otp:on().optional(),password:on().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Must include at least one uppercase letter").regex(/[0-9]/,"Must include at least one number").regex(/[^A-Za-z0-9]/,"Must include at least one special character")});function Jet(){const{register:e,handleSubmit:t,getValues:r,trigger:i,formState:{errors:n}}=$c({resolver:y0(Zet),mode:"onTouched"}),s=fs(),a=g3(),{is_authenticated:o,loading:l,error:c}=ho(M=>M.auth),[u,d]=O.useState(!1),[f,m]=O.useState(!1),[v,y]=O.useState(""),[x,w]=O.useState(!1);O.useEffect(()=>{Hn.init({duration:800,once:!0,easing:"ease-out-cubic"})},[]),O.useEffect(()=>{o&&s("/")},[o,s]);const _=M=>{f&&!M.otp||a(ZC(M))},S=async M=>{try{const T=await(await M()).user.getIdToken();a(Vw(T))}catch(C){console.error("Social login failed",C)}},P=async()=>{if(!await i("email_id"))return;const C=r("email_id");try{w(!0),y(""),await jt.post("/user/emailVerification",{email_id:C}),m(!0),y("OTP sent successfully!")}catch(T){y(T.response?.data?.message||"Failed to send OTP. Try again.")}finally{w(!1)}};return h.jsxs("div",{className:"relative min-h-screen flex items-center justify-center  bg-gradient-to-br from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-800  transition-colors overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsxs("div",{"data-aos":"zoom-in-up",className:"relative z-10 w-full max-w-md bg-base-100/10 backdrop-blur-md border border-gray-700 p-6 sm:p-8 rounded-2xl shadow-2xl",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("img",{src:nD,alt:"CodeG Logo",className:"h-16 w-16 mx-auto mb-4 rounded-xl shadow-lg"}),h.jsx("h2",{className:"text-3xl font-bold text-black dark:text-white",children:"Create an Account"}),h.jsx("p",{className:"text-gray-400 mt-2",children:"Join the community to start coding."})]}),h.jsxs("div",{className:"flex justify-center gap-4",children:[h.jsx("button",{onClick:()=>S(xde),"aria-label":"Continue with Google",className:"btn btn-outline btn-square border-gray-600 hover:bg-white/10 transition-all",children:h.jsx($le,{size:24})}),h.jsx("button",{onClick:()=>S(bde),"aria-label":"Continue with GitHub",className:"btn btn-outline btn-square border-gray-600 hover:bg-white/10 transition-all",children:h.jsx(Kle,{size:24,className:"text-black dark:text-white"})})]}),h.jsxs("div",{className:"relative flex py-5 items-center",children:[h.jsx("div",{className:"flex-grow border-t border-gray-700"}),h.jsx("span",{className:"flex-shrink mx-4 text-xs text-gray-500 font-semibold uppercase",children:"Or with email"}),h.jsx("div",{className:"flex-grow border-t border-gray-700"})]}),h.jsxs("form",{onSubmit:t(_),className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("input",{type:"text",placeholder:"First Name",className:`input input-bordered w-full bg-base-300/20 ${n.first_name?"input-error":""}`,...e("first_name")}),n.first_name&&h.jsx("p",{className:"text-error text-sm mt-1",children:n.first_name.message})]}),h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsxs("div",{className:"flex-grow",children:[h.jsx("input",{type:"email",placeholder:"Email Address",className:`input input-bordered w-full bg-base-300/20 ${n.email_id?"input-error":""}`,...e("email_id")}),n.email_id&&h.jsx("p",{className:"text-error text-sm mt-1",children:n.email_id.message})]}),h.jsx("button",{type:"button",onClick:P,disabled:x,className:`btn btn-secondary h-12 flex-shrink-0 ${x?"loading":""}`,children:x?"":"Send OTP"})]}),v&&h.jsx("p",{className:`text-sm text-center ${v.includes("successfully")?"text-success":"text-error"}`,children:v}),f&&h.jsxs("div",{"data-aos":"fade-in",children:[h.jsx("input",{type:"text",placeholder:"Enter 4-Digit OTP",className:`input input-bordered w-full bg-base-300/20 ${n.otp?"input-error":""}`,...e("otp",{required:"OTP is required"})}),n.otp&&h.jsx("p",{className:"text-error text-sm mt-1",children:n.otp.message})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:u?"text":"password",placeholder:"Password (min. 8 characters)",className:`input input-bordered w-full bg-base-300/20 pr-10 ${n.password?"input-error":""}`,...e("password")}),h.jsx("button",{type:"button",onClick:()=>d(!u),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-white",children:u?h.jsx(Yle,{size:22}):h.jsx(Xle,{size:22})})]}),n.password&&h.jsx("p",{className:"text-error text-sm mt-1",children:n.password.message}),h.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Must be at least 8 characters, include a capital letter, a number, and a special character."})]}),h.jsx("div",{className:"pt-2",children:h.jsx("button",{type:"submit",disabled:l,className:`btn btn-primary w-full text-base font-semibold ${l?"loading":""}`,children:l?"Creating Account...":"Create Account"})})]}),h.jsxs("p",{className:"text-center text-sm text-gray-400 mt-8",children:["Already have an account?"," ",h.jsx("a",{href:"/login",className:"font-semibold text-primary hover:underline",children:"Login here"})]})]})]})}const fV=O.createContext({});function pb(e){const t=O.useRef(null);return t.current===null&&(t.current=e()),t.current}const pV=typeof window<"u",TD=pV?O.useLayoutEffect:O.useEffect,MD=O.createContext(null);function mV(e,t){e.indexOf(t)===-1&&e.push(t)}function gV(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const od=(e,t,r)=>r>t?t:r<e?e:r;let s_=()=>{};const Gh={},wde=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function _de(e){return typeof e=="object"&&e!==null}const Sde=e=>/^0[^.\s]+$/u.test(e);function vV(e){let t;return()=>(t===void 0&&(t=e()),t)}const Io=e=>e,ett=(e,t)=>r=>t(e(r)),aS=(...e)=>e.reduce(ett),kx=(e,t,r)=>{const i=t-e;return i===0?1:(r-e)/i};class yV{constructor(){this.subscriptions=[]}add(t){return mV(this.subscriptions,t),()=>gV(this.subscriptions,t)}notify(t,r,i){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,i);else for(let s=0;s<n;s++){const a=this.subscriptions[s];a&&a(t,r,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Xu=e=>e*1e3,$u=e=>e/1e3;function xV(e,t){return t?e*(1e3/t):0}const Ede=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,ttt=1e-7,rtt=12;function itt(e,t,r,i,n){let s,a,o=0;do a=t+(r-t)/2,s=Ede(a,i,n)-e,s>0?r=a:t=a;while(Math.abs(s)>ttt&&++o<rtt);return a}function oS(e,t,r,i){if(e===t&&r===i)return Io;const n=s=>itt(s,0,1,e,r);return s=>s===0||s===1?s:Ede(n(s),t,i)}const Ade=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Cde=e=>t=>1-e(1-t),Tde=oS(.33,1.53,.69,.99),bV=Cde(Tde),Mde=Ade(bV),Pde=e=>(e*=2)<1?.5*bV(e):.5*(2-Math.pow(2,-10*(e-1))),wV=e=>1-Math.sin(Math.acos(e)),Dde=Cde(wV),Nde=Ade(wV),ntt=oS(.42,0,1,1),stt=oS(0,0,.58,1),kde=oS(.42,0,.58,1),att=e=>Array.isArray(e)&&typeof e[0]!="number",Rde=e=>Array.isArray(e)&&typeof e[0]=="number",ott={linear:Io,easeIn:ntt,easeInOut:kde,easeOut:stt,circIn:wV,circInOut:Nde,circOut:Dde,backIn:bV,backInOut:Mde,backOut:Tde,anticipate:Pde},ltt=e=>typeof e=="string",TZ=e=>{if(Rde(e)){s_(e.length===4);const[t,r,i,n]=e;return oS(t,r,i,n)}else if(ltt(e))return ott[e];return e},_C=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function ctt(e,t){let r=new Set,i=new Set,n=!1,s=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(u){a.has(u)&&(c.schedule(u),e()),u(o)}const c={schedule:(u,d=!1,f=!1)=>{const v=f&&n?r:i;return d&&a.add(u),v.has(u)||v.add(u),u},cancel:u=>{i.delete(u),a.delete(u)},process:u=>{if(o=u,n){s=!0;return}n=!0,[r,i]=[i,r],r.forEach(l),r.clear(),n=!1,s&&(s=!1,c.process(u))}};return c}const utt=40;function Ide(e,t){let r=!1,i=!0;const n={delta:0,timestamp:0,isProcessing:!1},s=()=>r=!0,a=_C.reduce((S,P)=>(S[P]=ctt(s),S),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:f,render:m,postRender:v}=a,y=()=>{const S=Gh.useManualTiming?n.timestamp:performance.now();r=!1,Gh.useManualTiming||(n.delta=i?1e3/60:Math.max(Math.min(S-n.timestamp,utt),1)),n.timestamp=S,n.isProcessing=!0,o.process(n),l.process(n),c.process(n),u.process(n),d.process(n),f.process(n),m.process(n),v.process(n),n.isProcessing=!1,r&&t&&(i=!1,e(y))},x=()=>{r=!0,i=!0,n.isProcessing||e(y)};return{schedule:_C.reduce((S,P)=>{const M=a[P];return S[P]=(C,T=!1,E=!1)=>(r||x(),M.schedule(C,T,E)),S},{}),cancel:S=>{for(let P=0;P<_C.length;P++)a[_C[P]].cancel(S)},state:n,steps:a}}const{schedule:Si,cancel:Uc,state:Fs,steps:nO}=Ide(typeof requestAnimationFrame<"u"?requestAnimationFrame:Io,!0);let NT;function dtt(){NT=void 0}const Do={now:()=>(NT===void 0&&Do.set(Fs.isProcessing||Gh.useManualTiming?Fs.timestamp:performance.now()),NT),set:e=>{NT=e,queueMicrotask(dtt)}},Ode=e=>t=>typeof t=="string"&&t.startsWith(e),_V=Ode("--"),htt=Ode("var(--"),SV=e=>htt(e)?ftt.test(e.split("/*")[0].trim()):!1,ftt=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,mb={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},a_={...mb,transform:e=>od(0,1,e)},SC={...mb,default:1},h2=e=>Math.round(e*1e5)/1e5,EV=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function ptt(e){return e==null}const mtt=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,AV=(e,t)=>r=>!!(typeof r=="string"&&mtt.test(r)&&r.startsWith(e)||t&&!ptt(r)&&Object.prototype.hasOwnProperty.call(r,t)),jde=(e,t,r)=>i=>{if(typeof i!="string")return i;const[n,s,a,o]=i.match(EV);return{[e]:parseFloat(n),[t]:parseFloat(s),[r]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},gtt=e=>od(0,255,e),sO={...mb,transform:e=>Math.round(gtt(e))},wg={test:AV("rgb","red"),parse:jde("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:i=1})=>"rgba("+sO.transform(e)+", "+sO.transform(t)+", "+sO.transform(r)+", "+h2(a_.transform(i))+")"};function vtt(e){let t="",r="",i="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),i=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),i=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,i+=i,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(i,16),alpha:n?parseInt(n,16)/255:1}}const hz={test:AV("#"),parse:vtt,transform:wg.transform},lS=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Wf=lS("deg"),Ku=lS("%"),br=lS("px"),ytt=lS("vh"),xtt=lS("vw"),MZ={...Ku,parse:e=>Ku.parse(e)/100,transform:e=>Ku.transform(e*100)},_y={test:AV("hsl","hue"),parse:jde("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:i=1})=>"hsla("+Math.round(e)+", "+Ku.transform(h2(t))+", "+Ku.transform(h2(r))+", "+h2(a_.transform(i))+")"},rs={test:e=>wg.test(e)||hz.test(e)||_y.test(e),parse:e=>wg.test(e)?wg.parse(e):_y.test(e)?_y.parse(e):hz.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?wg.transform(e):_y.transform(e),getAnimatableNone:e=>{const t=rs.parse(e);return t.alpha=0,rs.transform(t)}},btt=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function wtt(e){return isNaN(e)&&typeof e=="string"&&(e.match(EV)?.length||0)+(e.match(btt)?.length||0)>0}const Lde="number",zde="color",_tt="var",Stt="var(",PZ="${}",Ett=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function o_(e){const t=e.toString(),r=[],i={color:[],number:[],var:[]},n=[];let s=0;const o=t.replace(Ett,l=>(rs.test(l)?(i.color.push(s),n.push(zde),r.push(rs.parse(l))):l.startsWith(Stt)?(i.var.push(s),n.push(_tt),r.push(l)):(i.number.push(s),n.push(Lde),r.push(parseFloat(l))),++s,PZ)).split(PZ);return{values:r,split:o,indexes:i,types:n}}function Bde(e){return o_(e).values}function Fde(e){const{split:t,types:r}=o_(e),i=t.length;return n=>{let s="";for(let a=0;a<i;a++)if(s+=t[a],n[a]!==void 0){const o=r[a];o===Lde?s+=h2(n[a]):o===zde?s+=rs.transform(n[a]):s+=n[a]}return s}}const Att=e=>typeof e=="number"?0:rs.test(e)?rs.getAnimatableNone(e):e;function Ctt(e){const t=Bde(e);return Fde(e)(t.map(Att))}const Xp={test:wtt,parse:Bde,createTransformer:Fde,getAnimatableNone:Ctt};function aO(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Ttt({hue:e,saturation:t,lightness:r,alpha:i}){e/=360,t/=100,r/=100;let n=0,s=0,a=0;if(!t)n=s=a=r;else{const o=r<.5?r*(1+t):r+t-r*t,l=2*r-o;n=aO(l,o,e+1/3),s=aO(l,o,e),a=aO(l,o,e-1/3)}return{red:Math.round(n*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:i}}function zP(e,t){return r=>r>0?t:e}const vn=(e,t,r)=>e+(t-e)*r,oO=(e,t,r)=>{const i=e*e,n=r*(t*t-i)+i;return n<0?0:Math.sqrt(n)},Mtt=[hz,wg,_y],Ptt=e=>Mtt.find(t=>t.test(e));function DZ(e){const t=Ptt(e);if(!t)return!1;let r=t.parse(e);return t===_y&&(r=Ttt(r)),r}const NZ=(e,t)=>{const r=DZ(e),i=DZ(t);if(!r||!i)return zP(e,t);const n={...r};return s=>(n.red=oO(r.red,i.red,s),n.green=oO(r.green,i.green,s),n.blue=oO(r.blue,i.blue,s),n.alpha=vn(r.alpha,i.alpha,s),wg.transform(n))},fz=new Set(["none","hidden"]);function Dtt(e,t){return fz.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function Ntt(e,t){return r=>vn(e,t,r)}function CV(e){return typeof e=="number"?Ntt:typeof e=="string"?SV(e)?zP:rs.test(e)?NZ:Itt:Array.isArray(e)?Vde:typeof e=="object"?rs.test(e)?NZ:ktt:zP}function Vde(e,t){const r=[...e],i=r.length,n=e.map((s,a)=>CV(s)(s,t[a]));return s=>{for(let a=0;a<i;a++)r[a]=n[a](s);return r}}function ktt(e,t){const r={...e,...t},i={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(i[n]=CV(e[n])(e[n],t[n]));return n=>{for(const s in i)r[s]=i[s](n);return r}}function Rtt(e,t){const r=[],i={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){const s=t.types[n],a=e.indexes[s][i[s]],o=e.values[a]??0;r[n]=o,i[s]++}return r}const Itt=(e,t)=>{const r=Xp.createTransformer(t),i=o_(e),n=o_(t);return i.indexes.var.length===n.indexes.var.length&&i.indexes.color.length===n.indexes.color.length&&i.indexes.number.length>=n.indexes.number.length?fz.has(e)&&!n.values.length||fz.has(t)&&!i.values.length?Dtt(e,t):aS(Vde(Rtt(i,n),n.values),r):zP(e,t)};function Ude(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?vn(e,t,r):CV(e)(e,t)}const Ott=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>Si.update(t,r),stop:()=>Uc(t),now:()=>Fs.isProcessing?Fs.timestamp:Do.now()}},Hde=(e,t,r=10)=>{let i="";const n=Math.max(Math.round(t/r),2);for(let s=0;s<n;s++)i+=Math.round(e(s/(n-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},BP=2e4;function TV(e){let t=0;const r=50;let i=e.next(t);for(;!i.done&&t<BP;)t+=r,i=e.next(t);return t>=BP?1/0:t}function jtt(e,t=100,r){const i=r({...e,keyframes:[0,t]}),n=Math.min(TV(i),BP);return{type:"keyframes",ease:s=>i.next(n*s).value/t,duration:$u(n)}}const Ltt=5;function Gde(e,t,r){const i=Math.max(t-Ltt,0);return xV(r-e(i),t-i)}const Cn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},lO=.001;function ztt({duration:e=Cn.duration,bounce:t=Cn.bounce,velocity:r=Cn.velocity,mass:i=Cn.mass}){let n,s,a=1-t;a=od(Cn.minDamping,Cn.maxDamping,a),e=od(Cn.minDuration,Cn.maxDuration,$u(e)),a<1?(n=c=>{const u=c*a,d=u*e,f=u-r,m=pz(c,a),v=Math.exp(-d);return lO-f/m*v},s=c=>{const d=c*a*e,f=d*r+r,m=Math.pow(a,2)*Math.pow(c,2)*e,v=Math.exp(-d),y=pz(Math.pow(c,2),a);return(-n(c)+lO>0?-1:1)*((f-m)*v)/y}):(n=c=>{const u=Math.exp(-c*e),d=(c-r)*e+1;return-lO+u*d},s=c=>{const u=Math.exp(-c*e),d=(r-c)*(e*e);return u*d});const o=5/e,l=Ftt(n,s,o);if(e=Xu(e),isNaN(l))return{stiffness:Cn.stiffness,damping:Cn.damping,duration:e};{const c=Math.pow(l,2)*i;return{stiffness:c,damping:a*2*Math.sqrt(i*c),duration:e}}}const Btt=12;function Ftt(e,t,r){let i=r;for(let n=1;n<Btt;n++)i=i-e(i)/t(i);return i}function pz(e,t){return e*Math.sqrt(1-t*t)}const Vtt=["duration","bounce"],Utt=["stiffness","damping","mass"];function kZ(e,t){return t.some(r=>e[r]!==void 0)}function Htt(e){let t={velocity:Cn.velocity,stiffness:Cn.stiffness,damping:Cn.damping,mass:Cn.mass,isResolvedFromDuration:!1,...e};if(!kZ(e,Utt)&&kZ(e,Vtt))if(e.visualDuration){const r=e.visualDuration,i=2*Math.PI/(r*1.2),n=i*i,s=2*od(.05,1,1-(e.bounce||0))*Math.sqrt(n);t={...t,mass:Cn.mass,stiffness:n,damping:s}}else{const r=ztt(e);t={...t,...r,mass:Cn.mass},t.isResolvedFromDuration=!0}return t}function FP(e=Cn.visualDuration,t=Cn.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:i,restDelta:n}=r;const s=r.keyframes[0],a=r.keyframes[r.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:f,isResolvedFromDuration:m}=Htt({...r,velocity:-$u(r.velocity||0)}),v=f||0,y=c/(2*Math.sqrt(l*u)),x=a-s,w=$u(Math.sqrt(l/u)),_=Math.abs(x)<5;i||(i=_?Cn.restSpeed.granular:Cn.restSpeed.default),n||(n=_?Cn.restDelta.granular:Cn.restDelta.default);let S;if(y<1){const M=pz(w,y);S=C=>{const T=Math.exp(-y*w*C);return a-T*((v+y*w*x)/M*Math.sin(M*C)+x*Math.cos(M*C))}}else if(y===1)S=M=>a-Math.exp(-w*M)*(x+(v+w*x)*M);else{const M=w*Math.sqrt(y*y-1);S=C=>{const T=Math.exp(-y*w*C),E=Math.min(M*C,300);return a-T*((v+y*w*x)*Math.sinh(E)+M*x*Math.cosh(E))/M}}const P={calculatedDuration:m&&d||null,next:M=>{const C=S(M);if(m)o.done=M>=d;else{let T=M===0?v:0;y<1&&(T=M===0?Xu(v):Gde(S,M,C));const E=Math.abs(T)<=i,N=Math.abs(a-C)<=n;o.done=E&&N}return o.value=o.done?a:C,o},toString:()=>{const M=Math.min(TV(P),BP),C=Hde(T=>P.next(M*T).value,M,30);return M+"ms "+C},toTransition:()=>{}};return P}FP.applyToOptions=e=>{const t=jtt(e,100,FP);return e.ease=t.ease,e.duration=Xu(t.duration),e.type="keyframes",e};function mz({keyframes:e,velocity:t=0,power:r=.8,timeConstant:i=325,bounceDamping:n=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const d=e[0],f={done:!1,value:d},m=E=>o!==void 0&&E<o||l!==void 0&&E>l,v=E=>o===void 0?l:l===void 0||Math.abs(o-E)<Math.abs(l-E)?o:l;let y=r*t;const x=d+y,w=a===void 0?x:a(x);w!==x&&(y=w-d);const _=E=>-y*Math.exp(-E/i),S=E=>w+_(E),P=E=>{const N=_(E),D=S(E);f.done=Math.abs(N)<=c,f.value=f.done?w:D};let M,C;const T=E=>{m(f.value)&&(M=E,C=FP({keyframes:[f.value,v(f.value)],velocity:Gde(S,E,f.value),damping:n,stiffness:s,restDelta:c,restSpeed:u}))};return T(0),{calculatedDuration:null,next:E=>{let N=!1;return!C&&M===void 0&&(N=!0,P(E),T(E)),M!==void 0&&E>=M?C.next(E-M):(!N&&P(E),f)}}}function Gtt(e,t,r){const i=[],n=r||Gh.mix||Ude,s=e.length-1;for(let a=0;a<s;a++){let o=n(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||Io:t;o=aS(l,o)}i.push(o)}return i}function MV(e,t,{clamp:r=!0,ease:i,mixer:n}={}){const s=e.length;if(s_(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=Gtt(t,i,n),l=o.length,c=u=>{if(a&&u<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const f=kx(e[d],e[d+1],u);return o[d](f)};return r?u=>c(od(e[0],e[s-1],u)):c}function Wtt(e,t){const r=e[e.length-1];for(let i=1;i<=t;i++){const n=kx(0,t,i);e.push(vn(r,1,n))}}function Wde(e){const t=[0];return Wtt(t,e.length-1),t}function qtt(e,t){return e.map(r=>r*t)}function Ytt(e,t){return e.map(()=>t||kde).splice(0,e.length-1)}function f2({duration:e=300,keyframes:t,times:r,ease:i="easeInOut"}){const n=att(i)?i.map(TZ):TZ(i),s={done:!1,value:t[0]},a=qtt(r&&r.length===t.length?r:Wde(t),e),o=MV(a,t,{ease:Array.isArray(n)?n:Ytt(t,n)});return{calculatedDuration:e,next:l=>(s.value=o(l),s.done=l>=e,s)}}const Xtt=e=>e!==null;function PV(e,{repeat:t,repeatType:r="loop"},i,n=1){const s=e.filter(Xtt),o=n<0||t&&r!=="loop"&&t%2===1?0:s.length-1;return!o||i===void 0?s[o]:i}const $tt={decay:mz,inertia:mz,tween:f2,keyframes:f2,spring:FP};function qde(e){typeof e.type=="string"&&(e.type=$tt[e.type])}class DV{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const Ktt=e=>e/100;class PD extends DV{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==Do.now()&&this.tick(Do.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;qde(t);const{type:r=f2,repeat:i=0,repeatDelay:n=0,repeatType:s,velocity:a=0}=t;let{keyframes:o}=t;const l=r||f2;l!==f2&&typeof o[0]!="number"&&(this.mixKeyframes=aS(Ktt,Ude(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});s==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=TV(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+n,this.totalDuration=this.resolvedDuration*(i+1)-n,this.generator=c}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:i,totalDuration:n,mixKeyframes:s,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return i.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:f,repeatDelay:m,type:v,onUpdate:y,finalKeyframe:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-n/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const w=this.currentTime-c*(this.playbackSpeed>=0?1:-1),_=this.playbackSpeed>=0?w<0:w>n;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=n);let S=this.currentTime,P=i;if(d){const E=Math.min(this.currentTime,n)/o;let N=Math.floor(E),D=E%1;!D&&E>=1&&(D=1),D===1&&N--,N=Math.min(N,d+1),!!(N%2)&&(f==="reverse"?(D=1-D,m&&(D-=m/o)):f==="mirror"&&(P=a)),S=od(0,1,D)*o}const M=_?{done:!1,value:u[0]}:P.next(S);s&&(M.value=s(M.value));let{done:C}=M;!_&&l!==null&&(C=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const T=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&C);return T&&v!==mz&&(M.value=PV(u,this.options,x,this.speed)),y&&y(M.value),T&&this.finish(),M}then(t,r){return this.finished.then(t,r)}get duration(){return $u(this.calculatedDuration)}get time(){return $u(this.currentTime)}set time(t){t=Xu(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Do.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=$u(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=Ott,startTime:r}=this.options;this.driver||(this.driver=t(n=>this.tick(n))),this.options.onPlay?.();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=r??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Do.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function Qtt(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const _g=e=>e*180/Math.PI,gz=e=>{const t=_g(Math.atan2(e[1],e[0]));return vz(t)},Ztt={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:gz,rotateZ:gz,skewX:e=>_g(Math.atan(e[1])),skewY:e=>_g(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},vz=e=>(e=e%360,e<0&&(e+=360),e),RZ=gz,IZ=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),OZ=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Jtt={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:IZ,scaleY:OZ,scale:e=>(IZ(e)+OZ(e))/2,rotateX:e=>vz(_g(Math.atan2(e[6],e[5]))),rotateY:e=>vz(_g(Math.atan2(-e[2],e[0]))),rotateZ:RZ,rotate:RZ,skewX:e=>_g(Math.atan(e[4])),skewY:e=>_g(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function yz(e){return e.includes("scale")?1:0}function xz(e,t){if(!e||e==="none")return yz(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,n;if(r)i=Jtt,n=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=Ztt,n=o}if(!n)return yz(t);const s=i[t],a=n[1].split(",").map(trt);return typeof s=="function"?s(a):a[s]}const ert=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return xz(r,t)};function trt(e){return parseFloat(e.trim())}const gb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],vb=new Set(gb),jZ=e=>e===mb||e===br,rrt=new Set(["x","y","z"]),irt=gb.filter(e=>!rrt.has(e));function nrt(e){const t=[];return irt.forEach(r=>{const i=e.getValue(r);i!==void 0&&(t.push([r,i.get()]),i.set(r.startsWith("scale")?1:0))}),t}const Og={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>xz(t,"x"),y:(e,{transform:t})=>xz(t,"y")};Og.translateX=Og.x;Og.translateY=Og.y;const jg=new Set;let bz=!1,wz=!1,_z=!1;function Yde(){if(wz){const e=Array.from(jg).filter(i=>i.needsMeasurement),t=new Set(e.map(i=>i.element)),r=new Map;t.forEach(i=>{const n=nrt(i);n.length&&(r.set(i,n),i.render())}),e.forEach(i=>i.measureInitialState()),t.forEach(i=>{i.render();const n=r.get(i);n&&n.forEach(([s,a])=>{i.getValue(s)?.set(a)})}),e.forEach(i=>i.measureEndState()),e.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}wz=!1,bz=!1,jg.forEach(e=>e.complete(_z)),jg.clear()}function Xde(){jg.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(wz=!0)})}function srt(){_z=!0,Xde(),Yde(),_z=!1}class NV{constructor(t,r,i,n,s,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=i,this.motionValue=n,this.element=s,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(jg.add(this),bz||(bz=!0,Si.read(Xde),Si.resolveKeyframes(Yde))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:i,motionValue:n}=this;if(t[0]===null){const s=n?.get(),a=t[t.length-1];if(s!==void 0)t[0]=s;else if(i&&r){const o=i.readValue(r,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),n&&s===void 0&&n.set(t[0])}Qtt(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),jg.delete(this)}cancel(){this.state==="scheduled"&&(jg.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const art=e=>e.startsWith("--");function ort(e,t,r){art(t)?e.style.setProperty(t,r):e.style[t]=r}const $de=vV(()=>window.ScrollTimeline!==void 0),lrt={};function crt(e,t){const r=vV(e);return()=>lrt[t]??r()}const Kde=crt(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),kw=([e,t,r,i])=>`cubic-bezier(${e}, ${t}, ${r}, ${i})`,LZ={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:kw([0,.65,.55,1]),circOut:kw([.55,0,1,.45]),backIn:kw([.31,.01,.66,-.59]),backOut:kw([.33,1.53,.69,.99])};function Qde(e,t){if(e)return typeof e=="function"?Kde()?Hde(e,t):"ease-out":Rde(e)?kw(e):Array.isArray(e)?e.map(r=>Qde(r,t)||LZ.easeOut):LZ[e]}function urt(e,t,r,{delay:i=0,duration:n=300,repeat:s=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[t]:r};l&&(u.offset=l);const d=Qde(o,n);Array.isArray(d)&&(u.easing=d);const f={delay:i,duration:n,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"};return c&&(f.pseudoElement=c),e.animate(u,f)}function Zde(e){return typeof e=="function"&&"applyToOptions"in e}function drt({type:e,...t}){return Zde(e)&&Kde()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class hrt extends DV{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:i,keyframes:n,pseudoElement:s,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!s,this.allowFlatten=a,this.options=t,s_(typeof t.type!="string");const c=drt(t);this.animation=urt(r,i,n,c,s),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const u=PV(n,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):ort(r,i,u),this.animation.cancel()}l?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return $u(Number(t))}get time(){return $u(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Xu(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&$de()?(this.animation.timeline=t,Io):r(this)}}const Jde={anticipate:Pde,backInOut:Mde,circInOut:Nde};function frt(e){return e in Jde}function prt(e){typeof e.ease=="string"&&frt(e.ease)&&(e.ease=Jde[e.ease])}const zZ=10;class mrt extends hrt{constructor(t){prt(t),qde(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:i,onComplete:n,element:s,...a}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new PD({...a,autoplay:!1}),l=Xu(this.finishedTime??this.time);r.setWithVelocity(o.sample(l-zZ).value,o.sample(l).value,zZ),o.stop()}}const BZ=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Xp.test(e)||e==="0")&&!e.startsWith("url("));function grt(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function vrt(e,t,r,i){const n=e[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const s=e[e.length-1],a=BZ(n,t),o=BZ(s,t);return!a||!o?!1:grt(e)||(r==="spring"||Zde(r))&&i}function Sz(e){e.duration=0,e.type}const yrt=new Set(["opacity","clipPath","filter","transform"]),xrt=vV(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function brt(e){const{motionValue:t,name:r,repeatDelay:i,repeatType:n,damping:s,type:a}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=t.owner.getProps();return xrt()&&r&&yrt.has(r)&&(r!=="transform"||!c)&&!l&&!i&&n!=="mirror"&&s!==0&&a!=="inertia"}const wrt=40;class _rt extends DV{constructor({autoplay:t=!0,delay:r=0,type:i="keyframes",repeat:n=0,repeatDelay:s=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...d}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Do.now();const f={autoplay:t,delay:r,type:i,repeat:n,repeatDelay:s,repeatType:a,name:l,motionValue:c,element:u,...d},m=u?.KeyframeResolver||NV;this.keyframeResolver=new m(o,(v,y,x)=>this.onKeyframesResolved(v,y,f,!x),l,c,u),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,i,n){this.keyframeResolver=void 0;const{name:s,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=i;this.resolvedAt=Do.now(),vrt(t,s,a,o)||((Gh.instantAnimations||!l)&&u?.(PV(t,i,r)),t[0]=t[t.length-1],Sz(i),i.repeat=0);const f={startTime:n?this.resolvedAt?this.resolvedAt-this.createdAt>wrt?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...i,keyframes:t},m=!c&&brt(f)?new mrt({...f,element:f.motionValue.owner.current}):new PD(f);m.finished.then(()=>this.notifyFinished()).catch(Io),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),srt()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const Srt=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Ert(e){const t=Srt.exec(e);if(!t)return[,];const[,r,i,n]=t;return[`--${r??i}`,n]}function ehe(e,t,r=1){const[i,n]=Ert(e);if(!i)return;const s=window.getComputedStyle(t).getPropertyValue(i);if(s){const a=s.trim();return wde(a)?parseFloat(a):a}return SV(n)?ehe(n,t,r+1):n}function kV(e,t){return e?.[t]??e?.default??e}const the=new Set(["width","height","top","left","right","bottom",...gb]),Art={test:e=>e==="auto",parse:e=>e},rhe=e=>t=>t.test(e),ihe=[mb,br,Ku,Wf,xtt,ytt,Art],FZ=e=>ihe.find(rhe(e));function Crt(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Sde(e):!0}const Trt=new Set(["brightness","contrast","saturate","opacity"]);function Mrt(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[i]=r.match(EV)||[];if(!i)return e;const n=r.replace(i,"");let s=Trt.has(t)?1:0;return i!==r&&(s*=100),t+"("+s+n+")"}const Prt=/\b([a-z-]*)\(.*?\)/gu,Ez={...Xp,getAnimatableNone:e=>{const t=e.match(Prt);return t?t.map(Mrt).join(" "):e}},VZ={...mb,transform:Math.round},Drt={rotate:Wf,rotateX:Wf,rotateY:Wf,rotateZ:Wf,scale:SC,scaleX:SC,scaleY:SC,scaleZ:SC,skew:Wf,skewX:Wf,skewY:Wf,distance:br,translateX:br,translateY:br,translateZ:br,x:br,y:br,z:br,perspective:br,transformPerspective:br,opacity:a_,originX:MZ,originY:MZ,originZ:br},RV={borderWidth:br,borderTopWidth:br,borderRightWidth:br,borderBottomWidth:br,borderLeftWidth:br,borderRadius:br,radius:br,borderTopLeftRadius:br,borderTopRightRadius:br,borderBottomRightRadius:br,borderBottomLeftRadius:br,width:br,maxWidth:br,height:br,maxHeight:br,top:br,right:br,bottom:br,left:br,padding:br,paddingTop:br,paddingRight:br,paddingBottom:br,paddingLeft:br,margin:br,marginTop:br,marginRight:br,marginBottom:br,marginLeft:br,backgroundPositionX:br,backgroundPositionY:br,...Drt,zIndex:VZ,fillOpacity:a_,strokeOpacity:a_,numOctaves:VZ},Nrt={...RV,color:rs,backgroundColor:rs,outlineColor:rs,fill:rs,stroke:rs,borderColor:rs,borderTopColor:rs,borderRightColor:rs,borderBottomColor:rs,borderLeftColor:rs,filter:Ez,WebkitFilter:Ez},nhe=e=>Nrt[e];function she(e,t){let r=nhe(e);return r!==Ez&&(r=Xp),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const krt=new Set(["auto","none","0"]);function Rrt(e,t,r){let i=0,n;for(;i<e.length&&!n;){const s=e[i];typeof s=="string"&&!krt.has(s)&&o_(s).values.length&&(n=e[i]),i++}if(n&&r)for(const s of t)e[s]=she(r,n)}class Irt extends NV{constructor(t,r,i,n,s){super(t,r,i,n,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:i}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),SV(c))){const u=ehe(c,r.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!the.has(i)||t.length!==2)return;const[n,s]=t,a=FZ(n),o=FZ(s);if(a!==o)if(jZ(a)&&jZ(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else Og[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,i=[];for(let n=0;n<t.length;n++)(t[n]===null||Crt(t[n]))&&i.push(n);i.length&&Rrt(t,i,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:i}=this;if(!t||!t.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Og[i](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const n=r[r.length-1];n!==void 0&&t.getValue(i,n).jump(n,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const n=t.getValue(r);n&&n.jump(this.measuredOrigin,!1);const s=i.length-1,a=i[s];i[s]=Og[r](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,l])=>{t.getValue(o).set(l)}),this.resolveNoneKeyframes()}}function IV(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){const n=document.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}const ahe=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function OV(e){return _de(e)&&"offsetHeight"in e}const UZ=30,Ort=e=>!isNaN(parseFloat(e)),p2={current:void 0};class jrt{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{const n=Do.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const s of this.dependents)s.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Do.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=Ort(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new yV);const i=this.events[t].add(r);return t==="change"?()=>{i(),Si.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,i){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return p2.current&&p2.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const t=Do.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>UZ)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,UZ);return xV(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Pc(e,t){return new jrt(e,t)}const{schedule:jV}=Ide(queueMicrotask,!1),mc={x:!1,y:!1};function ohe(){return mc.x||mc.y}function Lrt(e){return e==="x"||e==="y"?mc[e]?null:(mc[e]=!0,()=>{mc[e]=!1}):mc.x||mc.y?null:(mc.x=mc.y=!0,()=>{mc.x=mc.y=!1})}function lhe(e,t){const r=IV(e),i=new AbortController,n={passive:!0,...t,signal:i.signal};return[r,n,()=>i.abort()]}function HZ(e){return!(e.pointerType==="touch"||ohe())}function zrt(e,t,r={}){const[i,n,s]=lhe(e,r),a=o=>{if(!HZ(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const u=d=>{HZ(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,n)};return i.forEach(o=>{o.addEventListener("pointerenter",a,n)}),s}const che=(e,t)=>t?e===t?!0:che(e,t.parentElement):!1,LV=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Brt=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Frt(e){return Brt.has(e.tagName)||e.tabIndex!==-1}const kT=new WeakSet;function GZ(e){return t=>{t.key==="Enter"&&e(t)}}function cO(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Vrt=(e,t)=>{const r=e.currentTarget;if(!r)return;const i=GZ(()=>{if(kT.has(r))return;cO(r,"down");const n=GZ(()=>{cO(r,"up")}),s=()=>cO(r,"cancel");r.addEventListener("keyup",n,t),r.addEventListener("blur",s,t)});r.addEventListener("keydown",i,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",i),t)};function WZ(e){return LV(e)&&!ohe()}function Urt(e,t,r={}){const[i,n,s]=lhe(e,r),a=o=>{const l=o.currentTarget;if(!WZ(o))return;kT.add(l);const c=t(l,o),u=(m,v)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",f),kT.has(l)&&kT.delete(l),WZ(m)&&typeof c=="function"&&c(m,{success:v})},d=m=>{u(m,l===window||l===document||r.useGlobalTarget||che(l,m.target))},f=m=>{u(m,!1)};window.addEventListener("pointerup",d,n),window.addEventListener("pointercancel",f,n)};return i.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",a,n),OV(o)&&(o.addEventListener("focus",c=>Vrt(c,n)),!Frt(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),s}function zV(e){return _de(e)&&"ownerSVGElement"in e}const RT=new WeakMap;let IT;const uhe=(e,t,r)=>(i,n)=>n&&n[0]?n[0][e+"Size"]:zV(i)&&"getBBox"in i?i.getBBox()[t]:i[r],Hrt=uhe("inline","width","offsetWidth"),Grt=uhe("block","height","offsetHeight");function Wrt({target:e,borderBoxSize:t}){RT.get(e)?.forEach(r=>{r(e,{get width(){return Hrt(e,t)},get height(){return Grt(e,t)}})})}function qrt(e){e.forEach(Wrt)}function Yrt(){typeof ResizeObserver>"u"||(IT=new ResizeObserver(qrt))}function Xrt(e,t){IT||Yrt();const r=IV(e);return r.forEach(i=>{let n=RT.get(i);n||(n=new Set,RT.set(i,n)),n.add(t),IT?.observe(i)}),()=>{r.forEach(i=>{const n=RT.get(i);n?.delete(t),n?.size||IT?.unobserve(i)})}}const OT=new Set;let Sy;function $rt(){Sy=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};OT.forEach(t=>t(e))},window.addEventListener("resize",Sy)}function Krt(e){return OT.add(e),Sy||$rt(),()=>{OT.delete(e),!OT.size&&typeof Sy=="function"&&(window.removeEventListener("resize",Sy),Sy=void 0)}}function Qrt(e,t){return typeof e=="function"?Krt(e):Xrt(e,t)}function dhe(e,t){let r;const i=()=>{const{currentTime:n}=t,a=(n===null?0:n.value)/100;r!==a&&e(a),r=a};return Si.preUpdate(i,!0),()=>Uc(i)}function Zrt(e){return zV(e)&&e.tagName==="svg"}function Jrt(...e){const t=!Array.isArray(e[0]),r=t?0:-1,i=e[0+r],n=e[1+r],s=e[2+r],a=e[3+r],o=MV(n,s,a);return t?o(i):o}const Ks=e=>!!(e&&e.getVelocity);function eit(e,t,r){const i=e.get();let n=null,s=i,a;const o=typeof i=="string"?i.replace(/[\d.-]/g,""):void 0,l=()=>{n&&(n.stop(),n=null)},c=()=>{l(),n=new PD({keyframes:[YZ(e.get()),YZ(s)],velocity:e.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...r,onUpdate:a})};if(e.attach((u,d)=>(s=u,a=f=>d(qZ(f,o)),Si.postRender(c),e.get()),l),Ks(t)){const u=t.on("change",f=>e.set(qZ(f,o))),d=e.on("destroy",u);return()=>{u(),d()}}return l}function qZ(e,t){return t?e+t:e}function YZ(e){return typeof e=="number"?e:parseFloat(e)}const tit=[...ihe,rs,Xp],rit=e=>tit.find(rhe(e)),cS=O.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class iit extends O.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const i=r.offsetParent,n=OV(i)&&i.offsetWidth||0,s=this.props.sizeRef.current;s.height=r.offsetHeight||0,s.width=r.offsetWidth||0,s.top=r.offsetTop,s.left=r.offsetLeft,s.right=n-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function nit({children:e,isPresent:t,anchorX:r,root:i}){const n=O.useId(),s=O.useRef(null),a=O.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=O.useContext(cS);return O.useInsertionEffect(()=>{const{width:l,height:c,top:u,left:d,right:f}=a.current;if(t||!s.current||!l||!c)return;const m=r==="left"?`left: ${d}`:`right: ${f}`;s.current.dataset.motionPopId=n;const v=document.createElement("style");o&&(v.nonce=o);const y=i??document.head;return y.appendChild(v),v.sheet&&v.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${c}px !important;
            ${m}px !important;
            top: ${u}px !important;
          }
        `),()=>{y.contains(v)&&y.removeChild(v)}},[t]),h.jsx(iit,{isPresent:t,childRef:s,sizeRef:a,children:O.cloneElement(e,{ref:s})})}const sit=({children:e,initial:t,isPresent:r,onExitComplete:i,custom:n,presenceAffectsLayout:s,mode:a,anchorX:o,root:l})=>{const c=pb(ait),u=O.useId();let d=!0,f=O.useMemo(()=>(d=!1,{id:u,initial:t,isPresent:r,custom:n,onExitComplete:m=>{c.set(m,!0);for(const v of c.values())if(!v)return;i&&i()},register:m=>(c.set(m,!1),()=>c.delete(m))}),[r,c,i]);return s&&d&&(f={...f}),O.useMemo(()=>{c.forEach((m,v)=>c.set(v,!1))},[r]),O.useEffect(()=>{!r&&!c.size&&i&&i()},[r]),a==="popLayout"&&(e=h.jsx(nit,{isPresent:r,anchorX:o,root:l,children:e})),h.jsx(MD.Provider,{value:f,children:e})};function ait(){return new Map}function hhe(e=!0){const t=O.useContext(MD);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:i,register:n}=t,s=O.useId();O.useEffect(()=>{if(e)return n(s)},[e]);const a=O.useCallback(()=>e&&i&&i(s),[s,i,e]);return!r&&i?[!1,a]:[!0]}const EC=e=>e.key||"";function XZ(e){const t=[];return O.Children.forEach(e,r=>{O.isValidElement(r)&&t.push(r)}),t}const ya=({children:e,custom:t,initial:r=!0,onExitComplete:i,presenceAffectsLayout:n=!0,mode:s="sync",propagate:a=!1,anchorX:o="left",root:l})=>{const[c,u]=hhe(a),d=O.useMemo(()=>XZ(e),[e]),f=a&&!c?[]:d.map(EC),m=O.useRef(!0),v=O.useRef(d),y=pb(()=>new Map),[x,w]=O.useState(d),[_,S]=O.useState(d);TD(()=>{m.current=!1,v.current=d;for(let C=0;C<_.length;C++){const T=EC(_[C]);f.includes(T)?y.delete(T):y.get(T)!==!0&&y.set(T,!1)}},[_,f.length,f.join("-")]);const P=[];if(d!==x){let C=[...d];for(let T=0;T<_.length;T++){const E=_[T],N=EC(E);f.includes(N)||(C.splice(T,0,E),P.push(E))}return s==="wait"&&P.length&&(C=P),S(XZ(C)),w(d),null}const{forceRender:M}=O.useContext(fV);return h.jsx(h.Fragment,{children:_.map(C=>{const T=EC(C),E=a&&!c?!1:d===_||f.includes(T),N=()=>{if(y.has(T))y.set(T,!0);else return;let D=!0;y.forEach(I=>{I||(D=!1)}),D&&(M?.(),S(v.current),a&&u?.(),i&&i())};return h.jsx(sit,{isPresent:E,initial:!m.current||r?void 0:!1,custom:t,presenceAffectsLayout:n,mode:s,root:l,onExitComplete:E?void 0:N,anchorX:o,children:C},T)})})},fhe=O.createContext({strict:!1}),$Z={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Rx={};for(const e in $Z)Rx[e]={isEnabled:t=>$Z[e].some(r=>!!t[r])};function oit(e){for(const t in e)Rx[t]={...Rx[t],...e[t]}}const lit=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function VP(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||lit.has(e)}let phe=e=>!VP(e);function cit(e){typeof e=="function"&&(phe=t=>t.startsWith("on")?!VP(t):e(t))}try{cit(require("@emotion/is-prop-valid").default)}catch{}function uit(e,t,r){const i={};for(const n in e)n==="values"&&typeof e.values=="object"||(phe(n)||r===!0&&VP(n)||!t&&!VP(n)||e.draggable&&n.startsWith("onDrag"))&&(i[n]=e[n]);return i}const DD=O.createContext({});function ND(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function l_(e){return typeof e=="string"||Array.isArray(e)}const BV=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],FV=["initial",...BV];function kD(e){return ND(e.animate)||FV.some(t=>l_(e[t]))}function mhe(e){return!!(kD(e)||e.variants)}function dit(e,t){if(kD(e)){const{initial:r,animate:i}=e;return{initial:r===!1||l_(r)?r:void 0,animate:l_(i)?i:void 0}}return e.inherit!==!1?t:{}}function hit(e){const{initial:t,animate:r}=dit(e,O.useContext(DD));return O.useMemo(()=>({initial:t,animate:r}),[KZ(t),KZ(r)])}function KZ(e){return Array.isArray(e)?e.join(" "):e}const c_={};function fit(e){for(const t in e)c_[t]=e[t],_V(t)&&(c_[t].isCSSVariable=!0)}function ghe(e,{layout:t,layoutId:r}){return vb.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!c_[e]||e==="opacity")}const pit={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},mit=gb.length;function git(e,t,r){let i="",n=!0;for(let s=0;s<mit;s++){const a=gb[s],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||r){const c=ahe(o,RV[a]);if(!l){n=!1;const u=pit[a]||a;i+=`${u}(${c}) `}r&&(t[a]=c)}}return i=i.trim(),r?i=r(t,n?"":i):n&&(i="none"),i}function VV(e,t,r){const{style:i,vars:n,transformOrigin:s}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(vb.has(l)){a=!0;continue}else if(_V(l)){n[l]=c;continue}else{const u=ahe(c,RV[l]);l.startsWith("origin")?(o=!0,s[l]=u):i[l]=u}}if(t.transform||(a||r?i.transform=git(t,e.transform,r):i.transform&&(i.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=s;i.transformOrigin=`${l} ${c} ${u}`}}const UV=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function vhe(e,t,r){for(const i in t)!Ks(t[i])&&!ghe(i,r)&&(e[i]=t[i])}function vit({transformTemplate:e},t){return O.useMemo(()=>{const r=UV();return VV(r,t,e),Object.assign({},r.vars,r.style)},[t])}function yit(e,t){const r=e.style||{},i={};return vhe(i,r,e),Object.assign(i,vit(e,t)),i}function xit(e,t){const r={},i=yit(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=i,r}const bit={offset:"stroke-dashoffset",array:"stroke-dasharray"},wit={offset:"strokeDashoffset",array:"strokeDasharray"};function _it(e,t,r=1,i=0,n=!0){e.pathLength=1;const s=n?bit:wit;e[s.offset]=br.transform(-i);const a=br.transform(t),o=br.transform(r);e[s.array]=`${a} ${o}`}function yhe(e,{attrX:t,attrY:r,attrScale:i,pathLength:n,pathSpacing:s=1,pathOffset:a=0,...o},l,c,u){if(VV(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:f}=e;d.transform&&(f.transform=d.transform,delete d.transform),(f.transform||d.transformOrigin)&&(f.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),f.transform&&(f.transformBox=u?.transformBox??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),r!==void 0&&(d.y=r),i!==void 0&&(d.scale=i),n!==void 0&&_it(d,n,s,a,!1)}const xhe=()=>({...UV(),attrs:{}}),bhe=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Sit(e,t,r,i){const n=O.useMemo(()=>{const s=xhe();return yhe(s,t,bhe(i),e.transformTemplate,e.style),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};vhe(s,e.style,e),n.style={...s,...n.style}}return n}const Eit=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function HV(e){return typeof e!="string"||e.includes("-")?!1:!!(Eit.indexOf(e)>-1||/[A-Z]/u.test(e))}function Ait(e,t,r,{latestValues:i},n,s=!1){const o=(HV(e)?Sit:xit)(t,i,n,e),l=uit(t,typeof e=="string",s),c=e!==O.Fragment?{...l,...o,ref:r}:{},{children:u}=t,d=O.useMemo(()=>Ks(u)?u.get():u,[u]);return O.createElement(e,{...c,children:d})}function QZ(e){const t=[{},{}];return e?.values.forEach((r,i)=>{t[0][i]=r.get(),t[1][i]=r.getVelocity()}),t}function GV(e,t,r,i){if(typeof t=="function"){const[n,s]=QZ(i);t=t(r!==void 0?r:e.custom,n,s)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[n,s]=QZ(i);t=t(r!==void 0?r:e.custom,n,s)}return t}function jT(e){return Ks(e)?e.get():e}function Cit({scrapeMotionValuesFromProps:e,createRenderState:t},r,i,n){return{latestValues:Tit(r,i,n,e),renderState:t()}}function Tit(e,t,r,i){const n={},s=i(e,{});for(const f in s)n[f]=jT(s[f]);let{initial:a,animate:o}=e;const l=kD(e),c=mhe(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=r?r.initial===!1:!1;u=u||a===!1;const d=u?o:a;if(d&&typeof d!="boolean"&&!ND(d)){const f=Array.isArray(d)?d:[d];for(let m=0;m<f.length;m++){const v=GV(e,f[m]);if(v){const{transitionEnd:y,transition:x,...w}=v;for(const _ in w){let S=w[_];if(Array.isArray(S)){const P=u?S.length-1:0;S=S[P]}S!==null&&(n[_]=S)}for(const _ in y)n[_]=y[_]}}}return n}const whe=e=>(t,r)=>{const i=O.useContext(DD),n=O.useContext(MD),s=()=>Cit(e,t,i,n);return r?s():pb(s)};function WV(e,t,r){const{style:i}=e,n={};for(const s in i)(Ks(i[s])||t.style&&Ks(t.style[s])||ghe(s,e)||r?.getValue(s)?.liveStyle!==void 0)&&(n[s]=i[s]);return n}const Mit=whe({scrapeMotionValuesFromProps:WV,createRenderState:UV});function _he(e,t,r){const i=WV(e,t,r);for(const n in e)if(Ks(e[n])||Ks(t[n])){const s=gb.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;i[s]=e[n]}return i}const Pit=whe({scrapeMotionValuesFromProps:_he,createRenderState:xhe}),Dit=Symbol.for("motionComponentSymbol");function Ey(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Nit(e,t,r){return O.useCallback(i=>{i&&e.onMount&&e.onMount(i),t&&(i?t.mount(i):t.unmount()),r&&(typeof r=="function"?r(i):Ey(r)&&(r.current=i))},[t])}const qV=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),kit="framerAppearId",She="data-"+qV(kit),Ehe=O.createContext({});function Rit(e,t,r,i,n){const{visualElement:s}=O.useContext(DD),a=O.useContext(fhe),o=O.useContext(MD),l=O.useContext(cS).reducedMotion,c=O.useRef(null);i=i||a.renderer,!c.current&&i&&(c.current=i(e,{visualState:t,parent:s,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=O.useContext(Ehe);u&&!u.projection&&n&&(u.type==="html"||u.type==="svg")&&Iit(c.current,r,n,d);const f=O.useRef(!1);O.useInsertionEffect(()=>{u&&f.current&&u.update(r,o)});const m=r[She],v=O.useRef(!!m&&!window.MotionHandoffIsComplete?.(m)&&window.MotionHasOptimisedAnimation?.(m));return TD(()=>{u&&(f.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),u.scheduleRenderMicrotask(),v.current&&u.animationState&&u.animationState.animateChanges())}),O.useEffect(()=>{u&&(!v.current&&u.animationState&&u.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(m)}),v.current=!1))}),u}function Iit(e,t,r,i){const{layoutId:n,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:Ahe(e.parent)),e.projection.setOptions({layoutId:n,layout:s,alwaysMeasureLayout:!!a||o&&Ey(o),visualElement:e,animationType:typeof s=="string"?s:"both",initialPromotionConfig:i,crossfade:u,layoutScroll:l,layoutRoot:c})}function Ahe(e){if(e)return e.options.allowProjection!==!1?e.projection:Ahe(e.parent)}function uO(e,{forwardMotionProps:t=!1}={},r,i){r&&oit(r);const n=HV(e)?Pit:Mit;function s(o,l){let c;const u={...O.useContext(cS),...o,layoutId:Oit(o)},{isStatic:d}=u,f=hit(o),m=n(o,d);if(!d&&pV){jit();const v=Lit(u);c=v.MeasureLayout,f.visualElement=Rit(e,m,u,i,v.ProjectionNode)}return h.jsxs(DD.Provider,{value:f,children:[c&&f.visualElement?h.jsx(c,{visualElement:f.visualElement,...u}):null,Ait(e,o,Nit(m,f.visualElement,l),m,d,t)]})}s.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const a=O.forwardRef(s);return a[Dit]=e,a}function Oit({layoutId:e}){const t=O.useContext(fV).id;return t&&e!==void 0?t+"-"+e:e}function jit(e,t){O.useContext(fhe).strict}function Lit(e){const{drag:t,layout:r}=Rx;if(!t&&!r)return{};const i={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}function zit(e,t){if(typeof Proxy>"u")return uO;const r=new Map,i=(s,a)=>uO(s,a,e,t),n=(s,a)=>i(s,a);return new Proxy(n,{get:(s,a)=>a==="create"?i:(r.has(a)||r.set(a,uO(a,void 0,e,t)),r.get(a))})}function Che({top:e,left:t,right:r,bottom:i}){return{x:{min:t,max:r},y:{min:e,max:i}}}function Bit({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Fit(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:i.y,right:i.x}}function dO(e){return e===void 0||e===1}function Az({scale:e,scaleX:t,scaleY:r}){return!dO(e)||!dO(t)||!dO(r)}function eg(e){return Az(e)||The(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function The(e){return ZZ(e.x)||ZZ(e.y)}function ZZ(e){return e&&e!=="0%"}function UP(e,t,r){const i=e-r,n=t*i;return r+n}function JZ(e,t,r,i,n){return n!==void 0&&(e=UP(e,n,i)),UP(e,r,i)+t}function Cz(e,t=0,r=1,i,n){e.min=JZ(e.min,t,r,i,n),e.max=JZ(e.max,t,r,i,n)}function Mhe(e,{x:t,y:r}){Cz(e.x,t.translate,t.scale,t.originPoint),Cz(e.y,r.translate,r.scale,r.originPoint)}const eJ=.999999999999,tJ=1.0000000000001;function Vit(e,t,r,i=!1){const n=r.length;if(!n)return;t.x=t.y=1;let s,a;for(let o=0;o<n;o++){s=r[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Cy(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,Mhe(e,a)),i&&eg(s.latestValues)&&Cy(e,s.latestValues))}t.x<tJ&&t.x>eJ&&(t.x=1),t.y<tJ&&t.y>eJ&&(t.y=1)}function Ay(e,t){e.min=e.min+t,e.max=e.max+t}function rJ(e,t,r,i,n=.5){const s=vn(e.min,e.max,n);Cz(e,t,r,s,i)}function Cy(e,t){rJ(e.x,t.x,t.scaleX,t.scale,t.originX),rJ(e.y,t.y,t.scaleY,t.scale,t.originY)}function Phe(e,t){return Che(Fit(e.getBoundingClientRect(),t))}function Uit(e,t,r){const i=Phe(e,r),{scroll:n}=t;return n&&(Ay(i.x,n.offset.x),Ay(i.y,n.offset.y)),i}const iJ=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ty=()=>({x:iJ(),y:iJ()}),nJ=()=>({min:0,max:0}),zn=()=>({x:nJ(),y:nJ()}),Tz={current:null},Dhe={current:!1};function Hit(){if(Dhe.current=!0,!!pV)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Tz.current=e.matches;e.addEventListener("change",t),t()}else Tz.current=!1}const Git=new WeakMap;function Wit(e,t,r){for(const i in t){const n=t[i],s=r[i];if(Ks(n))e.addValue(i,n);else if(Ks(s))e.addValue(i,Pc(n,{owner:e}));else if(s!==n)if(e.hasValue(i)){const a=e.getValue(i);a.liveStyle===!0?a.jump(n):a.hasAnimated||a.set(n)}else{const a=e.getStaticValue(i);e.addValue(i,Pc(a!==void 0?a:n,{owner:e}))}}for(const i in r)t[i]===void 0&&e.removeValue(i);return t}const sJ=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class qit{scrapeMotionValuesFromProps(t,r,i){return{}}constructor({parent:t,props:r,presenceContext:i,reducedMotionConfig:n,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=NV,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Do.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,Si.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=kD(r),this.isVariantNode=mhe(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(r,{},this);for(const f in d){const m=d[f];l[f]!==void 0&&Ks(m)&&m.set(l[f])}}mount(t){this.current=t,Git.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,i)=>this.bindToMotionValue(i,r)),Dhe.current||Hit(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Tz.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Uc(this.notifyUpdate),Uc(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const i=vb.has(t);i&&this.onBindTransform&&this.onBindTransform();const n=r.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&Si.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let s;window.MotionCheckAppearSync&&(s=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{n(),s&&s(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Rx){const r=Rx[t];if(!r)continue;const{isEnabled:i,Feature:n}=r;if(!this.features[t]&&n&&i(this.props)&&(this.features[t]=new n(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):zn()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let i=0;i<sJ.length;i++){const n=sJ[i];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const s="on"+n,a=t[s];a&&(this.propEventSubscriptions[n]=this.on(n,a))}this.prevMotionValues=Wit(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const i=this.values.get(t);r!==i&&(i&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&r!==void 0&&(i=Pc(r===null?void 0:r,{owner:this}),this.addValue(t,i)),i}readValue(t,r){let i=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return i!=null&&(typeof i=="string"&&(wde(i)||Sde(i))?i=parseFloat(i):!rit(i)&&Xp.test(r)&&(i=she(t,r)),this.setBaseTarget(t,Ks(i)?i.get():i)),Ks(i)?i.get():i}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const s=GV(this.props,r,this.presenceContext?.custom);s&&(i=s[t])}if(r&&i!==void 0)return i;const n=this.getBaseTargetFromProps(this.props,t);return n!==void 0&&!Ks(n)?n:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new yV),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){jV.render(this.render)}}class Nhe extends qit{constructor(){super(...arguments),this.KeyframeResolver=Irt}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:i}){delete r[t],delete i[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Ks(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function khe(e,{style:t,vars:r},i,n){const s=e.style;let a;for(a in t)s[a]=t[a];n?.applyProjectionStyles(s,i);for(a in r)s.setProperty(a,r[a])}function Yit(e){return window.getComputedStyle(e)}class Xit extends Nhe{constructor(){super(...arguments),this.type="html",this.renderInstance=khe}readValueFromInstance(t,r){if(vb.has(r))return this.projection?.isProjecting?yz(r):ert(t,r);{const i=Yit(t),n=(_V(r)?i.getPropertyValue(r):i[r])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(t,{transformPagePoint:r}){return Phe(t,r)}build(t,r,i){VV(t,r,i.transformTemplate)}scrapeMotionValuesFromProps(t,r,i){return WV(t,r,i)}}const Rhe=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function $it(e,t,r,i){khe(e,t,void 0,i);for(const n in t.attrs)e.setAttribute(Rhe.has(n)?n:qV(n),t.attrs[n])}class Kit extends Nhe{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=zn}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(vb.has(r)){const i=nhe(r);return i&&i.default||0}return r=Rhe.has(r)?r:qV(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,i){return _he(t,r,i)}build(t,r,i){yhe(t,r,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(t,r,i,n){$it(t,r,i,n)}mount(t){this.isSVGTag=bhe(t.tagName),super.mount(t)}}const Qit=(e,t)=>HV(e)?new Kit(t):new Xit(t,{allowProjection:e!==O.Fragment});function u_(e,t,r){const i=e.getProps();return GV(i,t,r!==void 0?r:i.custom,e)}const Mz=e=>Array.isArray(e);function Zit(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Pc(r))}function Jit(e){return Mz(e)?e[e.length-1]||0:e}function ent(e,t){const r=u_(e,t);let{transitionEnd:i={},transition:n={},...s}=r||{};s={...s,...i};for(const a in s){const o=Jit(s[a]);Zit(e,a,o)}}function tnt(e){return!!(Ks(e)&&e.add)}function Pz(e,t){const r=e.getValue("willChange");if(tnt(r))return r.add(t);if(!r&&Gh.WillChange){const i=new Gh.WillChange("auto");e.addValue("willChange",i),i.add(t)}}function Ihe(e){return e.props[She]}const rnt=e=>e!==null;function int(e,{repeat:t,repeatType:r="loop"},i){const n=e.filter(rnt),s=t&&r!=="loop"&&t%2===1?0:n.length-1;return n[s]}const nnt={type:"spring",stiffness:500,damping:25,restSpeed:10},snt=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),ant={type:"keyframes",duration:.8},ont={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},lnt=(e,{keyframes:t})=>t.length>2?ant:vb.has(e)?e.startsWith("scale")?snt(t[1]):nnt:ont;function cnt({when:e,delay:t,delayChildren:r,staggerChildren:i,staggerDirection:n,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const YV=(e,t,r,i={},n,s)=>a=>{const o=kV(i,e)||{},l=o.delay||i.delay||0;let{elapsed:c=0}=i;c=c-Xu(l);const u={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:f=>{t.set(f),o.onUpdate&&o.onUpdate(f)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:s?void 0:n};cnt(o)||Object.assign(u,lnt(e,u)),u.duration&&(u.duration=Xu(u.duration)),u.repeatDelay&&(u.repeatDelay=Xu(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(Sz(u),u.delay===0&&(d=!0)),(Gh.instantAnimations||Gh.skipAnimations)&&(d=!0,Sz(u),u.delay=0),u.allowFlatten=!o.type&&!o.ease,d&&!s&&t.get()!==void 0){const f=int(u.keyframes,o);if(f!==void 0){Si.update(()=>{u.onUpdate(f),u.onComplete()});return}}return o.isSync?new PD(u):new _rt(u)};function unt({protectedKeys:e,needsAnimating:t},r){const i=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,i}function Ohe(e,t,{delay:r=0,transitionOverride:i,type:n}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:a,...o}=t;i&&(s=i);const l=[],c=n&&e.animationState&&e.animationState.getState()[n];for(const u in o){const d=e.getValue(u,e.latestValues[u]??null),f=o[u];if(f===void 0||c&&unt(c,u))continue;const m={delay:r,...kV(s||{},u)},v=d.get();if(v!==void 0&&!d.isAnimating&&!Array.isArray(f)&&f===v&&!m.velocity)continue;let y=!1;if(window.MotionHandoffAnimation){const w=Ihe(e);if(w){const _=window.MotionHandoffAnimation(w,u,Si);_!==null&&(m.startTime=_,y=!0)}}Pz(e,u),d.start(YV(u,d,f,e.shouldReduceMotion&&the.has(u)?{type:!1}:m,e,y));const x=d.animation;x&&l.push(x)}return a&&Promise.all(l).then(()=>{Si.update(()=>{a&&ent(e,a)})}),l}function Dz(e,t,r={}){const i=u_(e,t,r.type==="exit"?e.presenceContext?.custom:void 0);let{transition:n=e.getDefaultTransition()||{}}=i||{};r.transitionOverride&&(n=r.transitionOverride);const s=i?()=>Promise.all(Ohe(e,i,r)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:d}=n;return dnt(e,t,l,c,u,d,r)}:()=>Promise.resolve(),{when:o}=n;if(o){const[l,c]=o==="beforeChildren"?[s,a]:[a,s];return l().then(()=>c())}else return Promise.all([s(),a(r.delay)])}function dnt(e,t,r=0,i=0,n=0,s=1,a){const o=[],l=e.variantChildren.size,c=(l-1)*n,u=typeof i=="function",d=u?f=>i(f,l):s===1?(f=0)=>f*n:(f=0)=>c-f*n;return Array.from(e.variantChildren).sort(hnt).forEach((f,m)=>{f.notify("AnimationStart",t),o.push(Dz(f,t,{...a,delay:r+(u?0:i)+d(m)}).then(()=>f.notify("AnimationComplete",t)))}),Promise.all(o)}function hnt(e,t){return e.sortNodePosition(t)}function fnt(e,t,r={}){e.notify("AnimationStart",t);let i;if(Array.isArray(t)){const n=t.map(s=>Dz(e,s,r));i=Promise.all(n)}else if(typeof t=="string")i=Dz(e,t,r);else{const n=typeof t=="function"?u_(e,t,r.custom):t;i=Promise.all(Ohe(e,n,r))}return i.then(()=>{e.notify("AnimationComplete",t)})}function jhe(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let i=0;i<r;i++)if(t[i]!==e[i])return!1;return!0}const pnt=FV.length;function Lhe(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?Lhe(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<pnt;r++){const i=FV[r],n=e.props[i];(l_(n)||n===!1)&&(t[i]=n)}return t}const mnt=[...BV].reverse(),gnt=BV.length;function vnt(e){return t=>Promise.all(t.map(({animation:r,options:i})=>fnt(e,r,i)))}function ynt(e){let t=vnt(e),r=aJ(),i=!0;const n=l=>(c,u)=>{const d=u_(e,u,l==="exit"?e.presenceContext?.custom:void 0);if(d){const{transition:f,transitionEnd:m,...v}=d;c={...c,...v,...m}}return c};function s(l){t=l(e)}function a(l){const{props:c}=e,u=Lhe(e.parent)||{},d=[],f=new Set;let m={},v=1/0;for(let x=0;x<gnt;x++){const w=mnt[x],_=r[w],S=c[w]!==void 0?c[w]:u[w],P=l_(S),M=w===l?_.isActive:null;M===!1&&(v=x);let C=S===u[w]&&S!==c[w]&&P;if(C&&i&&e.manuallyAnimateOnMount&&(C=!1),_.protectedKeys={...m},!_.isActive&&M===null||!S&&!_.prevProp||ND(S)||typeof S=="boolean")continue;const T=xnt(_.prevProp,S);let E=T||w===l&&_.isActive&&!C&&P||x>v&&P,N=!1;const D=Array.isArray(S)?S:[S];let I=D.reduce(n(w),{});M===!1&&(I={});const{prevResolvedValues:j={}}=_,L={...j,...I},B=Y=>{E=!0,f.has(Y)&&(N=!0,f.delete(Y)),_.needsAnimating[Y]=!0;const X=e.getValue(Y);X&&(X.liveStyle=!1)};for(const Y in L){const X=I[Y],re=j[Y];if(m.hasOwnProperty(Y))continue;let F=!1;Mz(X)&&Mz(re)?F=!jhe(X,re):F=X!==re,F?X!=null?B(Y):f.add(Y):X!==void 0&&f.has(Y)?B(Y):_.protectedKeys[Y]=!0}_.prevProp=S,_.prevResolvedValues=I,_.isActive&&(m={...m,...I}),i&&e.blockInitialAnimation&&(E=!1),E&&(!(C&&T)||N)&&d.push(...D.map(Y=>({animation:Y,options:{type:w}})))}if(f.size){const x={};if(typeof c.initial!="boolean"){const w=u_(e,Array.isArray(c.initial)?c.initial[0]:c.initial);w&&w.transition&&(x.transition=w.transition)}f.forEach(w=>{const _=e.getBaseTarget(w),S=e.getValue(w);S&&(S.liveStyle=!0),x[w]=_??null}),d.push({animation:x})}let y=!!d.length;return i&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(y=!1),i=!1,y?t(d):Promise.resolve()}function o(l,c){if(r[l].isActive===c)return Promise.resolve();e.variantChildren?.forEach(d=>d.animationState?.setActive(l,c)),r[l].isActive=c;const u=a(l);for(const d in r)r[d].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>r,reset:()=>{r=aJ(),i=!0}}}function xnt(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!jhe(t,e):!1}function Gm(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function aJ(){return{animate:Gm(!0),whileInView:Gm(),whileHover:Gm(),whileTap:Gm(),whileDrag:Gm(),whileFocus:Gm(),exit:Gm()}}class nm{constructor(t){this.isMounted=!1,this.node=t}update(){}}class bnt extends nm{constructor(t){super(t),t.animationState||(t.animationState=ynt(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();ND(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let wnt=0;class _nt extends nm{constructor(){super(...arguments),this.id=wnt++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;const n=this.node.animationState.setActive("exit",!t);r&&!t&&n.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Snt={animation:{Feature:bnt},exit:{Feature:_nt}};function d_(e,t,r,i={passive:!0}){return e.addEventListener(t,r,i),()=>e.removeEventListener(t,r)}function uS(e){return{point:{x:e.pageX,y:e.pageY}}}const Ent=e=>t=>LV(t)&&e(t,uS(t));function m2(e,t,r,i){return d_(e,t,Ent(r),i)}const zhe=1e-4,Ant=1-zhe,Cnt=1+zhe,Bhe=.01,Tnt=0-Bhe,Mnt=0+Bhe;function lo(e){return e.max-e.min}function Pnt(e,t,r){return Math.abs(e-t)<=r}function oJ(e,t,r,i=.5){e.origin=i,e.originPoint=vn(t.min,t.max,e.origin),e.scale=lo(r)/lo(t),e.translate=vn(r.min,r.max,e.origin)-e.originPoint,(e.scale>=Ant&&e.scale<=Cnt||isNaN(e.scale))&&(e.scale=1),(e.translate>=Tnt&&e.translate<=Mnt||isNaN(e.translate))&&(e.translate=0)}function g2(e,t,r,i){oJ(e.x,t.x,r.x,i?i.originX:void 0),oJ(e.y,t.y,r.y,i?i.originY:void 0)}function lJ(e,t,r){e.min=r.min+t.min,e.max=e.min+lo(t)}function Dnt(e,t,r){lJ(e.x,t.x,r.x),lJ(e.y,t.y,r.y)}function cJ(e,t,r){e.min=t.min-r.min,e.max=e.min+lo(t)}function v2(e,t,r){cJ(e.x,t.x,r.x),cJ(e.y,t.y,r.y)}function Dl(e){return[e("x"),e("y")]}const Fhe=({current:e})=>e?e.ownerDocument.defaultView:null,uJ=(e,t)=>Math.abs(e-t);function Nnt(e,t){const r=uJ(e.x,t.x),i=uJ(e.y,t.y);return Math.sqrt(r**2+i**2)}class Vhe{constructor(t,r,{transformPagePoint:i,contextWindow:n=window,dragSnapToOrigin:s=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=fO(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,v=Nnt(f.offset,{x:0,y:0})>=this.distanceThreshold;if(!m&&!v)return;const{point:y}=f,{timestamp:x}=Fs;this.history.push({...y,timestamp:x});const{onStart:w,onMove:_}=this.handlers;m||(w&&w(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),_&&_(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=hO(m,this.transformPagePoint),Si.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:v,onSessionEnd:y,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=fO(f.type==="pointercancel"?this.lastMoveEventInfo:hO(m,this.transformPagePoint),this.history);this.startEvent&&v&&v(f,w),y&&y(f,w)},!LV(t))return;this.dragSnapToOrigin=s,this.handlers=r,this.transformPagePoint=i,this.distanceThreshold=a,this.contextWindow=n||window;const o=uS(t),l=hO(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=Fs;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=r;d&&d(t,fO(l,this.history)),this.removeListeners=aS(m2(this.contextWindow,"pointermove",this.handlePointerMove),m2(this.contextWindow,"pointerup",this.handlePointerUp),m2(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Uc(this.updatePoint)}}function hO(e,t){return t?{point:t(e.point)}:e}function dJ(e,t){return{x:e.x-t.x,y:e.y-t.y}}function fO({point:e},t){return{point:e,delta:dJ(e,Uhe(t)),offset:dJ(e,knt(t)),velocity:Rnt(t,.1)}}function knt(e){return e[0]}function Uhe(e){return e[e.length-1]}function Rnt(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,i=null;const n=Uhe(e);for(;r>=0&&(i=e[r],!(n.timestamp-i.timestamp>Xu(t)));)r--;if(!i)return{x:0,y:0};const s=$u(n.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const a={x:(n.x-i.x)/s,y:(n.y-i.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function Int(e,{min:t,max:r},i){return t!==void 0&&e<t?e=i?vn(t,e,i.min):Math.max(e,t):r!==void 0&&e>r&&(e=i?vn(r,e,i.max):Math.min(e,r)),e}function hJ(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function Ont(e,{top:t,left:r,bottom:i,right:n}){return{x:hJ(e.x,r,n),y:hJ(e.y,t,i)}}function fJ(e,t){let r=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,i]=[i,r]),{min:r,max:i}}function jnt(e,t){return{x:fJ(e.x,t.x),y:fJ(e.y,t.y)}}function Lnt(e,t){let r=.5;const i=lo(e),n=lo(t);return n>i?r=kx(t.min,t.max-i,e.min):i>n&&(r=kx(e.min,e.max-n,t.min)),od(0,1,r)}function znt(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Nz=.35;function Bnt(e=Nz){return e===!1?e=0:e===!0&&(e=Nz),{x:pJ(e,"left","right"),y:pJ(e,"top","bottom")}}function pJ(e,t,r){return{min:mJ(e,t),max:mJ(e,r)}}function mJ(e,t){return typeof e=="number"?e:e[t]||0}const Fnt=new WeakMap;class Vnt{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=zn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:i}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(uS(d).point)},a=(d,f)=>{const{drag:m,dragPropagation:v,onDragStart:y}=this.getProps();if(m&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Lrt(m),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Dl(w=>{let _=this.getAxisMotionValue(w).get()||0;if(Ku.test(_)){const{projection:S}=this.visualElement;if(S&&S.layout){const P=S.layout.layoutBox[w];P&&(_=lo(P)*(parseFloat(_)/100))}}this.originPoint[w]=_}),y&&Si.postRender(()=>y(d,f)),Pz(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(d,f)=>{this.latestPointerEvent=d,this.latestPanInfo=f;const{dragPropagation:m,dragDirectionLock:v,onDirectionLock:y,onDrag:x}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=f;if(v&&this.currentDirection===null){this.currentDirection=Unt(w),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",f.point,w),this.updateAxis("y",f.point,w),this.visualElement.render(),x&&x(d,f)},l=(d,f)=>{this.latestPointerEvent=d,this.latestPanInfo=f,this.stop(d,f),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>Dl(d=>this.getAnimationState(d)==="paused"&&this.getAxisMotionValue(d).animation?.play()),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Vhe(t,{onSessionStart:s,onStart:a,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:i,contextWindow:Fhe(this.visualElement)})}stop(t,r){const i=t||this.latestPointerEvent,n=r||this.latestPanInfo,s=this.isDragging;if(this.cancel(),!s||!n||!i)return;const{velocity:a}=n;this.startAnimation(a);const{onDragEnd:o}=this.getProps();o&&Si.postRender(()=>o(i,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,i){const{drag:n}=this.getProps();if(!i||!AC(t,n,this.currentDirection))return;const s=this.getAxisMotionValue(t);let a=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(a=Int(a,this.constraints[t],this.elastic[t])),s.set(a)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,n=this.constraints;t&&Ey(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=Ont(i.layoutBox,t):this.constraints=!1,this.elastic=Bnt(r),n!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Dl(s=>{this.constraints!==!1&&this.getAxisMotionValue(s)&&(this.constraints[s]=znt(i.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Ey(t))return!1;const i=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const s=Uit(i,n.root,this.visualElement.getTransformPagePoint());let a=jnt(n.layout.layoutBox,s);if(r){const o=r(Bit(a));this.hasMutatedConstraints=!!o,o&&(a=Che(o))}return a}startAnimation(t){const{drag:r,dragMomentum:i,dragElastic:n,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Dl(u=>{if(!AC(u,r,this.currentDirection))return;let d=l&&l[u]||{};a&&(d={min:0,max:0});const f=n?200:1e6,m=n?40:1e7,v={type:"inertia",velocity:i?t[u]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...s,...d};return this.startAxisValueAnimation(u,v)});return Promise.all(c).then(o)}startAxisValueAnimation(t,r){const i=this.getAxisMotionValue(t);return Pz(this.visualElement,t),i.start(YV(t,i,0,r,this.visualElement,!1))}stopAnimation(){Dl(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Dl(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,i=this.visualElement.getProps(),n=i[r];return n||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){Dl(r=>{const{drag:i}=this.getProps();if(!AC(r,i,this.currentDirection))return;const{projection:n}=this.visualElement,s=this.getAxisMotionValue(r);if(n&&n.layout){const{min:a,max:o}=n.layout.layoutBox[r];s.set(t[r]-vn(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:i}=this.visualElement;if(!Ey(r)||!i||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Dl(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();n[a]=Lnt({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Dl(a=>{if(!AC(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(vn(l,c,n[a]))})}addListeners(){if(!this.visualElement.current)return;Fnt.set(this.visualElement,this);const t=this.visualElement.current,r=m2(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),i=()=>{const{dragConstraints:l}=this.getProps();Ey(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,s=n.addEventListener("measure",i);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),Si.read(i);const a=d_(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Dl(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),r(),s(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:i=!1,dragPropagation:n=!1,dragConstraints:s=!1,dragElastic:a=Nz,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:i,dragPropagation:n,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function AC(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function Unt(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class Hnt extends nm{constructor(t){super(t),this.removeGroupControls=Io,this.removeListeners=Io,this.controls=new Vnt(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Io}unmount(){this.removeGroupControls(),this.removeListeners()}}const gJ=e=>(t,r)=>{e&&Si.postRender(()=>e(t,r))};class Gnt extends nm{constructor(){super(...arguments),this.removePointerDownListener=Io}onPointerDown(t){this.session=new Vhe(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Fhe(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:i,onPanEnd:n}=this.node.getProps();return{onSessionStart:gJ(t),onStart:gJ(r),onMove:i,onEnd:(s,a)=>{delete this.session,n&&Si.postRender(()=>n(s,a))}}}mount(){this.removePointerDownListener=m2(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const LT={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function vJ(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const nw={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(br.test(e))e=parseFloat(e);else return e;const r=vJ(e,t.target.x),i=vJ(e,t.target.y);return`${r}% ${i}%`}},Wnt={correct:(e,{treeScale:t,projectionDelta:r})=>{const i=e,n=Xp.parse(e);if(n.length>5)return i;const s=Xp.createTransformer(e),a=typeof n[0]!="number"?1:0,o=r.x.scale*t.x,l=r.y.scale*t.y;n[0+a]/=o,n[1+a]/=l;const c=vn(o,l,.5);return typeof n[2+a]=="number"&&(n[2+a]/=c),typeof n[3+a]=="number"&&(n[3+a]/=c),s(n)}};let yJ=!1;class qnt extends O.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:i,layoutId:n}=this.props,{projection:s}=t;fit(Ynt),s&&(r.group&&r.group.add(s),i&&i.register&&n&&i.register(s),yJ&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),LT.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:i,drag:n,isPresent:s}=this.props,{projection:a}=i;return a&&(a.isPresent=s,yJ=!0,n||t.layoutDependency!==r||r===void 0||t.isPresent!==s?a.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?a.promote():a.relegate()||Si.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),jV.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:i}=this.props,{projection:n}=t;n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),i&&i.deregister&&i.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Hhe(e){const[t,r]=hhe(),i=O.useContext(fV);return h.jsx(qnt,{...e,layoutGroup:i,switchLayoutGroup:O.useContext(Ehe),isPresent:t,safeToRemove:r})}const Ynt={borderRadius:{...nw,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:nw,borderTopRightRadius:nw,borderBottomLeftRadius:nw,borderBottomRightRadius:nw,boxShadow:Wnt};function Xnt(e,t,r){const i=Ks(e)?e:Pc(e);return i.start(YV("",i,t,r)),i.animation}const $nt=(e,t)=>e.depth-t.depth;class Knt{constructor(){this.children=[],this.isDirty=!1}add(t){mV(this.children,t),this.isDirty=!0}remove(t){gV(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort($nt),this.isDirty=!1,this.children.forEach(t)}}function Qnt(e,t){const r=Do.now(),i=({timestamp:n})=>{const s=n-r;s>=t&&(Uc(i),e(s-t))};return Si.setup(i,!0),()=>Uc(i)}const Ghe=["TopLeft","TopRight","BottomLeft","BottomRight"],Znt=Ghe.length,xJ=e=>typeof e=="string"?parseFloat(e):e,bJ=e=>typeof e=="number"||br.test(e);function Jnt(e,t,r,i,n,s){n?(e.opacity=vn(0,r.opacity??1,est(i)),e.opacityExit=vn(t.opacity??1,0,tst(i))):s&&(e.opacity=vn(t.opacity??1,r.opacity??1,i));for(let a=0;a<Znt;a++){const o=`border${Ghe[a]}Radius`;let l=wJ(t,o),c=wJ(r,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||bJ(l)===bJ(c)?(e[o]=Math.max(vn(xJ(l),xJ(c),i),0),(Ku.test(c)||Ku.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||r.rotate)&&(e.rotate=vn(t.rotate||0,r.rotate||0,i))}function wJ(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const est=Whe(0,.5,Dde),tst=Whe(.5,.95,Io);function Whe(e,t,r){return i=>i<e?0:i>t?1:r(kx(e,t,i))}function _J(e,t){e.min=t.min,e.max=t.max}function Pl(e,t){_J(e.x,t.x),_J(e.y,t.y)}function SJ(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function EJ(e,t,r,i,n){return e-=t,e=UP(e,1/r,i),n!==void 0&&(e=UP(e,1/n,i)),e}function rst(e,t=0,r=1,i=.5,n,s=e,a=e){if(Ku.test(t)&&(t=parseFloat(t),t=vn(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=vn(s.min,s.max,i);e===s&&(o-=t),e.min=EJ(e.min,t,r,o,n),e.max=EJ(e.max,t,r,o,n)}function AJ(e,t,[r,i,n],s,a){rst(e,t[r],t[i],t[n],t.scale,s,a)}const ist=["x","scaleX","originX"],nst=["y","scaleY","originY"];function CJ(e,t,r,i){AJ(e.x,t,ist,r?r.x:void 0,i?i.x:void 0),AJ(e.y,t,nst,r?r.y:void 0,i?i.y:void 0)}function TJ(e){return e.translate===0&&e.scale===1}function qhe(e){return TJ(e.x)&&TJ(e.y)}function MJ(e,t){return e.min===t.min&&e.max===t.max}function sst(e,t){return MJ(e.x,t.x)&&MJ(e.y,t.y)}function PJ(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Yhe(e,t){return PJ(e.x,t.x)&&PJ(e.y,t.y)}function DJ(e){return lo(e.x)/lo(e.y)}function NJ(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class ast{constructor(){this.members=[]}add(t){mV(this.members,t),t.scheduleRender()}remove(t){if(gV(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let i;for(let n=r;n>=0;n--){const s=this.members[n];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(t,r){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,r&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:i}=t;r.onExitComplete&&r.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ost(e,t,r){let i="";const n=e.x.translate/t.x,s=e.y.translate/t.y,a=r?.z||0;if((n||s||a)&&(i=`translate3d(${n}px, ${s}px, ${a}px) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:f,skewX:m,skewY:v}=r;c&&(i=`perspective(${c}px) ${i}`),u&&(i+=`rotate(${u}deg) `),d&&(i+=`rotateX(${d}deg) `),f&&(i+=`rotateY(${f}deg) `),m&&(i+=`skewX(${m}deg) `),v&&(i+=`skewY(${v}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(i+=`scale(${o}, ${l})`),i||"none"}const pO=["","X","Y","Z"],lst=1e3;let cst=0;function mO(e,t,r,i){const{latestValues:n}=t;n[e]&&(r[e]=n[e],t.setStaticValue(e,0),i&&(i[e]=0))}function Xhe(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=Ihe(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:n,layoutId:s}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Si,!(n||s))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&Xhe(i)}function $he({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:i,resetTransform:n}){return class{constructor(a={},o=t?.()){this.id=cst++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(hst),this.nodes.forEach(gst),this.nodes.forEach(vst),this.nodes.forEach(fst)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Knt)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new yV),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=zV(a)&&!Zrt(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let u,d=0;const f=()=>this.root.updateBlockedByResize=!1;Si.read(()=>{d=window.innerWidth}),e(a,()=>{const m=window.innerWidth;m!==d&&(d=m,this.root.updateBlockedByResize=!0,u&&u(),u=Qnt(f,250),LT.hasAnimatedSinceResize&&(LT.hasAnimatedSinceResize=!1,this.nodes.forEach(IJ)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:f,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||c.getDefaultTransition()||_st,{onLayoutAnimationStart:y,onLayoutAnimationComplete:x}=c.getProps(),w=!this.targetLayout||!Yhe(this.targetLayout,m),_=!d&&f;if(this.options.layoutRoot||this.resumeFrom||_||d&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const S={...kV(v,"layout"),onPlay:y,onComplete:x};(c.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S),this.setAnimationOrigin(u,_)}else d||IJ(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Uc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(yst),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Xhe(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(kJ);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(RJ);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(mst),this.nodes.forEach(ust),this.nodes.forEach(dst)):this.nodes.forEach(RJ),this.clearAllSnapshots();const o=Do.now();Fs.delta=od(0,1e3/60,o-Fs.timestamp),Fs.timestamp=o,Fs.isProcessing=!0,nO.update.process(Fs),nO.preRender.process(Fs),nO.render.process(Fs),Fs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,jV.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(pst),this.sharedNodes.forEach(xst)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Si.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Si.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!lo(this.snapshot.measuredBox.x)&&!lo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=zn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=i(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!n)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!qhe(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||eg(this.latestValues)||u)&&(n(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),Sst(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return zn();const o=a.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(Est))){const{scroll:c}=this.root;c&&(Ay(o.x,c.offset.x),Ay(o.y,c.offset.y))}return o}removeElementScroll(a){const o=zn();if(Pl(o,a),this.scroll?.wasRoot)return o;for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:d}=c;c!==this.root&&u&&d.layoutScroll&&(u.wasRoot&&Pl(o,a),Ay(o.x,u.offset.x),Ay(o.y,u.offset.y))}return o}applyTransform(a,o=!1){const l=zn();Pl(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Cy(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),eg(u.latestValues)&&Cy(l,u.latestValues)}return eg(this.latestValues)&&Cy(l,this.latestValues),l}removeTransform(a){const o=zn();Pl(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!eg(c.latestValues))continue;Az(c.latestValues)&&c.updateSnapshot();const u=zn(),d=c.measurePageBox();Pl(u,d),CJ(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return eg(this.latestValues)&&CJ(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Fs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=Fs.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=zn(),this.relativeTargetOrigin=zn(),v2(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),Pl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=zn(),this.targetWithTransforms=zn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Dnt(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Pl(this.target,this.layout.layoutBox),Mhe(this.target,this.targetDelta)):Pl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=zn(),this.relativeTargetOrigin=zn(),v2(this.relativeTargetOrigin,this.target,f.target),Pl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Az(this.parent.latestValues)||The(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Fs.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Pl(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;Vit(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=zn());const{target:m}=a;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(SJ(this.prevProjectionDelta.x,this.projectionDelta.x),SJ(this.prevProjectionDelta.y,this.projectionDelta.y)),g2(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!NJ(this.projectionDelta.x,this.prevProjectionDelta.x)||!NJ(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.visualElement?.scheduleRender(),a){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ty(),this.projectionDelta=Ty(),this.projectionDeltaWithTransform=Ty()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=Ty();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const f=zn(),m=l?l.source:void 0,v=this.layout?this.layout.source:void 0,y=m!==v,x=this.getStack(),w=!x||x.members.length<=1,_=!!(y&&!w&&this.options.crossfade===!0&&!this.path.some(wst));this.animationProgress=0;let S;this.mixTargetDelta=P=>{const M=P/1e3;OJ(d.x,a.x,M),OJ(d.y,a.y,M),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(v2(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),bst(this.relativeTarget,this.relativeTargetOrigin,f,M),S&&sst(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=zn()),Pl(S,this.relativeTarget)),y&&(this.animationValues=u,Jnt(u,c,this.latestValues,M,_,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=M},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Uc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Si.update(()=>{LT.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Pc(0)),this.currentAnimation=Xnt(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(lst),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&Khe(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||zn();const d=lo(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const f=lo(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+f}Pl(o,l),Cy(o,u),g2(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new ast),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){const{layoutId:a}=this.options;return a?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:a}=this.options;return a?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&mO("z",a,c,this.animationValues);for(let u=0;u<pO.length;u++)mO(`rotate${pO[u]}`,a,c,this.animationValues),mO(`skew${pO[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}applyProjectionStyles(a,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=jT(o?.pointerEvents)||"",a.transform=l?l(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=jT(o?.pointerEvents)||""),this.hasProjected&&!eg(this.latestValues)&&(a.transform=l?l({},""):"none",this.hasProjected=!1);return}a.visibility="";const u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let d=ost(this.projectionDeltaWithTransform,this.treeScale,u);l&&(d=l(u,d)),a.transform=d;const{x:f,y:m}=this.projectionDelta;a.transformOrigin=`${f.origin*100}% ${m.origin*100}% 0`,c.animationValues?a.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:a.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const v in c_){if(u[v]===void 0)continue;const{correct:y,applyTo:x,isCSSVariable:w}=c_[v],_=d==="none"?u[v]:y(u[v],c);if(x){const S=x.length;for(let P=0;P<S;P++)a[x[P]]=_}else w?this.options.visualElement.renderState.vars[v]=_:a[v]=_}this.options.layoutId&&(a.pointerEvents=c===this?jT(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>a.currentAnimation?.stop()),this.root.nodes.forEach(kJ),this.root.sharedNodes.clear()}}}function ust(e){e.updateLayout()}function dst(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=e.layout,{animationType:n}=e.options,s=t.source!==e.layout.source;n==="size"?Dl(u=>{const d=s?t.measuredBox[u]:t.layoutBox[u],f=lo(d);d.min=r[u].min,d.max=d.min+f}):Khe(n,t.layoutBox,r)&&Dl(u=>{const d=s?t.measuredBox[u]:t.layoutBox[u],f=lo(r[u]);d.max=d.min+f,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[u].max=e.relativeTarget[u].min+f)});const a=Ty();g2(a,r,t.layoutBox);const o=Ty();s?g2(o,e.applyTransform(i,!0),t.measuredBox):g2(o,r,t.layoutBox);const l=!qhe(a);let c=!1;if(!e.resumeFrom){const u=e.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:d,layout:f}=u;if(d&&f){const m=zn();v2(m,t.layoutBox,d.layoutBox);const v=zn();v2(v,r,f.layoutBox),Yhe(m,v)||(c=!0),u.options.layoutRoot&&(e.relativeTarget=v,e.relativeTargetOrigin=m,e.relativeParent=u)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:a,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function hst(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function fst(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function pst(e){e.clearSnapshot()}function kJ(e){e.clearMeasurements()}function RJ(e){e.isLayoutDirty=!1}function mst(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function IJ(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function gst(e){e.resolveTargetDelta()}function vst(e){e.calcProjection()}function yst(e){e.resetSkewAndRotation()}function xst(e){e.removeLeadSnapshot()}function OJ(e,t,r){e.translate=vn(t.translate,0,r),e.scale=vn(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function jJ(e,t,r,i){e.min=vn(t.min,r.min,i),e.max=vn(t.max,r.max,i)}function bst(e,t,r,i){jJ(e.x,t.x,r.x,i),jJ(e.y,t.y,r.y,i)}function wst(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const _st={duration:.45,ease:[.4,0,.1,1]},LJ=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),zJ=LJ("applewebkit/")&&!LJ("chrome/")?Math.round:Io;function BJ(e){e.min=zJ(e.min),e.max=zJ(e.max)}function Sst(e){BJ(e.x),BJ(e.y)}function Khe(e,t,r){return e==="position"||e==="preserve-aspect"&&!Pnt(DJ(t),DJ(r),.2)}function Est(e){return e!==e.root&&e.scroll?.wasRoot}const Ast=$he({attachResizeListener:(e,t)=>d_(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),gO={current:void 0},Qhe=$he({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!gO.current){const e=new Ast({});e.mount(window),e.setOptions({layoutScroll:!0}),gO.current=e}return gO.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Cst={pan:{Feature:Gnt},drag:{Feature:Hnt,ProjectionNode:Qhe,MeasureLayout:Hhe}};function FJ(e,t,r){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover",r==="Start");const n="onHover"+r,s=i[n];s&&Si.postRender(()=>s(t,uS(t)))}class Tst extends nm{mount(){const{current:t}=this.node;t&&(this.unmount=zrt(t,(r,i)=>(FJ(this.node,i,"Start"),n=>FJ(this.node,n,"End"))))}unmount(){}}class Mst extends nm{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=aS(d_(this.node.current,"focus",()=>this.onFocus()),d_(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function VJ(e,t,r){const{props:i}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap",r==="Start");const n="onTap"+(r==="End"?"":r),s=i[n];s&&Si.postRender(()=>s(t,uS(t)))}class Pst extends nm{mount(){const{current:t}=this.node;t&&(this.unmount=Urt(t,(r,i)=>(VJ(this.node,i,"Start"),(n,{success:s})=>VJ(this.node,n,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const kz=new WeakMap,vO=new WeakMap,Dst=e=>{const t=kz.get(e.target);t&&t(e)},Nst=e=>{e.forEach(Dst)};function kst({root:e,...t}){const r=e||document;vO.has(r)||vO.set(r,{});const i=vO.get(r),n=JSON.stringify(t);return i[n]||(i[n]=new IntersectionObserver(Nst,{root:e,...t})),i[n]}function Rst(e,t,r){const i=kst(t);return kz.set(e,r),i.observe(e),()=>{kz.delete(e),i.unobserve(e)}}const Ist={some:0,all:1};class Ost extends nm{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:i,amount:n="some",once:s}=t,a={root:r?r.current:void 0,rootMargin:i,threshold:typeof n=="number"?n:Ist[n]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),f=c?u:d;f&&f(l)};return Rst(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(jst(t,r))&&this.startObserver()}unmount(){}}function jst({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const Lst={inView:{Feature:Ost},tap:{Feature:Pst},focus:{Feature:Mst},hover:{Feature:Tst}},zst={layout:{ProjectionNode:Qhe,MeasureLayout:Hhe}},Bst={...Snt,...Lst,...Cst,...zst},Et=zit(Bst,Qit);function Fst(e,t,r){O.useInsertionEffect(()=>e.on(t,r),[e,t,r])}const Vst=50,UJ=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),Ust=()=>({time:0,x:UJ(),y:UJ()}),Hst={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function HJ(e,t,r,i){const n=r[t],{length:s,position:a}=Hst[t],o=n.current,l=r.time;n.current=e[`scroll${a}`],n.scrollLength=e[`scroll${s}`]-e[`client${s}`],n.offset.length=0,n.offset[0]=0,n.offset[1]=n.scrollLength,n.progress=kx(0,n.scrollLength,n.current);const c=i-l;n.velocity=c>Vst?0:xV(n.current-o,c)}function Gst(e,t,r){HJ(e,"x",t,r),HJ(e,"y",t,r),t.time=r}function Wst(e,t){const r={x:0,y:0};let i=e;for(;i&&i!==t;)if(OV(i))r.x+=i.offsetLeft,r.y+=i.offsetTop,i=i.offsetParent;else if(i.tagName==="svg"){const n=i.getBoundingClientRect();i=i.parentElement;const s=i.getBoundingClientRect();r.x+=n.left-s.left,r.y+=n.top-s.top}else if(i instanceof SVGGraphicsElement){const{x:n,y:s}=i.getBBox();r.x+=n,r.y+=s;let a=null,o=i.parentNode;for(;!a;)o.tagName==="svg"&&(a=o),o=i.parentNode;i=a}else break;return r}const Rz={start:0,center:.5,end:1};function GJ(e,t,r=0){let i=0;if(e in Rz&&(e=Rz[e]),typeof e=="string"){const n=parseFloat(e);e.endsWith("px")?i=n:e.endsWith("%")?e=n/100:e.endsWith("vw")?i=n/100*document.documentElement.clientWidth:e.endsWith("vh")?i=n/100*document.documentElement.clientHeight:e=n}return typeof e=="number"&&(i=t*e),r+i}const qst=[0,0];function Yst(e,t,r,i){let n=Array.isArray(e)?e:qst,s=0,a=0;return typeof e=="number"?n=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?n=e.split(" "):n=[e,Rz[e]?e:"0"]),s=GJ(n[0],r,i),a=GJ(n[1],t),s-a}const Xst={All:[[0,0],[1,1]]},$st={x:0,y:0};function Kst(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function Qst(e,t,r){const{offset:i=Xst.All}=r,{target:n=e,axis:s="y"}=r,a=s==="y"?"height":"width",o=n!==e?Wst(n,e):$st,l=n===e?{width:e.scrollWidth,height:e.scrollHeight}:Kst(n),c={width:e.clientWidth,height:e.clientHeight};t[s].offset.length=0;let u=!t[s].interpolate;const d=i.length;for(let f=0;f<d;f++){const m=Yst(i[f],c[a],l[a],o[s]);!u&&m!==t[s].interpolatorOffsets[f]&&(u=!0),t[s].offset[f]=m}u&&(t[s].interpolate=MV(t[s].offset,Wde(i),{clamp:!1}),t[s].interpolatorOffsets=[...t[s].offset]),t[s].progress=od(0,1,t[s].interpolate(t[s].current))}function Zst(e,t=e,r){if(r.x.targetOffset=0,r.y.targetOffset=0,t!==e){let i=t;for(;i&&i!==e;)r.x.targetOffset+=i.offsetLeft,r.y.targetOffset+=i.offsetTop,i=i.offsetParent}r.x.targetLength=t===e?t.scrollWidth:t.clientWidth,r.y.targetLength=t===e?t.scrollHeight:t.clientHeight,r.x.containerLength=e.clientWidth,r.y.containerLength=e.clientHeight}function Jst(e,t,r,i={}){return{measure:n=>{Zst(e,i.target,r),Gst(e,r,n),(i.offset||i.target)&&Qst(e,r,i)},notify:()=>t(r)}}const sw=new WeakMap,WJ=new WeakMap,yO=new WeakMap,qJ=e=>e===document.scrollingElement?window:e;function Zhe(e,{container:t=document.scrollingElement,...r}={}){if(!t)return Io;let i=yO.get(t);i||(i=new Set,yO.set(t,i));const n=Ust(),s=Jst(t,e,n,r);if(i.add(s),!sw.has(t)){const o=()=>{for(const d of i)d.measure(Fs.timestamp);Si.preUpdate(l)},l=()=>{for(const d of i)d.notify()},c=()=>Si.read(o);sw.set(t,c);const u=qJ(t);window.addEventListener("resize",c,{passive:!0}),t!==document.documentElement&&WJ.set(t,Qrt(t,c)),u.addEventListener("scroll",c,{passive:!0}),c()}const a=sw.get(t);return Si.read(a,!1,!0),()=>{Uc(a);const o=yO.get(t);if(!o||(o.delete(s),o.size))return;const l=sw.get(t);sw.delete(t),l&&(qJ(t).removeEventListener("scroll",l),WJ.get(t)?.(),window.removeEventListener("resize",l))}}const YJ=new Map;function eat(e){const t={value:0},r=Zhe(i=>{t.value=i[e.axis].progress*100},e);return{currentTime:t,cancel:r}}function Jhe({source:e,container:t,...r}){const{axis:i}=r;e&&(t=e);const n=YJ.get(t)??new Map;YJ.set(t,n);const s=r.target??"self",a=n.get(s)??{},o=i+(r.offset??[]).join(",");return a[o]||(a[o]=!r.target&&$de()?new ScrollTimeline({source:t,axis:i}):eat({container:t,...r})),a[o]}function tat(e,t){const r=Jhe(t);return e.attachTimeline({timeline:t.target?void 0:r,observe:i=>(i.pause(),dhe(n=>{i.time=i.duration*n},r))})}function rat(e){return e.length===2}function iat(e,t){return rat(e)?Zhe(r=>{e(r[t.axis].progress,r)},t):dhe(e,Jhe(t))}function nat(e,{axis:t="y",container:r=document.scrollingElement,...i}={}){if(!r)return Io;const n={axis:t,container:r,...i};return typeof e=="function"?iat(e,n):tat(e,n)}const sat=()=>({scrollX:Pc(0),scrollY:Pc(0),scrollXProgress:Pc(0),scrollYProgress:Pc(0)}),CC=e=>e?!e.current:!1;function aat({container:e,target:t,...r}={}){const i=pb(sat),n=O.useRef(null),s=O.useRef(!1),a=O.useCallback(()=>(n.current=nat((o,{x:l,y:c})=>{i.scrollX.set(l.current),i.scrollXProgress.set(l.progress),i.scrollY.set(c.current),i.scrollYProgress.set(c.progress)},{...r,container:e?.current||void 0,target:t?.current||void 0}),()=>{n.current?.()}),[e,t,JSON.stringify(r.offset)]);return TD(()=>{if(s.current=!1,CC(e)||CC(t)){s.current=!0;return}else return a()},[a]),O.useEffect(()=>{if(s.current)return s_(!CC(e)),s_(!CC(t)),a()},[a]),i}function XV(e){const t=pb(()=>Pc(e)),{isStatic:r}=O.useContext(cS);if(r){const[,i]=O.useState(e);O.useEffect(()=>t.on("change",i),[])}return t}function efe(e,t){const r=XV(t()),i=()=>r.set(t());return i(),TD(()=>{const n=()=>Si.preRender(i,!1,!0),s=e.map(a=>a.on("change",n));return()=>{s.forEach(a=>a()),Uc(i)}}),r}function oat(e){p2.current=[],e();const t=efe(p2.current,e);return p2.current=void 0,t}function lat(e,t,r,i){if(typeof e=="function")return oat(e);const n=Jrt(t,r,i);return Array.isArray(e)?XJ(e,n):XJ([e],([s])=>n(s))}function XJ(e,t){const r=pb(()=>[]);return efe(e,()=>{r.length=0;const i=e.length;for(let n=0;n<i;n++)r[n]=e[n].get();return t(r)})}function cat(e,t={}){const{isStatic:r}=O.useContext(cS),i=()=>Ks(e)?e.get():e;if(r)return lat(i);const n=XV(i());return O.useInsertionEffect(()=>eit(n,e,t),[n,JSON.stringify(t)]),n}const uat={some:0,all:1};function dat(e,t,{root:r,margin:i,amount:n="some"}={}){const s=IV(e),a=new WeakMap,o=c=>{c.forEach(u=>{const d=a.get(u.target);if(u.isIntersecting!==!!d)if(u.isIntersecting){const f=t(u.target,u);typeof f=="function"?a.set(u.target,f):l.unobserve(u.target)}else typeof d=="function"&&(d(u),a.delete(u.target))})},l=new IntersectionObserver(o,{root:r,rootMargin:i,threshold:typeof n=="number"?n:uat[n]});return s.forEach(c=>l.observe(c)),()=>l.disconnect()}function hat(e,{root:t,margin:r,amount:i,once:n=!1,initial:s=!1}={}){const[a,o]=O.useState(s);return O.useEffect(()=>{if(!e.current||n&&a)return;const l=()=>(o(!0),n?void 0:()=>o(!1)),c={root:t&&t.current||void 0,margin:r,amount:i};return dat(e.current,l,c)},[t,e,r,n,i]),a}/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fat=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),pat=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,i)=>i?i.toUpperCase():r.toLowerCase()),$J=e=>{const t=pat(e);return t.charAt(0).toUpperCase()+t.slice(1)},tfe=(...e)=>e.filter((t,r,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===r).join(" ").trim(),mat=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var gat={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vat=O.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:n="",children:s,iconNode:a,...o},l)=>O.createElement("svg",{ref:l,...gat,width:t,height:t,stroke:e,strokeWidth:i?Number(r)*24/Number(t):r,className:tfe("lucide",n),...!s&&!mat(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,u])=>O.createElement(c,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=(e,t)=>{const r=O.forwardRef(({className:i,...n},s)=>O.createElement(vat,{ref:s,iconNode:t,className:tfe(`lucide-${fat($J(e))}`,`lucide-${e}`,i),...n}));return r.displayName=$J(e),r};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yat=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],rfe=vt("arrow-left",yat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xat=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],KJ=vt("arrow-right",xat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bat=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Iz=vt("award",bat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wat=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],$V=vt("book-open",wat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _at=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]],Sat=vt("book-text",_at);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eat=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],RD=vt("bot",Eat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aat=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Dp=vt("calendar",Aat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cat=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],sm=vt("check",Cat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tat=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],KV=vt("chevron-down",Tat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mat=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ife=vt("chevron-left",Mat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pat=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ky=vt("chevron-right",Pat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dat=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Nat=vt("chevron-up",Dat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kat=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Dh=vt("circle-alert",kat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rat=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Sh=vt("circle-check-big",Rat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iat=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ka=vt("circle-check",Iat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oat=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],jat=vt("circle-question-mark",Oat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lat=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],n0=vt("circle-x",Lat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zat=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Oz=vt("circle",zat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bat=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],Fat=vt("clipboard-check",Bat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vat=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],Uat=vt("clipboard",Vat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hat=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Rc=vt("clock",Hat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gat=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],nfe=vt("cloud-upload",Gat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wat=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],qat=vt("code-xml",Wat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yat=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],sl=vt("code",Yat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xat=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ID=vt("copy",Xat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $at=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Kat=vt("crown",$at);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qat=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Zat=vt("download",Qat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jat=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],QV=vt("eye-off",Jat);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eot=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Qu=vt("eye",eot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tot=[["polygon",{points:"13 19 22 12 13 5 13 19",key:"587y9g"}],["polygon",{points:"2 19 11 12 2 5 2 19",key:"3pweh0"}]],rot=vt("fast-forward",tot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iot=[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]],jz=vt("file-code",iot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const not=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],Lz=vt("file-json",not);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sot=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],zz=vt("file-text",sot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aot=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],oot=vt("flask-conical",aot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lot=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],xO=vt("funnel",lot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cot=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],OD=vt("grid-3x3",cot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uot=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],dot=vt("hard-drive",uot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hot=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],fot=vt("history",hot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pot=[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]],mot=vt("hourglass",pot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const got=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],vot=vt("lightbulb",got);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yot=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Eh=vt("list",yot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xot=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],HP=vt("loader-circle",xot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bot=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],wot=vt("log-in",bot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ot=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],GP=vt("lock",_ot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sot=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],Eot=vt("maximize",Sot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aot=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],Cot=vt("medal",Aot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tot=[["path",{d:"M6 19v-3",key:"1nvgqn"}],["path",{d:"M10 19v-3",key:"iu8nkm"}],["path",{d:"M14 19v-3",key:"kcehxu"}],["path",{d:"M18 19v-3",key:"1vh91z"}],["path",{d:"M8 11V9",key:"63erz4"}],["path",{d:"M16 11V9",key:"fru6f3"}],["path",{d:"M12 11V9",key:"ha00sb"}],["path",{d:"M2 15h20",key:"16ne18"}],["path",{d:"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1a2 2 0 0 0 0 3.837V17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-5.1a2 2 0 0 0 0-3.837Z",key:"lhddv3"}]],Mot=vt("memory-stick",Tot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pot=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Dot=vt("menu",Pot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Not=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],kot=vt("message-square",Not);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rot=[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],QJ=vt("mic-off",Rot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iot=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],Bz=vt("mic",Iot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oot=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],jot=vt("minimize",Oot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lot=[["path",{d:"M5 12h14",key:"1ays0h"}]],zot=vt("minus",Lot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bot=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],sfe=vt("moon",Bot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fot=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],Vot=vt("pause",Fot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uot=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ZJ=vt("pen",Uot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hot=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],jD=vt("play",Hot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Got=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Hl=vt("plus",Got);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wot=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],afe=vt("puzzle",Wot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qot=[["polygon",{points:"11 19 2 12 11 5 11 19",key:"14yba5"}],["polygon",{points:"22 19 13 12 22 5 22 19",key:"1pi1cj"}]],Yot=vt("rewind",qot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xot=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],$ot=vt("rotate-ccw",Xot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kot=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Qot=vt("save",Kot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zot=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Wh=vt("search",Zot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jot=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ofe=vt("send",Jot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const elt=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],tlt=vt("settings",elt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rlt=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],ZV=vt("shield-alert",rlt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ilt=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],JV=vt("shield-check",ilt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nlt=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Fz=vt("shield",nlt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const slt=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],lfe=vt("shuffle",slt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const alt=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],dS=vt("sparkles",alt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const olt=[["path",{d:"m10 9-3 3 3 3",key:"1oro0q"}],["path",{d:"m14 15 3-3-3-3",key:"bz13h7"}],["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}]],llt=vt("square-code",olt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const clt=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Vz=vt("square-pen",clt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ult=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],WP=vt("star",ult);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dlt=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],cfe=vt("sun",dlt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hlt=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],zT=vt("tag",hlt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const flt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],JJ=vt("target",flt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const plt=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]],eU=vt("test-tube",plt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mlt=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Lg=vt("timer",mlt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const glt=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ic=vt("trash-2",glt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vlt=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Uz=vt("trending-up",vlt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ylt=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],qP=vt("triangle-alert",ylt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xlt=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],qh=vt("trophy",xlt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const blt=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Hz=vt("user-check",blt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wlt=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ufe=vt("user",wlt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _lt=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Zu=vt("users",_lt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Slt=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Elt=vt("video",Slt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Alt=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],tU=vt("volume-2",Alt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Clt=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],dfe=vt("volume-x",Clt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tlt=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Dc=vt("x",Tlt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mlt=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],YP=vt("zap",Mlt);function Plt({theme:e,toggleTheme:t}){return h.jsx("button",{onClick:t,className:"relative z-50 flex items-center gap-2 rounded-lg bg-gray-200 px-3 py-2 text-black shadow-md transition-transform hover:scale-105 dark:bg-zinc-700 dark:text-white","aria-label":"Toggle theme",children:h.jsx(ya,{mode:"wait",children:h.jsx(Et.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:20,opacity:0},transition:{duration:.2},children:e==="dark"?h.jsx(cfe,{size:20}):h.jsx(sfe,{size:20})},e)})})}function Dlt(e){return wn({attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M16 9C16 11.2091 14.2091 13 12 13C9.79086 13 8 11.2091 8 9C8 6.79086 9.79086 5 12 5C14.2091 5 16 6.79086 16 9ZM14 9C14 10.1046 13.1046 11 12 11C10.8954 11 10 10.1046 10 9C10 7.89543 10.8954 7 12 7C13.1046 7 14 7.89543 14 9Z",fill:"currentColor"},child:[]},{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M12 1C5.92487 1 1 5.92487 1 12C1 18.0751 5.92487 23 12 23C18.0751 23 23 18.0751 23 12C23 5.92487 18.0751 1 12 1ZM3 12C3 14.0902 3.71255 16.014 4.90798 17.5417C6.55245 15.3889 9.14627 14 12.0645 14C14.9448 14 17.5092 15.3531 19.1565 17.4583C20.313 15.9443 21 14.0524 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12ZM12 21C9.84977 21 7.87565 20.2459 6.32767 18.9878C7.59352 17.1812 9.69106 16 12.0645 16C14.4084 16 16.4833 17.1521 17.7538 18.9209C16.1939 20.2191 14.1881 21 12 21Z",fill:"currentColor"},child:[]}]})(e)}function hfe(e){return wn({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M304 336v40a40 40 0 0 1-40 40H104a40 40 0 0 1-40-40V136a40 40 0 0 1 40-40h152c22.09 0 48 17.91 48 40v40m64 160 80-80-80-80m-192 80h256"},child:[]}]})(e)}function ffe({user:e,onLogoutClick:t,onDeleteAccountClick:r}){if(!e)return null;const i=`https://ui-avatars.com/api/?name=${e.first_name}&background=random`;return h.jsxs("div",{className:"dropdown dropdown-end",children:[h.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar",children:h.jsx("div",{className:"w-10 rounded-full",children:h.jsx("img",{src:e.profile_pic_url||i,alt:`${e.first_name}'s profile`,onError:n=>{n.currentTarget.src=i}})})}),h.jsxs("ul",{tabIndex:0,className:"menu menu-sm dropdown-content z-[1000] mt-3 w-56 rounded-box bg-base-200 p-2 shadow-xl focus:outline-none",children:[h.jsx("li",{className:"menu-title px-4 pt-2 pb-1 text-sm",children:h.jsxs("span",{children:["Hi, ",e.first_name,"!"]})}),h.jsx("li",{children:h.jsxs(hr,{to:"/profile",className:"p-3",children:[h.jsx(Dlt,{className:"h-4 w-4"}),"Profile"]})}),h.jsx("li",{children:e.setpassword?h.jsxs(hr,{to:"/settings/change-password",className:"p-3",children:[h.jsx(ZK,{className:"h-4 w-4"}),"Change Password"]}):h.jsxs(hr,{to:"/settings/set-password",className:"p-3",children:[h.jsx(ZK,{className:"h-4 w-4"}),"Set Password"]})}),h.jsx("li",{children:h.jsxs("button",{onClick:t,className:"p-3 w-full flex items-center gap-2",children:[h.jsx(hfe,{className:"h-4 w-4"}),"Logout"]})}),h.jsx("li",{className:"px-4",children:h.jsx("div",{className:"divider my-1 h-px bg-base-content/20"})}),h.jsx("li",{children:h.jsxs("button",{onClick:r,className:"p-3 text-error w-full flex items-center gap-2",children:[h.jsx(HYe,{className:"h-4 w-4"}),"Delete Account"]})})]})]})}const Nlt=({to:e,children:t})=>{const i=dd().pathname===e;return h.jsxs(hr,{to:e,className:`relative rounded-md px-3 py-2 text-sm font-medium transition-colors duration-200 ${i?"text-gray-900 dark:text-white":"text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white"}`,children:[t,i&&h.jsx("span",{className:"absolute bottom-0 left-1/2 h-0.5 w-4 -translate-x-1/2 rounded-full bg-blue-500"})]})};function pfe({theme:e,toggleTheme:t}){const{is_authenticated:r,user:i}=ho(E=>E.auth),n=g3(),s=fs(),[a,o]=O.useState(!1),[l,c]=O.useState(!1),[u,d]=O.useState(!1),[f,m]=O.useState(!1),[v,y]=O.useState(!1),{scrollY:x}=aat();O.useEffect(()=>{Hn.init({once:!0,duration:800});const E=()=>{const N=window.scrollY;m(N>10)};return window.addEventListener("scroll",E),()=>window.removeEventListener("scroll",E)},[]),Fst(x,"change",E=>{const N=x.getPrevious();E>N&&E>150?y(!0):y(!1)});const w=()=>{n(eT()).unwrap().then(()=>{n(Dy()),s("/")}).catch(E=>console.error("Logout failed",E))},_=()=>{n(tT()).unwrap().then(()=>{n(Dy()),s("/")}).catch(E=>console.error("Delete failed",E)),c(!1)},S=[{href:"/problems",text:"Problems"},{href:"/contest",text:"Contest"},{href:"/pair-mode",text:"Collab"},{href:"/discussion",text:"Discuss"},{href:"/tscassistant",text:"TSC Assistant"},{href:"/problem/potd",text:"POTD"}],P=({to:E,children:N})=>h.jsx(Et.div,{className:"relative group",whileHover:{scale:1.05},whileTap:{scale:.95},children:h.jsxs(hr,{to:E,className:"relative px-3 py-2 text-sm font-medium text-gray-700 dark:text-white/90 transition-all duration-300 hover:text-gray-900 dark:hover:text-white",children:[N,h.jsx(Et.div,{className:"absolute bottom-0 left-0 h-0.5 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500",initial:{width:0},whileHover:{width:"100%"},transition:{duration:.3,ease:"easeInOut"}}),h.jsx(Et.div,{className:"absolute inset-0 rounded-lg bg-gradient-to-r from-blue-500/10 via-purple-500/10 to-pink-500/10 opacity-0",whileHover:{opacity:1},transition:{duration:.3}})]})}),M=()=>h.jsx(Et.span,{className:"font-bold bg-gradient-to-r from-[#6b10e2e8] via-[#a310e2d7] to-[#e210ded7] dark:bg-gradient-to-r dark:from-[#10e2d4d7] dark:via-[#10b4e2d7] dark:to-[#106be2d7] bg-clip-text text-transparent",animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:3,repeat:1/0,ease:"linear"},style:{backgroundSize:"200% 200%"},children:"CodeG"}),C={hover:{scale:1.05,y:-2,boxShadow:"0 10px 25px rgba(0,0,0,0.1)",transition:{duration:.2}},tap:{scale:.95}},T="h-16";return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:`${T} w-full`})," ",h.jsx(Et.header,{"data-aos":"fade-down",variants:{visible:{y:0},hidden:{y:"-100%"}},animate:v?"hidden":"visible",transition:{duration:.35,ease:"easeInOut"},className:`fixed top-0 w-full z-50 transition-all duration-500 ${T} ${f?"border-b border-gray-200/20 bg-white/70 shadow-lg backdrop-blur-xl dark:border-gray-800/20 dark:bg-gray-900/70":"bg-transparent"}`,children:h.jsxs("nav",{className:"container mx-auto max-w-[85%] flex h-full items-center justify-between px-4",children:[h.jsx(Et.div,{className:"flex-shrink-0",whileHover:{scale:1.05},whileTap:{scale:.95},children:h.jsxs(hr,{to:"/",className:"flex items-center gap-2 text-2xl font-bold text-base-content group",children:[h.jsx(Et.img,{src:nD,className:"w-9 h-9",alt:"CodeG Logo",whileHover:{rotate:360},transition:{duration:.6,ease:"easeInOut"}}),h.jsx(M,{})]})}),h.jsx(Et.nav,{className:"hidden lg:flex flex-grow justify-center items-center",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6,staggerChildren:.1},children:S.map(E=>h.jsx(Et.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:E.index*.1},children:h.jsx(P,{to:E.href,children:E.text})},E.href))}),h.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[i?.role==="admin"&&h.jsx(Et.div,{className:"hidden sm:block",variants:C,whileHover:"hover",whileTap:"tap",children:h.jsx(hr,{to:"/admin",children:h.jsx("button",{className:"relative overflow-hidden rounded-lg border border-blue-500/30 bg-blue-50/80 dark:bg-blue-900/20 px-3 py-2 text-xs md:text-sm font-semibold text-blue-600 dark:text-blue-400 backdrop-blur-sm transition-all duration-300",children:h.jsx("span",{className:"relative z-10",children:"Admin"})})})}),h.jsx(Et.div,{className:"hidden sm:inline-block",variants:C,whileHover:"hover",whileTap:"tap",children:h.jsx(hr,{to:"/payment",children:h.jsx("button",{className:"relative overflow-hidden rounded-lg bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 px-3 py-2 text-xs md:text-sm font-semibold text-white shadow-lg transition-all duration-300",children:h.jsx("span",{className:"relative z-10",children:"Subscribe ✨"})})})}),h.jsx(Et.div,{whileHover:{scale:1.1},whileTap:{scale:.9},children:h.jsx(Plt,{theme:e,toggleTheme:t})}),r&&i?h.jsx(Et.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:h.jsx(ffe,{user:i,onLogoutClick:()=>d(!0),onDeleteAccountClick:()=>c(!0)})}):h.jsxs("div",{className:"hidden lg:flex items-center space-x-2",children:[h.jsx(Et.div,{variants:C,whileHover:"hover",whileTap:"tap",children:h.jsx(hr,{to:"/login",children:h.jsx("button",{className:"rounded-lg px-4 py-2 text-sm font-semibold",children:"Log In"})})}),h.jsx(Et.div,{variants:C,whileHover:"hover",whileTap:"tap",children:h.jsx(hr,{to:"/signup",children:h.jsx("button",{className:"rounded-lg bg-gray-800 text-white dark:bg-white dark:text-black px-4 py-2 text-sm font-semibold",children:"Sign Up"})})})]}),h.jsx(Et.button,{onClick:()=>o(!a),className:"ml-2 lg:hidden p-2 rounded-lg hover:bg-gray-100/50 dark:hover:bg-gray-800/50 transition-colors","aria-label":"Toggle menu",whileHover:{scale:1.1},whileTap:{scale:.9},children:h.jsx(ya,{mode:"wait",children:a?h.jsx(Et.div,{initial:{rotate:-90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:90,opacity:0},transition:{duration:.2},children:h.jsx(Dc,{className:"h-6 w-6"})},"close"):h.jsx(Et.div,{initial:{rotate:90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:-90,opacity:0},transition:{duration:.2},children:h.jsx(Dot,{className:"h-6 w-6"})},"menu")})})]})]})}),h.jsx(ya,{children:a&&h.jsx(Et.div,{initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},transition:{duration:.3,ease:"easeOut"},className:"fixed inset-x-0 top-16 z-40 mx-4 origin-top rounded-xl bg-white/80 p-6 shadow-2xl backdrop-blur-xl dark:bg-gray-900/80 lg:hidden border border-gray-200/50 dark:border-gray-700/50",children:h.jsxs(Et.div,{className:"flex flex-col space-y-4",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.07}}},initial:"hidden",animate:"visible",children:[S.map(E=>h.jsx(Et.div,{variants:{hidden:{x:-20,opacity:0},visible:{x:0,opacity:1}},children:h.jsx(Nlt,{to:E.href,className:"block py-2 text-base font-medium",onClick:()=>o(!1),children:E.text})},E.href)),h.jsxs(Et.div,{className:"border-t border-gray-200/50 pt-4 dark:border-gray-700/50",variants:{hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},children:[!r&&h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx(hr,{to:"/login",className:"btn btn-outline btn-primary w-full",onClick:()=>o(!1),children:"Log In"}),h.jsx(hr,{to:"/signup",className:"btn btn-primary w-full",onClick:()=>o(!1),children:"Sign Up"})]}),h.jsx("div",{className:"mt-4 block sm:hidden",children:h.jsx(hr,{to:"/payment",children:h.jsx("button",{className:"btn btn-primary w-full",onClick:()=>o(!1),children:"Subscribe ✨"})})})]})]})})}),h.jsx(ya,{children:l&&h.jsx(Et.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:h.jsxs(Et.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",damping:25,stiffness:500},className:"modal-box relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl",children:[h.jsxs("div",{className:"text-center",children:[h.jsx(Et.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},children:h.jsx(zYe,{className:"mx-auto h-16 w-16 text-error"})}),h.jsx("h3",{className:"text-2xl font-bold mt-4",children:"Are you sure?"}),h.jsx("p",{className:"py-4 text-base-content/80",children:"This action cannot be undone. All of your data will be permanently deleted."})]}),h.jsxs("div",{className:"modal-action justify-center gap-4",children:[h.jsx(Et.button,{className:"btn btn-ghost w-32",onClick:()=>c(!1),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Cancel"}),h.jsx(Et.button,{className:"btn btn-error w-32",onClick:_,whileHover:{scale:1.05},whileTap:{scale:.95},children:"Delete"})]})]})})}),h.jsx(ya,{children:u&&h.jsx(Et.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:h.jsxs(Et.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",damping:25,stiffness:500},className:"modal-box relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl",children:[h.jsxs("div",{className:"text-center",children:[h.jsx(Et.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},children:h.jsx(hfe,{className:"mx-auto h-16 w-16 text-primary"})}),h.jsx("h3",{className:"text-2xl font-bold mt-4",children:"Log Out Confirmation"}),h.jsx("p",{className:"py-4 text-base-content/80",children:"Are you sure you want to log out? You will be returned to the homepage."})]}),h.jsxs("div",{className:"modal-action justify-center gap-4",children:[h.jsx(Et.button,{className:"btn btn-ghost w-32",onClick:()=>d(!1),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Cancel"}),h.jsx(Et.button,{className:"btn btn-primary w-32",onClick:w,whileHover:{scale:1.05},whileTap:{scale:.95},children:"Log Out"})]})]})})})]})}const klt=({animation:e,setAnimation:t,theme:r})=>h.jsx(ya,{children:e&&e.type==="circle"&&h.jsx(Et.div,{initial:{clipPath:e.clipPath.initial},animate:{clipPath:e.clipPath.animate},exit:{clipPath:e.clipPath.initial},transition:{duration:.7,ease:"easeInOut"},onAnimationComplete:()=>t(null),className:`pointer-events-none fixed inset-0 z-[9999] backdrop-blur-lg ${r==="dark"?"bg-white":"bg-zinc-900"}`},e.key)}),Rlt=e=>{const t=Math.hypot(Math.max(e.x,window.innerWidth-e.x),Math.max(e.y,window.innerHeight-e.y));return{initial:`circle(0px at ${e.x}px ${e.y}px)`,animate:`circle(${t}px at ${e.x}px ${e.y}px)`}};function Ilt(){const[e,t]=O.useState("dark"),[r,i]=O.useState(null);O.useEffect(()=>{const s=localStorage.getItem("theme")||"dark";t(s)},[]),O.useEffect(()=>{const s=document.documentElement;e==="dark"?s.classList.add("dark"):s.classList.remove("dark"),s.setAttribute("data-theme",e),localStorage.setItem("theme",e)},[e]);const n=s=>{const a=e==="dark"?"light":"dark",o=s.currentTarget.getBoundingClientRect(),l={x:o.left+o.width/2,y:o.top+o.height/2},c=Rlt(l);i({type:"circle",key:Date.now(),clipPath:c}),setTimeout(()=>{t(a)},300)};return h.jsxs(h.Fragment,{children:[h.jsx(pfe,{theme:e,toggleTheme:n}),h.jsx("main",{children:h.jsx(are,{})}),h.jsx(klt,{animation:r,setAnimation:i,theme:e})]})}function Olt({title:e,titleId:t,...r},i){return O.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?O.createElement("title",{id:t},e):null,O.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const jlt=O.forwardRef(Olt);function Llt({title:e,titleId:t,...r},i){return O.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?O.createElement("title",{id:t},e):null,O.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const mfe=O.forwardRef(Llt);function _c({to:e,from:t=0,direction:r="up",delay:i=0,duration:n=2,className:s="",startWhen:a=!0,separator:o="",onStart:l,onEnd:c}){const u=O.useRef(null),d=XV(r==="down"?e:t),f=20+40*(1/n),m=100*(1/n),v=cat(d,{damping:f,stiffness:m}),y=hat(u,{once:!0,margin:"0px"}),x=_=>{const S=_.toString();if(S.includes(".")){const P=S.split(".")[1];if(parseInt(P)!==0)return P.length}return 0},w=Math.max(x(t),x(e));return O.useEffect(()=>{u.current&&(u.current.textContent=String(r==="down"?e:t))},[t,e,r]),O.useEffect(()=>{if(y&&a){typeof l=="function"&&l();const _=setTimeout(()=>{d.set(r==="down"?t:e)},i*1e3),S=setTimeout(()=>{typeof c=="function"&&c()},i*1e3+n*1e3);return()=>{clearTimeout(_),clearTimeout(S)}}},[y,a,d,r,t,e,i,l,c,n]),O.useEffect(()=>{const _=v.on("change",S=>{if(u.current){const P=w>0,M={useGrouping:!!o,minimumFractionDigits:P?w:0,maximumFractionDigits:P?w:0},C=Intl.NumberFormat("en-US",M).format(S);u.current.textContent=o?C.replace(/,/g,o):C}});return()=>_()},[v,o,w]),h.jsx("span",{className:s,ref:u})}const yb=({message:e="Please login or sign up to access this feature."})=>h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsxs("div",{className:"max-w-md mx-auto rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-zinc-900 p-6 shadow-md text-center","data-aos":"zoom-in",children:[h.jsx("div",{className:"flex items-center justify-center mb-4",children:h.jsx(GP,{className:"h-8 w-8 text-blue-600 dark:text-white"})}),h.jsx("h2",{className:"text-xl font-semibold text-gray-800 dark:text-white mb-2",children:"Restricted Access"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:e}),h.jsxs("div",{className:"flex justify-center gap-3",children:[h.jsx(hr,{to:"/login",children:h.jsx("button",{className:"rounded-md bg-blue-600 text-white px-4 py-2 text-sm font-medium shadow hover:bg-blue-500 transition hover:scale-105",children:"Log In"})}),h.jsx(hr,{to:"/signup",children:h.jsx("button",{className:"rounded-md bg-gray-100 text-blue-600 px-4 py-2 text-sm font-medium shadow hover:bg-gray-200 transition hover:scale-105 dark:bg-white/10 dark:text-white dark:hover:bg-white/20",children:"Sign Up"})})]})]})]}),eee=e=>{switch(e?.toLowerCase()){case"easy":return"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300";case"medium":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300";case"hard":return"bg-rose-100 text-rose-800 dark:bg-rose-900/50 dark:text-rose-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}},zlt=()=>{const{user:e}=ho(Z=>Z.auth),t=fs(),[r,i]=O.useState([]),[n,s]=O.useState([]),[a,o]=O.useState(!0),[l,c]=O.useState(null),[u,d]=O.useState(""),[f,m]=O.useState("all"),[v,y]=O.useState("all"),[x,w]=O.useState("all"),[_,S]=O.useState([]),[P,M]=O.useState(!1),[C,T]=O.useState(null),[E,N]=O.useState(null),[D,I]=O.useState({show:!1,message:""}),[j,L]=O.useState([]),[B,q]=O.useState(!1),[G,Y]=O.useState(!1);O.useEffect(()=>{(async()=>{try{o(!0);const he=(await jt.get("/problem/getAllProblem")).data.problem||[];i(he);const Ae=new Set;he.forEach(xe=>{typeof xe.tags=="string"&&xe.tags.split(",").map(Ee=>Ee.trim()).forEach(Ee=>Ae.add(Ee))}),S(Array.from(Ae).sort())}catch(fe){c(fe.message||"Failed to fetch problems."),console.error(fe)}finally{o(!1)}})()},[]),O.useEffect(()=>{e&&re()},[e]);const X=()=>{q(!1),M(!0)},re=async()=>{try{Y(!0);const Z=await jt.get("/user/todo/get");console.log(Z.data),L(Z.data.todo||[])}catch(Z){console.error("Failed to fetch todo problems:",Z)}finally{Y(!1)}},F=async Z=>{N(Z);try{await jt.post("/user/todo/add",{problemId:Z}),re(),I({show:!0,message:"📝 Got it! The problem has been added to your To-Do list. Let's tackle it soon!"}),setTimeout(()=>{I({show:!1,message:""})},2e3)}catch(fe){console.error("Failed to add problem to todo:",fe),I({show:!0,message:"Error: Could not add problem."}),setTimeout(()=>{I({show:!1,message:""})},2e3)}finally{N(null)}},$=async Z=>{T(Z);try{await jt.delete("/user/todo/remove",{data:{problemId:Z}}),re(),I({show:!0,message:"Problem removed from your Todo list!"}),setTimeout(()=>{I({show:!1,message:""})},2e3)}catch(fe){console.error("Failed to remove problem from todo:",fe),I({show:!0,message:"Error: Could not remove problem."}),setTimeout(()=>{I({show:!1,message:""})},2e3)}finally{T(null)}},se=Z=>j.some(fe=>fe._id===Z);O.useEffect(()=>{let Z=r;if(u&&(Z=Z.filter(fe=>fe.title.toLowerCase().includes(u.toLowerCase()))),f!=="all"&&(Z=Z.filter(fe=>fe.difficulty?.toLowerCase()===f)),v!=="all"&&(Z=Z.filter(fe=>fe.tags&&fe.tags.split(",").map(he=>he.trim()).includes(v))),x!=="all"){const fe=new Set(e?.problem_solved||[]);Z=Z.filter(he=>{const Ae=fe.has(he._id);return x==="solved"?Ae:!Ae})}s(Z)},[u,f,v,x,r,e]);const H=Z=>{t(`/problems/${Z}`)},ne=()=>({total:r.length,easy:r.filter(Z=>Z.difficulty?.toLowerCase()==="easy").length,medium:r.filter(Z=>Z.difficulty?.toLowerCase()==="medium").length,hard:r.filter(Z=>Z.difficulty?.toLowerCase()==="hard").length,solved:e?.problem_solved?.length||0}),ce=()=>{d(""),m("all"),y("all"),w("all")};if(O.useEffect(()=>{Hn.init({duration:800,easing:"ease-out",once:!0,offset:20,disable:"mobile"})},[]),!e)return h.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-10",children:h.jsx(yb,{message:"You need to be logged in to view  challenge!"})});if(a)return h.jsx("div",{className:"min-h-screen bg-base-100 flex items-center justify-center",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"loading loading-spinner loading-lg text-primary mb-4"}),h.jsx("p",{className:"text-base-content font-medium",children:"Loading problems..."})]})});if(l)return h.jsx("div",{className:"min-h-screen bg-base-100 flex items-center justify-center p-4",children:h.jsx("div",{className:"card max-w-md w-full bg-base-100 shadow-xl border-error border-2",children:h.jsxs("div",{className:"card-body text-center",children:[h.jsx("div",{className:"w-16 h-16 bg-error/20 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(n0,{className:"w-8 h-8 text-error"})}),h.jsx("h3",{className:"card-title text-error justify-center mb-2",children:"Error Loading Problems"}),h.jsx("p",{className:"text-error mb-4",children:l}),h.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-outline btn-error",children:"Try Again"})]})})});const ie=ne(),ae=new Set(e?.problem_solved||[]);return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-4 transition-colors",children:[h.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsx("div",{"data-aos":"fade-down","data-aos-duration":"500",className:"bg-base-200/80 backdrop-blur-sm border-b border-base-300/80 bg-gradient-to-br from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-4 transition-colors",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsxs("div",{className:"flex items-center justify-center mb-4","data-aos":"zoom-in","data-aos-delay":"100","data-aos-duration":"400",children:[h.jsx("div",{className:"bg-primary/30 p-3 rounded-full mr-4 ring-2 ring-primary/20",children:h.jsx(sl,{className:"w-8 h-8 text-primary dark:text-primary-content"})}),h.jsx("h1",{className:"text-4xl font-bold text-base-content dark:text-white","data-aos":"fade-left","data-aos-delay":"200","data-aos-duration":"400",children:"Problems"})]}),h.jsx("p",{className:"text-xl text-base-content/80 dark:text-gray-200 max-w-2xl mx-auto","data-aos":"fade-up","data-aos-delay":"300","data-aos-duration":"400",children:"Challenge yourself with coding problems and improve your algorithmic thinking."})]}),h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8","data-aos":"fade-up","data-aos-delay":"400","data-aos-duration":"500",children:[h.jsx("div",{className:"card bg-gradient-to-r from-primary to-primary-focus text-primary-content shadow-lg dark:shadow-primary/20","data-aos":"flip-left","data-aos-delay":"450","data-aos-duration":"400",children:h.jsxs("div",{className:"card-body p-4 text-center",children:[h.jsx(qh,{className:"w-6 h-6 mx-auto mb-2 text-white"}),h.jsx("p",{className:"text-2xl font-bold text-white",children:h.jsx(_c,{from:0,to:ie.total,separator:",",direction:"up",duration:2,className:"count-up-text"})}),h.jsx("p",{className:"text-primary-content/90 dark:text-white/90 text-sm",children:"Total Problems"})]})}),h.jsx("div",{className:"card bg-gradient-to-r from-success to-success-focus text-success-content shadow-lg dark:shadow-success/20","data-aos":"flip-left","data-aos-delay":"500","data-aos-duration":"400",children:h.jsxs("div",{className:"card-body p-4 text-center",children:[h.jsx(ka,{className:"w-6 h-6 mx-auto mb-2 text-white"}),h.jsx("p",{className:"text-2xl font-bold text-white",children:h.jsx(_c,{from:0,to:ie.easy,separator:",",direction:"up",duration:3,className:"count-up-text"})}),h.jsx("p",{className:"text-success-content/90 dark:text-white/90 text-sm",children:"Easy"})]})}),h.jsx("div",{className:"card bg-gradient-to-r from-warning to-warning-focus text-warning-content shadow-lg dark:shadow-warning/20","data-aos":"flip-left","data-aos-delay":"550","data-aos-duration":"400",children:h.jsxs("div",{className:"card-body p-4 text-center",children:[h.jsx(Rc,{className:"w-6 h-6 mx-auto mb-2 text-white"}),h.jsx("p",{className:"text-2xl font-bold text-white",children:h.jsx(_c,{from:0,to:ie.medium,separator:",",direction:"up",duration:3,className:"count-up-text"})}),h.jsx("p",{className:"text-warning-content/90 dark:text-white/90 text-sm",children:"Medium"})]})}),h.jsx("div",{className:"card bg-gradient-to-r from-error to-error-focus text-error-content shadow-lg dark:shadow-error/20","data-aos":"flip-left","data-aos-delay":"600","data-aos-duration":"400",children:h.jsxs("div",{className:"card-body p-4 text-center",children:[h.jsx(Uz,{className:"w-6 h-6 mx-auto mb-2 text-white"}),h.jsx("p",{className:"text-2xl font-bold text-white",children:h.jsx(_c,{from:0,to:ie.hard,separator:",",direction:"up",duration:3,className:"count-up-text"})}),h.jsx("p",{className:"text-error-content/90 dark:text-white/90 text-sm",children:"Hard"})]})}),h.jsx("div",{className:"card bg-gradient-to-r from-info to-info-focus text-info-content shadow-lg dark:shadow-info/20","data-aos":"flip-left","data-aos-delay":"650","data-aos-duration":"400",children:h.jsxs("div",{className:"card-body p-4 text-center",children:[h.jsx(ka,{className:"w-6 h-6 mx-auto mb-2 text-white"}),h.jsx("p",{className:"text-2xl font-bold text-white",children:h.jsx(_c,{from:0,to:ie.solved,separator:",",direction:"up",duration:3,className:"count-up-text"})}),h.jsx("p",{className:"text-info-content/90 dark:text-white/90 text-sm",children:"Solved"})]})})]}),h.jsxs("div",{className:"bg-base-100/50 dark:bg-gray-800/50 backdrop-blur-sm rounded-2xl p-6 border border-base-300/50 dark:border-gray-700/50 shadow-lg","data-aos":"zoom-in-up","data-aos-delay":"700","data-aos-duration":"500",children:[h.jsxs(Et.div,{className:"relative mb-6","data-aos":"fade-right","data-aos-delay":"800","data-aos-duration":"400",children:[h.jsx("span",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4",children:h.jsx(mfe,{className:"h-5 w-5 text-gray-400"})}),h.jsx("input",{type:"text",placeholder:"Search coding problems...",value:u,onChange:Z=>d(Z.target.value),className:"w-full rounded-full border border-gray-300 bg-white py-3 pl-11 pr-4 text-gray-900 shadow-sm transition-all duration-200 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-300/50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 dark:placeholder-gray-400 dark:focus:border-blue-500 hover:shadow-md"})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[h.jsxs("div",{className:"space-y-3","data-aos":"fade-up","data-aos-delay":"850","data-aos-duration":"400",children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[h.jsx("div",{className:"p-2 bg-primary/10 dark:bg-primary/20 rounded-lg",children:h.jsx(xO,{className:"w-4 h-4 text-primary dark:text-primary-content"})}),h.jsx("h3",{className:"font-semibold text-base-content dark:text-white",children:"Difficulty"})]}),h.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[h.jsx("button",{className:`btn btn-sm justify-start transition-all duration-200 hover:scale-105 ${f==="all"?"btn-primary text-white shadow-lg":"btn-ghost hover:bg-base-200 dark:hover:bg-gray-700 dark:text-gray-200"}`,onClick:()=>m("all"),children:"All Problems"}),h.jsx("button",{className:`btn btn-sm justify-start transition-all duration-200 hover:scale-105 ${f==="easy"?"btn-success text-white shadow-lg":"btn-ghost hover:bg-success/10 dark:hover:bg-success/20 text-success dark:text-success"}`,onClick:()=>m("easy"),children:"Easy"}),h.jsx("button",{className:`btn btn-sm justify-start transition-all duration-200 hover:scale-105 ${f==="medium"?"btn-warning text-white shadow-lg":"btn-ghost hover:bg-warning/10 dark:hover:bg-warning/20 text-warning dark:text-warning"}`,onClick:()=>m("medium"),children:"Medium"}),h.jsx("button",{className:`btn btn-sm justify-start transition-all duration-200 hover:scale-105 ${f==="hard"?"btn-error text-white shadow-lg":"btn-ghost hover:bg-error/10 dark:hover:bg-error/20 text-error dark:text-error"}`,onClick:()=>m("hard"),children:"Hard"})]})]}),h.jsxs("div",{className:"space-y-3","data-aos":"fade-up","data-aos-delay":"900","data-aos-duration":"400",children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[h.jsx("div",{className:"p-2 bg-success/10 dark:bg-success/20 rounded-lg",children:h.jsx(ka,{className:"w-4 h-4 text-success dark:text-success-content"})}),h.jsx("h3",{className:"font-semibold text-base-content dark:text-white",children:"Status"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("button",{className:`btn btn-sm w-full justify-start transition-all duration-200 hover:scale-105 ${x==="all"?"btn-primary text-white shadow-lg":"btn-ghost hover:bg-base-200 dark:hover:bg-gray-700 dark:text-gray-200"}`,onClick:()=>w("all"),children:[h.jsx("span",{className:"w-2 h-2 rounded-full bg-current mr-2"}),"All Problems"]}),h.jsxs("button",{className:`btn btn-sm w-full justify-start transition-all duration-200 hover:scale-105 ${x==="solved"?"btn-success text-white shadow-lg":"btn-ghost hover:bg-success/10 dark:hover:bg-success/20 text-success dark:text-success"}`,onClick:()=>w("solved"),children:[h.jsx(ka,{className:"w-4 h-4 mr-2"}),"Solved"]}),h.jsxs("button",{className:`btn btn-sm w-full justify-start transition-all duration-200 hover:scale-105 ${x==="unsolved"?"btn-info text-white shadow-lg":"btn-ghost hover:bg-info/10 dark:hover:bg-info/20 text-info dark:text-info"}`,onClick:()=>w("unsolved"),children:[h.jsx(Rc,{className:"w-4 h-4 mr-2"}),"Unsolved"]})]})]}),h.jsxs("div",{className:"space-y-3","data-aos":"fade-up","data-aos-delay":"950","data-aos-duration":"400",children:[h.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[h.jsx("div",{className:"p-2 bg-info/10 dark:bg-info/20 rounded-lg",children:h.jsx(zT,{className:"w-4 h-4 text-info dark:text-info-content"})}),h.jsx("h3",{className:"font-semibold text-base-content dark:text-white",children:"Tags"})]}),_.length>0?h.jsx("div",{className:"relative",children:h.jsxs("select",{className:"select select-bordered w-full bg-base-100 dark:bg-gray-800 dark:border-gray-600 dark:text-white focus:border-primary dark:focus:border-primary focus:ring-2 focus:ring-primary/20 transition-all duration-200 hover:shadow-sm",value:v,onChange:Z=>y(Z.target.value),children:[h.jsx("option",{value:"all",children:"All Categories"}),_.map(Z=>h.jsx("option",{value:Z,className:"dark:bg-gray-800",children:Z},Z))]})}):h.jsx("p",{className:"text-sm text-base-content/60 dark:text-gray-400 italic",children:"No tags available"})]})]}),h.jsx("div",{className:"mt-6 pt-4 border-t border-base-300/50 dark:border-gray-700/50","data-aos":"fade-up","data-aos-delay":"1000","data-aos-duration":"400",children:h.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[h.jsxs("button",{className:"btn btn-sm btn-ghost hover:bg-base-200 dark:text-gray-200 dark:hover:bg-gray-700 transition-all duration-200 hover:scale-105",onClick:ce,children:[h.jsx(xO,{className:"w-4 h-4 mr-2"}),"Clear Filters"]}),h.jsx("div",{className:"badge badge-neutral dark:badge-ghost",children:h.jsx("span",{className:"text-xs",children:"Showing filtered results"})})]})})]})]})}),h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[h.jsxs("div",{className:"bg-base-100/90 dark:bg-gray-800/90 backdrop-blur-xl rounded-2xl shadow-2xl border border-base-300/50 dark:border-gray-700/50 overflow-hidden",children:[h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"table w-full",children:[h.jsx("thead",{className:"bg-gradient-to-r from-primary/5 to-secondary/5 dark:from-primary/10 dark:to-secondary/10",children:h.jsxs("tr",{className:"border-b-2 border-primary/20 dark:border-primary/30",children:[h.jsx("th",{className:"text-left py-6 px-6 font-bold text-base-content dark:text-white w-20 text-sm uppercase tracking-wider",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("span",{className:"w-2 h-2 bg-primary rounded-full"}),h.jsx("span",{children:"#"})]})}),h.jsx("th",{className:"text-left py-6 px-6 font-bold text-base-content dark:text-white text-sm uppercase tracking-wider",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(sl,{className:"w-4 h-4 text-primary"}),h.jsx("span",{children:"Problem Title"})]})}),h.jsx("th",{className:"text-left py-6 px-6 font-bold text-base-content dark:text-white w-36 text-sm uppercase tracking-wider",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Uz,{className:"w-4 h-4 text-warning"}),h.jsx("span",{children:"Difficulty"})]})}),h.jsx("th",{className:"text-left py-6 px-6 font-bold text-base-content dark:text-white text-sm uppercase tracking-wider",children:h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(zT,{className:"w-4 h-4 text-info"}),h.jsx("span",{children:"Tags"})]})}),h.jsx("th",{className:"text-center py-6 px-6 font-bold text-base-content dark:text-white w-28 text-sm uppercase tracking-wider",children:h.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[h.jsx(ka,{className:"w-4 h-4 text-success"}),h.jsx("span",{children:"Status"})]})}),h.jsx("th",{className:"text-center py-6 px-6 font-bold text-base-content dark:text-white w-28 text-sm uppercase tracking-wider",children:h.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[h.jsx(Eh,{className:"w-4 h-4 text-primary"}),h.jsx("span",{children:"Todo"})]})})]})}),h.jsx("tbody",{className:"divide-y divide-base-300/30 dark:divide-gray-700/30",children:h.jsx(ya,{children:n.map((Z,fe)=>{const he=ae.has(Z._id.toString()),Ae=se(Z._id),xe=fe<10;return h.jsxs("tr",{...xe&&{"data-aos":"fade-up","data-aos-delay":Math.min(fe*30,300),"data-aos-duration":"300"},className:`
            group transition-all duration-200 cursor-pointer
            hover:bg-gradient-to-r hover:from-primary/5 hover:to-transparent
            dark:hover:from-primary/10 dark:hover:to-transparent
            hover:shadow-md
            ${he?"bg-success/5 dark:bg-success/10":""}
            ${fe%2===0?"bg-base-50/50 dark:bg-gray-800/30":"bg-base-100/50 dark:bg-gray-800/50"}
          `,children:[h.jsx("td",{className:"py-5 px-6",onClick:()=>H(Z._id),children:h.jsx("div",{className:"flex items-center",children:h.jsx("div",{className:"w-8 h-8 bg-base-200 dark:bg-gray-700 rounded-lg flex items-center justify-center group-hover:bg-primary/20 dark:group-hover:bg-primary/30 transition-colors duration-200",children:h.jsx("span",{className:"font-mono text-sm font-bold text-base-content/80 dark:text-gray-200 group-hover:text-primary",children:Z.serial_number})})})}),h.jsx("td",{className:"py-5 px-6",onClick:()=>H(Z._id),children:h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"p-2 bg-primary/10 dark:bg-primary/20 rounded-lg group-hover:bg-primary/20 dark:group-hover:bg-primary/30 transition-colors duration-200",children:h.jsx(sl,{className:"w-4 h-4 text-primary group-hover:text-primary-focus"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-base-content dark:text-white group-hover:text-primary transition-colors duration-200 leading-tight",children:Z.title}),h.jsx("p",{className:"text-xs text-base-content/60 dark:text-gray-400 mt-1",children:"Click to solve"})]})]})}),h.jsx("td",{className:"py-5 px-6",onClick:()=>H(Z._id),children:h.jsxs("span",{className:`
              inline-flex items-center px-3 py-2 rounded-xl text-xs font-bold uppercase tracking-wider
              shadow-sm transition-shadow duration-200 group-hover:shadow-md
              ${eee(Z.difficulty)}
            `,children:[h.jsx("span",{className:"w-2 h-2 rounded-full bg-current mr-2 opacity-80"}),Z.difficulty]})}),h.jsx("td",{className:"py-5 px-6",onClick:()=>H(Z._id),children:h.jsxs("div",{className:"flex flex-wrap gap-2",children:[Z.tags&&Z.tags.split(",").map(Ee=>Ee.trim()).slice(0,2).map((Ee,Be)=>h.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#9fa2a2] text-[white] dark:bg-[#5ad3c7be] dark:text-info-content border border-info/20 hover:bg-info/20 transition-colors duration-200",children:[h.jsx(zT,{className:"w-3 h-3 mr-1"}),Ee]},Be)),Z.tags&&Z.tags.split(",").length>2&&h.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-base-300/50 text-base-content/70 dark:bg-gray-600 dark:text-gray-300 border border-base-300 dark:border-gray-600",children:["+",Z.tags.split(",").length-2," more"]})]})}),h.jsx("td",{className:"py-5 px-6",onClick:()=>H(Z._id),children:h.jsx("div",{className:"flex justify-center",children:he?h.jsx("div",{className:"relative",children:h.jsx("div",{className:"w-10 h-10 bg-success/10 dark:bg-success/20 rounded-full flex items-center justify-center border-2 border-success/30",children:h.jsx(ka,{className:"w-5 h-5 text-success"})})}):h.jsx("div",{className:"w-10 h-10 bg-base-200 dark:bg-gray-700 rounded-full flex items-center justify-center border-2 border-base-300 dark:border-gray-600 group-hover:border-primary/50 transition-colors duration-200",children:h.jsx(Oz,{className:"w-5 h-5 text-base-content/40 dark:text-gray-500 group-hover:text-primary/70"})})})}),h.jsx("td",{className:"py-5 px-6",children:h.jsx("div",{className:"flex justify-center",children:h.jsx("div",{className:"tooltip tooltip-top","data-tip":Ae?"Remove from Todo":"Add to Todo",children:h.jsx("button",{onClick:Ee=>{Ee.stopPropagation(),!(E===Z._id||C===Z._id)&&(Ae?$(Z._id):F(Z._id))},className:`
                    w-10 h-10 rounded-full flex items-center justify-center border-2 
                    transition-all duration-200 hover:scale-105 
                    ${Ae?"bg-error/10 dark:bg-error/20 border-error/30 text-error dark:hover:bg-red-300 hover:bg-red-300":"bg-base-200 dark:hover:bg-green-300 hover:bg-green-300  dark:bg-gray-700 border-base-300 dark:border-gray-600 text-base-content/40 dark:text-gray-500 hover:border-primary/50 hover:text-primary/70"}
                    ${E===Z._id||C===Z._id?"cursor-not-allowed":""} 
                `,disabled:E===Z._id||C===Z._id,children:E===Z._id||C===Z._id?h.jsx("span",{className:"loading loading-spinner loading-sm text-primary"}):Ae?h.jsx(zot,{className:"w-5 h-5 cursor-pointer"}):h.jsx(Hl,{className:"w-5 h-5 cursor-pointer"})})})})})]},Z._id)})})})]})}),n.length===0&&h.jsxs("div",{className:"text-center py-16 px-6",children:[h.jsxs("div",{className:"relative mx-auto mb-8 w-24 h-24",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/20 to-secondary/20 rounded-full animate-pulse"}),h.jsx("div",{className:"relative w-24 h-24 bg-base-200 dark:bg-gray-700 rounded-full flex items-center justify-center border-4 border-base-300 dark:border-gray-600",children:h.jsx(Wh,{className:"w-10 h-10 text-base-content/50 dark:text-gray-400"})})]}),h.jsx("h3",{className:"text-2xl font-bold text-base-content dark:text-white mb-3",children:"No Problems Found"}),h.jsx("p",{className:"text-base-content/60 dark:text-gray-400 text-lg mb-6 max-w-md mx-auto",children:"We couldn't find any problems matching your current filters. Try adjusting your search criteria."}),h.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[h.jsxs("button",{className:"btn btn-primary btn-sm",children:[h.jsx(xO,{className:"w-4 h-4 mr-2"}),"Clear Filters"]}),h.jsxs("button",{className:"btn btn-ghost btn-sm",children:[h.jsx(Wh,{className:"w-4 h-4 mr-2"}),"Browse All"]})]})]})]}),n.length>0&&h.jsx("div",{className:"mt-8 text-center",children:h.jsxs("div",{className:"inline-flex items-center space-x-4 bg-base-100/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-full px-6 py-3 border border-primary/20 dark:border-primary/30 shadow-lg",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-pulse"}),h.jsx("span",{className:"text-base-content/70 dark:text-gray-300",children:"Showing"})]}),h.jsx("span",{className:"font-bold text-lg text-primary",children:n.length}),h.jsx("span",{className:"text-base-content/70 dark:text-gray-300",children:"of"}),h.jsx("span",{className:"font-bold text-lg text-base-content dark:text-white",children:r.length}),h.jsx("span",{className:"text-base-content/70 dark:text-gray-300",children:"problems"})]})})]}),h.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:h.jsx("div",{className:"tooltip tooltip-left","data-tip":"Todo List",children:h.jsx(Et.button,{onClick:()=>q(!0),className:"btn btn-circle btn-lg bg-primary hover:bg-primary-focus text-white shadow-2xl border-2 border-primary-content/20",animate:j.length>0?{scale:[1,1.1,1],y:[0,-20,0],boxShadow:["0 0 0 rgba(59, 130, 246, 0)","0 0 20px rgba(59, 130, 246, 0.7)","0 0 0 rgba(59, 130, 246, 0)"]}:{},transition:{duration:5,repeat:1/0,ease:"easeInOut"},children:h.jsxs("div",{className:"relative",children:[h.jsx(Eh,{className:"w-6 h-6"}),j.length>0&&h.jsx("div",{className:"absolute -top-2 -right-2 w-5 h-5 bg-error rounded-full flex items-center justify-center",children:h.jsx("span",{className:"text-xs font-bold text-white",children:j.length})})]})})})}),h.jsx(ya,{children:B&&h.jsxs(Et.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[h.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:X}),h.jsxs(Et.div,{initial:{scale:.9,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:50},transition:{type:"spring",stiffness:300,damping:30},className:"relative bg-base-100 dark:bg-gray-800 rounded-2xl shadow-2xl border border-base-300/50 dark:border-gray-700/50 w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[h.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-base-300/50 dark:border-gray-700/50 bg-gradient-to-r from-primary/5 to-secondary/5 dark:from-primary/10 dark:to-secondary/10",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"p-2 bg-primary/10 dark:bg-primary/20 rounded-lg",children:h.jsx(Eh,{className:"w-5 h-5 text-primary"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-base-content dark:text-white",children:"Todo Problems"}),h.jsxs("p",{className:"text-sm text-base-content/60 dark:text-gray-400",children:[j.length," problem",j.length!==1?"s":""," in your list"]})]})]}),h.jsx("button",{onClick:X,className:"btn btn-ghost btn-sm btn-circle hover:bg-base-200 dark:hover:bg-gray-700",children:h.jsx(Dc,{className:"w-5 h-5"})})]}),h.jsxs("div",{className:"overflow-y-auto max-h-[calc(80vh-140px)]",children:[" ",G?h.jsx("div",{className:"flex items-center justify-center py-12",children:h.jsx("div",{className:"loading loading-spinner loading-md text-primary"})}):j.length===0?h.jsxs("div",{className:"text-center py-12 px-6",children:[h.jsx("div",{className:"w-16 h-16 bg-base-200 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(Eh,{className:"w-8 h-8 text-base-content/40 dark:text-gray-500"})}),h.jsx("h3",{className:"text-lg font-semibold text-base-content dark:text-white mb-2",children:"No Problems in Todo"}),h.jsx("p",{className:"text-base-content/60 dark:text-gray-400",children:"Add problems to your todo list to keep track of what you want to solve."})]}):h.jsx("div",{className:"p-4 space-y-3",children:j.map(Z=>{if(!Z)return null;const fe=ae.has(Z._id.toString());return h.jsx("div",{className:`
                                                p-4 rounded-xl border transition-all duration-200 hover:shadow-lg
                                                ${fe?"bg-success/5 dark:bg-success/10 border-success/20":"bg-base-50 dark:bg-gray-700/50 border-base-300/50 dark:border-gray-600/50"}
                                            `,children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[h.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${fe?"bg-success/10 border-success/30 text-success":"bg-base-200 dark:bg-gray-600 border-base-300 dark:border-gray-600 text-base-content/60 dark:text-gray-400"}`,children:fe?h.jsx(ka,{className:"w-4 h-4"}):h.jsx(Oz,{className:"w-4 h-4"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"font-semibold text-base-content dark:text-white truncate",children:Z.title}),h.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[h.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${eee(Z.difficulty)}`,children:Z.difficulty}),fe&&h.jsx("span",{className:"text-xs text-success font-medium",children:"✓ Solved"})]})]})]}),h.jsxs("div",{className:"flex items-center space-x-2 ml-3",children:[h.jsx("div",{className:"tooltip tooltip-top","data-tip":"Solve Problem",children:h.jsx("button",{onClick:()=>{X(),H(Z._id)},className:"btn btn-sm btn-primary text-white hover:btn-primary-focus",children:h.jsx(jD,{className:"w-4 h-4"})})}),h.jsx("div",{className:"tooltip tooltip-top","data-tip":"Remove from Todo",children:h.jsx("button",{onClick:()=>$(Z._id),className:"btn btn-sm btn-error text-white hover:btn-error-focus",children:h.jsx(Ic,{className:"w-4 h-4"})})})]})]})},Z._id)})})]}),j.length>0&&h.jsx("div",{className:"p-4 border-t border-base-300/50 dark:border-gray-700/50 bg-base-50/50 dark:bg-gray-800/50",children:h.jsxs("div",{className:"flex items-center justify-between text-sm text-base-content/60 dark:text-gray-400",children:[h.jsxs("span",{children:[j.filter(Z=>ae.has(Z._id.toString())).length," solved"]}),h.jsxs("span",{children:[j.length," total"]})]})})]})]})}),h.jsx(ya,{children:D.show&&h.jsx(Et.div,{initial:{opacity:0,y:50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.5},className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-50",children:h.jsxs("div",{className:"bg-neutral text-neutral-content rounded-full shadow-lg px-6 py-3 flex items-center space-x-3",children:[h.jsx(ka,{className:"w-5 h-5 text-success"}),h.jsx("span",{className:"font-medium text-sm",children:D.message})]})})})]})};function Blt(){return h.jsxs(h.Fragment,{children:[h.jsx(pfe,{}),h.jsx("main",{children:h.jsx(are,{})})]})}function TC(...e){return e.filter(Boolean).join(" ")}const LD=O.forwardRef((e,t)=>{const{texts:r,transition:i={type:"spring",damping:25,stiffness:300},initial:n={y:"100%",opacity:0},animate:s={y:0,opacity:1},exit:a={y:"-120%",opacity:0},animatePresenceMode:o="wait",animatePresenceInitial:l=!1,rotationInterval:c=2e3,staggerDuration:u=0,staggerFrom:d="first",loop:f=!0,auto:m=!0,splitBy:v="characters",onNext:y,mainClassName:x,splitLevelClassName:w,elementLevelClassName:_,...S}=e,[P,M]=O.useState(0),C=B=>{if(typeof Intl<"u"&&Intl.Segmenter){const q=new Intl.Segmenter("en",{granularity:"grapheme"});return Array.from(q.segment(B),G=>G.segment)}return Array.from(B)},T=O.useMemo(()=>{const B=r[P];if(v==="characters"){const q=B.split(" ");return q.map((G,Y)=>({characters:C(G),needsSpace:Y!==q.length-1}))}return v==="words"?B.split(" ").map((q,G,Y)=>({characters:[q],needsSpace:G!==Y.length-1})):v==="lines"?B.split(`
`).map((q,G,Y)=>({characters:[q],needsSpace:G!==Y.length-1})):B.split(v).map((q,G,Y)=>({characters:[q],needsSpace:G!==Y.length-1}))},[r,P,v]),E=O.useCallback((B,q)=>{const G=q;if(d==="first")return B*u;if(d==="last")return(G-1-B)*u;if(d==="center"){const Y=Math.floor(G/2);return Math.abs(Y-B)*u}if(d==="random"){const Y=Math.floor(Math.random()*G);return Math.abs(Y-B)*u}return Math.abs(d-B)*u},[d,u]),N=O.useCallback(B=>{M(B),y&&y(B)},[y]),D=O.useCallback(()=>{const B=P===r.length-1?f?0:P:P+1;B!==P&&N(B)},[P,r.length,f,N]),I=O.useCallback(()=>{const B=P===0?f?r.length-1:P:P-1;B!==P&&N(B)},[P,r.length,f,N]),j=O.useCallback(B=>{const q=Math.max(0,Math.min(B,r.length-1));q!==P&&N(q)},[r.length,P,N]),L=O.useCallback(()=>{P!==0&&N(0)},[P,N]);return O.useImperativeHandle(t,()=>({next:D,previous:I,jumpTo:j,reset:L}),[D,I,j,L]),O.useEffect(()=>{if(!m)return;const B=setInterval(D,c);return()=>clearInterval(B)},[D,c,m]),h.jsxs(Et.span,{className:TC("flex flex-wrap whitespace-pre-wrap relative",x),...S,layout:!0,transition:i,children:[h.jsx("span",{className:"sr-only",children:r[P]}),h.jsx(ya,{mode:o,initial:l,children:h.jsx(Et.span,{className:TC(v==="lines"?"flex flex-col w-full":"flex flex-wrap whitespace-pre-wrap relative"),layout:!0,"aria-hidden":"true",children:T.map((B,q,G)=>{const Y=G.slice(0,q).reduce((X,re)=>X+re.characters.length,0);return h.jsxs("span",{className:TC("inline-flex",w),children:[B.characters.map((X,re)=>h.jsx(Et.span,{initial:n,animate:s,exit:a,transition:{...i,delay:E(Y+re,G.reduce((F,$)=>F+$.characters.length,0))},className:TC("inline-block",_),children:X},re)),B.needsSpace&&h.jsx("span",{className:"whitespace-pre",children:" "})]},q)})},P)})]})});LD.displayName="RotatingText";function Flt(){O.useEffect(()=>{Hn.init({duration:800,once:!1})},[]);const e=[{title:"Create Problem",description:"Design and add a new coding challenge to the platform.",icon:Hl,color:"bg-primary/10 text-primary",buttonClass:"btn-primary",link:"/admin/problems/create",buttonText:"Create New"},{title:"Manage Contest",description:"Create, edit, and monitor coding contests for your users.",icon:qh,color:"bg-purple-500/10 text-purple-500",buttonClass:"bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600",link:"/admin/contest",buttonText:"Manage"},{title:"Edit Problems",description:"Modify, update, and refine existing coding problems.",icon:Vz,color:"bg-secondary/10 text-secondary",buttonClass:"btn-secondary",link:"/admin/update",buttonText:"Edit Problems"},{title:"Video Library",description:"Manage educational content, tutorials, and video resources.",icon:Elt,color:"bg-accent/10 text-accent",buttonClass:"btn-accent",link:"/admin/video",buttonText:"Browse Library"},{title:"Manage Users",description:"Oversee user roles, permissions, and platform access.",icon:Hz,color:"bg-info/10 text-info",buttonClass:"btn-info",link:"/admin/users",buttonText:"Manage Users"},{title:"Delete Content",description:"Remove outdated or incorrect problems from the live set.",icon:Ic,color:"bg-error/10 text-error",buttonClass:"btn-error",link:"/admin/problems/delete",buttonText:"Manage"}],t=[{label:"Total Problems",value:"20",icon:afe,color:"text-primary"},{label:"Active Users",value:"15",icon:Hz,color:"text-success"},{label:"Success Rate",value:"89%",icon:Uz,color:"text-accent"},{label:"New Users Today",value:"4",icon:Zu,color:"text-info"}];return h.jsxs("div",{className:"relative min-h-screen bg-base-100 p-4 sm:p-8 overflow-hidden",children:[h.jsx("div",{className:"fixed inset-0 z-9 pointer-events-none from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-4 transition-colors "}),h.jsxs("div",{className:"absolute inset-0 z-100 pointer-events-none",children:[h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1}),h.jsx("div",{className:"absolute bottom-0 left-[-20%] right-0 top-[-10%] h-[500px] w-[500px] rounded-full bg-[radial-gradient(circle_farthest-side,rgba(var(--color-primary),0.1),transparent)]"}),h.jsx("div",{className:"absolute bottom-0 right-[-20%] top-[-10%] h-[500px] w-[500px] rounded-full bg-[radial-gradient(circle_farthest-side,rgba(var(--color-accent),0.1),transparent)]"})]}),h.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto space-y-16",children:[h.jsxs("div",{className:"text-center space-y-3 pt-10","data-aos":"fade-down",children:[h.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent",children:"Admin Dashboard"}),h.jsx(LD,{texts:["Manage your coding platform","Create new challenges","Monitor user activity","Analyze platform growth"],mainClassName:"text-base-content/70 font-medium text-base sm:text-lg flex justify-center",staggerDuration:.03,rotationInterval:4e3})]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map((r,i)=>{const n=r.icon;return h.jsxs("div",{className:"group relative","data-aos":"fade-up","data-aos-delay":i*50,children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-secondary rounded-xl blur-sm opacity-10 group-hover:opacity-30 transition-all duration-300"}),h.jsx("div",{className:"relative card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20 transition-all duration-300 hover:-translate-y-1",children:h.jsxs("div",{className:"card-body",children:[h.jsx("div",{className:`p-3 rounded-xl self-start ${r.color}`,children:h.jsx(n,{className:"w-6 h-6"})}),h.jsx("h2",{className:"card-title text-xl font-bold mt-4",children:r.title}),h.jsx("p",{className:"text-base-content/70 text-sm",children:r.description}),h.jsx("div",{className:"card-actions justify-end mt-4",children:h.jsx(hr,{to:r.link,className:`btn ${r.buttonClass} btn-sm text-white`,children:r.buttonText})})]})})]},r.title)})}),h.jsx("div",{className:"card bg-base-100/70 backdrop-blur-md shadow-2xl border border-base-300/20","data-aos":"fade-up","data-aos-delay":"100",children:h.jsxs("div",{className:"card-body",children:[h.jsx("h2",{className:"card-title text-2xl font-bold text-center sm:text-left mb-6",children:"📊 Platform Quick-Stats"}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6",children:t.map(r=>{const i=r.icon;return h.jsxs("div",{className:"text-center p-4 rounded-lg bg-base-200/50 hover:bg-base-200 transition-colors",children:[h.jsx(i,{className:`w-8 h-8 mx-auto mb-3 ${r.color}`}),h.jsx("div",{className:`text-4xl font-bold ${r.color}`,children:r.value}),h.jsx("div",{className:"text-sm text-base-content/70 mt-1",children:r.label})]},r.label)})})]})})]}),h.jsx("footer",{className:"relative z-10 border-t border-base-300/50",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-12 py-12",children:[h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[h.jsxs("div",{className:"lg:col-span-1","data-aos":"fade-up",children:[h.jsx("h3",{className:"text-2xl font-bold",children:"Ready to Start Your Journey?"}),h.jsx("p",{className:"mt-2 text-base-content/70",children:"Create an account to track your progress, save problems, and join the best community of developers."}),h.jsx("div",{className:"mt-6",children:h.jsx(hr,{to:"/register",className:"btn btn-primary btn-wide",children:"Get Started for Free"})})]}),h.jsxs("div",{className:"lg:col-span-2 grid grid-cols-2 md:grid-cols-4 gap-8","data-aos":"fade-up","data-aos-delay":"100",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-base-content mb-3",children:"Product"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsx("li",{children:h.jsx(hr,{to:"/problems",className:"link link-hover text-base-content/70",children:"Problems"})}),h.jsx("li",{children:h.jsx(hr,{to:"/problem/potd",className:"link link-hover text-base-content/70",children:"Daily Challenge"})}),h.jsx("li",{children:h.jsx(hr,{to:"/pricing",className:"link link-hover text-base-content/70",children:"Pricing"})}),h.jsx("li",{children:h.jsx(hr,{to:"/discussion",className:"link link-hover text-base-content/70",children:"Discussions"})})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-base-content mb-3",children:"Company"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"About Us"})}),h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Careers"})}),h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Contact"})})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-base-content mb-3",children:"Resources"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Blog"})}),h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Help Center"})}),h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Sitemap"})})]})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-base-content mb-3",children:"Legal"}),h.jsxs("ul",{className:"space-y-2",children:[h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Privacy Policy"})}),h.jsx("li",{children:h.jsx("a",{href:"#",className:"link link-hover text-base-content/70",children:"Terms of Service"})})]})]})]})]}),h.jsxs("div",{className:"mt-12 pt-8 border-t border-base-300/50 flex flex-col sm:flex-row justify-between items-center",children:[h.jsxs("p",{className:"text-sm text-base-content/60 text-center sm:text-left",children:["© ",new Date().getFullYear()," CodeG. All Rights Reserved."]}),h.jsxs("div",{className:"flex items-center gap-4 mt-4 sm:mt-0",children:[h.jsx("a",{href:"#",className:"text-base-content/70 hover:text-primary transition-colors",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.91 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})}),h.jsx("a",{href:"#",className:"text-base-content/70 hover:text-primary transition-colors",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.85s-.011 3.585-.069 4.85c-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07s-3.585-.012-4.85-.07c-3.252-.148-4.771-1.691-4.919-4.919-.058-1.265-.07-1.645-.07-4.85s.012-3.585.07-4.85c.148-3.225 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.85-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.667.072 4.947c.2 4.358 2.618 6.78 6.98 6.98 1.281.059 1.689.073 4.948.073s3.667-.014 4.947-.072c4.358-.2 6.78-2.618 6.98-6.98.059-1.281.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.2-4.358-2.618-6.78-6.98-6.98-1.281-.059-1.689-.073-4.948-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.162 6.162 6.162 6.162-2.759 6.162-6.162-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.79 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.441 1.441 1.441 1.441-.645 1.441-1.441-.645-1.44-1.441-1.44z"})})}),h.jsx("a",{href:"#",className:"text-base-content/70 hover:text-primary transition-colors",children:h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{d:"M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616v.064c0 2.295 1.616 4.22 3.765 4.664-.715.192-1.472.22-2.21.084.613 1.942 2.38 3.352 4.484 3.388-1.703 1.332-3.834 2.052-6.143 2.052-.4 0-.79-.023-1.17-.067 2.206 1.408 4.832 2.224 7.656 2.224 9.172 0 14.288-7.753 13.945-14.656.974-.698 1.82-1.572 2.486-2.584z"})})})]})]})]})})]})}function Vlt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function ree(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tee(Object(r),!0).forEach(function(i){Vlt(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tee(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Ult(e,t){if(e==null)return{};var r={},i=Object.keys(e),n,s;for(s=0;s<i.length;s++)n=i[s],!(t.indexOf(n)>=0)&&(r[n]=e[n]);return r}function Hlt(e,t){if(e==null)return{};var r=Ult(e,t),i,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function Glt(e,t){return Wlt(e)||qlt(e,t)||Ylt(e,t)||Xlt()}function Wlt(e){if(Array.isArray(e))return e}function qlt(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],i=!0,n=!1,s=void 0;try{for(var a=e[Symbol.iterator](),o;!(i=(o=a.next()).done)&&(r.push(o.value),!(t&&r.length===t));i=!0);}catch(l){n=!0,s=l}finally{try{!i&&a.return!=null&&a.return()}finally{if(n)throw s}}return r}}function Ylt(e,t){if(e){if(typeof e=="string")return iee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iee(e,t)}}function iee(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function Xlt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $lt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,i)}return r}function see(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nee(Object(r),!0).forEach(function(i){$lt(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nee(Object(r)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(r,i))})}return e}function Klt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(i){return t.reduceRight(function(n,s){return s(n)},i)}}function Rw(e){return function t(){for(var r=this,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return n.length>=e.length?e.apply(this,n):function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return t.apply(r,[].concat(n,o))}}}function XP(e){return{}.toString.call(e).includes("Object")}function Qlt(e){return!Object.keys(e).length}function h_(e){return typeof e=="function"}function Zlt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Jlt(e,t){return XP(t)||Np("changeType"),Object.keys(t).some(function(r){return!Zlt(e,r)})&&Np("changeField"),t}function ect(e){h_(e)||Np("selectorType")}function tct(e){h_(e)||XP(e)||Np("handlerType"),XP(e)&&Object.values(e).some(function(t){return!h_(t)})&&Np("handlersType")}function rct(e){e||Np("initialIsRequired"),XP(e)||Np("initialType"),Qlt(e)&&Np("initialContent")}function ict(e,t){throw new Error(e[t]||e.default)}var nct={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Np=Rw(ict)(nct),MC={changes:Jlt,selector:ect,handler:tct,initial:rct};function sct(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};MC.initial(e),MC.handler(t);var r={current:e},i=Rw(lct)(r,t),n=Rw(oct)(r),s=Rw(MC.changes)(e),a=Rw(act)(r);function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(u){return u};return MC.selector(c),c(r.current)}function l(c){Klt(i,n,s,a)(c)}return[o,l]}function act(e,t){return h_(t)?t(e.current):t}function oct(e,t){return e.current=see(see({},e.current),t),t}function lct(e,t,r){return h_(t)?t(e.current):Object.keys(r).forEach(function(i){var n;return(n=t[i])===null||n===void 0?void 0:n.call(t,e.current[i])}),r}var cct={create:sct},uct={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function dct(e){return function t(){for(var r=this,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return n.length>=e.length?e.apply(this,n):function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return t.apply(r,[].concat(n,o))}}}function hct(e){return{}.toString.call(e).includes("Object")}function fct(e){return e||aee("configIsRequired"),hct(e)||aee("configType"),e.urls?(pct(),{paths:{vs:e.urls.monacoBase}}):e}function pct(){console.warn(gfe.deprecation)}function mct(e,t){throw new Error(e[t]||e.default)}var gfe={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},aee=dct(mct)(gfe),gct={config:fct},vct=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return function(n){return r.reduceRight(function(s,a){return a(s)},n)}};function vfe(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],vfe(e[r],t[r]))}),ree(ree({},e),t)}var yct={type:"cancelation",msg:"operation is manually canceled"};function bO(e){var t=!1,r=new Promise(function(i,n){e.then(function(s){return t?n(yct):i(s)}),e.catch(n)});return r.cancel=function(){return t=!0},r}var xct=cct.create({config:uct,isInitialized:!1,resolve:null,reject:null,monaco:null}),yfe=Glt(xct,2),hS=yfe[0],zD=yfe[1];function bct(e){var t=gct.config(e),r=t.monaco,i=Hlt(t,["monaco"]);zD(function(n){return{config:vfe(n.config,i),monaco:r}})}function wct(){var e=hS(function(t){var r=t.monaco,i=t.isInitialized,n=t.resolve;return{monaco:r,isInitialized:i,resolve:n}});if(!e.isInitialized){if(zD({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),bO(wO);if(window.monaco&&window.monaco.editor)return xfe(window.monaco),e.resolve(window.monaco),bO(wO);vct(_ct,Ect)(Act)}return bO(wO)}function _ct(e){return document.body.appendChild(e)}function Sct(e){var t=document.createElement("script");return e&&(t.src=e),t}function Ect(e){var t=hS(function(i){var n=i.config,s=i.reject;return{config:n,reject:s}}),r=Sct("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function Act(){var e=hS(function(r){var i=r.config,n=r.resolve,s=r.reject;return{config:i,resolve:n,reject:s}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){xfe(r),e.resolve(r)},function(r){e.reject(r)})}function xfe(e){hS().monaco||zD({monaco:e})}function Cct(){return hS(function(e){var t=e.monaco;return t})}var wO=new Promise(function(e,t){return zD({resolve:e,reject:t})}),bfe={config:bct,init:wct,__getMonacoInstance:Cct},Tct={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},_O=Tct,Mct={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},Pct=Mct;function Dct({children:e}){return Ot.createElement("div",{style:Pct.container},e)}var Nct=Dct,kct=Nct;function Rct({width:e,height:t,isEditorReady:r,loading:i,_ref:n,className:s,wrapperProps:a}){return Ot.createElement("section",{style:{..._O.wrapper,width:e,height:t},...a},!r&&Ot.createElement(kct,null,i),Ot.createElement("div",{ref:n,style:{..._O.fullWidth,...!r&&_O.hide},className:s}))}var Ict=Rct,wfe=O.memo(Ict);function Oct(e){O.useEffect(e,[])}var _fe=Oct;function jct(e,t,r=!0){let i=O.useRef(!0);O.useEffect(i.current||!r?()=>{i.current=!1}:e,t)}var tl=jct;function y2(){}function My(e,t,r,i){return Lct(e,i)||zct(e,t,r,i)}function Lct(e,t){return e.editor.getModel(Sfe(e,t))}function zct(e,t,r,i){return e.editor.createModel(t,r,i?Sfe(e,i):void 0)}function Sfe(e,t){return e.Uri.parse(t)}function Bct({original:e,modified:t,language:r,originalLanguage:i,modifiedLanguage:n,originalModelPath:s,modifiedModelPath:a,keepCurrentOriginalModel:o=!1,keepCurrentModifiedModel:l=!1,theme:c="light",loading:u="Loading...",options:d={},height:f="100%",width:m="100%",className:v,wrapperProps:y={},beforeMount:x=y2,onMount:w=y2}){let[_,S]=O.useState(!1),[P,M]=O.useState(!0),C=O.useRef(null),T=O.useRef(null),E=O.useRef(null),N=O.useRef(w),D=O.useRef(x),I=O.useRef(!1);_fe(()=>{let q=bfe.init();return q.then(G=>(T.current=G)&&M(!1)).catch(G=>G?.type!=="cancelation"&&console.error("Monaco initialization: error:",G)),()=>C.current?B():q.cancel()}),tl(()=>{if(C.current&&T.current){let q=C.current.getOriginalEditor(),G=My(T.current,e||"",i||r||"text",s||"");G!==q.getModel()&&q.setModel(G)}},[s],_),tl(()=>{if(C.current&&T.current){let q=C.current.getModifiedEditor(),G=My(T.current,t||"",n||r||"text",a||"");G!==q.getModel()&&q.setModel(G)}},[a],_),tl(()=>{let q=C.current.getModifiedEditor();q.getOption(T.current.editor.EditorOption.readOnly)?q.setValue(t||""):t!==q.getValue()&&(q.executeEdits("",[{range:q.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),q.pushUndoStop())},[t],_),tl(()=>{C.current?.getModel()?.original.setValue(e||"")},[e],_),tl(()=>{let{original:q,modified:G}=C.current.getModel();T.current.editor.setModelLanguage(q,i||r||"text"),T.current.editor.setModelLanguage(G,n||r||"text")},[r,i,n],_),tl(()=>{T.current?.editor.setTheme(c)},[c],_),tl(()=>{C.current?.updateOptions(d)},[d],_);let j=O.useCallback(()=>{if(!T.current)return;D.current(T.current);let q=My(T.current,e||"",i||r||"text",s||""),G=My(T.current,t||"",n||r||"text",a||"");C.current?.setModel({original:q,modified:G})},[r,t,n,e,i,s,a]),L=O.useCallback(()=>{!I.current&&E.current&&(C.current=T.current.editor.createDiffEditor(E.current,{automaticLayout:!0,...d}),j(),T.current?.editor.setTheme(c),S(!0),I.current=!0)},[d,c,j]);O.useEffect(()=>{_&&N.current(C.current,T.current)},[_]),O.useEffect(()=>{!P&&!_&&L()},[P,_,L]);function B(){let q=C.current?.getModel();o||q?.original?.dispose(),l||q?.modified?.dispose(),C.current?.dispose()}return Ot.createElement(wfe,{width:m,height:f,isEditorReady:_,loading:u,_ref:E,className:v,wrapperProps:y})}var Fct=Bct;O.memo(Fct);function Vct(e){let t=O.useRef();return O.useEffect(()=>{t.current=e},[e]),t.current}var Uct=Vct,PC=new Map;function Hct({defaultValue:e,defaultLanguage:t,defaultPath:r,value:i,language:n,path:s,theme:a="light",line:o,loading:l="Loading...",options:c={},overrideServices:u={},saveViewState:d=!0,keepCurrentModel:f=!1,width:m="100%",height:v="100%",className:y,wrapperProps:x={},beforeMount:w=y2,onMount:_=y2,onChange:S,onValidate:P=y2}){let[M,C]=O.useState(!1),[T,E]=O.useState(!0),N=O.useRef(null),D=O.useRef(null),I=O.useRef(null),j=O.useRef(_),L=O.useRef(w),B=O.useRef(),q=O.useRef(i),G=Uct(s),Y=O.useRef(!1),X=O.useRef(!1);_fe(()=>{let $=bfe.init();return $.then(se=>(N.current=se)&&E(!1)).catch(se=>se?.type!=="cancelation"&&console.error("Monaco initialization: error:",se)),()=>D.current?F():$.cancel()}),tl(()=>{let $=My(N.current,e||i||"",t||n||"",s||r||"");$!==D.current?.getModel()&&(d&&PC.set(G,D.current?.saveViewState()),D.current?.setModel($),d&&D.current?.restoreViewState(PC.get(s)))},[s],M),tl(()=>{D.current?.updateOptions(c)},[c],M),tl(()=>{!D.current||i===void 0||(D.current.getOption(N.current.editor.EditorOption.readOnly)?D.current.setValue(i):i!==D.current.getValue()&&(X.current=!0,D.current.executeEdits("",[{range:D.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),D.current.pushUndoStop(),X.current=!1))},[i],M),tl(()=>{let $=D.current?.getModel();$&&n&&N.current?.editor.setModelLanguage($,n)},[n],M),tl(()=>{o!==void 0&&D.current?.revealLine(o)},[o],M),tl(()=>{N.current?.editor.setTheme(a)},[a],M);let re=O.useCallback(()=>{if(!(!I.current||!N.current)&&!Y.current){L.current(N.current);let $=s||r,se=My(N.current,i||e||"",t||n||"",$||"");D.current=N.current?.editor.create(I.current,{model:se,automaticLayout:!0,...c},u),d&&D.current.restoreViewState(PC.get($)),N.current.editor.setTheme(a),o!==void 0&&D.current.revealLine(o),C(!0),Y.current=!0}},[e,t,r,i,n,s,c,u,d,a,o]);O.useEffect(()=>{M&&j.current(D.current,N.current)},[M]),O.useEffect(()=>{!T&&!M&&re()},[T,M,re]),q.current=i,O.useEffect(()=>{M&&S&&(B.current?.dispose(),B.current=D.current?.onDidChangeModelContent($=>{X.current||S(D.current.getValue(),$)}))},[M,S]),O.useEffect(()=>{if(M){let $=N.current.editor.onDidChangeMarkers(se=>{let H=D.current.getModel()?.uri;if(H&&se.find(ne=>ne.path===H.path)){let ne=N.current.editor.getModelMarkers({resource:H});P?.(ne)}});return()=>{$?.dispose()}}return()=>{}},[M,P]);function F(){B.current?.dispose(),f?d&&PC.set(s,D.current.saveViewState()):D.current.getModel()?.dispose(),D.current.dispose()}return Ot.createElement(wfe,{width:m,height:v,isEditorReady:M,loading:l,_ref:I,className:y,wrapperProps:x})}var Gct=Hct,Wct=O.memo(Gct),fS=Wct;const oee=({control:e,name:t,language:r,isDark:i})=>h.jsx("div",{className:"border border-base-300/50 rounded-lg overflow-hidden h-64 bg-base-100/50 shadow-inner",children:h.jsx(Mqe,{name:t,control:e,render:({field:n})=>h.jsx(fS,{height:"100%",language:(r||"plaintext").toLowerCase(),theme:i?"vs-dark":"light",value:n.value||"",onChange:s=>n.onChange(s),options:{minimap:{enabled:!1},fontSize:14,wordWrap:"on",scrollBeyondLastLine:!1,padding:{top:16}}})})});function qct(){const[e,t]=O.useState(""),[r,i]=O.useState(!0),{register:n,control:s,handleSubmit:a,reset:o,watch:l}=$c({defaultValues:{serial_number:"",title:"",difficulty:"Easy",description:"",tags:"",isprime:!1,visible_testcase:[{input:"",output:"",explanation:""}],hidden_testcase:[{input:"",output:""}],start_code:[{language:"javascript",initial_code:`
var twoSum = function(nums, target) {
    
};`}],problem_solution:[{language:"javascript",complete_code:""}]}}),c=pC({control:s,name:"visible_testcase"}),u=pC({control:s,name:"hidden_testcase"}),d=pC({control:s,name:"start_code"}),f=pC({control:s,name:"problem_solution"}),m=l("start_code"),v=l("problem_solution");O.useEffect(()=>{Hn.init({duration:800,once:!1});const w=()=>i(document.documentElement.getAttribute("data-theme")?.includes("dark"));w();const _=new MutationObserver(w);return _.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>_.disconnect()},[]);const y=async w=>{try{await jt.post("/problem/create",w),t({status:"success",message:"Problem created successfully!"}),o()}catch(_){console.error(_),t({status:"error",message:_?.response?.data?.message||"Failed to create problem"})}},x=async w=>{const _=w.target.files[0];if(_)try{const S=await _.text(),P=JSON.parse(S);o(P),t({status:"success",message:"JSON loaded successfully. Review and submit."})}catch{t({status:"error",message:"Invalid or malformed JSON file."})}};return O.useEffect(()=>{if(e){const w=setTimeout(()=>t(""),5e3);return()=>clearTimeout(w)}},[e]),h.jsxs("div",{className:"relative min-h-screen bg-base-100 p-4 sm:p-8 overflow-hidden bg-gradient-surface bg-gradient-to-br from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600  transition-colors",children:[h.jsxs("div",{className:"absolute inset-0 z-0 pointer-events-none",children:[h.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_top_left,hsl(var(--p)_/_0.1),transparent_40%)]"}),h.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_bottom_right,hsl(var(--s)_/_0.1),transparent_40%)]"})]}),h.jsxs("div",{className:"relative z-10 max-w-6xl mx-auto",children:[h.jsxs("header",{className:"text-center mb-12","data-aos":"fade-down",children:[h.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold mb-3 bg-clip-text text-transparent bg-gradient-to-r from-primary to-accent",children:"Create New Problem"}),h.jsx("p",{className:"text-lg text-base-content/70",children:"Design the next great challenge for our community."})]}),h.jsx("div",{className:"card bg-base-100/70 backdrop-blur-md shadow-lg border border-base-300/20 mb-8","data-aos":"fade-up",children:h.jsx("div",{className:"card-body",children:h.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"p-3 bg-secondary/10 text-secondary rounded-xl",children:[" ",h.jsx(Lz,{className:"w-6 h-6"})," "]}),h.jsxs("div",{children:[h.jsx("h2",{className:"card-title text-lg",children:"Quick Upload"}),h.jsx("p",{className:"text-base-content/60 text-sm",children:"Have a problem in JSON format? Upload it here."})]})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs(hr,{to:"/admin/problem/json-format",rel:"noopener noreferrer",className:"btn btn-info btn-outline btn-sm gap-2",children:[h.jsx(Lz,{className:"w-4 h-4"}),"View Format"]}),h.jsx("input",{type:"file",id:"json-upload",accept:".json",className:"hidden",onChange:x}),h.jsxs("label",{htmlFor:"json-upload",className:"btn btn-secondary btn-outline btn-sm gap-2 cursor-pointer",children:[h.jsx(nfe,{className:"w-4 h-4"})," Upload JSON"]})]})]})})}),h.jsxs("form",{onSubmit:a(y),className:"space-y-8",children:[h.jsx("div",{className:"card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20","data-aos":"fade-up","data-aos-delay":"100",children:h.jsxs("div",{className:"card-body space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-3 bg-primary/10 text-primary rounded-xl",children:h.jsx($V,{className:"w-6 h-6"})}),h.jsx("h2",{className:"card-title text-2xl",children:"Basic Information"})]}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Serial Number"})}),h.jsx("input",{...n("serial_number"),type:"number",className:"input input-bordered w-full",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Problem Title"})}),h.jsx("input",{...n("title"),type:"text",className:"input input-bordered w-full",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Difficulty"})}),h.jsxs("select",{...n("difficulty"),className:"select select-bordered w-full",children:[h.jsx("option",{children:"Easy"}),h.jsx("option",{children:"Medium"}),h.jsx("option",{children:"Hard"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Tags (comma-separated)"})}),h.jsx("input",{...n("tags"),type:"text",className:"input input-bordered w-full"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-center mt-2",children:[h.jsxs("div",{className:"form-control md:col-span-2 flex flex-col",children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Description"})}),h.jsx("textarea",{...n("description"),rows:6,className:"textarea textarea-bordered min-h-[150px]",required:!0})]}),h.jsxs("div",{className:"form-control md:self-center relative right-30",children:[h.jsxs("label",{className:"label cursor-pointer justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(WP,{className:"w-5 h-5 text-warning"}),h.jsx("span",{className:"label-text font-semibold",children:"Premium Problem"})]}),h.jsx("input",{...n("isprime"),type:"checkbox",className:"toggle toggle-primary"})]}),h.jsx("p",{className:"text-xs text-base-content/60 mt-1 pl-9",children:"If enabled, this will be for Pro users only."})]})]})]})}),h.jsx("div",{className:"card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20","data-aos":"fade-up",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsxs("h2",{className:"card-title text-xl flex items-center gap-2",children:[h.jsx(Qu,{className:"w-5 h-5 text-success"}),"Visible Testcases"]}),h.jsxs("button",{type:"button",className:"btn btn-success btn-sm gap-2",onClick:()=>c.append({input:"",output:"",explanation:""}),children:[h.jsx(Hl,{className:"w-4 h-4"}),"Add"]})]}),h.jsx("div",{className:"space-y-4",children:c.fields.map((w,_)=>h.jsxs("div",{className:"bg-base-200/50 p-4 rounded-lg",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsxs("span",{className:"font-medium text-sm",children:["Testcase #",_+1]}),h.jsx("button",{type:"button",className:"btn btn-ghost btn-xs text-error",onClick:()=>c.remove(_),children:h.jsx(Dc,{className:"w-4 h-4"})})]}),h.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[h.jsx("input",{...n(`visible_testcase.${_}.input`),className:"input input-bordered input-sm",placeholder:"Input",required:!0}),h.jsx("input",{...n(`visible_testcase.${_}.output`),className:"input input-bordered input-sm",placeholder:"Output",required:!0}),h.jsx("input",{...n(`visible_testcase.${_}.explanation`),className:"input input-bordered input-sm",placeholder:"Explanation"})]})]},w.id))})]})}),h.jsx("div",{className:"card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20","data-aos":"fade-up",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsxs("h2",{className:"card-title text-xl flex items-center gap-2",children:[h.jsx(QV,{className:"w-5 h-5 text-warning"}),"Hidden Testcases"]}),h.jsxs("button",{type:"button",className:"btn btn-warning btn-sm gap-2",onClick:()=>u.append({input:"",output:""}),children:[h.jsx(Hl,{className:"w-4 h-4"}),"Add"]})]}),h.jsx("div",{className:"space-y-4",children:u.fields.map((w,_)=>h.jsxs("div",{className:"bg-base-200/50 p-4 rounded-lg",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsxs("span",{className:"font-medium text-sm",children:["Hidden Testcase #",_+1]}),h.jsx("button",{type:"button",className:"btn btn-ghost btn-xs text-error",onClick:()=>u.remove(_),children:h.jsx(Dc,{className:"w-4 h-4"})})]}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[h.jsx("input",{...n(`hidden_testcase.${_}.input`),className:"input input-bordered input-sm",placeholder:"Input",required:!0}),h.jsx("input",{...n(`hidden_testcase.${_}.output`),className:"input input-bordered input-sm",placeholder:"Output",required:!0})]})]},w.id))})]})}),h.jsx("div",{className:"card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20","data-aos":"fade-up",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsxs("h2",{className:"card-title text-xl flex items-center gap-2",children:[h.jsx(sl,{className:"w-5 h-5 text-info"}),"Starter Code"]}),h.jsxs("button",{type:"button",className:"btn btn-info btn-sm gap-2",onClick:()=>d.append({language:"javascript",initial_code:""}),children:[h.jsx(Hl,{className:"w-4 h-4"}),"Add Language"]})]}),h.jsx("div",{className:"space-y-6",children:d.fields.map((w,_)=>h.jsxs("div",{className:"bg-base-200/50 p-4 rounded-lg",children:[h.jsxs("div",{className:"flex justify-between items-center mb-3",children:[h.jsxs("div",{className:"form-control w-full sm:w-1/3",children:[h.jsx("label",{className:"label text-sm",children:"Language"}),h.jsx("input",{...n(`start_code.${_}.language`),className:"input input-sm input-bordered",placeholder:"e.g., javascript",required:!0})]}),h.jsx("button",{type:"button",className:"btn btn-ghost btn-xs text-error",onClick:()=>d.remove(_),children:h.jsx(Dc,{className:"w-4 h-4"})})]}),h.jsx(oee,{control:s,name:`start_code.${_}.initial_code`,language:m[_]?.language,isDark:r})]},w.id))})]})}),h.jsx("div",{className:"card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20","data-aos":"fade-up",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsxs("h2",{className:"card-title text-xl flex items-center gap-2",children:[h.jsx(eU,{className:"w-5 h-5 text-secondary"}),"Reference Solutions"]}),h.jsxs("button",{type:"button",className:"btn btn-secondary btn-sm gap-2",onClick:()=>f.append({language:"javascript",complete_code:""}),children:[h.jsx(Hl,{className:"w-4 h-4"}),"Add Solution"]})]}),h.jsx("div",{className:"space-y-6",children:f.fields.map((w,_)=>h.jsxs("div",{className:"bg-base-200/50 p-4 rounded-lg",children:[h.jsxs("div",{className:"flex justify-between items-center mb-3",children:[h.jsxs("div",{className:"form-control w-full sm:w-1/3",children:[h.jsx("label",{className:"label text-sm",children:"Language"}),h.jsx("input",{...n(`problem_solution.${_}.language`),className:"input input-sm input-bordered",placeholder:"e.g., javascript",required:!0})]}),h.jsx("button",{type:"button",className:"btn btn-ghost btn-xs text-error",onClick:()=>f.remove(_),children:h.jsx(Dc,{className:"w-4 h-4"})})]}),h.jsx(oee,{control:s,name:`problem_solution.${_}.complete_code`,language:v[_]?.language,isDark:r})]},w.id))})]})}),h.jsxs("div",{className:"pt-6 flex justify-end gap-4","data-aos":"fade-up",children:[h.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>o(),children:"Reset Form"}),h.jsx("button",{type:"submit",className:"btn btn-primary btn-lg px-8 shadow-lg",children:"Create Problem"})]})]}),e&&h.jsx("div",{className:"toast toast-center toast-middle z-50",children:h.jsx("div",{className:`alert ${e.status==="success"?"alert-success":"alert-error"} shadow-lg`,children:h.jsx("span",{children:e.message})})})]})]})}const Yct=()=>{const[e,t]=O.useState([]),[r,i]=O.useState(""),[n,s]=O.useState([]),[a,o]=O.useState(!0),[l,c]=O.useState(null),[u,d]=O.useState("grid"),f=fs();O.useEffect(()=>{Hn.init({duration:800,once:!1})},[]),O.useEffect(()=>{(async()=>{try{o(!0);const _=(await jt.get("/problem/getAllProblem")).data.problem;t(_),c(null)}catch(w){c(w.message||"Failed to fetch problems."),console.error(w)}finally{o(!1)}})()},[]),O.useEffect(()=>{const x=r.toLowerCase(),w=e.filter(_=>{const S=_.title.toLowerCase().includes(x),P=String(_.serial_number).includes(x);return S||P});s(w)},[r,e]);const m=x=>{f(`/edit-problem/${x}`)},v=x=>{switch(x.toLowerCase()){case"easy":return"badge-success";case"medium":return"badge-warning";case"hard":return"badge-error";default:return"badge-neutral"}},y=()=>a?h.jsx("div",{className:"flex justify-center items-center min-h-[400px]","data-aos":"fade-in",children:h.jsxs("div",{className:"text-center space-y-4",children:[h.jsx("span",{className:"loading loading-spinner loading-lg text-primary"}),h.jsx("p",{className:"text-base-content/70",children:"Loading problems..."})]})}):l?h.jsxs("div",{className:"group relative","data-aos":"fade-up",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-error to-warning rounded-xl blur-sm opacity-20 group-hover:opacity-30 transition-all duration-300"}),h.jsx("div",{className:"relative alert alert-error shadow-xl bg-base-100/70 backdrop-blur-md border border-error/20",children:h.jsxs("div",{children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),h.jsx("span",{children:l})]})})]}):e.length>0&&n.length===0?h.jsxs("div",{className:"text-center py-16","data-aos":"fade-up",children:[h.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),h.jsx("h3",{className:"text-xl font-semibold mb-2 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"No problems match your search"}),h.jsx("p",{className:"text-base-content/60",children:"Try adjusting your search terms"})]}):n.length===0?h.jsxs("div",{className:"text-center py-16","data-aos":"fade-up",children:[h.jsx("div",{className:"text-6xl mb-4",children:"📝"}),h.jsx("h3",{className:"text-xl font-semibold mb-2 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"No problems found"}),h.jsx("p",{className:"text-base-content/60",children:"Start by adding your first problem"})]}):u==="grid"?h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:n.map((x,w)=>h.jsxs("div",{className:"group relative","data-aos":"fade-up","data-aos-delay":w*50,children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-secondary rounded-xl blur-sm opacity-10 group-hover:opacity-30 transition-all duration-300"}),h.jsx("div",{className:"relative card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20 transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"flex items-start justify-between mb-3",children:[h.jsxs("div",{className:"badge badge-outline badge-lg font-bold bg-primary/10 text-primary border-primary/20",children:["#",x.serial_number]}),h.jsx("div",{className:`badge ${v(x.difficulty)} badge-lg font-semibold shadow-sm`,children:x.difficulty})]}),h.jsx("h2",{className:"card-title text-lg mb-3 line-clamp-2 bg-gradient-to-r from-base-content to-base-content/80 bg-clip-text",children:x.title}),h.jsxs("div",{className:"mb-4",children:[h.jsx("div",{className:"text-sm text-base-content/70 mb-2 font-medium",children:"Tags:"}),h.jsx("div",{className:"flex flex-wrap gap-1",children:x.tags.split(",").map((_,S)=>h.jsx("span",{className:"badge badge-ghost badge-sm bg-base-200/50 backdrop-blur-sm border border-base-300/20",children:_.trim()},S))})]}),h.jsx("div",{className:"card-actions justify-end",children:h.jsxs("button",{className:"btn btn-primary btn-sm gap-2 bg-gradient-to-r from-primary to-secondary border-none text-white",onClick:()=>m(x._id),children:[h.jsx(ZJ,{size:14}),"Edit"]})})]})})]},x._id))}):h.jsxs("div",{className:"group relative","data-aos":"fade-up",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-accent rounded-xl blur-sm opacity-10 group-hover:opacity-20 transition-all duration-300"}),h.jsx("div",{className:"relative card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20",children:h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"table table-zebra w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-base-200/50 backdrop-blur-sm",children:[h.jsx("th",{className:"font-bold text-base-content",children:"S.No."}),h.jsx("th",{className:"font-bold text-base-content",children:"Title"}),h.jsx("th",{className:"font-bold text-base-content",children:"Difficulty"}),h.jsx("th",{className:"font-bold text-base-content",children:"Tags"}),h.jsx("th",{className:"font-bold text-base-content",children:"Actions"})]})}),h.jsx("tbody",{children:n.map((x,w)=>h.jsxs("tr",{className:"hover:bg-base-200/30 transition-colors duration-200",children:[h.jsxs("td",{className:"font-bold text-primary",children:["#",x.serial_number]}),h.jsx("td",{className:"font-semibold max-w-md",children:h.jsx("div",{className:"truncate",children:x.title})}),h.jsx("td",{children:h.jsx("div",{className:`badge ${v(x.difficulty)} font-semibold shadow-sm`,children:x.difficulty})}),h.jsx("td",{children:h.jsxs("div",{className:"flex flex-wrap gap-1 max-w-xs",children:[x.tags.split(",").slice(0,3).map((_,S)=>h.jsx("span",{className:"badge badge-ghost badge-sm bg-base-200/50 backdrop-blur-sm border border-base-300/20",children:_.trim()},S)),x.tags.split(",").length>3&&h.jsxs("span",{className:"badge badge-ghost badge-sm bg-accent/10 text-accent",children:["+",x.tags.split(",").length-3]})]})}),h.jsx("td",{children:h.jsxs("button",{className:"btn btn-primary btn-sm gap-2 bg-gradient-to-r from-primary to-secondary border-none text-white",onClick:()=>m(x._id),children:[h.jsx(ZJ,{size:14}),"Edit"]})})]},x._id))})]})})})]});return h.jsxs("div",{className:"relative min-h-screen bg-base-100 p-4 sm:p-8 overflow-hidden",children:[h.jsx("div",{className:"fixed inset-0 z-0 pointer-events-none from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-4 transition-colors"}),h.jsxs("div",{className:"absolute inset-0 z-0 pointer-events-none",children:[h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1}),h.jsx("div",{className:"absolute bottom-0 left-[-20%] right-0 top-[-10%] h-[500px] w-[500px] rounded-full bg-[radial-gradient(circle_farthest-side,rgba(var(--color-primary),0.1),transparent)]"}),h.jsx("div",{className:"absolute bottom-0 right-[-20%] top-[-10%] h-[500px] w-[500px] rounded-full bg-[radial-gradient(circle_farthest-side,rgba(var(--color-accent),0.1),transparent)]"})]}),h.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto space-y-8",children:[h.jsxs("div",{className:"text-center space-y-4 pt-10","data-aos":"fade-down",children:[h.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent",children:"📚 Problems Hub"}),h.jsx(LD,{texts:["Manage your problem collection","Organize coding challenges","Edit and update problems","Build your coding library"],mainClassName:"text-base-content/70 font-medium text-base sm:text-lg flex justify-center",staggerDuration:.03,rotationInterval:4e3}),h.jsx("div",{className:"mt-6 inline-block","data-aos":"fade-up","data-aos-delay":"200",children:h.jsxs("div",{className:"group relative",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-secondary rounded-xl blur-sm opacity-20 group-hover:opacity-40 transition-all duration-300"}),h.jsxs("div",{className:"relative bg-base-100/70 backdrop-blur-md px-6 py-4 rounded-xl shadow-xl border border-base-300/20",children:[h.jsx("div",{className:"text-sm text-base-content/70 font-medium",children:"Total Problems"}),h.jsx("div",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent mt-1",children:h.jsx(_c,{from:0,to:e.length,separator:",",direction:"up",duration:2,className:"count-up-text"})})]})]})})]}),h.jsxs("div",{className:"group relative","data-aos":"fade-up","data-aos-delay":"100",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-info to-primary rounded-xl blur-sm opacity-10 group-hover:opacity-20 transition-all duration-300"}),h.jsx("div",{className:"relative card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20",children:h.jsx("div",{className:"card-body",children:h.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[h.jsx("div",{className:"form-control w-full max-w-md",children:h.jsxs("div",{className:"relative w-full",children:[h.jsx(Wh,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-base-content/50"}),h.jsx("input",{type:"text",placeholder:"Search by title or number...",className:"input input-bordered w-full pl-10 bg-base-100/50 backdrop-blur-sm border-base-300/20 focus:border-primary/50",value:r,onChange:x=>i(x.target.value)})]})}),h.jsx("div",{className:"flex gap-2",children:h.jsxs("div",{className:"join",children:[h.jsxs("button",{className:`btn join-item gap-2 ${u==="grid"?"btn-primary bg-gradient-to-r from-primary to-secondary border-none text-white":"btn-outline"}`,onClick:()=>d("grid"),children:[h.jsx(OD,{size:16}),"Grid"]}),h.jsxs("button",{className:`btn join-item gap-2 ${u==="table"?"btn-primary bg-gradient-to-r from-primary to-secondary border-none text-white":"btn-outline"}`,onClick:()=>d("table"),children:[h.jsx(Eh,{size:16}),"Table"]})]})})]})})})]}),h.jsx("main",{children:y()})]})]})};function lee(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function BD(...e){return t=>{let r=!1;const i=e.map(n=>{const s=lee(n,t);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let n=0;n<i.length;n++){const s=i[n];typeof s=="function"?s():lee(e[n],null)}}}}function fn(...e){return O.useCallback(BD(...e),e)}function Ix(e){const t=Xct(e),r=O.forwardRef((i,n)=>{const{children:s,...a}=i,o=O.Children.toArray(s),l=o.find(Kct);if(l){const c=l.props.children,u=o.map(d=>d===l?O.Children.count(c)>1?O.Children.only(null):O.isValidElement(c)?c.props.children:null:d);return h.jsx(t,{...a,ref:n,children:O.isValidElement(c)?O.cloneElement(c,void 0,u):null})}return h.jsx(t,{...a,ref:n,children:s})});return r.displayName=`${e}.Slot`,r}var Efe=Ix("Slot");function Xct(e){const t=O.forwardRef((r,i)=>{const{children:n,...s}=r;if(O.isValidElement(n)){const a=Zct(n),o=Qct(s,n.props);return n.type!==O.Fragment&&(o.ref=i?BD(i,a):a),O.cloneElement(n,o)}return O.Children.count(n)>1?O.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var $ct=Symbol("radix.slottable");function Kct(e){return O.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===$ct}function Qct(e,t){const r={...t};for(const i in t){const n=e[i],s=t[i];/^on[A-Z]/.test(i)?n&&s?r[i]=(...o)=>{const l=s(...o);return n(...o),l}:n&&(r[i]=n):i==="style"?r[i]={...n,...s}:i==="className"&&(r[i]=[n,s].filter(Boolean).join(" "))}return{...e,...r}}function Zct(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function Afe(e){var t,r,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=Afe(e[t]))&&(i&&(i+=" "),i+=r)}else for(r in e)e[r]&&(i&&(i+=" "),i+=r);return i}function Cfe(){for(var e,t,r=0,i="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=Afe(e))&&(i&&(i+=" "),i+=t);return i}const cee=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,uee=Cfe,Tfe=(e,t)=>r=>{var i;if(t?.variants==null)return uee(e,r?.class,r?.className);const{variants:n,defaultVariants:s}=t,a=Object.keys(n).map(c=>{const u=r?.[c],d=s?.[c];if(u===null)return null;const f=cee(u)||cee(d);return n[c][f]}),o=r&&Object.entries(r).reduce((c,u)=>{let[d,f]=u;return f===void 0||(c[d]=f),c},{}),l=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((c,u)=>{let{class:d,className:f,...m}=u;return Object.entries(m).every(v=>{let[y,x]=v;return Array.isArray(x)?x.includes({...s,...o}[y]):{...s,...o}[y]===x})?[...c,d,f]:c},[]);return uee(e,a,l,r?.class,r?.className)},rU="-",Jct=e=>{const t=tut(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:a=>{const o=a.split(rU);return o[0]===""&&o.length!==1&&o.shift(),Mfe(o,t)||eut(a)},getConflictingClassGroupIds:(a,o)=>{const l=r[a]||[];return o&&i[a]?[...l,...i[a]]:l}}},Mfe=(e,t)=>{if(e.length===0)return t.classGroupId;const r=e[0],i=t.nextPart.get(r),n=i?Mfe(e.slice(1),i):void 0;if(n)return n;if(t.validators.length===0)return;const s=e.join(rU);return t.validators.find(({validator:a})=>a(s))?.classGroupId},dee=/^\[(.+)\]$/,eut=e=>{if(dee.test(e)){const t=dee.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},tut=e=>{const{theme:t,classGroups:r}=e,i={nextPart:new Map,validators:[]};for(const n in r)Gz(r[n],i,n,t);return i},Gz=(e,t,r,i)=>{e.forEach(n=>{if(typeof n=="string"){const s=n===""?t:hee(t,n);s.classGroupId=r;return}if(typeof n=="function"){if(rut(n)){Gz(n(i),t,r,i);return}t.validators.push({validator:n,classGroupId:r});return}Object.entries(n).forEach(([s,a])=>{Gz(a,hee(t,s),r,i)})})},hee=(e,t)=>{let r=e;return t.split(rU).forEach(i=>{r.nextPart.has(i)||r.nextPart.set(i,{nextPart:new Map,validators:[]}),r=r.nextPart.get(i)}),r},rut=e=>e.isThemeGetter,iut=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,i=new Map;const n=(s,a)=>{r.set(s,a),t++,t>e&&(t=0,i=r,r=new Map)};return{get(s){let a=r.get(s);if(a!==void 0)return a;if((a=i.get(s))!==void 0)return n(s,a),a},set(s,a){r.has(s)?r.set(s,a):n(s,a)}}},Wz="!",qz=":",nut=qz.length,sut=e=>{const{prefix:t,experimentalParseClassName:r}=e;let i=n=>{const s=[];let a=0,o=0,l=0,c;for(let v=0;v<n.length;v++){let y=n[v];if(a===0&&o===0){if(y===qz){s.push(n.slice(l,v)),l=v+nut;continue}if(y==="/"){c=v;continue}}y==="["?a++:y==="]"?a--:y==="("?o++:y===")"&&o--}const u=s.length===0?n:n.substring(l),d=aut(u),f=d!==u,m=c&&c>l?c-l:void 0;return{modifiers:s,hasImportantModifier:f,baseClassName:d,maybePostfixModifierPosition:m}};if(t){const n=t+qz,s=i;i=a=>a.startsWith(n)?s(a.substring(n.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(r){const n=i;i=s=>r({className:s,parseClassName:n})}return i},aut=e=>e.endsWith(Wz)?e.substring(0,e.length-1):e.startsWith(Wz)?e.substring(1):e,out=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(i=>[i,!0]));return i=>{if(i.length<=1)return i;const n=[];let s=[];return i.forEach(a=>{a[0]==="["||t[a]?(n.push(...s.sort(),a),s=[]):s.push(a)}),n.push(...s.sort()),n}},lut=e=>({cache:iut(e.cacheSize),parseClassName:sut(e),sortModifiers:out(e),...Jct(e)}),cut=/\s+/,uut=(e,t)=>{const{parseClassName:r,getClassGroupId:i,getConflictingClassGroupIds:n,sortModifiers:s}=t,a=[],o=e.trim().split(cut);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{isExternal:d,modifiers:f,hasImportantModifier:m,baseClassName:v,maybePostfixModifierPosition:y}=r(u);if(d){l=u+(l.length>0?" "+l:l);continue}let x=!!y,w=i(x?v.substring(0,y):v);if(!w){if(!x){l=u+(l.length>0?" "+l:l);continue}if(w=i(v),!w){l=u+(l.length>0?" "+l:l);continue}x=!1}const _=s(f).join(":"),S=m?_+Wz:_,P=S+w;if(a.includes(P))continue;a.push(P);const M=n(w,x);for(let C=0;C<M.length;++C){const T=M[C];a.push(S+T)}l=u+(l.length>0?" "+l:l)}return l};function dut(){let e=0,t,r,i="";for(;e<arguments.length;)(t=arguments[e++])&&(r=Pfe(t))&&(i&&(i+=" "),i+=r);return i}const Pfe=e=>{if(typeof e=="string")return e;let t,r="";for(let i=0;i<e.length;i++)e[i]&&(t=Pfe(e[i]))&&(r&&(r+=" "),r+=t);return r};function hut(e,...t){let r,i,n,s=a;function a(l){const c=t.reduce((u,d)=>d(u),e());return r=lut(c),i=r.cache.get,n=r.cache.set,s=o,o(l)}function o(l){const c=i(l);if(c)return c;const u=uut(l,r);return n(l,u),u}return function(){return s(dut.apply(null,arguments))}}const ws=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},Dfe=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Nfe=/^\((?:(\w[\w-]*):)?(.+)\)$/i,fut=/^\d+\/\d+$/,put=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,mut=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,gut=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,vut=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,yut=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Wv=e=>fut.test(e),Fr=e=>!!e&&!Number.isNaN(Number(e)),Uf=e=>!!e&&Number.isInteger(Number(e)),SO=e=>e.endsWith("%")&&Fr(e.slice(0,-1)),Qd=e=>put.test(e),xut=()=>!0,but=e=>mut.test(e)&&!gut.test(e),kfe=()=>!1,wut=e=>vut.test(e),_ut=e=>yut.test(e),Sut=e=>!Bt(e)&&!Ft(e),Eut=e=>xb(e,Ofe,kfe),Bt=e=>Dfe.test(e),Wm=e=>xb(e,jfe,but),EO=e=>xb(e,Put,Fr),fee=e=>xb(e,Rfe,kfe),Aut=e=>xb(e,Ife,_ut),DC=e=>xb(e,Lfe,wut),Ft=e=>Nfe.test(e),aw=e=>bb(e,jfe),Cut=e=>bb(e,Dut),pee=e=>bb(e,Rfe),Tut=e=>bb(e,Ofe),Mut=e=>bb(e,Ife),NC=e=>bb(e,Lfe,!0),xb=(e,t,r)=>{const i=Dfe.exec(e);return i?i[1]?t(i[1]):r(i[2]):!1},bb=(e,t,r=!1)=>{const i=Nfe.exec(e);return i?i[1]?t(i[1]):r:!1},Rfe=e=>e==="position"||e==="percentage",Ife=e=>e==="image"||e==="url",Ofe=e=>e==="length"||e==="size"||e==="bg-size",jfe=e=>e==="length",Put=e=>e==="number",Dut=e=>e==="family-name",Lfe=e=>e==="shadow",Nut=()=>{const e=ws("color"),t=ws("font"),r=ws("text"),i=ws("font-weight"),n=ws("tracking"),s=ws("leading"),a=ws("breakpoint"),o=ws("container"),l=ws("spacing"),c=ws("radius"),u=ws("shadow"),d=ws("inset-shadow"),f=ws("text-shadow"),m=ws("drop-shadow"),v=ws("blur"),y=ws("perspective"),x=ws("aspect"),w=ws("ease"),_=ws("animate"),S=()=>["auto","avoid","all","avoid-page","page","left","right","column"],P=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],M=()=>[...P(),Ft,Bt],C=()=>["auto","hidden","clip","visible","scroll"],T=()=>["auto","contain","none"],E=()=>[Ft,Bt,l],N=()=>[Wv,"full","auto",...E()],D=()=>[Uf,"none","subgrid",Ft,Bt],I=()=>["auto",{span:["full",Uf,Ft,Bt]},Uf,Ft,Bt],j=()=>[Uf,"auto",Ft,Bt],L=()=>["auto","min","max","fr",Ft,Bt],B=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],q=()=>["start","end","center","stretch","center-safe","end-safe"],G=()=>["auto",...E()],Y=()=>[Wv,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...E()],X=()=>[e,Ft,Bt],re=()=>[...P(),pee,fee,{position:[Ft,Bt]}],F=()=>["no-repeat",{repeat:["","x","y","space","round"]}],$=()=>["auto","cover","contain",Tut,Eut,{size:[Ft,Bt]}],se=()=>[SO,aw,Wm],H=()=>["","none","full",c,Ft,Bt],ne=()=>["",Fr,aw,Wm],ce=()=>["solid","dashed","dotted","double"],ie=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ae=()=>[Fr,SO,pee,fee],Z=()=>["","none",v,Ft,Bt],fe=()=>["none",Fr,Ft,Bt],he=()=>["none",Fr,Ft,Bt],Ae=()=>[Fr,Ft,Bt],xe=()=>[Wv,"full",...E()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Qd],breakpoint:[Qd],color:[xut],container:[Qd],"drop-shadow":[Qd],ease:["in","out","in-out"],font:[Sut],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Qd],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Qd],shadow:[Qd],spacing:["px",Fr],text:[Qd],"text-shadow":[Qd],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Wv,Bt,Ft,x]}],container:["container"],columns:[{columns:[Fr,Bt,Ft,o]}],"break-after":[{"break-after":S()}],"break-before":[{"break-before":S()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:M()}],overflow:[{overflow:C()}],"overflow-x":[{"overflow-x":C()}],"overflow-y":[{"overflow-y":C()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:N()}],"inset-x":[{"inset-x":N()}],"inset-y":[{"inset-y":N()}],start:[{start:N()}],end:[{end:N()}],top:[{top:N()}],right:[{right:N()}],bottom:[{bottom:N()}],left:[{left:N()}],visibility:["visible","invisible","collapse"],z:[{z:[Uf,"auto",Ft,Bt]}],basis:[{basis:[Wv,"full","auto",o,...E()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Fr,Wv,"auto","initial","none",Bt]}],grow:[{grow:["",Fr,Ft,Bt]}],shrink:[{shrink:["",Fr,Ft,Bt]}],order:[{order:[Uf,"first","last","none",Ft,Bt]}],"grid-cols":[{"grid-cols":D()}],"col-start-end":[{col:I()}],"col-start":[{"col-start":j()}],"col-end":[{"col-end":j()}],"grid-rows":[{"grid-rows":D()}],"row-start-end":[{row:I()}],"row-start":[{"row-start":j()}],"row-end":[{"row-end":j()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":L()}],"auto-rows":[{"auto-rows":L()}],gap:[{gap:E()}],"gap-x":[{"gap-x":E()}],"gap-y":[{"gap-y":E()}],"justify-content":[{justify:[...B(),"normal"]}],"justify-items":[{"justify-items":[...q(),"normal"]}],"justify-self":[{"justify-self":["auto",...q()]}],"align-content":[{content:["normal",...B()]}],"align-items":[{items:[...q(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...q(),{baseline:["","last"]}]}],"place-content":[{"place-content":B()}],"place-items":[{"place-items":[...q(),"baseline"]}],"place-self":[{"place-self":["auto",...q()]}],p:[{p:E()}],px:[{px:E()}],py:[{py:E()}],ps:[{ps:E()}],pe:[{pe:E()}],pt:[{pt:E()}],pr:[{pr:E()}],pb:[{pb:E()}],pl:[{pl:E()}],m:[{m:G()}],mx:[{mx:G()}],my:[{my:G()}],ms:[{ms:G()}],me:[{me:G()}],mt:[{mt:G()}],mr:[{mr:G()}],mb:[{mb:G()}],ml:[{ml:G()}],"space-x":[{"space-x":E()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":E()}],"space-y-reverse":["space-y-reverse"],size:[{size:Y()}],w:[{w:[o,"screen",...Y()]}],"min-w":[{"min-w":[o,"screen","none",...Y()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...Y()]}],h:[{h:["screen","lh",...Y()]}],"min-h":[{"min-h":["screen","lh","none",...Y()]}],"max-h":[{"max-h":["screen","lh",...Y()]}],"font-size":[{text:["base",r,aw,Wm]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[i,Ft,EO]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",SO,Bt]}],"font-family":[{font:[Cut,Bt,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,Ft,Bt]}],"line-clamp":[{"line-clamp":[Fr,"none",Ft,EO]}],leading:[{leading:[s,...E()]}],"list-image":[{"list-image":["none",Ft,Bt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ft,Bt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:X()}],"text-color":[{text:X()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ce(),"wavy"]}],"text-decoration-thickness":[{decoration:[Fr,"from-font","auto",Ft,Wm]}],"text-decoration-color":[{decoration:X()}],"underline-offset":[{"underline-offset":[Fr,"auto",Ft,Bt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:E()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ft,Bt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ft,Bt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:re()}],"bg-repeat":[{bg:F()}],"bg-size":[{bg:$()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Uf,Ft,Bt],radial:["",Ft,Bt],conic:[Uf,Ft,Bt]},Mut,Aut]}],"bg-color":[{bg:X()}],"gradient-from-pos":[{from:se()}],"gradient-via-pos":[{via:se()}],"gradient-to-pos":[{to:se()}],"gradient-from":[{from:X()}],"gradient-via":[{via:X()}],"gradient-to":[{to:X()}],rounded:[{rounded:H()}],"rounded-s":[{"rounded-s":H()}],"rounded-e":[{"rounded-e":H()}],"rounded-t":[{"rounded-t":H()}],"rounded-r":[{"rounded-r":H()}],"rounded-b":[{"rounded-b":H()}],"rounded-l":[{"rounded-l":H()}],"rounded-ss":[{"rounded-ss":H()}],"rounded-se":[{"rounded-se":H()}],"rounded-ee":[{"rounded-ee":H()}],"rounded-es":[{"rounded-es":H()}],"rounded-tl":[{"rounded-tl":H()}],"rounded-tr":[{"rounded-tr":H()}],"rounded-br":[{"rounded-br":H()}],"rounded-bl":[{"rounded-bl":H()}],"border-w":[{border:ne()}],"border-w-x":[{"border-x":ne()}],"border-w-y":[{"border-y":ne()}],"border-w-s":[{"border-s":ne()}],"border-w-e":[{"border-e":ne()}],"border-w-t":[{"border-t":ne()}],"border-w-r":[{"border-r":ne()}],"border-w-b":[{"border-b":ne()}],"border-w-l":[{"border-l":ne()}],"divide-x":[{"divide-x":ne()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ne()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ce(),"hidden","none"]}],"divide-style":[{divide:[...ce(),"hidden","none"]}],"border-color":[{border:X()}],"border-color-x":[{"border-x":X()}],"border-color-y":[{"border-y":X()}],"border-color-s":[{"border-s":X()}],"border-color-e":[{"border-e":X()}],"border-color-t":[{"border-t":X()}],"border-color-r":[{"border-r":X()}],"border-color-b":[{"border-b":X()}],"border-color-l":[{"border-l":X()}],"divide-color":[{divide:X()}],"outline-style":[{outline:[...ce(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Fr,Ft,Bt]}],"outline-w":[{outline:["",Fr,aw,Wm]}],"outline-color":[{outline:X()}],shadow:[{shadow:["","none",u,NC,DC]}],"shadow-color":[{shadow:X()}],"inset-shadow":[{"inset-shadow":["none",d,NC,DC]}],"inset-shadow-color":[{"inset-shadow":X()}],"ring-w":[{ring:ne()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:X()}],"ring-offset-w":[{"ring-offset":[Fr,Wm]}],"ring-offset-color":[{"ring-offset":X()}],"inset-ring-w":[{"inset-ring":ne()}],"inset-ring-color":[{"inset-ring":X()}],"text-shadow":[{"text-shadow":["none",f,NC,DC]}],"text-shadow-color":[{"text-shadow":X()}],opacity:[{opacity:[Fr,Ft,Bt]}],"mix-blend":[{"mix-blend":[...ie(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ie()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Fr]}],"mask-image-linear-from-pos":[{"mask-linear-from":ae()}],"mask-image-linear-to-pos":[{"mask-linear-to":ae()}],"mask-image-linear-from-color":[{"mask-linear-from":X()}],"mask-image-linear-to-color":[{"mask-linear-to":X()}],"mask-image-t-from-pos":[{"mask-t-from":ae()}],"mask-image-t-to-pos":[{"mask-t-to":ae()}],"mask-image-t-from-color":[{"mask-t-from":X()}],"mask-image-t-to-color":[{"mask-t-to":X()}],"mask-image-r-from-pos":[{"mask-r-from":ae()}],"mask-image-r-to-pos":[{"mask-r-to":ae()}],"mask-image-r-from-color":[{"mask-r-from":X()}],"mask-image-r-to-color":[{"mask-r-to":X()}],"mask-image-b-from-pos":[{"mask-b-from":ae()}],"mask-image-b-to-pos":[{"mask-b-to":ae()}],"mask-image-b-from-color":[{"mask-b-from":X()}],"mask-image-b-to-color":[{"mask-b-to":X()}],"mask-image-l-from-pos":[{"mask-l-from":ae()}],"mask-image-l-to-pos":[{"mask-l-to":ae()}],"mask-image-l-from-color":[{"mask-l-from":X()}],"mask-image-l-to-color":[{"mask-l-to":X()}],"mask-image-x-from-pos":[{"mask-x-from":ae()}],"mask-image-x-to-pos":[{"mask-x-to":ae()}],"mask-image-x-from-color":[{"mask-x-from":X()}],"mask-image-x-to-color":[{"mask-x-to":X()}],"mask-image-y-from-pos":[{"mask-y-from":ae()}],"mask-image-y-to-pos":[{"mask-y-to":ae()}],"mask-image-y-from-color":[{"mask-y-from":X()}],"mask-image-y-to-color":[{"mask-y-to":X()}],"mask-image-radial":[{"mask-radial":[Ft,Bt]}],"mask-image-radial-from-pos":[{"mask-radial-from":ae()}],"mask-image-radial-to-pos":[{"mask-radial-to":ae()}],"mask-image-radial-from-color":[{"mask-radial-from":X()}],"mask-image-radial-to-color":[{"mask-radial-to":X()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":P()}],"mask-image-conic-pos":[{"mask-conic":[Fr]}],"mask-image-conic-from-pos":[{"mask-conic-from":ae()}],"mask-image-conic-to-pos":[{"mask-conic-to":ae()}],"mask-image-conic-from-color":[{"mask-conic-from":X()}],"mask-image-conic-to-color":[{"mask-conic-to":X()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:re()}],"mask-repeat":[{mask:F()}],"mask-size":[{mask:$()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ft,Bt]}],filter:[{filter:["","none",Ft,Bt]}],blur:[{blur:Z()}],brightness:[{brightness:[Fr,Ft,Bt]}],contrast:[{contrast:[Fr,Ft,Bt]}],"drop-shadow":[{"drop-shadow":["","none",m,NC,DC]}],"drop-shadow-color":[{"drop-shadow":X()}],grayscale:[{grayscale:["",Fr,Ft,Bt]}],"hue-rotate":[{"hue-rotate":[Fr,Ft,Bt]}],invert:[{invert:["",Fr,Ft,Bt]}],saturate:[{saturate:[Fr,Ft,Bt]}],sepia:[{sepia:["",Fr,Ft,Bt]}],"backdrop-filter":[{"backdrop-filter":["","none",Ft,Bt]}],"backdrop-blur":[{"backdrop-blur":Z()}],"backdrop-brightness":[{"backdrop-brightness":[Fr,Ft,Bt]}],"backdrop-contrast":[{"backdrop-contrast":[Fr,Ft,Bt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Fr,Ft,Bt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Fr,Ft,Bt]}],"backdrop-invert":[{"backdrop-invert":["",Fr,Ft,Bt]}],"backdrop-opacity":[{"backdrop-opacity":[Fr,Ft,Bt]}],"backdrop-saturate":[{"backdrop-saturate":[Fr,Ft,Bt]}],"backdrop-sepia":[{"backdrop-sepia":["",Fr,Ft,Bt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":E()}],"border-spacing-x":[{"border-spacing-x":E()}],"border-spacing-y":[{"border-spacing-y":E()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ft,Bt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Fr,"initial",Ft,Bt]}],ease:[{ease:["linear","initial",w,Ft,Bt]}],delay:[{delay:[Fr,Ft,Bt]}],animate:[{animate:["none",_,Ft,Bt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[y,Ft,Bt]}],"perspective-origin":[{"perspective-origin":M()}],rotate:[{rotate:fe()}],"rotate-x":[{"rotate-x":fe()}],"rotate-y":[{"rotate-y":fe()}],"rotate-z":[{"rotate-z":fe()}],scale:[{scale:he()}],"scale-x":[{"scale-x":he()}],"scale-y":[{"scale-y":he()}],"scale-z":[{"scale-z":he()}],"scale-3d":["scale-3d"],skew:[{skew:Ae()}],"skew-x":[{"skew-x":Ae()}],"skew-y":[{"skew-y":Ae()}],transform:[{transform:[Ft,Bt,"","none","gpu","cpu"]}],"transform-origin":[{origin:M()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:xe()}],"translate-x":[{"translate-x":xe()}],"translate-y":[{"translate-y":xe()}],"translate-z":[{"translate-z":xe()}],"translate-none":["translate-none"],accent:[{accent:X()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:X()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ft,Bt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":E()}],"scroll-mx":[{"scroll-mx":E()}],"scroll-my":[{"scroll-my":E()}],"scroll-ms":[{"scroll-ms":E()}],"scroll-me":[{"scroll-me":E()}],"scroll-mt":[{"scroll-mt":E()}],"scroll-mr":[{"scroll-mr":E()}],"scroll-mb":[{"scroll-mb":E()}],"scroll-ml":[{"scroll-ml":E()}],"scroll-p":[{"scroll-p":E()}],"scroll-px":[{"scroll-px":E()}],"scroll-py":[{"scroll-py":E()}],"scroll-ps":[{"scroll-ps":E()}],"scroll-pe":[{"scroll-pe":E()}],"scroll-pt":[{"scroll-pt":E()}],"scroll-pr":[{"scroll-pr":E()}],"scroll-pb":[{"scroll-pb":E()}],"scroll-pl":[{"scroll-pl":E()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ft,Bt]}],fill:[{fill:["none",...X()]}],"stroke-w":[{stroke:[Fr,aw,Wm,EO]}],stroke:[{stroke:["none",...X()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},kut=hut(Nut);function Nn(...e){return kut(Cfe(e))}const Rut=Tfe("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function Fn({className:e,variant:t,size:r,asChild:i=!1,...n}){const s=i?Efe:"button";return h.jsx(s,{"data-slot":"button",className:Nn(Rut({variant:t,size:r,className:e})),...n})}function kp({className:e,...t}){return h.jsx("div",{"data-slot":"card",className:Nn("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function f_({className:e,...t}){return h.jsx("div",{"data-slot":"card-header",className:Nn("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function FD({className:e,...t}){return h.jsx("div",{"data-slot":"card-title",className:Nn("leading-none font-semibold",e),...t})}function VD({className:e,...t}){return h.jsx("div",{"data-slot":"card-description",className:Nn("text-muted-foreground text-sm",e),...t})}function pS({className:e,...t}){return h.jsx("div",{"data-slot":"card-content",className:Nn("px-6",e),...t})}function BT({className:e,type:t,...r}){return h.jsx("input",{type:t,"data-slot":"input",className:Nn("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...r})}var mS=Kte();const Iut=d0(mS);var Out=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],di=Out.reduce((e,t)=>{const r=Ix(`Primitive.${t}`),i=O.forwardRef((n,s)=>{const{asChild:a,...o}=n,l=a?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(l,{...o,ref:s})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function zfe(e,t){e&&mS.flushSync(()=>e.dispatchEvent(t))}var jut="Label",Bfe=O.forwardRef((e,t)=>h.jsx(di.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Bfe.displayName=jut;var Lut=Bfe;function Fl({className:e,...t}){return h.jsx(Lut,{"data-slot":"label",className:Nn("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}function Qy({className:e,...t}){return h.jsx("textarea",{"data-slot":"textarea",className:Nn("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}function mee(e,[t,r]){return Math.min(r,Math.max(t,e))}function ir(e,t,{checkForDefaultPrevented:r=!0}={}){return function(n){if(e?.(n),r===!1||!n.defaultPrevented)return t?.(n)}}function S0(e,t=[]){let r=[];function i(s,a){const o=O.createContext(a),l=r.length;r=[...r,a];const c=d=>{const{scope:f,children:m,...v}=d,y=f?.[e]?.[l]||o,x=O.useMemo(()=>v,Object.values(v));return h.jsx(y.Provider,{value:x,children:m})};c.displayName=s+"Provider";function u(d,f){const m=f?.[e]?.[l]||o,v=O.useContext(m);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const n=()=>{const s=r.map(a=>O.createContext(a));return function(o){const l=o?.[e]||s;return O.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return n.scopeName=e,[i,zut(n,...t)]}function zut(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const i=e.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(s){const a=i.reduce((o,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...o,...d}},{});return O.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}function iU(e){const t=e+"CollectionProvider",[r,i]=S0(t),[n,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),a=y=>{const{scope:x,children:w}=y,_=Ot.useRef(null),S=Ot.useRef(new Map).current;return h.jsx(n,{scope:x,itemMap:S,collectionRef:_,children:w})};a.displayName=t;const o=e+"CollectionSlot",l=Ix(o),c=Ot.forwardRef((y,x)=>{const{scope:w,children:_}=y,S=s(o,w),P=fn(x,S.collectionRef);return h.jsx(l,{ref:P,children:_})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",f=Ix(u),m=Ot.forwardRef((y,x)=>{const{scope:w,children:_,...S}=y,P=Ot.useRef(null),M=fn(x,P),C=s(u,w);return Ot.useEffect(()=>(C.itemMap.set(P,{ref:P,...S}),()=>void C.itemMap.delete(P))),h.jsx(f,{[d]:"",ref:M,children:_})});m.displayName=u;function v(y){const x=s(e+"CollectionConsumer",y);return Ot.useCallback(()=>{const _=x.collectionRef.current;if(!_)return[];const S=Array.from(_.querySelectorAll(`[${d}]`));return Array.from(x.itemMap.values()).sort((C,T)=>S.indexOf(C.ref.current)-S.indexOf(T.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},v,i]}var But=O.createContext(void 0);function UD(e){const t=O.useContext(But);return e||t||"ltr"}function ld(e){const t=O.useRef(e);return O.useEffect(()=>{t.current=e}),O.useMemo(()=>(...r)=>t.current?.(...r),[])}function Fut(e,t=globalThis?.document){const r=ld(e);O.useEffect(()=>{const i=n=>{n.key==="Escape"&&r(n)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[r,t])}var Vut="DismissableLayer",Yz="dismissableLayer.update",Uut="dismissableLayer.pointerDownOutside",Hut="dismissableLayer.focusOutside",gee,Ffe=O.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),nU=O.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:n,onFocusOutside:s,onInteractOutside:a,onDismiss:o,...l}=e,c=O.useContext(Ffe),[u,d]=O.useState(null),f=u?.ownerDocument??globalThis?.document,[,m]=O.useState({}),v=fn(t,T=>d(T)),y=Array.from(c.layers),[x]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),w=y.indexOf(x),_=u?y.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,P=_>=w,M=qut(T=>{const E=T.target,N=[...c.branches].some(D=>D.contains(E));!P||N||(n?.(T),a?.(T),T.defaultPrevented||o?.())},f),C=Yut(T=>{const E=T.target;[...c.branches].some(D=>D.contains(E))||(s?.(T),a?.(T),T.defaultPrevented||o?.())},f);return Fut(T=>{_===c.layers.size-1&&(i?.(T),!T.defaultPrevented&&o&&(T.preventDefault(),o()))},f),O.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(gee=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),vee(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=gee)}},[u,f,r,c]),O.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),vee())},[u,c]),O.useEffect(()=>{const T=()=>m({});return document.addEventListener(Yz,T),()=>document.removeEventListener(Yz,T)},[]),h.jsx(di.div,{...l,ref:v,style:{pointerEvents:S?P?"auto":"none":void 0,...e.style},onFocusCapture:ir(e.onFocusCapture,C.onFocusCapture),onBlurCapture:ir(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:ir(e.onPointerDownCapture,M.onPointerDownCapture)})});nU.displayName=Vut;var Gut="DismissableLayerBranch",Wut=O.forwardRef((e,t)=>{const r=O.useContext(Ffe),i=O.useRef(null),n=fn(t,i);return O.useEffect(()=>{const s=i.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),h.jsx(di.div,{...e,ref:n})});Wut.displayName=Gut;function qut(e,t=globalThis?.document){const r=ld(e),i=O.useRef(!1),n=O.useRef(()=>{});return O.useEffect(()=>{const s=o=>{if(o.target&&!i.current){let l=function(){Vfe(Uut,r,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",n.current),n.current=l,t.addEventListener("click",n.current,{once:!0})):l()}else t.removeEventListener("click",n.current);i.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",s),t.removeEventListener("click",n.current)}},[t,r]),{onPointerDownCapture:()=>i.current=!0}}function Yut(e,t=globalThis?.document){const r=ld(e),i=O.useRef(!1);return O.useEffect(()=>{const n=s=>{s.target&&!i.current&&Vfe(Hut,r,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",n),()=>t.removeEventListener("focusin",n)},[t,r]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function vee(){const e=new CustomEvent(Yz);document.dispatchEvent(e)}function Vfe(e,t,r,{discrete:i}){const n=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&n.addEventListener(e,t,{once:!0}),i?zfe(n,s):n.dispatchEvent(s)}var AO=0;function Ufe(){O.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??yee()),document.body.insertAdjacentElement("beforeend",e[1]??yee()),AO++,()=>{AO===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),AO--}},[])}function yee(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var CO="focusScope.autoFocusOnMount",TO="focusScope.autoFocusOnUnmount",xee={bubbles:!1,cancelable:!0},Xut="FocusScope",sU=O.forwardRef((e,t)=>{const{loop:r=!1,trapped:i=!1,onMountAutoFocus:n,onUnmountAutoFocus:s,...a}=e,[o,l]=O.useState(null),c=ld(n),u=ld(s),d=O.useRef(null),f=fn(t,y=>l(y)),m=O.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;O.useEffect(()=>{if(i){let y=function(S){if(m.paused||!o)return;const P=S.target;o.contains(P)?d.current=P:qf(d.current,{select:!0})},x=function(S){if(m.paused||!o)return;const P=S.relatedTarget;P!==null&&(o.contains(P)||qf(d.current,{select:!0}))},w=function(S){if(document.activeElement===document.body)for(const M of S)M.removedNodes.length>0&&qf(o)};document.addEventListener("focusin",y),document.addEventListener("focusout",x);const _=new MutationObserver(w);return o&&_.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",x),_.disconnect()}}},[i,o,m.paused]),O.useEffect(()=>{if(o){wee.add(m);const y=document.activeElement;if(!o.contains(y)){const w=new CustomEvent(CO,xee);o.addEventListener(CO,c),o.dispatchEvent(w),w.defaultPrevented||($ut(edt(Hfe(o)),{select:!0}),document.activeElement===y&&qf(o))}return()=>{o.removeEventListener(CO,c),setTimeout(()=>{const w=new CustomEvent(TO,xee);o.addEventListener(TO,u),o.dispatchEvent(w),w.defaultPrevented||qf(y??document.body,{select:!0}),o.removeEventListener(TO,u),wee.remove(m)},0)}}},[o,c,u,m]);const v=O.useCallback(y=>{if(!r&&!i||m.paused)return;const x=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,w=document.activeElement;if(x&&w){const _=y.currentTarget,[S,P]=Kut(_);S&&P?!y.shiftKey&&w===P?(y.preventDefault(),r&&qf(S,{select:!0})):y.shiftKey&&w===S&&(y.preventDefault(),r&&qf(P,{select:!0})):w===_&&y.preventDefault()}},[r,i,m.paused]);return h.jsx(di.div,{tabIndex:-1,...a,ref:f,onKeyDown:v})});sU.displayName=Xut;function $ut(e,{select:t=!1}={}){const r=document.activeElement;for(const i of e)if(qf(i,{select:t}),document.activeElement!==r)return}function Kut(e){const t=Hfe(e),r=bee(t,e),i=bee(t.reverse(),e);return[r,i]}function Hfe(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const n=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||n?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function bee(e,t){for(const r of e)if(!Qut(r,{upTo:t}))return r}function Qut(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Zut(e){return e instanceof HTMLInputElement&&"select"in e}function qf(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Zut(e)&&t&&e.select()}}var wee=Jut();function Jut(){let e=[];return{add(t){const r=e[0];t!==r&&r?.pause(),e=_ee(e,t),e.unshift(t)},remove(t){e=_ee(e,t),e[0]?.resume()}}}function _ee(e,t){const r=[...e],i=r.indexOf(t);return i!==-1&&r.splice(i,1),r}function edt(e){return e.filter(t=>t.tagName!=="A")}var Ua=globalThis?.document?O.useLayoutEffect:()=>{},tdt=w6[" useId ".trim().toString()]||(()=>{}),rdt=0;function s0(e){const[t,r]=O.useState(tdt());return Ua(()=>{r(i=>i??String(rdt++))},[e]),e||(t?`radix-${t}`:"")}const idt=["top","right","bottom","left"],$p=Math.min,rl=Math.max,$P=Math.round,kC=Math.floor,Ju=e=>({x:e,y:e}),ndt={left:"right",right:"left",bottom:"top",top:"bottom"},sdt={start:"end",end:"start"};function Xz(e,t,r){return rl(e,$p(t,r))}function Yh(e,t){return typeof e=="function"?e(t):e}function Xh(e){return e.split("-")[0]}function wb(e){return e.split("-")[1]}function aU(e){return e==="x"?"y":"x"}function oU(e){return e==="y"?"height":"width"}const adt=new Set(["top","bottom"]);function Lu(e){return adt.has(Xh(e))?"y":"x"}function lU(e){return aU(Lu(e))}function odt(e,t,r){r===void 0&&(r=!1);const i=wb(e),n=lU(e),s=oU(n);let a=n==="x"?i===(r?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=KP(a)),[a,KP(a)]}function ldt(e){const t=KP(e);return[$z(e),t,$z(t)]}function $z(e){return e.replace(/start|end/g,t=>sdt[t])}const See=["left","right"],Eee=["right","left"],cdt=["top","bottom"],udt=["bottom","top"];function ddt(e,t,r){switch(e){case"top":case"bottom":return r?t?Eee:See:t?See:Eee;case"left":case"right":return t?cdt:udt;default:return[]}}function hdt(e,t,r,i){const n=wb(e);let s=ddt(Xh(e),r==="start",i);return n&&(s=s.map(a=>a+"-"+n),t&&(s=s.concat(s.map($z)))),s}function KP(e){return e.replace(/left|right|bottom|top/g,t=>ndt[t])}function fdt(e){return{top:0,right:0,bottom:0,left:0,...e}}function Gfe(e){return typeof e!="number"?fdt(e):{top:e,right:e,bottom:e,left:e}}function QP(e){const{x:t,y:r,width:i,height:n}=e;return{width:i,height:n,top:r,left:t,right:t+i,bottom:r+n,x:t,y:r}}function Aee(e,t,r){let{reference:i,floating:n}=e;const s=Lu(t),a=lU(t),o=oU(a),l=Xh(t),c=s==="y",u=i.x+i.width/2-n.width/2,d=i.y+i.height/2-n.height/2,f=i[o]/2-n[o]/2;let m;switch(l){case"top":m={x:u,y:i.y-n.height};break;case"bottom":m={x:u,y:i.y+i.height};break;case"right":m={x:i.x+i.width,y:d};break;case"left":m={x:i.x-n.width,y:d};break;default:m={x:i.x,y:i.y}}switch(wb(t)){case"start":m[a]-=f*(r&&c?-1:1);break;case"end":m[a]+=f*(r&&c?-1:1);break}return m}const pdt=async(e,t,r)=>{const{placement:i="bottom",strategy:n="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:n}),{x:u,y:d}=Aee(c,i,l),f=i,m={},v=0;for(let y=0;y<o.length;y++){const{name:x,fn:w}=o[y],{x:_,y:S,data:P,reset:M}=await w({x:u,y:d,initialPlacement:i,placement:f,strategy:n,middlewareData:m,rects:c,platform:a,elements:{reference:e,floating:t}});u=_??u,d=S??d,m={...m,[x]:{...m[x],...P}},M&&v<=50&&(v++,typeof M=="object"&&(M.placement&&(f=M.placement),M.rects&&(c=M.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:n}):M.rects),{x:u,y:d}=Aee(c,f,l)),y=-1)}return{x:u,y:d,placement:f,strategy:n,middlewareData:m}};async function p_(e,t){var r;t===void 0&&(t={});const{x:i,y:n,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:m=0}=Yh(t,e),v=Gfe(m),x=o[f?d==="floating"?"reference":"floating":d],w=QP(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(x)))==null||r?x:x.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),_=d==="floating"?{x:i,y:n,width:a.floating.width,height:a.floating.height}:a.reference,S=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),P=await(s.isElement==null?void 0:s.isElement(S))?await(s.getScale==null?void 0:s.getScale(S))||{x:1,y:1}:{x:1,y:1},M=QP(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:_,offsetParent:S,strategy:l}):_);return{top:(w.top-M.top+v.top)/P.y,bottom:(M.bottom-w.bottom+v.bottom)/P.y,left:(w.left-M.left+v.left)/P.x,right:(M.right-w.right+v.right)/P.x}}const mdt=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:i,placement:n,rects:s,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=Yh(e,t)||{};if(c==null)return{};const d=Gfe(u),f={x:r,y:i},m=lU(n),v=oU(m),y=await a.getDimensions(c),x=m==="y",w=x?"top":"left",_=x?"bottom":"right",S=x?"clientHeight":"clientWidth",P=s.reference[v]+s.reference[m]-f[m]-s.floating[v],M=f[m]-s.reference[m],C=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let T=C?C[S]:0;(!T||!await(a.isElement==null?void 0:a.isElement(C)))&&(T=o.floating[S]||s.floating[v]);const E=P/2-M/2,N=T/2-y[v]/2-1,D=$p(d[w],N),I=$p(d[_],N),j=D,L=T-y[v]-I,B=T/2-y[v]/2+E,q=Xz(j,B,L),G=!l.arrow&&wb(n)!=null&&B!==q&&s.reference[v]/2-(B<j?D:I)-y[v]/2<0,Y=G?B<j?B-j:B-L:0;return{[m]:f[m]+Y,data:{[m]:q,centerOffset:B-q-Y,...G&&{alignmentOffset:Y}},reset:G}}}),gdt=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,i;const{placement:n,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:y=!0,...x}=Yh(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const w=Xh(n),_=Lu(o),S=Xh(o)===o,P=await(l.isRTL==null?void 0:l.isRTL(c.floating)),M=f||(S||!y?[KP(o)]:ldt(o)),C=v!=="none";!f&&C&&M.push(...hdt(o,y,v,P));const T=[o,...M],E=await p_(t,x),N=[];let D=((i=s.flip)==null?void 0:i.overflows)||[];if(u&&N.push(E[w]),d){const B=odt(n,a,P);N.push(E[B[0]],E[B[1]])}if(D=[...D,{placement:n,overflows:N}],!N.every(B=>B<=0)){var I,j;const B=(((I=s.flip)==null?void 0:I.index)||0)+1,q=T[B];if(q&&(!(d==="alignment"?_!==Lu(q):!1)||D.every(X=>X.overflows[0]>0&&Lu(X.placement)===_)))return{data:{index:B,overflows:D},reset:{placement:q}};let G=(j=D.filter(Y=>Y.overflows[0]<=0).sort((Y,X)=>Y.overflows[1]-X.overflows[1])[0])==null?void 0:j.placement;if(!G)switch(m){case"bestFit":{var L;const Y=(L=D.filter(X=>{if(C){const re=Lu(X.placement);return re===_||re==="y"}return!0}).map(X=>[X.placement,X.overflows.filter(re=>re>0).reduce((re,F)=>re+F,0)]).sort((X,re)=>X[1]-re[1])[0])==null?void 0:L[0];Y&&(G=Y);break}case"initialPlacement":G=o;break}if(n!==G)return{reset:{placement:G}}}return{}}}};function Cee(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Tee(e){return idt.some(t=>e[t]>=0)}const vdt=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:i="referenceHidden",...n}=Yh(e,t);switch(i){case"referenceHidden":{const s=await p_(t,{...n,elementContext:"reference"}),a=Cee(s,r.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:Tee(a)}}}case"escaped":{const s=await p_(t,{...n,altBoundary:!0}),a=Cee(s,r.floating);return{data:{escapedOffsets:a,escaped:Tee(a)}}}default:return{}}}}},Wfe=new Set(["left","top"]);async function ydt(e,t){const{placement:r,platform:i,elements:n}=e,s=await(i.isRTL==null?void 0:i.isRTL(n.floating)),a=Xh(r),o=wb(r),l=Lu(r)==="y",c=Wfe.has(a)?-1:1,u=s&&l?-1:1,d=Yh(t,e);let{mainAxis:f,crossAxis:m,alignmentAxis:v}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof v=="number"&&(m=o==="end"?v*-1:v),l?{x:m*u,y:f*c}:{x:f*c,y:m*u}}const xdt=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,i;const{x:n,y:s,placement:a,middlewareData:o}=t,l=await ydt(t,e);return a===((r=o.offset)==null?void 0:r.placement)&&(i=o.arrow)!=null&&i.alignmentOffset?{}:{x:n+l.x,y:s+l.y,data:{...l,placement:a}}}}},bdt=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:i,placement:n}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:x=>{let{x:w,y:_}=x;return{x:w,y:_}}},...l}=Yh(e,t),c={x:r,y:i},u=await p_(t,l),d=Lu(Xh(n)),f=aU(d);let m=c[f],v=c[d];if(s){const x=f==="y"?"top":"left",w=f==="y"?"bottom":"right",_=m+u[x],S=m-u[w];m=Xz(_,m,S)}if(a){const x=d==="y"?"top":"left",w=d==="y"?"bottom":"right",_=v+u[x],S=v-u[w];v=Xz(_,v,S)}const y=o.fn({...t,[f]:m,[d]:v});return{...y,data:{x:y.x-r,y:y.y-i,enabled:{[f]:s,[d]:a}}}}}},wdt=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:i,placement:n,rects:s,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=Yh(e,t),u={x:r,y:i},d=Lu(n),f=aU(d);let m=u[f],v=u[d];const y=Yh(o,t),x=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(l){const S=f==="y"?"height":"width",P=s.reference[f]-s.floating[S]+x.mainAxis,M=s.reference[f]+s.reference[S]-x.mainAxis;m<P?m=P:m>M&&(m=M)}if(c){var w,_;const S=f==="y"?"width":"height",P=Wfe.has(Xh(n)),M=s.reference[d]-s.floating[S]+(P&&((w=a.offset)==null?void 0:w[d])||0)+(P?0:x.crossAxis),C=s.reference[d]+s.reference[S]+(P?0:((_=a.offset)==null?void 0:_[d])||0)-(P?x.crossAxis:0);v<M?v=M:v>C&&(v=C)}return{[f]:m,[d]:v}}}},_dt=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,i;const{placement:n,rects:s,platform:a,elements:o}=t,{apply:l=()=>{},...c}=Yh(e,t),u=await p_(t,c),d=Xh(n),f=wb(n),m=Lu(n)==="y",{width:v,height:y}=s.floating;let x,w;d==="top"||d==="bottom"?(x=d,w=f===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(w=d,x=f==="end"?"top":"bottom");const _=y-u.top-u.bottom,S=v-u.left-u.right,P=$p(y-u[x],_),M=$p(v-u[w],S),C=!t.middlewareData.shift;let T=P,E=M;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(E=S),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(T=_),C&&!f){const D=rl(u.left,0),I=rl(u.right,0),j=rl(u.top,0),L=rl(u.bottom,0);m?E=v-2*(D!==0||I!==0?D+I:rl(u.left,u.right)):T=y-2*(j!==0||L!==0?j+L:rl(u.top,u.bottom))}await l({...t,availableWidth:E,availableHeight:T});const N=await a.getDimensions(o.floating);return v!==N.width||y!==N.height?{reset:{rects:!0}}:{}}}};function HD(){return typeof window<"u"}function _b(e){return qfe(e)?(e.nodeName||"").toLowerCase():"#document"}function al(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function md(e){var t;return(t=(qfe(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function qfe(e){return HD()?e instanceof Node||e instanceof al(e).Node:!1}function Hc(e){return HD()?e instanceof Element||e instanceof al(e).Element:!1}function cd(e){return HD()?e instanceof HTMLElement||e instanceof al(e).HTMLElement:!1}function Mee(e){return!HD()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof al(e).ShadowRoot}const Sdt=new Set(["inline","contents"]);function gS(e){const{overflow:t,overflowX:r,overflowY:i,display:n}=Gc(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+r)&&!Sdt.has(n)}const Edt=new Set(["table","td","th"]);function Adt(e){return Edt.has(_b(e))}const Cdt=[":popover-open",":modal"];function GD(e){return Cdt.some(t=>{try{return e.matches(t)}catch{return!1}})}const Tdt=["transform","translate","scale","rotate","perspective"],Mdt=["transform","translate","scale","rotate","perspective","filter"],Pdt=["paint","layout","strict","content"];function cU(e){const t=uU(),r=Hc(e)?Gc(e):e;return Tdt.some(i=>r[i]?r[i]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||Mdt.some(i=>(r.willChange||"").includes(i))||Pdt.some(i=>(r.contain||"").includes(i))}function Ddt(e){let t=Kp(e);for(;cd(t)&&!Ox(t);){if(cU(t))return t;if(GD(t))return null;t=Kp(t)}return null}function uU(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Ndt=new Set(["html","body","#document"]);function Ox(e){return Ndt.has(_b(e))}function Gc(e){return al(e).getComputedStyle(e)}function WD(e){return Hc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Kp(e){if(_b(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Mee(e)&&e.host||md(e);return Mee(t)?t.host:t}function Yfe(e){const t=Kp(e);return Ox(t)?e.ownerDocument?e.ownerDocument.body:e.body:cd(t)&&gS(t)?t:Yfe(t)}function m_(e,t,r){var i;t===void 0&&(t=[]),r===void 0&&(r=!0);const n=Yfe(e),s=n===((i=e.ownerDocument)==null?void 0:i.body),a=al(n);if(s){const o=Kz(a);return t.concat(a,a.visualViewport||[],gS(n)?n:[],o&&r?m_(o):[])}return t.concat(n,m_(n,[],r))}function Kz(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Xfe(e){const t=Gc(e);let r=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const n=cd(e),s=n?e.offsetWidth:r,a=n?e.offsetHeight:i,o=$P(r)!==s||$P(i)!==a;return o&&(r=s,i=a),{width:r,height:i,$:o}}function dU(e){return Hc(e)?e:e.contextElement}function Zy(e){const t=dU(e);if(!cd(t))return Ju(1);const r=t.getBoundingClientRect(),{width:i,height:n,$:s}=Xfe(t);let a=(s?$P(r.width):r.width)/i,o=(s?$P(r.height):r.height)/n;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const kdt=Ju(0);function $fe(e){const t=al(e);return!uU()||!t.visualViewport?kdt:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Rdt(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==al(e)?!1:t}function a0(e,t,r,i){t===void 0&&(t=!1),r===void 0&&(r=!1);const n=e.getBoundingClientRect(),s=dU(e);let a=Ju(1);t&&(i?Hc(i)&&(a=Zy(i)):a=Zy(e));const o=Rdt(s,r,i)?$fe(s):Ju(0);let l=(n.left+o.x)/a.x,c=(n.top+o.y)/a.y,u=n.width/a.x,d=n.height/a.y;if(s){const f=al(s),m=i&&Hc(i)?al(i):i;let v=f,y=Kz(v);for(;y&&i&&m!==v;){const x=Zy(y),w=y.getBoundingClientRect(),_=Gc(y),S=w.left+(y.clientLeft+parseFloat(_.paddingLeft))*x.x,P=w.top+(y.clientTop+parseFloat(_.paddingTop))*x.y;l*=x.x,c*=x.y,u*=x.x,d*=x.y,l+=S,c+=P,v=al(y),y=Kz(v)}}return QP({width:u,height:d,x:l,y:c})}function hU(e,t){const r=WD(e).scrollLeft;return t?t.left+r:a0(md(e)).left+r}function Kfe(e,t,r){r===void 0&&(r=!1);const i=e.getBoundingClientRect(),n=i.left+t.scrollLeft-(r?0:hU(e,i)),s=i.top+t.scrollTop;return{x:n,y:s}}function Idt(e){let{elements:t,rect:r,offsetParent:i,strategy:n}=e;const s=n==="fixed",a=md(i),o=t?GD(t.floating):!1;if(i===a||o&&s)return r;let l={scrollLeft:0,scrollTop:0},c=Ju(1);const u=Ju(0),d=cd(i);if((d||!d&&!s)&&((_b(i)!=="body"||gS(a))&&(l=WD(i)),cd(i))){const m=a0(i);c=Zy(i),u.x=m.x+i.clientLeft,u.y=m.y+i.clientTop}const f=a&&!d&&!s?Kfe(a,l,!0):Ju(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+f.x,y:r.y*c.y-l.scrollTop*c.y+u.y+f.y}}function Odt(e){return Array.from(e.getClientRects())}function jdt(e){const t=md(e),r=WD(e),i=e.ownerDocument.body,n=rl(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=rl(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let a=-r.scrollLeft+hU(e);const o=-r.scrollTop;return Gc(i).direction==="rtl"&&(a+=rl(t.clientWidth,i.clientWidth)-n),{width:n,height:s,x:a,y:o}}function Ldt(e,t){const r=al(e),i=md(e),n=r.visualViewport;let s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(n){s=n.width,a=n.height;const c=uU();(!c||c&&t==="fixed")&&(o=n.offsetLeft,l=n.offsetTop)}return{width:s,height:a,x:o,y:l}}const zdt=new Set(["absolute","fixed"]);function Bdt(e,t){const r=a0(e,!0,t==="fixed"),i=r.top+e.clientTop,n=r.left+e.clientLeft,s=cd(e)?Zy(e):Ju(1),a=e.clientWidth*s.x,o=e.clientHeight*s.y,l=n*s.x,c=i*s.y;return{width:a,height:o,x:l,y:c}}function Pee(e,t,r){let i;if(t==="viewport")i=Ldt(e,r);else if(t==="document")i=jdt(md(e));else if(Hc(t))i=Bdt(t,r);else{const n=$fe(e);i={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return QP(i)}function Qfe(e,t){const r=Kp(e);return r===t||!Hc(r)||Ox(r)?!1:Gc(r).position==="fixed"||Qfe(r,t)}function Fdt(e,t){const r=t.get(e);if(r)return r;let i=m_(e,[],!1).filter(o=>Hc(o)&&_b(o)!=="body"),n=null;const s=Gc(e).position==="fixed";let a=s?Kp(e):e;for(;Hc(a)&&!Ox(a);){const o=Gc(a),l=cU(a);!l&&o.position==="fixed"&&(n=null),(s?!l&&!n:!l&&o.position==="static"&&!!n&&zdt.has(n.position)||gS(a)&&!l&&Qfe(e,a))?i=i.filter(u=>u!==a):n=o,a=Kp(a)}return t.set(e,i),i}function Vdt(e){let{element:t,boundary:r,rootBoundary:i,strategy:n}=e;const a=[...r==="clippingAncestors"?GD(t)?[]:Fdt(t,this._c):[].concat(r),i],o=a[0],l=a.reduce((c,u)=>{const d=Pee(t,u,n);return c.top=rl(d.top,c.top),c.right=$p(d.right,c.right),c.bottom=$p(d.bottom,c.bottom),c.left=rl(d.left,c.left),c},Pee(t,o,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Udt(e){const{width:t,height:r}=Xfe(e);return{width:t,height:r}}function Hdt(e,t,r){const i=cd(t),n=md(t),s=r==="fixed",a=a0(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=Ju(0);function c(){l.x=hU(n)}if(i||!i&&!s)if((_b(t)!=="body"||gS(n))&&(o=WD(t)),i){const m=a0(t,!0,s,t);l.x=m.x+t.clientLeft,l.y=m.y+t.clientTop}else n&&c();s&&!i&&n&&c();const u=n&&!i&&!s?Kfe(n,o):Ju(0),d=a.left+o.scrollLeft-l.x-u.x,f=a.top+o.scrollTop-l.y-u.y;return{x:d,y:f,width:a.width,height:a.height}}function MO(e){return Gc(e).position==="static"}function Dee(e,t){if(!cd(e)||Gc(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return md(e)===r&&(r=r.ownerDocument.body),r}function Zfe(e,t){const r=al(e);if(GD(e))return r;if(!cd(e)){let n=Kp(e);for(;n&&!Ox(n);){if(Hc(n)&&!MO(n))return n;n=Kp(n)}return r}let i=Dee(e,t);for(;i&&Adt(i)&&MO(i);)i=Dee(i,t);return i&&Ox(i)&&MO(i)&&!cU(i)?r:i||Ddt(e)||r}const Gdt=async function(e){const t=this.getOffsetParent||Zfe,r=this.getDimensions,i=await r(e.floating);return{reference:Hdt(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function Wdt(e){return Gc(e).direction==="rtl"}const qdt={convertOffsetParentRelativeRectToViewportRelativeRect:Idt,getDocumentElement:md,getClippingRect:Vdt,getOffsetParent:Zfe,getElementRects:Gdt,getClientRects:Odt,getDimensions:Udt,getScale:Zy,isElement:Hc,isRTL:Wdt};function Jfe(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Ydt(e,t){let r=null,i;const n=md(e);function s(){var o;clearTimeout(i),(o=r)==null||o.disconnect(),r=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const c=e.getBoundingClientRect(),{left:u,top:d,width:f,height:m}=c;if(o||t(),!f||!m)return;const v=kC(d),y=kC(n.clientWidth-(u+f)),x=kC(n.clientHeight-(d+m)),w=kC(u),S={rootMargin:-v+"px "+-y+"px "+-x+"px "+-w+"px",threshold:rl(0,$p(1,l))||1};let P=!0;function M(C){const T=C[0].intersectionRatio;if(T!==l){if(!P)return a();T?a(!1,T):i=setTimeout(()=>{a(!1,1e-7)},1e3)}T===1&&!Jfe(c,e.getBoundingClientRect())&&a(),P=!1}try{r=new IntersectionObserver(M,{...S,root:n.ownerDocument})}catch{r=new IntersectionObserver(M,S)}r.observe(e)}return a(!0),s}function Xdt(e,t,r,i){i===void 0&&(i={});const{ancestorScroll:n=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=i,c=dU(e),u=n||s?[...c?m_(c):[],...m_(t)]:[];u.forEach(w=>{n&&w.addEventListener("scroll",r,{passive:!0}),s&&w.addEventListener("resize",r)});const d=c&&o?Ydt(c,r):null;let f=-1,m=null;a&&(m=new ResizeObserver(w=>{let[_]=w;_&&_.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var S;(S=m)==null||S.observe(t)})),r()}),c&&!l&&m.observe(c),m.observe(t));let v,y=l?a0(e):null;l&&x();function x(){const w=a0(e);y&&!Jfe(y,w)&&r(),y=w,v=requestAnimationFrame(x)}return r(),()=>{var w;u.forEach(_=>{n&&_.removeEventListener("scroll",r),s&&_.removeEventListener("resize",r)}),d?.(),(w=m)==null||w.disconnect(),m=null,l&&cancelAnimationFrame(v)}}const $dt=xdt,Kdt=bdt,Qdt=gdt,Zdt=_dt,Jdt=vdt,Nee=mdt,eht=wdt,tht=(e,t,r)=>{const i=new Map,n={platform:qdt,...r},s={...n.platform,_c:i};return pdt(e,t,{...n,platform:s})};var rht=typeof document<"u",iht=function(){},FT=rht?O.useLayoutEffect:iht;function ZP(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,i,n;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(i=r;i--!==0;)if(!ZP(e[i],t[i]))return!1;return!0}if(n=Object.keys(e),r=n.length,r!==Object.keys(t).length)return!1;for(i=r;i--!==0;)if(!{}.hasOwnProperty.call(t,n[i]))return!1;for(i=r;i--!==0;){const s=n[i];if(!(s==="_owner"&&e.$$typeof)&&!ZP(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function epe(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function kee(e,t){const r=epe(e);return Math.round(t*r)/r}function PO(e){const t=O.useRef(e);return FT(()=>{t.current=e}),t}function nht(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:i=[],platform:n,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=O.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,m]=O.useState(i);ZP(f,i)||m(i);const[v,y]=O.useState(null),[x,w]=O.useState(null),_=O.useCallback(X=>{X!==C.current&&(C.current=X,y(X))},[]),S=O.useCallback(X=>{X!==T.current&&(T.current=X,w(X))},[]),P=s||v,M=a||x,C=O.useRef(null),T=O.useRef(null),E=O.useRef(u),N=l!=null,D=PO(l),I=PO(n),j=PO(c),L=O.useCallback(()=>{if(!C.current||!T.current)return;const X={placement:t,strategy:r,middleware:f};I.current&&(X.platform=I.current),tht(C.current,T.current,X).then(re=>{const F={...re,isPositioned:j.current!==!1};B.current&&!ZP(E.current,F)&&(E.current=F,mS.flushSync(()=>{d(F)}))})},[f,t,r,I,j]);FT(()=>{c===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,d(X=>({...X,isPositioned:!1})))},[c]);const B=O.useRef(!1);FT(()=>(B.current=!0,()=>{B.current=!1}),[]),FT(()=>{if(P&&(C.current=P),M&&(T.current=M),P&&M){if(D.current)return D.current(P,M,L);L()}},[P,M,L,D,N]);const q=O.useMemo(()=>({reference:C,floating:T,setReference:_,setFloating:S}),[_,S]),G=O.useMemo(()=>({reference:P,floating:M}),[P,M]),Y=O.useMemo(()=>{const X={position:r,left:0,top:0};if(!G.floating)return X;const re=kee(G.floating,u.x),F=kee(G.floating,u.y);return o?{...X,transform:"translate("+re+"px, "+F+"px)",...epe(G.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:re,top:F}},[r,o,G.floating,u.x,u.y]);return O.useMemo(()=>({...u,update:L,refs:q,elements:G,floatingStyles:Y}),[u,L,q,G,Y])}const sht=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:i,padding:n}=typeof e=="function"?e(r):e;return i&&t(i)?i.current!=null?Nee({element:i.current,padding:n}).fn(r):{}:i?Nee({element:i,padding:n}).fn(r):{}}}},aht=(e,t)=>({...$dt(e),options:[e,t]}),oht=(e,t)=>({...Kdt(e),options:[e,t]}),lht=(e,t)=>({...eht(e),options:[e,t]}),cht=(e,t)=>({...Qdt(e),options:[e,t]}),uht=(e,t)=>({...Zdt(e),options:[e,t]}),dht=(e,t)=>({...Jdt(e),options:[e,t]}),hht=(e,t)=>({...sht(e),options:[e,t]});var fht="Arrow",tpe=O.forwardRef((e,t)=>{const{children:r,width:i=10,height:n=5,...s}=e;return h.jsx(di.svg,{...s,ref:t,width:i,height:n,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});tpe.displayName=fht;var pht=tpe;function mht(e){const[t,r]=O.useState(void 0);return Ua(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;const s=n[0];let a,o;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;r({width:a,height:o})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else r(void 0)},[e]),t}var fU="Popper",[rpe,qD]=S0(fU),[ght,ipe]=rpe(fU),npe=e=>{const{__scopePopper:t,children:r}=e,[i,n]=O.useState(null);return h.jsx(ght,{scope:t,anchor:i,onAnchorChange:n,children:r})};npe.displayName=fU;var spe="PopperAnchor",ape=O.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:i,...n}=e,s=ipe(spe,r),a=O.useRef(null),o=fn(t,a);return O.useEffect(()=>{s.onAnchorChange(i?.current||a.current)}),i?null:h.jsx(di.div,{...n,ref:o})});ape.displayName=spe;var pU="PopperContent",[vht,yht]=rpe(pU),ope=O.forwardRef((e,t)=>{const{__scopePopper:r,side:i="bottom",sideOffset:n=0,align:s="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:v,...y}=e,x=ipe(pU,r),[w,_]=O.useState(null),S=fn(t,ae=>_(ae)),[P,M]=O.useState(null),C=mht(P),T=C?.width??0,E=C?.height??0,N=i+(s!=="center"?"-"+s:""),D=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},I=Array.isArray(c)?c:[c],j=I.length>0,L={padding:D,boundary:I.filter(bht),altBoundary:j},{refs:B,floatingStyles:q,placement:G,isPositioned:Y,middlewareData:X}=nht({strategy:"fixed",placement:N,whileElementsMounted:(...ae)=>Xdt(...ae,{animationFrame:m==="always"}),elements:{reference:x.anchor},middleware:[aht({mainAxis:n+E,alignmentAxis:a}),l&&oht({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?lht():void 0,...L}),l&&cht({...L}),uht({...L,apply:({elements:ae,rects:Z,availableWidth:fe,availableHeight:he})=>{const{width:Ae,height:xe}=Z.reference,Ee=ae.floating.style;Ee.setProperty("--radix-popper-available-width",`${fe}px`),Ee.setProperty("--radix-popper-available-height",`${he}px`),Ee.setProperty("--radix-popper-anchor-width",`${Ae}px`),Ee.setProperty("--radix-popper-anchor-height",`${xe}px`)}}),P&&hht({element:P,padding:o}),wht({arrowWidth:T,arrowHeight:E}),f&&dht({strategy:"referenceHidden",...L})]}),[re,F]=upe(G),$=ld(v);Ua(()=>{Y&&$?.()},[Y,$]);const se=X.arrow?.x,H=X.arrow?.y,ne=X.arrow?.centerOffset!==0,[ce,ie]=O.useState();return Ua(()=>{w&&ie(window.getComputedStyle(w).zIndex)},[w]),h.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...q,transform:Y?q.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[X.transformOrigin?.x,X.transformOrigin?.y].join(" "),...X.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:h.jsx(vht,{scope:r,placedSide:re,onArrowChange:M,arrowX:se,arrowY:H,shouldHideArrow:ne,children:h.jsx(di.div,{"data-side":re,"data-align":F,...y,ref:S,style:{...y.style,animation:Y?void 0:"none"}})})})});ope.displayName=pU;var lpe="PopperArrow",xht={top:"bottom",right:"left",bottom:"top",left:"right"},cpe=O.forwardRef(function(t,r){const{__scopePopper:i,...n}=t,s=yht(lpe,i),a=xht[s.placedSide];return h.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:h.jsx(pht,{...n,ref:r,style:{...n.style,display:"block"}})})});cpe.displayName=lpe;function bht(e){return e!==null}var wht=e=>({name:"transformOrigin",options:e,fn(t){const{placement:r,rects:i,middlewareData:n}=t,a=n.arrow?.centerOffset!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=upe(r),d={start:"0%",center:"50%",end:"100%"}[u],f=(n.arrow?.x??0)+o/2,m=(n.arrow?.y??0)+l/2;let v="",y="";return c==="bottom"?(v=a?d:`${f}px`,y=`${-l}px`):c==="top"?(v=a?d:`${f}px`,y=`${i.floating.height+l}px`):c==="right"?(v=`${-l}px`,y=a?d:`${m}px`):c==="left"&&(v=`${i.floating.width+l}px`,y=a?d:`${m}px`),{data:{x:v,y}}}});function upe(e){const[t,r="center"]=e.split("-");return[t,r]}var dpe=npe,hpe=ape,fpe=ope,ppe=cpe,_ht="Portal",mU=O.forwardRef((e,t)=>{const{container:r,...i}=e,[n,s]=O.useState(!1);Ua(()=>s(!0),[]);const a=r||n&&globalThis?.document?.body;return a?Iut.createPortal(h.jsx(di.div,{...i,ref:t}),a):null});mU.displayName=_ht;var Sht=w6[" useInsertionEffect ".trim().toString()]||Ua;function g_({prop:e,defaultProp:t,onChange:r=()=>{},caller:i}){const[n,s,a]=Eht({defaultProp:t,onChange:r}),o=e!==void 0,l=o?e:n;{const u=O.useRef(e!==void 0);O.useEffect(()=>{const d=u.current;d!==o&&console.warn(`${i} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,i])}const c=O.useCallback(u=>{if(o){const d=Aht(u)?u(e):u;d!==e&&a.current?.(d)}else s(u)},[o,e,s,a]);return[l,c]}function Eht({defaultProp:e,onChange:t}){const[r,i]=O.useState(e),n=O.useRef(r),s=O.useRef(t);return Sht(()=>{s.current=t},[t]),O.useEffect(()=>{n.current!==r&&(s.current?.(r),n.current=r)},[r,n]),[r,i,s]}function Aht(e){return typeof e=="function"}function Cht(e){const t=O.useRef({value:e,previous:e});return O.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var mpe=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Tht="VisuallyHidden",Mht=O.forwardRef((e,t)=>h.jsx(di.span,{...e,ref:t,style:{...mpe,...e.style}}));Mht.displayName=Tht;var Pht=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},qv=new WeakMap,RC=new WeakMap,IC={},DO=0,gpe=function(e){return e&&(e.host||gpe(e.parentNode))},Dht=function(e,t){return t.map(function(r){if(e.contains(r))return r;var i=gpe(r);return i&&e.contains(i)?i:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Nht=function(e,t,r,i){var n=Dht(t,Array.isArray(e)?e:[e]);IC[r]||(IC[r]=new WeakMap);var s=IC[r],a=[],o=new Set,l=new Set(n),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};n.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(f){if(o.has(f))u(f);else try{var m=f.getAttribute(i),v=m!==null&&m!=="false",y=(qv.get(f)||0)+1,x=(s.get(f)||0)+1;qv.set(f,y),s.set(f,x),a.push(f),y===1&&v&&RC.set(f,!0),x===1&&f.setAttribute(r,"true"),v||f.setAttribute(i,"true")}catch(w){console.error("aria-hidden: cannot operate on ",f,w)}})};return u(t),o.clear(),DO++,function(){a.forEach(function(d){var f=qv.get(d)-1,m=s.get(d)-1;qv.set(d,f),s.set(d,m),f||(RC.has(d)||d.removeAttribute(i),RC.delete(d)),m||d.removeAttribute(r)}),DO--,DO||(qv=new WeakMap,qv=new WeakMap,RC=new WeakMap,IC={})}},vpe=function(e,t,r){r===void 0&&(r="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),n=Pht(e);return n?(i.push.apply(i,Array.from(n.querySelectorAll("[aria-live], script"))),Nht(i,n,r,"aria-hidden")):function(){return null}},VT="right-scroll-bar-position",UT="width-before-scroll-bar",kht="with-scroll-bars-hidden",Rht="--removed-body-scroll-bar-size";function NO(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Iht(e,t){var r=O.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(i){var n=r.value;n!==i&&(r.value=i,r.callback(i,n))}}}})[0];return r.callback=t,r.facade}var Oht=typeof window<"u"?O.useLayoutEffect:O.useEffect,Ree=new WeakMap;function jht(e,t){var r=Iht(null,function(i){return e.forEach(function(n){return NO(n,i)})});return Oht(function(){var i=Ree.get(r);if(i){var n=new Set(i),s=new Set(e),a=r.current;n.forEach(function(o){s.has(o)||NO(o,null)}),s.forEach(function(o){n.has(o)||NO(o,a)})}Ree.set(r,e)},[e]),r}function Lht(e){return e}function zht(e,t){t===void 0&&(t=Lht);var r=[],i=!1,n={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var a=t(s,i);return r.push(a),function(){r=r.filter(function(o){return o!==a})}},assignSyncMedium:function(s){for(i=!0;r.length;){var a=r;r=[],a.forEach(s)}r={push:function(o){return s(o)},filter:function(){return r}}},assignMedium:function(s){i=!0;var a=[];if(r.length){var o=r;r=[],o.forEach(s),a=r}var l=function(){var u=a;a=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),r}}}};return n}function Bht(e){e===void 0&&(e={});var t=zht(null);return t.options=Ru({async:!0,ssr:!1},e),t}var ype=function(e){var t=e.sideCar,r=Q_(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return O.createElement(i,Ru({},r))};ype.isSideCarExport=!0;function Fht(e,t){return e.useMedium(t),ype}var xpe=Bht(),kO=function(){},YD=O.forwardRef(function(e,t){var r=O.useRef(null),i=O.useState({onScrollCapture:kO,onWheelCapture:kO,onTouchMoveCapture:kO}),n=i[0],s=i[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,f=e.sideCar,m=e.noRelative,v=e.noIsolation,y=e.inert,x=e.allowPinchZoom,w=e.as,_=w===void 0?"div":w,S=e.gapMode,P=Q_(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),M=f,C=jht([r,t]),T=Ru(Ru({},P),n);return O.createElement(O.Fragment,null,u&&O.createElement(M,{sideCar:xpe,removeScrollBar:c,shards:d,noRelative:m,noIsolation:v,inert:y,setCallbacks:s,allowPinchZoom:!!x,lockRef:r,gapMode:S}),a?O.cloneElement(O.Children.only(o),Ru(Ru({},T),{ref:C})):O.createElement(_,Ru({},T,{className:l,ref:C}),o))});YD.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};YD.classNames={fullWidth:UT,zeroRight:VT};var Vht=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Uht(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Vht();return t&&e.setAttribute("nonce",t),e}function Hht(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Ght(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Wht=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Uht())&&(Hht(t,r),Ght(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},qht=function(){var e=Wht();return function(t,r){O.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},bpe=function(){var e=qht(),t=function(r){var i=r.styles,n=r.dynamic;return e(i,n),null};return t},Yht={left:0,top:0,right:0,gap:0},RO=function(e){return parseInt(e||"",10)||0},Xht=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],n=t[e==="padding"?"paddingRight":"marginRight"];return[RO(r),RO(i),RO(n)]},$ht=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Yht;var t=Xht(e),r=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-r+t[2]-t[0])}},Kht=bpe(),Jy="data-scroll-locked",Qht=function(e,t,r,i){var n=e.left,s=e.top,a=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(kht,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(o,"px ").concat(i,`;
  }
  body[`).concat(Jy,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),r==="margin"&&`
    padding-left: `.concat(n,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(i,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(VT,` {
    right: `).concat(o,"px ").concat(i,`;
  }
  
  .`).concat(UT,` {
    margin-right: `).concat(o,"px ").concat(i,`;
  }
  
  .`).concat(VT," .").concat(VT,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(UT," .").concat(UT,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(Jy,`] {
    `).concat(Rht,": ").concat(o,`px;
  }
`)},Iee=function(){var e=parseInt(document.body.getAttribute(Jy)||"0",10);return isFinite(e)?e:0},Zht=function(){O.useEffect(function(){return document.body.setAttribute(Jy,(Iee()+1).toString()),function(){var e=Iee()-1;e<=0?document.body.removeAttribute(Jy):document.body.setAttribute(Jy,e.toString())}},[])},Jht=function(e){var t=e.noRelative,r=e.noImportant,i=e.gapMode,n=i===void 0?"margin":i;Zht();var s=O.useMemo(function(){return $ht(n)},[n]);return O.createElement(Kht,{styles:Qht(s,!t,n,r?"":"!important")})},Qz=!1;if(typeof window<"u")try{var OC=Object.defineProperty({},"passive",{get:function(){return Qz=!0,!0}});window.addEventListener("test",OC,OC),window.removeEventListener("test",OC,OC)}catch{Qz=!1}var Yv=Qz?{passive:!1}:!1,eft=function(e){return e.tagName==="TEXTAREA"},wpe=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!eft(e)&&r[t]==="visible")},tft=function(e){return wpe(e,"overflowY")},rft=function(e){return wpe(e,"overflowX")},Oee=function(e,t){var r=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var n=_pe(e,i);if(n){var s=Spe(e,i),a=s[1],o=s[2];if(a>o)return!0}i=i.parentNode}while(i&&i!==r.body);return!1},ift=function(e){var t=e.scrollTop,r=e.scrollHeight,i=e.clientHeight;return[t,r,i]},nft=function(e){var t=e.scrollLeft,r=e.scrollWidth,i=e.clientWidth;return[t,r,i]},_pe=function(e,t){return e==="v"?tft(t):rft(t)},Spe=function(e,t){return e==="v"?ift(t):nft(t)},sft=function(e,t){return e==="h"&&t==="rtl"?-1:1},aft=function(e,t,r,i,n){var s=sft(e,window.getComputedStyle(t).direction),a=s*i,o=r.target,l=t.contains(o),c=!1,u=a>0,d=0,f=0;do{if(!o)break;var m=Spe(e,o),v=m[0],y=m[1],x=m[2],w=y-x-s*v;(v||w)&&_pe(e,o)&&(d+=w,f+=v);var _=o.parentNode;o=_&&_.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_.host:_}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(d)<1||!u&&Math.abs(f)<1)&&(c=!0),c},jC=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},jee=function(e){return[e.deltaX,e.deltaY]},Lee=function(e){return e&&"current"in e?e.current:e},oft=function(e,t){return e[0]===t[0]&&e[1]===t[1]},lft=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},cft=0,Xv=[];function uft(e){var t=O.useRef([]),r=O.useRef([0,0]),i=O.useRef(),n=O.useState(cft++)[0],s=O.useState(bpe)[0],a=O.useRef(e);O.useEffect(function(){a.current=e},[e]),O.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(n));var y=M$e([e.lockRef.current],(e.shards||[]).map(Lee),!0).filter(Boolean);return y.forEach(function(x){return x.classList.add("allow-interactivity-".concat(n))}),function(){document.body.classList.remove("block-interactivity-".concat(n)),y.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(n))})}}},[e.inert,e.lockRef.current,e.shards]);var o=O.useCallback(function(y,x){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!a.current.allowPinchZoom;var w=jC(y),_=r.current,S="deltaX"in y?y.deltaX:_[0]-w[0],P="deltaY"in y?y.deltaY:_[1]-w[1],M,C=y.target,T=Math.abs(S)>Math.abs(P)?"h":"v";if("touches"in y&&T==="h"&&C.type==="range")return!1;var E=Oee(T,C);if(!E)return!0;if(E?M=T:(M=T==="v"?"h":"v",E=Oee(T,C)),!E)return!1;if(!i.current&&"changedTouches"in y&&(S||P)&&(i.current=M),!M)return!0;var N=i.current||M;return aft(N,x,y,N==="h"?S:P)},[]),l=O.useCallback(function(y){var x=y;if(!(!Xv.length||Xv[Xv.length-1]!==s)){var w="deltaY"in x?jee(x):jC(x),_=t.current.filter(function(M){return M.name===x.type&&(M.target===x.target||x.target===M.shadowParent)&&oft(M.delta,w)})[0];if(_&&_.should){x.cancelable&&x.preventDefault();return}if(!_){var S=(a.current.shards||[]).map(Lee).filter(Boolean).filter(function(M){return M.contains(x.target)}),P=S.length>0?o(x,S[0]):!a.current.noIsolation;P&&x.cancelable&&x.preventDefault()}}},[]),c=O.useCallback(function(y,x,w,_){var S={name:y,delta:x,target:w,should:_,shadowParent:dft(w)};t.current.push(S),setTimeout(function(){t.current=t.current.filter(function(P){return P!==S})},1)},[]),u=O.useCallback(function(y){r.current=jC(y),i.current=void 0},[]),d=O.useCallback(function(y){c(y.type,jee(y),y.target,o(y,e.lockRef.current))},[]),f=O.useCallback(function(y){c(y.type,jC(y),y.target,o(y,e.lockRef.current))},[]);O.useEffect(function(){return Xv.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",l,Yv),document.addEventListener("touchmove",l,Yv),document.addEventListener("touchstart",u,Yv),function(){Xv=Xv.filter(function(y){return y!==s}),document.removeEventListener("wheel",l,Yv),document.removeEventListener("touchmove",l,Yv),document.removeEventListener("touchstart",u,Yv)}},[]);var m=e.removeScrollBar,v=e.inert;return O.createElement(O.Fragment,null,v?O.createElement(s,{styles:lft(n)}):null,m?O.createElement(Jht,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function dft(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const hft=Fht(xpe,uft);var gU=O.forwardRef(function(e,t){return O.createElement(YD,Ru({},e,{ref:t,sideCar:hft}))});gU.classNames=YD.classNames;var fft=[" ","Enter","ArrowUp","ArrowDown"],pft=[" ","Enter"],o0="Select",[XD,$D,mft]=iU(o0),[Sb,MEt]=S0(o0,[mft,qD]),KD=qD(),[gft,am]=Sb(o0),[vft,yft]=Sb(o0),Epe=e=>{const{__scopeSelect:t,children:r,open:i,defaultOpen:n,onOpenChange:s,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:f,required:m,form:v}=e,y=KD(t),[x,w]=O.useState(null),[_,S]=O.useState(null),[P,M]=O.useState(!1),C=UD(c),[T,E]=g_({prop:i,defaultProp:n??!1,onChange:s,caller:o0}),[N,D]=g_({prop:a,defaultProp:o,onChange:l,caller:o0}),I=O.useRef(null),j=x?v||!!x.closest("form"):!0,[L,B]=O.useState(new Set),q=Array.from(L).map(G=>G.props.value).join(";");return h.jsx(dpe,{...y,children:h.jsxs(gft,{required:m,scope:t,trigger:x,onTriggerChange:w,valueNode:_,onValueNodeChange:S,valueNodeHasChildren:P,onValueNodeHasChildrenChange:M,contentId:s0(),value:N,onValueChange:D,open:T,onOpenChange:E,dir:C,triggerPointerDownPosRef:I,disabled:f,children:[h.jsx(XD.Provider,{scope:t,children:h.jsx(vft,{scope:e.__scopeSelect,onNativeOptionAdd:O.useCallback(G=>{B(Y=>new Set(Y).add(G))},[]),onNativeOptionRemove:O.useCallback(G=>{B(Y=>{const X=new Set(Y);return X.delete(G),X})},[]),children:r})}),j?h.jsxs(qpe,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:d,value:N,onChange:G=>D(G.target.value),disabled:f,form:v,children:[N===void 0?h.jsx("option",{value:""}):null,Array.from(L)]},q):null]})})};Epe.displayName=o0;var Ape="SelectTrigger",Cpe=O.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:i=!1,...n}=e,s=KD(r),a=am(Ape,r),o=a.disabled||i,l=fn(t,a.onTriggerChange),c=$D(r),u=O.useRef("touch"),[d,f,m]=Xpe(y=>{const x=c().filter(S=>!S.disabled),w=x.find(S=>S.value===a.value),_=$pe(x,y,w);_!==void 0&&a.onValueChange(_.value)}),v=y=>{o||(a.onOpenChange(!0),m()),y&&(a.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return h.jsx(hpe,{asChild:!0,...s,children:h.jsx(di.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":Ype(a.value)?"":void 0,...n,ref:l,onClick:ir(n.onClick,y=>{y.currentTarget.focus(),u.current!=="mouse"&&v(y)}),onPointerDown:ir(n.onPointerDown,y=>{u.current=y.pointerType;const x=y.target;x.hasPointerCapture(y.pointerId)&&x.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(v(y),y.preventDefault())}),onKeyDown:ir(n.onKeyDown,y=>{const x=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&f(y.key),!(x&&y.key===" ")&&fft.includes(y.key)&&(v(),y.preventDefault())})})})});Cpe.displayName=Ape;var Tpe="SelectValue",Mpe=O.forwardRef((e,t)=>{const{__scopeSelect:r,className:i,style:n,children:s,placeholder:a="",...o}=e,l=am(Tpe,r),{onValueNodeHasChildrenChange:c}=l,u=s!==void 0,d=fn(t,l.onValueNodeChange);return Ua(()=>{c(u)},[c,u]),h.jsx(di.span,{...o,ref:d,style:{pointerEvents:"none"},children:Ype(l.value)?h.jsx(h.Fragment,{children:a}):s})});Mpe.displayName=Tpe;var xft="SelectIcon",Ppe=O.forwardRef((e,t)=>{const{__scopeSelect:r,children:i,...n}=e;return h.jsx(di.span,{"aria-hidden":!0,...n,ref:t,children:i||"▼"})});Ppe.displayName=xft;var bft="SelectPortal",Dpe=e=>h.jsx(mU,{asChild:!0,...e});Dpe.displayName=bft;var l0="SelectContent",Npe=O.forwardRef((e,t)=>{const r=am(l0,e.__scopeSelect),[i,n]=O.useState();if(Ua(()=>{n(new DocumentFragment)},[]),!r.open){const s=i;return s?mS.createPortal(h.jsx(kpe,{scope:e.__scopeSelect,children:h.jsx(XD.Slot,{scope:e.__scopeSelect,children:h.jsx("div",{children:e.children})})}),s):null}return h.jsx(Rpe,{...e,ref:t})});Npe.displayName=l0;var gc=10,[kpe,om]=Sb(l0),wft="SelectContentImpl",_ft=Ix("SelectContent.RemoveScroll"),Rpe=O.forwardRef((e,t)=>{const{__scopeSelect:r,position:i="item-aligned",onCloseAutoFocus:n,onEscapeKeyDown:s,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:m,sticky:v,hideWhenDetached:y,avoidCollisions:x,...w}=e,_=am(l0,r),[S,P]=O.useState(null),[M,C]=O.useState(null),T=fn(t,ae=>P(ae)),[E,N]=O.useState(null),[D,I]=O.useState(null),j=$D(r),[L,B]=O.useState(!1),q=O.useRef(!1);O.useEffect(()=>{if(S)return vpe(S)},[S]),Ufe();const G=O.useCallback(ae=>{const[Z,...fe]=j().map(xe=>xe.ref.current),[he]=fe.slice(-1),Ae=document.activeElement;for(const xe of ae)if(xe===Ae||(xe?.scrollIntoView({block:"nearest"}),xe===Z&&M&&(M.scrollTop=0),xe===he&&M&&(M.scrollTop=M.scrollHeight),xe?.focus(),document.activeElement!==Ae))return},[j,M]),Y=O.useCallback(()=>G([E,S]),[G,E,S]);O.useEffect(()=>{L&&Y()},[L,Y]);const{onOpenChange:X,triggerPointerDownPosRef:re}=_;O.useEffect(()=>{if(S){let ae={x:0,y:0};const Z=he=>{ae={x:Math.abs(Math.round(he.pageX)-(re.current?.x??0)),y:Math.abs(Math.round(he.pageY)-(re.current?.y??0))}},fe=he=>{ae.x<=10&&ae.y<=10?he.preventDefault():S.contains(he.target)||X(!1),document.removeEventListener("pointermove",Z),re.current=null};return re.current!==null&&(document.addEventListener("pointermove",Z),document.addEventListener("pointerup",fe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Z),document.removeEventListener("pointerup",fe,{capture:!0})}}},[S,X,re]),O.useEffect(()=>{const ae=()=>X(!1);return window.addEventListener("blur",ae),window.addEventListener("resize",ae),()=>{window.removeEventListener("blur",ae),window.removeEventListener("resize",ae)}},[X]);const[F,$]=Xpe(ae=>{const Z=j().filter(Ae=>!Ae.disabled),fe=Z.find(Ae=>Ae.ref.current===document.activeElement),he=$pe(Z,ae,fe);he&&setTimeout(()=>he.ref.current.focus())}),se=O.useCallback((ae,Z,fe)=>{const he=!q.current&&!fe;(_.value!==void 0&&_.value===Z||he)&&(N(ae),he&&(q.current=!0))},[_.value]),H=O.useCallback(()=>S?.focus(),[S]),ne=O.useCallback((ae,Z,fe)=>{const he=!q.current&&!fe;(_.value!==void 0&&_.value===Z||he)&&I(ae)},[_.value]),ce=i==="popper"?Zz:Ipe,ie=ce===Zz?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:f,collisionPadding:m,sticky:v,hideWhenDetached:y,avoidCollisions:x}:{};return h.jsx(kpe,{scope:r,content:S,viewport:M,onViewportChange:C,itemRefCallback:se,selectedItem:E,onItemLeave:H,itemTextRefCallback:ne,focusSelectedItem:Y,selectedItemText:D,position:i,isPositioned:L,searchRef:F,children:h.jsx(gU,{as:_ft,allowPinchZoom:!0,children:h.jsx(sU,{asChild:!0,trapped:_.open,onMountAutoFocus:ae=>{ae.preventDefault()},onUnmountAutoFocus:ir(n,ae=>{_.trigger?.focus({preventScroll:!0}),ae.preventDefault()}),children:h.jsx(nU,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:ae=>ae.preventDefault(),onDismiss:()=>_.onOpenChange(!1),children:h.jsx(ce,{role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:ae=>ae.preventDefault(),...w,...ie,onPlaced:()=>B(!0),ref:T,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:ir(w.onKeyDown,ae=>{const Z=ae.ctrlKey||ae.altKey||ae.metaKey;if(ae.key==="Tab"&&ae.preventDefault(),!Z&&ae.key.length===1&&$(ae.key),["ArrowUp","ArrowDown","Home","End"].includes(ae.key)){let he=j().filter(Ae=>!Ae.disabled).map(Ae=>Ae.ref.current);if(["ArrowUp","End"].includes(ae.key)&&(he=he.slice().reverse()),["ArrowUp","ArrowDown"].includes(ae.key)){const Ae=ae.target,xe=he.indexOf(Ae);he=he.slice(xe+1)}setTimeout(()=>G(he)),ae.preventDefault()}})})})})})})});Rpe.displayName=wft;var Sft="SelectItemAlignedPosition",Ipe=O.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:i,...n}=e,s=am(l0,r),a=om(l0,r),[o,l]=O.useState(null),[c,u]=O.useState(null),d=fn(t,T=>u(T)),f=$D(r),m=O.useRef(!1),v=O.useRef(!0),{viewport:y,selectedItem:x,selectedItemText:w,focusSelectedItem:_}=a,S=O.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&c&&y&&x&&w){const T=s.trigger.getBoundingClientRect(),E=c.getBoundingClientRect(),N=s.valueNode.getBoundingClientRect(),D=w.getBoundingClientRect();if(s.dir!=="rtl"){const Ae=D.left-E.left,xe=N.left-Ae,Ee=T.left-xe,Be=T.width+Ee,$e=Math.max(Be,E.width),mt=window.innerWidth-gc,dt=mee(xe,[gc,Math.max(gc,mt-$e)]);o.style.minWidth=Be+"px",o.style.left=dt+"px"}else{const Ae=E.right-D.right,xe=window.innerWidth-N.right-Ae,Ee=window.innerWidth-T.right-xe,Be=T.width+Ee,$e=Math.max(Be,E.width),mt=window.innerWidth-gc,dt=mee(xe,[gc,Math.max(gc,mt-$e)]);o.style.minWidth=Be+"px",o.style.right=dt+"px"}const I=f(),j=window.innerHeight-gc*2,L=y.scrollHeight,B=window.getComputedStyle(c),q=parseInt(B.borderTopWidth,10),G=parseInt(B.paddingTop,10),Y=parseInt(B.borderBottomWidth,10),X=parseInt(B.paddingBottom,10),re=q+G+L+X+Y,F=Math.min(x.offsetHeight*5,re),$=window.getComputedStyle(y),se=parseInt($.paddingTop,10),H=parseInt($.paddingBottom,10),ne=T.top+T.height/2-gc,ce=j-ne,ie=x.offsetHeight/2,ae=x.offsetTop+ie,Z=q+G+ae,fe=re-Z;if(Z<=ne){const Ae=I.length>0&&x===I[I.length-1].ref.current;o.style.bottom="0px";const xe=c.clientHeight-y.offsetTop-y.offsetHeight,Ee=Math.max(ce,ie+(Ae?H:0)+xe+Y),Be=Z+Ee;o.style.height=Be+"px"}else{const Ae=I.length>0&&x===I[0].ref.current;o.style.top="0px";const Ee=Math.max(ne,q+y.offsetTop+(Ae?se:0)+ie)+fe;o.style.height=Ee+"px",y.scrollTop=Z-ne+y.offsetTop}o.style.margin=`${gc}px 0`,o.style.minHeight=F+"px",o.style.maxHeight=j+"px",i?.(),requestAnimationFrame(()=>m.current=!0)}},[f,s.trigger,s.valueNode,o,c,y,x,w,s.dir,i]);Ua(()=>S(),[S]);const[P,M]=O.useState();Ua(()=>{c&&M(window.getComputedStyle(c).zIndex)},[c]);const C=O.useCallback(T=>{T&&v.current===!0&&(S(),_?.(),v.current=!1)},[S,_]);return h.jsx(Aft,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:C,children:h.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:P},children:h.jsx(di.div,{...n,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...n.style}})})})});Ipe.displayName=Sft;var Eft="SelectPopperPosition",Zz=O.forwardRef((e,t)=>{const{__scopeSelect:r,align:i="start",collisionPadding:n=gc,...s}=e,a=KD(r);return h.jsx(fpe,{...a,...s,ref:t,align:i,collisionPadding:n,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Zz.displayName=Eft;var[Aft,vU]=Sb(l0,{}),Jz="SelectViewport",Ope=O.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:i,...n}=e,s=om(Jz,r),a=vU(Jz,r),o=fn(t,s.onViewportChange),l=O.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),h.jsx(XD.Slot,{scope:r,children:h.jsx(di.div,{"data-radix-select-viewport":"",role:"presentation",...n,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...n.style},onScroll:ir(n.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=a;if(f?.current&&d){const m=Math.abs(l.current-u.scrollTop);if(m>0){const v=window.innerHeight-gc*2,y=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),w=Math.max(y,x);if(w<v){const _=w+m,S=Math.min(v,_),P=_-S;d.style.height=S+"px",d.style.bottom==="0px"&&(u.scrollTop=P>0?P:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});Ope.displayName=Jz;var jpe="SelectGroup",[Cft,Tft]=Sb(jpe),Mft=O.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e,n=s0();return h.jsx(Cft,{scope:r,id:n,children:h.jsx(di.div,{role:"group","aria-labelledby":n,...i,ref:t})})});Mft.displayName=jpe;var Lpe="SelectLabel",Pft=O.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e,n=Tft(Lpe,r);return h.jsx(di.div,{id:n.id,...i,ref:t})});Pft.displayName=Lpe;var JP="SelectItem",[Dft,zpe]=Sb(JP),Bpe=O.forwardRef((e,t)=>{const{__scopeSelect:r,value:i,disabled:n=!1,textValue:s,...a}=e,o=am(JP,r),l=om(JP,r),c=o.value===i,[u,d]=O.useState(s??""),[f,m]=O.useState(!1),v=fn(t,_=>l.itemRefCallback?.(_,i,n)),y=s0(),x=O.useRef("touch"),w=()=>{n||(o.onValueChange(i),o.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(Dft,{scope:r,value:i,disabled:n,textId:y,isSelected:c,onItemTextChange:O.useCallback(_=>{d(S=>S||(_?.textContent??"").trim())},[]),children:h.jsx(XD.ItemSlot,{scope:r,value:i,disabled:n,textValue:u,children:h.jsx(di.div,{role:"option","aria-labelledby":y,"data-highlighted":f?"":void 0,"aria-selected":c&&f,"data-state":c?"checked":"unchecked","aria-disabled":n||void 0,"data-disabled":n?"":void 0,tabIndex:n?void 0:-1,...a,ref:v,onFocus:ir(a.onFocus,()=>m(!0)),onBlur:ir(a.onBlur,()=>m(!1)),onClick:ir(a.onClick,()=>{x.current!=="mouse"&&w()}),onPointerUp:ir(a.onPointerUp,()=>{x.current==="mouse"&&w()}),onPointerDown:ir(a.onPointerDown,_=>{x.current=_.pointerType}),onPointerMove:ir(a.onPointerMove,_=>{x.current=_.pointerType,n?l.onItemLeave?.():x.current==="mouse"&&_.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ir(a.onPointerLeave,_=>{_.currentTarget===document.activeElement&&l.onItemLeave?.()}),onKeyDown:ir(a.onKeyDown,_=>{l.searchRef?.current!==""&&_.key===" "||(pft.includes(_.key)&&w(),_.key===" "&&_.preventDefault())})})})})});Bpe.displayName=JP;var Iw="SelectItemText",Fpe=O.forwardRef((e,t)=>{const{__scopeSelect:r,className:i,style:n,...s}=e,a=am(Iw,r),o=om(Iw,r),l=zpe(Iw,r),c=yft(Iw,r),[u,d]=O.useState(null),f=fn(t,w=>d(w),l.onItemTextChange,w=>o.itemTextRefCallback?.(w,l.value,l.disabled)),m=u?.textContent,v=O.useMemo(()=>h.jsx("option",{value:l.value,disabled:l.disabled,children:m},l.value),[l.disabled,l.value,m]),{onNativeOptionAdd:y,onNativeOptionRemove:x}=c;return Ua(()=>(y(v),()=>x(v)),[y,x,v]),h.jsxs(h.Fragment,{children:[h.jsx(di.span,{id:l.textId,...s,ref:f}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?mS.createPortal(s.children,a.valueNode):null]})});Fpe.displayName=Iw;var Vpe="SelectItemIndicator",Upe=O.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e;return zpe(Vpe,r).isSelected?h.jsx(di.span,{"aria-hidden":!0,...i,ref:t}):null});Upe.displayName=Vpe;var e6="SelectScrollUpButton",Hpe=O.forwardRef((e,t)=>{const r=om(e6,e.__scopeSelect),i=vU(e6,e.__scopeSelect),[n,s]=O.useState(!1),a=fn(t,i.onScrollButtonChange);return Ua(()=>{if(r.viewport&&r.isPositioned){let o=function(){const c=l.scrollTop>0;s(c)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),n?h.jsx(Wpe,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});Hpe.displayName=e6;var t6="SelectScrollDownButton",Gpe=O.forwardRef((e,t)=>{const r=om(t6,e.__scopeSelect),i=vU(t6,e.__scopeSelect),[n,s]=O.useState(!1),a=fn(t,i.onScrollButtonChange);return Ua(()=>{if(r.viewport&&r.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;s(u)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),n?h.jsx(Wpe,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});Gpe.displayName=t6;var Wpe=O.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:i,...n}=e,s=om("SelectScrollButton",r),a=O.useRef(null),o=$D(r),l=O.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return O.useEffect(()=>()=>l(),[l]),Ua(()=>{o().find(u=>u.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[o]),h.jsx(di.div,{"aria-hidden":!0,...n,ref:t,style:{flexShrink:0,...n.style},onPointerDown:ir(n.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(i,50))}),onPointerMove:ir(n.onPointerMove,()=>{s.onItemLeave?.(),a.current===null&&(a.current=window.setInterval(i,50))}),onPointerLeave:ir(n.onPointerLeave,()=>{l()})})}),Nft="SelectSeparator",kft=O.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e;return h.jsx(di.div,{"aria-hidden":!0,...i,ref:t})});kft.displayName=Nft;var r6="SelectArrow",Rft=O.forwardRef((e,t)=>{const{__scopeSelect:r,...i}=e,n=KD(r),s=am(r6,r),a=om(r6,r);return s.open&&a.position==="popper"?h.jsx(ppe,{...n,...i,ref:t}):null});Rft.displayName=r6;var Ift="SelectBubbleInput",qpe=O.forwardRef(({__scopeSelect:e,value:t,...r},i)=>{const n=O.useRef(null),s=fn(i,n),a=Cht(t);return O.useEffect(()=>{const o=n.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),h.jsx(di.select,{...r,style:{...mpe,...r.style},ref:s,defaultValue:t})});qpe.displayName=Ift;function Ype(e){return e===""||e===void 0}function Xpe(e){const t=ld(e),r=O.useRef(""),i=O.useRef(0),n=O.useCallback(a=>{const o=r.current+a;t(o),function l(c){r.current=c,window.clearTimeout(i.current),c!==""&&(i.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),s=O.useCallback(()=>{r.current="",window.clearTimeout(i.current)},[]);return O.useEffect(()=>()=>window.clearTimeout(i.current),[]),[r,n,s]}function $pe(e,t,r){const n=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let a=Oft(e,Math.max(s,0));n.length===1&&(a=a.filter(c=>c!==r));const l=a.find(c=>c.textValue.toLowerCase().startsWith(n.toLowerCase()));return l!==r?l:void 0}function Oft(e,t){return e.map((r,i)=>e[(t+i)%e.length])}var jft=Epe,Lft=Cpe,zft=Mpe,Bft=Ppe,Fft=Dpe,Vft=Npe,Uft=Ope,Hft=Bpe,Gft=Fpe,Wft=Upe,qft=Hpe,Yft=Gpe;function Xft({...e}){return h.jsx(jft,{"data-slot":"select",...e})}function $ft({...e}){return h.jsx(zft,{"data-slot":"select-value",...e})}function Kft({className:e,size:t="default",children:r,...i}){return h.jsxs(Lft,{"data-slot":"select-trigger","data-size":t,className:Nn("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...i,children:[r,h.jsx(Bft,{asChild:!0,children:h.jsx(KV,{className:"size-4 opacity-50"})})]})}function Qft({className:e,children:t,position:r="popper",...i}){return h.jsx(Fft,{children:h.jsxs(Vft,{"data-slot":"select-content",className:Nn("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...i,children:[h.jsx(Zft,{}),h.jsx(Uft,{className:Nn("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),h.jsx(Jft,{})]})})}function IO({className:e,children:t,...r}){return h.jsxs(Hft,{"data-slot":"select-item",className:Nn("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...r,children:[h.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:h.jsx(Wft,{children:h.jsx(sm,{className:"size-4"})})}),h.jsx(Gft,{children:t})]})}function Zft({className:e,...t}){return h.jsx(qft,{"data-slot":"select-scroll-up-button",className:Nn("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(Nat,{className:"size-4"})})}function Jft({className:e,...t}){return h.jsx(Yft,{"data-slot":"select-scroll-down-button",className:Nn("flex cursor-default items-center justify-center py-1",e),...t,children:h.jsx(KV,{className:"size-4"})})}var OO="rovingFocusGroup.onEntryFocus",ept={bubbles:!1,cancelable:!0},vS="RovingFocusGroup",[i6,Kpe,tpt]=iU(vS),[rpt,QD]=S0(vS,[tpt]),[ipt,npt]=rpt(vS),Qpe=O.forwardRef((e,t)=>h.jsx(i6.Provider,{scope:e.__scopeRovingFocusGroup,children:h.jsx(i6.Slot,{scope:e.__scopeRovingFocusGroup,children:h.jsx(spt,{...e,ref:t})})}));Qpe.displayName=vS;var spt=O.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:i,loop:n=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,f=O.useRef(null),m=fn(t,f),v=UD(s),[y,x]=g_({prop:a,defaultProp:o??null,onChange:l,caller:vS}),[w,_]=O.useState(!1),S=ld(c),P=Kpe(r),M=O.useRef(!1),[C,T]=O.useState(0);return O.useEffect(()=>{const E=f.current;if(E)return E.addEventListener(OO,S),()=>E.removeEventListener(OO,S)},[S]),h.jsx(ipt,{scope:r,orientation:i,dir:v,loop:n,currentTabStopId:y,onItemFocus:O.useCallback(E=>x(E),[x]),onItemShiftTab:O.useCallback(()=>_(!0),[]),onFocusableItemAdd:O.useCallback(()=>T(E=>E+1),[]),onFocusableItemRemove:O.useCallback(()=>T(E=>E-1),[]),children:h.jsx(di.div,{tabIndex:w||C===0?-1:0,"data-orientation":i,...d,ref:m,style:{outline:"none",...e.style},onMouseDown:ir(e.onMouseDown,()=>{M.current=!0}),onFocus:ir(e.onFocus,E=>{const N=!M.current;if(E.target===E.currentTarget&&N&&!w){const D=new CustomEvent(OO,ept);if(E.currentTarget.dispatchEvent(D),!D.defaultPrevented){const I=P().filter(G=>G.focusable),j=I.find(G=>G.active),L=I.find(G=>G.id===y),q=[j,L,...I].filter(Boolean).map(G=>G.ref.current);eme(q,u)}}M.current=!1}),onBlur:ir(e.onBlur,()=>_(!1))})})}),Zpe="RovingFocusGroupItem",Jpe=O.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:i=!0,active:n=!1,tabStopId:s,children:a,...o}=e,l=s0(),c=s||l,u=npt(Zpe,r),d=u.currentTabStopId===c,f=Kpe(r),{onFocusableItemAdd:m,onFocusableItemRemove:v,currentTabStopId:y}=u;return O.useEffect(()=>{if(i)return m(),()=>v()},[i,m,v]),h.jsx(i6.ItemSlot,{scope:r,id:c,focusable:i,active:n,children:h.jsx(di.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:ir(e.onMouseDown,x=>{i?u.onItemFocus(c):x.preventDefault()}),onFocus:ir(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:ir(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){u.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const w=lpt(x,u.orientation,u.dir);if(w!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let S=f().filter(P=>P.focusable).map(P=>P.ref.current);if(w==="last")S.reverse();else if(w==="prev"||w==="next"){w==="prev"&&S.reverse();const P=S.indexOf(x.currentTarget);S=u.loop?cpt(S,P+1):S.slice(P+1)}setTimeout(()=>eme(S))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:y!=null}):a})})});Jpe.displayName=Zpe;var apt={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function opt(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function lpt(e,t,r){const i=opt(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return apt[i]}function eme(e,t=!1){const r=document.activeElement;for(const i of e)if(i===r||(i.focus({preventScroll:t}),document.activeElement!==r))return}function cpt(e,t){return e.map((r,i)=>e[(t+i)%e.length])}var tme=Qpe,rme=Jpe;function upt(e,t){return O.useReducer((r,i)=>t[r][i]??r,e)}var Eb=e=>{const{present:t,children:r}=e,i=dpt(t),n=typeof r=="function"?r({present:i.isPresent}):O.Children.only(r),s=fn(i.ref,hpt(n));return typeof r=="function"||i.isPresent?O.cloneElement(n,{ref:s}):null};Eb.displayName="Presence";function dpt(e){const[t,r]=O.useState(),i=O.useRef(null),n=O.useRef(e),s=O.useRef("none"),a=e?"mounted":"unmounted",[o,l]=upt(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return O.useEffect(()=>{const c=LC(i.current);s.current=o==="mounted"?c:"none"},[o]),Ua(()=>{const c=i.current,u=n.current;if(u!==e){const f=s.current,m=LC(c);e?l("MOUNT"):m==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&f!==m?"ANIMATION_OUT":"UNMOUNT"),n.current=e}},[e,l]),Ua(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=m=>{const y=LC(i.current).includes(m.animationName);if(m.target===t&&y&&(l("ANIMATION_END"),!n.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},f=m=>{m.target===t&&(s.current=LC(i.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:O.useCallback(c=>{i.current=c?getComputedStyle(c):null,r(c)},[])}}function LC(e){return e?.animationName||"none"}function hpt(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var ZD="Tabs",[fpt,PEt]=S0(ZD,[QD]),ime=QD(),[ppt,yU]=fpt(ZD),nme=O.forwardRef((e,t)=>{const{__scopeTabs:r,value:i,onValueChange:n,defaultValue:s,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=UD(o),[d,f]=g_({prop:i,onChange:n,defaultProp:s??"",caller:ZD});return h.jsx(ppt,{scope:r,baseId:s0(),value:d,onValueChange:f,orientation:a,dir:u,activationMode:l,children:h.jsx(di.div,{dir:u,"data-orientation":a,...c,ref:t})})});nme.displayName=ZD;var sme="TabsList",ame=O.forwardRef((e,t)=>{const{__scopeTabs:r,loop:i=!0,...n}=e,s=yU(sme,r),a=ime(r);return h.jsx(tme,{asChild:!0,...a,orientation:s.orientation,dir:s.dir,loop:i,children:h.jsx(di.div,{role:"tablist","aria-orientation":s.orientation,...n,ref:t})})});ame.displayName=sme;var ome="TabsTrigger",lme=O.forwardRef((e,t)=>{const{__scopeTabs:r,value:i,disabled:n=!1,...s}=e,a=yU(ome,r),o=ime(r),l=dme(a.baseId,i),c=hme(a.baseId,i),u=i===a.value;return h.jsx(rme,{asChild:!0,...o,focusable:!n,active:u,children:h.jsx(di.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:l,...s,ref:t,onMouseDown:ir(e.onMouseDown,d=>{!n&&d.button===0&&d.ctrlKey===!1?a.onValueChange(i):d.preventDefault()}),onKeyDown:ir(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(i)}),onFocus:ir(e.onFocus,()=>{const d=a.activationMode!=="manual";!u&&!n&&d&&a.onValueChange(i)})})})});lme.displayName=ome;var cme="TabsContent",ume=O.forwardRef((e,t)=>{const{__scopeTabs:r,value:i,forceMount:n,children:s,...a}=e,o=yU(cme,r),l=dme(o.baseId,i),c=hme(o.baseId,i),u=i===o.value,d=O.useRef(u);return O.useEffect(()=>{const f=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(f)},[]),h.jsx(Eb,{present:n||u,children:({present:f})=>h.jsx(di.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!f,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:f&&s})})});ume.displayName=cme;function dme(e,t){return`${e}-trigger-${t}`}function hme(e,t){return`${e}-content-${t}`}var mpt=nme,gpt=ame,vpt=lme,ypt=ume;function JD({className:e,...t}){return h.jsx(mpt,{"data-slot":"tabs",className:Nn("flex flex-col gap-2",e),...t})}function eN({className:e,...t}){return h.jsx(gpt,{"data-slot":"tabs-list",className:Nn("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function Vl({className:e,...t}){return h.jsx(vpt,{"data-slot":"tabs-trigger",className:Nn("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function Sc({className:e,...t}){return h.jsx(ypt,{"data-slot":"tabs-content",className:Nn("flex-1 outline-none",e),...t})}const xpt=Tfe("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function e3({className:e,variant:t,asChild:r=!1,...i}){const n=r?Efe:"span";return h.jsx(n,{"data-slot":"badge",className:Nn(xpt({variant:t}),e),...i})}const bpt=()=>{const e=()=>typeof window<"u"&&document.documentElement.classList.contains("dark")?"dark":"light",[t,r]=O.useState(e());return O.useEffect(()=>{const i=new MutationObserver(()=>{r(e())});return i.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>i.disconnect()},[]),t},wpt=({code:e,setCode:t,language:r,theme:i})=>h.jsxs("div",{className:"relative group",children:[h.jsx("div",{className:"absolute top-3 right-3 z-10",children:h.jsx(e3,{variant:"secondary",className:"bg-primary/10 text-primary border-primary/20",children:r})}),h.jsx("div",{className:"rounded-lg overflow-hidden border shadow-inner dark:shadow-black/20 bg-card",children:h.jsx(fS,{height:"400px",language:r?.toLowerCase()||"javascript",theme:i==="dark"?"vs-dark":"light",value:e,onChange:n=>t(n||""),options:{fontSize:14,wordWrap:"on",scrollBeyondLastLine:!1,minimap:{enabled:!0},automaticLayout:!0,tabSize:2,insertSpaces:!0,lineNumbers:"on",renderLineHighlight:"all",selectionHighlight:!1,contextmenu:!1,roundedSelection:!1,scrollbar:{verticalScrollbarSize:8,horizontalScrollbarSize:8},semanticHighlighting:!0}})})]}),_pt=({item:e,onChange:t})=>h.jsxs(kp,{className:"border-info/20 bg-gradient-to-br from-info/5 to-transparent dark:from-info/10 dark:to-transparent",children:[h.jsxs(f_,{className:"pb-4",children:[h.jsxs(FD,{className:"text-lg text-info flex items-center gap-2",children:[h.jsx(Qu,{className:"w-5 h-5"}),"Test Case Details"]}),h.jsx(VD,{children:"This test case will be visible to users as an example"})]}),h.jsxs(pS,{className:"space-y-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsxs(Fl,{className:"text-base font-medium flex items-center gap-2",children:[h.jsx($V,{className:"w-4 h-4"}),"Explanation"]}),h.jsx(Qy,{value:e.explanation,onChange:r=>t({...e,explanation:r.target.value}),className:"min-h-[100px] resize-y focus:ring-info/20",placeholder:"Explain the logic and expected outcome..."})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsxs(Fl,{className:"text-base font-medium flex items-center gap-2",children:[h.jsx(sl,{className:"w-4 h-4"}),"Input"]}),h.jsx(Qy,{value:e.input,onChange:r=>t({...e,input:r.target.value}),className:"font-mono text-sm min-h-[120px] resize-y focus:ring-info/20",placeholder:`e.g.,
[1, 2, 3]
"hello"`})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs(Fl,{className:"text-base font-medium flex items-center gap-2",children:[h.jsx(eU,{className:"w-4 h-4"}),"Expected Output"]}),h.jsx(Qy,{value:e.output,onChange:r=>t({...e,output:r.target.value}),className:"font-mono text-sm min-h-[120px] resize-y focus:ring-info/20",placeholder:`e.g.,
6
"olleh"`})]})]})]})]}),Spt=({item:e,onChange:t})=>h.jsxs(kp,{className:"border-warning/20 bg-gradient-to-br from-warning/5 to-transparent dark:from-warning/10 dark:to-transparent",children:[h.jsxs(f_,{className:"pb-4",children:[h.jsxs(FD,{className:"text-lg text-warning flex items-center gap-2",children:[h.jsx(Fz,{className:"w-5 h-5"}),"Hidden Test Case"]}),h.jsx(VD,{children:"This test case will be used for validation but not shown to users"})]}),h.jsx(pS,{children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsxs(Fl,{className:"text-base font-medium flex items-center gap-2",children:[h.jsx(sl,{className:"w-4 h-4"}),"Hidden Input"]}),h.jsx(Qy,{value:e.input,onChange:r=>t({...e,input:r.target.value}),className:"font-mono text-sm min-h-[120px] resize-y focus:ring-warning/20",placeholder:`e.g.,
[10, 20, 30]
"edge case"`})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs(Fl,{className:"text-base font-medium flex items-center gap-2",children:[h.jsx(eU,{className:"w-4 h-4"}),"Expected Output"]}),h.jsx(Qy,{value:e.output,onChange:r=>t({...e,output:r.target.value}),className:"font-mono text-sm min-h-[120px] resize-y focus:ring-warning/20",placeholder:`e.g.,
60
"esac egde"`})]})]})})]}),t3=({item:e,onChange:t,theme:r})=>{const i="complete_code"in e,n=i?"complete_code":"initial_code",s=i?"Complete Solution Code":"Initial Starter Code",a=o=>t({...e,[n]:o});return h.jsxs(kp,{className:"border-primary/20 bg-gradient-to-br from-primary/5 to-transparent dark:from-primary/10 dark:to-transparent",children:[h.jsxs(f_,{className:"pb-4",children:[h.jsxs(FD,{className:"text-lg text-primary flex items-center gap-2",children:[h.jsx(jz,{className:"w-5 h-5"}),s]}),h.jsx(VD,{children:i?"The complete solution for this problem":"Starter code template for users"})]}),h.jsxs(pS,{className:"space-y-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Fl,{className:"text-base font-medium",children:"Language"}),h.jsx(BT,{type:"text",value:e.language,onChange:o=>t({...e,language:o.target.value}),placeholder:"e.g., javascript",className:"max-w-xs"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Fl,{className:"text-base font-medium",children:s}),h.jsx(wpt,{code:e[n],setCode:a,language:e.language,theme:r})]})]})]})},zC=({title:e,field:t,data:r,setData:i,Component:n,icon:s,description:a,theme:o})=>{const l=(f,m)=>{const v=[...r];v[f]=m,i(t,v)},c=()=>{const f=t.includes("code")?{language:"javascript",[t==="start_code"?"initial_code":"complete_code"]:""}:t.includes("hidden")?{input:"",output:""}:{input:"",output:"",explanation:""};i(t,[...r,f])},u=f=>i(t,r.filter((m,v)=>v!==f)),d=f=>n===t3?h.jsx(t3,{...f,theme:o}):h.jsx(n,{...f});return h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{"data-aos":"fade-in",className:"flex items-center justify-between",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsxs("h3",{className:"text-2xl font-bold flex items-center gap-2",children:[h.jsx(s,{className:"w-6 h-6 text-primary"}),e]}),h.jsx("p",{className:"text-muted-foreground",children:a})]}),h.jsxs(Fn,{type:"button",onClick:c,className:"bg-blue-500 hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 text-white shadow-soft",children:[h.jsx(Hl,{className:"w-4 h-4 mr-2"}),"Add New"]})]}),h.jsxs("div",{className:"space-y-4",children:[r?.map((f,m)=>h.jsxs("div",{"data-aos":"zoom-in-up","data-aos-delay":m*100,className:"relative group",children:[h.jsx("div",{className:"absolute top-4 right-4 z-10 opacity-0 group-hover:opacity-100 transition-opacity",children:h.jsx(Fn,{variant:"destructive",size:"sm",onClick:()=>u(m),className:"h-8 w-8 p-0",children:h.jsx(Ic,{className:"w-4 h-4"})})}),d({item:f,index:m,onChange:v=>l(m,v)})]},m)),r?.length===0&&h.jsx(kp,{"data-aos":"fade-in",className:"border-dashed border-2 border-muted-foreground/20",children:h.jsxs(pS,{className:"py-12 text-center",children:[h.jsx(s,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground/50"}),h.jsxs("h4",{className:"text-lg font-semibold text-muted-foreground",children:["No ",e.toLowerCase()," yet"]}),h.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:'Click "Add New" to create your first one'})]})})]})]})},Ept=()=>{const{problemId:e}=Qp(),t=fs(),[r,i]=O.useState(null),[n,s]=O.useState(!0),[a,o]=O.useState(!1),[l,c]=O.useState(null),[u,d]=O.useState("visible_testcase"),[f,m]=O.useState(!1),[v,y]=O.useState("idle"),[x,w]=O.useState({message:"",type:"idle"}),_=bpt();O.useEffect(()=>{Hn.init({duration:800,once:!1,easing:"ease-out-cubic"})},[]),O.useEffect(()=>{if(!e){c("No problem ID provided."),s(!1);return}(async()=>{try{s(!0);const C=await jt.get(`/problem/getParticularProblem?by=id&value=${e}`);i(C.data.problem)}catch(C){c(C.message||"Failed to fetch problem details.")}finally{s(!1)}})()},[e]),O.useEffect(()=>{if(x.message){const M=setTimeout(()=>{w({message:"",type:"idle"})},4e3);return()=>clearTimeout(M)}},[x]);const S=(M,C)=>{i(T=>({...T,[M]:C})),f||m(!0),y("idle")},P=async M=>{M.preventDefault(),o(!0),y("saving"),c(null);try{await jt.put(`/problem/update?by=id&value=${e}`,r),y("saved"),m(!1),w({message:"Problem updated successfully!",type:"success"}),setTimeout(()=>y("idle"),3e3)}catch(C){const T=C.response?.data?.message||"An error occurred while saving.";c(T),y("error"),w({message:T,type:"error"})}finally{o(!1)}};return h.jsx("div",{className:"min-h-screen bg-background transition-colors",children:h.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6 lg:p-8",children:[h.jsxs("form",{onSubmit:P,className:"space-y-8",children:[h.jsx(kp,{"data-aos":"fade-down",className:"bg-card border shadow-sm",children:h.jsxs(f_,{className:"p-6",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-primary to-primary/70 rounded-lg flex items-center justify-center shadow-md",children:h.jsx(dS,{className:"w-6 h-6 text-primary-foreground"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-card-foreground",children:"Edit Problem"}),h.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["#",r?.serial_number," – ",r?.title]})]})]}),h.jsxs(Fn,{type:"button",variant:"outline",onClick:()=>t(-1),className:"flex items-center gap-2",children:[h.jsx(rfe,{className:"w-4 h-4"}),"Back"]})]}),l&&v==="error"&&h.jsx("div",{className:"mt-4 p-3 bg-destructive/10 border border-destructive/20 rounded-lg",children:h.jsx("p",{className:"text-sm text-destructive",children:l})})]})}),h.jsxs(kp,{"data-aos":"fade-up",className:"bg-card border shadow-sm",children:[h.jsxs(f_,{children:[h.jsxs(FD,{className:"flex items-center gap-3",children:[h.jsx($V,{className:"w-6 h-6 text-primary"}),"Core Information"]}),h.jsx(VD,{children:"Basic details and description of the problem"})]}),h.jsxs(pS,{className:"space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Fl,{children:"Title"}),h.jsx(BT,{value:r?.title||"",onChange:M=>S("title",M.target.value),placeholder:"Enter problem title",required:!0})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Fl,{children:"Tags"}),h.jsx(BT,{value:r?.tags||"",onChange:M=>S("tags",M.target.value),placeholder:"array, sorting, dynamic-programming",required:!0})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(Fl,{children:"Serial Number"}),h.jsx(BT,{type:"number",value:r?.serial_number||"",onChange:M=>S("serial_number",parseInt(M.target.value||"0")),placeholder:"1001",required:!0})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Fl,{children:"Difficulty"}),h.jsxs(Xft,{value:r?.difficulty||"",onValueChange:M=>S("difficulty",M),children:[h.jsx(Kft,{children:h.jsx($ft,{placeholder:"Select difficulty"})}),h.jsxs(Qft,{children:[h.jsx(IO,{value:"Easy",children:"Easy"}),h.jsx(IO,{value:"Medium",children:"Medium"}),h.jsx(IO,{value:"Hard",children:"Hard"})]})]})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Fl,{children:"Description"}),h.jsx(Qy,{value:r?.description||"",onChange:M=>S("description",M.target.value),placeholder:"Describe the problem in detail...",className:"min-h-[180px] resize-y",required:!0})]})]})]}),h.jsx(kp,{"data-aos":"fade-up","data-aos-delay":"200",className:"bg-card border shadow-sm overflow-hidden",children:h.jsxs(JD,{value:u,onValueChange:d,className:"w-full",children:[h.jsxs(eN,{className:"grid w-full grid-cols-2 md:grid-cols-4 h-auto rounded-none",children:[h.jsxs(Vl,{value:"visible_testcase",className:"py-3 gap-2 data-[state=active]:bg-muted",children:[h.jsx(Qu,{className:"w-4 h-4"}),"Visible Tests"]}),h.jsxs(Vl,{value:"hidden_testcase",className:"py-3 gap-2 data-[state=active]:bg-muted",children:[h.jsx(Fz,{className:"w-4 h-4"}),"Hidden Tests"]}),h.jsxs(Vl,{value:"start_code",className:"py-3 gap-2 data-[state=active]:bg-muted",children:[h.jsx(jz,{className:"w-4 h-4"}),"Starter Code"]}),h.jsxs(Vl,{value:"problem_solution",className:"py-3 gap-2 data-[state=active]:bg-muted",children:[h.jsx(Sh,{className:"w-4 h-4"}),"Solutions"]})]}),h.jsxs("div",{className:"p-6",children:[h.jsx(Sc,{value:"visible_testcase",className:"mt-0",children:h.jsx(zC,{title:"Visible Test Cases",field:"visible_testcase",data:r?.visible_testcase||[],setData:S,Component:_pt,icon:Qu,description:"Test cases that users can see as examples"})}),h.jsx(Sc,{value:"hidden_testcase",className:"mt-0",children:h.jsx(zC,{title:"Hidden Test Cases",field:"hidden_testcase",data:r?.hidden_testcase||[],setData:S,Component:Spt,icon:Fz,description:"Test cases used for validation but not shown to users"})}),h.jsx(Sc,{value:"start_code",className:"mt-0",children:h.jsx(zC,{title:"Starter Code",field:"start_code",data:r?.start_code||[],setData:S,Component:t3,icon:jz,description:"Initial code templates for different programming languages",theme:_})}),h.jsx(Sc,{value:"problem_solution",className:"mt-0",children:h.jsx(zC,{title:"Solution Code",field:"problem_solution",data:r?.problem_solution||[],setData:S,Component:t3,icon:Sh,description:"Complete solutions for the problem in different languages",theme:_})})]})]})}),h.jsx("div",{className:`fixed bottom-8 right-8 transition-all duration-500 z-50 ${f?"opacity-100 translate-y-0":"opacity-0 translate-y-10 pointer-events-none"}`,children:h.jsxs(Fn,{type:"submit",size:"lg",disabled:a,className:`shadow-lg transition-all duration-300 ${v==="saved"?"bg-green-600 hover:bg-green-700":v==="error"?"bg-destructive hover:bg-destructive/90":"bg-primary hover:bg-primary/90"}`,children:[a&&h.jsx("div",{className:"w-4 h-4 border-2 border-primary-foreground border-t-transparent rounded-full animate-spin mr-2"}),v==="saved"&&h.jsx(Sh,{className:"w-4 h-4 mr-2"}),v==="error"&&h.jsx(Dh,{className:"w-4 h-4 mr-2"}),v==="idle"&&h.jsx(Qot,{className:"w-4 h-4 mr-2"}),a?"Saving...":v==="saved"?"Saved!":v==="error"?"Try Again":"Save Changes"]})})]}),h.jsx("div",{className:"toast toast-center bottom-24 right-8 z-50",children:h.jsx("div",{className:`transition-all duration-300 ${x.message?"opacity-100 translate-y-0":"opacity-0 translate-y-5"}`,children:x.message&&h.jsxs("div",{className:`alert ${x.type==="success"?"alert-success":"alert-error"} shadow-lg flex items-center`,children:[x.type==="success"?h.jsx(Sh,{className:"w-5 h-5"}):h.jsx(Dh,{className:"w-5 h-5"}),h.jsx("span",{children:x.message})]})})})]})})};function Apt(){const[e,t]=O.useState([]),[r,i]=O.useState(""),[n,s]=O.useState([]),[a,o]=O.useState(!0),[l,c]=O.useState(null),[u,d]=O.useState("grid"),[f,m]=O.useState(null),[v,y]=O.useState(""),[x,w]=O.useState({message:"",type:""});fs(),O.useEffect(()=>{(async()=>{try{o(!0);const C=await jt.get("/problem/getAllProblem");t(C.data.problem)}catch(C){c(C.message||"Failed to fetch problems.")}finally{o(!1)}})()},[]),O.useEffect(()=>{const M=r.toLowerCase(),C=e.filter(T=>T.title.toLowerCase().includes(M)||String(T.serial_number).includes(M));s(C)},[r,e]),O.useEffect(()=>{if(x.message){const M=setTimeout(()=>w({message:"",type:""}),4e3);return()=>clearTimeout(M)}},[x]);const _=async()=>{if(!f||String(v)!==String(f.serial_number)){w({message:"Serial number does not match. Deletion cancelled.",type:"error"});return}try{await jt.delete(`/problem/delete?by=id&value=${f._id}`),t(M=>M.filter(C=>C._id!==f._id)),w({message:`Problem "${f.title}" deleted successfully.`,type:"success"})}catch(M){w({message:M.response?.data?.message||"Deletion failed.",type:"error"})}finally{m(null),y("")}},S=M=>{switch(M.toLowerCase()){case"easy":return"badge-success";case"medium":return"badge-warning";case"hard":return"badge-error";default:return"badge-neutral"}},P=()=>a?h.jsx("div",{className:"flex justify-center p-16",children:h.jsx("span",{className:"loading loading-spinner loading-lg text-primary"})}):l?h.jsx("div",{className:"alert alert-error",children:h.jsx("span",{children:l})}):e.length>0&&n.length===0?h.jsxs("div",{className:"text-center py-16",children:[h.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),h.jsx("h3",{className:"text-xl font-semibold",children:"No problems match your search."})]}):n.length===0?h.jsxs("div",{className:"text-center py-16",children:[h.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),h.jsx("h3",{className:"text-xl font-semibold",children:"No problems to manage."})]}):u==="grid"?h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:n.map(M=>h.jsx("div",{className:"card bg-base-200/50 shadow-lg transition-all duration-300 hover:shadow-error/20 hover:border-error border border-transparent group",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"flex items-start justify-between mb-3",children:[h.jsxs("div",{className:"badge badge-outline font-bold",children:["#",M.serial_number]}),h.jsx("div",{className:`badge ${S(M.difficulty)} font-semibold`,children:M.difficulty})]}),h.jsx("h2",{className:"card-title text-lg mb-1 line-clamp-2",children:M.title}),h.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:M.tags.split(",").map((C,T)=>h.jsx("span",{className:"badge badge-ghost badge-sm",children:C.trim()},T))}),h.jsx("div",{className:"card-actions justify-end",children:h.jsxs("button",{className:"btn btn-error btn-sm gap-2 text-white",onClick:()=>m(M),children:[h.jsx(Ic,{size:14})," Delete"]})})]})},M._id))}):h.jsx("div",{className:"overflow-x-auto rounded-lg border border-base-300",children:h.jsxs("table",{className:"table w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"S.No."}),h.jsx("th",{children:"Title"}),h.jsx("th",{children:"Difficulty"}),h.jsx("th",{className:"text-right",children:"Action"})]})}),h.jsx("tbody",{children:n.map(M=>h.jsxs("tr",{className:"hover",children:[h.jsxs("td",{className:"font-bold",children:["#",M.serial_number]}),h.jsx("td",{className:"font-semibold max-w-sm truncate",children:M.title}),h.jsx("td",{children:h.jsx("div",{className:`badge ${S(M.difficulty)}`,children:M.difficulty})}),h.jsx("td",{className:"text-right",children:h.jsxs("button",{className:"btn btn-error btn-sm gap-2 text-white",onClick:()=>m(M),children:[h.jsx(Ic,{size:14})," Delete"]})})]},M._id))})]})});return h.jsxs("div",{className:"relative min-h-screen bg-base-200 w-full p-4 sm:p-6 lg:p-8",children:[h.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto",children:[h.jsxs("div",{className:"text-center mb-12",children:[h.jsx(afe,{size:48,className:"mx-auto text-primary mb-4"}),h.jsx("h1",{className:"text-4xl sm:text-5xl font-bold",children:"Manage Problems"}),h.jsx("p",{className:"text-base-content/70 mt-2 text-lg",children:"Search, view, and permanently delete problems."}),h.jsxs("div",{className:"mt-6 inline-block",children:[h.jsx("div",{className:"text-sm text-base-content/70 font-medium",children:"Total Problems"}),h.jsx("div",{className:"text-3xl font-bold text-primary mt-1",children:h.jsx(_c,{from:0,to:e.length,separator:",",direction:"up",duration:2,className:"count-up-text"})})]})]}),h.jsx("div",{className:"card bg-base-100 shadow-xl",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between mb-6 pb-6 border-b border-base-300",children:[h.jsx("div",{className:"form-control w-full md:max-w-md",children:h.jsxs("div",{className:"relative w-full",children:[h.jsx(Wh,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-base-content/50"}),h.jsx("input",{type:"text",placeholder:"Search by title or S.No...",className:"input input-bordered w-full pl-12",value:r,onChange:M=>i(M.target.value)})]})}),h.jsxs("div",{className:"join",children:[h.jsxs("button",{className:`btn join-item gap-2 ${u==="grid"?"btn-primary":""}`,onClick:()=>d("grid"),children:[h.jsx(OD,{size:16}),"Grid"]}),h.jsxs("button",{className:`btn join-item gap-2 ${u==="table"?"btn-primary":""}`,onClick:()=>d("table"),children:[h.jsx(Eh,{size:16}),"Table"]})]})]}),P()]})})]}),h.jsx("input",{type:"checkbox",id:"delete-confirm-modal",className:"modal-toggle",checked:!!f,readOnly:!0}),h.jsx("div",{className:"modal modal-bottom sm:modal-middle",children:h.jsxs("div",{className:"modal-box",children:[h.jsx(ZV,{className:"w-16 h-16 text-error mx-auto mb-4"}),h.jsx("h3",{className:"font-bold text-lg text-center",children:"Confirm Deletion"}),h.jsx("p",{className:"py-2 text-center text-sm",children:"This action is irreversible. To confirm, type the problem's serial number."}),h.jsx("p",{className:"text-center font-mono text-lg p-2 bg-error/10 text-error rounded-md my-2",children:f?.serial_number}),h.jsx("div",{className:"form-control mt-4",children:h.jsx("input",{type:"text",className:"input input-bordered w-full text-center font-bold",placeholder:"Type serial number here...",value:v,onChange:M=>y(M.target.value)})}),h.jsxs("div",{className:"modal-action justify-center gap-4 mt-4",children:[h.jsx("button",{className:"btn",onClick:()=>{m(null),y("")},children:"Cancel"}),h.jsxs("button",{className:"btn btn-error text-white",onClick:_,disabled:String(v)!==String(f?.serial_number),children:[h.jsx(Ic,{size:14})," Yes, Delete It"]})]})]})}),x.message&&h.jsx("div",{className:"toast toast-top toast-center min-w-max z-50",children:h.jsx("div",{className:`alert ${x.type==="success"?"alert-success":"alert-error"}`,children:h.jsx("span",{children:x.message})})})]})}const Cpt=({credentials:e,onClose:t})=>{const[r,i]=O.useState("Copy"),n=()=>{const s=`Email: ${e.email}
Password: ${e.password}`;navigator.clipboard.writeText(s).then(()=>{i("Copied!"),setTimeout(()=>i("Copy"),2e3)}).catch(a=>{console.error("Failed to copy credentials: ",a),i("Failed to copy"),setTimeout(()=>i("Copy"),2e3)})};return h.jsx("div",{className:"modal modal-open",children:h.jsxs("div",{className:"modal-box",children:[h.jsxs("div",{className:"text-center",children:[h.jsx(JV,{className:"w-16 h-16 text-success mx-auto mb-4"}),h.jsx("h3",{className:"font-bold text-2xl",children:"Admin Registered!"})]}),h.jsxs("div",{className:"my-6 p-4 bg-base-200 rounded-lg space-y-3",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"font-medium text-base-content/70",children:"Email:"}),h.jsx("span",{className:"font-mono font-semibold",children:e.email})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"font-medium text-base-content/70",children:"Password:"}),h.jsx("span",{className:"font-mono font-semibold",children:e.password})]})]}),h.jsxs("div",{role:"alert",className:"alert alert-info",children:[h.jsx(qP,{className:"text-info-content"}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold",children:"Share these credentials with the new admin."}),h.jsx("div",{className:"text-xs",children:"It is recommended they change their password on first login."})]})]}),h.jsxs("div",{className:"modal-action items-center justify-between mt-6",children:[h.jsxs("button",{onClick:n,className:"btn btn-ghost gap-2",children:[r==="Copy"?h.jsx(Uat,{size:16}):h.jsx(Fat,{size:16,className:"text-success"}),r]}),h.jsx("button",{onClick:t,className:"btn btn-primary",children:"Done"})]})]})})},Tpt=x0({first_name:on().min(3,"Name must be at least 3 characters long"),email_id:on().email("Invalid email address"),password:on().min(8,"Password must be at least 8 characters long"),role:AYe(["user","admin"],"Role must be either 'user' or 'admin'"),last_name:on().min(2,"Last name is required")});function Mpt(){const[e,t]=O.useState([]),[r,i]=O.useState(""),[n,s]=O.useState([]),[a,o]=O.useState(!0),[l,c]=O.useState(null),[u,d]=O.useState({message:"",type:""}),{register:f,handleSubmit:m,reset:v,formState:{errors:y,isSubmitting:x}}=$c({resolver:y0(Tpt)}),[w,_]=O.useState(null),[S,P]=O.useState(!1),[M,C]=O.useState(null);O.useEffect(()=>{T()},[]);const T=async()=>{try{o(!0);const B=await jt.get("/user/alluser");t(B.data.users||[])}catch(B){c(B.message||"Failed to fetch users.")}finally{o(!1)}};O.useEffect(()=>{const B=r.toLowerCase();s(e.filter(q=>`${q.first_name}`.toLowerCase().includes(B)||q.email_id.toLowerCase().includes(B)))},[r,e]),O.useEffect(()=>{if(u.message){const B=setTimeout(()=>d({message:"",type:""}),4e3);return()=>clearTimeout(B)}},[u]);const E=(B,q)=>{C({userId:B,newRole:q})},N=async()=>{if(M)try{await jt.put(`/user/updateRole/${M.userId}`,{role:M.newRole}),t(B=>B.map(q=>q._id===M.userId?{...q,role:M.newRole}:q)),d({message:"User role updated successfully.",type:"success"})}catch(B){d({message:B.response?.data?.message||"Failed to update role.",type:"error"})}finally{C(null)}},D=()=>{P(!1),v()},I=async B=>{try{const q=await jt.post("user/register/admin",B);T();const{Email:G,Password:Y}=q.data.reply;_({email:G,password:Y}),D()}catch(q){d({message:q.response?.data?.message||"Failed to create user.",type:"error"})}},j=({role:B})=>h.jsx("div",{className:`badge ${B?.toLowerCase()==="admin"?"badge-primary":"badge-ghost"}`,children:B}),L=()=>a?h.jsx("div",{className:"flex justify-center p-16",children:h.jsx("span",{className:"loading loading-spinner loading-lg text-primary"})}):l?h.jsx("div",{className:"alert alert-error",children:h.jsx("span",{children:l})}):e.length>0&&n.length===0?h.jsx("div",{className:"text-center py-16",children:h.jsx("h3",{className:"text-xl font-semibold",children:"No users match your search."})}):n.length===0?h.jsx("div",{className:"text-center py-16",children:h.jsx("h3",{className:"text-xl font-semibold",children:"No users found."})}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"table w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Name"}),h.jsx("th",{children:"Email"}),h.jsx("th",{children:"Role"}),h.jsx("th",{children:"Joined On"}),h.jsx("th",{className:"text-center",children:"Set Role"})]})}),h.jsx("tbody",{children:n.map(B=>h.jsxs("tr",{className:"hover",children:[h.jsx("td",{children:h.jsx("div",{className:"font-bold",children:B.first_name})}),h.jsx("td",{children:B.email_id}),h.jsx("td",{children:h.jsx(j,{role:B.role})}),h.jsx("td",{children:new Date(B.createdAt).toLocaleDateString()}),h.jsx("td",{className:"text-center",children:h.jsxs("select",{className:"select select-bordered select-sm",value:B.role,onChange:q=>E(B._id,q.target.value),children:[h.jsx("option",{value:"user",children:"User"}),h.jsx("option",{value:"admin",children:"Admin"})]})})]},B._id))})]})});return h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-base-200 via-base-100 to-base-200 p-4 sm:p-6",children:[h.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsx("div",{className:"rounded-2xl p-8 mb-10 shadow-xl bg-base-100/80 backdrop-blur-md border border-base-300",children:h.jsxs("div",{className:"text-center space-y-4",children:[h.jsxs("h1",{className:"text-4xl font-bold text-info",children:[h.jsx(Hz,{className:"inline-block w-10 h-10 mr-2"}),"User Management"]}),h.jsx("p",{className:"text-base-content/70",children:"View, create, and manage user roles and platform access."}),h.jsxs("div",{className:"mt-6 inline-block bg-white dark:bg-zinc-900 px-6 py-4 rounded-xl shadow border border-info/30",children:[h.jsx("div",{className:"text-sm text-muted-foreground font-medium",children:"Total Users"}),h.jsx("div",{className:"text-3xl font-bold text-info mt-1",children:h.jsx(_c,{from:0,to:e.length,separator:",",direction:"up",duration:2,className:"count-up-text"})})]})]})}),h.jsx("div",{className:"card bg-base-100/70 backdrop-blur-lg shadow-xl border border-base-300",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between mb-6",children:[h.jsx("div",{className:"form-control w-full md:max-w-md",children:h.jsxs("div",{className:"relative w-full",children:[h.jsx(Wh,{size:18,className:"absolute z-10 left-4 top-1/2 -translate-y-1/2 text-base-content/50"}),h.jsx("input",{type:"text",placeholder:"Search by name or email...",className:"input input-bordered w-full pl-12 rounded-full",value:r,onChange:B=>i(B.target.value)})]})}),h.jsxs("button",{className:"btn btn-primary gap-2",onClick:()=>P(!0),children:[h.jsx(Hl,{})," Add New User"]})]}),L()]})})]}),u.message&&h.jsx("div",{className:"toast toast-top toast-center min-w-max z-50",children:h.jsx("div",{className:`alert ${u.type==="success"?"alert-success":"alert-error"}`,children:h.jsx("span",{children:u.message})})}),h.jsx("input",{type:"checkbox",id:"add-user-modal",className:"modal-toggle",checked:S,readOnly:!0}),h.jsx("div",{className:"modal",children:h.jsxs("div",{className:"modal-box",children:[h.jsx("button",{type:"button",className:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2",onClick:D,children:"✕"}),h.jsx("h3",{className:"font-bold text-lg mb-4",children:"Create New User"}),h.jsxs("form",{onSubmit:m(I),className:"space-y-3",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[h.jsxs("div",{children:[h.jsx("input",{type:"text",placeholder:"First Name",className:`input input-bordered w-full ${y.first_name?"input-error":""}`,...f("first_name")}),y.first_name&&h.jsx("p",{className:"text-error text-xs mt-1",children:y.first_name.message})]}),h.jsxs("div",{children:[h.jsx("input",{type:"text",placeholder:"Last Name",className:`input input-bordered w-full ${y.last_name?"input-error":""}`,...f("last_name")}),y.last_name&&h.jsx("p",{className:"text-error text-xs mt-1",children:y.last_name.message})]})]}),h.jsxs("div",{children:[h.jsx("input",{type:"email",placeholder:"Email Address",className:`input input-bordered w-full ${y.email_id?"input-error":""}`,...f("email_id")}),y.email_id&&h.jsx("p",{className:"text-error text-xs mt-1",children:y.email_id.message})]}),h.jsxs("div",{children:[h.jsx("input",{type:"password",placeholder:"Password",className:`input input-bordered w-full ${y.password?"input-error":""}`,...f("password")}),y.password&&h.jsx("p",{className:"text-error text-xs mt-1",children:y.password.message})]}),h.jsxs("select",{className:"select select-bordered w-full",...f("role"),children:[" ",h.jsx("option",{value:"user",children:"User"}),h.jsx("option",{value:"admin",children:"Admin"})]}),h.jsxs("div",{className:"modal-action pt-2",children:[h.jsx("button",{type:"button",className:"btn",onClick:D,children:"Cancel"}),h.jsx("button",{type:"submit",className:"btn btn-primary",disabled:x,children:x?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"loading loading-spinner"}),"Creating..."]}):"Create"})]})]})]})}),h.jsx("input",{type:"checkbox",id:"role-change-modal",className:"modal-toggle",checked:!!M,readOnly:!0}),h.jsx("div",{className:"modal",children:h.jsxs("div",{className:"modal-box",children:[h.jsx(ZV,{className:"w-16 h-16 text-warning mx-auto mb-4"}),h.jsx("h3",{className:"font-bold text-lg text-center",children:"Confirm Role Change"}),h.jsxs("p",{className:"py-4 text-center",children:["Are you sure you want to change this user's role to ",h.jsx("strong",{className:"badge badge-lg badge-primary",children:M?.newRole}),"?"]}),h.jsxs("div",{className:"modal-action justify-center gap-4",children:[h.jsx("button",{className:"btn",onClick:()=>C(null),children:"Cancel"}),h.jsx("button",{className:"btn btn-primary",onClick:N,children:"Confirm"})]})]})}),w&&h.jsx(Cpt,{credentials:w,onClose:()=>_(null)})]})}const tN=O.createContext(null);tN.displayName="PanelGroupContext";const Tn={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},xU=10,zg=O.useLayoutEffect,zee=w6.useId,Ppt=typeof zee=="function"?zee:()=>null;let Dpt=0;function bU(e=null){const t=Ppt(),r=O.useRef(e||t||null);return r.current===null&&(r.current=""+Dpt++),e??r.current}function fme({children:e,className:t="",collapsedSize:r,collapsible:i,defaultSize:n,forwardedRef:s,id:a,maxSize:o,minSize:l,onCollapse:c,onExpand:u,onResize:d,order:f,style:m,tagName:v="div",...y}){const x=O.useContext(tN);if(x===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:w,expandPanel:_,getPanelSize:S,getPanelStyle:P,groupId:M,isPanelCollapsed:C,reevaluatePanelConstraints:T,registerPanel:E,resizePanel:N,unregisterPanel:D}=x,I=bU(a),j=O.useRef({callbacks:{onCollapse:c,onExpand:u,onResize:d},constraints:{collapsedSize:r,collapsible:i,defaultSize:n,maxSize:o,minSize:l},id:I,idIsFromProps:a!==void 0,order:f});O.useRef({didLogMissingDefaultSizeWarning:!1}),zg(()=>{const{callbacks:B,constraints:q}=j.current,G={...q};j.current.id=I,j.current.idIsFromProps=a!==void 0,j.current.order=f,B.onCollapse=c,B.onExpand=u,B.onResize=d,q.collapsedSize=r,q.collapsible=i,q.defaultSize=n,q.maxSize=o,q.minSize=l,(G.collapsedSize!==q.collapsedSize||G.collapsible!==q.collapsible||G.maxSize!==q.maxSize||G.minSize!==q.minSize)&&T(j.current,G)}),zg(()=>{const B=j.current;return E(B),()=>{D(B)}},[f,I,E,D]),O.useImperativeHandle(s,()=>({collapse:()=>{w(j.current)},expand:B=>{_(j.current,B)},getId(){return I},getSize(){return S(j.current)},isCollapsed(){return C(j.current)},isExpanded(){return!C(j.current)},resize:B=>{N(j.current,B)}}),[w,_,S,C,I,N]);const L=P(j.current,n);return O.createElement(v,{...y,children:e,className:t,id:I,style:{...L,...m},[Tn.groupId]:M,[Tn.panel]:"",[Tn.panelCollapsible]:i||void 0,[Tn.panelId]:I,[Tn.panelSize]:parseFloat(""+L.flexGrow).toFixed(1)})}const Ow=O.forwardRef((e,t)=>O.createElement(fme,{...e,forwardedRef:t}));fme.displayName="Panel";Ow.displayName="forwardRef(Panel)";let n6=null,HT=-1,sp=null;function Npt(e,t){if(t){const r=(t&yme)!==0,i=(t&xme)!==0,n=(t&bme)!==0,s=(t&wme)!==0;if(r)return n?"se-resize":s?"ne-resize":"e-resize";if(i)return n?"sw-resize":s?"nw-resize":"w-resize";if(n)return"s-resize";if(s)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function kpt(){sp!==null&&(document.head.removeChild(sp),n6=null,sp=null,HT=-1)}function jO(e,t){var r,i;const n=Npt(e,t);if(n6!==n){if(n6=n,sp===null&&(sp=document.createElement("style"),document.head.appendChild(sp)),HT>=0){var s;(s=sp.sheet)===null||s===void 0||s.removeRule(HT)}HT=(r=(i=sp.sheet)===null||i===void 0?void 0:i.insertRule(`*{cursor: ${n} !important;}`))!==null&&r!==void 0?r:-1}}function pme(e){return e.type==="keydown"}function mme(e){return e.type.startsWith("pointer")}function gme(e){return e.type.startsWith("mouse")}function rN(e){if(mme(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(gme(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function Rpt(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function Ipt(e,t,r){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function Opt(e,t){if(e===t)throw new Error("Cannot compare node with itself");const r={a:Vee(e),b:Vee(t)};let i;for(;r.a.at(-1)===r.b.at(-1);)e=r.a.pop(),t=r.b.pop(),i=e;Lr(i,"Stacking order can only be calculated for elements with a common ancestor");const n={a:Fee(Bee(r.a)),b:Fee(Bee(r.b))};if(n.a===n.b){const s=i.childNodes,a={a:r.a.at(-1),b:r.b.at(-1)};let o=s.length;for(;o--;){const l=s[o];if(l===a.a)return 1;if(l===a.b)return-1}}return Math.sign(n.a-n.b)}const jpt=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function Lpt(e){var t;const r=getComputedStyle((t=vme(e))!==null&&t!==void 0?t:e).display;return r==="flex"||r==="inline-flex"}function zpt(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||Lpt(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||jpt.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function Bee(e){let t=e.length;for(;t--;){const r=e[t];if(Lr(r,"Missing node"),zpt(r))return r}return null}function Fee(e){return e&&Number(getComputedStyle(e).zIndex)||0}function Vee(e){const t=[];for(;e;)t.push(e),e=vme(e);return t}function vme(e){const{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}const yme=1,xme=2,bme=4,wme=8,Bpt=Rpt()==="coarse";let Oc=[],ex=!1,ap=new Map,iN=new Map;const v_=new Set;function Fpt(e,t,r,i,n){var s;const{ownerDocument:a}=t,o={direction:r,element:t,hitAreaMargins:i,setResizeHandlerState:n},l=(s=ap.get(a))!==null&&s!==void 0?s:0;return ap.set(a,l+1),v_.add(o),r3(),function(){var u;iN.delete(e),v_.delete(o);const d=(u=ap.get(a))!==null&&u!==void 0?u:1;if(ap.set(a,d-1),r3(),d===1&&ap.delete(a),Oc.includes(o)){const f=Oc.indexOf(o);f>=0&&Oc.splice(f,1),_U(),n("up",!0,null)}}}function Vpt(e){const{target:t}=e,{x:r,y:i}=rN(e);ex=!0,wU({target:t,x:r,y:i}),r3(),Oc.length>0&&(i3("down",e),e.preventDefault(),_me(t)||e.stopImmediatePropagation())}function LO(e){const{x:t,y:r}=rN(e);if(ex&&e.buttons===0&&(ex=!1,i3("up",e)),!ex){const{target:i}=e;wU({target:i,x:t,y:r})}i3("move",e),_U(),Oc.length>0&&e.preventDefault()}function zO(e){const{target:t}=e,{x:r,y:i}=rN(e);iN.clear(),ex=!1,Oc.length>0&&(e.preventDefault(),_me(t)||e.stopImmediatePropagation()),i3("up",e),wU({target:t,x:r,y:i}),_U(),r3()}function _me(e){let t=e;for(;t;){if(t.hasAttribute(Tn.resizeHandle))return!0;t=t.parentElement}return!1}function wU({target:e,x:t,y:r}){Oc.splice(0);let i=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(i=e),v_.forEach(n=>{const{element:s,hitAreaMargins:a}=n,o=s.getBoundingClientRect(),{bottom:l,left:c,right:u,top:d}=o,f=Bpt?a.coarse:a.fine;if(t>=c-f&&t<=u+f&&r>=d-f&&r<=l+f){if(i!==null&&document.contains(i)&&s!==i&&!s.contains(i)&&!i.contains(s)&&Opt(i,s)>0){let v=i,y=!1;for(;v&&!v.contains(s);){if(Ipt(v.getBoundingClientRect(),o)){y=!0;break}v=v.parentElement}if(y)return}Oc.push(n)}})}function BO(e,t){iN.set(e,t)}function _U(){let e=!1,t=!1;Oc.forEach(i=>{const{direction:n}=i;n==="horizontal"?e=!0:t=!0});let r=0;iN.forEach(i=>{r|=i}),e&&t?jO("intersection",r):e?jO("horizontal",r):t?jO("vertical",r):kpt()}let FO;function r3(){var e;(e=FO)===null||e===void 0||e.abort(),FO=new AbortController;const t={capture:!0,signal:FO.signal};v_.size&&(ex?(Oc.length>0&&ap.forEach((r,i)=>{const{body:n}=i;r>0&&(n.addEventListener("contextmenu",zO,t),n.addEventListener("pointerleave",LO,t),n.addEventListener("pointermove",LO,t))}),ap.forEach((r,i)=>{const{body:n}=i;n.addEventListener("pointerup",zO,t),n.addEventListener("pointercancel",zO,t)})):ap.forEach((r,i)=>{const{body:n}=i;r>0&&(n.addEventListener("pointerdown",Vpt,t),n.addEventListener("pointermove",LO,t))}))}function i3(e,t){v_.forEach(r=>{const{setResizeHandlerState:i}=r,n=Oc.includes(r);i(e,n,t)})}function Upt(){const[e,t]=O.useState(0);return O.useCallback(()=>t(r=>r+1),[])}function Lr(e,t){if(!e)throw console.error(t),Error(t)}function c0(e,t,r=xU){return e.toFixed(r)===t.toFixed(r)?0:e>t?1:-1}function hh(e,t,r=xU){return c0(e,t,r)===0}function Zo(e,t,r){return c0(e,t,r)===0}function Hpt(e,t,r){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){const n=e[i],s=t[i];if(!Zo(n,s,r))return!1}return!0}function Py({panelConstraints:e,panelIndex:t,size:r}){const i=e[t];Lr(i!=null,`Panel constraints not found for index ${t}`);let{collapsedSize:n=0,collapsible:s,maxSize:a=100,minSize:o=0}=i;if(c0(r,o)<0)if(s){const l=(n+o)/2;c0(r,l)<0?r=n:r=o}else r=o;return r=Math.min(a,r),r=parseFloat(r.toFixed(xU)),r}function jw({delta:e,initialLayout:t,panelConstraints:r,pivotIndices:i,prevLayout:n,trigger:s}){if(Zo(e,0))return t;const a=[...t],[o,l]=i;Lr(o!=null,"Invalid first pivot index"),Lr(l!=null,"Invalid second pivot index");let c=0;if(s==="keyboard"){{const d=e<0?l:o,f=r[d];Lr(f,`Panel constraints not found for index ${d}`);const{collapsedSize:m=0,collapsible:v,minSize:y=0}=f;if(v){const x=t[d];if(Lr(x!=null,`Previous layout not found for panel index ${d}`),Zo(x,m)){const w=y-x;c0(w,Math.abs(e))>0&&(e=e<0?0-w:w)}}}{const d=e<0?o:l,f=r[d];Lr(f,`No panel constraints found for index ${d}`);const{collapsedSize:m=0,collapsible:v,minSize:y=0}=f;if(v){const x=t[d];if(Lr(x!=null,`Previous layout not found for panel index ${d}`),Zo(x,y)){const w=x-m;c0(w,Math.abs(e))>0&&(e=e<0?0-w:w)}}}}{const d=e<0?1:-1;let f=e<0?l:o,m=0;for(;;){const y=t[f];Lr(y!=null,`Previous layout not found for panel index ${f}`);const w=Py({panelConstraints:r,panelIndex:f,size:100})-y;if(m+=w,f+=d,f<0||f>=r.length)break}const v=Math.min(Math.abs(e),Math.abs(m));e=e<0?0-v:v}{let f=e<0?o:l;for(;f>=0&&f<r.length;){const m=Math.abs(e)-Math.abs(c),v=t[f];Lr(v!=null,`Previous layout not found for panel index ${f}`);const y=v-m,x=Py({panelConstraints:r,panelIndex:f,size:y});if(!Zo(v,x)&&(c+=v-x,a[f]=x,c.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?f--:f++}}if(Hpt(n,a))return n;{const d=e<0?l:o,f=t[d];Lr(f!=null,`Previous layout not found for panel index ${d}`);const m=f+c,v=Py({panelConstraints:r,panelIndex:d,size:m});if(a[d]=v,!Zo(v,m)){let y=m-v,w=e<0?l:o;for(;w>=0&&w<r.length;){const _=a[w];Lr(_!=null,`Previous layout not found for panel index ${w}`);const S=_+y,P=Py({panelConstraints:r,panelIndex:w,size:S});if(Zo(_,P)||(y-=P-_,a[w]=P),Zo(y,0))break;e>0?w--:w++}}}const u=a.reduce((d,f)=>f+d,0);return Zo(u,100)?a:n}function Gpt({layout:e,panelsArray:t,pivotIndices:r}){let i=0,n=100,s=0,a=0;const o=r[0];Lr(o!=null,"No pivot index found"),t.forEach((d,f)=>{const{constraints:m}=d,{maxSize:v=100,minSize:y=0}=m;f===o?(i=y,n=v):(s+=y,a+=v)});const l=Math.min(n,100-s),c=Math.max(i,100-a),u=e[o];return{valueMax:l,valueMin:c,valueNow:u}}function y_(e,t=document){return Array.from(t.querySelectorAll(`[${Tn.resizeHandleId}][data-panel-group-id="${e}"]`))}function Sme(e,t,r=document){const n=y_(e,r).findIndex(s=>s.getAttribute(Tn.resizeHandleId)===t);return n??null}function Eme(e,t,r){const i=Sme(e,t,r);return i!=null?[i,i+1]:[-1,-1]}function Wpt(e){return e instanceof HTMLElement?!0:typeof e=="object"&&e!==null&&"tagName"in e&&"getAttribute"in e}function Ame(e,t=document){if(Wpt(t)&&t.dataset.panelGroupId==e)return t;const r=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return r||null}function nN(e,t=document){const r=t.querySelector(`[${Tn.resizeHandleId}="${e}"]`);return r||null}function qpt(e,t,r,i=document){var n,s,a,o;const l=nN(t,i),c=y_(e,i),u=l?c.indexOf(l):-1,d=(n=(s=r[u])===null||s===void 0?void 0:s.id)!==null&&n!==void 0?n:null,f=(a=(o=r[u+1])===null||o===void 0?void 0:o.id)!==null&&a!==void 0?a:null;return[d,f]}function Ypt({committedValuesRef:e,eagerValuesRef:t,groupId:r,layout:i,panelDataArray:n,panelGroupElement:s,setLayout:a}){O.useRef({didWarnAboutMissingResizeHandle:!1}),zg(()=>{if(!s)return;const o=y_(r,s);for(let l=0;l<n.length-1;l++){const{valueMax:c,valueMin:u,valueNow:d}=Gpt({layout:i,panelsArray:n,pivotIndices:[l,l+1]}),f=o[l];if(f!=null){const m=n[l];Lr(m,`No panel data found for index "${l}"`),f.setAttribute("aria-controls",m.id),f.setAttribute("aria-valuemax",""+Math.round(c)),f.setAttribute("aria-valuemin",""+Math.round(u)),f.setAttribute("aria-valuenow",d!=null?""+Math.round(d):"")}}return()=>{o.forEach((l,c)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[r,i,n,s]),O.useEffect(()=>{if(!s)return;const o=t.current;Lr(o,"Eager values not found");const{panelDataArray:l}=o,c=Ame(r,s);Lr(c!=null,`No group found for id "${r}"`);const u=y_(r,s);Lr(u,`No resize handles found for group id "${r}"`);const d=u.map(f=>{const m=f.getAttribute(Tn.resizeHandleId);Lr(m,"Resize handle element has no handle id attribute");const[v,y]=qpt(r,m,l,s);if(v==null||y==null)return()=>{};const x=w=>{if(!w.defaultPrevented)switch(w.key){case"Enter":{w.preventDefault();const _=l.findIndex(S=>S.id===v);if(_>=0){const S=l[_];Lr(S,`No panel data found for index ${_}`);const P=i[_],{collapsedSize:M=0,collapsible:C,minSize:T=0}=S.constraints;if(P!=null&&C){const E=jw({delta:Zo(P,M)?T-M:M-P,initialLayout:i,panelConstraints:l.map(N=>N.constraints),pivotIndices:Eme(r,m,s),prevLayout:i,trigger:"keyboard"});i!==E&&a(E)}}break}}};return f.addEventListener("keydown",x),()=>{f.removeEventListener("keydown",x)}});return()=>{d.forEach(f=>f())}},[s,e,t,r,i,n,a])}function Uee(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Cme(e,t){const r=e==="horizontal",{x:i,y:n}=rN(t);return r?i:n}function Xpt(e,t,r,i,n){const s=r==="horizontal",a=nN(t,n);Lr(a,`No resize handle element found for id "${t}"`);const o=a.getAttribute(Tn.groupId);Lr(o,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=i;const c=Cme(r,e),u=Ame(o,n);Lr(u,`No group element found for id "${o}"`);const d=u.getBoundingClientRect(),f=s?d.width:d.height;return(c-l)/f*100}function $pt(e,t,r,i,n,s){if(pme(e)){const a=r==="horizontal";let o=0;e.shiftKey?o=100:n!=null?o=n:o=10;let l=0;switch(e.key){case"ArrowDown":l=a?0:o;break;case"ArrowLeft":l=a?-o:0;break;case"ArrowRight":l=a?o:0;break;case"ArrowUp":l=a?0:-o;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return i==null?0:Xpt(e,t,r,i,s)}function Kpt({panelDataArray:e}){const t=Array(e.length),r=e.map(s=>s.constraints);let i=0,n=100;for(let s=0;s<e.length;s++){const a=r[s];Lr(a,`Panel constraints not found for index ${s}`);const{defaultSize:o}=a;o!=null&&(i++,t[s]=o,n-=o)}for(let s=0;s<e.length;s++){const a=r[s];Lr(a,`Panel constraints not found for index ${s}`);const{defaultSize:o}=a;if(o!=null)continue;const l=e.length-i,c=n/l;i++,t[s]=c,n-=c}return t}function $v(e,t,r){t.forEach((i,n)=>{const s=e[n];Lr(s,`Panel data not found for index ${n}`);const{callbacks:a,constraints:o,id:l}=s,{collapsedSize:c=0,collapsible:u}=o,d=r[l];if(d==null||i!==d){r[l]=i;const{onCollapse:f,onExpand:m,onResize:v}=a;v&&v(i,d),u&&(f||m)&&(m&&(d==null||hh(d,c))&&!hh(i,c)&&m(),f&&(d==null||!hh(d,c))&&hh(i,c)&&f())}})}function BC(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function Qpt({defaultSize:e,dragState:t,layout:r,panelData:i,panelIndex:n,precision:s=3}){const a=r[n];let o;return a==null?o=e!=null?e.toPrecision(s):"1":i.length===1?o="1":o=a.toPrecision(s),{flexBasis:0,flexGrow:o,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function Zpt(e,t=10){let r=null;return(...n)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>{e(...n)},t)}}function Hee(e){try{if(typeof localStorage<"u")e.getItem=t=>localStorage.getItem(t),e.setItem=(t,r)=>{localStorage.setItem(t,r)};else throw new Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function Tme(e){return`react-resizable-panels:${e}`}function Mme(e){return e.map(t=>{const{constraints:r,id:i,idIsFromProps:n,order:s}=t;return n?i:s?`${s}:${JSON.stringify(r)}`:JSON.stringify(r)}).sort((t,r)=>t.localeCompare(r)).join(",")}function Pme(e,t){try{const r=Tme(e),i=t.getItem(r);if(i){const n=JSON.parse(i);if(typeof n=="object"&&n!=null)return n}}catch{}return null}function Jpt(e,t,r){var i,n;const s=(i=Pme(e,r))!==null&&i!==void 0?i:{},a=Mme(t);return(n=s[a])!==null&&n!==void 0?n:null}function emt(e,t,r,i,n){var s;const a=Tme(e),o=Mme(t),l=(s=Pme(e,n))!==null&&s!==void 0?s:{};l[o]={expandToSizes:Object.fromEntries(r.entries()),layout:i};try{n.setItem(a,JSON.stringify(l))}catch(c){console.error(c)}}function Gee({layout:e,panelConstraints:t}){const r=[...e],i=r.reduce((s,a)=>s+a,0);if(r.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${r.map(s=>`${s}%`).join(", ")}`);if(!Zo(i,100)&&r.length>0)for(let s=0;s<t.length;s++){const a=r[s];Lr(a!=null,`No layout data found for index ${s}`);const o=100/i*a;r[s]=o}let n=0;for(let s=0;s<t.length;s++){const a=r[s];Lr(a!=null,`No layout data found for index ${s}`);const o=Py({panelConstraints:t,panelIndex:s,size:a});a!=o&&(n+=a-o,r[s]=o)}if(!Zo(n,0))for(let s=0;s<t.length;s++){const a=r[s];Lr(a!=null,`No layout data found for index ${s}`);const o=a+n,l=Py({panelConstraints:t,panelIndex:s,size:o});if(a!==l&&(n-=l-a,r[s]=l,Zo(n,0)))break}return r}const tmt=100,Lw={getItem:e=>(Hee(Lw),Lw.getItem(e)),setItem:(e,t)=>{Hee(Lw),Lw.setItem(e,t)}},Wee={};function Dme({autoSaveId:e=null,children:t,className:r="",direction:i,forwardedRef:n,id:s=null,onLayout:a=null,keyboardResizeBy:o=null,storage:l=Lw,style:c,tagName:u="div",...d}){const f=bU(s),m=O.useRef(null),[v,y]=O.useState(null),[x,w]=O.useState([]),_=Upt(),S=O.useRef({}),P=O.useRef(new Map),M=O.useRef(0),C=O.useRef({autoSaveId:e,direction:i,dragState:v,id:f,keyboardResizeBy:o,onLayout:a,storage:l}),T=O.useRef({layout:x,panelDataArray:[],panelDataArrayChanged:!1});O.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),O.useImperativeHandle(n,()=>({getId:()=>C.current.id,getLayout:()=>{const{layout:H}=T.current;return H},setLayout:H=>{const{onLayout:ne}=C.current,{layout:ce,panelDataArray:ie}=T.current,ae=Gee({layout:H,panelConstraints:ie.map(Z=>Z.constraints)});Uee(ce,ae)||(w(ae),T.current.layout=ae,ne&&ne(ae),$v(ie,ae,S.current))}}),[]),zg(()=>{C.current.autoSaveId=e,C.current.direction=i,C.current.dragState=v,C.current.id=f,C.current.onLayout=a,C.current.storage=l}),Ypt({committedValuesRef:C,eagerValuesRef:T,groupId:f,layout:x,panelDataArray:T.current.panelDataArray,setLayout:w,panelGroupElement:m.current}),O.useEffect(()=>{const{panelDataArray:H}=T.current;if(e){if(x.length===0||x.length!==H.length)return;let ne=Wee[e];ne==null&&(ne=Zpt(emt,tmt),Wee[e]=ne);const ce=[...H],ie=new Map(P.current);ne(e,ce,ie,x,l)}},[e,x,l]),O.useEffect(()=>{});const E=O.useCallback(H=>{const{onLayout:ne}=C.current,{layout:ce,panelDataArray:ie}=T.current;if(H.constraints.collapsible){const ae=ie.map(Ae=>Ae.constraints),{collapsedSize:Z=0,panelSize:fe,pivotIndices:he}=qm(ie,H,ce);if(Lr(fe!=null,`Panel size not found for panel "${H.id}"`),!hh(fe,Z)){P.current.set(H.id,fe);const xe=hy(ie,H)===ie.length-1?fe-Z:Z-fe,Ee=jw({delta:xe,initialLayout:ce,panelConstraints:ae,pivotIndices:he,prevLayout:ce,trigger:"imperative-api"});BC(ce,Ee)||(w(Ee),T.current.layout=Ee,ne&&ne(Ee),$v(ie,Ee,S.current))}}},[]),N=O.useCallback((H,ne)=>{const{onLayout:ce}=C.current,{layout:ie,panelDataArray:ae}=T.current;if(H.constraints.collapsible){const Z=ae.map(Be=>Be.constraints),{collapsedSize:fe=0,panelSize:he=0,minSize:Ae=0,pivotIndices:xe}=qm(ae,H,ie),Ee=ne??Ae;if(hh(he,fe)){const Be=P.current.get(H.id),$e=Be!=null&&Be>=Ee?Be:Ee,dt=hy(ae,H)===ae.length-1?he-$e:$e-he,ct=jw({delta:dt,initialLayout:ie,panelConstraints:Z,pivotIndices:xe,prevLayout:ie,trigger:"imperative-api"});BC(ie,ct)||(w(ct),T.current.layout=ct,ce&&ce(ct),$v(ae,ct,S.current))}}},[]),D=O.useCallback(H=>{const{layout:ne,panelDataArray:ce}=T.current,{panelSize:ie}=qm(ce,H,ne);return Lr(ie!=null,`Panel size not found for panel "${H.id}"`),ie},[]),I=O.useCallback((H,ne)=>{const{panelDataArray:ce}=T.current,ie=hy(ce,H);return Qpt({defaultSize:ne,dragState:v,layout:x,panelData:ce,panelIndex:ie})},[v,x]),j=O.useCallback(H=>{const{layout:ne,panelDataArray:ce}=T.current,{collapsedSize:ie=0,collapsible:ae,panelSize:Z}=qm(ce,H,ne);return Lr(Z!=null,`Panel size not found for panel "${H.id}"`),ae===!0&&hh(Z,ie)},[]),L=O.useCallback(H=>{const{layout:ne,panelDataArray:ce}=T.current,{collapsedSize:ie=0,collapsible:ae,panelSize:Z}=qm(ce,H,ne);return Lr(Z!=null,`Panel size not found for panel "${H.id}"`),!ae||c0(Z,ie)>0},[]),B=O.useCallback(H=>{const{panelDataArray:ne}=T.current;ne.push(H),ne.sort((ce,ie)=>{const ae=ce.order,Z=ie.order;return ae==null&&Z==null?0:ae==null?-1:Z==null?1:ae-Z}),T.current.panelDataArrayChanged=!0,_()},[_]);zg(()=>{if(T.current.panelDataArrayChanged){T.current.panelDataArrayChanged=!1;const{autoSaveId:H,onLayout:ne,storage:ce}=C.current,{layout:ie,panelDataArray:ae}=T.current;let Z=null;if(H){const he=Jpt(H,ae,ce);he&&(P.current=new Map(Object.entries(he.expandToSizes)),Z=he.layout)}Z==null&&(Z=Kpt({panelDataArray:ae}));const fe=Gee({layout:Z,panelConstraints:ae.map(he=>he.constraints)});Uee(ie,fe)||(w(fe),T.current.layout=fe,ne&&ne(fe),$v(ae,fe,S.current))}}),zg(()=>{const H=T.current;return()=>{H.layout=[]}},[]);const q=O.useCallback(H=>{let ne=!1;const ce=m.current;return ce&&window.getComputedStyle(ce,null).getPropertyValue("direction")==="rtl"&&(ne=!0),function(ae){ae.preventDefault();const Z=m.current;if(!Z)return()=>null;const{direction:fe,dragState:he,id:Ae,keyboardResizeBy:xe,onLayout:Ee}=C.current,{layout:Be,panelDataArray:$e}=T.current,{initialLayout:mt}=he??{},dt=Eme(Ae,H,Z);let ct=$pt(ae,H,fe,he,xe,Z);const ut=fe==="horizontal";ut&&ne&&(ct=-ct);const me=$e.map(J=>J.constraints),_e=jw({delta:ct,initialLayout:mt??Be,panelConstraints:me,pivotIndices:dt,prevLayout:Be,trigger:pme(ae)?"keyboard":"mouse-or-touch"}),te=!BC(Be,_e);(mme(ae)||gme(ae))&&M.current!=ct&&(M.current=ct,!te&&ct!==0?ut?BO(H,ct<0?yme:xme):BO(H,ct<0?bme:wme):BO(H,0)),te&&(w(_e),T.current.layout=_e,Ee&&Ee(_e),$v($e,_e,S.current))}},[]),G=O.useCallback((H,ne)=>{const{onLayout:ce}=C.current,{layout:ie,panelDataArray:ae}=T.current,Z=ae.map(Be=>Be.constraints),{panelSize:fe,pivotIndices:he}=qm(ae,H,ie);Lr(fe!=null,`Panel size not found for panel "${H.id}"`);const xe=hy(ae,H)===ae.length-1?fe-ne:ne-fe,Ee=jw({delta:xe,initialLayout:ie,panelConstraints:Z,pivotIndices:he,prevLayout:ie,trigger:"imperative-api"});BC(ie,Ee)||(w(Ee),T.current.layout=Ee,ce&&ce(Ee),$v(ae,Ee,S.current))},[]),Y=O.useCallback((H,ne)=>{const{layout:ce,panelDataArray:ie}=T.current,{collapsedSize:ae=0,collapsible:Z}=ne,{collapsedSize:fe=0,collapsible:he,maxSize:Ae=100,minSize:xe=0}=H.constraints,{panelSize:Ee}=qm(ie,H,ce);Ee!=null&&(Z&&he&&hh(Ee,ae)?hh(ae,fe)||G(H,fe):Ee<xe?G(H,xe):Ee>Ae&&G(H,Ae))},[G]),X=O.useCallback((H,ne)=>{const{direction:ce}=C.current,{layout:ie}=T.current;if(!m.current)return;const ae=nN(H,m.current);Lr(ae,`Drag handle element not found for id "${H}"`);const Z=Cme(ce,ne);y({dragHandleId:H,dragHandleRect:ae.getBoundingClientRect(),initialCursorPosition:Z,initialLayout:ie})},[]),re=O.useCallback(()=>{y(null)},[]),F=O.useCallback(H=>{const{panelDataArray:ne}=T.current,ce=hy(ne,H);ce>=0&&(ne.splice(ce,1),delete S.current[H.id],T.current.panelDataArrayChanged=!0,_())},[_]),$=O.useMemo(()=>({collapsePanel:E,direction:i,dragState:v,expandPanel:N,getPanelSize:D,getPanelStyle:I,groupId:f,isPanelCollapsed:j,isPanelExpanded:L,reevaluatePanelConstraints:Y,registerPanel:B,registerResizeHandle:q,resizePanel:G,startDragging:X,stopDragging:re,unregisterPanel:F,panelGroupElement:m.current}),[E,v,i,N,D,I,f,j,L,Y,B,q,G,X,re,F]),se={display:"flex",flexDirection:i==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return O.createElement(tN.Provider,{value:$},O.createElement(u,{...d,children:t,className:r,id:s,ref:m,style:{...se,...c},[Tn.group]:"",[Tn.groupDirection]:i,[Tn.groupId]:f}))}const s6=O.forwardRef((e,t)=>O.createElement(Dme,{...e,forwardedRef:t}));Dme.displayName="PanelGroup";s6.displayName="forwardRef(PanelGroup)";function hy(e,t){return e.findIndex(r=>r===t||r.id===t.id)}function qm(e,t,r){const i=hy(e,t),s=i===e.length-1?[i-1,i]:[i,i+1],a=r[i];return{...t.constraints,panelSize:a,pivotIndices:s}}function rmt({disabled:e,handleId:t,resizeHandler:r,panelGroupElement:i}){O.useEffect(()=>{if(e||r==null||i==null)return;const n=nN(t,i);if(n==null)return;const s=a=>{if(!a.defaultPrevented)switch(a.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{a.preventDefault(),r(a);break}case"F6":{a.preventDefault();const o=n.getAttribute(Tn.groupId);Lr(o,`No group element found for id "${o}"`);const l=y_(o,i),c=Sme(o,t,i);Lr(c!==null,`No resize element found for id "${t}"`);const u=a.shiftKey?c>0?c-1:l.length-1:c+1<l.length?c+1:0;l[u].focus();break}}};return n.addEventListener("keydown",s),()=>{n.removeEventListener("keydown",s)}},[i,e,t,r])}function a6({children:e=null,className:t="",disabled:r=!1,hitAreaMargins:i,id:n,onBlur:s,onClick:a,onDragging:o,onFocus:l,onPointerDown:c,onPointerUp:u,style:d={},tabIndex:f=0,tagName:m="div",...v}){var y,x;const w=O.useRef(null),_=O.useRef({onClick:a,onDragging:o,onPointerDown:c,onPointerUp:u});O.useEffect(()=>{_.current.onClick=a,_.current.onDragging=o,_.current.onPointerDown=c,_.current.onPointerUp=u});const S=O.useContext(tN);if(S===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:P,groupId:M,registerResizeHandle:C,startDragging:T,stopDragging:E,panelGroupElement:N}=S,D=bU(n),[I,j]=O.useState("inactive"),[L,B]=O.useState(!1),[q,G]=O.useState(null),Y=O.useRef({state:I});zg(()=>{Y.current.state=I}),O.useEffect(()=>{if(r)G(null);else{const $=C(D);G(()=>$)}},[r,D,C]);const X=(y=i?.coarse)!==null&&y!==void 0?y:15,re=(x=i?.fine)!==null&&x!==void 0?x:5;O.useEffect(()=>{if(r||q==null)return;const $=w.current;Lr($,"Element ref not attached");let se=!1;return Fpt(D,$,P,{coarse:X,fine:re},(ne,ce,ie)=>{if(!ce){j("inactive");return}switch(ne){case"down":{j("drag"),se=!1,Lr(ie,'Expected event to be defined for "down" action'),T(D,ie);const{onDragging:ae,onPointerDown:Z}=_.current;ae?.(!0),Z?.();break}case"move":{const{state:ae}=Y.current;se=!0,ae!=="drag"&&j("hover"),Lr(ie,'Expected event to be defined for "move" action'),q(ie);break}case"up":{j("hover"),E();const{onClick:ae,onDragging:Z,onPointerUp:fe}=_.current;Z?.(!1),fe?.(),se||ae?.();break}}})},[X,P,r,re,C,D,q,T,E]),rmt({disabled:r,handleId:D,resizeHandler:q,panelGroupElement:N});const F={touchAction:"none",userSelect:"none"};return O.createElement(m,{...v,children:e,className:t,id:n,onBlur:()=>{B(!1),s?.()},onFocus:()=>{B(!0),l?.()},ref:w,role:"separator",style:{...F,...d},tabIndex:f,[Tn.groupDirection]:P,[Tn.groupId]:M,[Tn.resizeHandle]:"",[Tn.resizeHandleActive]:I==="drag"?"pointer":L?"keyboard":void 0,[Tn.resizeHandleEnabled]:!r,[Tn.resizeHandleId]:D,[Tn.resizeHandleState]:I})}a6.displayName="PanelResizeHandle";var o6=["Enter"," "],imt=["ArrowDown","PageUp","Home"],Nme=["ArrowUp","PageDown","End"],nmt=[...imt,...Nme],smt={ltr:[...o6,"ArrowRight"],rtl:[...o6,"ArrowLeft"]},amt={ltr:["ArrowLeft"],rtl:["ArrowRight"]},yS="Menu",[x_,omt,lmt]=iU(yS),[E0,kme]=S0(yS,[lmt,qD,QD]),sN=qD(),Rme=QD(),[cmt,A0]=E0(yS),[umt,xS]=E0(yS),Ime=e=>{const{__scopeMenu:t,open:r=!1,children:i,dir:n,onOpenChange:s,modal:a=!0}=e,o=sN(t),[l,c]=O.useState(null),u=O.useRef(!1),d=ld(s),f=UD(n);return O.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),h.jsx(dpe,{...o,children:h.jsx(cmt,{scope:t,open:r,onOpenChange:d,content:l,onContentChange:c,children:h.jsx(umt,{scope:t,onClose:O.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:f,modal:a,children:i})})})};Ime.displayName=yS;var dmt="MenuAnchor",SU=O.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e,n=sN(r);return h.jsx(hpe,{...n,...i,ref:t})});SU.displayName=dmt;var EU="MenuPortal",[hmt,Ome]=E0(EU,{forceMount:void 0}),jme=e=>{const{__scopeMenu:t,forceMount:r,children:i,container:n}=e,s=A0(EU,t);return h.jsx(hmt,{scope:t,forceMount:r,children:h.jsx(Eb,{present:r||s.open,children:h.jsx(mU,{asChild:!0,container:n,children:i})})})};jme.displayName=EU;var Yl="MenuContent",[fmt,AU]=E0(Yl),Lme=O.forwardRef((e,t)=>{const r=Ome(Yl,e.__scopeMenu),{forceMount:i=r.forceMount,...n}=e,s=A0(Yl,e.__scopeMenu),a=xS(Yl,e.__scopeMenu);return h.jsx(x_.Provider,{scope:e.__scopeMenu,children:h.jsx(Eb,{present:i||s.open,children:h.jsx(x_.Slot,{scope:e.__scopeMenu,children:a.modal?h.jsx(pmt,{...n,ref:t}):h.jsx(mmt,{...n,ref:t})})})})}),pmt=O.forwardRef((e,t)=>{const r=A0(Yl,e.__scopeMenu),i=O.useRef(null),n=fn(t,i);return O.useEffect(()=>{const s=i.current;if(s)return vpe(s)},[]),h.jsx(CU,{...e,ref:n,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:ir(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),mmt=O.forwardRef((e,t)=>{const r=A0(Yl,e.__scopeMenu);return h.jsx(CU,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),gmt=Ix("MenuContent.ScrollLock"),CU=O.forwardRef((e,t)=>{const{__scopeMenu:r,loop:i=!1,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:m,disableOutsideScroll:v,...y}=e,x=A0(Yl,r),w=xS(Yl,r),_=sN(r),S=Rme(r),P=omt(r),[M,C]=O.useState(null),T=O.useRef(null),E=fn(t,T,x.onContentChange),N=O.useRef(0),D=O.useRef(""),I=O.useRef(0),j=O.useRef(null),L=O.useRef("right"),B=O.useRef(0),q=v?gU:O.Fragment,G=v?{as:gmt,allowPinchZoom:!0}:void 0,Y=re=>{const F=D.current+re,$=P().filter(ae=>!ae.disabled),se=document.activeElement,H=$.find(ae=>ae.ref.current===se)?.textValue,ne=$.map(ae=>ae.textValue),ce=Mmt(ne,F,H),ie=$.find(ae=>ae.textValue===ce)?.ref.current;(function ae(Z){D.current=Z,window.clearTimeout(N.current),Z!==""&&(N.current=window.setTimeout(()=>ae(""),1e3))})(F),ie&&setTimeout(()=>ie.focus())};O.useEffect(()=>()=>window.clearTimeout(N.current),[]),Ufe();const X=O.useCallback(re=>L.current===j.current?.side&&Dmt(re,j.current?.area),[]);return h.jsx(fmt,{scope:r,searchRef:D,onItemEnter:O.useCallback(re=>{X(re)&&re.preventDefault()},[X]),onItemLeave:O.useCallback(re=>{X(re)||(T.current?.focus(),C(null))},[X]),onTriggerLeave:O.useCallback(re=>{X(re)&&re.preventDefault()},[X]),pointerGraceTimerRef:I,onPointerGraceIntentChange:O.useCallback(re=>{j.current=re},[]),children:h.jsx(q,{...G,children:h.jsx(sU,{asChild:!0,trapped:n,onMountAutoFocus:ir(s,re=>{re.preventDefault(),T.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:h.jsx(nU,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,onDismiss:m,children:h.jsx(tme,{asChild:!0,...S,dir:w.dir,orientation:"vertical",loop:i,currentTabStopId:M,onCurrentTabStopIdChange:C,onEntryFocus:ir(l,re=>{w.isUsingKeyboardRef.current||re.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(fpe,{role:"menu","aria-orientation":"vertical","data-state":Jme(x.open),"data-radix-menu-content":"",dir:w.dir,..._,...y,ref:E,style:{outline:"none",...y.style},onKeyDown:ir(y.onKeyDown,re=>{const $=re.target.closest("[data-radix-menu-content]")===re.currentTarget,se=re.ctrlKey||re.altKey||re.metaKey,H=re.key.length===1;$&&(re.key==="Tab"&&re.preventDefault(),!se&&H&&Y(re.key));const ne=T.current;if(re.target!==ne||!nmt.includes(re.key))return;re.preventDefault();const ie=P().filter(ae=>!ae.disabled).map(ae=>ae.ref.current);Nme.includes(re.key)&&ie.reverse(),Cmt(ie)}),onBlur:ir(e.onBlur,re=>{re.currentTarget.contains(re.target)||(window.clearTimeout(N.current),D.current="")}),onPointerMove:ir(e.onPointerMove,b_(re=>{const F=re.target,$=B.current!==re.clientX;if(re.currentTarget.contains(F)&&$){const se=re.clientX>B.current?"right":"left";L.current=se,B.current=re.clientX}}))})})})})})})});Lme.displayName=Yl;var vmt="MenuGroup",TU=O.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e;return h.jsx(di.div,{role:"group",...i,ref:t})});TU.displayName=vmt;var ymt="MenuLabel",zme=O.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e;return h.jsx(di.div,{...i,ref:t})});zme.displayName=ymt;var n3="MenuItem",qee="menu.itemSelect",aN=O.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:i,...n}=e,s=O.useRef(null),a=xS(n3,e.__scopeMenu),o=AU(n3,e.__scopeMenu),l=fn(t,s),c=O.useRef(!1),u=()=>{const d=s.current;if(!r&&d){const f=new CustomEvent(qee,{bubbles:!0,cancelable:!0});d.addEventListener(qee,m=>i?.(m),{once:!0}),zfe(d,f),f.defaultPrevented?c.current=!1:a.onClose()}};return h.jsx(Bme,{...n,ref:l,disabled:r,onClick:ir(e.onClick,u),onPointerDown:d=>{e.onPointerDown?.(d),c.current=!0},onPointerUp:ir(e.onPointerUp,d=>{c.current||d.currentTarget?.click()}),onKeyDown:ir(e.onKeyDown,d=>{const f=o.searchRef.current!=="";r||f&&d.key===" "||o6.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});aN.displayName=n3;var Bme=O.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:i=!1,textValue:n,...s}=e,a=AU(n3,r),o=Rme(r),l=O.useRef(null),c=fn(t,l),[u,d]=O.useState(!1),[f,m]=O.useState("");return O.useEffect(()=>{const v=l.current;v&&m((v.textContent??"").trim())},[s.children]),h.jsx(x_.ItemSlot,{scope:r,disabled:i,textValue:n??f,children:h.jsx(rme,{asChild:!0,...o,focusable:!i,children:h.jsx(di.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...s,ref:c,onPointerMove:ir(e.onPointerMove,b_(v=>{i?a.onItemLeave(v):(a.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ir(e.onPointerLeave,b_(v=>a.onItemLeave(v))),onFocus:ir(e.onFocus,()=>d(!0)),onBlur:ir(e.onBlur,()=>d(!1))})})})}),xmt="MenuCheckboxItem",Fme=O.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:i,...n}=e;return h.jsx(Wme,{scope:e.__scopeMenu,checked:r,children:h.jsx(aN,{role:"menuitemcheckbox","aria-checked":s3(r)?"mixed":r,...n,ref:t,"data-state":PU(r),onSelect:ir(n.onSelect,()=>i?.(s3(r)?!0:!r),{checkForDefaultPrevented:!1})})})});Fme.displayName=xmt;var Vme="MenuRadioGroup",[bmt,wmt]=E0(Vme,{value:void 0,onValueChange:()=>{}}),Ume=O.forwardRef((e,t)=>{const{value:r,onValueChange:i,...n}=e,s=ld(i);return h.jsx(bmt,{scope:e.__scopeMenu,value:r,onValueChange:s,children:h.jsx(TU,{...n,ref:t})})});Ume.displayName=Vme;var Hme="MenuRadioItem",Gme=O.forwardRef((e,t)=>{const{value:r,...i}=e,n=wmt(Hme,e.__scopeMenu),s=r===n.value;return h.jsx(Wme,{scope:e.__scopeMenu,checked:s,children:h.jsx(aN,{role:"menuitemradio","aria-checked":s,...i,ref:t,"data-state":PU(s),onSelect:ir(i.onSelect,()=>n.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});Gme.displayName=Hme;var MU="MenuItemIndicator",[Wme,_mt]=E0(MU,{checked:!1}),qme=O.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:i,...n}=e,s=_mt(MU,r);return h.jsx(Eb,{present:i||s3(s.checked)||s.checked===!0,children:h.jsx(di.span,{...n,ref:t,"data-state":PU(s.checked)})})});qme.displayName=MU;var Smt="MenuSeparator",Yme=O.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e;return h.jsx(di.div,{role:"separator","aria-orientation":"horizontal",...i,ref:t})});Yme.displayName=Smt;var Emt="MenuArrow",Xme=O.forwardRef((e,t)=>{const{__scopeMenu:r,...i}=e,n=sN(r);return h.jsx(ppe,{...n,...i,ref:t})});Xme.displayName=Emt;var Amt="MenuSub",[DEt,$me]=E0(Amt),zw="MenuSubTrigger",Kme=O.forwardRef((e,t)=>{const r=A0(zw,e.__scopeMenu),i=xS(zw,e.__scopeMenu),n=$me(zw,e.__scopeMenu),s=AU(zw,e.__scopeMenu),a=O.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=s,c={__scopeMenu:e.__scopeMenu},u=O.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return O.useEffect(()=>u,[u]),O.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),l(null)}},[o,l]),h.jsx(SU,{asChild:!0,...c,children:h.jsx(Bme,{id:n.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":n.contentId,"data-state":Jme(r.open),...e,ref:BD(t,n.onTriggerChange),onClick:d=>{e.onClick?.(d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:ir(e.onPointerMove,b_(d=>{s.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!r.open&&!a.current&&(s.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:ir(e.onPointerLeave,b_(d=>{u();const f=r.content?.getBoundingClientRect();if(f){const m=r.content?.dataset.side,v=m==="right",y=v?-5:5,x=f[v?"left":"right"],w=f[v?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+y,y:d.clientY},{x,y:f.top},{x:w,y:f.top},{x:w,y:f.bottom},{x,y:f.bottom}],side:m}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:ir(e.onKeyDown,d=>{const f=s.searchRef.current!=="";e.disabled||f&&d.key===" "||smt[i.dir].includes(d.key)&&(r.onOpenChange(!0),r.content?.focus(),d.preventDefault())})})})});Kme.displayName=zw;var Qme="MenuSubContent",Zme=O.forwardRef((e,t)=>{const r=Ome(Yl,e.__scopeMenu),{forceMount:i=r.forceMount,...n}=e,s=A0(Yl,e.__scopeMenu),a=xS(Yl,e.__scopeMenu),o=$me(Qme,e.__scopeMenu),l=O.useRef(null),c=fn(t,l);return h.jsx(x_.Provider,{scope:e.__scopeMenu,children:h.jsx(Eb,{present:i||s.open,children:h.jsx(x_.Slot,{scope:e.__scopeMenu,children:h.jsx(CU,{id:o.contentId,"aria-labelledby":o.triggerId,...n,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{a.isUsingKeyboardRef.current&&l.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ir(e.onFocusOutside,u=>{u.target!==o.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:ir(e.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:ir(e.onKeyDown,u=>{const d=u.currentTarget.contains(u.target),f=amt[a.dir].includes(u.key);d&&f&&(s.onOpenChange(!1),o.trigger?.focus(),u.preventDefault())})})})})})});Zme.displayName=Qme;function Jme(e){return e?"open":"closed"}function s3(e){return e==="indeterminate"}function PU(e){return s3(e)?"indeterminate":e?"checked":"unchecked"}function Cmt(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function Tmt(e,t){return e.map((r,i)=>e[(t+i)%e.length])}function Mmt(e,t,r){const n=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let a=Tmt(e,Math.max(s,0));n.length===1&&(a=a.filter(c=>c!==r));const l=a.find(c=>c.toLowerCase().startsWith(n.toLowerCase()));return l!==r?l:void 0}function Pmt(e,t){const{x:r,y:i}=e;let n=!1;for(let s=0,a=t.length-1;s<t.length;a=s++){const o=t[s],l=t[a],c=o.x,u=o.y,d=l.x,f=l.y;u>i!=f>i&&r<(d-c)*(i-u)/(f-u)+c&&(n=!n)}return n}function Dmt(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return Pmt(r,t)}function b_(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Nmt=Ime,kmt=SU,Rmt=jme,Imt=Lme,Omt=TU,jmt=zme,Lmt=aN,zmt=Fme,Bmt=Ume,Fmt=Gme,Vmt=qme,Umt=Yme,Hmt=Xme,Gmt=Kme,Wmt=Zme,oN="DropdownMenu",[qmt,NEt]=S0(oN,[kme]),po=kme(),[Ymt,ege]=qmt(oN),tge=e=>{const{__scopeDropdownMenu:t,children:r,dir:i,open:n,defaultOpen:s,onOpenChange:a,modal:o=!0}=e,l=po(t),c=O.useRef(null),[u,d]=g_({prop:n,defaultProp:s??!1,onChange:a,caller:oN});return h.jsx(Ymt,{scope:t,triggerId:s0(),triggerRef:c,contentId:s0(),open:u,onOpenChange:d,onOpenToggle:O.useCallback(()=>d(f=>!f),[d]),modal:o,children:h.jsx(Nmt,{...l,open:u,onOpenChange:d,dir:i,modal:o,children:r})})};tge.displayName=oN;var rge="DropdownMenuTrigger",ige=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:i=!1,...n}=e,s=ege(rge,r),a=po(r);return h.jsx(kmt,{asChild:!0,...a,children:h.jsx(di.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...n,ref:BD(t,s.triggerRef),onPointerDown:ir(e.onPointerDown,o=>{!i&&o.button===0&&o.ctrlKey===!1&&(s.onOpenToggle(),s.open||o.preventDefault())}),onKeyDown:ir(e.onKeyDown,o=>{i||(["Enter"," "].includes(o.key)&&s.onOpenToggle(),o.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});ige.displayName=rge;var Xmt="DropdownMenuPortal",nge=e=>{const{__scopeDropdownMenu:t,...r}=e,i=po(t);return h.jsx(Rmt,{...i,...r})};nge.displayName=Xmt;var sge="DropdownMenuContent",age=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=ege(sge,r),s=po(r),a=O.useRef(!1);return h.jsx(Imt,{id:n.contentId,"aria-labelledby":n.triggerId,...s,...i,ref:t,onCloseAutoFocus:ir(e.onCloseAutoFocus,o=>{a.current||n.triggerRef.current?.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:ir(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!n.modal||u)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});age.displayName=sge;var $mt="DropdownMenuGroup",Kmt=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(Omt,{...n,...i,ref:t})});Kmt.displayName=$mt;var Qmt="DropdownMenuLabel",Zmt=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(jmt,{...n,...i,ref:t})});Zmt.displayName=Qmt;var Jmt="DropdownMenuItem",oge=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(Lmt,{...n,...i,ref:t})});oge.displayName=Jmt;var egt="DropdownMenuCheckboxItem",tgt=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(zmt,{...n,...i,ref:t})});tgt.displayName=egt;var rgt="DropdownMenuRadioGroup",igt=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(Bmt,{...n,...i,ref:t})});igt.displayName=rgt;var ngt="DropdownMenuRadioItem",sgt=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(Fmt,{...n,...i,ref:t})});sgt.displayName=ngt;var agt="DropdownMenuItemIndicator",ogt=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(Vmt,{...n,...i,ref:t})});ogt.displayName=agt;var lgt="DropdownMenuSeparator",cgt=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(Umt,{...n,...i,ref:t})});cgt.displayName=lgt;var ugt="DropdownMenuArrow",dgt=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(Hmt,{...n,...i,ref:t})});dgt.displayName=ugt;var hgt="DropdownMenuSubTrigger",fgt=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(Gmt,{...n,...i,ref:t})});fgt.displayName=hgt;var pgt="DropdownMenuSubContent",mgt=O.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...i}=e,n=po(r);return h.jsx(Wmt,{...n,...i,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mgt.displayName=pgt;var ggt=tge,vgt=ige,ygt=nge,xgt=age,bgt=oge;function wgt({...e}){return h.jsx(ggt,{"data-slot":"dropdown-menu",...e})}function _gt({...e}){return h.jsx(vgt,{"data-slot":"dropdown-menu-trigger",...e})}function Sgt({className:e,sideOffset:t=4,...r}){return h.jsx(ygt,{children:h.jsx(xgt,{"data-slot":"dropdown-menu-content",sideOffset:t,className:Nn("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...r})})}function Egt({className:e,inset:t,variant:r="default",...i}){return h.jsx(bgt,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":r,className:Nn("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...i})}const Agt=({sub:e})=>{const[t,r]=O.useState(!1),i=e.status==="accepted",n=e.status?.replace(/_/g," ")||"Failed";return h.jsxs("div",{className:"bg-white dark:bg-neutral-900/80 rounded-lg p-4 flex flex-col gap-3 border border-neutral-200 dark:border-neutral-800 shadow-sm",children:[h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex items-center flex-wrap gap-3",children:[h.jsx(e3,{variant:"outline",className:`\r
                        bg-blue-100 text-blue-800 border-blue-200 \r
                        dark:bg-blue-900/50 dark:text-blue-300 dark:border-blue-500/30\r
                        font-mono capitalize`,children:e.language}),h.jsx("span",{className:`text-sm font-semibold capitalize 
                        ${i?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:n})]}),h.jsx("span",{className:"text-xs text-neutral-500 dark:text-neutral-400 whitespace-nowrap pl-4",children:new Date(e.submitted_at).toLocaleString()})]}),h.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-neutral-600 dark:text-neutral-400",children:[h.jsxs("span",{children:["Test Cases: ",h.jsx("span",{className:"font-semibold text-neutral-800 dark:text-neutral-200",children:e.testcases_passed})]}),h.jsxs("span",{children:["Runtime: ",h.jsx("span",{className:"font-semibold text-neutral-800 dark:text-neutral-200",children:e.runtime})]}),h.jsxs("span",{children:["Memory: ",h.jsx("span",{className:"font-semibold text-neutral-800 dark:text-neutral-200",children:e.memory})]})]}),!i&&e.error_message&&h.jsxs("div",{className:`mt-1 text-sm \r
                    bg-red-50 text-red-700 p-3 rounded-md border border-red-200\r
                    dark:bg-red-900/20 dark:text-red-400 dark:border-red-500/20`,children:[h.jsx("span",{className:"font-semibold",children:"Error:"})," ",e.error_message]}),h.jsx("div",{className:"mt-1",children:h.jsxs("details",{className:"group",open:t,onToggle:s=>r(s.currentTarget.open),children:[h.jsxs("summary",{className:`cursor-pointer text-sm font-medium \r
                        text-blue-600 hover:underline \r
                        dark:text-sky-400\r
                        flex items-center gap-1 list-none`,children:[h.jsx(Ky,{className:`h-4 w-4 transition-transform duration-200 ${t?"rotate-90":""}`}),t?"Hide Code":"View Code"]}),h.jsx("div",{className:`mt-2 \r
                        bg-neutral-100 text-neutral-800\r
                        dark:bg-neutral-800/60 dark:text-neutral-200\r
                        rounded p-3 overflow-x-auto text-xs font-mono border border-neutral-200 dark:border-neutral-700`,children:h.jsx("pre",{children:e.code})})]})})]})};function Cgt(e,t){const r={};return(e[e.length-1]===""?[...e,""]:e).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const Tgt=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Mgt=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Pgt={};function Yee(e,t){return(Pgt.jsx?Mgt:Tgt).test(e)}const Dgt=/[ \t\n\f\r]/g;function Ngt(e){return typeof e=="object"?e.type==="text"?Xee(e.value):!1:Xee(e)}function Xee(e){return e.replace(Dgt,"")===""}class bS{constructor(t,r,i){this.normal=r,this.property=t,i&&(this.space=i)}}bS.prototype.normal={};bS.prototype.property={};bS.prototype.space=void 0;function lge(e,t){const r={},i={};for(const n of e)Object.assign(r,n.property),Object.assign(i,n.normal);return new bS(r,i,t)}function l6(e){return e.toLowerCase()}class zo{constructor(t,r){this.attribute=r,this.property=t}}zo.prototype.attribute="";zo.prototype.booleanish=!1;zo.prototype.boolean=!1;zo.prototype.commaOrSpaceSeparated=!1;zo.prototype.commaSeparated=!1;zo.prototype.defined=!1;zo.prototype.mustUseProperty=!1;zo.prototype.number=!1;zo.prototype.overloadedBoolean=!1;zo.prototype.property="";zo.prototype.spaceSeparated=!1;zo.prototype.space=void 0;let kgt=0;const Or=C0(),es=C0(),c6=C0(),gt=C0(),Zi=C0(),tx=C0(),Qo=C0();function C0(){return 2**++kgt}const u6=Object.freeze(Object.defineProperty({__proto__:null,boolean:Or,booleanish:es,commaOrSpaceSeparated:Qo,commaSeparated:tx,number:gt,overloadedBoolean:c6,spaceSeparated:Zi},Symbol.toStringTag,{value:"Module"})),VO=Object.keys(u6);class DU extends zo{constructor(t,r,i,n){let s=-1;if(super(t,r),$ee(this,"space",n),typeof i=="number")for(;++s<VO.length;){const a=VO[s];$ee(this,VO[s],(i&u6[a])===u6[a])}}}DU.prototype.defined=!0;function $ee(e,t,r){r&&(e[t]=r)}function Ab(e){const t={},r={};for(const[i,n]of Object.entries(e.properties)){const s=new DU(i,e.transform(e.attributes||{},i),n,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(s.mustUseProperty=!0),t[i]=s,r[l6(i)]=i,r[l6(s.attribute)]=i}return new bS(t,r,e.space)}const cge=Ab({properties:{ariaActiveDescendant:null,ariaAtomic:es,ariaAutoComplete:null,ariaBusy:es,ariaChecked:es,ariaColCount:gt,ariaColIndex:gt,ariaColSpan:gt,ariaControls:Zi,ariaCurrent:null,ariaDescribedBy:Zi,ariaDetails:null,ariaDisabled:es,ariaDropEffect:Zi,ariaErrorMessage:null,ariaExpanded:es,ariaFlowTo:Zi,ariaGrabbed:es,ariaHasPopup:null,ariaHidden:es,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Zi,ariaLevel:gt,ariaLive:null,ariaModal:es,ariaMultiLine:es,ariaMultiSelectable:es,ariaOrientation:null,ariaOwns:Zi,ariaPlaceholder:null,ariaPosInSet:gt,ariaPressed:es,ariaReadOnly:es,ariaRelevant:null,ariaRequired:es,ariaRoleDescription:Zi,ariaRowCount:gt,ariaRowIndex:gt,ariaRowSpan:gt,ariaSelected:es,ariaSetSize:gt,ariaSort:null,ariaValueMax:gt,ariaValueMin:gt,ariaValueNow:gt,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function uge(e,t){return t in e?e[t]:t}function dge(e,t){return uge(e,t.toLowerCase())}const Rgt=Ab({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:tx,acceptCharset:Zi,accessKey:Zi,action:null,allow:null,allowFullScreen:Or,allowPaymentRequest:Or,allowUserMedia:Or,alt:null,as:null,async:Or,autoCapitalize:null,autoComplete:Zi,autoFocus:Or,autoPlay:Or,blocking:Zi,capture:null,charSet:null,checked:Or,cite:null,className:Zi,cols:gt,colSpan:null,content:null,contentEditable:es,controls:Or,controlsList:Zi,coords:gt|tx,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Or,defer:Or,dir:null,dirName:null,disabled:Or,download:c6,draggable:es,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Or,formTarget:null,headers:Zi,height:gt,hidden:c6,high:gt,href:null,hrefLang:null,htmlFor:Zi,httpEquiv:Zi,id:null,imageSizes:null,imageSrcSet:null,inert:Or,inputMode:null,integrity:null,is:null,isMap:Or,itemId:null,itemProp:Zi,itemRef:Zi,itemScope:Or,itemType:Zi,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Or,low:gt,manifest:null,max:null,maxLength:gt,media:null,method:null,min:null,minLength:gt,multiple:Or,muted:Or,name:null,nonce:null,noModule:Or,noValidate:Or,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Or,optimum:gt,pattern:null,ping:Zi,placeholder:null,playsInline:Or,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Or,referrerPolicy:null,rel:Zi,required:Or,reversed:Or,rows:gt,rowSpan:gt,sandbox:Zi,scope:null,scoped:Or,seamless:Or,selected:Or,shadowRootClonable:Or,shadowRootDelegatesFocus:Or,shadowRootMode:null,shape:null,size:gt,sizes:null,slot:null,span:gt,spellCheck:es,src:null,srcDoc:null,srcLang:null,srcSet:null,start:gt,step:null,style:null,tabIndex:gt,target:null,title:null,translate:null,type:null,typeMustMatch:Or,useMap:null,value:es,width:gt,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Zi,axis:null,background:null,bgColor:null,border:gt,borderColor:null,bottomMargin:gt,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Or,declare:Or,event:null,face:null,frame:null,frameBorder:null,hSpace:gt,leftMargin:gt,link:null,longDesc:null,lowSrc:null,marginHeight:gt,marginWidth:gt,noResize:Or,noHref:Or,noShade:Or,noWrap:Or,object:null,profile:null,prompt:null,rev:null,rightMargin:gt,rules:null,scheme:null,scrolling:es,standby:null,summary:null,text:null,topMargin:gt,valueType:null,version:null,vAlign:null,vLink:null,vSpace:gt,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Or,disableRemotePlayback:Or,prefix:null,property:null,results:gt,security:null,unselectable:null},space:"html",transform:dge}),Igt=Ab({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Qo,accentHeight:gt,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:gt,amplitude:gt,arabicForm:null,ascent:gt,attributeName:null,attributeType:null,azimuth:gt,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:gt,by:null,calcMode:null,capHeight:gt,className:Zi,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:gt,diffuseConstant:gt,direction:null,display:null,dur:null,divisor:gt,dominantBaseline:null,download:Or,dx:null,dy:null,edgeMode:null,editable:null,elevation:gt,enableBackground:null,end:null,event:null,exponent:gt,externalResourcesRequired:null,fill:null,fillOpacity:gt,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:tx,g2:tx,glyphName:tx,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:gt,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:gt,horizOriginX:gt,horizOriginY:gt,id:null,ideographic:gt,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:gt,k:gt,k1:gt,k2:gt,k3:gt,k4:gt,kernelMatrix:Qo,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:gt,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:gt,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:gt,overlineThickness:gt,paintOrder:null,panose1:null,path:null,pathLength:gt,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Zi,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:gt,pointsAtY:gt,pointsAtZ:gt,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Qo,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Qo,rev:Qo,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Qo,requiredFeatures:Qo,requiredFonts:Qo,requiredFormats:Qo,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:gt,specularExponent:gt,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:gt,strikethroughThickness:gt,string:null,stroke:null,strokeDashArray:Qo,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:gt,strokeOpacity:gt,strokeWidth:null,style:null,surfaceScale:gt,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Qo,tabIndex:gt,tableValues:null,target:null,targetX:gt,targetY:gt,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Qo,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:gt,underlineThickness:gt,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:gt,values:null,vAlphabetic:gt,vMathematical:gt,vectorEffect:null,vHanging:gt,vIdeographic:gt,version:null,vertAdvY:gt,vertOriginX:gt,vertOriginY:gt,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:gt,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:uge}),hge=Ab({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),fge=Ab({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:dge}),pge=Ab({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),Ogt={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},jgt=/[A-Z]/g,Kee=/-[a-z]/g,Lgt=/^data[-\w.:]+$/i;function zgt(e,t){const r=l6(t);let i=t,n=zo;if(r in e.normal)return e.property[e.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&Lgt.test(t)){if(t.charAt(4)==="-"){const s=t.slice(5).replace(Kee,Fgt);i="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=t.slice(4);if(!Kee.test(s)){let a=s.replace(jgt,Bgt);a.charAt(0)!=="-"&&(a="-"+a),t="data"+a}}n=DU}return new n(i,t)}function Bgt(e){return"-"+e.toLowerCase()}function Fgt(e){return e.charAt(1).toUpperCase()}const Vgt=lge([cge,Rgt,hge,fge,pge],"html"),NU=lge([cge,Igt,hge,fge,pge],"svg");function Ugt(e){return e.join(" ").trim()}var Kv={},UO,Qee;function Hgt(){if(Qee)return UO;Qee=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,t=/\n/g,r=/^\s*/,i=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,n=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,a=/^[;\s]*/,o=/^\s+|\s+$/g,l=`
`,c="/",u="*",d="",f="comment",m="declaration";UO=function(y,x){if(typeof y!="string")throw new TypeError("First argument must be a string");if(!y)return[];x=x||{};var w=1,_=1;function S(L){var B=L.match(t);B&&(w+=B.length);var q=L.lastIndexOf(l);_=~q?L.length-q:_+L.length}function P(){var L={line:w,column:_};return function(B){return B.position=new M(L),E(),B}}function M(L){this.start=L,this.end={line:w,column:_},this.source=x.source}M.prototype.content=y;function C(L){var B=new Error(x.source+":"+w+":"+_+": "+L);if(B.reason=L,B.filename=x.source,B.line=w,B.column=_,B.source=y,!x.silent)throw B}function T(L){var B=L.exec(y);if(B){var q=B[0];return S(q),y=y.slice(q.length),B}}function E(){T(r)}function N(L){var B;for(L=L||[];B=D();)B!==!1&&L.push(B);return L}function D(){var L=P();if(!(c!=y.charAt(0)||u!=y.charAt(1))){for(var B=2;d!=y.charAt(B)&&(u!=y.charAt(B)||c!=y.charAt(B+1));)++B;if(B+=2,d===y.charAt(B-1))return C("End of comment missing");var q=y.slice(2,B-2);return _+=2,S(q),y=y.slice(B),_+=2,L({type:f,comment:q})}}function I(){var L=P(),B=T(i);if(B){if(D(),!T(n))return C("property missing ':'");var q=T(s),G=L({type:m,property:v(B[0].replace(e,d)),value:q?v(q[0].replace(e,d)):d});return T(a),G}}function j(){var L=[];N(L);for(var B;B=I();)B!==!1&&(L.push(B),N(L));return L}return E(),j()};function v(y){return y?y.replace(o,d):d}return UO}var Zee;function Ggt(){if(Zee)return Kv;Zee=1;var e=Kv&&Kv.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Kv,"__esModule",{value:!0}),Kv.default=r;var t=e(Hgt());function r(i,n){var s=null;if(!i||typeof i!="string")return s;var a=(0,t.default)(i),o=typeof n=="function";return a.forEach(function(l){if(l.type==="declaration"){var c=l.property,u=l.value;o?n(c,u,l):u&&(s=s||{},s[c]=u)}}),s}return Kv}var ow={},Jee;function Wgt(){if(Jee)return ow;Jee=1,Object.defineProperty(ow,"__esModule",{value:!0}),ow.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,t=/-([a-z])/g,r=/^[^-]+$/,i=/^-(webkit|moz|ms|o|khtml)-/,n=/^-(ms)-/,s=function(c){return!c||r.test(c)||e.test(c)},a=function(c,u){return u.toUpperCase()},o=function(c,u){return"".concat(u,"-")},l=function(c,u){return u===void 0&&(u={}),s(c)?c:(c=c.toLowerCase(),u.reactCompat?c=c.replace(n,o):c=c.replace(i,o),c.replace(t,a))};return ow.camelCase=l,ow}var lw,ete;function qgt(){if(ete)return lw;ete=1;var e=lw&&lw.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},t=e(Ggt()),r=Wgt();function i(n,s){var a={};return!n||typeof n!="string"||(0,t.default)(n,function(o,l){o&&l&&(a[(0,r.camelCase)(o,s)]=l)}),a}return i.default=i,lw=i,lw}var Ygt=qgt();const Xgt=d0(Ygt),mge=gge("end"),kU=gge("start");function gge(e){return t;function t(r){const i=r&&r.position&&r.position[e]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function $gt(e){const t=kU(e),r=mge(e);if(t&&r)return{start:t,end:r}}function x2(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?tte(e.position):"start"in e||"end"in e?tte(e):"line"in e||"column"in e?d6(e):""}function d6(e){return rte(e&&e.line)+":"+rte(e&&e.column)}function tte(e){return d6(e&&e.start)+"-"+d6(e&&e.end)}function rte(e){return e&&typeof e=="number"?e:1}class Ga extends Error{constructor(t,r,i){super(),typeof r=="string"&&(i=r,r=void 0);let n="",s={},a=!1;if(r&&("line"in r&&"column"in r?s={place:r}:"start"in r&&"end"in r?s={place:r}:"type"in r?s={ancestors:[r],place:r.position}:s={...r}),typeof t=="string"?n=t:!s.cause&&t&&(a=!0,n=t.message,s.cause=t),!s.ruleId&&!s.source&&typeof i=="string"){const l=i.indexOf(":");l===-1?s.ruleId=i:(s.source=i.slice(0,l),s.ruleId=i.slice(l+1))}if(!s.place&&s.ancestors&&s.ancestors){const l=s.ancestors[s.ancestors.length-1];l&&(s.place=l.position)}const o=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file,this.message=n,this.line=o?o.line:void 0,this.name=x2(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=a&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual,this.expected,this.note,this.url}}Ga.prototype.file="";Ga.prototype.name="";Ga.prototype.reason="";Ga.prototype.message="";Ga.prototype.stack="";Ga.prototype.column=void 0;Ga.prototype.line=void 0;Ga.prototype.ancestors=void 0;Ga.prototype.cause=void 0;Ga.prototype.fatal=void 0;Ga.prototype.place=void 0;Ga.prototype.ruleId=void 0;Ga.prototype.source=void 0;const RU={}.hasOwnProperty,Kgt=new Map,Qgt=/[A-Z]/g,Zgt=new Set(["table","tbody","thead","tfoot","tr"]),Jgt=new Set(["td","th"]),vge="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function e0t(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=t.filePath||void 0;let i;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=l0t(r,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");i=o0t(r,t.jsx,t.jsxs)}const n={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:i,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?NU:Vgt,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},s=yge(n,e,void 0);return s&&typeof s!="string"?s:n.create(e,n.Fragment,{children:s||void 0},void 0)}function yge(e,t,r){if(t.type==="element")return t0t(e,t,r);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return r0t(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return n0t(e,t,r);if(t.type==="mdxjsEsm")return i0t(e,t);if(t.type==="root")return s0t(e,t,r);if(t.type==="text")return a0t(e,t)}function t0t(e,t,r){const i=e.schema;let n=i;t.tagName.toLowerCase()==="svg"&&i.space==="html"&&(n=NU,e.schema=n),e.ancestors.push(t);const s=bge(e,t.tagName,!1),a=c0t(e,t);let o=OU(e,t);return Zgt.has(t.tagName)&&(o=o.filter(function(l){return typeof l=="string"?!Ngt(l):!0})),xge(e,a,s,t),IU(a,o),e.ancestors.pop(),e.schema=i,e.create(t,s,a,r)}function r0t(e,t){if(t.data&&t.data.estree&&e.evaluater){const i=t.data.estree.body[0];return i.type,e.evaluater.evaluateExpression(i.expression)}w_(e,t.position)}function i0t(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);w_(e,t.position)}function n0t(e,t,r){const i=e.schema;let n=i;t.name==="svg"&&i.space==="html"&&(n=NU,e.schema=n),e.ancestors.push(t);const s=t.name===null?e.Fragment:bge(e,t.name,!0),a=u0t(e,t),o=OU(e,t);return xge(e,a,s,t),IU(a,o),e.ancestors.pop(),e.schema=i,e.create(t,s,a,r)}function s0t(e,t,r){const i={};return IU(i,OU(e,t)),e.create(t,e.Fragment,i,r)}function a0t(e,t){return t.value}function xge(e,t,r,i){typeof r!="string"&&r!==e.Fragment&&e.passNode&&(t.node=i)}function IU(e,t){if(t.length>0){const r=t.length>1?t:t[0];r&&(e.children=r)}}function o0t(e,t,r){return i;function i(n,s,a,o){const c=Array.isArray(a.children)?r:t;return o?c(s,a,o):c(s,a)}}function l0t(e,t){return r;function r(i,n,s,a){const o=Array.isArray(s.children),l=kU(i);return t(n,s,a,o,{columnNumber:l?l.column-1:void 0,fileName:e,lineNumber:l?l.line:void 0},void 0)}}function c0t(e,t){const r={};let i,n;for(n in t.properties)if(n!=="children"&&RU.call(t.properties,n)){const s=d0t(e,n,t.properties[n]);if(s){const[a,o]=s;e.tableCellAlignToStyle&&a==="align"&&typeof o=="string"&&Jgt.has(t.tagName)?i=o:r[a]=o}}if(i){const s=r.style||(r.style={});s[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=i}return r}function u0t(e,t){const r={};for(const i of t.attributes)if(i.type==="mdxJsxExpressionAttribute")if(i.data&&i.data.estree&&e.evaluater){const s=i.data.estree.body[0];s.type;const a=s.expression;a.type;const o=a.properties[0];o.type,Object.assign(r,e.evaluater.evaluateExpression(o.argument))}else w_(e,t.position);else{const n=i.name;let s;if(i.value&&typeof i.value=="object")if(i.value.data&&i.value.data.estree&&e.evaluater){const o=i.value.data.estree.body[0];o.type,s=e.evaluater.evaluateExpression(o.expression)}else w_(e,t.position);else s=i.value===null?!0:i.value;r[n]=s}return r}function OU(e,t){const r=[];let i=-1;const n=e.passKeys?new Map:Kgt;for(;++i<t.children.length;){const s=t.children[i];let a;if(e.passKeys){const l=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(l){const c=n.get(l)||0;a=l+"-"+c,n.set(l,c+1)}}const o=yge(e,s,a);o!==void 0&&r.push(o)}return r}function d0t(e,t,r){const i=zgt(e.schema,t);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=i.commaSeparated?Cgt(r):Ugt(r)),i.property==="style"){let n=typeof r=="object"?r:h0t(e,String(r));return e.stylePropertyNameCase==="css"&&(n=f0t(n)),["style",n]}return[e.elementAttributeNameCase==="react"&&i.space?Ogt[i.property]||i.property:i.attribute,r]}}function h0t(e,t){try{return Xgt(t,{reactCompat:!0})}catch(r){if(e.ignoreInvalidStyle)return{};const i=r,n=new Ga("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=vge+"#cannot-parse-style-attribute",n}}function bge(e,t,r){let i;if(!r)i={type:"Literal",value:t};else if(t.includes(".")){const n=t.split(".");let s=-1,a;for(;++s<n.length;){const o=Yee(n[s])?{type:"Identifier",name:n[s]}:{type:"Literal",value:n[s]};a=a?{type:"MemberExpression",object:a,property:o,computed:!!(s&&o.type==="Literal"),optional:!1}:o}i=a}else i=Yee(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(i.type==="Literal"){const n=i.value;return RU.call(e.components,n)?e.components[n]:n}if(e.evaluater)return e.evaluater.evaluateExpression(i);w_(e)}function w_(e,t){const r=new Ga("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=vge+"#cannot-handle-mdx-estrees-without-createevaluater",r}function f0t(e){const t={};let r;for(r in e)RU.call(e,r)&&(t[p0t(r)]=e[r]);return t}function p0t(e){let t=e.replace(Qgt,m0t);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function m0t(e){return"-"+e.toLowerCase()}const HO={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},g0t={};function jU(e,t){const r=g0t,i=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,n=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return wge(e,i,n)}function wge(e,t,r){if(v0t(e)){if("value"in e)return e.type==="html"&&!r?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return ite(e.children,t,r)}return Array.isArray(e)?ite(e,t,r):""}function ite(e,t,r){const i=[];let n=-1;for(;++n<e.length;)i[n]=wge(e[n],t,r);return i.join("")}function v0t(e){return!!(e&&typeof e=="object")}const nte=document.createElement("i");function LU(e){const t="&"+e+";";nte.innerHTML=t;const r=nte.textContent;return r.charCodeAt(r.length-1)===59&&e!=="semi"||r===t?!1:r}function ol(e,t,r,i){const n=e.length;let s=0,a;if(t<0?t=-t>n?0:n+t:t=t>n?n:t,r=r>0?r:0,i.length<1e4)a=Array.from(i),a.unshift(t,r),e.splice(...a);else for(r&&e.splice(t,r);s<i.length;)a=i.slice(s,s+1e4),a.unshift(t,0),e.splice(...a),s+=1e4,t+=1e4}function Ll(e,t){return e.length>0?(ol(e,e.length,0,t),e):t}const ste={}.hasOwnProperty;function _ge(e){const t={};let r=-1;for(;++r<e.length;)y0t(t,e[r]);return t}function y0t(e,t){let r;for(r in t){const n=(ste.call(e,r)?e[r]:void 0)||(e[r]={}),s=t[r];let a;if(s)for(a in s){ste.call(n,a)||(n[a]=[]);const o=s[a];x0t(n[a],Array.isArray(o)?o:o?[o]:[])}}}function x0t(e,t){let r=-1;const i=[];for(;++r<t.length;)(t[r].add==="after"?e:i).push(t[r]);ol(e,0,0,i)}function Sge(e,t){const r=Number.parseInt(e,t);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"�":String.fromCodePoint(r)}function jc(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const so=lm(/[A-Za-z]/),za=lm(/[\dA-Za-z]/),b0t=lm(/[#-'*+\--9=?A-Z^-~]/);function a3(e){return e!==null&&(e<32||e===127)}const h6=lm(/\d/),w0t=lm(/[\dA-Fa-f]/),_0t=lm(/[!-/:-@[-`{-~]/);function or(e){return e!==null&&e<-2}function Xi(e){return e!==null&&(e<0||e===32)}function $r(e){return e===-2||e===-1||e===32}const lN=lm(new RegExp("\\p{P}|\\p{S}","u")),u0=lm(/\s/);function lm(e){return t;function t(r){return r!==null&&r>-1&&e.test(String.fromCharCode(r))}}function Cb(e){const t=[];let r=-1,i=0,n=0;for(;++r<e.length;){const s=e.charCodeAt(r);let a="";if(s===37&&za(e.charCodeAt(r+1))&&za(e.charCodeAt(r+2)))n=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(a=String.fromCharCode(s));else if(s>55295&&s<57344){const o=e.charCodeAt(r+1);s<56320&&o>56319&&o<57344?(a=String.fromCharCode(s,o),n=1):a="�"}else a=String.fromCharCode(s);a&&(t.push(e.slice(i,r),encodeURIComponent(a)),i=r+n+1,a=""),n&&(r+=n,n=0)}return t.join("")+e.slice(i)}function ui(e,t,r,i){const n=i?i-1:Number.POSITIVE_INFINITY;let s=0;return a;function a(l){return $r(l)?(e.enter(r),o(l)):t(l)}function o(l){return $r(l)&&s++<n?(e.consume(l),o):(e.exit(r),t(l))}}const S0t={tokenize:E0t};function E0t(e){const t=e.attempt(this.parser.constructs.contentInitial,i,n);let r;return t;function i(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),ui(e,t,"linePrefix")}function n(o){return e.enter("paragraph"),s(o)}function s(o){const l=e.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=l),r=l,a(o)}function a(o){if(o===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(o);return}return or(o)?(e.consume(o),e.exit("chunkText"),s):(e.consume(o),a)}}const A0t={tokenize:C0t},ate={tokenize:T0t};function C0t(e){const t=this,r=[];let i=0,n,s,a;return o;function o(S){if(i<r.length){const P=r[i];return t.containerState=P[1],e.attempt(P[0].continuation,l,c)(S)}return c(S)}function l(S){if(i++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,n&&_();const P=t.events.length;let M=P,C;for(;M--;)if(t.events[M][0]==="exit"&&t.events[M][1].type==="chunkFlow"){C=t.events[M][1].end;break}w(i);let T=P;for(;T<t.events.length;)t.events[T][1].end={...C},T++;return ol(t.events,M+1,0,t.events.slice(P)),t.events.length=T,c(S)}return o(S)}function c(S){if(i===r.length){if(!n)return f(S);if(n.currentConstruct&&n.currentConstruct.concrete)return v(S);t.interrupt=!!(n.currentConstruct&&!n._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(ate,u,d)(S)}function u(S){return n&&_(),w(i),f(S)}function d(S){return t.parser.lazy[t.now().line]=i!==r.length,a=t.now().offset,v(S)}function f(S){return t.containerState={},e.attempt(ate,m,v)(S)}function m(S){return i++,r.push([t.currentConstruct,t.containerState]),f(S)}function v(S){if(S===null){n&&_(),w(0),e.consume(S);return}return n=n||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:n,contentType:"flow",previous:s}),y(S)}function y(S){if(S===null){x(e.exit("chunkFlow"),!0),w(0),e.consume(S);return}return or(S)?(e.consume(S),x(e.exit("chunkFlow")),i=0,t.interrupt=void 0,o):(e.consume(S),y)}function x(S,P){const M=t.sliceStream(S);if(P&&M.push(null),S.previous=s,s&&(s.next=S),s=S,n.defineSkip(S.start),n.write(M),t.parser.lazy[S.start.line]){let C=n.events.length;for(;C--;)if(n.events[C][1].start.offset<a&&(!n.events[C][1].end||n.events[C][1].end.offset>a))return;const T=t.events.length;let E=T,N,D;for(;E--;)if(t.events[E][0]==="exit"&&t.events[E][1].type==="chunkFlow"){if(N){D=t.events[E][1].end;break}N=!0}for(w(i),C=T;C<t.events.length;)t.events[C][1].end={...D},C++;ol(t.events,E+1,0,t.events.slice(T)),t.events.length=C}}function w(S){let P=r.length;for(;P-- >S;){const M=r[P];t.containerState=M[1],M[0].exit.call(t,e)}r.length=S}function _(){n.write([null]),s=void 0,n=void 0,t.containerState._closeFlow=void 0}}function T0t(e,t,r){return ui(e,e.attempt(this.parser.constructs.document,t,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function jx(e){if(e===null||Xi(e)||u0(e))return 1;if(lN(e))return 2}function cN(e,t,r){const i=[];let n=-1;for(;++n<e.length;){const s=e[n].resolveAll;s&&!i.includes(s)&&(t=s(t,r),i.push(s))}return t}const f6={name:"attention",resolveAll:M0t,tokenize:P0t};function M0t(e,t){let r=-1,i,n,s,a,o,l,c,u;for(;++r<e.length;)if(e[r][0]==="enter"&&e[r][1].type==="attentionSequence"&&e[r][1]._close){for(i=r;i--;)if(e[i][0]==="exit"&&e[i][1].type==="attentionSequence"&&e[i][1]._open&&t.sliceSerialize(e[i][1]).charCodeAt(0)===t.sliceSerialize(e[r][1]).charCodeAt(0)){if((e[i][1]._close||e[r][1]._open)&&(e[r][1].end.offset-e[r][1].start.offset)%3&&!((e[i][1].end.offset-e[i][1].start.offset+e[r][1].end.offset-e[r][1].start.offset)%3))continue;l=e[i][1].end.offset-e[i][1].start.offset>1&&e[r][1].end.offset-e[r][1].start.offset>1?2:1;const d={...e[i][1].end},f={...e[r][1].start};ote(d,-l),ote(f,l),a={type:l>1?"strongSequence":"emphasisSequence",start:d,end:{...e[i][1].end}},o={type:l>1?"strongSequence":"emphasisSequence",start:{...e[r][1].start},end:f},s={type:l>1?"strongText":"emphasisText",start:{...e[i][1].end},end:{...e[r][1].start}},n={type:l>1?"strong":"emphasis",start:{...a.start},end:{...o.end}},e[i][1].end={...a.start},e[r][1].start={...o.end},c=[],e[i][1].end.offset-e[i][1].start.offset&&(c=Ll(c,[["enter",e[i][1],t],["exit",e[i][1],t]])),c=Ll(c,[["enter",n,t],["enter",a,t],["exit",a,t],["enter",s,t]]),c=Ll(c,cN(t.parser.constructs.insideSpan.null,e.slice(i+1,r),t)),c=Ll(c,[["exit",s,t],["enter",o,t],["exit",o,t],["exit",n,t]]),e[r][1].end.offset-e[r][1].start.offset?(u=2,c=Ll(c,[["enter",e[r][1],t],["exit",e[r][1],t]])):u=0,ol(e,i-1,r-i+3,c),r=i+c.length-u-2;break}}for(r=-1;++r<e.length;)e[r][1].type==="attentionSequence"&&(e[r][1].type="data");return e}function P0t(e,t){const r=this.parser.constructs.attentionMarkers.null,i=this.previous,n=jx(i);let s;return a;function a(l){return s=l,e.enter("attentionSequence"),o(l)}function o(l){if(l===s)return e.consume(l),o;const c=e.exit("attentionSequence"),u=jx(l),d=!u||u===2&&n||r.includes(l),f=!n||n===2&&u||r.includes(i);return c._open=!!(s===42?d:d&&(n||!f)),c._close=!!(s===42?f:f&&(u||!d)),t(l)}}function ote(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const D0t={name:"autolink",tokenize:N0t};function N0t(e,t,r){let i=0;return n;function n(m){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s}function s(m){return so(m)?(e.consume(m),a):m===64?r(m):c(m)}function a(m){return m===43||m===45||m===46||za(m)?(i=1,o(m)):c(m)}function o(m){return m===58?(e.consume(m),i=0,l):(m===43||m===45||m===46||za(m))&&i++<32?(e.consume(m),o):(i=0,c(m))}function l(m){return m===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.exit("autolink"),t):m===null||m===32||m===60||a3(m)?r(m):(e.consume(m),l)}function c(m){return m===64?(e.consume(m),u):b0t(m)?(e.consume(m),c):r(m)}function u(m){return za(m)?d(m):r(m)}function d(m){return m===46?(e.consume(m),i=0,u):m===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.exit("autolink"),t):f(m)}function f(m){if((m===45||za(m))&&i++<63){const v=m===45?f:d;return e.consume(m),v}return r(m)}}const wS={partial:!0,tokenize:k0t};function k0t(e,t,r){return i;function i(s){return $r(s)?ui(e,n,"linePrefix")(s):n(s)}function n(s){return s===null||or(s)?t(s):r(s)}}const Ege={continuation:{tokenize:I0t},exit:O0t,name:"blockQuote",tokenize:R0t};function R0t(e,t,r){const i=this;return n;function n(a){if(a===62){const o=i.containerState;return o.open||(e.enter("blockQuote",{_container:!0}),o.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(a),e.exit("blockQuoteMarker"),s}return r(a)}function s(a){return $r(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}}function I0t(e,t,r){const i=this;return n;function n(a){return $r(a)?ui(e,s,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):s(a)}function s(a){return e.attempt(Ege,t,r)(a)}}function O0t(e){e.exit("blockQuote")}const Age={name:"characterEscape",tokenize:j0t};function j0t(e,t,r){return i;function i(s){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(s),e.exit("escapeMarker"),n}function n(s){return _0t(s)?(e.enter("characterEscapeValue"),e.consume(s),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):r(s)}}const Cge={name:"characterReference",tokenize:L0t};function L0t(e,t,r){const i=this;let n=0,s,a;return o;function o(d){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(d),e.exit("characterReferenceMarker"),l}function l(d){return d===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(d),e.exit("characterReferenceMarkerNumeric"),c):(e.enter("characterReferenceValue"),s=31,a=za,u(d))}function c(d){return d===88||d===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(d),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,a=w0t,u):(e.enter("characterReferenceValue"),s=7,a=h6,u(d))}function u(d){if(d===59&&n){const f=e.exit("characterReferenceValue");return a===za&&!LU(i.sliceSerialize(f))?r(d):(e.enter("characterReferenceMarker"),e.consume(d),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return a(d)&&n++<s?(e.consume(d),u):r(d)}}const lte={partial:!0,tokenize:B0t},cte={concrete:!0,name:"codeFenced",tokenize:z0t};function z0t(e,t,r){const i=this,n={partial:!0,tokenize:M};let s=0,a=0,o;return l;function l(C){return c(C)}function c(C){const T=i.events[i.events.length-1];return s=T&&T[1].type==="linePrefix"?T[2].sliceSerialize(T[1],!0).length:0,o=C,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),u(C)}function u(C){return C===o?(a++,e.consume(C),u):a<3?r(C):(e.exit("codeFencedFenceSequence"),$r(C)?ui(e,d,"whitespace")(C):d(C))}function d(C){return C===null||or(C)?(e.exit("codeFencedFence"),i.interrupt?t(C):e.check(lte,y,P)(C)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(C))}function f(C){return C===null||or(C)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),d(C)):$r(C)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),ui(e,m,"whitespace")(C)):C===96&&C===o?r(C):(e.consume(C),f)}function m(C){return C===null||or(C)?d(C):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),v(C))}function v(C){return C===null||or(C)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),d(C)):C===96&&C===o?r(C):(e.consume(C),v)}function y(C){return e.attempt(n,P,x)(C)}function x(C){return e.enter("lineEnding"),e.consume(C),e.exit("lineEnding"),w}function w(C){return s>0&&$r(C)?ui(e,_,"linePrefix",s+1)(C):_(C)}function _(C){return C===null||or(C)?e.check(lte,y,P)(C):(e.enter("codeFlowValue"),S(C))}function S(C){return C===null||or(C)?(e.exit("codeFlowValue"),_(C)):(e.consume(C),S)}function P(C){return e.exit("codeFenced"),t(C)}function M(C,T,E){let N=0;return D;function D(q){return C.enter("lineEnding"),C.consume(q),C.exit("lineEnding"),I}function I(q){return C.enter("codeFencedFence"),$r(q)?ui(C,j,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(q):j(q)}function j(q){return q===o?(C.enter("codeFencedFenceSequence"),L(q)):E(q)}function L(q){return q===o?(N++,C.consume(q),L):N>=a?(C.exit("codeFencedFenceSequence"),$r(q)?ui(C,B,"whitespace")(q):B(q)):E(q)}function B(q){return q===null||or(q)?(C.exit("codeFencedFence"),T(q)):E(q)}}}function B0t(e,t,r){const i=this;return n;function n(a){return a===null?r(a):(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),s)}function s(a){return i.parser.lazy[i.now().line]?r(a):t(a)}}const GO={name:"codeIndented",tokenize:V0t},F0t={partial:!0,tokenize:U0t};function V0t(e,t,r){const i=this;return n;function n(c){return e.enter("codeIndented"),ui(e,s,"linePrefix",5)(c)}function s(c){const u=i.events[i.events.length-1];return u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?a(c):r(c)}function a(c){return c===null?l(c):or(c)?e.attempt(F0t,a,l)(c):(e.enter("codeFlowValue"),o(c))}function o(c){return c===null||or(c)?(e.exit("codeFlowValue"),a(c)):(e.consume(c),o)}function l(c){return e.exit("codeIndented"),t(c)}}function U0t(e,t,r){const i=this;return n;function n(a){return i.parser.lazy[i.now().line]?r(a):or(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n):ui(e,s,"linePrefix",5)(a)}function s(a){const o=i.events[i.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(a):or(a)?n(a):r(a)}}const H0t={name:"codeText",previous:W0t,resolve:G0t,tokenize:q0t};function G0t(e){let t=e.length-4,r=3,i,n;if((e[r][1].type==="lineEnding"||e[r][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(i=r;++i<t;)if(e[i][1].type==="codeTextData"){e[r][1].type="codeTextPadding",e[t][1].type="codeTextPadding",r+=2,t-=2;break}}for(i=r-1,t++;++i<=t;)n===void 0?i!==t&&e[i][1].type!=="lineEnding"&&(n=i):(i===t||e[i][1].type==="lineEnding")&&(e[n][1].type="codeTextData",i!==n+2&&(e[n][1].end=e[i-1][1].end,e.splice(n+2,i-n-2),t-=i-n-2,i=n+2),n=void 0);return e}function W0t(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function q0t(e,t,r){let i=0,n,s;return a;function a(d){return e.enter("codeText"),e.enter("codeTextSequence"),o(d)}function o(d){return d===96?(e.consume(d),i++,o):(e.exit("codeTextSequence"),l(d))}function l(d){return d===null?r(d):d===32?(e.enter("space"),e.consume(d),e.exit("space"),l):d===96?(s=e.enter("codeTextSequence"),n=0,u(d)):or(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),l):(e.enter("codeTextData"),c(d))}function c(d){return d===null||d===32||d===96||or(d)?(e.exit("codeTextData"),l(d)):(e.consume(d),c)}function u(d){return d===96?(e.consume(d),n++,u):n===i?(e.exit("codeTextSequence"),e.exit("codeText"),t(d)):(s.type="codeTextData",c(d))}}class Y0t{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,r){const i=r??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(t,i):t>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(t,r,i){const n=r||0;this.setCursor(Math.trunc(t));const s=this.right.splice(this.right.length-n,Number.POSITIVE_INFINITY);return i&&cw(this.left,i),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),cw(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),cw(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const r=this.left.splice(t,Number.POSITIVE_INFINITY);cw(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);cw(this.left,r.reverse())}}}function cw(e,t){let r=0;if(t.length<1e4)e.push(...t);else for(;r<t.length;)e.push(...t.slice(r,r+1e4)),r+=1e4}function Tge(e){const t={};let r=-1,i,n,s,a,o,l,c;const u=new Y0t(e);for(;++r<u.length;){for(;r in t;)r=t[r];if(i=u.get(r),r&&i[1].type==="chunkFlow"&&u.get(r-1)[1].type==="listItemPrefix"&&(l=i[1]._tokenizer.events,s=0,s<l.length&&l[s][1].type==="lineEndingBlank"&&(s+=2),s<l.length&&l[s][1].type==="content"))for(;++s<l.length&&l[s][1].type!=="content";)l[s][1].type==="chunkText"&&(l[s][1]._isInFirstContentOfListItem=!0,s++);if(i[0]==="enter")i[1].contentType&&(Object.assign(t,X0t(u,r)),r=t[r],c=!0);else if(i[1]._container){for(s=r,n=void 0;s--;)if(a=u.get(s),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(n&&(u.get(n)[1].type="lineEndingBlank"),a[1].type="lineEnding",n=s);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;n&&(i[1].end={...u.get(n)[1].start},o=u.slice(n,r),o.unshift(i),u.splice(n,r-n+1,o))}}return ol(e,0,Number.POSITIVE_INFINITY,u.slice(0)),!c}function X0t(e,t){const r=e.get(t)[1],i=e.get(t)[2];let n=t-1;const s=[];let a=r._tokenizer;a||(a=i.parser[r.contentType](r.start),r._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const o=a.events,l=[],c={};let u,d,f=-1,m=r,v=0,y=0;const x=[y];for(;m;){for(;e.get(++n)[1]!==m;);s.push(n),m._tokenizer||(u=i.sliceStream(m),m.next||u.push(null),d&&a.defineSkip(m.start),m._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(u),m._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),d=m,m=m.next}for(m=r;++f<o.length;)o[f][0]==="exit"&&o[f-1][0]==="enter"&&o[f][1].type===o[f-1][1].type&&o[f][1].start.line!==o[f][1].end.line&&(y=f+1,x.push(y),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(a.events=[],m?(m._tokenizer=void 0,m.previous=void 0):x.pop(),f=x.length;f--;){const w=o.slice(x[f],x[f+1]),_=s.pop();l.push([_,_+w.length-1]),e.splice(_,2,w)}for(l.reverse(),f=-1;++f<l.length;)c[v+l[f][0]]=v+l[f][1],v+=l[f][1]-l[f][0]-1;return c}const $0t={resolve:Q0t,tokenize:Z0t},K0t={partial:!0,tokenize:J0t};function Q0t(e){return Tge(e),e}function Z0t(e,t){let r;return i;function i(o){return e.enter("content"),r=e.enter("chunkContent",{contentType:"content"}),n(o)}function n(o){return o===null?s(o):or(o)?e.check(K0t,a,s)(o):(e.consume(o),n)}function s(o){return e.exit("chunkContent"),e.exit("content"),t(o)}function a(o){return e.consume(o),e.exit("chunkContent"),r.next=e.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,n}}function J0t(e,t,r){const i=this;return n;function n(a){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),ui(e,s,"linePrefix")}function s(a){if(a===null||or(a))return r(a);const o=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(a):e.interrupt(i.parser.constructs.flow,r,t)(a)}}function Mge(e,t,r,i,n,s,a,o,l){const c=l||Number.POSITIVE_INFINITY;let u=0;return d;function d(w){return w===60?(e.enter(i),e.enter(n),e.enter(s),e.consume(w),e.exit(s),f):w===null||w===32||w===41||a3(w)?r(w):(e.enter(i),e.enter(a),e.enter(o),e.enter("chunkString",{contentType:"string"}),y(w))}function f(w){return w===62?(e.enter(s),e.consume(w),e.exit(s),e.exit(n),e.exit(i),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),m(w))}function m(w){return w===62?(e.exit("chunkString"),e.exit(o),f(w)):w===null||w===60||or(w)?r(w):(e.consume(w),w===92?v:m)}function v(w){return w===60||w===62||w===92?(e.consume(w),m):m(w)}function y(w){return!u&&(w===null||w===41||Xi(w))?(e.exit("chunkString"),e.exit(o),e.exit(a),e.exit(i),t(w)):u<c&&w===40?(e.consume(w),u++,y):w===41?(e.consume(w),u--,y):w===null||w===32||w===40||a3(w)?r(w):(e.consume(w),w===92?x:y)}function x(w){return w===40||w===41||w===92?(e.consume(w),y):y(w)}}function Pge(e,t,r,i,n,s){const a=this;let o=0,l;return c;function c(m){return e.enter(i),e.enter(n),e.consume(m),e.exit(n),e.enter(s),u}function u(m){return o>999||m===null||m===91||m===93&&!l||m===94&&!o&&"_hiddenFootnoteSupport"in a.parser.constructs?r(m):m===93?(e.exit(s),e.enter(n),e.consume(m),e.exit(n),e.exit(i),t):or(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),u):(e.enter("chunkString",{contentType:"string"}),d(m))}function d(m){return m===null||m===91||m===93||or(m)||o++>999?(e.exit("chunkString"),u(m)):(e.consume(m),l||(l=!$r(m)),m===92?f:d)}function f(m){return m===91||m===92||m===93?(e.consume(m),o++,d):d(m)}}function Dge(e,t,r,i,n,s){let a;return o;function o(f){return f===34||f===39||f===40?(e.enter(i),e.enter(n),e.consume(f),e.exit(n),a=f===40?41:f,l):r(f)}function l(f){return f===a?(e.enter(n),e.consume(f),e.exit(n),e.exit(i),t):(e.enter(s),c(f))}function c(f){return f===a?(e.exit(s),l(a)):f===null?r(f):or(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),ui(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),u(f))}function u(f){return f===a||f===null||or(f)?(e.exit("chunkString"),c(f)):(e.consume(f),f===92?d:u)}function d(f){return f===a||f===92?(e.consume(f),u):u(f)}}function b2(e,t){let r;return i;function i(n){return or(n)?(e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),r=!0,i):$r(n)?ui(e,i,r?"linePrefix":"lineSuffix")(n):t(n)}}const evt={name:"definition",tokenize:rvt},tvt={partial:!0,tokenize:ivt};function rvt(e,t,r){const i=this;let n;return s;function s(m){return e.enter("definition"),a(m)}function a(m){return Pge.call(i,e,o,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function o(m){return n=jc(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),m===58?(e.enter("definitionMarker"),e.consume(m),e.exit("definitionMarker"),l):r(m)}function l(m){return Xi(m)?b2(e,c)(m):c(m)}function c(m){return Mge(e,u,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function u(m){return e.attempt(tvt,d,d)(m)}function d(m){return $r(m)?ui(e,f,"whitespace")(m):f(m)}function f(m){return m===null||or(m)?(e.exit("definition"),i.parser.defined.push(n),t(m)):r(m)}}function ivt(e,t,r){return i;function i(o){return Xi(o)?b2(e,n)(o):r(o)}function n(o){return Dge(e,s,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function s(o){return $r(o)?ui(e,a,"whitespace")(o):a(o)}function a(o){return o===null||or(o)?t(o):r(o)}}const nvt={name:"hardBreakEscape",tokenize:svt};function svt(e,t,r){return i;function i(s){return e.enter("hardBreakEscape"),e.consume(s),n}function n(s){return or(s)?(e.exit("hardBreakEscape"),t(s)):r(s)}}const avt={name:"headingAtx",resolve:ovt,tokenize:lvt};function ovt(e,t){let r=e.length-2,i=3,n,s;return e[i][1].type==="whitespace"&&(i+=2),r-2>i&&e[r][1].type==="whitespace"&&(r-=2),e[r][1].type==="atxHeadingSequence"&&(i===r-1||r-4>i&&e[r-2][1].type==="whitespace")&&(r-=i+1===r?2:4),r>i&&(n={type:"atxHeadingText",start:e[i][1].start,end:e[r][1].end},s={type:"chunkText",start:e[i][1].start,end:e[r][1].end,contentType:"text"},ol(e,i,r-i+1,[["enter",n,t],["enter",s,t],["exit",s,t],["exit",n,t]])),e}function lvt(e,t,r){let i=0;return n;function n(u){return e.enter("atxHeading"),s(u)}function s(u){return e.enter("atxHeadingSequence"),a(u)}function a(u){return u===35&&i++<6?(e.consume(u),a):u===null||Xi(u)?(e.exit("atxHeadingSequence"),o(u)):r(u)}function o(u){return u===35?(e.enter("atxHeadingSequence"),l(u)):u===null||or(u)?(e.exit("atxHeading"),t(u)):$r(u)?ui(e,o,"whitespace")(u):(e.enter("atxHeadingText"),c(u))}function l(u){return u===35?(e.consume(u),l):(e.exit("atxHeadingSequence"),o(u))}function c(u){return u===null||u===35||Xi(u)?(e.exit("atxHeadingText"),o(u)):(e.consume(u),c)}}const cvt=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],ute=["pre","script","style","textarea"],uvt={concrete:!0,name:"htmlFlow",resolveTo:fvt,tokenize:pvt},dvt={partial:!0,tokenize:gvt},hvt={partial:!0,tokenize:mvt};function fvt(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function pvt(e,t,r){const i=this;let n,s,a,o,l;return c;function c(H){return u(H)}function u(H){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(H),d}function d(H){return H===33?(e.consume(H),f):H===47?(e.consume(H),s=!0,y):H===63?(e.consume(H),n=3,i.interrupt?t:F):so(H)?(e.consume(H),a=String.fromCharCode(H),x):r(H)}function f(H){return H===45?(e.consume(H),n=2,m):H===91?(e.consume(H),n=5,o=0,v):so(H)?(e.consume(H),n=4,i.interrupt?t:F):r(H)}function m(H){return H===45?(e.consume(H),i.interrupt?t:F):r(H)}function v(H){const ne="CDATA[";return H===ne.charCodeAt(o++)?(e.consume(H),o===ne.length?i.interrupt?t:j:v):r(H)}function y(H){return so(H)?(e.consume(H),a=String.fromCharCode(H),x):r(H)}function x(H){if(H===null||H===47||H===62||Xi(H)){const ne=H===47,ce=a.toLowerCase();return!ne&&!s&&ute.includes(ce)?(n=1,i.interrupt?t(H):j(H)):cvt.includes(a.toLowerCase())?(n=6,ne?(e.consume(H),w):i.interrupt?t(H):j(H)):(n=7,i.interrupt&&!i.parser.lazy[i.now().line]?r(H):s?_(H):S(H))}return H===45||za(H)?(e.consume(H),a+=String.fromCharCode(H),x):r(H)}function w(H){return H===62?(e.consume(H),i.interrupt?t:j):r(H)}function _(H){return $r(H)?(e.consume(H),_):D(H)}function S(H){return H===47?(e.consume(H),D):H===58||H===95||so(H)?(e.consume(H),P):$r(H)?(e.consume(H),S):D(H)}function P(H){return H===45||H===46||H===58||H===95||za(H)?(e.consume(H),P):M(H)}function M(H){return H===61?(e.consume(H),C):$r(H)?(e.consume(H),M):S(H)}function C(H){return H===null||H===60||H===61||H===62||H===96?r(H):H===34||H===39?(e.consume(H),l=H,T):$r(H)?(e.consume(H),C):E(H)}function T(H){return H===l?(e.consume(H),l=null,N):H===null||or(H)?r(H):(e.consume(H),T)}function E(H){return H===null||H===34||H===39||H===47||H===60||H===61||H===62||H===96||Xi(H)?M(H):(e.consume(H),E)}function N(H){return H===47||H===62||$r(H)?S(H):r(H)}function D(H){return H===62?(e.consume(H),I):r(H)}function I(H){return H===null||or(H)?j(H):$r(H)?(e.consume(H),I):r(H)}function j(H){return H===45&&n===2?(e.consume(H),G):H===60&&n===1?(e.consume(H),Y):H===62&&n===4?(e.consume(H),$):H===63&&n===3?(e.consume(H),F):H===93&&n===5?(e.consume(H),re):or(H)&&(n===6||n===7)?(e.exit("htmlFlowData"),e.check(dvt,se,L)(H)):H===null||or(H)?(e.exit("htmlFlowData"),L(H)):(e.consume(H),j)}function L(H){return e.check(hvt,B,se)(H)}function B(H){return e.enter("lineEnding"),e.consume(H),e.exit("lineEnding"),q}function q(H){return H===null||or(H)?L(H):(e.enter("htmlFlowData"),j(H))}function G(H){return H===45?(e.consume(H),F):j(H)}function Y(H){return H===47?(e.consume(H),a="",X):j(H)}function X(H){if(H===62){const ne=a.toLowerCase();return ute.includes(ne)?(e.consume(H),$):j(H)}return so(H)&&a.length<8?(e.consume(H),a+=String.fromCharCode(H),X):j(H)}function re(H){return H===93?(e.consume(H),F):j(H)}function F(H){return H===62?(e.consume(H),$):H===45&&n===2?(e.consume(H),F):j(H)}function $(H){return H===null||or(H)?(e.exit("htmlFlowData"),se(H)):(e.consume(H),$)}function se(H){return e.exit("htmlFlow"),t(H)}}function mvt(e,t,r){const i=this;return n;function n(a){return or(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),s):r(a)}function s(a){return i.parser.lazy[i.now().line]?r(a):t(a)}}function gvt(e,t,r){return i;function i(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),e.attempt(wS,t,r)}}const vvt={name:"htmlText",tokenize:yvt};function yvt(e,t,r){const i=this;let n,s,a;return o;function o(F){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(F),l}function l(F){return F===33?(e.consume(F),c):F===47?(e.consume(F),M):F===63?(e.consume(F),S):so(F)?(e.consume(F),E):r(F)}function c(F){return F===45?(e.consume(F),u):F===91?(e.consume(F),s=0,v):so(F)?(e.consume(F),_):r(F)}function u(F){return F===45?(e.consume(F),m):r(F)}function d(F){return F===null?r(F):F===45?(e.consume(F),f):or(F)?(a=d,Y(F)):(e.consume(F),d)}function f(F){return F===45?(e.consume(F),m):d(F)}function m(F){return F===62?G(F):F===45?f(F):d(F)}function v(F){const $="CDATA[";return F===$.charCodeAt(s++)?(e.consume(F),s===$.length?y:v):r(F)}function y(F){return F===null?r(F):F===93?(e.consume(F),x):or(F)?(a=y,Y(F)):(e.consume(F),y)}function x(F){return F===93?(e.consume(F),w):y(F)}function w(F){return F===62?G(F):F===93?(e.consume(F),w):y(F)}function _(F){return F===null||F===62?G(F):or(F)?(a=_,Y(F)):(e.consume(F),_)}function S(F){return F===null?r(F):F===63?(e.consume(F),P):or(F)?(a=S,Y(F)):(e.consume(F),S)}function P(F){return F===62?G(F):S(F)}function M(F){return so(F)?(e.consume(F),C):r(F)}function C(F){return F===45||za(F)?(e.consume(F),C):T(F)}function T(F){return or(F)?(a=T,Y(F)):$r(F)?(e.consume(F),T):G(F)}function E(F){return F===45||za(F)?(e.consume(F),E):F===47||F===62||Xi(F)?N(F):r(F)}function N(F){return F===47?(e.consume(F),G):F===58||F===95||so(F)?(e.consume(F),D):or(F)?(a=N,Y(F)):$r(F)?(e.consume(F),N):G(F)}function D(F){return F===45||F===46||F===58||F===95||za(F)?(e.consume(F),D):I(F)}function I(F){return F===61?(e.consume(F),j):or(F)?(a=I,Y(F)):$r(F)?(e.consume(F),I):N(F)}function j(F){return F===null||F===60||F===61||F===62||F===96?r(F):F===34||F===39?(e.consume(F),n=F,L):or(F)?(a=j,Y(F)):$r(F)?(e.consume(F),j):(e.consume(F),B)}function L(F){return F===n?(e.consume(F),n=void 0,q):F===null?r(F):or(F)?(a=L,Y(F)):(e.consume(F),L)}function B(F){return F===null||F===34||F===39||F===60||F===61||F===96?r(F):F===47||F===62||Xi(F)?N(F):(e.consume(F),B)}function q(F){return F===47||F===62||Xi(F)?N(F):r(F)}function G(F){return F===62?(e.consume(F),e.exit("htmlTextData"),e.exit("htmlText"),t):r(F)}function Y(F){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(F),e.exit("lineEnding"),X}function X(F){return $r(F)?ui(e,re,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(F):re(F)}function re(F){return e.enter("htmlTextData"),a(F)}}const zU={name:"labelEnd",resolveAll:_vt,resolveTo:Svt,tokenize:Evt},xvt={tokenize:Avt},bvt={tokenize:Cvt},wvt={tokenize:Tvt};function _vt(e){let t=-1;const r=[];for(;++t<e.length;){const i=e[t][1];if(r.push(e[t]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const n=i.type==="labelImage"?4:2;i.type="data",t+=n}}return e.length!==r.length&&ol(e,0,e.length,r),e}function Svt(e,t){let r=e.length,i=0,n,s,a,o;for(;r--;)if(n=e[r][1],s){if(n.type==="link"||n.type==="labelLink"&&n._inactive)break;e[r][0]==="enter"&&n.type==="labelLink"&&(n._inactive=!0)}else if(a){if(e[r][0]==="enter"&&(n.type==="labelImage"||n.type==="labelLink")&&!n._balanced&&(s=r,n.type!=="labelLink")){i=2;break}}else n.type==="labelEnd"&&(a=r);const l={type:e[s][1].type==="labelLink"?"link":"image",start:{...e[s][1].start},end:{...e[e.length-1][1].end}},c={type:"label",start:{...e[s][1].start},end:{...e[a][1].end}},u={type:"labelText",start:{...e[s+i+2][1].end},end:{...e[a-2][1].start}};return o=[["enter",l,t],["enter",c,t]],o=Ll(o,e.slice(s+1,s+i+3)),o=Ll(o,[["enter",u,t]]),o=Ll(o,cN(t.parser.constructs.insideSpan.null,e.slice(s+i+4,a-3),t)),o=Ll(o,[["exit",u,t],e[a-2],e[a-1],["exit",c,t]]),o=Ll(o,e.slice(a+1)),o=Ll(o,[["exit",l,t]]),ol(e,s,e.length,o),e}function Evt(e,t,r){const i=this;let n=i.events.length,s,a;for(;n--;)if((i.events[n][1].type==="labelImage"||i.events[n][1].type==="labelLink")&&!i.events[n][1]._balanced){s=i.events[n][1];break}return o;function o(f){return s?s._inactive?d(f):(a=i.parser.defined.includes(jc(i.sliceSerialize({start:s.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelEnd"),l):r(f)}function l(f){return f===40?e.attempt(xvt,u,a?u:d)(f):f===91?e.attempt(bvt,u,a?c:d)(f):a?u(f):d(f)}function c(f){return e.attempt(wvt,u,d)(f)}function u(f){return t(f)}function d(f){return s._balanced=!0,r(f)}}function Avt(e,t,r){return i;function i(d){return e.enter("resource"),e.enter("resourceMarker"),e.consume(d),e.exit("resourceMarker"),n}function n(d){return Xi(d)?b2(e,s)(d):s(d)}function s(d){return d===41?u(d):Mge(e,a,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(d)}function a(d){return Xi(d)?b2(e,l)(d):u(d)}function o(d){return r(d)}function l(d){return d===34||d===39||d===40?Dge(e,c,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(d):u(d)}function c(d){return Xi(d)?b2(e,u)(d):u(d)}function u(d){return d===41?(e.enter("resourceMarker"),e.consume(d),e.exit("resourceMarker"),e.exit("resource"),t):r(d)}}function Cvt(e,t,r){const i=this;return n;function n(o){return Pge.call(i,e,s,a,"reference","referenceMarker","referenceString")(o)}function s(o){return i.parser.defined.includes(jc(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?t(o):r(o)}function a(o){return r(o)}}function Tvt(e,t,r){return i;function i(s){return e.enter("reference"),e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),n}function n(s){return s===93?(e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),e.exit("reference"),t):r(s)}}const Mvt={name:"labelStartImage",resolveAll:zU.resolveAll,tokenize:Pvt};function Pvt(e,t,r){const i=this;return n;function n(o){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(o),e.exit("labelImageMarker"),s}function s(o){return o===91?(e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelImage"),a):r(o)}function a(o){return o===94&&"_hiddenFootnoteSupport"in i.parser.constructs?r(o):t(o)}}const Dvt={name:"labelStartLink",resolveAll:zU.resolveAll,tokenize:Nvt};function Nvt(e,t,r){const i=this;return n;function n(a){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(a),e.exit("labelMarker"),e.exit("labelLink"),s}function s(a){return a===94&&"_hiddenFootnoteSupport"in i.parser.constructs?r(a):t(a)}}const WO={name:"lineEnding",tokenize:kvt};function kvt(e,t){return r;function r(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),ui(e,t,"linePrefix")}}const GT={name:"thematicBreak",tokenize:Rvt};function Rvt(e,t,r){let i=0,n;return s;function s(c){return e.enter("thematicBreak"),a(c)}function a(c){return n=c,o(c)}function o(c){return c===n?(e.enter("thematicBreakSequence"),l(c)):i>=3&&(c===null||or(c))?(e.exit("thematicBreak"),t(c)):r(c)}function l(c){return c===n?(e.consume(c),i++,l):(e.exit("thematicBreakSequence"),$r(c)?ui(e,o,"whitespace")(c):o(c))}}const bo={continuation:{tokenize:Lvt},exit:Bvt,name:"list",tokenize:jvt},Ivt={partial:!0,tokenize:Fvt},Ovt={partial:!0,tokenize:zvt};function jvt(e,t,r){const i=this,n=i.events[i.events.length-1];let s=n&&n[1].type==="linePrefix"?n[2].sliceSerialize(n[1],!0).length:0,a=0;return o;function o(m){const v=i.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(v==="listUnordered"?!i.containerState.marker||m===i.containerState.marker:h6(m)){if(i.containerState.type||(i.containerState.type=v,e.enter(v,{_container:!0})),v==="listUnordered")return e.enter("listItemPrefix"),m===42||m===45?e.check(GT,r,c)(m):c(m);if(!i.interrupt||m===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),l(m)}return r(m)}function l(m){return h6(m)&&++a<10?(e.consume(m),l):(!i.interrupt||a<2)&&(i.containerState.marker?m===i.containerState.marker:m===41||m===46)?(e.exit("listItemValue"),c(m)):r(m)}function c(m){return e.enter("listItemMarker"),e.consume(m),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||m,e.check(wS,i.interrupt?r:u,e.attempt(Ivt,f,d))}function u(m){return i.containerState.initialBlankLine=!0,s++,f(m)}function d(m){return $r(m)?(e.enter("listItemPrefixWhitespace"),e.consume(m),e.exit("listItemPrefixWhitespace"),f):r(m)}function f(m){return i.containerState.size=s+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(m)}}function Lvt(e,t,r){const i=this;return i.containerState._closeFlow=void 0,e.check(wS,n,s);function n(o){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,ui(e,t,"listItemIndent",i.containerState.size+1)(o)}function s(o){return i.containerState.furtherBlankLines||!$r(o)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,a(o)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(Ovt,t,a)(o))}function a(o){return i.containerState._closeFlow=!0,i.interrupt=void 0,ui(e,e.attempt(bo,t,r),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function zvt(e,t,r){const i=this;return ui(e,n,"listItemIndent",i.containerState.size+1);function n(s){const a=i.events[i.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===i.containerState.size?t(s):r(s)}}function Bvt(e){e.exit(this.containerState.type)}function Fvt(e,t,r){const i=this;return ui(e,n,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function n(s){const a=i.events[i.events.length-1];return!$r(s)&&a&&a[1].type==="listItemPrefixWhitespace"?t(s):r(s)}}const dte={name:"setextUnderline",resolveTo:Vvt,tokenize:Uvt};function Vvt(e,t){let r=e.length,i,n,s;for(;r--;)if(e[r][0]==="enter"){if(e[r][1].type==="content"){i=r;break}e[r][1].type==="paragraph"&&(n=r)}else e[r][1].type==="content"&&e.splice(r,1),!s&&e[r][1].type==="definition"&&(s=r);const a={type:"setextHeading",start:{...e[i][1].start},end:{...e[e.length-1][1].end}};return e[n][1].type="setextHeadingText",s?(e.splice(n,0,["enter",a,t]),e.splice(s+1,0,["exit",e[i][1],t]),e[i][1].end={...e[s][1].end}):e[i][1]=a,e.push(["exit",a,t]),e}function Uvt(e,t,r){const i=this;let n;return s;function s(c){let u=i.events.length,d;for(;u--;)if(i.events[u][1].type!=="lineEnding"&&i.events[u][1].type!=="linePrefix"&&i.events[u][1].type!=="content"){d=i.events[u][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||d)?(e.enter("setextHeadingLine"),n=c,a(c)):r(c)}function a(c){return e.enter("setextHeadingLineSequence"),o(c)}function o(c){return c===n?(e.consume(c),o):(e.exit("setextHeadingLineSequence"),$r(c)?ui(e,l,"lineSuffix")(c):l(c))}function l(c){return c===null||or(c)?(e.exit("setextHeadingLine"),t(c)):r(c)}}const Hvt={tokenize:Gvt};function Gvt(e){const t=this,r=e.attempt(wS,i,e.attempt(this.parser.constructs.flowInitial,n,ui(e,e.attempt(this.parser.constructs.flow,n,e.attempt($0t,n)),"linePrefix")));return r;function i(s){if(s===null){e.consume(s);return}return e.enter("lineEndingBlank"),e.consume(s),e.exit("lineEndingBlank"),t.currentConstruct=void 0,r}function n(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),t.currentConstruct=void 0,r}}const Wvt={resolveAll:kge()},qvt=Nge("string"),Yvt=Nge("text");function Nge(e){return{resolveAll:kge(e==="text"?Xvt:void 0),tokenize:t};function t(r){const i=this,n=this.parser.constructs[e],s=r.attempt(n,a,o);return a;function a(u){return c(u)?s(u):o(u)}function o(u){if(u===null){r.consume(u);return}return r.enter("data"),r.consume(u),l}function l(u){return c(u)?(r.exit("data"),s(u)):(r.consume(u),l)}function c(u){if(u===null)return!0;const d=n[u];let f=-1;if(d)for(;++f<d.length;){const m=d[f];if(!m.previous||m.previous.call(i,i.previous))return!0}return!1}}}function kge(e){return t;function t(r,i){let n=-1,s;for(;++n<=r.length;)s===void 0?r[n]&&r[n][1].type==="data"&&(s=n,n++):(!r[n]||r[n][1].type!=="data")&&(n!==s+2&&(r[s][1].end=r[n-1][1].end,r.splice(s+2,n-s-2),n=s+2),s=void 0);return e?e(r,i):r}}function Xvt(e,t){let r=0;for(;++r<=e.length;)if((r===e.length||e[r][1].type==="lineEnding")&&e[r-1][1].type==="data"){const i=e[r-1][1],n=t.sliceStream(i);let s=n.length,a=-1,o=0,l;for(;s--;){const c=n[s];if(typeof c=="string"){for(a=c.length;c.charCodeAt(a-1)===32;)o++,a--;if(a)break;a=-1}else if(c===-2)l=!0,o++;else if(c!==-1){s++;break}}if(t._contentTypeTextTrailing&&r===e.length&&(o=0),o){const c={type:r===e.length||l||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?a:i.start._bufferIndex+a,_index:i.start._index+s,line:i.end.line,column:i.end.column-o,offset:i.end.offset-o},end:{...i.end}};i.end={...c.start},i.start.offset===i.end.offset?Object.assign(i,c):(e.splice(r,0,["enter",c,t],["exit",c,t]),r+=2)}r++}return e}const $vt={42:bo,43:bo,45:bo,48:bo,49:bo,50:bo,51:bo,52:bo,53:bo,54:bo,55:bo,56:bo,57:bo,62:Ege},Kvt={91:evt},Qvt={[-2]:GO,[-1]:GO,32:GO},Zvt={35:avt,42:GT,45:[dte,GT],60:uvt,61:dte,95:GT,96:cte,126:cte},Jvt={38:Cge,92:Age},eyt={[-5]:WO,[-4]:WO,[-3]:WO,33:Mvt,38:Cge,42:f6,60:[D0t,vvt],91:Dvt,92:[nvt,Age],93:zU,95:f6,96:H0t},tyt={null:[f6,Wvt]},ryt={null:[42,95]},iyt={null:[]},nyt=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:ryt,contentInitial:Kvt,disable:iyt,document:$vt,flow:Zvt,flowInitial:Qvt,insideSpan:tyt,string:Jvt,text:eyt},Symbol.toStringTag,{value:"Module"}));function syt(e,t,r){let i={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const n={},s=[];let a=[],o=[];const l={attempt:T(M),check:T(C),consume:_,enter:S,exit:P,interrupt:T(C,{interrupt:!0})},c={code:null,containerState:{},defineSkip:y,events:[],now:v,parser:e,previous:null,sliceSerialize:f,sliceStream:m,write:d};let u=t.tokenize.call(c,l);return t.resolveAll&&s.push(t),c;function d(I){return a=Ll(a,I),x(),a[a.length-1]!==null?[]:(E(t,0),c.events=cN(s,c.events,c),c.events)}function f(I,j){return oyt(m(I),j)}function m(I){return ayt(a,I)}function v(){const{_bufferIndex:I,_index:j,line:L,column:B,offset:q}=i;return{_bufferIndex:I,_index:j,line:L,column:B,offset:q}}function y(I){n[I.line]=I.column,D()}function x(){let I;for(;i._index<a.length;){const j=a[i._index];if(typeof j=="string")for(I=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===I&&i._bufferIndex<j.length;)w(j.charCodeAt(i._bufferIndex));else w(j)}}function w(I){u=u(I)}function _(I){or(I)?(i.line++,i.column=1,i.offset+=I===-3?2:1,D()):I!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===a[i._index].length&&(i._bufferIndex=-1,i._index++)),c.previous=I}function S(I,j){const L=j||{};return L.type=I,L.start=v(),c.events.push(["enter",L,c]),o.push(L),L}function P(I){const j=o.pop();return j.end=v(),c.events.push(["exit",j,c]),j}function M(I,j){E(I,j.from)}function C(I,j){j.restore()}function T(I,j){return L;function L(B,q,G){let Y,X,re,F;return Array.isArray(B)?se(B):"tokenize"in B?se([B]):$(B);function $(ie){return ae;function ae(Z){const fe=Z!==null&&ie[Z],he=Z!==null&&ie.null,Ae=[...Array.isArray(fe)?fe:fe?[fe]:[],...Array.isArray(he)?he:he?[he]:[]];return se(Ae)(Z)}}function se(ie){return Y=ie,X=0,ie.length===0?G:H(ie[X])}function H(ie){return ae;function ae(Z){return F=N(),re=ie,ie.partial||(c.currentConstruct=ie),ie.name&&c.parser.constructs.disable.null.includes(ie.name)?ce():ie.tokenize.call(j?Object.assign(Object.create(c),j):c,l,ne,ce)(Z)}}function ne(ie){return I(re,F),q}function ce(ie){return F.restore(),++X<Y.length?H(Y[X]):G}}}function E(I,j){I.resolveAll&&!s.includes(I)&&s.push(I),I.resolve&&ol(c.events,j,c.events.length-j,I.resolve(c.events.slice(j),c)),I.resolveTo&&(c.events=I.resolveTo(c.events,c))}function N(){const I=v(),j=c.previous,L=c.currentConstruct,B=c.events.length,q=Array.from(o);return{from:B,restore:G};function G(){i=I,c.previous=j,c.currentConstruct=L,c.events.length=B,o=q,D()}}function D(){i.line in n&&i.column<2&&(i.column=n[i.line],i.offset+=n[i.line]-1)}}function ayt(e,t){const r=t.start._index,i=t.start._bufferIndex,n=t.end._index,s=t.end._bufferIndex;let a;if(r===n)a=[e[r].slice(i,s)];else{if(a=e.slice(r,n),i>-1){const o=a[0];typeof o=="string"?a[0]=o.slice(i):a.shift()}s>0&&a.push(e[n].slice(0,s))}return a}function oyt(e,t){let r=-1;const i=[];let n;for(;++r<e.length;){const s=e[r];let a;if(typeof s=="string")a=s;else switch(s){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=t?" ":"	";break}case-1:{if(!t&&n)continue;a=" ";break}default:a=String.fromCharCode(s)}n=s===-2,i.push(a)}return i.join("")}function lyt(e){const i={constructs:_ge([nyt,...(e||{}).extensions||[]]),content:n(S0t),defined:[],document:n(A0t),flow:n(Hvt),lazy:{},string:n(qvt),text:n(Yvt)};return i;function n(s){return a;function a(o){return syt(i,s,o)}}}function cyt(e){for(;!Tge(e););return e}const hte=/[\0\t\n\r]/g;function uyt(){let e=1,t="",r=!0,i;return n;function n(s,a,o){const l=[];let c,u,d,f,m;for(s=t+(typeof s=="string"?s.toString():new TextDecoder(a||void 0).decode(s)),d=0,t="",r&&(s.charCodeAt(0)===65279&&d++,r=void 0);d<s.length;){if(hte.lastIndex=d,c=hte.exec(s),f=c&&c.index!==void 0?c.index:s.length,m=s.charCodeAt(f),!c){t=s.slice(d);break}if(m===10&&d===f&&i)l.push(-3),i=void 0;else switch(i&&(l.push(-5),i=void 0),d<f&&(l.push(s.slice(d,f)),e+=f-d),m){case 0:{l.push(65533),e++;break}case 9:{for(u=Math.ceil(e/4)*4,l.push(-2);e++<u;)l.push(-1);break}case 10:{l.push(-4),e=1;break}default:i=!0,e=1}d=f+1}return o&&(i&&l.push(-5),t&&l.push(t),l.push(null)),l}}const dyt=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function hyt(e){return e.replace(dyt,fyt)}function fyt(e,t,r){if(t)return t;if(r.charCodeAt(0)===35){const n=r.charCodeAt(1),s=n===120||n===88;return Sge(r.slice(s?2:1),s?16:10)}return LU(r)||e}const Rge={}.hasOwnProperty;function pyt(e,t,r){return typeof t!="string"&&(r=t,t=void 0),myt(r)(cyt(lyt(r).document().write(uyt()(e,t,!0))))}function myt(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(ut),autolinkProtocol:N,autolinkEmail:N,atxHeading:s($e),blockQuote:s(he),characterEscape:N,characterReference:N,codeFenced:s(Ae),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:s(Ae,a),codeText:s(xe,a),codeTextData:N,data:N,codeFlowValue:N,definition:s(Ee),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:s(Be),hardBreakEscape:s(mt),hardBreakTrailing:s(mt),htmlFlow:s(dt,a),htmlFlowData:N,htmlText:s(dt,a),htmlTextData:N,image:s(ct),label:a,link:s(ut),listItem:s(_e),listItemValue:f,listOrdered:s(me,d),listUnordered:s(me),paragraph:s(te),reference:H,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:s($e),strong:s(J),thematicBreak:s(Me)},exit:{atxHeading:l(),atxHeadingSequence:M,autolink:l(),autolinkEmail:fe,autolinkProtocol:Z,blockQuote:l(),characterEscapeValue:D,characterReferenceMarkerHexadecimal:ce,characterReferenceMarkerNumeric:ce,characterReferenceValue:ie,characterReference:ae,codeFenced:l(x),codeFencedFence:y,codeFencedFenceInfo:m,codeFencedFenceMeta:v,codeFlowValue:D,codeIndented:l(w),codeText:l(q),codeTextData:D,data:D,definition:l(),definitionDestinationString:P,definitionLabelString:_,definitionTitleString:S,emphasis:l(),hardBreakEscape:l(j),hardBreakTrailing:l(j),htmlFlow:l(L),htmlFlowData:D,htmlText:l(B),htmlTextData:D,image:l(Y),label:re,labelText:X,lineEnding:I,link:l(G),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:ne,resourceDestinationString:F,resourceTitleString:$,resource:se,setextHeading:l(E),setextHeadingLineSequence:T,setextHeadingText:C,strong:l(),thematicBreak:l()}};Ige(t,(e||{}).mdastExtensions||[]);const r={};return i;function i(W){let Se={type:"root",children:[]};const ze={stack:[Se],tokenStack:[],config:t,enter:o,exit:c,buffer:a,resume:u,data:r},Ue=[];let Ne=-1;for(;++Ne<W.length;)if(W[Ne][1].type==="listOrdered"||W[Ne][1].type==="listUnordered")if(W[Ne][0]==="enter")Ue.push(Ne);else{const De=Ue.pop();Ne=n(W,De,Ne)}for(Ne=-1;++Ne<W.length;){const De=t[W[Ne][0]];Rge.call(De,W[Ne][1].type)&&De[W[Ne][1].type].call(Object.assign({sliceSerialize:W[Ne][2].sliceSerialize},ze),W[Ne][1])}if(ze.tokenStack.length>0){const De=ze.tokenStack[ze.tokenStack.length-1];(De[1]||fte).call(ze,void 0,De[0])}for(Se.position={start:Hf(W.length>0?W[0][1].start:{line:1,column:1,offset:0}),end:Hf(W.length>0?W[W.length-2][1].end:{line:1,column:1,offset:0})},Ne=-1;++Ne<t.transforms.length;)Se=t.transforms[Ne](Se)||Se;return Se}function n(W,Se,ze){let Ue=Se-1,Ne=-1,De=!1,We,Je,et,qe;for(;++Ue<=ze;){const ft=W[Ue];switch(ft[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{ft[0]==="enter"?Ne++:Ne--,qe=void 0;break}case"lineEndingBlank":{ft[0]==="enter"&&(We&&!qe&&!Ne&&!et&&(et=Ue),qe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:qe=void 0}if(!Ne&&ft[0]==="enter"&&ft[1].type==="listItemPrefix"||Ne===-1&&ft[0]==="exit"&&(ft[1].type==="listUnordered"||ft[1].type==="listOrdered")){if(We){let kt=Ue;for(Je=void 0;kt--;){const Mt=W[kt];if(Mt[1].type==="lineEnding"||Mt[1].type==="lineEndingBlank"){if(Mt[0]==="exit")continue;Je&&(W[Je][1].type="lineEndingBlank",De=!0),Mt[1].type="lineEnding",Je=kt}else if(!(Mt[1].type==="linePrefix"||Mt[1].type==="blockQuotePrefix"||Mt[1].type==="blockQuotePrefixWhitespace"||Mt[1].type==="blockQuoteMarker"||Mt[1].type==="listItemIndent"))break}et&&(!Je||et<Je)&&(We._spread=!0),We.end=Object.assign({},Je?W[Je][1].start:ft[1].end),W.splice(Je||Ue,0,["exit",We,ft[2]]),Ue++,ze++}if(ft[1].type==="listItemPrefix"){const kt={type:"listItem",_spread:!1,start:Object.assign({},ft[1].start),end:void 0};We=kt,W.splice(Ue,0,["enter",kt,ft[2]]),Ue++,ze++,et=void 0,qe=!0}}}return W[Se][1]._spread=De,ze}function s(W,Se){return ze;function ze(Ue){o.call(this,W(Ue),Ue),Se&&Se.call(this,Ue)}}function a(){this.stack.push({type:"fragment",children:[]})}function o(W,Se,ze){this.stack[this.stack.length-1].children.push(W),this.stack.push(W),this.tokenStack.push([Se,ze||void 0]),W.position={start:Hf(Se.start),end:void 0}}function l(W){return Se;function Se(ze){W&&W.call(this,ze),c.call(this,ze)}}function c(W,Se){const ze=this.stack.pop(),Ue=this.tokenStack.pop();if(Ue)Ue[0].type!==W.type&&(Se?Se.call(this,W,Ue[0]):(Ue[1]||fte).call(this,W,Ue[0]));else throw new Error("Cannot close `"+W.type+"` ("+x2({start:W.start,end:W.end})+"): it’s not open");ze.position.end=Hf(W.end)}function u(){return jU(this.stack.pop())}function d(){this.data.expectingFirstListItemValue=!0}function f(W){if(this.data.expectingFirstListItemValue){const Se=this.stack[this.stack.length-2];Se.start=Number.parseInt(this.sliceSerialize(W),10),this.data.expectingFirstListItemValue=void 0}}function m(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.lang=W}function v(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.meta=W}function y(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function x(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.value=W.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function w(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.value=W.replace(/(\r?\n|\r)$/g,"")}function _(W){const Se=this.resume(),ze=this.stack[this.stack.length-1];ze.label=Se,ze.identifier=jc(this.sliceSerialize(W)).toLowerCase()}function S(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.title=W}function P(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.url=W}function M(W){const Se=this.stack[this.stack.length-1];if(!Se.depth){const ze=this.sliceSerialize(W).length;Se.depth=ze}}function C(){this.data.setextHeadingSlurpLineEnding=!0}function T(W){const Se=this.stack[this.stack.length-1];Se.depth=this.sliceSerialize(W).codePointAt(0)===61?1:2}function E(){this.data.setextHeadingSlurpLineEnding=void 0}function N(W){const ze=this.stack[this.stack.length-1].children;let Ue=ze[ze.length-1];(!Ue||Ue.type!=="text")&&(Ue=ve(),Ue.position={start:Hf(W.start),end:void 0},ze.push(Ue)),this.stack.push(Ue)}function D(W){const Se=this.stack.pop();Se.value+=this.sliceSerialize(W),Se.position.end=Hf(W.end)}function I(W){const Se=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ze=Se.children[Se.children.length-1];ze.position.end=Hf(W.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(Se.type)&&(N.call(this,W),D.call(this,W))}function j(){this.data.atHardBreak=!0}function L(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.value=W}function B(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.value=W}function q(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.value=W}function G(){const W=this.stack[this.stack.length-1];if(this.data.inReference){const Se=this.data.referenceType||"shortcut";W.type+="Reference",W.referenceType=Se,delete W.url,delete W.title}else delete W.identifier,delete W.label;this.data.referenceType=void 0}function Y(){const W=this.stack[this.stack.length-1];if(this.data.inReference){const Se=this.data.referenceType||"shortcut";W.type+="Reference",W.referenceType=Se,delete W.url,delete W.title}else delete W.identifier,delete W.label;this.data.referenceType=void 0}function X(W){const Se=this.sliceSerialize(W),ze=this.stack[this.stack.length-2];ze.label=hyt(Se),ze.identifier=jc(Se).toLowerCase()}function re(){const W=this.stack[this.stack.length-1],Se=this.resume(),ze=this.stack[this.stack.length-1];if(this.data.inReference=!0,ze.type==="link"){const Ue=W.children;ze.children=Ue}else ze.alt=Se}function F(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.url=W}function $(){const W=this.resume(),Se=this.stack[this.stack.length-1];Se.title=W}function se(){this.data.inReference=void 0}function H(){this.data.referenceType="collapsed"}function ne(W){const Se=this.resume(),ze=this.stack[this.stack.length-1];ze.label=Se,ze.identifier=jc(this.sliceSerialize(W)).toLowerCase(),this.data.referenceType="full"}function ce(W){this.data.characterReferenceType=W.type}function ie(W){const Se=this.sliceSerialize(W),ze=this.data.characterReferenceType;let Ue;ze?(Ue=Sge(Se,ze==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ue=LU(Se);const Ne=this.stack[this.stack.length-1];Ne.value+=Ue}function ae(W){const Se=this.stack.pop();Se.position.end=Hf(W.end)}function Z(W){D.call(this,W);const Se=this.stack[this.stack.length-1];Se.url=this.sliceSerialize(W)}function fe(W){D.call(this,W);const Se=this.stack[this.stack.length-1];Se.url="mailto:"+this.sliceSerialize(W)}function he(){return{type:"blockquote",children:[]}}function Ae(){return{type:"code",lang:null,meta:null,value:""}}function xe(){return{type:"inlineCode",value:""}}function Ee(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Be(){return{type:"emphasis",children:[]}}function $e(){return{type:"heading",depth:0,children:[]}}function mt(){return{type:"break"}}function dt(){return{type:"html",value:""}}function ct(){return{type:"image",title:null,url:"",alt:null}}function ut(){return{type:"link",title:null,url:"",children:[]}}function me(W){return{type:"list",ordered:W.type==="listOrdered",start:null,spread:W._spread,children:[]}}function _e(W){return{type:"listItem",spread:W._spread,checked:null,children:[]}}function te(){return{type:"paragraph",children:[]}}function J(){return{type:"strong",children:[]}}function ve(){return{type:"text",value:""}}function Me(){return{type:"thematicBreak"}}}function Hf(e){return{line:e.line,column:e.column,offset:e.offset}}function Ige(e,t){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?Ige(e,i):gyt(e,i)}}function gyt(e,t){let r;for(r in t)if(Rge.call(t,r))switch(r){case"canContainEols":{const i=t[r];i&&e[r].push(...i);break}case"transforms":{const i=t[r];i&&e[r].push(...i);break}case"enter":case"exit":{const i=t[r];i&&Object.assign(e[r],i);break}}}function fte(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+x2({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+x2({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+x2({start:t.start,end:t.end})+") is still open")}function vyt(e){const t=this;t.parser=r;function r(i){return pyt(i,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function yyt(e,t){const r={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,r),e.applyData(t,r)}function xyt(e,t){const r={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,r),[e.applyData(t,r),{type:"text",value:`
`}]}function byt(e,t){const r=t.value?t.value+`
`:"",i={};t.lang&&(i.className=["language-"+t.lang]);let n={type:"element",tagName:"code",properties:i,children:[{type:"text",value:r}]};return t.meta&&(n.data={meta:t.meta}),e.patch(t,n),n=e.applyData(t,n),n={type:"element",tagName:"pre",properties:{},children:[n]},e.patch(t,n),n}function wyt(e,t){const r={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function _yt(e,t){const r={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function Syt(e,t){const r=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",i=String(t.identifier).toUpperCase(),n=Cb(i.toLowerCase()),s=e.footnoteOrder.indexOf(i);let a,o=e.footnoteCounts.get(i);o===void 0?(o=0,e.footnoteOrder.push(i),a=e.footnoteOrder.length):a=s+1,o+=1,e.footnoteCounts.set(i,o);const l={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+n,id:r+"fnref-"+n+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};e.patch(t,l);const c={type:"element",tagName:"sup",properties:{},children:[l]};return e.patch(t,c),e.applyData(t,c)}function Eyt(e,t){const r={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function Ayt(e,t){if(e.options.allowDangerousHtml){const r={type:"raw",value:t.value};return e.patch(t,r),e.applyData(t,r)}}function Oge(e,t){const r=t.referenceType;let i="]";if(r==="collapsed"?i+="[]":r==="full"&&(i+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+i}];const n=e.all(t),s=n[0];s&&s.type==="text"?s.value="["+s.value:n.unshift({type:"text",value:"["});const a=n[n.length-1];return a&&a.type==="text"?a.value+=i:n.push({type:"text",value:i}),n}function Cyt(e,t){const r=String(t.identifier).toUpperCase(),i=e.definitionById.get(r);if(!i)return Oge(e,t);const n={src:Cb(i.url||""),alt:t.alt};i.title!==null&&i.title!==void 0&&(n.title=i.title);const s={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,s),e.applyData(t,s)}function Tyt(e,t){const r={src:Cb(t.url)};t.alt!==null&&t.alt!==void 0&&(r.alt=t.alt),t.title!==null&&t.title!==void 0&&(r.title=t.title);const i={type:"element",tagName:"img",properties:r,children:[]};return e.patch(t,i),e.applyData(t,i)}function Myt(e,t){const r={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,r);const i={type:"element",tagName:"code",properties:{},children:[r]};return e.patch(t,i),e.applyData(t,i)}function Pyt(e,t){const r=String(t.identifier).toUpperCase(),i=e.definitionById.get(r);if(!i)return Oge(e,t);const n={href:Cb(i.url||"")};i.title!==null&&i.title!==void 0&&(n.title=i.title);const s={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,s),e.applyData(t,s)}function Dyt(e,t){const r={href:Cb(t.url)};t.title!==null&&t.title!==void 0&&(r.title=t.title);const i={type:"element",tagName:"a",properties:r,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function Nyt(e,t,r){const i=e.all(t),n=r?kyt(r):jge(t),s={},a=[];if(typeof t.checked=="boolean"){const u=i[0];let d;u&&u.type==="element"&&u.tagName==="p"?d=u:(d={type:"element",tagName:"p",properties:{},children:[]},i.unshift(d)),d.children.length>0&&d.children.unshift({type:"text",value:" "}),d.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let o=-1;for(;++o<i.length;){const u=i[o];(n||o!==0||u.type!=="element"||u.tagName!=="p")&&a.push({type:"text",value:`
`}),u.type==="element"&&u.tagName==="p"&&!n?a.push(...u.children):a.push(u)}const l=i[i.length-1];l&&(n||l.type!=="element"||l.tagName!=="p")&&a.push({type:"text",value:`
`});const c={type:"element",tagName:"li",properties:s,children:a};return e.patch(t,c),e.applyData(t,c)}function kyt(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const r=e.children;let i=-1;for(;!t&&++i<r.length;)t=jge(r[i])}return t}function jge(e){const t=e.spread;return t??e.children.length>1}function Ryt(e,t){const r={},i=e.all(t);let n=-1;for(typeof t.start=="number"&&t.start!==1&&(r.start=t.start);++n<i.length;){const a=i[n];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const s={type:"element",tagName:t.ordered?"ol":"ul",properties:r,children:e.wrap(i,!0)};return e.patch(t,s),e.applyData(t,s)}function Iyt(e,t){const r={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function Oyt(e,t){const r={type:"root",children:e.wrap(e.all(t))};return e.patch(t,r),e.applyData(t,r)}function jyt(e,t){const r={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function Lyt(e,t){const r=e.all(t),i=r.shift(),n=[];if(i){const a={type:"element",tagName:"thead",properties:{},children:e.wrap([i],!0)};e.patch(t.children[0],a),n.push(a)}if(r.length>0){const a={type:"element",tagName:"tbody",properties:{},children:e.wrap(r,!0)},o=kU(t.children[1]),l=mge(t.children[t.children.length-1]);o&&l&&(a.position={start:o,end:l}),n.push(a)}const s={type:"element",tagName:"table",properties:{},children:e.wrap(n,!0)};return e.patch(t,s),e.applyData(t,s)}function zyt(e,t,r){const i=r?r.children:void 0,s=(i?i.indexOf(t):1)===0?"th":"td",a=r&&r.type==="table"?r.align:void 0,o=a?a.length:t.children.length;let l=-1;const c=[];for(;++l<o;){const d=t.children[l],f={},m=a?a[l]:void 0;m&&(f.align=m);let v={type:"element",tagName:s,properties:f,children:[]};d&&(v.children=e.all(d),e.patch(d,v),v=e.applyData(d,v)),c.push(v)}const u={type:"element",tagName:"tr",properties:{},children:e.wrap(c,!0)};return e.patch(t,u),e.applyData(t,u)}function Byt(e,t){const r={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}const pte=9,mte=32;function Fyt(e){const t=String(e),r=/\r?\n|\r/g;let i=r.exec(t),n=0;const s=[];for(;i;)s.push(gte(t.slice(n,i.index),n>0,!0),i[0]),n=i.index+i[0].length,i=r.exec(t);return s.push(gte(t.slice(n),n>0,!1)),s.join("")}function gte(e,t,r){let i=0,n=e.length;if(t){let s=e.codePointAt(i);for(;s===pte||s===mte;)i++,s=e.codePointAt(i)}if(r){let s=e.codePointAt(n-1);for(;s===pte||s===mte;)n--,s=e.codePointAt(n-1)}return n>i?e.slice(i,n):""}function Vyt(e,t){const r={type:"text",value:Fyt(String(t.value))};return e.patch(t,r),e.applyData(t,r)}function Uyt(e,t){const r={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,r),e.applyData(t,r)}const Hyt={blockquote:yyt,break:xyt,code:byt,delete:wyt,emphasis:_yt,footnoteReference:Syt,heading:Eyt,html:Ayt,imageReference:Cyt,image:Tyt,inlineCode:Myt,linkReference:Pyt,link:Dyt,listItem:Nyt,list:Ryt,paragraph:Iyt,root:Oyt,strong:jyt,table:Lyt,tableCell:Byt,tableRow:zyt,text:Vyt,thematicBreak:Uyt,toml:FC,yaml:FC,definition:FC,footnoteDefinition:FC};function FC(){}const Lge=-1,uN=0,w2=1,o3=2,BU=3,FU=4,VU=5,UU=6,zge=7,Bge=8,vte=typeof self=="object"?self:globalThis,Gyt=(e,t)=>{const r=(n,s)=>(e.set(s,n),n),i=n=>{if(e.has(n))return e.get(n);const[s,a]=t[n];switch(s){case uN:case Lge:return r(a,n);case w2:{const o=r([],n);for(const l of a)o.push(i(l));return o}case o3:{const o=r({},n);for(const[l,c]of a)o[i(l)]=i(c);return o}case BU:return r(new Date(a),n);case FU:{const{source:o,flags:l}=a;return r(new RegExp(o,l),n)}case VU:{const o=r(new Map,n);for(const[l,c]of a)o.set(i(l),i(c));return o}case UU:{const o=r(new Set,n);for(const l of a)o.add(i(l));return o}case zge:{const{name:o,message:l}=a;return r(new vte[o](l),n)}case Bge:return r(BigInt(a),n);case"BigInt":return r(Object(BigInt(a)),n);case"ArrayBuffer":return r(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:o}=new Uint8Array(a);return r(new DataView(o),a)}}return r(new vte[s](a),n)};return i},yte=e=>Gyt(new Map,e)(0),Qv="",{toString:Wyt}={},{keys:qyt}=Object,uw=e=>{const t=typeof e;if(t!=="object"||!e)return[uN,t];const r=Wyt.call(e).slice(8,-1);switch(r){case"Array":return[w2,Qv];case"Object":return[o3,Qv];case"Date":return[BU,Qv];case"RegExp":return[FU,Qv];case"Map":return[VU,Qv];case"Set":return[UU,Qv];case"DataView":return[w2,r]}return r.includes("Array")?[w2,r]:r.includes("Error")?[zge,r]:[o3,r]},VC=([e,t])=>e===uN&&(t==="function"||t==="symbol"),Yyt=(e,t,r,i)=>{const n=(a,o)=>{const l=i.push(a)-1;return r.set(o,l),l},s=a=>{if(r.has(a))return r.get(a);let[o,l]=uw(a);switch(o){case uN:{let u=a;switch(l){case"bigint":o=Bge,u=a.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+l);u=null;break;case"undefined":return n([Lge],a)}return n([o,u],a)}case w2:{if(l){let f=a;return l==="DataView"?f=new Uint8Array(a.buffer):l==="ArrayBuffer"&&(f=new Uint8Array(a)),n([l,[...f]],a)}const u=[],d=n([o,u],a);for(const f of a)u.push(s(f));return d}case o3:{if(l)switch(l){case"BigInt":return n([l,a.toString()],a);case"Boolean":case"Number":case"String":return n([l,a.valueOf()],a)}if(t&&"toJSON"in a)return s(a.toJSON());const u=[],d=n([o,u],a);for(const f of qyt(a))(e||!VC(uw(a[f])))&&u.push([s(f),s(a[f])]);return d}case BU:return n([o,a.toISOString()],a);case FU:{const{source:u,flags:d}=a;return n([o,{source:u,flags:d}],a)}case VU:{const u=[],d=n([o,u],a);for(const[f,m]of a)(e||!(VC(uw(f))||VC(uw(m))))&&u.push([s(f),s(m)]);return d}case UU:{const u=[],d=n([o,u],a);for(const f of a)(e||!VC(uw(f)))&&u.push(s(f));return d}}const{message:c}=a;return n([o,{name:l,message:c}],a)};return s},xte=(e,{json:t,lossy:r}={})=>{const i=[];return Yyt(!(t||r),!!t,new Map,i)(e),i},l3=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?yte(xte(e,t)):structuredClone(e):(e,t)=>yte(xte(e,t));function Xyt(e,t){const r=[{type:"text",value:"↩"}];return t>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),r}function $yt(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function Kyt(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=e.options.footnoteBackContent||Xyt,i=e.options.footnoteBackLabel||$yt,n=e.options.footnoteLabel||"Footnotes",s=e.options.footnoteLabelTagName||"h2",a=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let l=-1;for(;++l<e.footnoteOrder.length;){const c=e.footnoteById.get(e.footnoteOrder[l]);if(!c)continue;const u=e.all(c),d=String(c.identifier).toUpperCase(),f=Cb(d.toLowerCase());let m=0;const v=[],y=e.footnoteCounts.get(d);for(;y!==void 0&&++m<=y;){v.length>0&&v.push({type:"text",value:" "});let _=typeof r=="string"?r:r(l,m);typeof _=="string"&&(_={type:"text",value:_}),v.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+f+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(l,m),className:["data-footnote-backref"]},children:Array.isArray(_)?_:[_]})}const x=u[u.length-1];if(x&&x.type==="element"&&x.tagName==="p"){const _=x.children[x.children.length-1];_&&_.type==="text"?_.value+=" ":x.children.push({type:"text",value:" "}),x.children.push(...v)}else u.push(...v);const w={type:"element",tagName:"li",properties:{id:t+"fn-"+f},children:e.wrap(u,!0)};e.patch(c,w),o.push(w)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...l3(a),id:"footnote-label"},children:[{type:"text",value:n}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const dN=function(e){if(e==null)return ext;if(typeof e=="function")return hN(e);if(typeof e=="object")return Array.isArray(e)?Qyt(e):Zyt(e);if(typeof e=="string")return Jyt(e);throw new Error("Expected function, string, or object as test")};function Qyt(e){const t=[];let r=-1;for(;++r<e.length;)t[r]=dN(e[r]);return hN(i);function i(...n){let s=-1;for(;++s<t.length;)if(t[s].apply(this,n))return!0;return!1}}function Zyt(e){const t=e;return hN(r);function r(i){const n=i;let s;for(s in e)if(n[s]!==t[s])return!1;return!0}}function Jyt(e){return hN(t);function t(r){return r&&r.type===e}}function hN(e){return t;function t(r,i,n){return!!(txt(r)&&e.call(this,r,typeof i=="number"?i:void 0,n||void 0))}}function ext(){return!0}function txt(e){return e!==null&&typeof e=="object"&&"type"in e}const Fge=[],rxt=!0,p6=!1,ixt="skip";function Vge(e,t,r,i){let n;typeof t=="function"&&typeof r!="function"?(i=r,r=t):n=t;const s=dN(n),a=i?-1:1;o(e,void 0,[])();function o(l,c,u){const d=l&&typeof l=="object"?l:{};if(typeof d.type=="string"){const m=typeof d.tagName=="string"?d.tagName:typeof d.name=="string"?d.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(l.type+(m?"<"+m+">":""))+")"})}return f;function f(){let m=Fge,v,y,x;if((!t||s(l,c,u[u.length-1]||void 0))&&(m=nxt(r(l,u)),m[0]===p6))return m;if("children"in l&&l.children){const w=l;if(w.children&&m[0]!==ixt)for(y=(i?w.children.length:-1)+a,x=u.concat(w);y>-1&&y<w.children.length;){const _=w.children[y];if(v=o(_,y,x)(),v[0]===p6)return v;y=typeof v[1]=="number"?v[1]:y+a}}return m}}}function nxt(e){return Array.isArray(e)?e:typeof e=="number"?[rxt,e]:e==null?Fge:[e]}function HU(e,t,r,i){let n,s,a;typeof t=="function"&&typeof r!="function"?(s=void 0,a=t,n=r):(s=t,a=r,n=i),Vge(e,s,o,n);function o(l,c){const u=c[c.length-1],d=u?u.children.indexOf(l):void 0;return a(l,d,u)}}const m6={}.hasOwnProperty,sxt={};function axt(e,t){const r=t||sxt,i=new Map,n=new Map,s=new Map,a={...Hyt,...r.handlers},o={all:c,applyData:lxt,definitionById:i,footnoteById:n,footnoteCounts:s,footnoteOrder:[],handlers:a,one:l,options:r,patch:oxt,wrap:uxt};return HU(e,function(u){if(u.type==="definition"||u.type==="footnoteDefinition"){const d=u.type==="definition"?i:n,f=String(u.identifier).toUpperCase();d.has(f)||d.set(f,u)}}),o;function l(u,d){const f=u.type,m=o.handlers[f];if(m6.call(o.handlers,f)&&m)return m(o,u,d);if(o.options.passThrough&&o.options.passThrough.includes(f)){if("children"in u){const{children:y,...x}=u,w=l3(x);return w.children=o.all(u),w}return l3(u)}return(o.options.unknownHandler||cxt)(o,u,d)}function c(u){const d=[];if("children"in u){const f=u.children;let m=-1;for(;++m<f.length;){const v=o.one(f[m],u);if(v){if(m&&f[m-1].type==="break"&&(!Array.isArray(v)&&v.type==="text"&&(v.value=bte(v.value)),!Array.isArray(v)&&v.type==="element")){const y=v.children[0];y&&y.type==="text"&&(y.value=bte(y.value))}Array.isArray(v)?d.push(...v):d.push(v)}}}return d}}function oxt(e,t){e.position&&(t.position=$gt(e))}function lxt(e,t){let r=t;if(e&&e.data){const i=e.data.hName,n=e.data.hChildren,s=e.data.hProperties;if(typeof i=="string")if(r.type==="element")r.tagName=i;else{const a="children"in r?r.children:[r];r={type:"element",tagName:i,properties:{},children:a}}r.type==="element"&&s&&Object.assign(r.properties,l3(s)),"children"in r&&r.children&&n!==null&&n!==void 0&&(r.children=n)}return r}function cxt(e,t){const r=t.data||{},i="value"in t&&!(m6.call(r,"hProperties")||m6.call(r,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function uxt(e,t){const r=[];let i=-1;for(t&&r.push({type:"text",value:`
`});++i<e.length;)i&&r.push({type:"text",value:`
`}),r.push(e[i]);return t&&e.length>0&&r.push({type:"text",value:`
`}),r}function bte(e){let t=0,r=e.charCodeAt(t);for(;r===9||r===32;)t++,r=e.charCodeAt(t);return e.slice(t)}function wte(e,t){const r=axt(e,t),i=r.one(e,void 0),n=Kyt(r),s=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return n&&s.children.push({type:"text",value:`
`},n),s}function dxt(e,t){return e&&"run"in e?async function(r,i){const n=wte(r,{file:i,...t});await e.run(n,i)}:function(r,i){return wte(r,{file:i,...e||t})}}function _te(e){if(e)throw e}var qO,Ste;function hxt(){if(Ste)return qO;Ste=1;var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,r=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=function(c){return typeof Array.isArray=="function"?Array.isArray(c):t.call(c)==="[object Array]"},s=function(c){if(!c||t.call(c)!=="[object Object]")return!1;var u=e.call(c,"constructor"),d=c.constructor&&c.constructor.prototype&&e.call(c.constructor.prototype,"isPrototypeOf");if(c.constructor&&!u&&!d)return!1;var f;for(f in c);return typeof f>"u"||e.call(c,f)},a=function(c,u){r&&u.name==="__proto__"?r(c,u.name,{enumerable:!0,configurable:!0,value:u.newValue,writable:!0}):c[u.name]=u.newValue},o=function(c,u){if(u==="__proto__")if(e.call(c,u)){if(i)return i(c,u).value}else return;return c[u]};return qO=function l(){var c,u,d,f,m,v,y=arguments[0],x=1,w=arguments.length,_=!1;for(typeof y=="boolean"&&(_=y,y=arguments[1]||{},x=2),(y==null||typeof y!="object"&&typeof y!="function")&&(y={});x<w;++x)if(c=arguments[x],c!=null)for(u in c)d=o(y,u),f=o(c,u),y!==f&&(_&&f&&(s(f)||(m=n(f)))?(m?(m=!1,v=d&&n(d)?d:[]):v=d&&s(d)?d:{},a(y,{name:u,newValue:l(_,v,f)})):typeof f<"u"&&a(y,{name:u,newValue:f}));return y},qO}var fxt=hxt();const YO=d0(fxt);function g6(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function pxt(){const e=[],t={run:r,use:i};return t;function r(...n){let s=-1;const a=n.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);o(null,...n);function o(l,...c){const u=e[++s];let d=-1;if(l){a(l);return}for(;++d<n.length;)(c[d]===null||c[d]===void 0)&&(c[d]=n[d]);n=c,u?mxt(u,o)(...c):a(null,...c)}}function i(n){if(typeof n!="function")throw new TypeError("Expected `middelware` to be a function, not "+n);return e.push(n),t}}function mxt(e,t){let r;return i;function i(...a){const o=e.length>a.length;let l;o&&a.push(n);try{l=e.apply(this,a)}catch(c){const u=c;if(o&&r)throw u;return n(u)}o||(l&&l.then&&typeof l.then=="function"?l.then(s,n):l instanceof Error?n(l):s(l))}function n(a,...o){r||(r=!0,t(a,...o))}function s(a){n(null,a)}}const Eu={basename:gxt,dirname:vxt,extname:yxt,join:xxt,sep:"/"};function gxt(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');_S(e);let r=0,i=-1,n=e.length,s;if(t===void 0||t.length===0||t.length>e.length){for(;n--;)if(e.codePointAt(n)===47){if(s){r=n+1;break}}else i<0&&(s=!0,i=n+1);return i<0?"":e.slice(r,i)}if(t===e)return"";let a=-1,o=t.length-1;for(;n--;)if(e.codePointAt(n)===47){if(s){r=n+1;break}}else a<0&&(s=!0,a=n+1),o>-1&&(e.codePointAt(n)===t.codePointAt(o--)?o<0&&(i=n):(o=-1,i=a));return r===i?i=a:i<0&&(i=e.length),e.slice(r,i)}function vxt(e){if(_S(e),e.length===0)return".";let t=-1,r=e.length,i;for(;--r;)if(e.codePointAt(r)===47){if(i){t=r;break}}else i||(i=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function yxt(e){_S(e);let t=e.length,r=-1,i=0,n=-1,s=0,a;for(;t--;){const o=e.codePointAt(t);if(o===47){if(a){i=t+1;break}continue}r<0&&(a=!0,r=t+1),o===46?n<0?n=t:s!==1&&(s=1):n>-1&&(s=-1)}return n<0||r<0||s===0||s===1&&n===r-1&&n===i+1?"":e.slice(n,r)}function xxt(...e){let t=-1,r;for(;++t<e.length;)_S(e[t]),e[t]&&(r=r===void 0?e[t]:r+"/"+e[t]);return r===void 0?".":bxt(r)}function bxt(e){_S(e);const t=e.codePointAt(0)===47;let r=wxt(e,!t);return r.length===0&&!t&&(r="."),r.length>0&&e.codePointAt(e.length-1)===47&&(r+="/"),t?"/"+r:r}function wxt(e,t){let r="",i=0,n=-1,s=0,a=-1,o,l;for(;++a<=e.length;){if(a<e.length)o=e.codePointAt(a);else{if(o===47)break;o=47}if(o===47){if(!(n===a-1||s===1))if(n!==a-1&&s===2){if(r.length<2||i!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(l=r.lastIndexOf("/"),l!==r.length-1){l<0?(r="",i=0):(r=r.slice(0,l),i=r.length-1-r.lastIndexOf("/")),n=a,s=0;continue}}else if(r.length>0){r="",i=0,n=a,s=0;continue}}t&&(r=r.length>0?r+"/..":"..",i=2)}else r.length>0?r+="/"+e.slice(n+1,a):r=e.slice(n+1,a),i=a-n-1;n=a,s=0}else o===46&&s>-1?s++:s=-1}return r}function _S(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const _xt={cwd:Sxt};function Sxt(){return"/"}function v6(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function Ext(e){if(typeof e=="string")e=new URL(e);else if(!v6(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return Axt(e)}function Axt(e){if(e.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const t=e.pathname;let r=-1;for(;++r<t.length;)if(t.codePointAt(r)===37&&t.codePointAt(r+1)===50){const i=t.codePointAt(r+2);if(i===70||i===102){const n=new TypeError("File URL path must not include encoded / characters");throw n.code="ERR_INVALID_FILE_URL_PATH",n}}return decodeURIComponent(t)}const XO=["history","path","basename","stem","extname","dirname"];class Uge{constructor(t){let r;t?v6(t)?r={path:t}:typeof t=="string"||Cxt(t)?r={value:t}:r=t:r={},this.cwd="cwd"in r?"":_xt.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<XO.length;){const s=XO[i];s in r&&r[s]!==void 0&&r[s]!==null&&(this[s]=s==="history"?[...r[s]]:r[s])}let n;for(n in r)XO.includes(n)||(this[n]=r[n])}get basename(){return typeof this.path=="string"?Eu.basename(this.path):void 0}set basename(t){KO(t,"basename"),$O(t,"basename"),this.path=Eu.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Eu.dirname(this.path):void 0}set dirname(t){Ete(this.basename,"dirname"),this.path=Eu.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Eu.extname(this.path):void 0}set extname(t){if($O(t,"extname"),Ete(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Eu.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){v6(t)&&(t=Ext(t)),KO(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Eu.basename(this.path,this.extname):void 0}set stem(t){KO(t,"stem"),$O(t,"stem"),this.path=Eu.join(this.dirname||"",t+(this.extname||""))}fail(t,r,i){const n=this.message(t,r,i);throw n.fatal=!0,n}info(t,r,i){const n=this.message(t,r,i);return n.fatal=void 0,n}message(t,r,i){const n=new Ga(t,r,i);return this.path&&(n.name=this.path+":"+n.name,n.file=this.path),n.fatal=!1,this.messages.push(n),n}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function $O(e,t){if(e&&e.includes(Eu.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Eu.sep+"`")}function KO(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function Ete(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function Cxt(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const Txt=function(e){const i=this.constructor.prototype,n=i[e],s=function(){return n.apply(s,arguments)};return Object.setPrototypeOf(s,i),s},Mxt={}.hasOwnProperty;class GU extends Txt{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=pxt()}copy(){const t=new GU;let r=-1;for(;++r<this.attachers.length;){const i=this.attachers[r];t.use(...i)}return t.data(YO(!0,{},this.namespace)),t}data(t,r){return typeof t=="string"?arguments.length===2?(JO("data",this.frozen),this.namespace[t]=r,this):Mxt.call(this.namespace,t)&&this.namespace[t]||void 0:t?(JO("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const n=r.call(t,...i);typeof n=="function"&&this.transformers.use(n)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const r=UC(t),i=this.parser||this.Parser;return QO("parse",i),i(String(r),r)}process(t,r){const i=this;return this.freeze(),QO("process",this.parser||this.Parser),ZO("process",this.compiler||this.Compiler),r?n(void 0,r):new Promise(n);function n(s,a){const o=UC(t),l=i.parse(o);i.run(l,o,function(u,d,f){if(u||!d||!f)return c(u);const m=d,v=i.stringify(m,f);Nxt(v)?f.value=v:f.result=v,c(u,f)});function c(u,d){u||!d?a(u):s?s(d):r(void 0,d)}}}processSync(t){let r=!1,i;return this.freeze(),QO("processSync",this.parser||this.Parser),ZO("processSync",this.compiler||this.Compiler),this.process(t,n),Cte("processSync","process",r),i;function n(s,a){r=!0,_te(s),i=a}}run(t,r,i){Ate(t),this.freeze();const n=this.transformers;return!i&&typeof r=="function"&&(i=r,r=void 0),i?s(void 0,i):new Promise(s);function s(a,o){const l=UC(r);n.run(t,l,c);function c(u,d,f){const m=d||t;u?o(u):a?a(m):i(void 0,m,f)}}}runSync(t,r){let i=!1,n;return this.run(t,r,s),Cte("runSync","run",i),n;function s(a,o){_te(a),n=o,i=!0}}stringify(t,r){this.freeze();const i=UC(r),n=this.compiler||this.Compiler;return ZO("stringify",n),Ate(t),n(t,i)}use(t,...r){const i=this.attachers,n=this.namespace;if(JO("use",this.frozen),t!=null)if(typeof t=="function")l(t,r);else if(typeof t=="object")Array.isArray(t)?o(t):a(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function s(c){if(typeof c=="function")l(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[u,...d]=c;l(u,d)}else a(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function a(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(c.plugins),c.settings&&(n.settings=YO(!0,n.settings,c.settings))}function o(c){let u=-1;if(c!=null)if(Array.isArray(c))for(;++u<c.length;){const d=c[u];s(d)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function l(c,u){let d=-1,f=-1;for(;++d<i.length;)if(i[d][0]===c){f=d;break}if(f===-1)i.push([c,...u]);else if(u.length>0){let[m,...v]=u;const y=i[f][1];g6(y)&&g6(m)&&(m=YO(!0,y,m)),i[f]=[c,m,...v]}}}}const Pxt=new GU().freeze();function QO(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function ZO(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function JO(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Ate(e){if(!g6(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Cte(e,t,r){if(!r)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function UC(e){return Dxt(e)?e:new Uge(e)}function Dxt(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function Nxt(e){return typeof e=="string"||kxt(e)}function kxt(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const Rxt="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Tte=[],Mte={allowDangerousHtml:!0},Ixt=/^(https?|ircs?|mailto|xmpp)$/i,Oxt=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Hge(e){const t=jxt(e),r=Lxt(e);return zxt(t.runSync(t.parse(r),r),e)}function jxt(e){const t=e.rehypePlugins||Tte,r=e.remarkPlugins||Tte,i=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Mte}:Mte;return Pxt().use(vyt).use(r).use(dxt,i).use(t)}function Lxt(e){const t=e.children||"",r=new Uge;return typeof t=="string"&&(r.value=t),r}function zxt(e,t){const r=t.allowedElements,i=t.allowElement,n=t.components,s=t.disallowedElements,a=t.skipHtml,o=t.unwrapDisallowed,l=t.urlTransform||Bxt;for(const u of Oxt)Object.hasOwn(t,u.from)&&(""+u.from+(u.to?"use `"+u.to+"` instead":"remove it")+Rxt+u.id,void 0);return HU(e,c),e0t(e,{Fragment:h.Fragment,components:n,ignoreInvalidStyle:!0,jsx:h.jsx,jsxs:h.jsxs,passKeys:!0,passNode:!0});function c(u,d,f){if(u.type==="raw"&&f&&typeof d=="number")return a?f.children.splice(d,1):f.children[d]={type:"text",value:u.value},d;if(u.type==="element"){let m;for(m in HO)if(Object.hasOwn(HO,m)&&Object.hasOwn(u.properties,m)){const v=u.properties[m],y=HO[m];(y===null||y.includes(u.tagName))&&(u.properties[m]=l(String(v||""),m,u))}}if(u.type==="element"){let m=r?!r.includes(u.tagName):s?s.includes(u.tagName):!1;if(!m&&i&&typeof d=="number"&&(m=!i(u,d,f)),m&&f&&typeof d=="number")return o&&u.children?f.children.splice(d,1,...u.children):f.children.splice(d,1),d}}}function Bxt(e){const t=e.indexOf(":"),r=e.indexOf("?"),i=e.indexOf("#"),n=e.indexOf("/");return t===-1||n!==-1&&t>n||r!==-1&&t>r||i!==-1&&t>i||Ixt.test(e.slice(0,t))?e:""}function Pte(e,t){const r=String(e);if(typeof t!="string")throw new TypeError("Expected character");let i=0,n=r.indexOf(t);for(;n!==-1;)i++,n=r.indexOf(t,n+t.length);return i}function Fxt(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function Vxt(e,t,r){const n=dN((r||{}).ignore||[]),s=Uxt(t);let a=-1;for(;++a<s.length;)Vge(e,"text",o);function o(c,u){let d=-1,f;for(;++d<u.length;){const m=u[d],v=f?f.children:void 0;if(n(m,v?v.indexOf(m):void 0,f))return;f=m}if(f)return l(c,u)}function l(c,u){const d=u[u.length-1],f=s[a][0],m=s[a][1];let v=0;const x=d.children.indexOf(c);let w=!1,_=[];f.lastIndex=0;let S=f.exec(c.value);for(;S;){const P=S.index,M={index:S.index,input:S.input,stack:[...u,c]};let C=m(...S,M);if(typeof C=="string"&&(C=C.length>0?{type:"text",value:C}:void 0),C===!1?f.lastIndex=P+1:(v!==P&&_.push({type:"text",value:c.value.slice(v,P)}),Array.isArray(C)?_.push(...C):C&&_.push(C),v=P+S[0].length,w=!0),!f.global)break;S=f.exec(c.value)}return w?(v<c.value.length&&_.push({type:"text",value:c.value.slice(v)}),d.children.splice(x,1,..._)):_=[c],x+_.length}}function Uxt(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const r=!e[0]||Array.isArray(e[0])?e:[e];let i=-1;for(;++i<r.length;){const n=r[i];t.push([Hxt(n[0]),Gxt(n[1])])}return t}function Hxt(e){return typeof e=="string"?new RegExp(Fxt(e),"g"):e}function Gxt(e){return typeof e=="function"?e:function(){return e}}const ej="phrasing",tj=["autolink","link","image","label"];function Wxt(){return{transforms:[Zxt],enter:{literalAutolink:Yxt,literalAutolinkEmail:rj,literalAutolinkHttp:rj,literalAutolinkWww:rj},exit:{literalAutolink:Qxt,literalAutolinkEmail:Kxt,literalAutolinkHttp:Xxt,literalAutolinkWww:$xt}}}function qxt(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:ej,notInConstruct:tj},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:ej,notInConstruct:tj},{character:":",before:"[ps]",after:"\\/",inConstruct:ej,notInConstruct:tj}]}}function Yxt(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function rj(e){this.config.enter.autolinkProtocol.call(this,e)}function Xxt(e){this.config.exit.autolinkProtocol.call(this,e)}function $xt(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function Kxt(e){this.config.exit.autolinkEmail.call(this,e)}function Qxt(e){this.exit(e)}function Zxt(e){Vxt(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,Jxt],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),ebt]],{ignore:["link","linkReference"]})}function Jxt(e,t,r,i,n){let s="";if(!Gge(n)||(/^w/i.test(t)&&(r=t+r,t="",s="http://"),!tbt(r)))return!1;const a=rbt(r+i);if(!a[0])return!1;const o={type:"link",title:null,url:s+t+a[0],children:[{type:"text",value:t+a[0]}]};return a[1]?[o,{type:"text",value:a[1]}]:o}function ebt(e,t,r,i){return!Gge(i,!0)||/[-\d_]$/.test(r)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+r,children:[{type:"text",value:t+"@"+r}]}}function tbt(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function rbt(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let r=t[0],i=r.indexOf(")");const n=Pte(e,"(");let s=Pte(e,")");for(;i!==-1&&n>s;)e+=r.slice(0,i+1),r=r.slice(i+1),i=r.indexOf(")"),s++;return[e,r]}function Gge(e,t){const r=e.input.charCodeAt(e.index-1);return(e.index===0||u0(r)||lN(r))&&(!t||r!==47)}Wge.peek=dbt;function ibt(){this.buffer()}function nbt(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function sbt(){this.buffer()}function abt(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function obt(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.identifier=jc(this.sliceSerialize(e)).toLowerCase(),r.label=t}function lbt(e){this.exit(e)}function cbt(e){const t=this.resume(),r=this.stack[this.stack.length-1];r.type,r.identifier=jc(this.sliceSerialize(e)).toLowerCase(),r.label=t}function ubt(e){this.exit(e)}function dbt(){return"["}function Wge(e,t,r,i){const n=r.createTracker(i);let s=n.move("[^");const a=r.enter("footnoteReference"),o=r.enter("reference");return s+=n.move(r.safe(r.associationId(e),{after:"]",before:s})),o(),a(),s+=n.move("]"),s}function hbt(){return{enter:{gfmFootnoteCallString:ibt,gfmFootnoteCall:nbt,gfmFootnoteDefinitionLabelString:sbt,gfmFootnoteDefinition:abt},exit:{gfmFootnoteCallString:obt,gfmFootnoteCall:lbt,gfmFootnoteDefinitionLabelString:cbt,gfmFootnoteDefinition:ubt}}}function fbt(e){let t=!1;return e&&e.firstLineBlank&&(t=!0),{handlers:{footnoteDefinition:r,footnoteReference:Wge},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function r(i,n,s,a){const o=s.createTracker(a);let l=o.move("[^");const c=s.enter("footnoteDefinition"),u=s.enter("label");return l+=o.move(s.safe(s.associationId(i),{before:l,after:"]"})),u(),l+=o.move("]:"),i.children&&i.children.length>0&&(o.shift(4),l+=o.move((t?`
`:" ")+s.indentLines(s.containerFlow(i,o.current()),t?qge:pbt))),c(),l}}function pbt(e,t,r){return t===0?e:qge(e,t,r)}function qge(e,t,r){return(r?"":"    ")+e}const mbt=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];Yge.peek=bbt;function gbt(){return{canContainEols:["delete"],enter:{strikethrough:ybt},exit:{strikethrough:xbt}}}function vbt(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:mbt}],handlers:{delete:Yge}}}function ybt(e){this.enter({type:"delete",children:[]},e)}function xbt(e){this.exit(e)}function Yge(e,t,r,i){const n=r.createTracker(i),s=r.enter("strikethrough");let a=n.move("~~");return a+=r.containerPhrasing(e,{...n.current(),before:a,after:"~"}),a+=n.move("~~"),s(),a}function bbt(){return"~"}function wbt(e){return e.length}function _bt(e,t){const r=t||{},i=(r.align||[]).concat(),n=r.stringLength||wbt,s=[],a=[],o=[],l=[];let c=0,u=-1;for(;++u<e.length;){const y=[],x=[];let w=-1;for(e[u].length>c&&(c=e[u].length);++w<e[u].length;){const _=Sbt(e[u][w]);if(r.alignDelimiters!==!1){const S=n(_);x[w]=S,(l[w]===void 0||S>l[w])&&(l[w]=S)}y.push(_)}a[u]=y,o[u]=x}let d=-1;if(typeof i=="object"&&"length"in i)for(;++d<c;)s[d]=Dte(i[d]);else{const y=Dte(i);for(;++d<c;)s[d]=y}d=-1;const f=[],m=[];for(;++d<c;){const y=s[d];let x="",w="";y===99?(x=":",w=":"):y===108?x=":":y===114&&(w=":");let _=r.alignDelimiters===!1?1:Math.max(1,l[d]-x.length-w.length);const S=x+"-".repeat(_)+w;r.alignDelimiters!==!1&&(_=x.length+_+w.length,_>l[d]&&(l[d]=_),m[d]=_),f[d]=S}a.splice(1,0,f),o.splice(1,0,m),u=-1;const v=[];for(;++u<a.length;){const y=a[u],x=o[u];d=-1;const w=[];for(;++d<c;){const _=y[d]||"";let S="",P="";if(r.alignDelimiters!==!1){const M=l[d]-(x[d]||0),C=s[d];C===114?S=" ".repeat(M):C===99?M%2?(S=" ".repeat(M/2+.5),P=" ".repeat(M/2-.5)):(S=" ".repeat(M/2),P=S):P=" ".repeat(M)}r.delimiterStart!==!1&&!d&&w.push("|"),r.padding!==!1&&!(r.alignDelimiters===!1&&_==="")&&(r.delimiterStart!==!1||d)&&w.push(" "),r.alignDelimiters!==!1&&w.push(S),w.push(_),r.alignDelimiters!==!1&&w.push(P),r.padding!==!1&&w.push(" "),(r.delimiterEnd!==!1||d!==c-1)&&w.push("|")}v.push(r.delimiterEnd===!1?w.join("").replace(/ +$/,""):w.join(""))}return v.join(`
`)}function Sbt(e){return e==null?"":String(e)}function Dte(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}function Ebt(e,t,r,i){const n=r.enter("blockquote"),s=r.createTracker(i);s.move("> "),s.shift(2);const a=r.indentLines(r.containerFlow(e,s.current()),Abt);return n(),a}function Abt(e,t,r){return">"+(r?"":" ")+e}function Cbt(e,t){return Nte(e,t.inConstruct,!0)&&!Nte(e,t.notInConstruct,!1)}function Nte(e,t,r){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return r;let i=-1;for(;++i<t.length;)if(e.includes(t[i]))return!0;return!1}function kte(e,t,r,i){let n=-1;for(;++n<r.unsafe.length;)if(r.unsafe[n].character===`
`&&Cbt(r.stack,r.unsafe[n]))return/[ \t]/.test(i.before)?"":" ";return`\\
`}function Tbt(e,t){const r=String(e);let i=r.indexOf(t),n=i,s=0,a=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;i!==-1;)i===n?++s>a&&(a=s):s=1,n=i+t.length,i=r.indexOf(t,n);return a}function Mbt(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function Pbt(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function Dbt(e,t,r,i){const n=Pbt(r),s=e.value||"",a=n==="`"?"GraveAccent":"Tilde";if(Mbt(e,r)){const d=r.enter("codeIndented"),f=r.indentLines(s,Nbt);return d(),f}const o=r.createTracker(i),l=n.repeat(Math.max(Tbt(s,n)+1,3)),c=r.enter("codeFenced");let u=o.move(l);if(e.lang){const d=r.enter(`codeFencedLang${a}`);u+=o.move(r.safe(e.lang,{before:u,after:" ",encode:["`"],...o.current()})),d()}if(e.lang&&e.meta){const d=r.enter(`codeFencedMeta${a}`);u+=o.move(" "),u+=o.move(r.safe(e.meta,{before:u,after:`
`,encode:["`"],...o.current()})),d()}return u+=o.move(`
`),s&&(u+=o.move(s+`
`)),u+=o.move(l),c(),u}function Nbt(e,t,r){return(r?"":"    ")+e}function WU(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function kbt(e,t,r,i){const n=WU(r),s=n==='"'?"Quote":"Apostrophe",a=r.enter("definition");let o=r.enter("label");const l=r.createTracker(i);let c=l.move("[");return c+=l.move(r.safe(r.associationId(e),{before:c,after:"]",...l.current()})),c+=l.move("]: "),o(),!e.url||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(r.safe(e.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(o=r.enter("destinationRaw"),c+=l.move(r.safe(e.url,{before:c,after:e.title?" ":`
`,...l.current()}))),o(),e.title&&(o=r.enter(`title${s}`),c+=l.move(" "+n),c+=l.move(r.safe(e.title,{before:c,after:n,...l.current()})),c+=l.move(n),o()),a(),c}function Rbt(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function __(e){return"&#x"+e.toString(16).toUpperCase()+";"}function c3(e,t,r){const i=jx(e),n=jx(t);return i===void 0?n===void 0?r==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:n===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:i===1?n===void 0?{inside:!1,outside:!1}:n===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:n===void 0?{inside:!1,outside:!1}:n===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}Xge.peek=Ibt;function Xge(e,t,r,i){const n=Rbt(r),s=r.enter("emphasis"),a=r.createTracker(i),o=a.move(n);let l=a.move(r.containerPhrasing(e,{after:n,before:o,...a.current()}));const c=l.charCodeAt(0),u=c3(i.before.charCodeAt(i.before.length-1),c,n);u.inside&&(l=__(c)+l.slice(1));const d=l.charCodeAt(l.length-1),f=c3(i.after.charCodeAt(0),d,n);f.inside&&(l=l.slice(0,-1)+__(d));const m=a.move(n);return s(),r.attentionEncodeSurroundingInfo={after:f.outside,before:u.outside},o+l+m}function Ibt(e,t,r){return r.options.emphasis||"*"}function Obt(e,t){let r=!1;return HU(e,function(i){if("value"in i&&/\r?\n|\r/.test(i.value)||i.type==="break")return r=!0,p6}),!!((!e.depth||e.depth<3)&&jU(e)&&(t.options.setext||r))}function jbt(e,t,r,i){const n=Math.max(Math.min(6,e.depth||1),1),s=r.createTracker(i);if(Obt(e,r)){const u=r.enter("headingSetext"),d=r.enter("phrasing"),f=r.containerPhrasing(e,{...s.current(),before:`
`,after:`
`});return d(),u(),f+`
`+(n===1?"=":"-").repeat(f.length-(Math.max(f.lastIndexOf("\r"),f.lastIndexOf(`
`))+1))}const a="#".repeat(n),o=r.enter("headingAtx"),l=r.enter("phrasing");s.move(a+" ");let c=r.containerPhrasing(e,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(c)&&(c=__(c.charCodeAt(0))+c.slice(1)),c=c?a+" "+c:a,r.options.closeAtx&&(c+=" "+a),l(),o(),c}$ge.peek=Lbt;function $ge(e){return e.value||""}function Lbt(){return"<"}Kge.peek=zbt;function Kge(e,t,r,i){const n=WU(r),s=n==='"'?"Quote":"Apostrophe",a=r.enter("image");let o=r.enter("label");const l=r.createTracker(i);let c=l.move("![");return c+=l.move(r.safe(e.alt,{before:c,after:"]",...l.current()})),c+=l.move("]("),o(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(o=r.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(r.safe(e.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(o=r.enter("destinationRaw"),c+=l.move(r.safe(e.url,{before:c,after:e.title?" ":")",...l.current()}))),o(),e.title&&(o=r.enter(`title${s}`),c+=l.move(" "+n),c+=l.move(r.safe(e.title,{before:c,after:n,...l.current()})),c+=l.move(n),o()),c+=l.move(")"),a(),c}function zbt(){return"!"}Qge.peek=Bbt;function Qge(e,t,r,i){const n=e.referenceType,s=r.enter("imageReference");let a=r.enter("label");const o=r.createTracker(i);let l=o.move("![");const c=r.safe(e.alt,{before:l,after:"]",...o.current()});l+=o.move(c+"]["),a();const u=r.stack;r.stack=[],a=r.enter("reference");const d=r.safe(r.associationId(e),{before:l,after:"]",...o.current()});return a(),r.stack=u,s(),n==="full"||!c||c!==d?l+=o.move(d+"]"):n==="shortcut"?l=l.slice(0,-1):l+=o.move("]"),l}function Bbt(){return"!"}Zge.peek=Fbt;function Zge(e,t,r){let i=e.value||"",n="`",s=-1;for(;new RegExp("(^|[^`])"+n+"([^`]|$)").test(i);)n+="`";for(/[^ \r\n]/.test(i)&&(/^[ \r\n]/.test(i)&&/[ \r\n]$/.test(i)||/^`|`$/.test(i))&&(i=" "+i+" ");++s<r.unsafe.length;){const a=r.unsafe[s],o=r.compilePattern(a);let l;if(a.atBreak)for(;l=o.exec(i);){let c=l.index;i.charCodeAt(c)===10&&i.charCodeAt(c-1)===13&&c--,i=i.slice(0,c)+" "+i.slice(l.index+1)}}return n+i+n}function Fbt(){return"`"}function Jge(e,t){const r=jU(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(r===e.url||"mailto:"+r===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}e0e.peek=Vbt;function e0e(e,t,r,i){const n=WU(r),s=n==='"'?"Quote":"Apostrophe",a=r.createTracker(i);let o,l;if(Jge(e,r)){const u=r.stack;r.stack=[],o=r.enter("autolink");let d=a.move("<");return d+=a.move(r.containerPhrasing(e,{before:d,after:">",...a.current()})),d+=a.move(">"),o(),r.stack=u,d}o=r.enter("link"),l=r.enter("label");let c=a.move("[");return c+=a.move(r.containerPhrasing(e,{before:c,after:"](",...a.current()})),c+=a.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=r.enter("destinationLiteral"),c+=a.move("<"),c+=a.move(r.safe(e.url,{before:c,after:">",...a.current()})),c+=a.move(">")):(l=r.enter("destinationRaw"),c+=a.move(r.safe(e.url,{before:c,after:e.title?" ":")",...a.current()}))),l(),e.title&&(l=r.enter(`title${s}`),c+=a.move(" "+n),c+=a.move(r.safe(e.title,{before:c,after:n,...a.current()})),c+=a.move(n),l()),c+=a.move(")"),o(),c}function Vbt(e,t,r){return Jge(e,r)?"<":"["}t0e.peek=Ubt;function t0e(e,t,r,i){const n=e.referenceType,s=r.enter("linkReference");let a=r.enter("label");const o=r.createTracker(i);let l=o.move("[");const c=r.containerPhrasing(e,{before:l,after:"]",...o.current()});l+=o.move(c+"]["),a();const u=r.stack;r.stack=[],a=r.enter("reference");const d=r.safe(r.associationId(e),{before:l,after:"]",...o.current()});return a(),r.stack=u,s(),n==="full"||!c||c!==d?l+=o.move(d+"]"):n==="shortcut"?l=l.slice(0,-1):l+=o.move("]"),l}function Ubt(){return"["}function qU(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function Hbt(e){const t=qU(e),r=e.options.bulletOther;if(!r)return t==="*"?"-":"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(r===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+r+"`) to be different");return r}function Gbt(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function r0e(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function Wbt(e,t,r,i){const n=r.enter("list"),s=r.bulletCurrent;let a=e.ordered?Gbt(r):qU(r);const o=e.ordered?a==="."?")":".":Hbt(r);let l=t&&r.bulletLastUsed?a===r.bulletLastUsed:!1;if(!e.ordered){const u=e.children?e.children[0]:void 0;if((a==="*"||a==="-")&&u&&(!u.children||!u.children[0])&&r.stack[r.stack.length-1]==="list"&&r.stack[r.stack.length-2]==="listItem"&&r.stack[r.stack.length-3]==="list"&&r.stack[r.stack.length-4]==="listItem"&&r.indexStack[r.indexStack.length-1]===0&&r.indexStack[r.indexStack.length-2]===0&&r.indexStack[r.indexStack.length-3]===0&&(l=!0),r0e(r)===a&&u){let d=-1;for(;++d<e.children.length;){const f=e.children[d];if(f&&f.type==="listItem"&&f.children&&f.children[0]&&f.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(a=o),r.bulletCurrent=a;const c=r.containerFlow(e,i);return r.bulletLastUsed=a,r.bulletCurrent=s,n(),c}function qbt(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function Ybt(e,t,r,i){const n=qbt(r);let s=r.bulletCurrent||qU(r);t&&t.type==="list"&&t.ordered&&(s=(typeof t.start=="number"&&t.start>-1?t.start:1)+(r.options.incrementListMarker===!1?0:t.children.indexOf(e))+s);let a=s.length+1;(n==="tab"||n==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(a=Math.ceil(a/4)*4);const o=r.createTracker(i);o.move(s+" ".repeat(a-s.length)),o.shift(a);const l=r.enter("listItem"),c=r.indentLines(r.containerFlow(e,o.current()),u);return l(),c;function u(d,f,m){return f?(m?"":" ".repeat(a))+d:(m?s:s+" ".repeat(a-s.length))+d}}function Xbt(e,t,r,i){const n=r.enter("paragraph"),s=r.enter("phrasing"),a=r.containerPhrasing(e,i);return s(),n(),a}const $bt=dN(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function Kbt(e,t,r,i){return(e.children.some(function(a){return $bt(a)})?r.containerPhrasing:r.containerFlow).call(r,e,i)}function Qbt(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}i0e.peek=Zbt;function i0e(e,t,r,i){const n=Qbt(r),s=r.enter("strong"),a=r.createTracker(i),o=a.move(n+n);let l=a.move(r.containerPhrasing(e,{after:n,before:o,...a.current()}));const c=l.charCodeAt(0),u=c3(i.before.charCodeAt(i.before.length-1),c,n);u.inside&&(l=__(c)+l.slice(1));const d=l.charCodeAt(l.length-1),f=c3(i.after.charCodeAt(0),d,n);f.inside&&(l=l.slice(0,-1)+__(d));const m=a.move(n+n);return s(),r.attentionEncodeSurroundingInfo={after:f.outside,before:u.outside},o+l+m}function Zbt(e,t,r){return r.options.strong||"*"}function Jbt(e,t,r,i){return r.safe(e.value,i)}function e1t(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function t1t(e,t,r){const i=(r0e(r)+(r.options.ruleSpaces?" ":"")).repeat(e1t(r));return r.options.ruleSpaces?i.slice(0,-1):i}const n0e={blockquote:Ebt,break:kte,code:Dbt,definition:kbt,emphasis:Xge,hardBreak:kte,heading:jbt,html:$ge,image:Kge,imageReference:Qge,inlineCode:Zge,link:e0e,linkReference:t0e,list:Wbt,listItem:Ybt,paragraph:Xbt,root:Kbt,strong:i0e,text:Jbt,thematicBreak:t1t};function r1t(){return{enter:{table:i1t,tableData:Rte,tableHeader:Rte,tableRow:s1t},exit:{codeText:a1t,table:n1t,tableData:ij,tableHeader:ij,tableRow:ij}}}function i1t(e){const t=e._align;this.enter({type:"table",align:t.map(function(r){return r==="none"?null:r}),children:[]},e),this.data.inTable=!0}function n1t(e){this.exit(e),this.data.inTable=void 0}function s1t(e){this.enter({type:"tableRow",children:[]},e)}function ij(e){this.exit(e)}function Rte(e){this.enter({type:"tableCell",children:[]},e)}function a1t(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,o1t));const r=this.stack[this.stack.length-1];r.type,r.value=t,this.exit(e)}function o1t(e,t){return t==="|"?t:e}function l1t(e){const t=e||{},r=t.tableCellPadding,i=t.tablePipeAlign,n=t.stringLength,s=r?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:f,table:a,tableCell:l,tableRow:o}};function a(m,v,y,x){return c(u(m,y,x),m.align)}function o(m,v,y,x){const w=d(m,y,x),_=c([w]);return _.slice(0,_.indexOf(`
`))}function l(m,v,y,x){const w=y.enter("tableCell"),_=y.enter("phrasing"),S=y.containerPhrasing(m,{...x,before:s,after:s});return _(),w(),S}function c(m,v){return _bt(m,{align:v,alignDelimiters:i,padding:r,stringLength:n})}function u(m,v,y){const x=m.children;let w=-1;const _=[],S=v.enter("table");for(;++w<x.length;)_[w]=d(x[w],v,y);return S(),_}function d(m,v,y){const x=m.children;let w=-1;const _=[],S=v.enter("tableRow");for(;++w<x.length;)_[w]=l(x[w],m,v,y);return S(),_}function f(m,v,y){let x=n0e.inlineCode(m,v,y);return y.stack.includes("tableCell")&&(x=x.replace(/\|/g,"\\$&")),x}}function c1t(){return{exit:{taskListCheckValueChecked:Ite,taskListCheckValueUnchecked:Ite,paragraph:d1t}}}function u1t(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:h1t}}}function Ite(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function d1t(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const r=this.stack[this.stack.length-1];r.type;const i=r.children[0];if(i&&i.type==="text"){const n=t.children;let s=-1,a;for(;++s<n.length;){const o=n[s];if(o.type==="paragraph"){a=o;break}}a===r&&(i.value=i.value.slice(1),i.value.length===0?r.children.shift():r.position&&i.position&&typeof i.position.start.offset=="number"&&(i.position.start.column++,i.position.start.offset++,r.position.start=Object.assign({},i.position.start)))}}this.exit(e)}function h1t(e,t,r,i){const n=e.children[0],s=typeof e.checked=="boolean"&&n&&n.type==="paragraph",a="["+(e.checked?"x":" ")+"] ",o=r.createTracker(i);s&&o.move(a);let l=n0e.listItem(e,t,r,{...i,...o.current()});return s&&(l=l.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),l;function c(u){return u+a}}function f1t(){return[Wxt(),hbt(),gbt(),r1t(),c1t()]}function p1t(e){return{extensions:[qxt(),fbt(e),vbt(),l1t(e),u1t()]}}const m1t={tokenize:w1t,partial:!0},s0e={tokenize:_1t,partial:!0},a0e={tokenize:S1t,partial:!0},o0e={tokenize:E1t,partial:!0},g1t={tokenize:A1t,partial:!0},l0e={name:"wwwAutolink",tokenize:x1t,previous:u0e},c0e={name:"protocolAutolink",tokenize:b1t,previous:d0e},Jh={name:"emailAutolink",tokenize:y1t,previous:h0e},gd={};function v1t(){return{text:gd}}let Ym=48;for(;Ym<123;)gd[Ym]=Jh,Ym++,Ym===58?Ym=65:Ym===91&&(Ym=97);gd[43]=Jh;gd[45]=Jh;gd[46]=Jh;gd[95]=Jh;gd[72]=[Jh,c0e];gd[104]=[Jh,c0e];gd[87]=[Jh,l0e];gd[119]=[Jh,l0e];function y1t(e,t,r){const i=this;let n,s;return a;function a(d){return!y6(d)||!h0e.call(i,i.previous)||YU(i.events)?r(d):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),o(d))}function o(d){return y6(d)?(e.consume(d),o):d===64?(e.consume(d),l):r(d)}function l(d){return d===46?e.check(g1t,u,c)(d):d===45||d===95||za(d)?(s=!0,e.consume(d),l):u(d)}function c(d){return e.consume(d),n=!0,l}function u(d){return s&&n&&so(i.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(d)):r(d)}}function x1t(e,t,r){const i=this;return n;function n(a){return a!==87&&a!==119||!u0e.call(i,i.previous)||YU(i.events)?r(a):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(m1t,e.attempt(s0e,e.attempt(a0e,s),r),r)(a))}function s(a){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(a)}}function b1t(e,t,r){const i=this;let n="",s=!1;return a;function a(d){return(d===72||d===104)&&d0e.call(i,i.previous)&&!YU(i.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),n+=String.fromCodePoint(d),e.consume(d),o):r(d)}function o(d){if(so(d)&&n.length<5)return n+=String.fromCodePoint(d),e.consume(d),o;if(d===58){const f=n.toLowerCase();if(f==="http"||f==="https")return e.consume(d),l}return r(d)}function l(d){return d===47?(e.consume(d),s?c:(s=!0,l)):r(d)}function c(d){return d===null||a3(d)||Xi(d)||u0(d)||lN(d)?r(d):e.attempt(s0e,e.attempt(a0e,u),r)(d)}function u(d){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(d)}}function w1t(e,t,r){let i=0;return n;function n(a){return(a===87||a===119)&&i<3?(i++,e.consume(a),n):a===46&&i===3?(e.consume(a),s):r(a)}function s(a){return a===null?r(a):t(a)}}function _1t(e,t,r){let i,n,s;return a;function a(c){return c===46||c===95?e.check(o0e,l,o)(c):c===null||Xi(c)||u0(c)||c!==45&&lN(c)?l(c):(s=!0,e.consume(c),a)}function o(c){return c===95?i=!0:(n=i,i=void 0),e.consume(c),a}function l(c){return n||i||!s?r(c):t(c)}}function S1t(e,t){let r=0,i=0;return n;function n(a){return a===40?(r++,e.consume(a),n):a===41&&i<r?s(a):a===33||a===34||a===38||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===60||a===63||a===93||a===95||a===126?e.check(o0e,t,s)(a):a===null||Xi(a)||u0(a)?t(a):(e.consume(a),n)}function s(a){return a===41&&i++,e.consume(a),n}}function E1t(e,t,r){return i;function i(o){return o===33||o===34||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===63||o===95||o===126?(e.consume(o),i):o===38?(e.consume(o),s):o===93?(e.consume(o),n):o===60||o===null||Xi(o)||u0(o)?t(o):r(o)}function n(o){return o===null||o===40||o===91||Xi(o)||u0(o)?t(o):i(o)}function s(o){return so(o)?a(o):r(o)}function a(o){return o===59?(e.consume(o),i):so(o)?(e.consume(o),a):r(o)}}function A1t(e,t,r){return i;function i(s){return e.consume(s),n}function n(s){return za(s)?r(s):t(s)}}function u0e(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||Xi(e)}function d0e(e){return!so(e)}function h0e(e){return!(e===47||y6(e))}function y6(e){return e===43||e===45||e===46||e===95||za(e)}function YU(e){let t=e.length,r=!1;for(;t--;){const i=e[t][1];if((i.type==="labelLink"||i.type==="labelImage")&&!i._balanced){r=!0;break}if(i._gfmAutolinkLiteralWalkedInto){r=!1;break}}return e.length>0&&!r&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),r}const C1t={tokenize:I1t,partial:!0};function T1t(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:N1t,continuation:{tokenize:k1t},exit:R1t}},text:{91:{name:"gfmFootnoteCall",tokenize:D1t},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:M1t,resolveTo:P1t}}}}function M1t(e,t,r){const i=this;let n=i.events.length;const s=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let a;for(;n--;){const l=i.events[n][1];if(l.type==="labelImage"){a=l;break}if(l.type==="gfmFootnoteCall"||l.type==="labelLink"||l.type==="label"||l.type==="image"||l.type==="link")break}return o;function o(l){if(!a||!a._balanced)return r(l);const c=jc(i.sliceSerialize({start:a.end,end:i.now()}));return c.codePointAt(0)!==94||!s.includes(c.slice(1))?r(l):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(l),e.exit("gfmFootnoteCallLabelMarker"),t(l))}}function P1t(e,t){let r=e.length;for(;r--;)if(e[r][1].type==="labelImage"&&e[r][0]==="enter"){e[r][1];break}e[r+1][1].type="data",e[r+3][1].type="gfmFootnoteCallLabelMarker";const i={type:"gfmFootnoteCall",start:Object.assign({},e[r+3][1].start),end:Object.assign({},e[e.length-1][1].end)},n={type:"gfmFootnoteCallMarker",start:Object.assign({},e[r+3][1].end),end:Object.assign({},e[r+3][1].end)};n.end.column++,n.end.offset++,n.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},n.end),end:Object.assign({},e[e.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},o=[e[r+1],e[r+2],["enter",i,t],e[r+3],e[r+4],["enter",n,t],["exit",n,t],["enter",s,t],["enter",a,t],["exit",a,t],["exit",s,t],e[e.length-2],e[e.length-1],["exit",i,t]];return e.splice(r,e.length-r+1,...o),e}function D1t(e,t,r){const i=this,n=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s=0,a;return o;function o(d){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(d),e.exit("gfmFootnoteCallLabelMarker"),l}function l(d){return d!==94?r(d):(e.enter("gfmFootnoteCallMarker"),e.consume(d),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(d){if(s>999||d===93&&!a||d===null||d===91||Xi(d))return r(d);if(d===93){e.exit("chunkString");const f=e.exit("gfmFootnoteCallString");return n.includes(jc(i.sliceSerialize(f)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(d),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):r(d)}return Xi(d)||(a=!0),s++,e.consume(d),d===92?u:c}function u(d){return d===91||d===92||d===93?(e.consume(d),s++,c):c(d)}}function N1t(e,t,r){const i=this,n=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]);let s,a=0,o;return l;function l(v){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(v),e.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(v){return v===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(v),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",u):r(v)}function u(v){if(a>999||v===93&&!o||v===null||v===91||Xi(v))return r(v);if(v===93){e.exit("chunkString");const y=e.exit("gfmFootnoteDefinitionLabelString");return s=jc(i.sliceSerialize(y)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(v),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),f}return Xi(v)||(o=!0),a++,e.consume(v),v===92?d:u}function d(v){return v===91||v===92||v===93?(e.consume(v),a++,u):u(v)}function f(v){return v===58?(e.enter("definitionMarker"),e.consume(v),e.exit("definitionMarker"),n.includes(s)||n.push(s),ui(e,m,"gfmFootnoteDefinitionWhitespace")):r(v)}function m(v){return t(v)}}function k1t(e,t,r){return e.check(wS,t,e.attempt(C1t,t,r))}function R1t(e){e.exit("gfmFootnoteDefinition")}function I1t(e,t,r){const i=this;return ui(e,n,"gfmFootnoteDefinitionIndent",5);function n(s){const a=i.events[i.events.length-1];return a&&a[1].type==="gfmFootnoteDefinitionIndent"&&a[2].sliceSerialize(a[1],!0).length===4?t(s):r(s)}}function O1t(e){let r=(e||{}).singleTilde;const i={name:"strikethrough",tokenize:s,resolveAll:n};return r==null&&(r=!0),{text:{126:i},insideSpan:{null:[i]},attentionMarkers:{null:[126]}};function n(a,o){let l=-1;for(;++l<a.length;)if(a[l][0]==="enter"&&a[l][1].type==="strikethroughSequenceTemporary"&&a[l][1]._close){let c=l;for(;c--;)if(a[c][0]==="exit"&&a[c][1].type==="strikethroughSequenceTemporary"&&a[c][1]._open&&a[l][1].end.offset-a[l][1].start.offset===a[c][1].end.offset-a[c][1].start.offset){a[l][1].type="strikethroughSequence",a[c][1].type="strikethroughSequence";const u={type:"strikethrough",start:Object.assign({},a[c][1].start),end:Object.assign({},a[l][1].end)},d={type:"strikethroughText",start:Object.assign({},a[c][1].end),end:Object.assign({},a[l][1].start)},f=[["enter",u,o],["enter",a[c][1],o],["exit",a[c][1],o],["enter",d,o]],m=o.parser.constructs.insideSpan.null;m&&ol(f,f.length,0,cN(m,a.slice(c+1,l),o)),ol(f,f.length,0,[["exit",d,o],["enter",a[l][1],o],["exit",a[l][1],o],["exit",u,o]]),ol(a,c-1,l-c+3,f),l=c+f.length-2;break}}for(l=-1;++l<a.length;)a[l][1].type==="strikethroughSequenceTemporary"&&(a[l][1].type="data");return a}function s(a,o,l){const c=this.previous,u=this.events;let d=0;return f;function f(v){return c===126&&u[u.length-1][1].type!=="characterEscape"?l(v):(a.enter("strikethroughSequenceTemporary"),m(v))}function m(v){const y=jx(c);if(v===126)return d>1?l(v):(a.consume(v),d++,m);if(d<2&&!r)return l(v);const x=a.exit("strikethroughSequenceTemporary"),w=jx(v);return x._open=!w||w===2&&!!y,x._close=!y||y===2&&!!w,o(v)}}}class j1t{constructor(){this.map=[]}add(t,r,i){L1t(this,t,r,i)}consume(t){if(this.map.sort(function(s,a){return s[0]-a[0]}),this.map.length===0)return;let r=this.map.length;const i=[];for(;r>0;)r-=1,i.push(t.slice(this.map[r][0]+this.map[r][1]),this.map[r][2]),t.length=this.map[r][0];i.push(t.slice()),t.length=0;let n=i.pop();for(;n;){for(const s of n)t.push(s);n=i.pop()}this.map.length=0}}function L1t(e,t,r,i){let n=0;if(!(r===0&&i.length===0)){for(;n<e.map.length;){if(e.map[n][0]===t){e.map[n][1]+=r,e.map[n][2].push(...i);return}n+=1}e.map.push([t,r,i])}}function z1t(e,t){let r=!1;const i=[];for(;t<e.length;){const n=e[t];if(r){if(n[0]==="enter")n[1].type==="tableContent"&&i.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(n[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const s=i.length-1;i[s]=i[s]==="left"?"center":"right"}}else if(n[1].type==="tableDelimiterRow")break}else n[0]==="enter"&&n[1].type==="tableDelimiterRow"&&(r=!0);t+=1}return i}function B1t(){return{flow:{null:{name:"table",tokenize:F1t,resolveAll:V1t}}}}function F1t(e,t,r){const i=this;let n=0,s=0,a;return o;function o(D){let I=i.events.length-1;for(;I>-1;){const B=i.events[I][1].type;if(B==="lineEnding"||B==="linePrefix")I--;else break}const j=I>-1?i.events[I][1].type:null,L=j==="tableHead"||j==="tableRow"?C:l;return L===C&&i.parser.lazy[i.now().line]?r(D):L(D)}function l(D){return e.enter("tableHead"),e.enter("tableRow"),c(D)}function c(D){return D===124||(a=!0,s+=1),u(D)}function u(D){return D===null?r(D):or(D)?s>1?(s=0,i.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(D),e.exit("lineEnding"),m):r(D):$r(D)?ui(e,u,"whitespace")(D):(s+=1,a&&(a=!1,n+=1),D===124?(e.enter("tableCellDivider"),e.consume(D),e.exit("tableCellDivider"),a=!0,u):(e.enter("data"),d(D)))}function d(D){return D===null||D===124||Xi(D)?(e.exit("data"),u(D)):(e.consume(D),D===92?f:d)}function f(D){return D===92||D===124?(e.consume(D),d):d(D)}function m(D){return i.interrupt=!1,i.parser.lazy[i.now().line]?r(D):(e.enter("tableDelimiterRow"),a=!1,$r(D)?ui(e,v,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(D):v(D))}function v(D){return D===45||D===58?x(D):D===124?(a=!0,e.enter("tableCellDivider"),e.consume(D),e.exit("tableCellDivider"),y):M(D)}function y(D){return $r(D)?ui(e,x,"whitespace")(D):x(D)}function x(D){return D===58?(s+=1,a=!0,e.enter("tableDelimiterMarker"),e.consume(D),e.exit("tableDelimiterMarker"),w):D===45?(s+=1,w(D)):D===null||or(D)?P(D):M(D)}function w(D){return D===45?(e.enter("tableDelimiterFiller"),_(D)):M(D)}function _(D){return D===45?(e.consume(D),_):D===58?(a=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(D),e.exit("tableDelimiterMarker"),S):(e.exit("tableDelimiterFiller"),S(D))}function S(D){return $r(D)?ui(e,P,"whitespace")(D):P(D)}function P(D){return D===124?v(D):D===null||or(D)?!a||n!==s?M(D):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(D)):M(D)}function M(D){return r(D)}function C(D){return e.enter("tableRow"),T(D)}function T(D){return D===124?(e.enter("tableCellDivider"),e.consume(D),e.exit("tableCellDivider"),T):D===null||or(D)?(e.exit("tableRow"),t(D)):$r(D)?ui(e,T,"whitespace")(D):(e.enter("data"),E(D))}function E(D){return D===null||D===124||Xi(D)?(e.exit("data"),T(D)):(e.consume(D),D===92?N:E)}function N(D){return D===92||D===124?(e.consume(D),E):E(D)}}function V1t(e,t){let r=-1,i=!0,n=0,s=[0,0,0,0],a=[0,0,0,0],o=!1,l=0,c,u,d;const f=new j1t;for(;++r<e.length;){const m=e[r],v=m[1];m[0]==="enter"?v.type==="tableHead"?(o=!1,l!==0&&(Ote(f,t,l,c,u),u=void 0,l=0),c={type:"table",start:Object.assign({},v.start),end:Object.assign({},v.end)},f.add(r,0,[["enter",c,t]])):v.type==="tableRow"||v.type==="tableDelimiterRow"?(i=!0,d=void 0,s=[0,0,0,0],a=[0,r+1,0,0],o&&(o=!1,u={type:"tableBody",start:Object.assign({},v.start),end:Object.assign({},v.end)},f.add(r,0,[["enter",u,t]])),n=v.type==="tableDelimiterRow"?2:u?3:1):n&&(v.type==="data"||v.type==="tableDelimiterMarker"||v.type==="tableDelimiterFiller")?(i=!1,a[2]===0&&(s[1]!==0&&(a[0]=a[1],d=HC(f,t,s,n,void 0,d),s=[0,0,0,0]),a[2]=r)):v.type==="tableCellDivider"&&(i?i=!1:(s[1]!==0&&(a[0]=a[1],d=HC(f,t,s,n,void 0,d)),s=a,a=[s[1],r,0,0])):v.type==="tableHead"?(o=!0,l=r):v.type==="tableRow"||v.type==="tableDelimiterRow"?(l=r,s[1]!==0?(a[0]=a[1],d=HC(f,t,s,n,r,d)):a[1]!==0&&(d=HC(f,t,a,n,r,d)),n=0):n&&(v.type==="data"||v.type==="tableDelimiterMarker"||v.type==="tableDelimiterFiller")&&(a[3]=r)}for(l!==0&&Ote(f,t,l,c,u),f.consume(t.events),r=-1;++r<t.events.length;){const m=t.events[r];m[0]==="enter"&&m[1].type==="table"&&(m[1]._align=z1t(t.events,r))}return e}function HC(e,t,r,i,n,s){const a=i===1?"tableHeader":i===2?"tableDelimiter":"tableData",o="tableContent";r[0]!==0&&(s.end=Object.assign({},fy(t.events,r[0])),e.add(r[0],0,[["exit",s,t]]));const l=fy(t.events,r[1]);if(s={type:a,start:Object.assign({},l),end:Object.assign({},l)},e.add(r[1],0,[["enter",s,t]]),r[2]!==0){const c=fy(t.events,r[2]),u=fy(t.events,r[3]),d={type:o,start:Object.assign({},c),end:Object.assign({},u)};if(e.add(r[2],0,[["enter",d,t]]),i!==2){const f=t.events[r[2]],m=t.events[r[3]];if(f[1].end=Object.assign({},m[1].end),f[1].type="chunkText",f[1].contentType="text",r[3]>r[2]+1){const v=r[2]+1,y=r[3]-r[2]-1;e.add(v,y,[])}}e.add(r[3]+1,0,[["exit",d,t]])}return n!==void 0&&(s.end=Object.assign({},fy(t.events,n)),e.add(n,0,[["exit",s,t]]),s=void 0),s}function Ote(e,t,r,i,n){const s=[],a=fy(t.events,r);n&&(n.end=Object.assign({},a),s.push(["exit",n,t])),i.end=Object.assign({},a),s.push(["exit",i,t]),e.add(r+1,0,s)}function fy(e,t){const r=e[t],i=r[0]==="enter"?"start":"end";return r[1][i]}const U1t={name:"tasklistCheck",tokenize:G1t};function H1t(){return{text:{91:U1t}}}function G1t(e,t,r){const i=this;return n;function n(l){return i.previous!==null||!i._gfmTasklistFirstContentOfListItem?r(l):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(l),e.exit("taskListCheckMarker"),s)}function s(l){return Xi(l)?(e.enter("taskListCheckValueUnchecked"),e.consume(l),e.exit("taskListCheckValueUnchecked"),a):l===88||l===120?(e.enter("taskListCheckValueChecked"),e.consume(l),e.exit("taskListCheckValueChecked"),a):r(l)}function a(l){return l===93?(e.enter("taskListCheckMarker"),e.consume(l),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),o):r(l)}function o(l){return or(l)?t(l):$r(l)?e.check({tokenize:W1t},t,r)(l):r(l)}}function W1t(e,t,r){return ui(e,i,"whitespace");function i(n){return n===null?r(n):t(n)}}function q1t(e){return _ge([v1t(),T1t(),O1t(e),B1t(),H1t()])}const Y1t={};function f0e(e){const t=this,r=e||Y1t,i=t.data(),n=i.micromarkExtensions||(i.micromarkExtensions=[]),s=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),a=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);n.push(q1t(r)),s.push(f1t()),a.push(p1t(r))}const X1t=({role:e,text:t,timestamp:r,isError:i,isLoading:n})=>{const s=e==="user",[a,o]=O.useState(!1),l=f=>{navigator.clipboard.writeText(f).then(()=>{o(!0),setTimeout(()=>o(!1),2e3)})},c=s?"justify-end":"justify-start",u=s?"bg-blue-600 text-white":i?"bg-red-500/20 text-red-300 border border-red-500/30":"bg-[#2D3748] text-gray-200",d=()=>h.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 bg-gray-700",children:s?h.jsx(ufe,{size:16}):h.jsx(RD,{size:16})});return n?h.jsxs("div",{className:`flex items-start gap-3 ${c}`,children:[h.jsx(d,{}),h.jsx("div",{className:"flex flex-col max-w-2xl w-full",children:h.jsxs("div",{className:"bg-[#2D3748] rounded-xl px-4 py-3 flex items-center",children:[h.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce mr-1"}),h.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce mr-1",style:{animationDelay:"0.1s"}}),h.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]}):h.jsxs("div",{className:`flex items-start gap-3 ${c} group`,children:[!s&&h.jsx(d,{}),h.jsxs("div",{className:"flex flex-col max-w-2xl w-full",children:[h.jsxs("div",{className:`relative rounded-xl px-4 py-3 ${u}`,children:[i&&h.jsx(qP,{className:"absolute -top-2 -left-2 w-5 h-5 text-red-400"}),h.jsx(Hge,{remarkPlugins:[f0e],components:{code({node:f,inline:m,className:v,children:y,...x}){const w=/language-(\w+)/.exec(v||"");return m?h.jsx("code",{className:"bg-black/20 text-blue-300 font-mono px-1.5 py-0.5 rounded",...x,children:y}):h.jsxs("div",{className:"relative my-2 bg-[#1A202C] rounded-md shadow-inner",children:[h.jsxs("div",{className:"flex items-center justify-between bg-black/30 text-gray-300 px-3 py-1.5 rounded-t-md",children:[h.jsxs("span",{className:"text-xs font-sans font-medium flex items-center gap-2",children:[h.jsx(sl,{size:14}),w?w[1]:"code"]}),h.jsx("button",{onClick:()=>l(String(y)),className:"p-1 rounded-md hover:bg-white/10 text-gray-300 hover:text-white",children:a?h.jsx(sm,{size:14,className:"text-emerald-400"}):h.jsx(ID,{size:14})})]}),h.jsx("pre",{className:"p-3 text-sm overflow-x-auto",children:h.jsx("code",{className:"font-mono",...x,children:y})})]})},p:({children:f})=>h.jsx("p",{className:"leading-relaxed whitespace-pre-wrap",children:f}),ul:({children:f})=>h.jsx("ul",{className:"list-disc list-inside space-y-1 my-2",children:f})},children:t})]}),h.jsx("span",{className:`text-xs text-gray-500 mt-1.5 ${s?"text-right":"text-left"}`,children:new Date(r).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),s&&h.jsx(d,{})]})},$1t=({messages:e})=>{const t=O.useRef(null);return O.useEffect(()=>{t.current?.scrollIntoView({behavior:"smooth"})},[e]),h.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[e.map((r,i)=>h.jsx(X1t,{...r},i)),h.jsx("div",{ref:t})]})},K1t=({onSendMessage:e,isLoading:t})=>{const{register:r,handleSubmit:i,reset:n,watch:s}=$c(),a=s("message",""),o=O.useRef(null),l=c=>{c.message.trim()&&(e(c.message),n())};return O.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=`${o.current.scrollHeight}px`)},[a]),h.jsx("div",{className:"p-4 bg-[#1E1E1E] border-t border-gray-700",children:h.jsxs("form",{onSubmit:i(l),className:"flex items-end gap-3",children:[h.jsx("textarea",{ref:o,placeholder:"Ask for a hint, explain your code, or get help with algorithms...",className:"w-full resize-none bg-[#2D3748] text-gray-200 border border-gray-600 rounded-lg px-4 py-3 pr-20 focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:outline-none transition-all max-h-40",...r("message"),disabled:t,rows:1,onKeyDown:c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),i(l)())}}),h.jsxs("div",{className:"absolute right-20 bottom-7 text-xs text-gray-400 pointer-events-none",children:[a.length,"/500"]}),h.jsx("button",{type:"submit",className:"flex items-center justify-center w-12 h-12 rounded-lg bg-gray-700 text-gray-400 hover:bg-gray-600 hover:text-white transition-all disabled:bg-gray-800 disabled:text-gray-500 disabled:cursor-not-allowed",disabled:t||!a.trim(),children:h.jsx(ofe,{size:20})})]})})};function Q1t({problem:e}){const[t,r]=O.useState([]),[i,n]=O.useState(!1);O.useEffect(()=>{e?.title&&r([{role:"model",text:`Hello! 👋 I'm here to help you with the **${e.title}** problem. What would you like to know?`,timestamp:new Date().toISOString()}])},[e.title]);const s=async a=>{const o={role:"user",text:a,timestamp:new Date().toISOString()};r(u=>[...u,o,{role:"model",isLoading:!0}]),n(!0);const l={messages:[...t,o].map(u=>({role:u.role,parts:[{text:u.text}]})),title:e.title,description:e.description,testCases:e.testCases,startCode:e.starterCode},c=async u=>{let d="";for(let m=0;m<u.length;m++)d+=u[m],await new Promise(v=>setTimeout(v,30)),r(v=>{const y=[...v];return y[y.length-1]={role:"model",text:d,timestamp:new Date().toISOString()},y})};try{const d=(await jt.post("/problem/aichat",l)).data.message;await c(d)}catch(u){const f={role:"model",text:u.response?.data?.error||u.response?.data?.message||"Sorry, an unexpected error occurred.",timestamp:new Date().toISOString(),isError:!0};r(m=>[...m.slice(0,-1),f])}finally{n(!1)}};return h.jsxs("div",{className:"flex flex-col h-full bg-[#1E1E1E] text-white rounded-lg border border-gray-700 overflow-hidden",children:[h.jsxs("div",{className:"p-4 flex items-center gap-4 border-b border-gray-700 flex-shrink-0",children:[h.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center",children:h.jsx(dS,{size:20})}),h.jsxs("div",{children:[h.jsx("h2",{className:"font-semibold text-lg",children:"AI Assistant"}),h.jsxs("p",{className:"text-sm text-gray-400",children:['Ready to help with "',e?.title,'"']})]})]}),h.jsx($1t,{messages:t}),h.jsx(K1t,{onSendMessage:s,isLoading:i})]})}const Z1t=[.5,.75,1,1.25,1.5,2],J1t=({secureUrl:e,thumbnailUrl:t,duration:r})=>{const i=O.useRef(null),n=O.useRef(null),[s,a]=O.useState(!1);O.useEffect(()=>{a(!0)},[]);const[o,l]=O.useState(!1),[c,u]=O.useState(.8),[d,f]=O.useState(!1),[m,v]=O.useState(1),[y,x]=O.useState(0),[w,_]=O.useState(!1),[S,P]=O.useState(!1),[M,C]=O.useState(!0),[T,E]=O.useState(!1),[N,D]=O.useState(r||0),[I,j]=O.useState(!0),[L,B]=O.useState(null),q=()=>{n.current&&(o?n.current.pause():n.current.play().catch(xe=>{console.error("Play failed:",xe),B(xe.message)}),l(!o))},G=()=>{n.current&&(n.current.currentTime=Math.max(0,n.current.currentTime-10))},Y=()=>{n.current&&(n.current.currentTime=Math.min(N,n.current.currentTime+10))},X=xe=>{const Ee=parseFloat(xe.target.value);u(Ee),f(Ee===0),n.current&&(n.current.volume=Ee)},re=()=>{const xe=!d;f(xe),n.current&&(n.current.muted=xe)},F=xe=>{v(xe),n.current&&(n.current.playbackRate=xe),E(!1)},$=()=>_(!0),se=xe=>{const Ee=parseFloat(xe.target.value);x(Ee),n.current&&(n.current.currentTime=Ee*N)},H=xe=>{_(!1);const Ee=parseFloat(xe.target.value);n.current&&(n.current.currentTime=Ee*N)},ne=()=>{document.fullscreenEnabled&&i.current&&(document.fullscreenElement?(document.exitFullscreen(),P(!1)):(i.current.requestFullscreen().catch(xe=>{console.error("Fullscreen failed:",xe)}),P(!0)))},ce=xe=>{if(isNaN(xe)||xe===1/0)return"00:00";const Ee=new Date(xe*1e3),Be=Ee.getUTCHours(),$e=Ee.getUTCMinutes(),mt=Ee.getUTCSeconds().toString().padStart(2,"0");return Be?`${Be}:${$e.toString().padStart(2,"0")}:${mt}`:`${$e}:${mt}`},ie=()=>{j(!0),B(null)},ae=()=>{j(!1)},Z=xe=>{B("Failed to load video"),j(!1),console.error("Video error:",xe)},fe=()=>{n.current&&(D(n.current.duration),n.current.volume=c,n.current.muted=d,n.current.playbackRate=m)},he=()=>{n.current&&!w&&x(n.current.currentTime/N)},Ae=()=>{l(!1)};return O.useEffect(()=>{let xe;const Ee=()=>{C(!0),clearTimeout(xe),o&&(xe=setTimeout(()=>C(!1),3e3))},Be=i.current;return Be?.addEventListener("mousemove",Ee),()=>{Be?.removeEventListener("mousemove",Ee),clearTimeout(xe)}},[o]),s?h.jsxs("div",{ref:i,className:"relative w-full max-w-4xl mx-auto rounded-xl overflow-hidden shadow-2xl bg-black aspect-video group",children:[L&&h.jsxs("div",{className:"absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded text-xs z-50",children:["Error: ",L]}),h.jsxs("video",{ref:n,className:"w-full h-full object-contain",poster:t,preload:"metadata",onLoadStart:ie,onCanPlay:ae,onError:Z,onLoadedMetadata:fe,onTimeUpdate:he,onEnded:Ae,crossOrigin:"anonymous",children:[h.jsx("source",{src:e,type:"video/mp4"}),"Your browser does not support the video tag."]}),I&&h.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:h.jsx("div",{className:"text-white",children:"Loading video..."})}),h.jsxs("div",{className:`absolute inset-0 flex flex-col justify-between bg-gradient-to-t from-black/70 to-transparent p-4 transition-opacity duration-300 ${M||!o?"opacity-100":"opacity-0"}`,children:[h.jsx("div",{}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-white text-xs font-semibold",children:ce(y*N)}),h.jsx("input",{type:"range",min:0,max:.999999,step:"any",value:y,onMouseDown:$,onChange:se,onMouseUp:H,className:"flex-1 cursor-pointer bg-gray-600 rounded-lg appearance-none h-1 [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:cursor-pointer"}),h.jsx("span",{className:"text-white text-xs font-semibold",children:ce(N)})]}),h.jsxs("div",{className:"flex justify-between items-center mt-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:G,className:"p-2 rounded-full hover:bg-white/20 text-white transition-colors",children:h.jsx(Yot,{size:20})}),h.jsx("button",{onClick:q,className:"p-2 rounded-full hover:bg-white/20 text-white transition-colors",children:o?h.jsx(Vot,{size:32}):h.jsx(jD,{size:32})}),h.jsx("button",{onClick:Y,className:"p-2 rounded-full hover:bg-white/20 text-white transition-colors",children:h.jsx(rot,{size:20})}),h.jsxs("div",{className:"flex items-center group",children:[h.jsx("button",{onClick:re,className:"p-2 rounded-full hover:bg-white/20 text-white transition-colors",children:d||c===0?h.jsx(dfe,{size:20}):h.jsx(tU,{size:20})}),h.jsx("input",{type:"range",min:"0",max:"1",step:"any",value:c,onChange:X,className:"w-20 cursor-pointer opacity-0 group-hover:opacity-100 transition-opacity bg-gray-600 rounded-lg appearance-none h-1 [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:cursor-pointer"})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:"relative",children:[h.jsx("button",{onClick:()=>E(xe=>!xe),className:"p-2 rounded-full hover:bg-white/20 text-white transition-colors",children:h.jsx(tlt,{size:20})}),T&&h.jsxs("div",{className:"absolute bottom-full right-0 mb-2 bg-black/80 backdrop-blur-md rounded-lg p-2 min-w-[120px]",children:[h.jsx("h4",{className:"text-white text-sm font-bold px-2 py-1",children:"Speed"}),Z1t.map(xe=>h.jsxs("button",{onClick:()=>F(xe),className:`flex justify-between items-center w-full text-left text-sm px-2 py-1 rounded transition-colors ${m===xe?"bg-blue-600 text-white":"text-white hover:bg-white/20"}`,children:[h.jsx("span",{children:xe===1?"Normal":`${xe}x`}),m===xe&&h.jsx(sm,{size:16})]},xe))]})]}),h.jsx("button",{onClick:ne,className:"p-2 rounded-full hover:bg-white/20 text-white transition-colors",children:S?h.jsx(jot,{size:20}):h.jsx(Eot,{size:20})})]})]})]})]})]}):h.jsx("div",{className:"aspect-video w-full max-w-4xl mx-auto rounded-xl bg-black flex items-center justify-center",children:h.jsx("div",{className:"text-white",children:"Loading player..."})})},ewt=({sessionData:e,participantDetails:t})=>{const r=(a,o)=>{if(!a)return null;const l=t[a];let c="https://ui-avatars.com/api/?name=?&background=333&color=fff";const u=l?.first_name||`User ${o}`;if(l){const d=`https://ui-avatars.com/api/?name=${l.first_name}+${l.last_name||""}&background=random&color=fff&rounded=true`;c=l.profile_pic_url||d}return{name:u,avatarUrl:c,fallbackAvatar:`https://ui-avatars.com/api/?name=${u}&background=random&color=fff&rounded=true`}},i=r(e.user1_id,1),n=r(e.user2_id,2),s=({info:a,role:o})=>a?h.jsx("div",{className:"flex items-center justify-between text-sm",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("img",{src:a.avatarUrl,alt:`${a.name}'s avatar`,onError:l=>{l.currentTarget.src=a.fallbackAvatar},className:"w-7 h-7 rounded-full object-cover bg-neutral-700 border-2 border-neutral-300 dark:border-neutral-600"}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-semibold text-neutral-800 dark:text-neutral-100",children:a.name}),h.jsx("span",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:o})]})]})}):null;return h.jsxs("div",{className:"bg-white dark:bg-[#282828] border-b border-neutral-200 dark:border-neutral-700/80 px-4 py-3 flex-shrink-0",children:[h.jsxs("h3",{className:"flex items-center gap-2 text-sm font-semibold text-neutral-800 dark:text-neutral-200 mb-4",children:[h.jsx(Zu,{size:16}),"Participants"]}),h.jsxs("div",{className:"space-y-4",children:[i&&h.jsx(s,{info:i,role:"Host"}),n?h.jsx(s,{info:n,role:"Partner"}):h.jsxs("div",{className:"flex items-center gap-3 text-sm text-yellow-600 dark:text-yellow-400 opacity-80",children:[h.jsx("div",{className:"w-7 h-7 rounded-full bg-neutral-200 dark:bg-neutral-700 flex items-center justify-center",children:h.jsx(mot,{size:15})}),h.jsx("div",{className:"flex flex-col",children:h.jsx("span",{className:"font-semibold",children:"Waiting for partner..."})})]})]})]})},twt=({sessionData:e,isDriver:t,handleSwitchRoles:r,handleSyncCode:i,sessionId:n,addToast:s,participantDetails:a,isMuted:o,isSpeakerOn:l,handleToggleMute:c,handleToggleSpeaker:u,currentUser:d})=>{const f=async()=>{if(!n){s("Could not find Session ID to copy.","error");return}try{await navigator.clipboard.writeText(n),s("Session ID copied! Share it with your friend.","success")}catch{s("Failed to copy session ID.","error")}},m=()=>{const w=e?.current_driver;return w?a[w]?.first_name||`...${w.slice(-6)}`:"..."},y=(e?.user1_id===d?._id?e?.user2_mic_on:e?.user1_mic_on)!==!1,x=e?.user2_id;return h.jsx("div",{className:"bg-white/70 dark:bg-neutral-900/50 backdrop-blur-sm border-b border-neutral-200 dark:border-neutral-700/80 p-2 px-4 text-sm animate-fade-in flex-shrink-0",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-3 py-1.5 bg-neutral-100 hover:bg-neutral-200 dark:bg-neutral-800/60 dark:hover:bg-neutral-700/80 border border-neutral-200 dark:border-neutral-700 rounded-md transition-all duration-200 group",title:"Copy Invite ID",children:[h.jsx(ID,{size:14,className:"text-neutral-500 dark:text-neutral-400"}),h.jsx("span",{className:"text-neutral-700 dark:text-neutral-300 font-medium text-xs",children:"Copy Invite ID"})]}),h.jsxs("div",{className:"text-neutral-500 dark:text-neutral-400 hidden md:block",children:[h.jsx("span",{className:"font-semibold",children:"Driver:"}),h.jsx("span",{className:"ml-1.5 font-medium text-neutral-800 dark:text-neutral-100",children:m()}),h.jsx("span",{className:"ml-1",children:t?"🚗":"🧭"})]})]}),h.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[h.jsx(Fn,{variant:"ghost",size:"icon",onClick:c,className:"rounded-full text-neutral-600 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-700",title:o?"Unmute Microphone":"Mute Microphone",children:o?h.jsx(QJ,{className:"h-5 w-5 text-red-500"}):h.jsx(Bz,{className:"h-5 w-5 text-green-500"})}),h.jsx(Fn,{variant:"ghost",size:"icon",onClick:u,className:"rounded-full text-neutral-600 dark:text-neutral-300 hover:bg-neutral-200 dark:hover:bg-neutral-700",title:l?"Mute Speaker":"Unmute Speaker",children:l?h.jsx(tU,{className:"h-5 w-5"}):h.jsx(dfe,{className:"h-5 w-5"})}),h.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-neutral-400 border-l border-neutral-300 dark:border-neutral-700 pl-2 ml-1",title:"Partner's microphone status",children:[h.jsx("span",{children:"Partner:"}),x?y?h.jsx(Bz,{className:"h-4 w-4 text-green-500"}):h.jsx(QJ,{className:"h-4 w-4 text-red-500"}):h.jsx("span",{className:"text-neutral-500",children:"..."})]}),h.jsxs(Fn,{onClick:r,variant:"outline",size:"sm",className:"h-8 gap-2 border-neutral-300 dark:border-neutral-700 bg-white dark:bg-neutral-800 hover:bg-neutral-100 dark:hover:bg-neutral-700",disabled:!x,title:x?"Switch roles":"Waiting for partner to join",children:[h.jsx(lfe,{size:14})," Switch"]}),t&&h.jsxs(Fn,{onClick:i,size:"sm",className:"h-8 gap-2 bg-blue-600 hover:bg-blue-700 text-white",children:[h.jsx(nfe,{size:14})," Sync"]})]})]})})},rwt=({message:e,type:t,onClose:r})=>{O.useEffect(()=>{const s=setTimeout(()=>r(),3e3);return()=>clearTimeout(s)},[r]);const i={success:"bg-green-600",error:"bg-red-600",info:"bg-blue-600"},n={success:ka,error:n0,info:Dh}[t];return h.jsxs("div",{className:`flex items-center gap-4 text-white p-4 rounded-lg shadow-lg animate-fade-in-down ${i[t]}`,children:[h.jsx(n,{className:"h-5 w-5"}),h.jsx("p",{children:e}),h.jsx("button",{onClick:r,className:"ml-auto",children:h.jsx(Dc,{className:"h-5 w-5"})})]})},iwt=({toasts:e,removeToast:t})=>h.jsx("div",{className:"fixed top-20 right-5 z-50 space-y-2",children:e.map(r=>h.jsx(rwt,{...r,onClose:()=>t(r.id)},r.id))}),rx={javascript:{name:"JavaScript",monacoLang:"javascript"},python:{name:"Python",monacoLang:"python"},java:{name:"Java",monacoLang:"java"},"c++":{name:"C++",monacoLang:"c++"}},nwt=({language:e,setLanguage:t,availableLanguages:r=[]})=>{const i=rx[e]?.name||"Select Language";return h.jsxs(wgt,{children:[h.jsx(_gt,{asChild:!0,children:h.jsxs(Fn,{variant:"ghost",className:"font-medium text-sm text-foreground bg-muted hover:bg-muted/80 px-3",children:[i,h.jsx(KV,{className:"h-4 w-4 ml-2"})]})}),h.jsx(Sgt,{align:"end",className:"w-56 p-2 bg-[#282828] border-gray-700 rounded-lg shadow-2xl",children:r.map(n=>{const s=rx[n.language];return s?h.jsxs(Egt,{onSelect:()=>t(n.language),className:"flex items-center justify-between p-2 rounded-md hover:bg-[#3E3E3E] focus:bg-[#3E3E3E] text-gray-200 cursor-pointer",children:[h.jsx("span",{children:s.name}),e===n.language&&h.jsx(sm,{className:"h-4 w-4 text-sky-400"})]},n.language):null})})]})},swt=({problem:e})=>{const{problemId:t}=Qp(),[r,i]=O.useState([]),[n,s]=O.useState(!1),[a,o]=O.useState(""),[l,c]=O.useState(!1),[u,d]=O.useState("description"),f=O.useCallback(async()=>{s(!0),o("");try{const _=await jt.get(`/problem/submissionOfProblem/${t}`);i(_.data.submissions),c(!0)}catch(_){i(null),o(_.message||"Failed to fetch submissions.")}finally{s(!1)}},[t]);O.useEffect(()=>{u==="submissions"&&!l&&f()},[u,l,f,t]);const m=_=>{switch(_.toLowerCase()){case"easy":return"bg-emerald-100 dark:bg-emerald-900/60 text-emerald-700 dark:text-emerald-400";case"medium":return"bg-yellow-100 dark:bg-yellow-900/60 text-yellow-700 dark:text-yellow-400";case"hard":return"bg-red-100 dark:bg-red-900/60 text-red-700 dark:text-red-400";default:return"bg-neutral-200 dark:bg-neutral-700 text-neutral-800 dark:text-neutral-300"}},[v,y]=O.useState(e.problem_solution?.[0]?.language||null),x=e.problem_solution?.find(_=>_.language===v),w=_=>{const S=_.replace(/`([^`]+)`/g,'<code class="bg-neutral-700/80 text-neutral-200 font-mono px-1.5 py-0.5 rounded-md mx-0.5">$1</code>');return h.jsx("div",{dangerouslySetInnerHTML:{__html:S}})};return h.jsx("div",{className:"h-full overflow-y-auto bg-white dark:bg-[#282828] text-neutral-800 dark:text-neutral-300",children:h.jsx("div",{className:"h-full flex flex-col",children:h.jsxs(JD,{defaultValue:"description",className:"h-full flex flex-col",onValueChange:d,children:[h.jsx("div",{className:"px-5 py-2 flex-shrink-0","data-aos":"fade-in",children:h.jsxs(eN,{className:"bg-transparent p-0 h-auto",children:[h.jsxs(Vl,{value:"description",className:"flex items-center gap-1.5 text-sm px-3 py-1.5 rounded-lg h-auto dark:data-[state=active]:bg-neutral-700/50  dark:data-[state=active]:text-white data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 data-[state=active]:border-blue-200",children:[h.jsx(Sat,{className:"h-4 w-4"})," Description"]}),h.jsxs(Vl,{value:"editorial",className:"flex items-center gap-1.5 text-sm px-3 py-1.5 rounded-lg h-auto dark:data-[state=active]:bg-neutral-700/50  dark:data-[state=active]:text-white data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 data-[state=active]:border-blue-200",children:[h.jsx(zz,{className:"h-4 w-4"})," Editorial"]}),h.jsxs(Vl,{value:"submissions",className:"flex items-center gap-1.5 text-sm px-3 py-1.5 rounded-lg h-auto dark:data-[state=active]:bg-neutral-700/50  dark:data-[state=active]:text-white data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 data-[state=active]:border-blue-200",children:[h.jsx(fot,{className:"h-4 w-4"})," Submissions"]}),h.jsxs(Vl,{value:"solutions",className:"flex items-center gap-1.5 text-sm px-3 py-1.5 rounded-lg h-auto dark:data-[state=active]:bg-neutral-700/50  dark:data-[state=active]:text-white data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 data-[state=active]:border-blue-200",children:[h.jsx(oot,{className:"h-4 w-4"})," Solutions"]}),h.jsxs(Vl,{value:"aichat",className:"flex items-center gap-1.5 text-sm px-3 py-1.5 rounded-lg h-auto dark:data-[state=active]:bg-neutral-700/50  dark:data-[state=active]:text-white data-[state=active]:bg-blue-50 data-[state=active]:text-blue-600 data-[state=active]:border-blue-200",children:[h.jsx(RD,{className:"h-4 w-4"})," Virtual Assistant"]})]})}),h.jsxs("div",{className:"flex-1 overflow-y-auto px-5 pb-5",children:[h.jsx(Sc,{value:"description",className:"mt-0",children:h.jsxs("div",{className:"space-y-5",children:[h.jsxs("h1",{"data-aos":"fade-down",className:"text-xl font-medium text-black dark:text-white ",children:[e.serial_number,". ",e.title]}),h.jsxs("div",{"data-aos":"fade-down","data-aos-delay":"100",className:"flex items-center gap-2",children:[h.jsx(e3,{className:`font-medium rounded-full px-3 py-1 text-xs border-none ${m(e.difficulty)}`,children:e.difficulty}),e.tags.split(",").map(_=>h.jsx(e3,{variant:"secondary",className:"font-normal rounded-full px-3 py-1 text-xs bg-gray-200 text-gray-700 hover:bg-gray-300  dark:bg-neutral-700/80 dark:text-neutral-300 dark:hover:bg-neutral-700 border-none cursor-pointer",children:_.trim()},_.trim()))]}),h.jsx("div",{"data-aos":"fade-up",className:"text-sm leading-relaxed space-y-4",children:w(e.description)}),h.jsx("div",{className:"space-y-6",children:e.visible_testcase.map((_,S)=>h.jsxs("div",{"data-aos":"fade-up","data-aos-delay":S*150,children:[h.jsxs("p",{className:"font-semibold text-sm text-neutral-800 dark:text-neutral-200 mb-2",children:["Example ",S+1,":"]}),h.jsxs("div",{className:"bg-neutral-100 dark:bg-neutral-800/60 p-4 rounded-lg font-mono text-sm space-y-2 border border-neutral-200 dark:border-neutral-700/80",children:[h.jsxs("div",{children:[h.jsx("strong",{className:"font-medium text-neutral-500 dark:text-neutral-400 mr-2",children:"Input:"}),h.jsx("span",{className:"text-neutral-900 dark:text-neutral-100",children:_.input})]}),h.jsxs("div",{children:[h.jsx("strong",{className:"font-medium text-neutral-500 dark:text-neutral-400 mr-2",children:"Output:"}),h.jsx("span",{className:"text-neutral-900 dark:text-neutral-100",children:_.output})]}),_.explanation&&h.jsxs("div",{children:[h.jsx("strong",{className:"font-medium text-neutral-500 dark:text-neutral-400 mr-2",children:"Explanation:"}),h.jsx("span",{className:"text-neutral-600 dark:text-neutral-300",children:_.explanation})]})]})]},S))})]})}),h.jsx(Sc,{value:"solutions",className:"mt-4",children:h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{"data-aos":"fade-in",className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg",children:h.jsx("svg",{className:"h-5 w-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-xl font-semibold text-black dark:text-white",children:"Solution"}),h.jsx("p",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"Official solution with multiple language implementations"})]})]}),h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs(Fn,{variant:"ghost",size:"sm",className:"text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200",onClick:()=>navigator.clipboard.writeText(x?.complete_code||""),children:[h.jsx("svg",{className:"h-4 w-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy"]})})]}),!e.problem_solution||e.problem_solution.length===0?h.jsxs("div",{"data-aos":"zoom-in",className:"text-center py-16",children:[h.jsx("div",{className:"mx-auto w-16 h-16 bg-gradient-to-r from-neutral-100 to-neutral-200 dark:from-neutral-800 dark:to-neutral-700 rounded-full flex items-center justify-center mb-4",children:h.jsx("svg",{className:"h-8 w-8 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})}),h.jsx("p",{className:"text-neutral-500 dark:text-neutral-400 text-lg mb-2",children:"No Solution Available"}),h.jsx("p",{className:"text-neutral-400 dark:text-neutral-500 text-sm",children:"The official solution for this problem hasn't been published yet."})]}):h.jsxs("div",{className:"space-y-4","data-aos":"fade-up",children:[h.jsx("div",{className:"flex flex-wrap gap-2",children:e.problem_solution.map(_=>h.jsxs(Fn,{onClick:()=>y(_.language),variant:v===_.language?"default":"outline",className:`flex items-center gap-2 h-9 px-4 text-sm font-medium transition-all duration-200 ${v===_.language?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg shadow-blue-500/25 border-0":"hover:bg-neutral-100 dark:hover:bg-neutral-800"}`,children:[h.jsxs("span",{className:"text-base",children:[_.language==="javascript"&&"🟨",_.language==="python"&&"🐍",_.language==="java"&&"☕",_.language==="cpp"&&"⚡"]}),rx[_.language]?.name||_.language]},_.language))}),h.jsx("div",{className:"flex items-center justify-between cursor-pointer",children:h.jsxs("div",{className:` bg-fuchsia-300 inline-flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium ${v==="javascript"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300":""} ${v==="python"?"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300":""} ${v==="java"?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300":""} ${v==="cpp"?"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300":""}`,children:[h.jsxs("span",{children:[v==="javascript"&&"🟨",v==="python"&&"🐍",v==="java"&&"☕",v==="cpp"&&"⚡"]}),rx[v]?.name||v]})}),h.jsx("div",{className:"h-[600px] border border-neutral-200 dark:border-neutral-700/80 rounded-xl overflow-hidden bg-gradient-to-r from-neutral-50/50 to-neutral-100/50 dark:from-neutral-900/50 dark:to-neutral-800/50 shadow-sm",children:h.jsx(fS,{height:"100%",language:rx[v]?.monacoLang||"plaintext",value:x?.complete_code||"",theme:document.documentElement.classList.contains("dark")?"vs-dark":"light",options:{readOnly:!0,minimap:{enabled:!1},fontSize:14,wordWrap:"on",automaticLayout:!0,lineNumbers:"on",scrollBeyondLastLine:!1,padding:{top:16,bottom:16},renderLineHighlight:"none",overviewRulerBorder:!1,hideCursorInOverviewRuler:!0,folding:!0,selectOnLineNumbers:!0,matchBrackets:"always",contextmenu:!0,smoothScrolling:!0}})})]})]})}),h.jsx(Sc,{value:"submissions",className:"mt-0 text-neutral-500 pt-10",children:n?h.jsxs("div",{className:"flex justify-center items-center py-10",children:[h.jsx(HP,{className:"h-6 w-6 animate-spin"}),h.jsx("span",{className:"ml-2",children:"Loading submissions..."})]}):a?h.jsx("div",{className:"text-red-500 text-center py-10",children:a}):r.length===0?h.jsx("div",{className:"text-center text-neutral-400 py-10",children:"No Submissions Yet"}):h.jsx("div",{className:"space-y-6 max-w-2xl mx-auto",children:r.map(_=>h.jsx(Agt,{sub:_},_.id))})}),h.jsx(Sc,{value:"editorial",className:"mt-0",children:h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{"data-aos":"fade-in",className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg",children:h.jsx(zz,{className:"h-5 w-5 text-white"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-xl font-semibold text-black dark:text-white",children:"Editorial"}),h.jsx("p",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:"A video explanation of the solution approach."})]})]}),h.jsx("div",{"data-aos":"fade-up",className:"text-sm leading-relaxed text-neutral-700 dark:text-neutral-300",children:e.secureUrl?h.jsx(J1t,{secureUrl:e.secureUrl,thumbnailUrl:e.thumbnailUrl,duration:e.duration}):h.jsx("div",{className:"text-center py-16",children:h.jsx("p",{className:"text-neutral-500 dark:text-neutral-400",children:"No editorial video available for this problem yet."})})})]})}),h.jsx(Sc,{value:"aichat",className:"mt-0 h-full",children:h.jsx(Q1t,{problem:e})})]})]})})})},awt=({language:e,isDark:t,onMount:r,code:i,onCodeChange:n,readOnly:s})=>h.jsx(fS,{height:"100%",language:rx[e]?.monacoLang||"javascript",theme:t?"vs-dark":"light",onMount:r,value:i,onChange:n,options:{readOnly:s,minimap:{enabled:!1},fontSize:14,wordWrap:"on",automaticLayout:!0,padding:{top:16,bottom:16}}}),owt=({testcases:e,isRunning:t,testResults:r})=>{const[i,n]=O.useState(0),s=o=>o===3?{text:"Accepted",color:"text-green-500",icon:h.jsx(ka,{className:"h-4 w-4"})}:o===4?{text:"Wrong Answer",color:"text-red-500",icon:h.jsx(n0,{className:"h-4 w-4"})}:o===5?{text:"Time Limit Exceeded",color:"text-yellow-500",icon:h.jsx(Rc,{className:"h-4 w-4"})}:o===6?{text:"Compilation Error",color:"text-red-500",icon:h.jsx(Dh,{className:"h-4 w-4"})}:{text:"Error",color:"text-red-500",icon:h.jsx(Dh,{className:"h-4 w-4"})},a=()=>{if(!r)return null;if(r.errorMessage&&r.testCases.length===0)return h.jsxs("div",{"data-aos":"fade-in",className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800/50 rounded-lg mb-4",children:[h.jsxs("div",{className:"flex items-center gap-2 text-red-600 dark:text-red-400 mb-2",children:[h.jsx(Dh,{className:"h-5 w-5"}),h.jsx("h2",{className:"text-lg font-semibold",children:"Execution Failed"})]}),h.jsx("pre",{className:"text-xs whitespace-pre-wrap font-mono bg-red-100 dark:bg-red-900/40 p-3 rounded-md text-red-800 dark:text-red-300",children:r.errorMessage})]});const o=r.success?"Accepted":"Wrong Answer",l=r.success?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",c=r.success?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800/50":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800/50";return h.jsxs("div",{"data-aos":"fade-in",className:`p-4 ${c} border rounded-lg mb-4`,children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.success?h.jsx(ka,{className:"h-5 w-5 text-green-500"}):h.jsx(n0,{className:"h-5 w-5 text-red-500"}),h.jsx("h2",{className:`text-lg font-semibold ${l}`,children:o})]}),h.jsxs("div",{className:"flex items-center gap-6 text-sm text-neutral-600 dark:text-neutral-400",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Rc,{className:"h-4 w-4"}),h.jsxs("span",{children:["Runtime: ",h.jsxs("span",{className:"font-medium",children:[r.runtime.toFixed(2)," ms"]})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(dot,{className:"h-4 w-4"}),h.jsxs("span",{children:["Memory: ",h.jsxs("span",{className:"font-medium",children:[(r.memory/1024).toFixed(2)," MB"]})]})]})]})]})};return h.jsx("div",{className:"h-full bg-white dark:bg-neutral-900 flex flex-col border border-neutral-200 dark:border-neutral-700 rounded-lg",children:h.jsxs(JD,{defaultValue:"testcase",className:"h-full flex flex-col",children:[h.jsx("div",{className:"px-4 py-3 flex-shrink-0 border-b border-neutral-200 dark:border-neutral-700 bg-neutral-50 dark:bg-neutral-800/50","data-aos":"fade-in",children:h.jsxs(eN,{className:"bg-transparent p-0 gap-1",children:[h.jsx(Vl,{value:"testcase",className:"text-sm data-[state=active]:text-blue-600 data-[state=active]:bg-blue-50 data-[state=active]:border-blue-200 dark:data-[state=active]:text-blue-400 dark:data-[state=active]:bg-blue-900/20 dark:data-[state=active]:border-blue-800/50 rounded-lg px-4 py-2 border border-transparent hover:bg-neutral-100 dark:hover:bg-neutral-700",children:"Test Cases"}),h.jsx(Vl,{value:"result",className:"text-sm data-[state=active]:text-blue-600 data-[state=active]:bg-blue-50 data-[state=active]:border-blue-200 dark:data-[state=active]:text-blue-400 dark:data-[state=active]:bg-blue-900/20 dark:data-[state=active]:border-blue-800/50 rounded-lg px-4 py-2 border border-transparent hover:bg-neutral-100 dark:hover:bg-neutral-700",children:"Result"})]})}),h.jsxs(Sc,{value:"testcase",className:"flex-1 p-4 overflow-y-auto","data-aos":"fade-up",children:[h.jsx("div",{className:"flex gap-2 mb-4 flex-wrap",children:e.map((o,l)=>h.jsxs(Fn,{variant:i===l?"default":"outline",size:"sm",onClick:()=>n(l),className:`h-8 rounded-lg ${i===l?"bg-blue-500 text-white border-blue-500 hover:bg-blue-600":"border-neutral-300 dark:border-neutral-600 hover:bg-neutral-100 dark:hover:bg-neutral-800"}`,children:["Case ",l+1]},l))}),e[i]&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2 block",children:"Input"}),h.jsx("div",{className:"bg-neutral-100 dark:bg-neutral-800 p-3 rounded-lg font-mono text-sm text-neutral-800 dark:text-neutral-200 border border-neutral-200 dark:border-neutral-700",children:e[i].input})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-sm font-medium text-neutral-700 dark:text-neutral-300 mb-2 block",children:"Expected Output"}),h.jsx("div",{className:"bg-neutral-100 dark:bg-neutral-800 p-3 rounded-lg font-mono text-sm text-neutral-800 dark:text-neutral-200 border border-neutral-200 dark:border-neutral-700",children:e[i].output})]})]})]}),h.jsx(Sc,{value:"result",className:"flex-1 p-4 overflow-y-auto",children:t?h.jsxs("div",{className:"flex items-center justify-center h-full text-neutral-600 dark:text-neutral-400 gap-2",children:[h.jsx(HP,{className:"h-5 w-5 animate-spin"}),h.jsx("span",{children:"Evaluating..."})]}):r?h.jsxs("div",{children:[h.jsx(a,{}),h.jsx("div",{className:"flex gap-2 mb-4 flex-wrap","data-aos":"fade-up",children:r.testCases.map((o,l)=>h.jsxs(Fn,{variant:i===l?"default":"outline",size:"sm",onClick:()=>n(l),className:`h-8 rounded-lg ${i===l?o.status_id===3?"bg-green-500 border-green-500 text-white hover:bg-green-600":"bg-red-500 border-red-500 text-white hover:bg-red-600":o.status_id===3?"border-green-500 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20":"border-red-500 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20"}`,children:["Case ",l+1]},l))}),r.testCases[i]&&(()=>{const o=r.testCases[i],l=e[i],c=s(o.status_id);return h.jsxs("div",{className:"space-y-4","data-aos":"fade-up","data-aos-delay":"100",children:[h.jsxs("div",{className:`flex items-center gap-2 font-medium ${c.color} p-3 rounded-lg ${o.status_id===3?"bg-green-50 dark:bg-green-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[c.icon," ",c.text]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-sm font-semibold text-neutral-700 dark:text-neutral-300 mb-2 block",children:"Input:"}),h.jsx("div",{className:"bg-neutral-100 dark:bg-neutral-800 p-3 rounded-lg font-mono text-sm text-neutral-800 dark:text-neutral-200 border border-neutral-200 dark:border-neutral-700",children:l.input})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-sm font-semibold text-neutral-700 dark:text-neutral-300 mb-2 block",children:"Your Output:"}),h.jsx("div",{className:"bg-neutral-100 dark:bg-neutral-800 p-3 rounded-lg font-mono text-sm text-neutral-800 dark:text-neutral-200 border border-neutral-200 dark:border-neutral-700",children:o.stdout||"(no output)"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-sm font-semibold text-neutral-700 dark:text-neutral-300 mb-2 block",children:"Expected Output:"}),h.jsx("div",{className:"bg-neutral-100 dark:bg-neutral-800 p-3 rounded-lg font-mono text-sm text-neutral-800 dark:text-neutral-200 border border-neutral-200 dark:border-neutral-700",children:l.output})]})]})})()]}):h.jsx("div",{className:"flex items-center justify-center h-full text-neutral-500 dark:text-neutral-400",children:h.jsxs("div",{className:"text-center","data-aos":"zoom-in",children:[h.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-neutral-100 dark:bg-neutral-800 rounded-full flex items-center justify-center",children:h.jsx(Rc,{className:"h-8 w-8 text-neutral-400"})}),h.jsx("p",{children:"Click 'Run' to see test results"})]})})})]})})},lwt=({result:e,onClose:t})=>{if(!e)return null;const r=e.success,i=r?"Accepted":"Wrong Answer",n=r?"text-green-500":"text-red-500";return h.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in",onClick:t,children:h.jsxs("div",{className:"bg-white dark:bg-[#282828] w-full max-w-xl rounded-2xl shadow-2xl border border-neutral-200 dark:border-neutral-700 transform transition-all duration-300 scale-95 animate-scale-in",onClick:s=>s.stopPropagation(),children:[h.jsxs("div",{className:"relative p-6 text-center",children:[h.jsx("button",{onClick:t,className:"absolute right-4 top-4 p-2 rounded-full hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors","aria-label":"Close modal",children:h.jsx(Dc,{className:"h-5 w-5 text-neutral-500 dark:text-neutral-400"})}),h.jsx("div",{className:`mx-auto h-20 w-20 flex items-center justify-center rounded-full ${r?"bg-green-50 dark:bg-green-900/30 border-2 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/30 border-2 border-red-200 dark:border-red-800"} mb-6`,children:r?h.jsx(ka,{className:"h-12 w-12 text-green-500"}):h.jsx(n0,{className:"h-12 w-12 text-red-500"})}),h.jsx("h2",{className:`text-3xl font-bold ${n} mb-2`,children:e.status?.replace(/_/g," ")||i}),e.errorMessage?h.jsx("div",{className:"mt-4 p-4 bg-neutral-50 dark:bg-neutral-800/50 rounded-xl border border-neutral-200 dark:border-neutral-700",children:h.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400 font-mono text-left",children:e.errorMessage})}):h.jsx("p",{className:"text-neutral-600 dark:text-neutral-400 text-lg",children:"Your solution passed all hidden test cases."})]}),!e.errorMessage&&h.jsxs("div",{className:"mx-6 mb-6 grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 p-4 rounded-xl border border-neutral-200 dark:border-neutral-700",children:[h.jsxs("div",{className:"flex items-center justify-center mb-2",children:[h.jsx(Rc,{className:"h-5 w-5 text-neutral-500 dark:text-neutral-400 mr-2"}),h.jsx("p",{className:"text-sm font-medium text-neutral-500 dark:text-neutral-400",children:"Runtime"})]}),h.jsxs("p",{className:"text-xl font-bold text-neutral-900 dark:text-white text-center",children:[e.runtime?.toFixed(2)||"0.00"," ms"]})]}),h.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-800/50 p-4 rounded-xl border border-neutral-200 dark:border-neutral-700",children:[h.jsxs("div",{className:"flex items-center justify-center mb-2",children:[h.jsx(Mot,{className:"h-5 w-5 text-neutral-500 dark:text-neutral-400 mr-2"}),h.jsx("p",{className:"text-sm font-medium text-neutral-500 dark:text-neutral-400",children:"Memory"})]}),h.jsxs("p",{className:"text-xl font-bold text-neutral-900 dark:text-white text-center",children:[((e.memory||0)/1024).toFixed(2)," MB"]})]})]}),h.jsx("div",{className:"p-6 pt-0 flex justify-end",children:h.jsx("button",{onClick:t,className:"px-6 py-2 bg-neutral-100 dark:bg-neutral-700 text-neutral-700 dark:text-neutral-200 rounded-lg hover:bg-neutral-200 dark:hover:bg-neutral-600 transition-colors font-medium",children:"Close"})})]})})},nj=()=>{let{problemId:e,sessionId:t}=Qp();const r=fs(),i=O.useRef(null);let[n,s]=O.useState(null);const[a,o]=O.useState(!0),[l,c]=O.useState(""),[u,d]=O.useState("javascript"),[f,m]=O.useState(!0),[v,y]=O.useState(!1),[x,w]=O.useState(),[_,S]=O.useState([]),[P,M]=O.useState(null),C=dd(),{user:T}=ho(De=>De.auth),[E,N]=O.useState(!!t),[D,I]=O.useState(null),[j,L]=O.useState({}),[B,q]=O.useState(""),G=E&&D?.current_driver===T?._id,[Y,X]=O.useState(null),[re,F]=O.useState(null);let[$,se]=O.useState(null);const[H,ne]=O.useState(!1),[ce,ie]=O.useState(!0),ae=O.useRef(),Z=O.useRef(new Set),fe=()=>{$&&($.close(),$=null),ae?.current&&(ae.current.pause(),ae.current.srcObject=null)};if(!T)return h.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-10",children:h.jsx(yb,{message:"You need to be logged in to view  challenge!"})});O.useEffect(()=>{if(!D||!T)return;const De=async qe=>{if(!(!qe||j[qe]))try{return(await jt.get(`/user/profile/${qe}`)).data}catch(ft){return console.error(`Failed to fetch details for user ${qe}`,ft),{_id:qe,first_name:"Unknown"}}},{user1_id:We,user2_id:Je}=D,et=[];We===T._id?et.push(Promise.resolve(T)):We&&et.push(De(We)),Je===T._id?et.push(Promise.resolve(T)):Je&&et.push(De(Je)),Promise.all(et).then(qe=>{const ft={};qe.forEach(kt=>{kt&&(ft[kt._id]=kt)}),L(kt=>({...kt,...ft}))})},[D?.user1_id,D?.user2_id,T]),O.useEffect(()=>{Hn.init({duration:500,once:!0,easing:"ease-out-cubic"})},[]);const he=(De,We="info")=>{const Je=Date.now();S(et=>[...et,{id:Je,message:De,type:We}])},Ae=De=>S(We=>We.filter(Je=>Je.id!==De)),xe=De=>i.current=De;O.useEffect(()=>{const De=async()=>{o(!0);try{const We=C.pathname==="/problem/potd"?"/problem/potd":`/problem/getParticularProblem?by=id&value=${e}`,Je=await jt.get(We);s(Je.data.problem);const et=Je.data.problem?.start_code.find(qe=>qe.language===u)?.initial_code||"";q(et)}catch{}finally{o(!1)}};e||C.pathname==="/problem/potd"?De():(c("No problem ID found in URL."),o(!1))},[e,C.pathname,u]);const Ee=async()=>{if(!D||!D.user2_id){he("Your partner has not joined yet.","info");return}const De=D.user1_id===D.current_driver?D.user2_id:D.user1_id,We=$d(Kd,"pair_sessions",t);await Da(We,{current_driver:De}),he("Roles switched!","success")},Be=async()=>{if(!i.current)return;const De=i.current.getValue(),We=$d(Kd,"pair_sessions",t);try{await Da(We,{code_content:De}),he("Code synced!","success")}catch(Je){console.error("Error syncing code:",Je),he("Failed to sync code","error")}},$e=async()=>{if(!i.current){he("Editor is not ready.","error");return}const De=i.current.getValue();if(!De.trim()){he("Cannot run empty code.","info");return}y(!0),w(null),he("Running your code...","info"),e=n._id;try{const We=await jt.post(`/code/run/${e}`,{code:De,language:u});if(w(We.data),We.data.success)he("Accepted!","success");else{const Je=We.data.errorMessage||"Some test cases failed.";he(Je,"error")}}catch(We){const Je=We.response?.data?.message||We.response?.data||"An unexpected server error occurred.";w({success:!1,testCases:[],errorMessage:Je}),he("Failed to run code.","error")}finally{y(!1)}},mt=async()=>{if(!i.current){he("Editor is not ready.","error");return}const De=i.current.getValue();if(!De.trim()){he("Cannot submit empty code.","info");return}y(!0),M(null),he("Submitting for final evaluation...","info");const Je=new URLSearchParams(C.search).get("contestId");console.log(n),e=n._id;try{const qe=(await jt.post(`/code/submit/${e}`,{code:De,language:u,contestId:Je})).data;if(qe.success?he("Code Accepted!","success"):he(qe.errorMessage||"Test cases failed.","error"),qe.success&&qe.contestId){he("Code Accepted! Now updating contest progress...","success");try{await jt.post(`/contest/${qe.contestId}/track-solve/${qe.problemId}`),sessionStorage.setItem(`solvedProblem_${qe.contestId}`,qe.problemId),setTimeout(()=>{r(`/contest/${qe.contestId}/arena`)},1500)}catch(ft){console.error("CRITICAL: Code was accepted but failed to track contest progress.",ft),he("Error updating contest progress. Please contact support.","error"),M(qe)}}else M(qe)}catch(et){console.error("Submission failed:",et);const qe=et.response?.data?.message||"An unexpected server error occurred.";M({success:!1,status:"server_error",errorMessage:qe}),he("Submission failed.","error")}finally{y(!1)}},dt=O.useRef(!1),ct=O.useRef(!1),ut=O.useRef(!1),me=O.useRef(0),_e=O.useRef(0),te=O.useRef(!1),J=async()=>{if(!t)return;const De=$d(Kd,"pair_sessions",t);try{await Da(De,{webrtc_offer:null,webrtc_answer:null,webrtc_ice_candidates_user1:[],webrtc_ice_candidates_user2:[]}),ct.current=!1,ut.current=!1,dt.current=!1,te.current=!1,me.current=0,_e.current=0,Z.current.clear(),await new Promise(We=>setTimeout(We,500))}catch(We){console.error("Error clearing WebRTC data:",We)}};O.useEffect(()=>{if(!E||!T?._id)return;const De=$d(Kd,"pair_sessions",t),We=CZ(De,async Je=>{if(Je.exists()){const et=Je.data();if(I(et),!(et.current_driver===T._id)&&i.current&&et.code_content!==i.current.getValue()&&q(et.code_content),et.user1_id!==T._id&&!et.user2_id){Da(De,{user2_id:T._id,user2_mic_on:!0});return}if(!et.user1_id||!et.user2_id)return;const ft=et.user1_id===T._id;if(!$&&!te.current){te.current=!0,await J();const kt={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}],sdpSemantics:"unified-plan"},Mt=new RTCPeerConnection(kt);Mt.ontrack=ye=>{F(ye.streams[0])},Mt.onicecandidate=ye=>{ye.candidate&&Da(De,{[ft?"webrtc_ice_candidates_user1":"webrtc_ice_candidates_user2"]:iO(ye.candidate.toJSON())}).catch(console.error)},Mt.onconnectionstatechange=()=>{Mt.connectionState==="failed"&&J().then(()=>{window.location.reload()})};try{const ye=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});X(ye);const He=ye.getAudioTracks(),tt=ye.getVideoTracks();[...He,...tt].forEach(xt=>{Mt.addTrack(xt,ye)})}catch(ye){console.error("🚫 Media access error:",ye),he("Microphone access denied. Voice chat disabled.","error")}se(Mt),ft&&setTimeout(async()=>{try{if(Mt.signalingState==="stable"){const ye=await Mt.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1,voiceActivityDetection:!1});await Mt.setLocalDescription(ye),await Da(De,{webrtc_offer:{type:ye.type,sdp:ye.sdp,timestamp:Date.now()}})}}catch(ye){console.error("❌ Error creating offer:",ye),he("Failed to create voice call offer","error")}},2e3);return}if($&&!dt.current){dt.current=!0;try{if(ft&&et.webrtc_answer&&!ut.current){const kt=et.webrtc_answer.timestamp||0;if(kt<=_e.current)return;if($.signalingState==="have-local-offer")try{await $.setRemoteDescription(new RTCSessionDescription(et.webrtc_answer)),ut.current=!0,_e.current=kt}catch(Mt){console.error("❌ SDP Error:",Mt),he("Voice connection failed. Please refresh.","error"),await J()}}else if(!ft&&et.webrtc_offer&&!ct.current){const kt=et.webrtc_offer.timestamp||0;if(kt<=me.current)return;if($.signalingState==="stable")try{await $.setRemoteDescription(new RTCSessionDescription(et.webrtc_offer)),ct.current=!0,me.current=kt;const Mt=await $.createAnswer({voiceActivityDetection:!1});await $.setLocalDescription(Mt),await Da(De,{webrtc_answer:{type:Mt.type,sdp:Mt.sdp,timestamp:Date.now()}})}catch(Mt){console.error("❌ SDP Error:",Mt),he("Voice connection failed. Please refresh.","error"),await J()}}if($.remoteDescription){const kt=ft?"webrtc_ice_candidates_user2":"webrtc_ice_candidates_user1";if(et[kt]&&Array.isArray(et[kt]))for(const Mt of et[kt]){const ye=JSON.stringify(Mt);if(!Z.current.has(ye))try{await $.addIceCandidate(new RTCIceCandidate(Mt)),Z.current.add(ye)}catch(He){console.warn("⚠️ ICE candidate error (safe to ignore):",He.message)}}}}catch(kt){console.error("❌ Signaling error:",kt),ct.current=!1,ut.current=!1}finally{dt.current=!1}}}else he("Pair session not found or has ended.","error"),r(`/problems/${e||"1"}`)});return()=>{We(),dt.current=!1}},[E,t,T,r,e,$]),O.useEffect(()=>{if(!E||!T?._id)return;const De=$d(Kd,"pair_sessions",t),We=async()=>{if(t)try{await Da(De,{webrtc_offer:null,webrtc_answer:null,webrtc_ice_candidates_user1:[],webrtc_ice_candidates_user2:[]}),Z.current.clear()}catch(et){console.error("Error clearing WebRTC data:",et)}},Je=CZ(De,async et=>{if(!et.exists()){he("Pair session not found or has ended.","error"),r(`/problems/${e||"1"}`);return}const qe=et.data();if(I(qe),!(qe.current_driver===T._id)&&i.current&&qe.code_content!==i.current.getValue()&&q(qe.code_content),qe.user1_id!==T._id&&!qe.user2_id){Da(De,{user2_id:T._id,user2_mic_on:!0});return}if(!(!qe.user1_id||!qe.user2_id)){if(!$&&!te.current){te.current=!0,await We();const kt={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302"]}],sdpSemantics:"unified-plan"},Mt=new RTCPeerConnection(kt);se(Mt),Mt.ontrack=ye=>{F(ye.streams[0])},Mt.onicecandidate=ye=>{if(ye.candidate){const He=qe.user1_id===T._id?"webrtc_ice_candidates_user1":"webrtc_ice_candidates_user2";Da(De,{[He]:iO(ye.candidate.toJSON())})}};try{const ye=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});X(ye),ye.getTracks().forEach(He=>Mt.addTrack(He,ye))}catch{he("Microphone access denied. Voice chat disabled.","error")}return}if($&&!dt.current){dt.current=!0;const kt=qe.user1_id===T._id;try{if(kt){if($.signalingState==="stable"&&!qe.webrtc_offer){const ye=await $.createOffer();await $.setLocalDescription(ye),await Da(De,{webrtc_offer:{type:ye.type,sdp:ye.sdp}})}qe.webrtc_answer&&$.signalingState==="have-local-offer"&&await $.setRemoteDescription(new RTCSessionDescription(qe.webrtc_answer))}else if(qe.webrtc_offer&&$.signalingState==="stable"){await $.setRemoteDescription(new RTCSessionDescription(qe.webrtc_offer));const ye=await $.createAnswer();await $.setLocalDescription(ye),await Da(De,{webrtc_answer:{type:ye.type,sdp:ye.sdp}})}const Mt=kt?"webrtc_ice_candidates_user2":"webrtc_ice_candidates_user1";if($.remoteDescription&&qe[Mt])for(const ye of qe[Mt]){const He=JSON.stringify(ye);Z.current.has(He)||(await $.addIceCandidate(new RTCIceCandidate(ye)),Z.current.add(He))}}catch(Mt){console.error("❌ Signaling Error:",Mt)}finally{dt.current=!1}}}});return()=>{Je(),$&&$.close(),Y&&Y.getTracks().forEach(et=>et.stop())}},[E,t,T,$]),O.useEffect(()=>()=>{$&&$.close(),Y&&Y.getTracks().forEach(De=>{De.stop()}),dt.current=!1,ct.current=!1,ut.current=!1,te.current=!1,me.current=0,_e.current=0},[]),O.useEffect(()=>{re&&ae.current&&(ae.current.srcObject=re,(()=>{const We=ae.current;if(We){We.muted=!ce;const Je=We.play();Je!==void 0&&Je.catch(et=>{console.warn("⚠️ Playback blocked. Waiting for user gesture..."),he("Click anywhere to enable audio","info");const qe=()=>{We.play().then(()=>{document.removeEventListener("click",qe)})};document.addEventListener("click",qe)})}})())},[re]),O.useEffect(()=>{ae.current&&(ae.current.muted=!ce)},[ce]);const ve=async()=>{if(!Y){he("Microphone not available","error");return}const De=!H;if(Y.getAudioTracks().forEach(We=>{We.enabled=!De}),ne(De),D&&t)try{const We=$d(Kd,"pair_sessions",t),Je=D.user1_id===T._id?"user1_mic_on":"user2_mic_on";await Da(We,{[Je]:!De})}catch(We){console.error("Error updating mic status:",We)}};O.useEffect(()=>{fe()},[t]),O.useEffect(()=>{if(!E||!D?.user1_id||!D?.user2_id||!T?._id)return;let De=$;if(!De){const Je={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302"]}]};De=new RTCPeerConnection(Je),se(De),navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(et=>{X(et),et.getTracks().forEach(qe=>De.addTrack(qe,et))}).catch(et=>he("Microphone access denied. Voice chat disabled.","error")),De.ontrack=et=>F(et.streams[0]),De.onicecandidate=et=>{if(et.candidate){const qe=$d(Kd,"pair_sessions",t),ft=D.user1_id===T._id?"webrtc_ice_candidates_user1":"webrtc_ice_candidates_user2";Da(qe,{[ft]:iO(et.candidate.toJSON())})}};return}(async()=>{const Je=D.user1_id===T._id;if(Je){if(De.signalingState==="stable"&&!De.localDescription){const qe=await De.createOffer();await De.setLocalDescription(qe);const ft=$d(Kd,"pair_sessions",t);await Da(ft,{webrtc_offer:{type:qe.type,sdp:qe.sdp}})}D.webrtc_answer&&De.signalingState==="have-local-offer"&&await De.setRemoteDescription(new RTCSessionDescription(D.webrtc_answer))}else if(D.webrtc_offer&&!De.localDescription&&(await De.setRemoteDescription(new RTCSessionDescription(D.webrtc_offer)),De.signalingState==="have-remote-offer")){const qe=await De.createAnswer();await De.setLocalDescription(qe);const ft=$d(Kd,"pair_sessions",t);await Da(ft,{webrtc_answer:{type:qe.type,sdp:qe.sdp}})}const et=Je?"webrtc_ice_candidates_user2":"webrtc_ice_candidates_user1";D[et]&&D[et].forEach(qe=>{const ft=JSON.stringify(qe);Z.current.has(ft)||(De.addIceCandidate(new RTCIceCandidate(qe)),Z.current.add(ft))})})().catch(Je=>console.error("Signaling Error:",Je))},[D,T,E,$,t,he]),O.useEffect(()=>{const De=()=>{ae.current&&ae.current.play().then(()=>console.log(" Playback allowed after user interaction")).catch(We=>console.warn("⚠️ Still failed:",We)),window.removeEventListener("click",De)};return window.addEventListener("click",De),()=>window.removeEventListener("click",De)},[]);const Me=()=>{ie(De=>!De)},W=()=>{if(i.current&&n){const De=n.start_code.find(We=>We.language===u)?.initial_code||"";i.current.setValue(De),he("Code has been reset to default.","info")}},Se=()=>{let De=n.serial_number;if(De===1&&(De=20),!e){c("No problem ID found in URL."),o(!1);return}(async()=>{o(!0),c("");try{const Je=await jt.get(`/problem/getParticularProblem?by=serial&value=${De-1}`);s(Je.data.problem)}catch(Je){s(null),c(Je.message||"Failed to fetch problem. It may not exist.")}finally{o(!1)}})()},ze=()=>{let De=n.serial_number;if(De===20&&(De=1),!e){c("No problem ID found in URL."),o(!1);return}(async()=>{o(!0),c("");try{const Je=await jt.get(`/problem/getParticularProblem?by=serial&value=${De+1}`);s(Je.data.problem)}catch(Je){s(null),c(Je.message||"Failed to fetch problem. It may not exist.")}finally{o(!1)}})()},Ue=()=>{const De=Math.floor(Math.random()*20)+1;if(!e){c("No problem ID found in URL."),o(!1);return}(async()=>{o(!0),c("");try{const Je=await jt.get(`/problem/getParticularProblem?by=serial&value=${De+1}`);s(Je.data.problem)}catch(Je){s(null),c(Je.message||"Failed to fetch problem. It may not exist.")}finally{o(!1)}})()};O.useEffect(()=>{const De=window.document.documentElement;f?De.classList.add("dark"):De.classList.remove("dark")},[f]);const Ne=()=>m(!f);return a?h.jsx("div",{className:"flex justify-center items-center h-screen bg-[#1E1E1E] text-white",children:h.jsx(HP,{className:"h-8 w-8 animate-spin"})}):l?h.jsx("div",{className:"flex justify-center items-center h-screen bg-[#1E1E1E] text-white",children:h.jsxs(kp,{className:"p-6 text-center bg-[#282828] border-gray-700",children:[h.jsx(Dh,{className:"h-10 w-10 text-red-500 mx-auto mb-2"}),h.jsx("h3",{className:"font-semibold text-xl",children:"Error"}),h.jsx("p",{className:"text-muted-foreground",children:l}),h.jsx(hr,{to:"/problems",children:h.jsx(Fn,{variant:"outline",className:"mt-4",children:"Back to List"})})]})}):n?h.jsxs(h.Fragment,{children:[h.jsx(iwt,{toasts:_,removeToast:Ae}),P&&h.jsx(lwt,{result:P,onClose:()=>M(null)}),h.jsxs("div",{className:"h-screen bg-white dark:bg-[#1E1E1E] text-neutral-800 dark:text-white flex flex-col",children:[h.jsxs("header",{className:"h-14 border-b-2 border-neutral-200 dark:border-neutral-900 bg-white dark:bg-neutral-800 px-4 flex items-center justify-between","data-aos":"fade-down",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"flex",children:h.jsx(hr,{to:"/",className:"btn btn-ghost text-2xl font-bold text-neutral-800 dark:text-neutral-200 gap-2",children:h.jsx("img",{src:nD,className:"w-10 h-10",alt:"CodeG Logo"})})}),h.jsxs(hr,{to:"/problems",className:"hidden sm:flex items-center gap-2 text-sm font-medium text-neutral-600 hover:text-neutral-900 dark:text-neutral-400 dark:hover:text-white transition-colors",children:[h.jsx(Eh,{className:"h-5 w-5"}),"Problem List"]}),h.jsxs("div",{className:"hidden sm:flex items-center text-neutral-500 dark:text-neutral-400",children:[h.jsx(Fn,{variant:"ghost",size:"icon",onClick:Se,disabled:parseInt(e,10)<=1,children:h.jsx(ife,{className:"h-5 w-5"})}),h.jsx(Fn,{variant:"ghost",size:"icon",onClick:ze,children:h.jsx(Ky,{className:"h-5 w-5"})}),h.jsx(Fn,{variant:"ghost",size:"icon",onClick:Ue,children:h.jsx(lfe,{className:"h-4 w-4"})})]})]}),h.jsxs("div",{className:"flex-1 flex justify-center items-center gap-4 relative",children:[h.jsxs("div",{className:"relative group",children:[h.jsx(Fn,{className:`
                px-4 py-2 font-medium rounded-md
                transition-all duration-200 ease-in-out
                ${v?"bg-neutral-300 dark:bg-neutral-500 text-neutral-600 dark:text-neutral-300 cursor-wait":E&&!G?"bg-neutral-100 text-neutral-800 dark:bg-neutral-600 dark:text-neutral-200 cursor-not-allowed opacity-50":"bg-neutral-100 text-neutral-800 hover:bg-neutral-200 dark:bg-neutral-600 dark:text-neutral-200 dark:hover:bg-neutral-700"}
            `,onClick:$e,disabled:v||E&&!G,children:h.jsxs("div",{className:"flex items-center gap-2",children:[v?h.jsx(HP,{className:"h-4 w-4 animate-spin"}):h.jsx(jD,{className:"h-4 w-4"}),h.jsx("span",{children:"Run"})]})}),E&&!G&&h.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1 bg-black dark:bg-gray-800 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-10",children:["Only driver can run code",h.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-black dark:border-t-gray-800"})]})]}),h.jsxs("div",{className:"relative group",children:[h.jsx(Fn,{onClick:mt,disabled:v||E&&!G,className:`
                px-4 py-2 font-medium rounded-md
                transition-all duration-200 ease-in-out
                ${v||E&&!G?"bg-green-600 text-white cursor-not-allowed opacity-50":"bg-green-600 hover:bg-green-700 text-white"}
            `,children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(sm,{className:"h-4 w-4"}),h.jsx("span",{children:"Submit"})]})}),E&&!G&&h.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1 bg-black dark:bg-gray-800 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-10",children:["Only driver can submit code",h.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-black dark:border-t-gray-800"})]})]})]}),h.jsxs("div",{className:"mr-8 flex items-center gap-4",children:[h.jsx(Fn,{variant:"ghost",size:"icon",onClick:Ne,className:"text-neutral-500 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700",children:f?h.jsx(cfe,{className:"h-8 w-8"}):h.jsx(sfe,{className:"h-8 w-8"})}),h.jsx(ffe,{user:T})]})]}),h.jsx("main",{className:"flex-1 flex min-h-0","data-aos":"fade-in","data-aos-delay":"200",children:h.jsxs(s6,{direction:"horizontal",children:[h.jsx(Ow,{defaultSize:50,minSize:30,children:h.jsxs("div",{className:"flex flex-col h-full",children:[h.jsx("div",{className:"flex-grow overflow-auto",children:h.jsx(swt,{problem:n},n._id)}),E&&D&&h.jsx("div",{className:"flex-shrink-0  border-t border-neutral-200 dark:border-neutral-700/80",children:h.jsx(ewt,{sessionData:D,participantDetails:j})})]})})," ",h.jsx(a6,{className:"w-1.5 bg-neutral-200 dark:bg-gray-700/60 hover:bg-neutral-400 dark:hover:bg-sky-800 transition-colors"}),h.jsx(Ow,{defaultSize:50,minSize:30,children:h.jsxs(s6,{direction:"vertical",children:[h.jsxs(Ow,{defaultSize:65,minSize:20,className:"flex flex-col bg-[#1E1E1E]",children:[E&&D&&h.jsxs(h.Fragment,{children:[h.jsx(twt,{sessionData:D,isDriver:G,handleSwitchRoles:Ee,handleSyncCode:Be,addToast:he,sessionId:t,participantDetails:j,isMuted:H,isSpeakerOn:ce,handleToggleMute:ve,handleToggleSpeaker:Me,currentUser:T}),h.jsx("audio",{ref:ae,autoPlay:!0,playsInline:!0,muted:!ce})]}),h.jsxs("header",{className:"h-14 border-b border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900 px-4 flex items-center justify-between flex-shrink-0",children:[h.jsx("div",{className:"flex items-center gap-4",children:h.jsx(JD,{defaultValue:"code",children:h.jsx(eN,{className:"bg-transparent p-0",children:h.jsxs(Vl,{value:"code",className:"flex items-center gap-2 rounded-md px-3 py-1.5 text-sm transition-colors text-neutral-600 hover:text-neutral-900 data-[state=active]:bg-white data-[state=active]:text-neutral-900 data-[state=active]:shadow-sm dark:text-neutral-400 dark:hover:text-white dark:data-[state=active]:bg-neutral-800 dark:data-[state=active]:text-white",children:[h.jsx(sl,{className:"h-4 w-4"})," Code"]})})})}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Fn,{variant:"ghost",size:"icon",onClick:W,className:"text-neutral-500 hover:text-neutral-800 dark:text-neutral-400 dark:hover:text-white",children:h.jsx($ot,{className:"h-4 w-4"})}),h.jsx(nwt,{language:u,setLanguage:d,availableLanguages:n.start_code})]})]}),h.jsx("div",{className:"flex-1 min-h-0",children:h.jsx(awt,{language:u,isDark:f,onMount:xe,code:B,onCodeChange:q,readOnly:E&&!G})})]}),h.jsx(a6,{className:"h-1.5 bg-neutral-200 dark:bg-gray-700/60 hover:bg-neutral-400 dark:hover:bg-sky-800 transition-colors"}),h.jsx(Ow,{defaultSize:35,minSize:20,children:h.jsx(owt,{testcases:n.visible_testcase,isRunning:v,testResults:x})})]})})]})})]})]}):null},cwt=({role:e,text:t,timestamp:r})=>{const i=e==="user",[n,s]=O.useState(!1),a=async d=>{try{await navigator.clipboard.writeText(d),s(!0),setTimeout(()=>s(!1),2e3)}catch(f){console.error("Failed to copy:",f)}},o=i?"bg-gray-100 dark:bg-slate-800":"bg-white dark:bg-slate-700 shadow-sm",l="w-10 h-10 rounded-full flex items-center justify-center shadow-md flex-shrink-0",c=i?"bg-blue-500 text-white":"bg-gray-800 text-white",u=()=>h.jsx("div",{className:`${l} ${c}`,children:i?h.jsx(ufe,{size:18}):h.jsx(RD,{size:18})});return i?h.jsxs("div",{className:"flex items-start gap-4 group","data-aos":"fade-up",children:[h.jsx(u,{}),h.jsxs("div",{className:"flex flex-col w-full",children:[h.jsxs("div",{className:`relative rounded-lg border dark:border-slate-700 ${o}`,children:[h.jsxs("div",{className:"flex items-center justify-between bg-gray-200 dark:bg-slate-900/50 text-gray-600 dark:text-gray-300 px-4 py-2 rounded-t-lg",children:[h.jsx("span",{className:"text-sm font-semibold",children:"Your Code Submission"}),h.jsx("button",{onClick:()=>a(t),className:"p-1.5 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600",title:"Copy code",children:n?h.jsx(sm,{size:14,className:"text-green-500"}):h.jsx(ID,{size:14})})]}),h.jsx("pre",{className:"text-gray-800 dark:text-gray-100 p-4 overflow-x-auto bg-gray-50 dark:bg-slate-800 rounded-b-lg",children:h.jsx("code",{className:"font-mono text-sm ",children:t})})]}),r&&h.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:new Date(r).toLocaleTimeString()})]})]}):h.jsxs("div",{className:"flex items-start gap-4 group","data-aos":"fade-up",children:[h.jsx(u,{}),h.jsxs("div",{className:"flex flex-col w-full",children:[h.jsx("div",{className:`relative rounded-lg p-5 border dark:border-transparent ${o}`,children:h.jsx(Hge,{remarkPlugins:[f0e],components:{h2:({children:d})=>h.jsx("h2",{className:"text-lg font-semibold mb-3 border-b dark:border-slate-600 pb-2 flex items-center gap-2",children:d}),p:({children:d})=>h.jsx("p",{className:"mb-3 leading-relaxed text-gray-700 dark:text-gray-300",children:d}),ul:({children:d})=>h.jsx("ul",{className:"list-disc list-inside mb-3 space-y-2 pl-4",children:d}),strong:({children:d})=>h.jsx("strong",{className:"font-semibold text-gray-900 dark:text-white",children:d}),code:({children:d})=>h.jsx("code",{className:"bg-gray-200 dark:bg-slate-600 px-1.5 py-1 rounded font-mono text-sm text-pink-500 dark:text-pink-400",children:d})},children:t})}),r&&h.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:new Date(r).toLocaleTimeString()})]})]})},uwt=({messages:e,isLoading:t})=>{const r=O.useRef(null);return O.useEffect(()=>{r.current?.scrollIntoView({behavior:"smooth"})},[e,t]),h.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[e.map((i,n)=>h.jsx(cwt,{role:i.role,text:i.parts[0].text,timestamp:i.timestamp},n)),t&&h.jsxs("div",{className:"flex items-start gap-4","data-aos":"fade-in",children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center shadow-md flex-shrink-0",children:h.jsx(RD,{size:18,className:"text-white"})}),h.jsx("div",{className:"bg-white dark:bg-slate-700 rounded-lg p-4 w-full border dark:border-transparent",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("div",{className:"flex space-x-1.5",children:[h.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce"}),h.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce [animation-delay:0.1s]"}),h.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce [animation-delay:0.2s]"})]}),h.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"AI is analyzing..."})]})})]}),h.jsx("div",{ref:r})]})},dwt=({onAnalyzeCode:e,isLoading:t})=>{const[r,i]=O.useState(`// Example: Fibonacci sequence
function fibonacci(n) {
  if (n <= 1) {
    return n;
  }
  return fibonacci(n - 1) + fibonacci(n - 2);
}`),[n,s]=O.useState("light");O.useEffect(()=>{const o=window.matchMedia("(prefers-color-scheme: dark)");s(o.matches?"vs-dark":"light");const l=c=>s(c.matches?"vs-dark":"light");return o.addEventListener("change",l),()=>o.removeEventListener("change",l)},[]);const a=()=>{r.trim()&&e(r)};return h.jsxs("div",{className:"h-full flex flex-col bg-white dark:bg-slate-800 border-r border-gray-200 dark:border-slate-700",children:[h.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 flex-shrink-0",children:[h.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[h.jsx(sl,{size:20}),"Code to Analyze"]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Paste your algorithm or function below."})]}),h.jsx("div",{className:"flex-1 p-4 flex flex-col min-h-0",children:h.jsx("div",{className:"border border-gray-300 dark:border-slate-600 rounded-lg overflow-hidden h-full",children:h.jsx(fS,{height:"100%",language:"javascript",theme:n,value:r,onChange:o=>i(o||""),options:{minimap:{enabled:!1},fontSize:14,wordWrap:"on",scrollBeyondLastLine:!1,automaticLayout:!0}})})}),h.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-slate-700 flex-shrink-0",children:h.jsx("button",{type:"button",onClick:a,className:"w-full flex items-center justify-center gap-2 py-3 px-4 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 transition-all shadow-md disabled:bg-gray-500 disabled:cursor-not-allowed transform hover:scale-105 active:scale-100",disabled:t||!r.trim(),children:t?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Analyzing..."]}):h.jsxs(h.Fragment,{children:[h.jsx(YP,{size:18}),"Analyze Complexity"]})})})]})};function hwt(){const{user:e}=ho(o=>o.auth),[t,r]=O.useState([]),[i,n]=O.useState(!1);O.useEffect(()=>{Hn.init({duration:800,once:!1})},[]),O.useEffect(()=>{e?.subscribed&&r([{role:"model",parts:[{text:`## Welcome to the AI TSC Assistant! 🚀

I'm ready to analyze the time and space complexity of your code. Just paste your code into the editor on the left and click **"Analyze Complexity"** to get started.`}],timestamp:new Date().toISOString()}])},[e]);const s=async o=>{const l={role:"user",parts:[{text:o}],timestamp:new Date().toISOString()},c=[...t,l];r(c),n(!0);try{const u=await jt.post("/ai/assist",{messages:[{role:"user",parts:[{text:o}]}]});a(u.data.analysis)}catch(u){console.error("API Error:",u);const d=u.response?.data?.message||"Sorry, an unexpected error occurred. Please try again later.";r(f=>[...f,{role:"model",parts:[{text:`❌ **Error:** ${d}`}],timestamp:new Date().toISOString()}])}finally{n(!1)}},a=o=>{const l=o.split(`
`);let c="",u=0;const d=setInterval(()=>{if(u>=l.length){clearInterval(d);return}c+=l[u]+`
`,r(f=>{const m=[...f],v=m[m.length-1];return v&&v.role==="model"&&v.streaming?(v.parts[0].text=c,[...m.slice(0,-1),v]):[...m,{role:"model",parts:[{text:c}],timestamp:new Date().toISOString(),streaming:!0}]}),u++},120)};return e?e?.subscribed===!1?h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-800 p-4 transition-colors",children:h.jsx("div",{"data-aos":"zoom-in-up",className:"card w-full max-w-md bg-white/80 dark:bg-slate-900/60 backdrop-blur-sm border border-gray-200 dark:border-slate-700 shadow-2xl transition-all hover:border-primary/40",children:h.jsxs("div",{className:"card-body items-center text-center p-8",children:[h.jsx(Kat,{className:"w-16 h-16 text-amber-400 mb-4"}),h.jsx("h2",{className:"card-title text-3xl font-bold mb-2 text-slate-800 dark:text-white",children:"Unlock TSC Assistant"}),h.jsx("p",{className:"text-slate-600 dark:text-slate-300 mb-8",children:"Subscribe to get instant AI-powered time & space complexity analysis for your code."}),h.jsxs("ul",{className:"text-sm text-left space-y-3 mb-8 w-full",children:[h.jsxs("li",{className:"flex items-center gap-3 text-slate-700 dark:text-slate-200",children:[h.jsx(ka,{className:"w-5 h-5 text-primary shrink-0"}),h.jsx("span",{children:"Accurate Big-O analysis in milliseconds"})]}),h.jsxs("li",{className:"flex items-center gap-3 text-slate-700 dark:text-slate-200",children:[h.jsx(ka,{className:"w-5 h-5 text-primary shrink-0"}),h.jsx("span",{children:"Line-by-line space complexity breakdown"})]}),h.jsxs("li",{className:"flex items-center gap-3 text-slate-700 dark:text-slate-200",children:[h.jsx(ka,{className:"w-5 h-5 text-primary shrink-0"}),h.jsx("span",{children:"Handles complex algorithms and data structures"})]})]}),h.jsx(hr,{to:"/payment",children:h.jsx("button",{className:"btn btn-primary w-full max-w-xs shadow-lg transform hover:scale-105 transition-transform",children:"Subscribe Now"})})]})})}):h.jsxs("div",{className:"grid grid-cols-1  md:grid-cols-2 h-screen w-screen bg-gray-100 dark:bg-slate-900",children:[h.jsx("div",{"data-aos":"fade-right","data-aos-duration":"1000",children:h.jsx(dwt,{onAnalyzeCode:s,isLoading:i})}),h.jsxs("div",{className:"h-full flex flex-col","data-aos":"fade-left","data-aos-duration":"1000","data-aos-delay":"200",children:[h.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-slate-700 bg-white dark:bg-slate-800 flex-shrink-0",children:[h.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[h.jsx(dS,{size:20,className:"text-blue-500"}),"AI Analysis"]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Results of your code complexity analysis will appear here."})]}),h.jsx(uwt,{messages:t,isLoading:i})]})]}):h.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-10",children:h.jsx(yb,{message:"You need to be logged in for analyze the code complexity "})})}function fwt(){const{user:e}=ho(r=>r.auth);(async()=>{try{const{data:r}=await jt.post("/pay/create-order");if(!window.Razorpay)throw new Error("Razorpay SDK not loaded. Please add the script tag to your HTML.");const i={key:r.key_id||"rzp_test_P8uCvfKO1wc0hd",amount:r.amount,currency:r.currency||"INR",name:"CodeG",description:"Lifetime Unlock",order_id:r.id,handler:async function(s){try{const a=await jt.post("/pay/verify-payment",{razorpay_order_id:s.razorpay_order_id,razorpay_payment_id:s.razorpay_payment_id,razorpay_signature:s.razorpay_signature});alert(a.data.message),window.location.reload()}catch(a){console.error("Payment verification failed:",a),alert("Payment verification failed. Please contact support.")}},modal:{ondismiss:function(){}},prefill:{name:e?.first_name||"",email:e?.email_id||""},theme:{color:"#0B1120"}},n=new window.Razorpay(i);n.on("payment.failed",function(s){console.error("Payment failed:",s.error),alert(`Payment failed: ${s.error.description}`)}),n.open()}catch(r){if(r.response){const i=r.response.data;console.error("Server error:",i),alert(`Error: ${i.message||"Server error occurred"}`)}else r.request?(console.error("Network error:",r.request),alert("Network error. Please check your connection and try again.")):(console.error("Error:",r.message),alert(`Error: ${r.message}`))}})()}function pwt(){const[e,t]=O.useState([]),[r,i]=O.useState(""),[n,s]=O.useState([]),[a,o]=O.useState(!0),[l,c]=O.useState(null),[u,d]=O.useState("grid"),[f,m]=O.useState(null),[v,y]=O.useState(""),[x,w]=O.useState({message:"",type:""});fs(),O.useEffect(()=>{Hn.init({duration:800,once:!1})},[]),O.useEffect(()=>{(async()=>{try{o(!0);const C=await jt.get("/problem/getAllProblem");t(C.data.problem)}catch(C){c(C.message||"Failed to fetch problems.")}finally{o(!1)}})()},[]),O.useEffect(()=>{const M=r.toLowerCase(),C=e.filter(T=>T.title.toLowerCase().includes(M)||String(T.serial_number).includes(M));s(C)},[r,e]),O.useEffect(()=>{if(x.message){const M=setTimeout(()=>w({message:"",type:""}),4e3);return()=>clearTimeout(M)}},[x]);const _=async()=>{if(!f||String(v)!==String(f.serial_number)){w({message:"Serial number does not match. Deletion cancelled.",type:"error"});return}try{await jt.delete(`/video/delete?by=problem&value=${f._id}`),t(M=>M.filter(C=>C._id!==f._id)),w({message:`Problem "${f.title}" deleted successfully.`,type:"success"})}catch(M){w({message:M.response?.data?.message||"Deletion failed.",type:"error"})}finally{m(null),y("")}},S=M=>{switch(M.toLowerCase()){case"easy":return"badge-success";case"medium":return"badge-warning";case"hard":return"badge-error";default:return"badge-neutral"}},P=()=>a?h.jsx("div",{className:"flex justify-center items-center min-h-[300px]",children:h.jsx("span",{className:"loading loading-spinner loading-lg text-primary"})}):l?h.jsx("div",{className:"alert alert-error shadow-xl",children:l}):n.length===0?h.jsx("div",{className:"text-center py-20",children:h.jsx("h2",{className:"text-xl font-semibold text-base-content/70",children:e.length?"No matching problems.":"No problems available."})}):u==="grid"?h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:n.map(M=>h.jsxs("div",{className:"group relative",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-secondary rounded-xl blur-sm opacity-10 group-hover:opacity-30 transition-all duration-300"}),h.jsx("div",{className:"relative card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"flex justify-between items-center mb-3",children:[h.jsxs("div",{className:"badge badge-outline font-bold",children:["#",M.serial_number]}),h.jsx("div",{className:`badge ${S(M.difficulty)} font-semibold`,children:M.difficulty})]}),h.jsx("h2",{className:"card-title line-clamp-2 text-lg mb-2",children:M.title}),h.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:M.tags.split(",").map((C,T)=>h.jsx("span",{className:"badge badge-ghost badge-sm bg-base-200/50 border border-base-300/20",children:C.trim()},T))}),h.jsxs("div",{className:"card-actions justify-end gap-2",children:[h.jsx(hj,{to:`/admin/video/upload/${M._id}`,className:"btn btn-primary btn-sm text-white",children:"Upload"}),h.jsxs("button",{className:"btn btn-error btn-sm text-white",onClick:()=>m(M),children:[h.jsx(Ic,{size:14})," Delete"]})]})]})})]},M._id))}):h.jsx("div",{className:"overflow-x-auto rounded-lg border border-base-300",children:h.jsxs("table",{className:"table w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"S.No."}),h.jsx("th",{children:"Title"}),h.jsx("th",{children:"Difficulty"}),h.jsx("th",{children:"Action"})]})}),h.jsx("tbody",{children:n.map(M=>h.jsxs("tr",{className:"hover:bg-base-200/30",children:[h.jsxs("td",{className:"font-bold text-primary",children:["#",M.serial_number]}),h.jsx("td",{className:"font-semibold max-w-sm truncate",children:M.title}),h.jsx("td",{children:h.jsx("div",{className:`badge ${S(M.difficulty)}`,children:M.difficulty})}),h.jsxs("td",{className:"space-x-2 text-right",children:[h.jsx(hj,{to:`/admin/video/upload/${M._id}`,className:"btn btn-sm bg-primary text-white",children:"Upload"}),h.jsxs("button",{className:"btn btn-error btn-sm text-white",onClick:()=>m(M),children:[h.jsx(Ic,{size:14})," Delete"]})]})]},M._id))})]})});return h.jsxs("div",{className:"relative min-h-screen bg-base-100 p-4 sm:p-8 overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto space-y-8",children:[h.jsxs("div",{className:"text-center space-y-4 pt-10","data-aos":"fade-down",children:[h.jsx("h1",{className:"text-4xl font-extrabold bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent",children:"🎬 Video Library"}),h.jsx("p",{className:"text-base-content/70",children:"Upload and manage problem video solutions"}),h.jsxs("div",{className:"mt-4 inline-block bg-base-100/70 backdrop-blur-md px-6 py-4 rounded-xl border border-base-300/20 shadow",children:[h.jsx("div",{className:"text-sm text-base-content/60",children:"Total Problems"}),h.jsx("div",{className:"text-3xl font-bold text-primary",children:h.jsx(_c,{from:0,to:e.length,separator:",",direction:"up",duration:2,className:"count-up-text"})})]})]}),h.jsx("div",{"data-aos":"fade-up",children:h.jsx("div",{className:"card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20",children:h.jsx("div",{className:"card-body",children:h.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[h.jsx("div",{className:"form-control w-full max-w-md",children:h.jsxs("div",{className:"relative",children:[h.jsx(Wh,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-base-content/50",size:18}),h.jsx("input",{type:"text",className:"input input-bordered pl-10 bg-base-100/50 border-base-300/20 focus:border-primary/50",placeholder:"Search by title or S.No...",value:r,onChange:M=>i(M.target.value)})]})}),h.jsxs("div",{className:"join",children:[h.jsxs("button",{className:`btn join-item ${u==="grid"?"btn-primary text-white":"btn-outline"}`,onClick:()=>d("grid"),children:[h.jsx(OD,{size:16})," Grid"]}),h.jsxs("button",{className:`btn join-item ${u==="table"?"btn-primary text-white":"btn-outline"}`,onClick:()=>d("table"),children:[h.jsx(Eh,{size:16})," Table"]})]})]})})})}),h.jsx("main",{children:P()})]}),h.jsx("input",{type:"checkbox",id:"delete-confirm-modal",className:"modal-toggle",checked:!!f,readOnly:!0}),h.jsx("div",{className:"modal modal-bottom sm:modal-middle",children:h.jsxs("div",{className:"modal-box border-purple-200/30 dark:border-purple-600/30",children:[h.jsx("div",{className:"w-16 h-16 bg-purple-100 dark:bg-purple-900/30 rounded-full mx-auto mb-4 flex items-center justify-center",children:h.jsx(ZV,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})}),h.jsx("h3",{className:"font-bold text-lg text-center text-purple-700 dark:text-purple-300",children:"Confirm Deletion"}),h.jsx("p",{className:"py-2 text-center text-sm text-base-content/70",children:"This action is irreversible. To confirm, please type the serial number of the problem."}),h.jsx("p",{className:"text-center font-mono text-lg p-2 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-md border border-purple-200 dark:border-purple-600/30",children:f?.serial_number}),h.jsx("div",{className:"form-control mt-4",children:h.jsx("input",{type:"text",className:"input input-bordered w-full text-center font-bold border-purple-300 focus:border-purple-500 focus:ring-2 focus:ring-purple-200",placeholder:"Type serial number here...",value:v,onChange:M=>y(M.target.value)})}),h.jsxs("div",{className:"modal-action justify-center gap-4",children:[h.jsx("button",{className:"btn btn-ghost border-purple-300 hover:bg-purple-50 dark:hover:bg-purple-900/20",onClick:()=>{m(null),y("")},children:"Cancel"}),h.jsxs("button",{className:"btn bg-red-600 hover:bg-red-700 text-white border-red-600 hover:border-red-700",onClick:_,disabled:String(v)!==String(f?.serial_number),children:[h.jsx(Ic,{size:14})," Yes, Delete It"]})]})]})}),x.message&&h.jsx("div",{className:"toast toast-top toast-center min-w-max z-50",children:h.jsx("div",{className:`alert ${x.type==="success"?"alert-success bg-purple-100 border-purple-300 text-purple-700":"alert-error"}`,children:h.jsx("span",{children:x.message})})})]})}function mwt(){const{problemId:e}=Qp(),[t,r]=O.useState(!1),[i,n]=O.useState(0),[s,a]=O.useState(null),{register:o,handleSubmit:l,watch:c,formState:{errors:u},reset:d,setError:f,clearErrors:m}=$c(),v=c("videoFile")?.[0],y=async _=>{const S=_.videoFile[0];r(!0),n(0),m();try{const P=await jt.get(`/video/create/${e}`),{signature:M,timestamp:C,public_id:T,api_key:E,cloud_name:N,upload_url:D}=P.data,I=new FormData;I.append("file",S),I.append("signature",M),I.append("timestamp",C),I.append("public_id",T),I.append("api_key",E);const L=(await xn.post(D,I,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:q=>{const G=Math.round(q.loaded*100/q.total);n(G)}})).data,B=await jt.post("/video/save",{problemId:e,cloudinaryPublicId:L.public_id,secureUrl:L.secure_url,duration:L.duration});a(B.data.videoSolution),d()}catch(P){console.error("Upload error:",P),f("root",{type:"manual",message:P.response?.data?.message||"Upload failed. Please try again."})}finally{r(!1),n(0)}},x=_=>{if(_===0)return"0 Bytes";const S=1024,P=["Bytes","KB","MB","GB"],M=Math.floor(Math.log(_)/Math.log(S));return parseFloat((_/Math.pow(S,M)).toFixed(2))+" "+P[M]},w=_=>{const S=Math.floor(_/60),P=Math.floor(_%60);return`${S}:${P.toString().padStart(2,"0")}`};return h.jsxs("div",{className:"max-w-md mx-auto p-6",children:[h.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsx("div",{className:"card bg-base-100 shadow-xl",children:h.jsxs("div",{className:"card-body",children:[h.jsx("h2",{className:"card-title",children:"Upload Video"}),h.jsxs("form",{onSubmit:l(y),className:"space-y-4",children:[h.jsxs("div",{className:"form-control w-full",children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text",children:"Choose video file"})}),h.jsx("input",{type:"file",accept:"video/*",...o("videoFile",{required:"Please select a video file",validate:{isVideo:_=>!_||!_[0]?"Please select a video file":_[0].type.startsWith("video/")||"Please select a valid video file",fileSize:_=>{if(!_||!_[0])return!0;const S=_[0],P=100*1024*1024;return S.size<=P||"File size must be less than 100MB"}}}),className:`file-input file-input-bordered w-full ${u.videoFile?"file-input-error":""}`,disabled:t}),u.videoFile&&h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text-alt text-error",children:u.videoFile.message})})]}),v&&h.jsx("div",{className:"alert alert-info",children:h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold",children:"Selected File:"}),h.jsx("p",{className:"text-sm",children:v.name}),h.jsxs("p",{className:"text-sm",children:["Size: ",x(v.size)]})]})}),t&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex justify-between text-sm",children:[h.jsx("span",{children:"Uploading..."}),h.jsxs("span",{children:[i,"%"]})]}),h.jsx("progress",{className:"progress progress-primary w-full",value:i,max:"100"})]}),u.root&&h.jsx("div",{className:"alert alert-error",children:h.jsx("span",{children:u.root.message})}),s&&h.jsx("div",{className:"alert alert-success",children:h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold",children:"Upload Successful!"}),h.jsxs("p",{className:"text-sm",children:["Duration: ",w(s.duration)]}),h.jsxs("p",{className:"text-sm",children:["Uploaded: ",new Date(s.uploadedAt).toLocaleString()]})]})}),h.jsx("div",{className:"card-actions justify-end",children:h.jsx("button",{type:"submit",disabled:t,className:`btn btn-primary ${t?"loading":""}`,children:t?"Uploading...":"Upload Video"})})]})]})})]})}const p0e=6048e5,gwt=864e5,m0e=6e4,g0e=36e5,GC=43200,jte=1440,Lte=Symbol.for("constructDateFrom");function ud(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Lte in e?e[Lte](t):e instanceof Date?new e.constructor(t):new Date(t)}function hs(e,t){return ud(t||e,e)}let vwt={};function SS(){return vwt}function S_(e,t){const r=SS(),i=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,n=hs(e,t?.in),s=n.getDay(),a=(s<i?7:0)+s-i;return n.setDate(n.getDate()-a),n.setHours(0,0,0,0),n}function u3(e,t){return S_(e,{...t,weekStartsOn:1})}function v0e(e,t){const r=hs(e,t?.in),i=r.getFullYear(),n=ud(r,0);n.setFullYear(i+1,0,4),n.setHours(0,0,0,0);const s=u3(n),a=ud(r,0);a.setFullYear(i,0,4),a.setHours(0,0,0,0);const o=u3(a);return r.getTime()>=s.getTime()?i+1:r.getTime()>=o.getTime()?i:i-1}function d3(e){const t=hs(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function fN(e,...t){const r=ud.bind(null,e||t.find(i=>typeof i=="object"));return t.map(r)}function zte(e,t){const r=hs(e,t?.in);return r.setHours(0,0,0,0),r}function ywt(e,t,r){const[i,n]=fN(r?.in,e,t),s=zte(i),a=zte(n),o=+s-d3(s),l=+a-d3(a);return Math.round((o-l)/gwt)}function xwt(e,t){const r=v0e(e,t),i=ud(e,0);return i.setFullYear(r,0,4),i.setHours(0,0,0,0),u3(i)}function WT(e,t){const r=+hs(e)-+hs(t);return r<0?-1:r>0?1:r}function bwt(e){return ud(e,Date.now())}function wwt(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function _wt(e){return!(!wwt(e)&&typeof e!="number"||isNaN(+hs(e)))}function Swt(e,t,r){const[i,n]=fN(r?.in,e,t),s=i.getFullYear()-n.getFullYear(),a=i.getMonth()-n.getMonth();return s*12+a}function Ewt(e){return t=>{const i=(e?Math[e]:Math.trunc)(t);return i===0?0:i}}function Awt(e,t){return+hs(e)-+hs(t)}function Cwt(e,t){const r=hs(e,t?.in);return r.setHours(23,59,59,999),r}function Twt(e,t){const r=hs(e,t?.in),i=r.getMonth();return r.setFullYear(r.getFullYear(),i+1,0),r.setHours(23,59,59,999),r}function Mwt(e,t){const r=hs(e,t?.in);return+Cwt(r,t)==+Twt(r,t)}function Pwt(e,t,r){const[i,n,s]=fN(r?.in,e,e,t),a=WT(n,s),o=Math.abs(Swt(n,s));if(o<1)return 0;n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-a*o);let l=WT(n,s)===-a;Mwt(i)&&o===1&&WT(i,s)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function Dwt(e,t,r){const i=Awt(e,t)/1e3;return Ewt(r?.roundingMethod)(i)}function Nwt(e,t){const r=hs(e,t?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const kwt={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Rwt=(e,t,r)=>{let i;const n=kwt[e];return typeof n=="string"?i=n:t===1?i=n.one:i=n.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+i:i+" ago":i};function sj(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Iwt={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Owt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},jwt={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Lwt={date:sj({formats:Iwt,defaultWidth:"full"}),time:sj({formats:Owt,defaultWidth:"full"}),dateTime:sj({formats:jwt,defaultWidth:"full"})},zwt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Bwt=(e,t,r,i)=>zwt[e];function dw(e){return(t,r)=>{const i=r?.context?String(r.context):"standalone";let n;if(i==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=r?.width?String(r.width):a;n=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=r?.width?String(r.width):e.defaultWidth;n=e.values[o]||e.values[a]}const s=e.argumentCallback?e.argumentCallback(t):t;return n[s]}}const Fwt={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Vwt={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Uwt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Hwt={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Gwt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Wwt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},qwt=(e,t)=>{const r=Number(e),i=r%100;if(i>20||i<10)switch(i%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Ywt={ordinalNumber:qwt,era:dw({values:Fwt,defaultWidth:"wide"}),quarter:dw({values:Vwt,defaultWidth:"wide",argumentCallback:e=>e-1}),month:dw({values:Uwt,defaultWidth:"wide"}),day:dw({values:Hwt,defaultWidth:"wide"}),dayPeriod:dw({values:Gwt,defaultWidth:"wide",formattingValues:Wwt,defaultFormattingWidth:"wide"})};function hw(e){return(t,r={})=>{const i=r.width,n=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],s=t.match(n);if(!s)return null;const a=s[0],o=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?$wt(o,d=>d.test(a)):Xwt(o,d=>d.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function Xwt(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function $wt(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Kwt(e){return(t,r={})=>{const i=t.match(e.matchPattern);if(!i)return null;const n=i[0],s=t.match(e.parsePattern);if(!s)return null;let a=e.valueCallback?e.valueCallback(s[0]):s[0];a=r.valueCallback?r.valueCallback(a):a;const o=t.slice(n.length);return{value:a,rest:o}}}const Qwt=/^(\d+)(th|st|nd|rd)?/i,Zwt=/\d+/i,Jwt={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},e2t={any:[/^b/i,/^(a|c)/i]},t2t={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},r2t={any:[/1/i,/2/i,/3/i,/4/i]},i2t={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},n2t={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},s2t={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},a2t={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},o2t={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},l2t={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},c2t={ordinalNumber:Kwt({matchPattern:Qwt,parsePattern:Zwt,valueCallback:e=>parseInt(e,10)}),era:hw({matchPatterns:Jwt,defaultMatchWidth:"wide",parsePatterns:e2t,defaultParseWidth:"any"}),quarter:hw({matchPatterns:t2t,defaultMatchWidth:"wide",parsePatterns:r2t,defaultParseWidth:"any",valueCallback:e=>e+1}),month:hw({matchPatterns:i2t,defaultMatchWidth:"wide",parsePatterns:n2t,defaultParseWidth:"any"}),day:hw({matchPatterns:s2t,defaultMatchWidth:"wide",parsePatterns:a2t,defaultParseWidth:"any"}),dayPeriod:hw({matchPatterns:o2t,defaultMatchWidth:"any",parsePatterns:l2t,defaultParseWidth:"any"})},y0e={code:"en-US",formatDistance:Rwt,formatLong:Lwt,formatRelative:Bwt,localize:Ywt,match:c2t,options:{weekStartsOn:0,firstWeekContainsDate:1}};function u2t(e,t){const r=hs(e,t?.in);return ywt(r,Nwt(r))+1}function d2t(e,t){const r=hs(e,t?.in),i=+u3(r)-+xwt(r);return Math.round(i/p0e)+1}function x0e(e,t){const r=hs(e,t?.in),i=r.getFullYear(),n=SS(),s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,a=ud(t?.in||e,0);a.setFullYear(i+1,0,s),a.setHours(0,0,0,0);const o=S_(a,t),l=ud(t?.in||e,0);l.setFullYear(i,0,s),l.setHours(0,0,0,0);const c=S_(l,t);return+r>=+o?i+1:+r>=+c?i:i-1}function h2t(e,t){const r=SS(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,n=x0e(e,t),s=ud(t?.in||e,0);return s.setFullYear(n,0,i),s.setHours(0,0,0,0),S_(s,t)}function f2t(e,t){const r=hs(e,t?.in),i=+S_(r,t)-+h2t(r,t);return Math.round(i/p0e)+1}function Di(e,t){const r=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return r+i}const Gf={y(e,t){const r=e.getFullYear(),i=r>0?r:1-r;return Di(t==="yy"?i%100:i,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Di(r+1,2)},d(e,t){return Di(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Di(e.getHours()%12||12,t.length)},H(e,t){return Di(e.getHours(),t.length)},m(e,t){return Di(e.getMinutes(),t.length)},s(e,t){return Di(e.getSeconds(),t.length)},S(e,t){const r=t.length,i=e.getMilliseconds(),n=Math.trunc(i*Math.pow(10,r-3));return Di(n,t.length)}},Zv={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Bte={G:function(e,t,r){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(i,{width:"abbreviated"});case"GGGGG":return r.era(i,{width:"narrow"});case"GGGG":default:return r.era(i,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const i=e.getFullYear(),n=i>0?i:1-i;return r.ordinalNumber(n,{unit:"year"})}return Gf.y(e,t)},Y:function(e,t,r,i){const n=x0e(e,i),s=n>0?n:1-n;if(t==="YY"){const a=s%100;return Di(a,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):Di(s,t.length)},R:function(e,t){const r=v0e(e);return Di(r,t.length)},u:function(e,t){const r=e.getFullYear();return Di(r,t.length)},Q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Di(i,2);case"Qo":return r.ordinalNumber(i,{unit:"quarter"});case"QQQ":return r.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,r){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Di(i,2);case"qo":return r.ordinalNumber(i,{unit:"quarter"});case"qqq":return r.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,r){const i=e.getMonth();switch(t){case"M":case"MM":return Gf.M(e,t);case"Mo":return r.ordinalNumber(i+1,{unit:"month"});case"MMM":return r.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,r){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Di(i+1,2);case"Lo":return r.ordinalNumber(i+1,{unit:"month"});case"LLL":return r.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,r,i){const n=f2t(e,i);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):Di(n,t.length)},I:function(e,t,r){const i=d2t(e);return t==="Io"?r.ordinalNumber(i,{unit:"week"}):Di(i,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Gf.d(e,t)},D:function(e,t,r){const i=u2t(e);return t==="Do"?r.ordinalNumber(i,{unit:"dayOfYear"}):Di(i,t.length)},E:function(e,t,r){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(i,{width:"short",context:"formatting"});case"EEEE":default:return r.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,r,i){const n=e.getDay(),s=(n-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Di(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,i){const n=e.getDay(),s=(n-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Di(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const i=e.getDay(),n=i===0?7:i;switch(t){case"i":return String(n);case"ii":return Di(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(i,{width:"short",context:"formatting"});case"iiii":default:return r.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const i=e.getHours();let n;switch(i===12?n=Zv.noon:i===0?n=Zv.midnight:n=i/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const i=e.getHours();let n;switch(i>=17?n=Zv.evening:i>=12?n=Zv.afternoon:i>=4?n=Zv.morning:n=Zv.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),r.ordinalNumber(i,{unit:"hour"})}return Gf.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Gf.H(e,t)},K:function(e,t,r){const i=e.getHours()%12;return t==="Ko"?r.ordinalNumber(i,{unit:"hour"}):Di(i,t.length)},k:function(e,t,r){let i=e.getHours();return i===0&&(i=24),t==="ko"?r.ordinalNumber(i,{unit:"hour"}):Di(i,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Gf.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Gf.s(e,t)},S:function(e,t){return Gf.S(e,t)},X:function(e,t,r){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return Vte(i);case"XXXX":case"XX":return tg(i);case"XXXXX":case"XXX":default:return tg(i,":")}},x:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"x":return Vte(i);case"xxxx":case"xx":return tg(i);case"xxxxx":case"xxx":default:return tg(i,":")}},O:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Fte(i,":");case"OOOO":default:return"GMT"+tg(i,":")}},z:function(e,t,r){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Fte(i,":");case"zzzz":default:return"GMT"+tg(i,":")}},t:function(e,t,r){const i=Math.trunc(+e/1e3);return Di(i,t.length)},T:function(e,t,r){return Di(+e,t.length)}};function Fte(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),n=Math.trunc(i/60),s=i%60;return s===0?r+String(n):r+String(n)+t+Di(s,2)}function Vte(e,t){return e%60===0?(e>0?"-":"+")+Di(Math.abs(e)/60,2):tg(e,t)}function tg(e,t=""){const r=e>0?"-":"+",i=Math.abs(e),n=Di(Math.trunc(i/60),2),s=Di(i%60,2);return r+n+t+s}const Ute=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},b0e=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},p2t=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],i=r[1],n=r[2];if(!n)return Ute(e,t);let s;switch(i){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",Ute(i,t)).replace("{{time}}",b0e(n,t))},m2t={p:b0e,P:p2t},g2t=/^D+$/,v2t=/^Y+$/,y2t=["D","DD","YY","YYYY"];function x2t(e){return g2t.test(e)}function b2t(e){return v2t.test(e)}function w2t(e,t,r){const i=_2t(e,t,r);if(console.warn(i),y2t.includes(e))throw new RangeError(i)}function _2t(e,t,r){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const S2t=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,E2t=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,A2t=/^'([^]*?)'?$/,C2t=/''/g,T2t=/[a-zA-Z]/;function op(e,t,r){const i=SS(),n=i.locale??y0e,s=i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,a=i.weekStartsOn??i.locale?.options?.weekStartsOn??0,o=hs(e,r?.in);if(!_wt(o))throw new RangeError("Invalid time value");let l=t.match(E2t).map(u=>{const d=u[0];if(d==="p"||d==="P"){const f=m2t[d];return f(u,n.formatLong)}return u}).join("").match(S2t).map(u=>{if(u==="''")return{isToken:!1,value:"'"};const d=u[0];if(d==="'")return{isToken:!1,value:M2t(u)};if(Bte[d])return{isToken:!0,value:u};if(d.match(T2t))throw new RangeError("Format string contains an unescaped latin alphabet character `"+d+"`");return{isToken:!1,value:u}});n.localize.preprocessor&&(l=n.localize.preprocessor(o,l));const c={firstWeekContainsDate:s,weekStartsOn:a,locale:n};return l.map(u=>{if(!u.isToken)return u.value;const d=u.value;(b2t(d)||x2t(d))&&w2t(d,t,String(e));const f=Bte[d[0]];return f(o,d,n.localize,c)}).join("")}function M2t(e){const t=e.match(A2t);return t?t[1].replace(C2t,"'"):e}function P2t(e,t,r){const i=SS(),n=r?.locale??i.locale??y0e,s=2520,a=WT(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},r,{addSuffix:r?.addSuffix,comparison:a}),[l,c]=fN(r?.in,...a>0?[t,e]:[e,t]),u=Dwt(c,l),d=(d3(c)-d3(l))/1e3,f=Math.round((u-d)/60);let m;if(f<2)return r?.includeSeconds?u<5?n.formatDistance("lessThanXSeconds",5,o):u<10?n.formatDistance("lessThanXSeconds",10,o):u<20?n.formatDistance("lessThanXSeconds",20,o):u<40?n.formatDistance("halfAMinute",0,o):u<60?n.formatDistance("lessThanXMinutes",1,o):n.formatDistance("xMinutes",1,o):f===0?n.formatDistance("lessThanXMinutes",1,o):n.formatDistance("xMinutes",f,o);if(f<45)return n.formatDistance("xMinutes",f,o);if(f<90)return n.formatDistance("aboutXHours",1,o);if(f<jte){const v=Math.round(f/60);return n.formatDistance("aboutXHours",v,o)}else{if(f<s)return n.formatDistance("xDays",1,o);if(f<GC){const v=Math.round(f/jte);return n.formatDistance("xDays",v,o)}else if(f<GC*2)return m=Math.round(f/GC),n.formatDistance("aboutXMonths",m,o)}if(m=Pwt(c,l),m<12){const v=Math.round(f/GC);return n.formatDistance("xMonths",v,o)}else{const v=m%12,y=Math.trunc(m/12);return v<3?n.formatDistance("aboutXYears",y,o):v<9?n.formatDistance("overXYears",y,o):n.formatDistance("almostXYears",y+1,o)}}function D2t(e,t){return P2t(e,bwt(e),t)}function N2t(e,t){const r=()=>ud(t?.in,NaN),n=O2t(e);let s;if(n.date){const c=j2t(n.date,2);s=L2t(c.restDateString,c.year)}if(!s||isNaN(+s))return r();const a=+s;let o=0,l;if(n.time&&(o=z2t(n.time),isNaN(o)))return r();if(n.timezone){if(l=B2t(n.timezone),isNaN(l))return r()}else{const c=new Date(a+o),u=hs(0,t?.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return hs(a+o+l,t?.in)}const WC={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},k2t=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,R2t=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,I2t=/^([+-])(\d{2})(?::?(\d{2}))?$/;function O2t(e){const t={},r=e.split(WC.dateTimeDelimiter);let i;if(r.length>2)return t;if(/:/.test(r[0])?i=r[0]:(t.date=r[0],i=r[1],WC.timeZoneDelimiter.test(t.date)&&(t.date=e.split(WC.timeZoneDelimiter)[0],i=e.substr(t.date.length,e.length))),i){const n=WC.timezone.exec(i);n?(t.time=i.replace(n[1],""),t.timezone=n[1]):t.time=i}return t}function j2t(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(r);if(!i)return{year:NaN,restDateString:""};const n=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:s===null?n:s*100,restDateString:e.slice((i[1]||i[2]).length)}}function L2t(e,t){if(t===null)return new Date(NaN);const r=e.match(k2t);if(!r)return new Date(NaN);const i=!!r[4],n=fw(r[1]),s=fw(r[2])-1,a=fw(r[3]),o=fw(r[4]),l=fw(r[5])-1;if(i)return G2t(t,o,l)?F2t(t,o,l):new Date(NaN);{const c=new Date(0);return!U2t(t,s,a)||!H2t(t,n)?new Date(NaN):(c.setUTCFullYear(t,s,Math.max(n,a)),c)}}function fw(e){return e?parseInt(e):1}function z2t(e){const t=e.match(R2t);if(!t)return NaN;const r=aj(t[1]),i=aj(t[2]),n=aj(t[3]);return W2t(r,i,n)?r*g0e+i*m0e+n*1e3:NaN}function aj(e){return e&&parseFloat(e.replace(",","."))||0}function B2t(e){if(e==="Z")return 0;const t=e.match(I2t);if(!t)return 0;const r=t[1]==="+"?-1:1,i=parseInt(t[2]),n=t[3]&&parseInt(t[3])||0;return q2t(i,n)?r*(i*g0e+n*m0e):NaN}function F2t(e,t,r){const i=new Date(0);i.setUTCFullYear(e,0,4);const n=i.getUTCDay()||7,s=(t-1)*7+r+1-n;return i.setUTCDate(i.getUTCDate()+s),i}const V2t=[31,null,31,30,31,30,31,31,30,31,30,31];function w0e(e){return e%400===0||e%4===0&&e%100!==0}function U2t(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(V2t[t]||(w0e(e)?29:28))}function H2t(e,t){return t>=1&&t<=(w0e(e)?366:365)}function G2t(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function W2t(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function q2t(e,t){return t>=0&&t<=59}var pw={},Bw={exports:{}},Y2t=Bw.exports,Hte;function X2t(){return Hte||(Hte=1,function(e,t){(function(r,i){i(t)})(Y2t,function(r){var i=function(){return i=Object.assign||function(s){for(var a,o=1,l=arguments.length;o<l;o++)for(var c in a=arguments[o])Object.prototype.hasOwnProperty.call(a,c)&&(s[c]=a[c]);return s},i.apply(this,arguments)},n=function(){function s(a,o,l){var c=this;this.endVal=o,this.options=l,this.version="2.9.0",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(u){c.startTime||(c.startTime=u);var d=u-c.startTime;c.remaining=c.duration-d,c.useEasing?c.countDown?c.frameVal=c.startVal-c.easingFn(d,0,c.startVal-c.endVal,c.duration):c.frameVal=c.easingFn(d,c.startVal,c.endVal-c.startVal,c.duration):c.frameVal=c.startVal+(c.endVal-c.startVal)*(d/c.duration);var f=c.countDown?c.frameVal<c.endVal:c.frameVal>c.endVal;c.frameVal=f?c.endVal:c.frameVal,c.frameVal=Number(c.frameVal.toFixed(c.options.decimalPlaces)),c.printValue(c.frameVal),d<c.duration?c.rAF=requestAnimationFrame(c.count):c.finalEndVal!==null?c.update(c.finalEndVal):c.options.onCompleteCallback&&c.options.onCompleteCallback()},this.formatNumber=function(u){var d,f,m,v,y=u<0?"-":"";d=Math.abs(u).toFixed(c.options.decimalPlaces);var x=(d+="").split(".");if(f=x[0],m=x.length>1?c.options.decimal+x[1]:"",c.options.useGrouping){v="";for(var w=3,_=0,S=0,P=f.length;S<P;++S)c.options.useIndianSeparators&&S===4&&(w=2,_=1),S!==0&&_%w==0&&(v=c.options.separator+v),_++,v=f[P-S-1]+v;f=v}return c.options.numerals&&c.options.numerals.length&&(f=f.replace(/[0-9]/g,function(M){return c.options.numerals[+M]}),m=m.replace(/[0-9]/g,function(M){return c.options.numerals[+M]})),y+c.options.prefix+f+m+c.options.suffix},this.easeOutExpo=function(u,d,f,m){return f*(1-Math.pow(2,-10*u/m))*1024/1023+d},this.options=i(i({},this.defaults),l),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.el=typeof a=="string"?document.getElementById(a):a,o=o??this.parse(this.el.innerHTML),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(o),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,this.options.separator===""&&(this.options.useGrouping=!1),this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,a):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push(function(){return c.handleScroll(c)}),window.onscroll=function(){window.onScrollFns.forEach(function(u){return u()})},this.handleScroll(this)))}return s.prototype.handleScroll=function(a){if(a&&window&&!a.once){var o=window.innerHeight+window.scrollY,l=a.el.getBoundingClientRect(),c=l.top+window.pageYOffset,u=l.top+l.height+window.pageYOffset;u<o&&u>window.scrollY&&a.paused?(a.paused=!1,setTimeout(function(){return a.start()},a.options.scrollSpyDelay),a.options.scrollSpyOnce&&(a.once=!0)):(window.scrollY>u||c>o)&&!a.paused&&a.reset()}},s.prototype.determineDirectionAndSmartEasing=function(){var a=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>a;var o=a-this.startVal;if(Math.abs(o)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=a;var l=this.countDown?1:-1;this.endVal=a+l*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=a,this.finalEndVal=null;this.finalEndVal!==null?this.useEasing=!1:this.useEasing=this.options.useEasing},s.prototype.start=function(a){this.error||(this.options.onStartCallback&&this.options.onStartCallback(),a&&(this.options.onCompleteCallback=a),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},s.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},s.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},s.prototype.update=function(a){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(a),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal==null&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},s.prototype.printValue=function(a){var o;if(this.el){var l=this.formattingFn(a);!((o=this.options.plugin)===null||o===void 0)&&o.render?this.options.plugin.render(this.el,l):this.el.tagName==="INPUT"?this.el.value=l:this.el.tagName==="text"||this.el.tagName==="tspan"?this.el.textContent=l:this.el.innerHTML=l}},s.prototype.ensureNumber=function(a){return typeof a=="number"&&!isNaN(a)},s.prototype.validateValue=function(a){var o=Number(a);return this.ensureNumber(o)?o:(this.error="[CountUp] invalid start or end value: ".concat(a),null)},s.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},s.prototype.parse=function(a){var o=function(d){return d.replace(/([.,'  ])/g,"\\$1")},l=o(this.options.separator),c=o(this.options.decimal),u=a.replace(new RegExp(l,"g"),"").replace(new RegExp(c,"g"),".");return parseFloat(u)},s}();r.CountUp=n})}(Bw,Bw.exports)),Bw.exports}var Gte;function $2t(){if(Gte)return pw;Gte=1,Object.defineProperty(pw,"__esModule",{value:!0});var e=E_(),t=X2t();function r(E,N){var D=E==null?null:typeof Symbol<"u"&&E[Symbol.iterator]||E["@@iterator"];if(D!=null){var I,j,L,B,q=[],G=!0,Y=!1;try{if(L=(D=D.call(E)).next,N!==0)for(;!(G=(I=L.call(D)).done)&&(q.push(I.value),q.length!==N);G=!0);}catch(X){Y=!0,j=X}finally{try{if(!G&&D.return!=null&&(B=D.return(),Object(B)!==B))return}finally{if(Y)throw j}}return q}}function i(E,N){var D=Object.keys(E);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(E);N&&(I=I.filter(function(j){return Object.getOwnPropertyDescriptor(E,j).enumerable})),D.push.apply(D,I)}return D}function n(E){for(var N=1;N<arguments.length;N++){var D=arguments[N]!=null?arguments[N]:{};N%2?i(Object(D),!0).forEach(function(I){o(E,I,D[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(D)):i(Object(D)).forEach(function(I){Object.defineProperty(E,I,Object.getOwnPropertyDescriptor(D,I))})}return E}function s(E,N){if(typeof E!="object"||!E)return E;var D=E[Symbol.toPrimitive];if(D!==void 0){var I=D.call(E,N);if(typeof I!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(N==="string"?String:Number)(E)}function a(E){var N=s(E,"string");return typeof N=="symbol"?N:String(N)}function o(E,N,D){return N=a(N),N in E?Object.defineProperty(E,N,{value:D,enumerable:!0,configurable:!0,writable:!0}):E[N]=D,E}function l(){return l=Object.assign?Object.assign.bind():function(E){for(var N=1;N<arguments.length;N++){var D=arguments[N];for(var I in D)Object.prototype.hasOwnProperty.call(D,I)&&(E[I]=D[I])}return E},l.apply(this,arguments)}function c(E,N){if(E==null)return{};var D={},I=Object.keys(E),j,L;for(L=0;L<I.length;L++)j=I[L],!(N.indexOf(j)>=0)&&(D[j]=E[j]);return D}function u(E,N){if(E==null)return{};var D=c(E,N),I,j;if(Object.getOwnPropertySymbols){var L=Object.getOwnPropertySymbols(E);for(j=0;j<L.length;j++)I=L[j],!(N.indexOf(I)>=0)&&Object.prototype.propertyIsEnumerable.call(E,I)&&(D[I]=E[I])}return D}function d(E,N){return f(E)||r(E,N)||m(E,N)||y()}function f(E){if(Array.isArray(E))return E}function m(E,N){if(E){if(typeof E=="string")return v(E,N);var D=Object.prototype.toString.call(E).slice(8,-1);if(D==="Object"&&E.constructor&&(D=E.constructor.name),D==="Map"||D==="Set")return Array.from(E);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return v(E,N)}}function v(E,N){(N==null||N>E.length)&&(N=E.length);for(var D=0,I=new Array(N);D<N;D++)I[D]=E[D];return I}function y(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var x=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?e.useLayoutEffect:e.useEffect;function w(E){var N=e.useRef(E);return x(function(){N.current=E}),e.useCallback(function(){for(var D=arguments.length,I=new Array(D),j=0;j<D;j++)I[j]=arguments[j];return N.current.apply(void 0,I)},[])}var _=function(N,D){var I=D.decimal,j=D.decimals,L=D.duration,B=D.easingFn,q=D.end,G=D.formattingFn,Y=D.numerals,X=D.prefix,re=D.separator,F=D.start,$=D.suffix,se=D.useEasing,H=D.useGrouping,ne=D.useIndianSeparators,ce=D.enableScrollSpy,ie=D.scrollSpyDelay,ae=D.scrollSpyOnce,Z=D.plugin;return new t.CountUp(N,q,{startVal:F,duration:L,decimal:I,decimalPlaces:j,easingFn:B,formattingFn:G,numerals:Y,separator:re,prefix:X,suffix:$,plugin:Z,useEasing:se,useIndianSeparators:ne,useGrouping:H,enableScrollSpy:ce,scrollSpyDelay:ie,scrollSpyOnce:ae})},S=["ref","startOnMount","enableReinitialize","delay","onEnd","onStart","onPauseResume","onReset","onUpdate"],P={decimal:".",separator:",",delay:null,prefix:"",suffix:"",duration:2,start:0,decimals:0,startOnMount:!0,enableReinitialize:!0,useEasing:!0,useGrouping:!0,useIndianSeparators:!1},M=function(N){var D=Object.fromEntries(Object.entries(N).filter(function(Ee){var Be=d(Ee,2),$e=Be[1];return $e!==void 0})),I=e.useMemo(function(){return n(n({},P),D)},[N]),j=I.ref,L=I.startOnMount,B=I.enableReinitialize,q=I.delay,G=I.onEnd,Y=I.onStart,X=I.onPauseResume,re=I.onReset,F=I.onUpdate,$=u(I,S),se=e.useRef(),H=e.useRef(),ne=e.useRef(!1),ce=w(function(){return _(typeof j=="string"?j:j.current,$)}),ie=w(function(Ee){var Be=se.current;if(Be&&!Ee)return Be;var $e=ce();return se.current=$e,$e}),ae=w(function(){var Ee=function(){return ie(!0).start(function(){G?.({pauseResume:Z,reset:fe,start:Ae,update:he})})};q&&q>0?H.current=setTimeout(Ee,q*1e3):Ee(),Y?.({pauseResume:Z,reset:fe,update:he})}),Z=w(function(){ie().pauseResume(),X?.({reset:fe,start:Ae,update:he})}),fe=w(function(){ie().el&&(H.current&&clearTimeout(H.current),ie().reset(),re?.({pauseResume:Z,start:Ae,update:he}))}),he=w(function(Ee){ie().update(Ee),F?.({pauseResume:Z,reset:fe,start:Ae})}),Ae=w(function(){fe(),ae()}),xe=w(function(Ee){L&&(Ee&&fe(),ae())});return e.useEffect(function(){ne.current?B&&xe(!0):(ne.current=!0,xe())},[B,ne,xe,q,N.start,N.suffix,N.prefix,N.duration,N.separator,N.decimals,N.decimal,N.formattingFn]),e.useEffect(function(){return function(){fe()}},[fe]),{start:Ae,pauseResume:Z,reset:fe,update:he,getCountUp:ie}},C=["className","redraw","containerProps","children","style"],T=function(N){var D=N.className,I=N.redraw,j=N.containerProps,L=N.children,B=N.style,q=u(N,C),G=e.useRef(null),Y=e.useRef(!1),X=M(n(n({},q),{},{ref:G,startOnMount:typeof L!="function"||N.delay===0,enableReinitialize:!1})),re=X.start,F=X.reset,$=X.update,se=X.pauseResume,H=X.getCountUp,ne=w(function(){re()}),ce=w(function(Z){N.preserveValue||F(),$(Z)}),ie=w(function(){if(typeof N.children=="function"&&!(G.current instanceof Element)){console.error(`Couldn't find attached element to hook the CountUp instance into! Try to attach "containerRef" from the render prop to a an Element, eg. <span ref={containerRef} />.`);return}H()});e.useEffect(function(){ie()},[ie]),e.useEffect(function(){Y.current&&ce(N.end)},[N.end,ce]);var ae=I&&N;return e.useEffect(function(){I&&Y.current&&ne()},[ne,I,ae]),e.useEffect(function(){!I&&Y.current&&ne()},[ne,I,N.start,N.suffix,N.prefix,N.duration,N.separator,N.decimals,N.decimal,N.className,N.formattingFn]),e.useEffect(function(){Y.current=!0},[]),typeof L=="function"?L({countUpRef:G,start:re,reset:F,update:$,pauseResume:se,getCountUp:H}):e.createElement("span",l({className:D,ref:G,style:B},j),typeof N.start<"u"?H().formattingFn(N.start):"")};return pw.default=T,pw.useCountUp=M,pw}var K2t=$2t();const _0e=d0(K2t);function Q2t(e){return wn({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M22.394 6c-.167-.29-.398-.543-.652-.69L12.926.22c-.509-.294-1.34-.294-1.848 0L2.26 5.31c-.508.293-.923 1.013-.923 1.6v10.18c0 .294.104.62.271.91.167.29.398.543.652.69l8.816 5.09c.508.293 1.34.293 1.848 0l8.816-5.09c.254-.147.485-.4.652-.69.167-.29.27-.616.27-.91V6.91c.003-.294-.1-.62-.268-.91zM12 19.11c-3.92 0-7.109-3.19-7.109-7.11 0-3.92 3.19-7.11 7.11-7.11a7.133 7.133 0 016.156 3.553l-3.076 1.78a3.567 3.567 0 00-3.08-1.78A3.56 3.56 0 008.444 12 3.56 3.56 0 0012 15.555a3.57 3.57 0 003.08-1.778l3.078 1.78A7.135 7.135 0 0112 19.11zm7.11-6.715h-.79v.79h-.79v-.79h-.79v-.79h.79v-.79h.79v.79h.79zm2.962 0h-.79v.79h-.79v-.79h-.79v-.79h.79v-.79h.79v.79h.79z"},child:[]}]})(e)}const Lx=({children:e,className:t=""})=>h.jsx(Et.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:`bg-base-100 shadow-md border border-base-300/50 rounded-lg p-6 ${t}`,children:e}),Z2t=({user:e})=>{const[t,r]=O.useState(!1),[i,n]=O.useState(!1),[s,a]=O.useState(!1),[o,l]=O.useState(0),[c,u]=O.useState(e?.first_name||"User"),[d,f]=O.useState(null),[m,v]=O.useState(null),[y,x]=O.useState({show:!1,message:"",type:"success"}),w=O.useRef(null),_=async()=>{a(!0),l(0),x({...y,show:!1});try{let T=e.profile_pic_url;if(d){const N=await jt.get("/video/upload/pic"),{upload_url:D,...I}=N.data,j=new FormData;j.append("file",d);for(const B in I)j.append(B,I[B]);T=(await xn.post(D,j,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:B=>{const q=Math.round(B.loaded*100/B.total);l(q)}})).data.secure_url}const E={first_name:c,profile_pic_url:T};await jt.put("/user/updateUser",E),x({show:!0,message:"Profile updated successfully!",type:"success"}),r(!1)}catch(T){console.error("Failed to update profile:",T),x({show:!0,message:"Update failed. Please try again.",type:"error"})}finally{a(!1),l(0),setTimeout(()=>x(T=>({...T,show:!1})),3e3)}},S=()=>{r(!0),u(e?.first_name||"User"),f(null),v(null)},P=()=>{r(!1),f(null),v(null)},M=T=>{const E=T.target.files[0];E&&(f(E),v(URL.createObjectURL(E)))};O.useEffect(()=>()=>{m&&URL.revokeObjectURL(m)},[m]);const C=m||e?.profile_pic_url||"https://i.imgur.com/rLgnS6y.jpg";return h.jsxs(h.Fragment,{children:[h.jsxs(Lx,{className:"items-center text-center",children:[h.jsxs("div",{className:"avatar relative group",children:[h.jsx("div",{className:"w-32 rounded-full ring ring-[#44444355] ring-offset-base-100 ring-offset-3 cursor-pointer",onClick:()=>!t&&n(!0),children:h.jsx("img",{src:C,alt:"User Avatar"})}),t&&h.jsxs(h.Fragment,{children:[h.jsx("input",{type:"file",ref:w,onChange:M,className:"hidden",accept:"image/*"}),h.jsx("div",{className:"absolute inset-0 rounded-full bg-black/60 flex items-center justify-center text-white opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:()=>w.current.click(),title:"Upload new photo",children:h.jsx(LYe,{size:24})})]})]}),t?h.jsx("input",{type:"text",value:c,onChange:T=>u(T.target.value),className:"input input-bordered w-full max-w-xs mt-6 text-center text-3xl font-bold",placeholder:"Enter your name",disabled:s}):h.jsx("h1",{className:"text-3xl font-bold mt-6",children:e?.first_name||"User"}),h.jsx("p",{className:"text-base-content/60",children:e?.email_id||"username"}),h.jsx("div",{className:"badge badge-primary badge-lg mt-4 font-semibold",children:"Rank #4"}),h.jsxs("div",{className:"text-left text-sm text-base-content/70 mt-6 space-y-3",children:[h.jsxs("p",{className:"flex items-center gap-3",children:[h.jsx(GYe,{}),h.jsxs("span",{children:["Role: ",e.role]})]}),h.jsxs("p",{className:"flex items-center gap-3",children:[h.jsx(jYe,{}),h.jsxs("span",{children:["Joined: ",new Date(e.createdAt).toLocaleDateString("en-GB")]})]})]}),h.jsxs("div",{className:"w-full mt-6 space-y-4",children:[h.jsx(ya,{children:y.show&&h.jsx(Et.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:10},children:h.jsx("div",{className:`alert text-sm p-3 ${y.type==="success"?"alert-success":"alert-error"}`,children:h.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[y.type==="success"?h.jsx(Qle,{}):h.jsx(Jle,{}),h.jsx("span",{children:y.message})]})})})}),s&&h.jsxs("div",{children:[h.jsx("progress",{className:"progress progress-primary w-full",value:o,max:"100"}),h.jsxs("p",{className:"text-sm text-center",children:[o,"% uploaded"]})]}),t?h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("button",{className:"btn btn-ghost flex-1",onClick:P,disabled:s,children:[h.jsx(VYe,{})," Cancel"]}),h.jsxs("button",{className:`btn btn-primary flex-1 ${s?"loading":""}`,onClick:_,disabled:s,children:[h.jsx(FYe,{})," Save"]})]}):h.jsx("button",{className:"btn btn-primary btn-block",onClick:S,children:"Edit Profile"})]})]}),i&&h.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 cursor-zoom-out",onClick:()=>n(!1),children:h.jsx(Et.img,{layoutId:"profile-avatar",src:C,alt:"User Avatar - Zoomed",className:"max-w-[90vw] max-h-[90vh] rounded-lg shadow-2xl object-contain",initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.5,opacity:0},onClick:T=>T.stopPropagation()})})]})},Wte=({icon:e,title:t,value:r,unit:i="",children:n})=>h.jsxs(Lx,{className:"text-center",children:[h.jsx("div",{className:"flex justify-center text-3xl text-primary mb-3",children:e}),h.jsxs("div",{className:"text-4xl font-bold",children:[h.jsx(_0e,{end:r,duration:2}),i]}),h.jsx("p",{className:"text-base-content/70 mt-1",children:t}),n]}),J2t=({stats:e,activeFilter:t,onFilterChange:r})=>{const i=[{level:"Easy",solved:e.easySolved,total:12,color:"text-success",icon:"🟢"},{level:"Medium",solved:e.mediumSolved,total:8,color:"text-warning",icon:"🟡"},{level:"Hard",solved:e.hardSolved,total:2,color:"text-error",icon:"🔴"}];return h.jsxs(Lx,{children:[h.jsx("h2",{className:"card-title mb-4",children:"Difficulty Breakdown"}),h.jsx("div",{className:"space-y-4",children:i.map(({level:n,solved:s,total:a,color:o,icon:l})=>h.jsxs("div",{className:`p-3 rounded-lg cursor-pointer transition-all ${t===n.toLowerCase()?"bg-primary/10 ring-2 ring-primary":"hover:bg-base-content/5"}`,onClick:()=>r(t===n.toLowerCase()?"all":n.toLowerCase()),children:[h.jsxs("div",{className:"flex items-center justify-between text-sm font-semibold",children:[h.jsxs("span",{className:`flex items-center gap-2 ${o}`,children:[l," ",n]}),h.jsxs("span",{children:[s," / ",a]})]}),h.jsx("progress",{className:`progress ${o} w-full mt-1 h-[6px]`,value:s,max:a})]},n))})]})},e_t={python:h.jsx(OYe,{className:"text-blue-400"}),java:h.jsx(RYe,{className:"text-orange-500"}),javascript:h.jsx(IYe,{className:"text-yellow-400"}),"c++":h.jsx(Q2t,{className:"text-blue-600"})},t_t=({submissions:e})=>{const t=fs();return h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"table w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Problem"}),h.jsx("th",{children:"Status"}),h.jsx("th",{children:"Language"}),h.jsx("th",{children:"Date"})]})}),h.jsx("tbody",{children:h.jsx(ya,{children:e.map(r=>h.jsxs(Et.tr,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hover cursor-pointer",onClick:()=>t(`/problems/${r.problem_id}`),children:[h.jsx("td",{className:"font-semibold",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:`badge badge-xs border-none ${r.problem_difficulty?.toLowerCase()==="easy"?"bg-success":r.problem_difficulty?.toLowerCase()==="medium"?"bg-warning":r.problem_difficulty?.toLowerCase()==="hard"?"bg-error":"bg-base-300"}`}),r.problem_name]})}),h.jsx("td",{children:h.jsxs("span",{className:`capitalize font-semibold flex items-center gap-2 ${r.status==="accepted"?"text-success":"text-error"}`,children:[r.status==="accepted"?h.jsx(Qle,{}):h.jsx(Jle,{}),r.status.replace("_"," ")]})}),h.jsx("td",{children:h.jsxs("span",{className:"flex items-center gap-2",children:[e_t[r.language?.toLowerCase()]||h.jsx(Zle,{}),r.language||"N/A"]})}),h.jsx("td",{children:h.jsx("div",{className:"tooltip","data-tip":new Date(r.date).toLocaleString(),children:h.jsx("span",{className:"text-xs text-base-content/70",children:D2t(new Date(r.date),{addSuffix:!0})})})})]},r._id+new Date(r.date).toLocaleTimeString()))})})]})})};let rg;const r_t=({submissions:e})=>{rg=O.useMemo(()=>{const n={counts:new Map,totalSubmissions:0,activeDays:0,maxStreak:0},s=new Date;s.setFullYear(s.getFullYear()-1);for(const o of e){const l=new Date(o.date);if(l>=s){const c=op(l,"yyyy-MM-dd");n.counts.set(c,(n.counts.get(c)||0)+1)}}n.totalSubmissions=Array.from(n.counts.values()).reduce((o,l)=>o+l,0),n.activeDays=n.counts.size;let a=0;for(let o=0;o<365;o++){const l=new Date;l.setDate(l.getDate()-o);const c=op(l,"yyyy-MM-dd");n.counts.has(c)?(a++,n.maxStreak=Math.max(n.maxStreak,a)):a=0}return n},[e]);const t=O.useMemo(()=>{const n=new Date,s=[];for(let a=0;a<12;a++){const o=new Date(n.getFullYear(),n.getMonth()-a,1),l=op(o,"MMM"),c=[],u=new Date(o.getFullYear(),o.getMonth(),1),d=new Date(o.getFullYear(),o.getMonth()+1,0);let f=new Array(7).fill(null);for(let m=new Date(u);m<=d;m.setDate(m.getDate()+1)){const v=m.getDay(),y=op(m,"yyyy-MM-dd");f[v]={date:y,count:rg.counts.get(y)||0},v===6&&(c.push(f),f=new Array(7).fill(null))}f.some(m=>m!==null)&&c.push(f),s.push({monthName:l,weeks:c})}return s.reverse()},[rg.counts]),r=n=>n===0?"bg-base-content/10":n<=2?"bg-success/40":n<=5?"bg-success/70":"bg-success",i=n=>{if(!n)return"";const s=N2t(n.date),a=n.count===1?"":"s";return`${n.count} submission${a} on ${op(s,"MMM d, yyyy")}`};return h.jsxs(Lx,{children:[h.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2 mb-4",children:[h.jsxs("h2",{className:"text-lg font-medium",children:[rg.totalSubmissions," submissions in the past year"]}),h.jsxs("div",{className:"flex items-center space-x-4 sm:space-x-6 text-sm text-base-content/70",children:[h.jsxs("span",{children:["Active days: ",h.jsx("span",{className:"font-semibold text-base-content",children:rg.activeDays})]}),h.jsxs("span",{children:["Max streak: ",h.jsx("span",{className:"font-semibold text-base-content",children:rg.maxStreak})]})]})]}),h.jsx("div",{className:"heatmap-container flex gap-x-3 overflow-x-auto pt-2 pb-4 scrollbar-thin scrollbar-thumb-base-300 scrollbar-track-base-100",children:t.map(({monthName:n,weeks:s},a)=>h.jsxs("div",{className:"flex-shrink-0",children:[h.jsx("div",{className:"grid grid-flow-col grid-rows-7 gap-1",children:s.map((o,l)=>o.map((c,u)=>h.jsx("div",{className:`w-3.5 h-3.5 rounded-sm tooltip ${c?r(c.count):"bg-transparent"}`,"data-tip":i(c)},`${l}-${u}`)))}),h.jsx("p",{className:"text-xs text-base-content/60 text-center mt-2",children:n})]},a))})]})},i_t=()=>{const e=ho(m=>m.auth.user),[t,r]=O.useState([]),[i,n]=O.useState(!0),[s,a]=O.useState(null),[o,l]=O.useState("all"),[c,u]=O.useState("all");O.useEffect(()=>{(async()=>{if(!e?._id){n(!1);return}try{n(!0);const y=((await jt.get("/problem/allsubmission")).data.submissions||[]).sort((x,w)=>new Date(w.date)-new Date(x.date));r(y)}catch(v){a(v.message||"Failed to fetch submissions.")}finally{n(!1)}})()},[e]);const d=O.useMemo(()=>{const m=t.length,v=t.filter(w=>w.status==="accepted"),y=v.length,x=new Map;return v.forEach(w=>{x.has(w.problem_name)||x.set(w.problem_name,w.problem_difficulty?.toLowerCase()||"easy")}),{totalSubmissions:m,acceptedCount:y,acceptanceRate:m>0?Math.round(y/m*100):0,easySolved:[...x.values()].filter(w=>w==="easy").length,mediumSolved:[...x.values()].filter(w=>w==="medium").length,hardSolved:[...x.values()].filter(w=>w==="hard").length}},[t]),f=O.useMemo(()=>t.filter(m=>o==="accepted"?m.status==="accepted":o==="rejected"?m.status!=="accepted":!0).filter(m=>c==="all"?!0:m.problem_difficulty?.toLowerCase()===c),[t,o,c]);return i?h.jsx("div",{className:"flex justify-center items-center h-screen p-16",children:h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"w-16 h-16 border-4 border-primary/20 border-t-primary rounded-full animate-spin"}),h.jsx("div",{className:"absolute top-2 left-2 w-12 h-12 border-4 border-purple-500/20 border-t-purple-500 rounded-full animate-spin animation-delay-75"})]})}):s?h.jsx("div",{className:"text-center text-error p-10 font-semibold",children:s}):h.jsxs("div",{className:"p-4  sm:p-6 lg:p-8 font-sans bg-base-200 min-h-screen",children:[h.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[h.jsxs("aside",{className:"lg:col-span-3 space-y-6",children:[h.jsx(Z2t,{user:e}),h.jsx(J2t,{stats:d,activeFilter:c,onFilterChange:u})]}),h.jsxs("main",{className:"lg:col-span-9 space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[h.jsx(Wte,{icon:h.jsx(UYe,{}),title:"Problems Solved",value:d.easySolved+d.mediumSolved+d.hardSolved}),h.jsxs(Lx,{className:"text-center items-center",children:[h.jsx("div",{className:"radial-progress text-success transition-all",style:{"--value":d.acceptanceRate,"--size":"8rem","--thickness":"0.8rem"},role:"progressbar",children:h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsxs("span",{className:"text-3xl font-bold",children:[h.jsx(_0e,{end:d.acceptanceRate,duration:2}),"%"]}),h.jsx("span",{className:"text-xs text-base-content/60",children:"Acceptance"})]})}),h.jsx("div",{className:"tooltip w-full mt-4","data-tip":`${d.acceptedCount} accepted / ${d.totalSubmissions} total`,children:h.jsxs("p",{className:"text-sm text-base-content/70",children:[d.acceptedCount," of ",d.totalSubmissions," subs accepted"]})})]}),h.jsx(Wte,{icon:h.jsx(BYe,{}),title:"Max Streak",value:rg?.maxStreak,unit:" days"})]}),h.jsx(r_t,{submissions:t}),h.jsxs(Lx,{children:[h.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-center mb-4",children:[h.jsx("h2",{className:"card-title",children:"Submissions"}),h.jsxs("div",{className:"tabs tabs-boxed",children:[h.jsx("a",{className:`tab ${o==="all"?"tab-active":""}`,onClick:()=>l("all"),children:"All"}),h.jsx("a",{className:`tab ${o==="accepted"?"tab-active":""}`,onClick:()=>l("accepted"),children:"Accepted"}),h.jsx("a",{className:`tab ${o==="rejected"?"tab-active":""}`,onClick:()=>l("rejected"),children:"Rejected"})]})]}),f.length===0?h.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[200px] text-base-content/40 text-center",children:[h.jsx(Zle,{className:"text-5xl mb-4"}),h.jsx("h3",{className:"font-bold",children:"No Submissions Found"}),h.jsx("p",{className:"text-sm",children:"Try adjusting your filters or submitting a new solution!"})]}):h.jsx(t_t,{submissions:f})]})]})]})]})},qte=({label:e,id:t,register:r,error:i,isVisible:n,toggleVisibility:s})=>h.jsxs("div",{className:"form-control w-full",children:[h.jsx("label",{className:"label",htmlFor:t,children:h.jsx("span",{className:"label-text font-bold text-base-content/80",children:e})}),h.jsxs("div",{className:"relative",children:[h.jsx(GP,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 text-base-content/40",size:20,strokeWidth:1.5}),h.jsx("input",{id:t,type:n?"text":"password",placeholder:"••••••••",...r,className:`
          input input-bordered w-full pl-12 text-lg 
          transition-all duration-300
          focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-base-100
          ${i?"input-error":"focus:input-primary"}
        `}),h.jsx("button",{type:"button",onClick:s,className:"absolute right-2 top-1/2 w-8 h-8 rounded-full flex items-center justify-center hover:bg-base-300/50 active:bg-base-300/70 focus:outline-none transition-colors duration-200",style:{transform:"translateY(-50%)",position:"absolute"},"aria-label":n?"Hide password":"Show password",children:n?h.jsx(QV,{size:18}):h.jsx(Qu,{size:18})})]}),h.jsx("div",{className:"h-5 mt-1",children:i&&h.jsxs("span",{className:"label-text-alt text-error text-xs flex items-center gap-1",children:[h.jsx(n0,{size:14})," ",i.message]})})]}),n_t=()=>{const{register:e,handleSubmit:t,watch:r,formState:{errors:i},setError:n,reset:s}=$c({mode:"onBlur"}),a=fs(),[o,l]=O.useState(!1),[c,u]=O.useState(!1),[d,f]=O.useState(!1),[m,v]=O.useState({type:"",message:""}),y=r("password"),x=async w=>{v({type:"",message:""}),f(!0);try{const _=await jt.put("/user/updateUser",w);v({type:"success",message:"Your password has been set! Redirecting..."}),s(),setTimeout(()=>a("/"),2500)}catch(_){const S=_.message||"An unexpected error occurred. Please try again.";n("root.serverError",{type:"manual",message:S})}finally{f(!1)}};return O.useEffect(()=>{i.root?.serverError&&v({type:"error",message:i.root.serverError.message})},[i.root?.serverError]),h.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-base-200 p-4 bg-gradient-to-br from-base-200 via-base-100 to-base-200",children:h.jsx(Et.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},className:"card w-full max-w-lg bg-base-100/80 backdrop-blur-xl shadow-2xl border border-base-content/10",children:h.jsxs("div",{className:"card-body p-8 md:p-12",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent pb-2",children:"Set Your Password"}),h.jsx("p",{className:"text-base-content/70",children:"A strong password is the key to your account's security."})]}),h.jsxs("form",{onSubmit:t(x),className:"space-y-4",children:[h.jsx(qte,{id:"password",label:"New Password",register:e("password",{required:"A new password is required.",minLength:{value:8,message:"Password must be at least 8 characters."},validate:{hasUpperCase:w=>/[A-Z]/.test(w)||"Must contain one uppercase letter.",hasSpecialChar:w=>/[!@#$%^&*(),.?":{}|<>]/.test(w)||"Must contain one special character."}}),error:i.password,isVisible:o,toggleVisibility:()=>l(!o)}),h.jsx(qte,{id:"confirmPassword",label:"Confirm New Password",register:e("confirmPassword",{required:"Please confirm your new password.",validate:w=>w===y||"The passwords do not match."}),error:i.confirmPassword,isVisible:c,toggleVisibility:()=>u(!c)}),h.jsx(ya,{children:m.message&&h.jsx(Et.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:h.jsxs("div",{className:`alert ${m.type==="success"?"alert-success":"alert-error"} text-sm`,children:[m.type==="success"?h.jsx(ka,{}):h.jsx(n0,{}),h.jsx("span",{children:m.message})]})})}),h.jsx("div",{className:"form-control pt-6",children:h.jsx("button",{type:"submit",className:`btn btn-primary btn-lg w-full transition-all duration-300 ${d?"loading":""}`,disabled:d||m.type==="success",children:d?"Setting Password...":"Set Password"})})]})]})})})};function s_t({title:e,titleId:t,...r},i){return O.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?O.createElement("title",{id:t},e):null,O.createElement("path",{fillRule:"evenodd",d:"M11.47 2.47a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06l-6.22-6.22V21a.75.75 0 0 1-1.5 0V4.81l-6.22 6.22a.75.75 0 1 1-1.06-1.06l7.5-7.5Z",clipRule:"evenodd"}))}const a_t=O.forwardRef(s_t);function o_t({title:e,titleId:t,...r},i){return O.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?O.createElement("title",{id:t},e):null,O.createElement("path",{fillRule:"evenodd",d:"M8.603 3.799A4.49 4.49 0 0 1 12 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 0 1 3.498 1.307 4.491 4.491 0 0 1 1.307 3.497A4.49 4.49 0 0 1 21.75 12a4.49 4.49 0 0 1-1.549 3.397 4.491 4.491 0 0 1-1.307 3.497 4.491 4.491 0 0 1-3.497 1.307A4.49 4.49 0 0 1 12 21.75a4.49 4.49 0 0 1-3.397-1.549 4.49 4.49 0 0 1-3.498-1.306 4.491 4.491 0 0 1-1.307-3.498A4.49 4.49 0 0 1 2.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 0 1 1.307-3.497 4.49 4.49 0 0 1 3.497-1.307Zm7.007 6.387a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const S0e=O.forwardRef(o_t);function l_t({title:e,titleId:t,...r},i){return O.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":t},r),e?O.createElement("title",{id:t},e):null,O.createElement("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const c_t=O.forwardRef(l_t),u_t=e=>{switch(e.toLowerCase()){case"express":return"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-200";case"array":return"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-200";case"react":return"bg-cyan-100 text-cyan-800 dark:bg-cyan-900/50 dark:text-cyan-200";default:return"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}},d_t=({name:e})=>h.jsx(Et.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.3},className:`rounded-full px-3 py-1 text-xs font-semibold uppercase ${u_t(e)}`,children:e}),E0e=({user:e,size:t="h-8 w-8"})=>{if(e?.profile_pic_url)return h.jsx("img",{src:e.profile_pic_url,alt:e.first_name||"User Avatar",className:`${t} rounded-full object-cover`,title:e.first_name||"User"});const r=e?.first_name?e.first_name.charAt(0).toUpperCase():"U",i=t.includes("10")||t.includes("12")?"text-base":"text-sm";return h.jsx("div",{className:`flex items-center justify-center rounded-full bg-gray-300 font-bold text-gray-600 dark:bg-gray-600 dark:text-gray-200 ${t}`,title:e?.first_name||"User",children:h.jsx("span",{className:i,children:r})})},h_t=({question:e})=>{const t=e.answers.length,r=e.is_solved;return h.jsxs(Et.div,{whileHover:{scale:1.02,y:-5},transition:{type:"spring",stiffness:400,damping:20},className:"group cursor-pointer rounded-xl border bg-white p-4 shadow-sm transition-shadow duration-300 hover:shadow-lg dark:border-gray-700 dark:bg-gray-800",children:[h.jsxs(hr,{to:`/question/${e._id}`,className:"block",children:[h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900 transition-colors group-hover:text-blue-600 dark:text-gray-100 dark:group-hover:text-blue-400",children:e.title}),r&&h.jsx(S0e,{className:"ml-2 h-6 w-6 flex-shrink-0 text-green-500",title:"Solved"})]}),h.jsx("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:e.tags.map(i=>h.jsx(d_t,{name:i},i))})]}),h.jsxs("div",{className:"mt-4 flex flex-col justify-between gap-4 border-t border-gray-200 pt-4 text-sm text-gray-500 dark:border-gray-700 dark:text-gray-400 sm:flex-row sm:items-center",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(E0e,{user:e.posted_by}),h.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:gap-2",children:[h.jsxs("span",{className:`font-semibold ${t===0?"text-orange-600 dark:text-orange-400":"text-gray-700 dark:text-gray-300"}`,children:[t," ",t===1?"Answer":"Answers"]}),h.jsx("span",{className:"hidden sm:inline",children:"•"}),h.jsxs("span",{children:["Asked by ",e.posted_by.first_name||"User"]})]})]}),h.jsx("span",{title:`Asked on ${op(new Date(e.createdAt),"PPpp")}`,children:op(new Date(e.createdAt),"PPP")})]})]})},h3=({children:e,onClick:t})=>h.jsx(Et.button,{whileTap:{scale:.95},className:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-semibold px-4 py-2 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:t,children:e}),f_t=({onFilterChange:e})=>{const t=["All","Unanswered","Most Answered","Recent"],[r,i]=O.useState("All"),n=s=>{i(s),e(s)};return h.jsx("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:t.map(s=>h.jsx("button",{onClick:()=>n(s),className:`rounded-full px-4 py-1.5 text-sm font-medium transition-colors ${r===s?"bg-blue-600 text-white shadow":"bg-white text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600"}`,children:s},s))})},p_t=()=>{const[e,t]=O.useState([]),[r,i]=O.useState(!0),[n,s]=O.useState("All"),[a,o]=O.useState(""),l=ho(m=>m.auth.user);O.useEffect(()=>{(async()=>{try{i(!0);const v=await jt.get("/discussion/getAllQuestions");t(v.data)}catch(v){console.error("Error fetching questions:",v)}finally{i(!1)}})()},[]);const c=m=>{s(m)},u=e.filter(m=>{const v=a.toLowerCase().trim();if(!v)return!0;const y=m.title.toLowerCase().includes(v),x=m.tags.some(w=>w.toLowerCase().includes(v));return y||x}).filter(m=>n==="Unanswered"?m.answers.length===0:!0).sort((m,v)=>n==="Most Answered"?v.answers.length-m.answers.length:n==="Recent"?new Date(v.createdAt)-new Date(m.createdAt):new Date(v.createdAt)-new Date(m.createdAt)),d={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},f={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring"}}};return l?h.jsx(Et.div,{variants:d,initial:"hidden",animate:"visible",className:"min-h-screen  bg-gradient-to-br from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-4 transition-colors sm:p-8",children:h.jsxs("div",{className:"mx-auto max-w-4xl ",children:[h.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsxs(Et.header,{variants:f,className:"mb-6 flex items-center justify-between",children:[h.jsx("h1",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 bg-clip-text font-serif text-3xl font-bold text-transparent sm:text-4xl",children:"Discussions"}),h.jsx(hr,{to:"/ask-question",children:h.jsx(h3,{children:"Ask a Question"})})]}),h.jsxs(Et.div,{variants:f,className:"relative mb-4",children:[h.jsx("span",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4",children:h.jsx(mfe,{className:"h-5 w-5 text-gray-400"})}),h.jsx("input",{type:"text",placeholder:"Search questions by title or tag (e.g., 'Array', 'DP')",value:a,onChange:m=>o(m.target.value),className:"w-full rounded-full border border-gray-300 bg-white py-2.5 pl-11 pr-4 text-gray-900 shadow-sm transition-colors focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-300/50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 dark:placeholder-gray-400 dark:focus:border-blue-500"})]}),h.jsx(Et.div,{variants:f,children:h.jsx(f_t,{onFilterChange:c})}),r?h.jsx("p",{className:"pt-10 text-center text-gray-600 dark:text-gray-400",children:"Loading questions..."}):h.jsx("main",{className:"mt-6 space-y-5",children:h.jsx(ya,{children:u.length>0?u.map(m=>h.jsx(Et.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,transition:{duration:.15}},transition:{type:"spring",stiffness:400,damping:25},children:h.jsx(h_t,{question:m})},m._id)):h.jsxs(Et.div,{initial:{opacity:0},animate:{opacity:1},className:"pt-10 text-center text-gray-500 dark:text-gray-400",children:[h.jsx("h3",{className:"text-lg font-semibold",children:"No Questions Found"}),h.jsx("p",{children:"Try adjusting your search or filters."})]})})})]})}):h.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-10",children:h.jsx(yb,{message:"You need to be logged in to become part of Discussion"})})},A0e=({user:e,date:t,prefix:r="Asked"})=>h.jsxs("div",{className:"mt-4 flex items-center gap-3",children:[h.jsx(E0e,{user:e,size:"h-10 w-10"}),h.jsxs("div",{className:"text-sm",children:[h.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:e?.first_name||"Anonymous User"}),h.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[r," on ",t?op(new Date(t),"PPP"):"a while ago"]})]})]}),m_t=({onUpvote:e,upvotes:t,hasVoted:r,isUpvoting:i})=>{const n={hover:{scale:1.05,y:-2},tap:{scale:.95}};return h.jsxs("div",{className:"relative flex items-center group",children:[h.jsxs(Et.button,{variants:n,whileHover:"hover",whileTap:"tap",onClick:e,disabled:i,className:`flex items-center gap-2 rounded-full px-4 py-2 font-semibold transition-colors cursor-pointer disabled:cursor-not-allowed ${r?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600"}`,children:[h.jsx(a_t,{className:"h-5 w-5"}),h.jsx("span",{children:t})]}),h.jsxs("div",{className:`absolute bottom-full mb-2 w-max max-w-xs\r
                   invisible opacity-0 group-hover:visible group-hover:opacity-100 \r
                   transition-opacity duration-300`,children:[h.jsx("div",{className:"bg-blue-200  text-black border-gray-500 border-1 dark:bg-gray-800 dark:text-white  text-xs rounded-md py-1 px-3",children:"Upvote the answer if you find it helpful!"}),h.jsx("div",{className:`absolute left-4 -translate-x-1/2 w-0 h-0 \r
                       border-l-[6px] border-l-transparent\r
                       border-r-[6px] border-r-transparent\r
                       border-t-[6px] border-t-gray-800`})]})]})},g_t=({answer:e,onUpvote:t,upvotingId:r,currentUserId:i,onDelete:n,deletingId:s})=>{const a=i&&e.posted_by._id===i,o=i&&e.upvoted_by.includes(i);return h.jsxs(Et.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"},className:`relative rounded-xl border bg-white p-5 shadow-sm dark:bg-gray-800 ${e.is_accepted?"border-green-500/50":"border-gray-200 dark:border-gray-700"}`,children:[e.is_accepted&&h.jsxs("div",{className:"absolute -top-3 right-4 flex items-center gap-1 rounded-full bg-green-100 px-3 py-1 text-xs font-semibold text-green-800 dark:bg-green-900 dark:text-green-200",children:[h.jsx(S0e,{className:"h-4 w-4"}),"Accepted Answer"]}),h.jsx("p",{className:"text-base text-gray-800 dark:text-gray-300",children:e.content}),h.jsxs("div",{className:"mt-4 flex flex-col items-start justify-between gap-4 border-t border-gray-200 pt-4 dark:border-gray-700 sm:flex-row sm:items-center",children:[h.jsx(A0e,{user:e.posted_by,date:e.createdAt,prefix:"Answered"}),h.jsxs("div",{className:"flex items-center gap-4",children:[a&&h.jsx("button",{onClick:()=>n(e._id),disabled:s===e._id,className:"text-sm font-semibold text-red-500 hover:text-red-700 disabled:opacity-50",children:s===e._id?"Deleting...":"Delete"}),h.jsx(m_t,{onUpvote:()=>t(e._id),upvotes:e.upvotes,hasVoted:o,isUpvoting:r===e._id})]})]})]})},v_t=({description:e,user:t,date:r})=>h.jsxs(Et.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},className:"mb-8 rounded-xl border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-gray-800",children:[h.jsx("p",{className:"text-base leading-relaxed text-gray-800 dark:text-gray-300",children:e}),h.jsx(A0e,{user:t,date:r})]}),y_t=({content:e,setContent:t,onSubmit:r,isSubmitting:i,error:n})=>h.jsxs("div",{className:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-gray-800",children:[h.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Your Answer"}),n&&h.jsx("div",{className:"mt-3 rounded-md bg-red-50 p-3 text-sm text-red-700 dark:bg-red-900/30 dark:text-red-300",children:n}),h.jsx("textarea",{className:"mt-4 w-full rounded-md border-gray-300 bg-gray-50 p-3 text-gray-900 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400",rows:"5",placeholder:"Share your solution or insights here...",value:e,onChange:s=>t(s.target.value),disabled:i}),h.jsx("div",{className:"mt-4 flex justify-end",children:h.jsx(h3,{onClick:r,disabled:i,children:i?"Submitting...":"Post Answer"})})]}),x_t=({name:e})=>h.jsx(Et.div,{whileHover:{scale:1.1},className:"cursor-pointer rounded-full bg-blue-100 px-3 py-1 text-sm font-semibold text-blue-800 transition-colors dark:bg-indigo-900 dark:text-indigo-200",children:e}),b_t=({title:e,tags:t,isAuthor:r,onDelete:i})=>h.jsxs("header",{className:"mb-6",children:[h.jsxs(hr,{to:"/discussion",className:"mb-4 inline-flex items-center gap-2 text-sm font-semibold text-blue-600 hover:underline dark:text-blue-400",children:[h.jsx(jlt,{className:"h-4 w-4"}),"Back to Discussions"]}),h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:e}),r&&h.jsx("button",{className:"btn btn-sm btn-error",onClick:i,children:"Delete Question"})]}),h.jsx("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:t.map(n=>h.jsx(x_t,{name:n},n))})]}),w_t=()=>{const[e,t]=O.useState(null),[r,i]=O.useState(!0),{id:n}=Qp(),[s,a]=O.useState(""),[o,l]=O.useState(!1),[c,u]=O.useState(""),[d,f]=O.useState(null),[m,v]=O.useState(null),y=fs(),x=ho(T=>T.auth.user._id);O.useEffect(()=>{Hn.init({duration:800,once:!1,offset:50})},[]);const w=O.useCallback(async()=>{try{r||i(!0);const T=await jt.get(`/discussion/getQuestion/${n}`);t(T.data),setTimeout(()=>Hn.refresh(),500)}catch(T){console.error("Error fetching question:",T),u("Failed to load the question.")}finally{i(!1)}},[n,r]);O.useEffect(()=>{w()},[n]);const _=async()=>{if(!s.trim()){u("Answer content cannot be empty.");return}l(!0),u("");try{await jt.post(`/discussion/answer/${n}`,{content:s}),a(""),await w(),Hn.refresh()}catch(T){console.error("Error posting answer:",T),u(T.response?.data?.msg||"An error occurred. Please try again.")}finally{l(!1)}},S=async T=>{f(T);try{const E=await jt.patch(`discussion/${T}/upvote`,{});t(N=>({...N,answers:N.answers.map(D=>D._id===T?{...D,upvotes:E.data.upvotes,upvoted_by:E.data.upvoted_by}:D)}))}catch(E){console.error("Upvote error:",E),alert(E.response?.data?.msg||"An error occurred.")}finally{f(null)}},P=async()=>{if(window.confirm("Are you sure you want to delete this entire question and all its answers? This cannot be undone."))try{await jt.delete(`/discussion/deleteQuestion/${n}`),y("/discussion")}catch(T){console.error("Error deleting question:",T),alert(T.response?.data?.msg||"Could not delete the question.")}},M=async T=>{if(window.confirm("Are you sure you want to delete this answer?")){v(T);try{await jt.delete(`/discussion/deleteAnswer/${T}`),t(E=>({...E,answers:E.answers.filter(N=>N._id!==T)}))}catch(E){console.error("Error deleting answer:",E),alert(E.response?.data?.msg||"Could not delete the answer.")}finally{v(null)}}};if(r)return h.jsx("div",{className:"flex h-screen items-center justify-center text-gray-500 dark:text-gray-400",children:"Loading..."});if(!e)return h.jsx("div",{className:"p-8 text-center text-red-500",children:c||"Question not found."});const C=x&&e.posted_by._id===x;return h.jsx("div",{className:"min-h-screen bg-gradient-to-br from-sky-50 via-white to-pink-50 p-4 transition-colors dark:from-slate-900 dark:via-gray-900 dark:to-slate-600 sm:p-8",children:h.jsxs("div",{className:"mx-auto max-w-4xl",children:[h.jsx("div",{"data-aos":"fade-down","data-aos-delay":"100",children:h.jsx(b_t,{title:e.title,tags:e.tags,isAuthor:C,onDelete:P})}),h.jsx("div",{"data-aos":"fade-up","data-aos-delay":"200",children:h.jsx(v_t,{description:e.description,user:e.posted_by,date:e.createdAt})}),h.jsxs("div",{className:"mb-8","data-aos":"fade-up","data-aos-delay":"300",children:[h.jsxs("h2",{className:"mb-4 text-2xl font-bold text-gray-900 dark:text-white",children:[e.answers.length," Answers 🧠"]}),h.jsx("div",{className:"space-y-4",children:h.jsx(ya,{children:e.answers.length>0?e.answers.map((T,E)=>h.jsx("div",{"data-aos":"fade-up","data-aos-delay":100*(E+1),children:h.jsx(g_t,{answer:T,onUpvote:S,upvotingId:d,currentUserId:x,onDelete:M,deletingId:m})},T._id)):h.jsx("p",{className:"py-4 text-center text-gray-500 dark:text-gray-400",children:"No answers yet. Be the first to help!"})})})]}),h.jsx("div",{"data-aos":"zoom-in-up","data-aos-delay":"200",children:h.jsx(y_t,{content:s,setContent:a,onSubmit:_,isSubmitting:o,error:c})})]})})};let __t={data:""},S_t=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||__t,E_t=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,A_t=/\/\*[^]*?\*\/|  +/g,Yte=/\n+/g,lp=(e,t)=>{let r="",i="",n="";for(let s in e){let a=e[s];s[0]=="@"?s[1]=="i"?r=s+" "+a+";":i+=s[1]=="f"?lp(a,s):s+"{"+lp(a,s[1]=="k"?"":t)+"}":typeof a=="object"?i+=lp(a,t?t.replace(/([^,])+/g,o=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,o):o?o+" "+l:l)):s):a!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=lp.p?lp.p(s,a):s+":"+a+";")}return r+(t&&n?t+"{"+n+"}":n)+i},Zd={},C0e=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+C0e(e[r]);return t}return e},C_t=(e,t,r,i,n)=>{let s=C0e(e),a=Zd[s]||(Zd[s]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(s));if(!Zd[a]){let l=s!==e?e:(c=>{let u,d,f=[{}];for(;u=E_t.exec(c.replace(A_t,""));)u[4]?f.shift():u[3]?(d=u[3].replace(Yte," ").trim(),f.unshift(f[0][d]=f[0][d]||{})):f[0][u[1]]=u[2].replace(Yte," ").trim();return f[0]})(e);Zd[a]=lp(n?{["@keyframes "+a]:l}:l,r?"":"."+a)}let o=r&&Zd.g?Zd.g:null;return r&&(Zd.g=Zd[a]),((l,c,u,d)=>{d?c.data=c.data.replace(d,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(Zd[a],t,i,o),a},T_t=(e,t,r)=>e.reduce((i,n,s)=>{let a=t[s];if(a&&a.call){let o=a(r),l=o&&o.props&&o.props.className||/^go/.test(o)&&o;a=l?"."+l:o&&typeof o=="object"?o.props?"":lp(o,""):o===!1?"":o}return i+n+(a??"")},"");function pN(e){let t=this||{},r=e.call?e(t.p):e;return C_t(r.unshift?r.raw?T_t(r,[].slice.call(arguments,1),t.p):r.reduce((i,n)=>Object.assign(i,n&&n.call?n(t.p):n),{}):r,S_t(t.target),t.g,t.o,t.k)}let T0e,x6,b6;pN.bind({g:1});let $h=pN.bind({k:1});function M_t(e,t,r,i){lp.p=t,T0e=e,x6=r,b6=i}function cm(e,t){let r=this||{};return function(){let i=arguments;function n(s,a){let o=Object.assign({},s),l=o.className||n.className;r.p=Object.assign({theme:x6&&x6()},o),r.o=/ *go\d+/.test(l),o.className=pN.apply(r,i)+(l?" "+l:"");let c=e;return e[0]&&(c=o.as||e,delete o.as),b6&&c[0]&&b6(o),T0e(c,o)}return n}}var P_t=e=>typeof e=="function",f3=(e,t)=>P_t(e)?e(t):e,D_t=(()=>{let e=0;return()=>(++e).toString()})(),M0e=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),N_t=20,P0e=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,N_t)};case 1:return{...e,toasts:e.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case 2:let{toast:r}=t;return P0e(e,{type:e.toasts.find(s=>s.id===r.id)?1:0,toast:r});case 3:let{toastId:i}=t;return{...e,toasts:e.toasts.map(s=>s.id===i||i===void 0?{...s,dismissed:!0,visible:!1}:s)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(s=>s.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let n=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+n}))}}},qT=[],Sg={toasts:[],pausedAt:void 0},T0=e=>{Sg=P0e(Sg,e),qT.forEach(t=>{t(Sg)})},k_t={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},R_t=(e={})=>{let[t,r]=O.useState(Sg),i=O.useRef(Sg);O.useEffect(()=>(i.current!==Sg&&r(Sg),qT.push(r),()=>{let s=qT.indexOf(r);s>-1&&qT.splice(s,1)}),[]);let n=t.toasts.map(s=>{var a,o,l;return{...e,...e[s.type],...s,removeDelay:s.removeDelay||((a=e[s.type])==null?void 0:a.removeDelay)||e?.removeDelay,duration:s.duration||((o=e[s.type])==null?void 0:o.duration)||e?.duration||k_t[s.type],style:{...e.style,...(l=e[s.type])==null?void 0:l.style,...s.style}}});return{...t,toasts:n}},I_t=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:r?.id||D_t()}),ES=e=>(t,r)=>{let i=I_t(t,e,r);return T0({type:2,toast:i}),i.id},ro=(e,t)=>ES("blank")(e,t);ro.error=ES("error");ro.success=ES("success");ro.loading=ES("loading");ro.custom=ES("custom");ro.dismiss=e=>{T0({type:3,toastId:e})};ro.remove=e=>T0({type:4,toastId:e});ro.promise=(e,t,r)=>{let i=ro.loading(t.loading,{...r,...r?.loading});return typeof e=="function"&&(e=e()),e.then(n=>{let s=t.success?f3(t.success,n):void 0;return s?ro.success(s,{id:i,...r,...r?.success}):ro.dismiss(i),n}).catch(n=>{let s=t.error?f3(t.error,n):void 0;s?ro.error(s,{id:i,...r,...r?.error}):ro.dismiss(i)}),e};var O_t=(e,t)=>{T0({type:1,toast:{id:e,height:t}})},j_t=()=>{T0({type:5,time:Date.now()})},_2=new Map,L_t=1e3,z_t=(e,t=L_t)=>{if(_2.has(e))return;let r=setTimeout(()=>{_2.delete(e),T0({type:4,toastId:e})},t);_2.set(e,r)},B_t=e=>{let{toasts:t,pausedAt:r}=R_t(e);O.useEffect(()=>{if(r)return;let s=Date.now(),a=t.map(o=>{if(o.duration===1/0)return;let l=(o.duration||0)+o.pauseDuration-(s-o.createdAt);if(l<0){o.visible&&ro.dismiss(o.id);return}return setTimeout(()=>ro.dismiss(o.id),l)});return()=>{a.forEach(o=>o&&clearTimeout(o))}},[t,r]);let i=O.useCallback(()=>{r&&T0({type:6,time:Date.now()})},[r]),n=O.useCallback((s,a)=>{let{reverseOrder:o=!1,gutter:l=8,defaultPosition:c}=a||{},u=t.filter(m=>(m.position||c)===(s.position||c)&&m.height),d=u.findIndex(m=>m.id===s.id),f=u.filter((m,v)=>v<d&&m.visible).length;return u.filter(m=>m.visible).slice(...o?[f+1]:[0,f]).reduce((m,v)=>m+(v.height||0)+l,0)},[t]);return O.useEffect(()=>{t.forEach(s=>{if(s.dismissed)z_t(s.id,s.removeDelay);else{let a=_2.get(s.id);a&&(clearTimeout(a),_2.delete(s.id))}})},[t]),{toasts:t,handlers:{updateHeight:O_t,startPause:j_t,endPause:i,calculateOffset:n}}},F_t=$h`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,V_t=$h`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,U_t=$h`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,H_t=cm("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${F_t} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${V_t} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${U_t} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,G_t=$h`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,W_t=cm("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${G_t} 1s linear infinite;
`,q_t=$h`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Y_t=$h`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,X_t=cm("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${q_t} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Y_t} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,$_t=cm("div")`
  position: absolute;
`,K_t=cm("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Q_t=$h`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Z_t=cm("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Q_t} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,J_t=({toast:e})=>{let{icon:t,type:r,iconTheme:i}=e;return t!==void 0?typeof t=="string"?O.createElement(Z_t,null,t):t:r==="blank"?null:O.createElement(K_t,null,O.createElement(W_t,{...i}),r!=="loading"&&O.createElement($_t,null,r==="error"?O.createElement(H_t,{...i}):O.createElement(X_t,{...i})))},eSt=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,tSt=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,rSt="0%{opacity:0;} 100%{opacity:1;}",iSt="0%{opacity:1;} 100%{opacity:0;}",nSt=cm("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,sSt=cm("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,aSt=(e,t)=>{let r=e.includes("top")?1:-1,[i,n]=M0e()?[rSt,iSt]:[eSt(r),tSt(r)];return{animation:t?`${$h(i)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${$h(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},oSt=O.memo(({toast:e,position:t,style:r,children:i})=>{let n=e.height?aSt(e.position||t||"top-center",e.visible):{opacity:0},s=O.createElement(J_t,{toast:e}),a=O.createElement(sSt,{...e.ariaProps},f3(e.message,e));return O.createElement(nSt,{className:e.className,style:{...n,...r,...e.style}},typeof i=="function"?i({icon:s,message:a}):O.createElement(O.Fragment,null,s,a))});M_t(O.createElement);var lSt=({id:e,className:t,style:r,onHeightUpdate:i,children:n})=>{let s=O.useCallback(a=>{if(a){let o=()=>{let l=a.getBoundingClientRect().height;i(e,l)};o(),new MutationObserver(o).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[e,i]);return O.createElement("div",{ref:s,className:t,style:r},n)},cSt=(e,t)=>{let r=e.includes("top"),i=r?{top:0}:{bottom:0},n=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:M0e()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...i,...n}},uSt=pN`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,qC=16,dSt=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:i,children:n,containerStyle:s,containerClassName:a})=>{let{toasts:o,handlers:l}=B_t(r);return O.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:qC,left:qC,right:qC,bottom:qC,pointerEvents:"none",...s},className:a,onMouseEnter:l.startPause,onMouseLeave:l.endPause},o.map(c=>{let u=c.position||t,d=l.calculateOffset(c,{reverseOrder:e,gutter:i,defaultPosition:t}),f=cSt(u,d);return O.createElement(lSt,{id:c.id,key:c.id,onHeightUpdate:l.updateHeight,className:c.visible?uSt:"",style:f},c.type==="custom"?f3(c.message,c):n?n(c):O.createElement(oSt,{toast:c,position:u}))}))},Xte=ro;const hSt=["Graph","sliding window","string","arrays","hashmaps","tree","dp"],fSt=({tags:e,setTags:t})=>{const[r,i]=Ot.useState(""),n=o=>{t(e.filter((l,c)=>c!==o))},s=o=>{const l=o.trim().toLowerCase();l&&!e.includes(l)&&t([...e,l])},a=o=>{(o.key===","||o.key==="Enter")&&r&&(o.preventDefault(),s(r),i(""))};return h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex w-full flex-wrap gap-2 rounded-lg border-2 border-gray-300 p-2 dark:border-gray-600",children:[h.jsx(ya,{children:e.map((o,l)=>h.jsxs(Et.div,{layout:!0,initial:{opacity:0,y:-10,scale:.8},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,x:-10},transition:{type:"spring",stiffness:500,damping:30},className:"flex items-center gap-1 rounded-full bg-blue-100 px-3 py-1 text-sm font-semibold text-blue-800 dark:bg-blue-900/50 dark:text-blue-200",children:[o,h.jsx("button",{onClick:()=>n(l),className:"focus:outline-none",children:h.jsx(c_t,{className:"h-4 w-4"})})]},o))}),h.jsx("input",{type:"text",value:r,onChange:o=>i(o.target.value),onKeyDown:a,placeholder:e.length===0?"Add tags...":"",className:"flex-grow bg-transparent p-1 text-gray-900 focus:outline-none dark:text-white"})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400",children:"Popular Tags:"}),h.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:hSt.map(o=>h.jsxs("button",{type:"button",onClick:()=>s(o),className:"rounded-full bg-gray-200 px-3 py-1 text-xs text-gray-800 transition-transform hover:scale-105 hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",children:["#",o]},o))})]})]})},pSt=x0({title:on().min(5,"Title must be at least 5 characters long.").max(150),description:on().min(15,"Description must be at least 15 characters long.")}),mSt=()=>{const[e,t]=O.useState([]),r=fs(),{register:i,handleSubmit:n,formState:{errors:s}}=$c({resolver:y0(pSt)}),a=async c=>{if(e.length===0){Xte.error("Please add at least one tag.");return}const u=jt.post("/discussion/create",{...c,tags:e});Xte.promise(u,{loading:"Posting your question...",success:d=>(r(`/question/${d.data._id}`),"Question posted successfully!"),error:d=>d.response?.data?.msg||"An unexpected error occurred."})},o={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring"}}},l={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,staggerChildren:.1}}};return h.jsxs(h.Fragment,{children:[h.jsx(dSt,{position:"top-center",reverseOrder:!1}),h.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-cyan-50 dark:from-gray-900 dark:via-slate-900 dark:to-indigo-950 relative overflow-hidden",children:[h.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[h.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-r from-blue-400/20 to-purple-400/20 rounded-full blur-3xl animate-pulse"}),h.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-r from-cyan-400/20 to-blue-400/20 rounded-full blur-3xl animate-pulse delay-1000"}),h.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-gradient-to-r from-indigo-400/10 to-purple-400/10 rounded-full blur-3xl animate-pulse delay-500"})]}),h.jsx("div",{className:"relative z-10 p-4 md:p-8",children:h.jsxs(Et.div,{variants:l,initial:"hidden",animate:"visible",className:"mx-auto max-w-4xl",children:[h.jsxs(Et.header,{variants:o,className:"mb-12 text-center",children:[h.jsx("div",{className:"flex items-center justify-center mb-6",children:h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full blur-xl opacity-30 animate-pulse"}),h.jsx("div",{className:"relative bg-gradient-to-r from-blue-500 to-purple-500 p-4 rounded-full",children:h.jsx(jat,{className:"w-8 h-8 text-white"})})]})}),h.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 bg-clip-text text-transparent sm:text-6xl mb-4",children:"Ask a Public Question"}),h.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto leading-relaxed",children:"Stuck on a coding problem? Our vibrant community of developers is here to help you succeed."})]}),h.jsxs(Et.div,{variants:o,whileHover:{y:-5},className:"relative",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-400/20 via-purple-400/20 to-cyan-400/20 rounded-3xl blur-xl"}),h.jsxs("div",{className:"relative bg-white/90 dark:bg-gray-800/90 backdrop-blur-xl rounded-3xl border border-white/20 dark:border-gray-700/20 shadow-2xl overflow-hidden",children:[h.jsx("div",{className:"bg-gradient-to-r from-blue-500/10 via-purple-500/10 to-cyan-500/10 dark:from-blue-500/20 dark:via-purple-500/20 dark:to-cyan-500/20 p-8 border-b border-gray-200/50 dark:border-gray-700/50",children:h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg",children:h.jsx(dS,{className:"w-5 h-5 text-white"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Share Your Challenge"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"The more details you provide, the better help you'll receive"})]})]})}),h.jsx("div",{className:"p-8",children:h.jsxs("form",{onSubmit:n(a),className:"space-y-8",children:[h.jsxs(Et.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"space-y-3",children:[h.jsxs("label",{className:"flex items-center space-x-2 text-lg font-semibold text-gray-800 dark:text-gray-200",children:[h.jsx("div",{className:"p-1 bg-blue-100 dark:bg-blue-900/50 rounded",children:h.jsx(kot,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),h.jsx("span",{children:"Question Title"}),h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{...i("title"),className:"w-full px-4 py-4 bg-gray-50/50 dark:bg-gray-900/50 border-2 border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:border-blue-500 dark:focus:border-blue-400 focus:ring-4 focus:ring-blue-500/20 transition-all duration-200 text-lg",placeholder:"e.g., How to implement binary search in Python?"}),h.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4",children:h.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse"})})]}),s.title&&h.jsxs(Et.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm flex items-center space-x-1",children:[h.jsx("span",{className:"w-1 h-1 bg-red-500 rounded-full"}),h.jsx("span",{children:s.title.message})]})]}),h.jsxs(Et.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},className:"space-y-3",children:[h.jsxs("label",{className:"flex items-center space-x-2 text-lg font-semibold text-gray-800 dark:text-gray-200",children:[h.jsx("div",{className:"p-1 bg-green-100 dark:bg-green-900/50 rounded",children:h.jsx(sl,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),h.jsx("span",{children:"Problem Description"}),h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsxs("div",{className:"relative",children:[h.jsx("textarea",{...i("description"),rows:12,className:"w-full px-4 py-4 bg-gray-50/50 dark:bg-gray-900/50 border-2 border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:border-green-500 dark:focus:border-green-400 focus:ring-4 focus:ring-green-500/20 transition-all duration-200 font-mono text-sm resize-none",placeholder:`Describe your problem in detail:\r
\r
• What are you trying to achieve?\r
• What have you tried so far?\r
• What specific error or issue are you encountering?\r
• Include relevant code snippets\r
\r
Example:\r
\`\`\`python\r
def binary_search(arr, target):\r
    # Your code here\r
    pass\r
\`\`\``}),h.jsxs("div",{className:"absolute top-4 right-4 flex space-x-2",children:[h.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse delay-100"}),h.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse delay-200"}),h.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse delay-300"})]})]}),s.description&&h.jsxs(Et.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-500 text-sm flex items-center space-x-1",children:[h.jsx("span",{className:"w-1 h-1 bg-red-500 rounded-full"}),h.jsx("span",{children:s.description.message})]})]}),h.jsxs(Et.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4},className:"space-y-3",children:[h.jsxs("label",{className:"flex items-center space-x-2 text-lg font-semibold text-gray-800 dark:text-gray-200",children:[h.jsx("div",{className:"p-1 bg-purple-100 dark:bg-purple-900/50 rounded",children:h.jsx(zT,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"})}),h.jsx("span",{children:"Tags"}),h.jsx("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:"(Help others find your question)"})]}),h.jsx("div",{className:"bg-gray-50/50 dark:bg-gray-900/50 border-2 border-gray-200 dark:border-gray-700 rounded-xl p-4 focus-within:border-purple-500 dark:focus-within:border-purple-400 focus-within:ring-4 focus-within:ring-purple-500/20 transition-all duration-200",children:h.jsx(fSt,{tags:e,setTags:t})})]}),h.jsx(Et.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"pt-6",children:h.jsxs(Et.button,{whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},type:"submit",className:"group relative w-full overflow-hidden rounded-xl bg-gradient-to-r from-blue-600 via-purple-600 to-cyan-600 px-8 py-4 text-lg font-bold text-white shadow-2xl transition-all duration-300 hover:shadow-blue-500/25",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-700 via-purple-700 to-cyan-700 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),h.jsxs("div",{className:"relative flex items-center justify-center space-x-3",children:[h.jsx(ofe,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-200"}),h.jsx("span",{children:"Post Your Question"}),h.jsxs("div",{className:"flex space-x-1",children:[h.jsx("div",{className:"w-1 h-1 bg-white/60 rounded-full animate-bounce delay-0"}),h.jsx("div",{className:"w-1 h-1 bg-white/60 rounded-full animate-bounce delay-100"}),h.jsx("div",{className:"w-1 h-1 bg-white/60 rounded-full animate-bounce delay-200"})]})]})]})})]})})]})]}),h.jsxs(Et.div,{variants:o,className:"mt-12 bg-white/60 dark:bg-gray-800/60 backdrop-blur-sm rounded-2xl p-6 border border-gray-200/50 dark:border-gray-700/50",children:[h.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[h.jsx(vot,{className:"w-5 h-5 text-amber-500 mr-2"}),"Tips for Getting Great Answers"]}),h.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-gray-600 dark:text-gray-300",children:[h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),h.jsx("span",{children:"Be specific about what you're trying to accomplish"})]}),h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full mt-2 flex-shrink-0"}),h.jsx("span",{children:"Include relevant code snippets and error messages"})]}),h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx("div",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full mt-2 flex-shrink-0"}),h.jsx("span",{children:"Show what you've already tried"})]}),h.jsxs("div",{className:"flex items-start space-x-2",children:[h.jsx("div",{className:"w-1.5 h-1.5 bg-amber-400 rounded-full mt-2 flex-shrink-0"}),h.jsx("span",{children:"Use clear, descriptive titles"})]})]})]})]})})]})]})},gSt=x0({currentPassword:on().min(1,"Current password is required"),newPassword:on().min(8,"Must be at least 8 characters").regex(/[A-Z]/,"Must include an uppercase letter").regex(/[0-9]/,"Must include a number").regex(/[^a-zA-Z0-9]/,"Must include a special character"),confirmPassword:on().min(1,"Please confirm your password")}).refine(e=>e.newPassword===e.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}),oj=({label:e,name:t,register:r,error:i,show:n,toggleShow:s,placeholder:a})=>h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm text-black dark:text-white mb-1",children:e}),h.jsxs("div",{className:"relative",children:[h.jsx("input",{type:n?"text":"password",...r(t),placeholder:a,className:`input input-bordered w-full bg-base-300/20 pr-12 text-gray-700 dark:text-white ${i?"input-error":""}`}),h.jsx("button",{type:"button",onClick:s,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 cursor-pointer hover:text-gray-600 dark:hover:text-white",children:n?h.jsx(QV,{size:20}):h.jsx(Qu,{size:20})})]}),i&&h.jsx("p",{className:"text-error text-sm mt-1",children:i.message})]});function vSt(){const e=fs(),{register:t,handleSubmit:r,formState:{errors:i},reset:n}=$c({resolver:y0(gSt),mode:"onTouched"}),[s,a]=O.useState(!1),[o,l]=O.useState(""),[c,u]=O.useState(""),[d,f]=O.useState(!1),[m,v]=O.useState(!1),[y,x]=O.useState(!1);O.useEffect(()=>{Hn.init({duration:800,once:!0,easing:"ease-out-cubic"})},[]);const w=async _=>{a(!0),l(""),u("");try{console.log("hi");const S=await jt.put("/user/change-password",{currentPassword:_.currentPassword,newPassword:_.newPassword});u(S.data.message),n(),setTimeout(()=>e("/profile"),2e3)}catch(S){l(S.response?.data?.message||"An unexpected error occurred.")}finally{a(!1)}};return h.jsxs("div",{className:"relative min-h-screen flex items-center justify-center bg-gradient-to-br from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600  transition-colors overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsxs("div",{"data-aos":"zoom-in-up",className:"relative z-10 w-full max-w-md bg-base-100/10 backdrop-blur-md border border-gray-700 p-6 sm:p-8 rounded-2xl shadow-2xl",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("div",{className:"w-16 h-16 bg-primary/20 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:h.jsx(GP,{className:"w-8 h-8 text-primary"})}),h.jsx("h2",{className:"text-3xl font-bold text-black dark:text-white",children:"Change Password"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Choose a new, strong password."})]}),c&&h.jsx("div",{className:"alert alert-success shadow-lg mb-4","data-aos":"fade-in",children:h.jsxs("div",{children:[h.jsx(JV,{className:"h-5 w-5"}),h.jsx("span",{children:c})]})}),o&&h.jsx("div",{className:"alert alert-error shadow-lg mb-4","data-aos":"fade-in",children:h.jsxs("div",{children:[h.jsx(GP,{className:"h-5 w-5"}),h.jsx("span",{children:o})]})}),h.jsxs("form",{onSubmit:r(w),className:"space-y-4 ",children:[h.jsx(oj,{label:"Current Password",name:"currentPassword",register:t,error:i.currentPassword,show:d,toggleShow:()=>f(_=>!_),placeholder:"Enter current password"}),h.jsx(oj,{label:"New Password",name:"newPassword",register:t,error:i.newPassword,show:m,toggleShow:()=>v(_=>!_),placeholder:"Enter new password"}),h.jsx(oj,{label:"Confirm New Password",name:"confirmPassword",register:t,error:i.confirmPassword,show:y,toggleShow:()=>x(_=>!_),placeholder:"Confirm new password"}),h.jsx("div",{className:"pt-2",children:h.jsx("button",{type:"submit",disabled:s,className:`btn btn-primary w-full text-base ${s?"loading":""}`,children:s?"Updating...":"Update Password"})})]})]})]})}const ySt=({contest:e,onRegister:t,isRegistering:r})=>{const i=ho(_=>_.auth.user),s=(()=>{const _=new Date,S=new Date(e.startTime),P=new Date(e.endTime);return console.log("Status check:",{now:_.toISOString(),nowLocal:_.toString(),start:S.toISOString(),startLocal:S.toString(),end:P.toISOString(),endLocal:P.toString(),nowTime:_.getTime(),startTime:S.getTime(),endTime:P.getTime(),isBeforeStart:_<S,isAfterStart:_>=S,isBeforeEnd:_<=P,isAfterEnd:_>P}),_<S?(console.log("Contest is UPCOMING"),{text:"Upcoming",color:"bg-gradient-to-r from-blue-500 to-indigo-500",icon:h.jsx(Dp,{className:"w-4 h-4"}),type:"upcoming"}):_>=S&&_<=P?(console.log("Contest is LIVE"),{text:"Live Now",color:"bg-gradient-to-r from-green-500 to-emerald-500 animate-pulse",icon:h.jsx(Lg,{className:"w-4 h-4 animate-spin"}),type:"live"}):(console.log("Contest has ENDED"),{text:"Ended",color:"bg-gradient-to-r from-gray-500 to-slate-500",icon:h.jsx(Iz,{className:"w-4 h-4"}),type:"ended"})})(),a=_=>new Date(_).toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Kolkata",timeZoneName:"short"}),o=(_,S)=>{const P=new Date(S)-new Date(_),M=Math.floor(P/6e4);if(M<60)return`${M} mins`;const C=Math.floor(M/60),T=M%60;if(C<24)return`${C}h ${T}m`;const E=Math.floor(C/24),N=C%24;return`${E}d ${N}h`},l=()=>{const _=new Date,S=new Date(e.startTime);if(console.log("Time to start calculation:",{now:_.toISOString(),start:S.toISOString(),nowTime:_.getTime(),startTime:S.getTime(),diff:S.getTime()-_.getTime()}),_>=S)return null;const P=S-_,M=Math.floor(P/(1e3*60*60*24)),C=Math.floor(P%(1e3*60*60*24)/(1e3*60*60)),T=Math.floor(P%(1e3*60*60)/(1e3*60));return M>0?`Starts in ${M}d ${C}h`:C>0?`Starts in ${C}h ${T}m`:`Starts in ${T}m`},c=()=>{const _=new Date,S=new Date(e.endTime);if(_>=S)return null;const P=S-_,M=Math.floor(P/(1e3*60*60*24)),C=Math.floor(P%(1e3*60*60*24)/(1e3*60*60)),T=Math.floor(P%(1e3*60*60)/(1e3*60));return M>0?`${M}d ${C}h remaining`:C>0?`${C}h ${T}m remaining`:`${T}m remaining`},u=e.participants?.length>=e.maxParticipants,d=e.problems?.length||0,f=e.participants?.length||0,m=l(),v=c(),y=i?._id?e.participants?.some(_=>_.toString()===i._id.toString()):!1,x=()=>{s.type==="live"&&y?window.location.href=`/contest/${e._id}/arena`:s.type==="ended"&&(window.location.href=`/contest/${e._id}/results`)},w=s.type==="live"&&y||s.type==="ended";return h.jsxs("div",{"data-aos":"fade-up",onClick:w?x:void 0,className:`group relative overflow-hidden rounded-2xl backdrop-blur-sm border shadow-xl transition-all duration-500 hover:-translate-y-1 ${s.type==="live"?"bg-green-50/10 dark:bg-green-900/10 border-green-300/30 dark:border-green-700/50 hover:border-green-400/50 hover:shadow-green-500/20":s.type==="ended"?"bg-gray-50/10 dark:bg-gray-900/10 border-gray-300/30 dark:border-gray-700/50 hover:border-gray-400/50 hover:shadow-gray-500/20":"bg-white/10 dark:bg-base-100/10 border-gray-300/20 dark:border-gray-700 hover:border-primary/40 hover:shadow-primary/10"} ${w?"cursor-pointer":""}`,children:[h.jsx("div",{className:`absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 ${s.type==="live"?"bg-gradient-to-br from-green-500/10 via-transparent to-emerald-500/10":s.type==="ended"?"bg-gradient-to-br from-gray-500/10 via-transparent to-slate-500/10":"bg-gradient-to-br from-primary/5 via-transparent to-purple-500/5"}`}),h.jsx("div",{className:"absolute top-4 right-4 z-10",children:h.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full text-white dark:text-white text-sm font-semibold ${s.color} shadow-lg`,children:[s.icon,s.text]})}),h.jsxs("div",{className:"relative p-6 space-y-6",children:[h.jsxs("div",{className:"space-y-3",children:[h.jsx("h2",{className:`text-2xl font-bold bg-gradient-to-r bg-clip-text text-transparent transition-all duration-300 ${s.type==="live"?"from-green-700 to-emerald-600 dark:from-green-300 dark:to-emerald-400 group-hover:from-green-600 group-hover:to-emerald-500":s.type==="ended"?"from-gray-700 to-gray-600 dark:from-gray-300 dark:to-gray-400 group-hover:from-gray-600 group-hover:to-gray-500":"from-gray-900 to-gray-700 dark:from-white dark:via-slate-100 dark:to-slate-300 group-hover:from-primary group-hover:to-purple-400"}`,children:e.title}),h.jsx("p",{className:"text-gray-600 dark:text-slate-400 leading-relaxed line-clamp-2",children:e.description})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl border transition-colors duration-300 ${s.type==="live"?"bg-green-100/60 dark:bg-green-800/40 border-green-200/50 dark:border-green-700/50 group-hover:border-green-400/40":s.type==="ended"?"bg-gray-100/60 dark:bg-gray-800/40 border-gray-200/50 dark:border-gray-700/50 group-hover:border-gray-400/40":"bg-gray-100/60 dark:bg-slate-800/40 border-gray-200/50 dark:border-slate-700/50 group-hover:border-primary/30"}`,children:[h.jsx("div",{className:`p-2 rounded-lg ${s.type==="live"?"bg-gradient-to-r from-green-500/20 to-emerald-500/20":s.type==="ended"?"bg-gradient-to-r from-gray-500/20 to-slate-500/20":"bg-gradient-to-r from-primary/20 to-purple-500/20"}`,children:h.jsx(sl,{className:`w-5 h-5 ${s.type==="live"?"text-green-600 dark:text-green-400":s.type==="ended"?"text-gray-600 dark:text-gray-400":"text-primary"}`})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 uppercase tracking-wide",children:"Problems"}),h.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:d})]})]}),h.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-xl border transition-colors duration-300 ${s.type==="live"?"bg-green-100/60 dark:bg-green-800/40 border-green-200/50 dark:border-green-700/50 group-hover:border-emerald-500/40":s.type==="ended"?"bg-gray-100/60 dark:bg-gray-800/40 border-gray-200/50 dark:border-gray-700/50 group-hover:border-gray-400/40":"bg-gray-100/60 dark:bg-slate-800/40 border-gray-200/50 dark:border-slate-700/50 group-hover:border-purple-500/30"}`,children:[h.jsx("div",{className:`p-2 rounded-lg ${s.type==="live"?"bg-gradient-to-r from-emerald-500/20 to-green-500/20":s.type==="ended"?"bg-gradient-to-r from-gray-500/20 to-slate-500/20":"bg-gradient-to-r from-purple-500/20 to-pink-500/20"}`,children:h.jsx(Zu,{className:`w-5 h-5 ${s.type==="live"?"text-emerald-600 dark:text-emerald-400":s.type==="ended"?"text-gray-600 dark:text-gray-400":"text-purple-400"}`})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 uppercase tracking-wide",children:"Registered"}),h.jsxs("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[f,h.jsxs("span",{className:"text-sm text-gray-500 dark:text-slate-400",children:["/",e.maxParticipants]})]})]})]})]}),h.jsxs("div",{className:`space-y-3 p-4 rounded-xl border ${s.type==="live"?"bg-gradient-to-r from-green-50/80 to-emerald-100/60 dark:from-green-800/30 dark:to-emerald-900/30 border-green-200/40 dark:border-green-700/30":s.type==="ended"?"bg-gradient-to-r from-gray-50/80 to-gray-100/60 dark:from-gray-800/30 dark:to-gray-900/30 border-gray-200/40 dark:border-gray-700/30":"bg-gradient-to-r from-gray-50/80 to-gray-100/60 dark:from-slate-800/30 dark:to-slate-900/30 border-gray-200/40 dark:border-slate-700/30"}`,children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-slate-300",children:[h.jsx(Dp,{className:"w-4 h-4 text-primary/70"}),h.jsx("span",{className:"text-sm font-medium",children:"Start Time"})]}),h.jsx("span",{className:"text-sm text-gray-900 dark:text-white font-mono",children:a(e.startTime)})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-slate-300",children:[h.jsx(Rc,{className:"w-4 h-4 text-primary/70"}),h.jsx("span",{className:"text-sm font-medium",children:"Duration"})]}),h.jsx("span",{className:"text-sm text-gray-900 dark:text-white font-mono",children:o(e.startTime,e.endTime)})]}),m&&h.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200/60 dark:border-slate-700/50",children:[h.jsxs("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400",children:[h.jsx(Lg,{className:"w-4 h-4"}),h.jsx("span",{className:"text-sm font-medium",children:"Countdown"})]}),h.jsx("span",{className:"text-sm text-blue-600 dark:text-blue-400 font-mono font-bold",children:m})]}),s.type==="live"&&v&&h.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-green-200/60 dark:border-green-700/50",children:[h.jsxs("div",{className:"flex items-center gap-2 text-red-600 dark:text-red-400",children:[h.jsx(Lg,{className:"w-4 h-4 animate-pulse"}),h.jsx("span",{className:"text-sm font-medium",children:"Time Left"})]}),h.jsx("span",{className:"text-sm text-red-600 dark:text-red-400 font-mono font-bold animate-pulse",children:v})]})]}),e.maxParticipants>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex justify-between text-sm",children:[h.jsx("span",{className:"text-gray-500 dark:text-slate-400",children:"Registration Progress"}),h.jsxs("span",{className:"text-gray-700 dark:text-slate-300",children:[Math.round(f/e.maxParticipants*100),"%"]})]}),h.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-800 rounded-full h-2 overflow-hidden",children:h.jsx("div",{className:`h-full transition-all duration-500 ease-out ${s.type==="live"?"bg-gradient-to-r from-green-500 to-emerald-500":s.type==="ended"?"bg-gradient-to-r from-gray-500 to-slate-500":"bg-gradient-to-r from-primary to-purple-500"}`,style:{width:`${Math.min(f/e.maxParticipants*100,100)}%`}})})]}),h.jsx("div",{className:"pt-2",onClick:_=>_.stopPropagation(),children:s.text==="Ended"?h.jsxs(hr,{to:`/contest/${e._id}/results`,className:"w-full py-3 px-4 rounded-xl bg-gradient-to-r from-gray-600 to-slate-600 hover:from-gray-700 hover:to-slate-700 text-white font-medium transition-all duration-300 hover:shadow-lg hover:shadow-gray-500/25 flex items-center justify-center gap-2 group hover:-translate-y-0.5",children:[h.jsx(Qu,{className:"w-5 h-5 group-hover:scale-110 transition-transform duration-300"}),"View Results",h.jsx(Ky,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-300"})]}):s.text==="Live Now"?y?h.jsxs(hr,{to:`/contest/${e._id}/arena`,className:"w-full py-3 px-4 rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-semibold transition-all duration-300 hover:shadow-lg hover:shadow-green-500/25 flex items-center justify-center gap-2 group hover:-translate-y-0.5",children:[h.jsx(jD,{className:"w-5 h-5 group-hover:scale-110 transition-transform duration-300"}),"Enter Arena",h.jsx(Ky,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-300"})]}):h.jsxs("button",{className:"w-full py-3 px-4 rounded-xl bg-gradient-to-r from-red-600 to-rose-600 text-white font-medium cursor-not-allowed flex items-center justify-center gap-2",children:[h.jsx(Zu,{className:"w-5 h-5"}),"Registration Closed"]}):y?h.jsxs("button",{className:"w-full py-3 px-4 rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 text-white font-medium cursor-not-allowed flex items-center justify-center gap-2 shadow-lg opacity-75",children:[h.jsx(sm,{className:"w-5 h-5"}),"Already Registered"]}):u?h.jsxs("button",{className:"w-full py-3 px-4 rounded-xl bg-gradient-to-r from-red-600 to-rose-600 text-white font-medium cursor-not-allowed flex items-center justify-center gap-2",children:[h.jsx(Zu,{className:"w-5 h-5"}),"Registration Full"]}):h.jsx("button",{className:`w-full py-3 px-4 rounded-xl bg-gradient-to-r from-primary to-purple-600 hover:from-primary/90 hover:to-purple-600/90 text-white font-semibold transition-all duration-300 hover:shadow-lg hover:shadow-primary/25 flex items-center justify-center gap-2 group ${r?"opacity-75 cursor-wait":"hover:-translate-y-0.5"}`,onClick:()=>t(e._id),disabled:r,children:r?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Registering..."]}):h.jsxs(h.Fragment,{children:[h.jsx(qh,{className:"w-5 h-5 group-hover:rotate-12 transition-transform duration-300"}),"Register Now",h.jsx(Ky,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform duration-300"})]})})})]})]})};function xSt(){const[e,t]=O.useState([]),[r,i]=O.useState("Upcoming"),[n,s]=O.useState(!0),[a,o]=O.useState(null),l=ho(x=>x.auth.user);O.useEffect(()=>{Hn.init({duration:800,once:!0,easing:"ease-out-cubic",offset:100}),c()},[]);const c=async()=>{try{s(!0);const x=await jt.get("/contest/getcontest");t(x.data)}catch(x){console.error("Failed to fetch contests",x)}finally{s(!1)}},u=async x=>{o(x);try{await jt.post(`/contest/${x}/register`),c()}catch(w){alert(w.response?.data?.message||"Registration failed. Please try again."),console.error("Registration failed",w)}finally{o(null)}},f=(()=>{const x=new Date;return console.log("Filtering contests at:",x.toISOString()),e.filter(w=>{const _=new Date(w.startTime),S=new Date(w.endTime);return console.log(`Contest "${w.title}":`,{start:_.toISOString(),end:S.toISOString(),now:x.toISOString(),isUpcoming:x<_,isOngoing:x>=_&&x<=S,isPast:x>S}),r==="Upcoming"?x<_:r==="Ongoing"?x>=_&&x<=S:r==="Past"?x>S:!1}).sort((w,_)=>new Date(w.startTime)-new Date(_.startTime))})(),m=e.length,v=e.filter(x=>new Date<new Date(x.startTime)).length,y=e.filter(x=>{const w=new Date;return w>=new Date(x.startTime)&&w<=new Date(x.endTime)}).length;return l?h.jsxs("div",{className:" min-h-screen w-full bg-gray-50 dark:bg-[#1E1E1E]",children:[h.jsx("div",{className:"fixed inset-0 z-0 pointer-events-none",children:h.jsx(_a,{particleColors:["#3b82f6","#8b5cf6","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1,className:"absolute inset-0 w-full h-full"})}),h.jsx("div",{className:"relative z-10 p-4 sm:p-6 lg:p-8",children:h.jsxs("div",{className:"max-w-4xl mx-auto",children:[h.jsxs("header",{className:"text-center mb-12 space-y-6","data-aos":"fade-down",children:[h.jsx("div",{className:"relative inline-block",children:h.jsx(qh,{className:"w-12 h-12 mx-auto text-primary drop-shadow-lg"})}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("h1",{className:"text-4xl sm:text-5xl font-bold text-gray-900 dark:text-white",children:"Competitive Programming Contests"}),h.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 mt-2",children:"Test your skills, climb the leaderboard."})]}),h.jsxs("div",{className:"flex justify-center gap-8 pt-6",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl font-bold text-primary",children:m}),h.jsx("div",{className:"text-sm text-gray-500 dark:text-slate-400",children:"Total Contests"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-emerald-400",children:v}),h.jsx("div",{className:"text-sm text-gray-500 dark:text-slate-400",children:"Upcoming"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:y}),h.jsx("div",{className:"text-sm text-gray-500 dark:text-slate-400",children:"Live Now"})]})]})]}),h.jsx("div",{className:"flex justify-center mb-10","data-aos":"fade-down","data-aos-delay":"200",children:h.jsx("div",{className:"relative p-1 bg-white/10 dark:bg-slate-800/50 backdrop-blur-sm rounded-2xl border border-gray-200/30 dark:border-gray-700/50 shadow-lg",children:h.jsxs("div",{className:"flex relative",children:[h.jsx("div",{className:`absolute top-1 bottom-1 bg-gradient-to-r from-primary to-purple-600 rounded-xl transition-all duration-500 ease-in-out shadow-lg z-0 ${r==="Upcoming"?"left-1 right-[66.666%]":r==="Ongoing"?"left-[41.333%] right-[30.333%]":"left-[70.666%] right-1"}`}),["Upcoming","Ongoing","Past"].map(x=>h.jsxs("button",{className:`relative z-10 px-6 py-3 rounded-xl font-semibold text-sm transition-all duration-300 min-w-[120px] flex items-center justify-center gap-2 ${r===x?"text-white shadow-lg":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-white/10"}`,onClick:()=>i(x),children:[x==="Upcoming"&&h.jsx(Dp,{className:"w-4 h-4"}),x==="Ongoing"&&h.jsx(Lg,{className:`w-4 h-4 ${r===x?"animate-pulse":""}`}),x==="Past"&&h.jsx(Iz,{className:"w-4 h-4"}),h.jsx("span",{children:x}),x==="Ongoing"&&y>0&&h.jsx("span",{className:`ml-1 px-2 py-0.5 text-xs rounded-full font-bold transition-all duration-300 ${r===x?"bg-white/20 text-white":"bg-green-500 text-white animate-pulse"}`,children:y}),x==="Upcoming"&&v>0&&r!==x&&h.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-blue-500/20 text-blue-600 dark:text-blue-400 rounded-full font-bold",children:v})]},x))]})})}),h.jsx("main",{className:"space-y-8",children:n?h.jsx("div",{className:"flex justify-center p-16",children:h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"w-16 h-16 border-4 border-primary/20 border-t-primary rounded-full animate-spin"}),h.jsx("div",{className:"absolute top-2 left-2 w-12 h-12 border-4 border-purple-500/20 border-t-purple-500 rounded-full animate-spin animation-delay-75"})]})}):f.length>0?f.map((x,w)=>h.jsx("div",{"data-aos":"fade-up","data-aos-delay":w*100,children:h.jsx(ySt,{contest:x,onRegister:u,isRegistering:a===x._id})},x._id)):h.jsxs("div",{className:"text-center py-16 space-y-6",children:[h.jsxs("div",{className:"relative w-24 h-24 mx-auto",children:[h.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-gray-200/50 to-gray-300/50 dark:from-slate-800/50 dark:to-slate-700/50 backdrop-blur-sm"}),h.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-primary/10 to-purple-500/10 animate-pulse"}),h.jsxs("div",{className:"relative flex items-center justify-center w-full h-full",children:[r==="Upcoming"&&h.jsx(Dp,{className:"w-12 h-12 text-gray-400 dark:text-slate-500"}),r==="Ongoing"&&h.jsx(Lg,{className:"w-12 h-12 text-gray-400 dark:text-slate-500"}),r==="Past"&&h.jsx(Iz,{className:"w-12 h-12 text-gray-400 dark:text-slate-500"})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["No ",r," Contests"]}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-md mx-auto",children:r==="Upcoming"?"New contests are being planned. Check back later for exciting coding challenges!":r==="Ongoing"?"No contests are currently running. Keep an eye on upcoming events!":"Check out our upcoming contests to participate in future competitions!"})]}),h.jsx("div",{className:"pt-4",children:r!=="Upcoming"&&v>0&&h.jsxs("button",{onClick:()=>i("Upcoming"),className:"px-6 py-3 bg-gradient-to-r from-primary to-purple-600 hover:from-primary/90 hover:to-purple-600/90 text-white font-semibold rounded-xl transition-all duration-300 hover:shadow-lg hover:shadow-primary/25 hover:-translate-y-0.5 flex items-center gap-2 mx-auto",children:[h.jsx(Dp,{className:"w-5 h-5"}),"View Upcoming Contests",h.jsx(Ky,{className:"w-4 h-4"})]})})]})})]})})]}):h.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-10 bg-gradient-to-br from-sky-100 to-pink-100 dark:from-slate-800 dark:to-slate-600",children:h.jsx(yb,{message:"You need to be logged in to start or join a collaborative programming session."})})}const bSt=({contest:e,onClose:t})=>{if(!e)return null;const[r,i]=O.useState("Participants"),n=o=>new Date(o).toLocaleString([],{dateStyle:"medium",timeStyle:"short"}),s=(o,l)=>{const c=(new Date(l)-new Date(o))/6e4;return c<60?`${c}m`:`${Math.floor(c/60)}h ${c%60}m`},a=o=>{o.target===o.currentTarget&&t()};return h.jsx("div",{className:`modal ${e?"modal-open":""}`,onClick:a,children:h.jsxs("div",{className:"modal-box w-11/12 max-w-2xl bg-base-100/70 backdrop-blur-md border border-base-300/20 shadow-2xl",onClick:o=>o.stopPropagation(),children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-secondary rounded-xl blur-sm opacity-10 group-hover:opacity-20 transition-all duration-300"}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute right-4 top-4",children:h.jsx("button",{onClick:t,className:"btn btn-sm btn-circle btn-ghost bg-base-200/50 backdrop-blur-sm border border-base-300/20 hover:bg-error/20 hover:text-error transition-all duration-300",children:"✕"})}),h.jsx("h3",{className:"font-bold text-2xl bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent mb-2",children:e.title}),h.jsx("p",{className:"text-base-content/70 mb-6",children:e.description}),h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-sm mb-6 text-base-content/80",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Dp,{size:14,className:"text-primary"}),h.jsx("strong",{children:"Starts:"})," ",n(e.startTime)]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Rc,{size:14,className:"text-primary"}),h.jsx("strong",{children:"Duration:"})," ",s(e.startTime,e.endTime)]})]}),h.jsx("div",{className:"relative p-1 bg-base-200/50 backdrop-blur-sm rounded-2xl border border-base-300/20 shadow-lg mb-4",children:h.jsxs("div",{className:"flex relative",children:[h.jsx("div",{className:`absolute top-1 bottom-1 bg-gradient-to-r from-primary to-secondary rounded-xl transition-all duration-300 ease-in-out shadow-lg z-0 ${r==="Participants"?"left-1 right-[50%]":"left-[50%] right-1"}`}),h.jsxs("button",{className:`relative z-10 px-4 py-2 rounded-xl font-semibold text-sm transition-all duration-300 flex-1 flex items-center justify-center gap-2 ${r==="Participants"?"text-white shadow-lg":"text-base-content/70 hover:text-base-content hover:bg-base-200/10"}`,onClick:()=>i("Participants"),children:[h.jsx(Zu,{size:16}),"Participants (",e.participants?.length||0,")"]}),h.jsxs("button",{className:`relative z-10 px-4 py-2 rounded-xl font-semibold text-sm transition-all duration-300 flex-1 flex items-center justify-center gap-2 ${r==="Problems"?"text-white shadow-lg":"text-base-content/70 hover:text-base-content hover:bg-base-200/10"}`,onClick:()=>i("Problems"),children:[h.jsx(zz,{size:16}),"Problems (",e.problems?.length||0,")"]})]})}),h.jsxs("div",{className:"max-h-60 overflow-y-auto bg-base-200/30 backdrop-blur-sm p-4 rounded-lg border border-base-300/20",children:[r==="Participants"&&(e.participants&&e.participants.length>0?h.jsx("ul",{className:"space-y-3",children:e.participants.map(o=>h.jsxs("li",{className:"flex items-center gap-3 p-2 rounded-lg bg-base-100/30 backdrop-blur-sm border border-base-300/20 hover:bg-base-100/50 transition-all duration-300",children:[h.jsx("div",{className:"avatar",children:h.jsx("div",{className:"w-8 rounded-full ring-2 ring-primary/20",children:h.jsx("img",{src:o.profile_pic_url||`https://ui-avatars.com/api/?name=${o.first_name}&background=random`,alt:o.first_name})})}),h.jsx("span",{className:"font-semibold text-base-content",children:o.first_name})]},o._id))}):h.jsxs("div",{className:"text-center py-8",children:[h.jsx("div",{className:"text-4xl mb-2",children:"👥"}),h.jsx("p",{className:"text-base-content/60",children:"No participants have registered yet."})]})),r==="Problems"&&(e.problems&&e.problems.length>0?h.jsx("ul",{className:"space-y-2",children:e.problems.map(o=>h.jsxs("li",{className:"bg-base-100/30 backdrop-blur-sm p-3 rounded-lg border border-base-300/20 font-mono text-sm text-base-content hover:bg-base-100/50 transition-all duration-300",children:[h.jsxs("span",{className:"badge badge-outline badge-sm bg-primary/10 text-primary border-primary/20 mr-2",children:["#",o.serial_number]}),o.title]},o._id))}):h.jsxs("div",{className:"text-center py-8",children:[h.jsx("div",{className:"text-4xl mb-2",children:"📝"}),h.jsx("p",{className:"text-base-content/60",children:"No problems added yet."})]}))]})]})]})})},wSt=()=>{const[e,t]=O.useState([]),[r,i]=O.useState(!0),[n,s]=O.useState(""),[a,o]=O.useState(null),[l,c]=O.useState(null),[u,d]=O.useState(!1),[f,m]=O.useState("table");O.useEffect(()=>{Hn.init({duration:800,once:!1}),v()},[]);const v=async()=>{try{i(!0);const T=await jt.get("/contest/getcontest");t(T.data)}catch(T){s("Failed to fetch contests."),console.error(T)}finally{i(!1)}},y=T=>{o(T)},x=async T=>{try{d(!0);const E=await jt.get(`/contest/${T}`);c(E.data)}catch(E){alert("Could not fetch contest details."),console.error(E)}finally{d(!1)}},w=async()=>{if(a)try{await jt.delete(`/contest/delete/${a._id}`),t(e.filter(T=>T._id!==a._id)),o(null)}catch(T){alert("Failed to delete contest."),console.error("Delete error:",T),o(null)}},_=T=>new Date(T).toLocaleString(),S=(T,E)=>{const N=Math.round((new Date(E)-new Date(T))/6e4);return N<60?`${N}m`:`${Math.floor(N/60)}h ${N%60}m`},P=(T,E)=>{const N=new Date;return N<new Date(T)?h.jsx("div",{className:"badge badge-info font-semibold shadow-sm",children:"Upcoming"}):N>=new Date(T)&&N<=new Date(E)?h.jsx("div",{className:"badge badge-success font-semibold shadow-sm animate-pulse",children:"Ongoing"}):h.jsx("div",{className:"badge badge-neutral font-semibold shadow-sm",children:"Past"})},M=T=>{T.target===T.currentTarget&&o(null)},C=()=>r?h.jsx("div",{className:"flex justify-center items-center min-h-[400px]","data-aos":"fade-in",children:h.jsxs("div",{className:"text-center space-y-4",children:[h.jsx("span",{className:"loading loading-spinner loading-lg text-primary"}),h.jsx("p",{className:"text-base-content/70",children:"Loading contests..."})]})}):n?h.jsxs("div",{className:"group relative","data-aos":"fade-up",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-error to-warning rounded-xl blur-sm opacity-20 group-hover:opacity-30 transition-all duration-300"}),h.jsx("div",{className:"relative alert alert-error shadow-xl bg-base-100/70 backdrop-blur-md border border-error/20",children:h.jsxs("div",{children:[h.jsx(qP,{className:"stroke-current flex-shrink-0 h-6 w-6"}),h.jsx("span",{children:n})]})})]}):e.length===0?h.jsxs("div",{className:"text-center py-16","data-aos":"fade-up",children:[h.jsx("div",{className:"text-6xl mb-4",children:"🏆"}),h.jsx("h3",{className:"text-xl font-semibold mb-2 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"No contests found"}),h.jsx("p",{className:"text-base-content/60 mb-6",children:"Get started by adding your first contest"}),h.jsxs(hr,{to:"/admin/contests/create",className:"btn btn-primary bg-gradient-to-r from-primary to-secondary border-none text-white gap-2",children:[h.jsx(Hl,{size:16}),"Add New Contest"]})]}):f==="grid"?h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:e.map((T,E)=>h.jsxs("div",{className:"group relative","data-aos":"fade-up","data-aos-delay":E*50,children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-secondary rounded-xl blur-sm opacity-10 group-hover:opacity-30 transition-all duration-300"}),h.jsx("div",{className:"relative card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20 transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl",children:h.jsxs("div",{className:"card-body",children:[h.jsxs("div",{className:"flex items-start justify-between mb-3",children:[P(T.startTime,T.endTime),h.jsxs("div",{className:"dropdown dropdown-end",children:[h.jsx("div",{tabIndex:0,role:"button",className:"btn btn-ghost btn-xs",children:"⋮"}),h.jsxs("ul",{tabIndex:0,className:"dropdown-content z-[1] menu p-2 shadow bg-base-100/70 backdrop-blur-md rounded-box w-32 border border-base-300/20",children:[h.jsx("li",{children:h.jsxs("button",{onClick:()=>x(T._id),className:`text-sm ${u?"loading":""}`,disabled:u,children:[h.jsx(Qu,{size:14})," View"]})}),h.jsx("li",{children:h.jsxs(hr,{to:`/admin/contests/edit/${T._id}`,className:"text-sm",children:[h.jsx(Vz,{size:14})," Edit"]})}),h.jsx("li",{children:h.jsxs("button",{onClick:()=>y(T),className:"text-sm text-error",children:[h.jsx(Ic,{size:14})," Delete"]})})]})]})]}),h.jsx("h2",{className:"card-title text-lg mb-3 line-clamp-2 bg-gradient-to-r from-base-content to-base-content/80 bg-clip-text",children:T.title}),h.jsx("p",{className:"text-base-content/70 text-sm mb-4 line-clamp-2",children:T.description}),h.jsxs("div",{className:"space-y-2 mb-4",children:[h.jsxs("div",{className:"flex items-center gap-2 text-sm text-base-content/80",children:[h.jsx(Dp,{className:"w-4 h-4 text-primary/70"}),h.jsx("span",{children:_(T.startTime)})]}),h.jsxs("div",{className:"flex items-center gap-2 text-sm text-base-content/80",children:[h.jsx(Rc,{className:"w-4 h-4 text-primary/70"}),h.jsx("span",{children:S(T.startTime,T.endTime)})]}),h.jsxs("div",{className:"flex items-center gap-2 text-sm text-base-content/80",children:[h.jsx(Zu,{className:"w-4 h-4 text-primary/70"}),h.jsxs("span",{children:[T.participants?.length||0," / ",T.maxParticipants," participants"]})]})]}),h.jsx("div",{className:"card-actions justify-end",children:h.jsxs("button",{onClick:()=>x(T._id),className:"btn btn-primary btn-sm gap-2 bg-gradient-to-r from-primary to-secondary border-none text-white",disabled:u,children:[h.jsx(Qu,{size:14}),"View Details"]})})]})})]},T._id))}):h.jsxs("div",{className:"group relative","data-aos":"fade-up",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-accent rounded-xl blur-sm opacity-10 group-hover:opacity-20 transition-all duration-300"}),h.jsx("div",{className:"relative card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20",children:h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"table table-zebra w-full",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-base-200/50 backdrop-blur-sm",children:[h.jsx("th",{className:"font-bold text-base-content",children:"Title"}),h.jsx("th",{className:"font-bold text-base-content",children:"Status"}),h.jsx("th",{className:"font-bold text-base-content",children:"Start Time"}),h.jsx("th",{className:"font-bold text-base-content",children:"Duration"}),h.jsx("th",{className:"font-bold text-base-content",children:"Participants"}),h.jsx("th",{className:"font-bold text-base-content text-right",children:"Actions"})]})}),h.jsx("tbody",{children:e.map((T,E)=>h.jsxs("tr",{className:"hover:bg-base-200/30 transition-colors duration-200",children:[h.jsx("td",{className:"font-semibold text-base-content max-w-md",children:h.jsx("div",{className:"truncate",children:T.title})}),h.jsx("td",{children:P(T.startTime,T.endTime)}),h.jsx("td",{className:"text-base-content/80",children:_(T.startTime)}),h.jsx("td",{className:"text-base-content/80",children:S(T.startTime,T.endTime)}),h.jsx("td",{children:h.jsxs("span",{className:"font-mono bg-primary/10 text-primary px-2 py-1 rounded-md border border-primary/20",children:[T.participants?.length||0," / ",T.maxParticipants]})}),h.jsx("td",{className:"text-right",children:h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsx("button",{onClick:()=>x(T._id),className:`btn btn-ghost btn-xs hover:bg-info/20 hover:text-info ${u?"loading":""}`,title:"View",disabled:u,children:!u&&h.jsx(Qu,{size:16})}),h.jsx(hr,{to:`/admin/contests/edit/${T._id}`,className:"btn btn-ghost btn-xs hover:bg-warning/20 hover:text-warning",title:"Edit",children:h.jsx(Vz,{size:16})}),h.jsx("button",{onClick:()=>y(T),className:"btn btn-ghost btn-xs hover:bg-error/20 hover:text-error",title:"Delete",children:h.jsx(Ic,{size:16})})]})})]},T._id))})]})})})]});return h.jsxs("div",{className:"relative min-h-screen bg-base-100 p-4 sm:p-8 overflow-hidden",children:[h.jsxs("div",{className:"fixed inset-0 z-0 pointer-events-none",children:[h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100,moveParticlesOnHover:!0,alphaParticles:!1,disableRotation:!1}),h.jsx("div",{className:"absolute bottom-0 left-[-20%] right-0 top-[-10%] h-[500px] w-[500px] rounded-full bg-[radial-gradient(circle_farthest-side,rgba(var(--color-primary),0.1),transparent)]"}),h.jsx("div",{className:"absolute bottom-0 right-[-20%] top-[-10%] h-[500px] w-[500px] rounded-full bg-[radial-gradient(circle_farthest-side,rgba(var(--color-accent),0.1),transparent)]"})]}),h.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto space-y-8",children:[h.jsxs("div",{className:"text-center space-y-4 pt-10","data-aos":"fade-down",children:[h.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent",children:"🏆 Contest Management Hub"}),h.jsx(LD,{texts:["Manage competitive events","Create coding challenges","Monitor contest progress","Build coding community"],mainClassName:"text-base-content/70 font-medium text-base sm:text-lg flex justify-center",staggerDuration:.03,rotationInterval:4e3}),h.jsxs("div",{className:"flex justify-center gap-8 mt-6",children:[h.jsx("div",{className:"text-center","data-aos":"fade-up","data-aos-delay":"100",children:h.jsxs("div",{className:"group relative inline-block",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-secondary rounded-xl blur-sm opacity-20 group-hover:opacity-40 transition-all duration-300"}),h.jsxs("div",{className:"relative bg-base-100/70 backdrop-blur-md px-6 py-4 rounded-xl shadow-xl border border-base-300/20",children:[h.jsx("div",{className:"text-sm text-base-content/70 font-medium",children:"Total Contests"}),h.jsx("div",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent mt-1",children:h.jsx(_c,{from:0,to:e.length,separator:",",direction:"up",duration:2,className:"count-up-text"})})]})]})}),h.jsx("div",{className:"text-center","data-aos":"fade-up","data-aos-delay":"200",children:h.jsxs("div",{className:"group relative inline-block",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-success to-info rounded-xl blur-sm opacity-20 group-hover:opacity-40 transition-all duration-300"}),h.jsxs("div",{className:"relative bg-base-100/70 backdrop-blur-md px-6 py-4 rounded-xl shadow-xl border border-base-300/20",children:[h.jsx("div",{className:"text-sm text-base-content/70 font-medium",children:"Active Contests"}),h.jsx("div",{className:"text-3xl font-bold bg-gradient-to-r from-success to-info bg-clip-text text-transparent mt-1",children:h.jsx(_c,{from:0,to:e.filter(T=>{const E=new Date;return E>=new Date(T.startTime)&&E<=new Date(T.endTime)}).length,separator:",",direction:"up",duration:2,className:"count-up-text"})})]})]})})]})]}),h.jsxs("div",{className:"group relative","data-aos":"fade-up","data-aos-delay":"100",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-info to-primary rounded-xl blur-sm opacity-10 group-hover:opacity-20 transition-all duration-300"}),h.jsx("div",{className:"relative card bg-base-100/70 backdrop-blur-md shadow-xl border border-base-300/20",children:h.jsx("div",{className:"card-body",children:h.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx(qh,{className:"text-primary w-6 h-6"}),h.jsxs("div",{children:[h.jsx("h2",{className:"font-bold text-lg bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"Manage Contests"}),h.jsx("p",{className:"text-base-content/60 text-sm",children:"View, create, edit, and delete all competitive events"})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("div",{className:"join",children:[h.jsxs("button",{className:`btn join-item gap-2 ${f==="table"?"btn-primary bg-gradient-to-r from-primary to-secondary border-none text-white":"btn-outline"}`,onClick:()=>m("table"),children:[h.jsx(Eh,{size:16}),"Table"]}),h.jsxs("button",{className:`btn join-item gap-2 ${f==="grid"?"btn-primary bg-gradient-to-r from-primary to-secondary border-none text-white":"btn-outline"}`,onClick:()=>m("grid"),children:[h.jsx(OD,{size:16}),"Grid"]})]}),h.jsxs(hr,{to:"/admin/contests/create",className:"btn btn-primary bg-gradient-to-r from-primary to-secondary border-none text-white gap-2",children:[h.jsx(Hl,{size:16}),"Add New Contest"]})]})]})})})]}),h.jsx("main",{children:C()})]}),h.jsx(bSt,{contest:l,onClose:()=>c(null)}),h.jsx("div",{className:`modal ${a?"modal-open":""}`,onClick:M,children:h.jsxs("div",{className:"modal-box bg-base-100/70 backdrop-blur-md border border-base-300/20 shadow-2xl",onClick:T=>T.stopPropagation(),children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-error to-warning rounded-xl blur-sm opacity-20 transition-all duration-300"}),h.jsxs("div",{className:"relative",children:[h.jsxs("h3",{className:"font-bold text-xl text-error flex items-center gap-2 mb-4",children:[h.jsx(qP,{}),"Confirm Deletion"]}),h.jsxs("p",{className:"py-4 text-base-content",children:["Are you sure you want to delete the contest ",h.jsxs("span",{className:"font-semibold text-primary",children:['"',a?.title,'"']}),"? This action cannot be undone."]}),h.jsxs("div",{className:"modal-action",children:[h.jsx("button",{onClick:()=>o(null),className:"btn btn-outline",children:"Cancel"}),h.jsx("button",{onClick:w,className:"btn btn-error",children:"Delete Contest"})]})]})]})})]})},_St=x0({title:on().min(5,"Title must be at least 5 characters"),description:on().min(20,"Description must be at least 20 characters"),startTime:on().min(1,"Start time is required"),endTime:on().min(1,"End time is required"),maxParticipants:Gle.number().int().positive("Must be a positive number"),problems:Hle(on()).min(1,"Please add at least one problem to the contest.")}).refine(e=>new Date(e.endTime)>new Date(e.startTime),{message:"End time must be after start time",path:["endTime"]}),SSt=()=>{const e=fs(),{register:t,handleSubmit:r,formState:{errors:i},setValue:n,trigger:s}=$c({resolver:y0(_St),mode:"onTouched"}),[a,o]=O.useState(!1),[l,c]=O.useState(""),[u,d]=O.useState(""),[f,m]=O.useState(""),[v,y]=O.useState([]),[x,w]=O.useState(!1),[_,S]=O.useState("");O.useEffect(()=>{const T=v.map(E=>E._id);n("problems",T),T.length>0&&s("problems")},[v,n,s]),O.useEffect(()=>{Hn.init({duration:800,once:!0,easing:"ease-out-cubic"})},[]);const P=async()=>{if(f.trim()){w(!0),S("");try{const E=(await jt.get(`/contest/find?query=${f.trim()}`)).data;v.some(N=>N._id===E._id)?S("This problem has already been added."):(y(N=>[...N,E]),m(""))}catch(T){S(T.response?.data?.message||"Problem not found.")}finally{w(!1)}}},M=T=>{y(E=>E.filter(N=>N._id!==T))},C=async T=>{o(!0),c(""),d("");try{const E=new Date(T.startTime),N=new Date(T.endTime),D=E.toISOString(),I=N.toISOString(),j={...T,startTime:D,endTime:I},L=await jt.post("/contest/create",j);d("Contest created successfully! Redirecting..."),setTimeout(()=>e("/admin/contest"),2e3)}catch(E){c(E.response?.data?.message||"Failed to create contest.")}finally{o(!1)}};return h.jsx("div",{className:"relative min-h-screen w-full p-4 sm:p-6 lg:p-8 bg-[#1E1E1E]",children:h.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto",children:[h.jsx("header",{"data-aos":"fade-down",className:"flex items-center justify-between mb-8"}),h.jsx("div",{"data-aos":"fade-up",className:"bg-base-100/10 backdrop-blur-md border border-gray-700 p-8 rounded-2xl shadow-2xl",children:h.jsxs("form",{onSubmit:r(C),className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"Contest Title"})}),h.jsx("input",{type:"text",placeholder:"e.g., Weekly Coding Showdown #3",className:`input input-bordered w-full bg-base-300/20 ${i.title?"input-error":""}`,...t("title")}),i.title&&h.jsx("p",{className:"text-error text-sm mt-1",children:i.title.message})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"Description"})}),h.jsx("textarea",{placeholder:"A brief and exciting summary of the contest.",className:`textarea textarea-bordered w-full h-24 bg-base-300/20 ${i.description?"textarea-error":""}`,...t("description")}),i.description&&h.jsx("p",{className:"text-error text-sm mt-1",children:i.description.message})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"Start Time"})}),h.jsx("input",{type:"datetime-local",className:`input input-bordered w-full bg-base-300/20 ${i.startTime?"input-error":""}`,...t("startTime")}),i.startTime&&h.jsx("p",{className:"text-error text-sm mt-1",children:i.startTime.message})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"End Time"})}),h.jsx("input",{type:"datetime-local",className:`input input-bordered w-full bg-base-300/20 ${i.endTime?"input-error":""}`,...t("endTime")}),i.endTime&&h.jsx("p",{className:"text-error text-sm mt-1",children:i.endTime.message})]})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"Max Participants"})}),h.jsx("input",{type:"number",defaultValue:100,className:`input input-bordered w-full bg-base-300/20 ${i.maxParticipants?"input-error":""}`,...t("maxParticipants")}),i.maxParticipants&&h.jsx("p",{className:"text-error text-sm mt-1",children:i.maxParticipants.message})]})}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"Add Problems"})}),h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsxs("div",{className:"relative flex-grow",children:[h.jsx(Wh,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),h.jsx("input",{type:"text",placeholder:"Find by Serial Number or exact Title",className:"input input-bordered w-full bg-base-300/20 pl-10",value:f,onChange:T=>m(T.target.value),onKeyDown:T=>{T.key==="Enter"&&(T.preventDefault(),P())}})]}),h.jsxs("button",{type:"button",onClick:P,disabled:x,className:`btn btn-sm  btn-secondary h-10 flex-shrink-0 ${x?"loading":""}`,children:[h.jsx(Hl,{size:18})," Add"]})]}),_&&h.jsx("p",{className:"text-error text-sm mt-1",children:_}),i.problems&&h.jsx("p",{className:"text-error text-sm mt-1",children:i.problems.message})]}),v.length>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-gray-400",children:"Selected Problems:"})}),h.jsx("ul",{className:"p-4 bg-base-300/20 rounded-lg space-y-2 border border-gray-700",children:v.map(T=>h.jsxs("li",{className:"flex items-center justify-between bg-base-100/10 p-2 rounded-md animate-fade-in",children:[h.jsxs("span",{className:"font-semibold text-white",children:["#",T.serial_number," - ",T.title]}),h.jsx("button",{type:"button",onClick:()=>M(T._id),className:"btn btn-ghost btn-xs text-error",children:h.jsx(Dc,{size:16})})]},T._id))})]}),h.jsx("input",{type:"hidden",...t("problems")}),u&&h.jsxs("div",{className:"alert alert-success text-sm",children:[h.jsx(Sh,{}),h.jsx("span",{children:u})]}),l&&h.jsxs("div",{className:"alert alert-error text-sm",children:[h.jsx(Dh,{}),h.jsx("span",{children:l})]}),h.jsx("div",{className:"flex justify-end pt-4",children:h.jsx("button",{type:"submit",disabled:a,className:`btn btn-primary w-full sm:w-auto ${a?"loading":""}`,children:a?"Creating...":"Create Contest"})})]})})]})})},ESt=x0({title:on().min(5,"Title must be at least 5 characters"),description:on().min(20,"Description must be at least 20 characters"),startTime:on().min(1,"Start time is required"),endTime:on().min(1,"End time is required"),maxParticipants:Gle.number().int().positive("Must be a positive number"),problems:Hle(on()).min(1,"Please add at least one problem.")}).refine(e=>new Date(e.endTime)>new Date(e.startTime),{message:"End time must be after start time",path:["endTime"]}),ASt=()=>{const{contestId:e}=Qp(),t=fs(),{register:r,handleSubmit:i,formState:{errors:n},setValue:s,reset:a,trigger:o}=$c({resolver:y0(ESt),mode:"onTouched"}),[l,c]=O.useState(!1),[u,d]=O.useState(!0),[f,m]=O.useState(""),[v,y]=O.useState(""),[x,w]=O.useState(""),[_,S]=O.useState([]),[P,M]=O.useState(!1),[C,T]=O.useState("");O.useEffect(()=>{(async()=>{try{const L=(await jt.get(`/contest/get/${e}`)).data;a({title:L.title,description:L.description,startTime:new Date(L.startTime).toISOString().slice(0,16),endTime:new Date(L.endTime).toISOString().slice(0,16),maxParticipants:L.maxParticipants,problems:L.problems.map(B=>B._id)}),S(L.problems)}catch{m("Failed to load contest data.")}finally{d(!1)}})()},[e,a]),O.useEffect(()=>{const I=_.map(j=>j._id);s("problems",I),I.length>0&&o("problems")},[_,s,o]),O.useEffect(()=>{Hn.init({duration:800,once:!0,easing:"ease-out-cubic"})},[]);const E=async()=>{if(x.trim()){M(!0),T("");try{const j=(await jt.get(`/contest/find?query=${x.trim()}`)).data;_.some(L=>L._id===j._id)?T("This problem is already added."):(S(L=>[...L,j]),w(""))}catch(I){T(I.response?.data?.message||"Problem not found.")}finally{M(!1)}}},N=I=>{S(j=>j.filter(L=>L._id!==I))},D=async I=>{c(!0),m(""),y("");try{await jt.put(`/contest/edit/${e}`,I),y("Contest updated successfully! Redirecting..."),setTimeout(()=>t("/admin/contest"),2e3)}catch(j){m(j.response?.data?.message||"Failed to update contest.")}finally{c(!1)}};return u?h.jsx("div",{className:"min-h-screen bg-[#1E1E1E] flex justify-center items-center",children:h.jsx("span",{className:"loading loading-spinner loading-lg"})}):h.jsx("div",{className:"relative min-h-screen w-full p-4 sm:p-6 lg:p-8 bg-[#1E1E1E]",children:h.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto",children:[h.jsxs("header",{"data-aos":"fade-down",className:"flex items-center justify-between mb-8",children:[h.jsxs("div",{children:[h.jsxs("h1",{className:"text-4xl font-bold text-white flex items-center gap-3",children:[h.jsx(qh,{className:"text-primary"})," Edit Contest"]}),h.jsx("p",{className:"text-gray-400 mt-2",children:"Modify the details of the competitive event."})]}),h.jsxs(hr,{to:"/admin/contest",className:"btn btn-outline border-gray-600",children:[h.jsx(rfe,{size:16})," Back to List"]})]}),h.jsx("div",{"data-aos":"fade-up",className:"bg-base-100/10 backdrop-blur-md border border-gray-700 p-8 rounded-2xl shadow-2xl",children:h.jsxs("form",{onSubmit:i(D),className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"Contest Title"})}),h.jsx("input",{type:"text",className:`input input-bordered w-full bg-base-300/20 ${n.title?"input-error":""}`,...r("title")}),n.title&&h.jsx("p",{className:"text-error text-sm mt-1",children:n.title.message})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"Description"})}),h.jsx("textarea",{className:`textarea textarea-bordered w-full h-24 bg-base-300/20 ${n.description?"textarea-error":""}`,...r("description")}),n.description&&h.jsx("p",{className:"text-error text-sm mt-1",children:n.description.message})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"Start Time"})}),h.jsx("input",{type:"datetime-local",className:`input input-bordered w-full bg-base-300/20 ${n.startTime?"input-error":""}`,...r("startTime")}),n.startTime&&h.jsx("p",{className:"text-error text-sm mt-1",children:n.startTime.message})]}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"End Time"})}),h.jsx("input",{type:"datetime-local",className:`input input-bordered w-full bg-base-300/20 ${n.endTime?"input-error":""}`,...r("endTime")}),n.endTime&&h.jsx("p",{className:"text-error text-sm mt-1",children:n.endTime.message})]})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"Max Participants"})}),h.jsx("input",{type:"number",className:`input input-bordered w-full bg-base-300/20 ${n.maxParticipants?"input-error":""}`,...r("maxParticipants")}),n.maxParticipants&&h.jsx("p",{className:"text-error text-sm mt-1",children:n.maxParticipants.message})]})}),h.jsxs("div",{children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-white",children:"Manage Problems"})}),h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsxs("div",{className:"relative flex-grow",children:[h.jsx(Wh,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"}),h.jsx("input",{type:"text",placeholder:"Find by Serial Number or exact Title",className:"input input-bordered w-full bg-base-300/20 pl-10",value:x,onChange:I=>w(I.target.value),onKeyDown:I=>{I.key==="Enter"&&(I.preventDefault(),E())}})]}),h.jsxs("button",{type:"button",onClick:E,disabled:P,className:`btn btn-secondary btn-sm h-10 flex-shrink-0 ${P?"loading":""}`,children:[h.jsx(Hl,{size:18})," Add"]})]}),C&&h.jsx("p",{className:"text-error text-sm mt-1",children:C}),n.problems&&h.jsx("p",{className:"text-error text-sm mt-1",children:n.problems.message})]}),_.length>0&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"label",children:h.jsx("span",{className:"label-text text-gray-400",children:"Selected Problems:"})}),h.jsx("ul",{className:"p-4 bg-base-300/20 rounded-lg space-y-2 border border-gray-700",children:_.map(I=>h.jsxs("li",{className:"flex items-center justify-between bg-base-100/10 p-2 rounded-md animate-fade-in",children:[h.jsxs("span",{className:"font-semibold text-white",children:["#",I.serial_number," - ",I.title]}),h.jsx("button",{type:"button",onClick:()=>N(I._id),className:"btn btn-ghost btn-xs text-error",children:h.jsx(Dc,{size:16})})]},I._id))})]}),h.jsx("input",{type:"hidden",...r("problems")}),v&&h.jsxs("div",{className:"alert alert-success text-sm",children:[h.jsx(Sh,{}),h.jsx("span",{children:v})]}),f&&h.jsxs("div",{className:"alert alert-error text-sm",children:[h.jsx(Dh,{}),h.jsx("span",{children:f})]}),h.jsx("div",{className:"flex justify-end pt-4",children:h.jsx("button",{type:"submit",disabled:l,className:`btn btn-primary w-full sm:w-auto ${l?"loading":""}`,children:l?"Updating...":"Save Changes"})})]})})]})})},CSt=()=>{const{contestId:e}=Qp(),t=fs(),[r,i]=O.useState(null),[n,s]=O.useState(null),[a,o]=O.useState(null),[l,c]=O.useState(null),[u,d]=O.useState(!0),[f,m]=O.useState(null);O.useEffect(()=>{(async()=>{if(!e){m("Contest ID is required"),d(!1);return}try{d(!0),m(null);const[S,P]=await Promise.all([jt.get(`/contest/${e}/arena`),jt.get(`/contest/${e}/progress`)]);i(S.data),s(P.data);const M=sessionStorage.getItem(`solvedProblem_${e}`);M&&(v(M,"SOLVED",P.data),sessionStorage.removeItem(`solvedProblem_${e}`))}catch(S){console.error("Error fetching contest data:",S),m(S.response?.data?.message||"Failed to load contest data")}finally{d(!1)}})()},[e]),O.useEffect(()=>{if(!r?.endTime)return;const _=setInterval(()=>{const S=new Date,M=new Date(r.endTime)-S;if(M<=0){o("Contest Ended"),clearInterval(_);return}const C=Math.floor(M/(1e3*60*60)),T=Math.floor(M%(1e3*60*60)/(1e3*60)),E=Math.floor(M%(1e3*60)/1e3);o(`${C.toString().padStart(2,"0")}:${T.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`)},1e3);return()=>clearInterval(_)},[r?.endTime]);const v=(_,S,P)=>{const M=P||n;if(!M)return;const C=M.problemProgress.map(E=>E.problemId?._id.toString()===_.toString()&&E.status!==S?{...E,status:S}:E),T=C.filter(E=>E.status==="SOLVED").length;s({...M,problemProgress:C,totalSolved:T})},y=async _=>{try{x(_)==="NOT_ATTEMPTED"&&v(_,"ATTEMPTED"),await jt.post(`/contest/${e}/track-visit/${_}`),t(`/problems/${_}?contestId=${e}`)}catch(S){console.error("Error tracking problem visit:",S),t(`/problems/${_}?contestId=${e}`)}},x=_=>n?.problemProgress&&n.problemProgress.find(P=>P.problemId?._id.toString()===_.toString())?.status||"NOT_ATTEMPTED",w=_=>{switch(_?.toLowerCase()){case"easy":return"text-green-500";case"medium":return"text-yellow-500";case"hard":return"text-red-500";default:return"text-gray-500"}};return u?h.jsx("div",{className:"flex justify-center items-center h-screen p-16",children:h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"w-16 h-16 border-4 border-primary/20 border-t-primary rounded-full animate-spin"}),h.jsx("div",{className:"absolute top-2 left-2 w-12 h-12 border-4 border-purple-500/20 border-t-purple-500 rounded-full animate-spin animation-delay-75"})]})}):f?h.jsxs("div",{children:["Error: ",f]}):r?h.jsxs("div",{className:"min-h-screen transition-all duration-500 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:[h.jsx("header",{className:"backdrop-blur-lg bg-white/10 dark:bg-gray-800/10 border-b border-white/20 dark:border-gray-700/20 sticky top-0 ",children:h.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center space-x-4",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(qh,{className:"w-8 h-8 text-yellow-500"}),h.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:r.title})]}),h.jsxs("div",{className:"hidden md:flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[h.jsx(Zu,{className:"w-4 h-4"}),h.jsxs("span",{children:[r.participants?.length||0," participants"]})]})]}),h.jsxs("div",{className:"flex items-center space-x-6",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(JJ,{className:"w-5 h-5 text-indigo-600"}),h.jsxs("span",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:[n?.totalSolved||0,"/",r.problems?.length||0]}),h.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"solved"})]}),h.jsxs("div",{className:"flex items-center space-x-2 bg-gradient-to-r from-red-500/10 to-orange-500/10 px-4 py-2 rounded-full",children:[h.jsx(Lg,{className:"w-5 h-5 text-red-500"}),h.jsx("span",{className:"text-lg font-mono font-bold text-red-600 dark:text-red-400",children:a})]})]})]}),h.jsx("div",{className:"mt-4",children:h.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:h.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 h-2 rounded-full transition-all duration-500",style:{width:`${(n?.totalSolved||0)/(r.problems?.length||1)*100}%`}})})})]})}),h.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[h.jsx("div",{className:"lg:col-span-1",children:h.jsxs("div",{className:"backdrop-blur-sm bg-white/10 dark:bg-gray-800/10 rounded-2xl border border-white/20 dark:border-gray-700/20 p-6 sticky top-24",children:[h.jsxs("h2",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center",children:[h.jsx(sl,{className:"w-5 h-5 mr-2 text-indigo-600"}),"Problems"]}),h.jsx("div",{className:"space-y-3",children:r.problems?.map((_,S)=>{const P=x(_._id);return h.jsxs("div",{className:`group cursor-pointer p-4 rounded-xl transition-all duration-300 hover:-translate-y-1 hover:shadow-lg ${l?._id===_._id?"bg-indigo-500/20 border-indigo-500/30":"bg-white/5 dark:bg-gray-800/5 hover:bg-white/10 dark:hover:bg-gray-800/10"} border border-white/10 dark:border-gray-700/10`,onClick:()=>c(_),children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsxs("div",{className:"flex items-center space-x-3",children:[P==="SOLVED"&&h.jsx(Sh,{className:"w-5 h-5 text-green-500"}),P==="ATTEMPTED"&&h.jsx(Rc,{className:"w-5 h-5 text-blue-500"}),P==="NOT_ATTEMPTED"&&h.jsx(Oz,{className:"w-5 h-5 text-gray-400"}),h.jsx("span",{className:"font-semibold text-gray-800 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors",children:_.title})]}),h.jsx(KJ,{className:"w-4 h-4 text-gray-400 group-hover:text-indigo-600 group-hover:translate-x-1 transition-all"})]}),h.jsxs("div",{className:"flex items-center justify-between text-sm",children:[h.jsx("span",{className:`${w(_.difficulty)} font-medium`,children:_.difficulty}),h.jsxs("div",{className:"flex items-center space-x-1",children:[h.jsx(WP,{className:"w-3 h-3 text-yellow-500"}),h.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:_.points})]})]})]},_._id)})})]})}),h.jsx("div",{className:"lg:col-span-3",children:h.jsx("div",{className:"backdrop-blur-sm bg-white/10 dark:bg-gray-800/10 rounded-2xl border border-white/20 dark:border-gray-700/20 p-8",children:l?h.jsxs("div",{children:[h.jsxs("div",{className:"mb-6",children:[h.jsxs("div",{className:"flex items-center justify-between mb-4",children:[h.jsx("h2",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:l.title}),h.jsxs("div",{className:"flex items-center space-x-3",children:[h.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${w(l.difficulty)} bg-current/10`,children:l.difficulty}),h.jsxs("div",{className:"flex items-center space-x-1",children:[h.jsx(WP,{className:"w-4 h-4 text-yellow-500"}),h.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[l.points," pts"]})]})]})]}),h.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[x(l._id)==="SOLVED"&&h.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[h.jsx(Sh,{className:"w-5 h-5"}),h.jsx("span",{className:"font-medium",children:"Solved"})]}),x(l._id)==="ATTEMPTED"&&h.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[h.jsx(Rc,{className:"w-5 h-5"}),h.jsx("span",{className:"font-medium",children:"Attempted"})]})]})]}),h.jsx("div",{children:h.jsxs("button",{onClick:()=>y(l._id),className:"group relative w-full sm:w-auto px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-700 to-purple-700 translate-y-full group-hover:translate-y-0 transition-transform duration-300"}),h.jsxs("div",{className:"relative flex items-center justify-center space-x-2",children:[h.jsx(YP,{className:"w-5 h-5 group-hover:scale-110 transition-transform"}),h.jsx("span",{children:"Solve Problem"}),h.jsx(KJ,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"})]})]})})]}):h.jsx("div",{children:h.jsxs("div",{className:"text-center",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx(qh,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),h.jsx("h2",{className:"text-4xl font-bold text-gray-800 dark:text-white mb-4",children:r.title}),h.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto",children:r.description})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[h.jsxs("div",{className:"backdrop-blur-sm bg-white/5 dark:bg-gray-800/5 rounded-xl p-6 border border-white/10 dark:border-gray-700/10",children:[h.jsx(Zu,{className:"w-8 h-8 text-indigo-600 mx-auto mb-2"}),h.jsx("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:r.participants?.length||0}),h.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Participants"})]}),h.jsxs("div",{className:"backdrop-blur-sm bg-white/5 dark:bg-gray-800/5 rounded-xl p-6 border border-white/10 dark:border-gray-700/10",children:[h.jsx(sl,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),h.jsx("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:r.problems?.length||0}),h.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Problems"})]}),h.jsxs("div",{className:"backdrop-blur-sm bg-white/5 dark:bg-gray-800/5 rounded-xl p-6 border border-white/10 dark:border-gray-700/10",children:[h.jsx(JJ,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),h.jsx("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:n?.totalSolved||0}),h.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Solved"})]})]}),h.jsxs("div",{className:"text-gray-600 dark:text-gray-400",children:[h.jsx("p",{className:"mb-4",children:"Select a problem from the sidebar to get started!"}),h.jsxs("div",{className:"flex items-center justify-center space-x-4 text-sm",children:[h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Dp,{className:"w-4 h-4"}),h.jsxs("span",{children:["Started: ",new Date(r.startTime).toLocaleString()]})]}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Lg,{className:"w-4 h-4"}),h.jsxs("span",{children:["Ends: ",new Date(r.endTime).toLocaleString()]})]})]})]})]})})})})]})})]}):null},lj=({entry:e,rank:t})=>{const i={1:{borderColor:"border-yellow-400",bgColor:"bg-yellow-400/10",textColor:"text-yellow-400",height:"h-48",icon:h.jsx(qh,{className:"w-8 h-8"})},2:{borderColor:"border-gray-300",bgColor:"bg-gray-300/10",textColor:"text-gray-300",height:"h-40",icon:h.jsx(Cot,{className:"w-8 h-8"})},3:{borderColor:"border-yellow-600/70",bgColor:"bg-yellow-600/10",textColor:"text-yellow-600/80",height:"h-40",icon:h.jsx(WP,{className:"w-8 h-8"})}}[t];return h.jsxs(Et.div,{className:`flex flex-col items-center justify-end w-1/3 p-4 m-1 rounded-t-xl border-b-4 ${i.borderColor} ${i.bgColor} ${i.height}`,initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5,delay:t*.2},children:[h.jsx("img",{src:e.userId.profile_pic_url||`https://ui-avatars.com/api/?name=${e.userId.first_name}&background=random`,alt:e.userId.username,className:"w-16 h-16 rounded-full border-2 border-white/50 shadow-lg"}),h.jsx("h3",{className:"mt-2 text-lg font-bold text-white truncate",children:e.userId.first_name}),h.jsx("div",{className:`mt-2 p-2 rounded-full ${i.textColor}`,children:i.icon}),h.jsx("p",{className:"mt-1 text-2xl font-black text-white",children:e.totalSolved}),h.jsx("p",{className:"text-xs text-gray-400",children:"Solved"})]})},TSt=({entry:e,rank:t})=>h.jsxs(Et.tr,{className:"border-b border-gray-700/50 hover:bg-gray-500/10",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:(t-4)*.05},children:[h.jsx("td",{className:"p-4 text-center font-bold text-lg text-gray-300",children:t}),h.jsxs("td",{className:"p-4 flex items-center space-x-3",children:[h.jsx("img",{src:e.userId.profile_pic_url||`https://ui-avatars.com/api/?name=${e.userId.first_name}&background=random`,alt:e.userId.username,className:"w-10 h-10 rounded-full"}),h.jsx("span",{className:"font-semibold text-white",children:e.userId.first_name})]}),h.jsx("td",{className:"p-4 text-center text-lg font-semibold text-green-400",children:e.totalSolved}),h.jsx("td",{className:"p-4 text-center font-mono text-sm text-gray-400",children:e.totalScore}),h.jsx("td",{className:"p-4 text-center text-sm text-gray-500",children:new Date(e.lastUpdated).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),MSt=()=>{const{contestId:e}=Qp(),[t,r]=O.useState([]),[i,n]=O.useState(!0),[s,a]=O.useState(null);if(O.useEffect(()=>{Hn.init({duration:800}),(async()=>{try{const u=await jt.get(`/contest/${e}/leaderboard`);r(u.data)}catch(u){a(u.response?.data?.message||"Failed to load results.")}finally{n(!1)}})()},[e]),i)return h.jsx("div",{className:"flex justify-center items-center h-screen p-16",children:h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"w-16 h-16 border-4 border-primary/20 border-t-primary rounded-full animate-spin"}),h.jsx("div",{className:"absolute top-2 left-2 w-12 h-12 border-4 border-purple-500/20 border-t-purple-500 rounded-full animate-spin animation-delay-75"})]})});if(s)return h.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center text-red-400 text-xl",children:s});const o=t.slice(0,3),l=t.slice(3);return h.jsx("div",{className:"min-h-screen bg-gray-900 text-white font-sans p-4 sm:p-6 lg:p-8 overflow-x-hidden",children:h.jsxs("div",{className:"max-w-5xl mx-auto",children:[h.jsxs("header",{className:"flex items-center justify-between mb-12","data-aos":"fade-down",children:[h.jsxs(hr,{to:"/contest",className:"flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[h.jsx(ife,{size:20})," Back to Contests"]}),h.jsxs("div",{className:"text-center",children:[h.jsx(JV,{className:"w-12 h-12 text-blue-400 mx-auto mb-2"}),h.jsx("h1",{className:"text-4xl font-extrabold tracking-tight",children:"Final Standings"}),h.jsx("p",{className:"text-lg text-gray-400",children:"The results are in. Congratulations to all participants!"})]}),h.jsx("div",{className:"w-36"})," "]}),o.length>0&&h.jsxs("div",{className:"flex items-end justify-center mb-12","data-aos":"fade-up",children:[o.find(c=>t.indexOf(c)+1===2)&&h.jsx(lj,{entry:o.find(c=>t.indexOf(c)+1===2),rank:2}),o.find(c=>t.indexOf(c)+1===1)&&h.jsx(lj,{entry:o.find(c=>t.indexOf(c)+1===1),rank:1}),o.find(c=>t.indexOf(c)+1===3)&&h.jsx(lj,{entry:o.find(c=>t.indexOf(c)+1===3),rank:3})]}),l.length>0&&h.jsx("div",{className:"bg-[#1c1c1c]/50 backdrop-blur-sm border border-gray-700/50 rounded-xl shadow-2xl","data-aos":"fade-up","data-aos-delay":"300",children:h.jsxs("table",{className:"w-full text-left",children:[h.jsx("thead",{className:"border-b-2 border-gray-700",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-4 w-20 text-center text-gray-400 font-semibold tracking-wider",children:"Rank"}),h.jsx("th",{className:"p-4 text-gray-400 font-semibold tracking-wider",children:"User"}),h.jsx("th",{className:"p-4 w-32 text-center text-gray-400 font-semibold tracking-wider",children:"Solved"}),h.jsx("th",{className:"p-4 w-32 text-center text-gray-400 font-semibold tracking-wider",children:"Score"}),h.jsx("th",{className:"p-4 w-40 text-center text-gray-400 font-semibold tracking-wider",children:"Finish Time"})]})}),h.jsx("tbody",{children:l.map((c,u)=>h.jsx(TSt,{rank:u+4,entry:c},c._id))})]})})]})})},PSt=()=>{const[e,t]=O.useState(""),[r,i]=O.useState(!1),[n,s]=O.useState(""),[a,o]=O.useState([]),[l,c]=O.useState(null),[u,d]=O.useState(!1),[f,m]=O.useState(!1),v=O.useRef(null),y=O.useRef(null),x=fs(),w=ho(E=>E.auth.user);O.useEffect(()=>(n.trim().length>=1?(v.current&&clearTimeout(v.current),v.current=setTimeout(async()=>{d(!0),m(!0);try{const E=await jt.get(`/contest/find?query=${n.trim()}`);let N=[];E.data&&(Array.isArray(E.data)?N=E.data:E.data.problems&&Array.isArray(E.data.problems)?N=E.data.problems:E.data._id&&(N=[E.data])),o(N)}catch(E){console.error("Error searching problems:",E),o([])}finally{d(!1)}},300)):(o([]),m(!1),d(!1)),()=>{v.current&&clearTimeout(v.current)}),[n]),O.useEffect(()=>{const E=N=>{y.current&&!y.current.contains(N.target)&&m(!1)};return document.addEventListener("mousedown",E),()=>document.removeEventListener("mousedown",E)},[]);const _=async()=>{if(!l){alert("Please select a problem first.");return}i(!0);try{const E=await jt.post("/pairMode/createSession",{problemId:l._id}),{sessionId:N}=E.data;N&&x(`/problem/${l._id}/session/${N}`)}catch(E){console.error("Error creating collab session:",E),alert("Failed to create session. Please try again."),i(!1)}},S=async E=>{E.preventDefault();const N=e.trim();if(!N){alert("Please enter a Session ID.");return}i(!0);try{const D=await jt.get(`/pairMode/details/${N}`),{problemId:I}=D.data;I?x(`/problem/${I}/session/${N}`):alert("Could not find a problem associated with that session.")}catch(D){console.error("Error joining session:",D),D.response?.status===404?alert("Invalid Session ID. Please check the ID and try again."):alert("Failed to join session. Please try again.")}finally{i(!1)}},P=E=>{c(E),s(E.title),m(!1)},M=()=>{c(null),s(""),o([])},C={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},T={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:100}}};return w?h.jsxs(Et.div,{variants:C,initial:"hidden",animate:"visible",className:" min-h-screen bg-gradient-to-br from-sky-100 via-violet-100 to-pink-100 dark:from-slate-800 dark:via-neutral-900 dark:to-slate-600 p-4 sm:p-8 flex items-center justify-center overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none",children:h.jsx(_a,{particleColors:["#ffffff","#ffffff"],particleCount:180,particleSpread:10,speed:.1,particleBaseSize:100})}),h.jsxs("div",{className:"relative z-10 mx-auto max-w-5xl w-full",children:[h.jsxs(Et.header,{variants:T,className:"text-center mb-8",children:[h.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[h.jsx(Zu,{className:"h-10 w-10 text-blue-500"}),h.jsx("h1",{className:"bg-gradient-to-r py-2 from-blue-500 to-indigo-600 bg-clip-text font-serif text-4xl font-bold text-transparent sm:text-5xl",children:"Collab Programming"})]}),h.jsx("p",{className:"mt-3 text-lg text-slate-600 dark:text-slate-400 max-w-2xl mx-auto",children:"Solve problems together with a shared real-time editor and integrated voice chat."}),h.jsxs(Et.div,{variants:T,className:"mt-6 bg-gradient-to-r from-purple-500/10 to-pink-500/10 dark:from-[#cf85f06f] dark:to-[#4c30667b] border-2 border-purple-200 dark:border-purple-600/50 rounded-2xl p-6 backdrop-blur-sm",children:[h.jsxs("div",{className:"flex items-center justify-center gap-4 mb-3",children:[h.jsx(Bz,{className:"h-8 w-8 text-purple-600 dark:text-purple-400"}),h.jsx(tU,{className:"h-7 w-7 text-purple-600 dark:text-purple-400"}),h.jsx(YP,{className:"h-7 w-7 text-purple-600 dark:text-purple-400"})]}),h.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent mb-2",children:"Real-Time Voice Communication Included!"}),h.jsx("p",{className:"text-purple-700 dark:text-purple-300 font-medium text-lg max-w-lg mx-auto",children:"Talk to your partner instantly while coding—no external apps needed!"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[h.jsxs(Et.div,{variants:T,className:"bg-white/60 dark:bg-slate-800/60 backdrop-blur-xl border border-white/30 dark:border-slate-700/50 rounded-2xl p-8 flex flex-col shadow-xl",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[h.jsx("div",{className:"p-4 bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-blue-900/50 dark:to-indigo-900/50 rounded-xl",children:h.jsx(llt,{className:"h-8 w-8 text-blue-600 dark:text-blue-400",strokeWidth:2.5})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"Create New Session"}),h.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Start a fresh coding session."})]})]}),h.jsxs("div",{className:"mb-6 relative",ref:y,children:[h.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Select a Problem"}),l?h.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-2 border-green-200 dark:border-green-700 rounded-xl p-4",children:h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx(Sh,{className:"h-5 w-5 text-green-600"}),h.jsx("span",{className:"font-semibold text-green-800 dark:text-green-300",children:"Selected Problem"})]}),h.jsx("h3",{className:"font-bold text-slate-800 dark:text-slate-100 mb-1",children:l.title}),h.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-2",children:["#",l.serial_number]})]}),h.jsx("button",{onClick:M,className:"p-2 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg",title:"Clear selection",children:h.jsx(Dc,{className:"h-4 w-4 text-red-500"})})]})}):h.jsxs("div",{className:"relative",children:[h.jsxs("div",{className:"relative",children:[h.jsx(Wh,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-400"}),h.jsx("input",{type:"text",placeholder:"Search by name or serial number...",value:n,onChange:E=>s(E.target.value),className:"w-full pl-12 pr-4 py-4 rounded-xl border-2 border-slate-200 dark:border-slate-600 bg-white/80 dark:bg-slate-700/80 focus:border-blue-500 focus:outline-none focus:ring-4 focus:ring-blue-500/20"}),u&&h.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 animate-spin rounded-full h-5 w-5 border-2 border-blue-500 border-t-transparent"})]}),h.jsx(ya,{children:f&&a.length>0&&h.jsx(Et.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-slate-800 border dark:border-slate-600 rounded-xl shadow-xl max-h-60 overflow-y-auto z-50",children:a.map(E=>h.jsxs("button",{onClick:()=>P(E),className:"w-full text-left p-4 hover:bg-slate-50 dark:hover:bg-slate-700 border-b dark:border-slate-700 last:border-b-0",children:[h.jsx("h4",{className:"font-semibold text-slate-800 dark:text-slate-100",children:E.title}),h.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:["#",E.serial_number]})]},E._id))})}),f&&!u&&a.length===0&&n.trim()&&h.jsx("div",{className:"absolute top-full w-full mt-2 bg-white dark:bg-slate-800 border dark:border-slate-600 rounded-xl p-4 text-center text-slate-500 z-50",children:"No problems found."})]})]}),h.jsx(h3,{onClick:_,disabled:r||!l,className:"w-full mt-auto",children:r?"Creating...":"Create Collab Session"})]}),h.jsxs(Et.div,{variants:T,className:"bg-white/60 dark:bg-slate-800/60 backdrop-blur-xl border border-white/30 dark:border-slate-700/50 rounded-2xl p-8 flex flex-col shadow-xl",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[h.jsx("div",{className:"p-4 bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900/50 dark:to-emerald-900/50 rounded-xl",children:h.jsx(wot,{className:"h-8 w-8 text-green-600 dark:text-green-400",strokeWidth:2.5})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"Join Existing Session"}),h.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Enter session ID from your partner."})]})]}),h.jsxs("form",{onSubmit:S,className:"flex flex-col gap-6 flex-1",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Session ID"}),h.jsx("input",{type:"text",placeholder:"Enter partner's Session ID...",value:e,onChange:E=>t(E.target.value),className:"w-full py-4 px-4 rounded-xl border-2 border-slate-200 dark:border-slate-600 bg-white/80 dark:bg-slate-700/80 focus:border-green-500 focus:outline-none focus:ring-4 focus:ring-green-500/20"})]}),h.jsx(h3,{type:"submit",disabled:r||!e.trim(),className:"w-full mt-auto",children:r?"Joining...":"Join Session"})]})]})]}),h.jsx(Et.div,{variants:T,className:"mt-12",children:h.jsxs("div",{className:"bg-white/50 dark:bg-slate-800/50 backdrop-blur-lg border border-white/30 dark:border-slate-700/50 rounded-2xl p-8 shadow-xl",children:[h.jsx("h3",{className:"text-2xl font-bold text-center text-slate-800 dark:text-slate-100 mb-8",children:"How It Works"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 text-center",children:[h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/50 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx("span",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:"1"})}),h.jsx("h4",{className:"font-semibold text-slate-800 dark:text-slate-100 mb-2",children:"Create & Share"}),h.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Choose a problem, start a session, and share the ID with your partner."})]}),h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/50 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx("span",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:"2"})}),h.jsx("h4",{className:"font-semibold text-slate-800 dark:text-slate-100 mb-2",children:"Join & Connect"}),h.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Your partner joins, instantly connecting the editor and voice chat."})]}),h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/50 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx("span",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:"3"})}),h.jsx("h4",{className:"font-semibold text-slate-800 dark:text-slate-100 mb-2",children:"Code & Talk"}),h.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Solve the problem together, talking strategy with integrated, low-latency audio."})]})]}),h.jsxs("div",{className:"mt-10 bg-slate-50 dark:bg-slate-700/50 rounded-xl p-6",children:[h.jsxs("h4",{className:"font-semibold text-slate-800 dark:text-slate-100 mb-4 flex items-center gap-2",children:[h.jsx(YP,{className:"h-5 w-5 text-blue-500"}),"Key Features"]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full mt-1.5 shrink-0"}),h.jsxs("div",{children:[h.jsx("strong",{className:"text-slate-800 dark:text-slate-100",children:"Integrated Voice Chat:"}),h.jsx("span",{className:"text-slate-600 dark:text-slate-400 ml-1",children:"Talk to your partner while you code, right in the browser."})]})]}),h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-1.5 shrink-0"}),h.jsxs("div",{children:[h.jsx("strong",{className:"text-slate-800 dark:text-slate-100",children:"Real-Time Sync:"}),h.jsx("span",{className:"text-slate-600 dark:text-slate-400 ml-1",children:"See your partner’s edits and cursor movements live."})]})]}),h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-1.5 shrink-0"}),h.jsxs("div",{children:[h.jsx("strong",{className:"text-slate-800 dark:text-slate-100",children:"Driver/Navigator Roles:"}),h.jsx("span",{className:"text-slate-600 dark:text-slate-400 ml-1",children:"Control who drives the coding with easy role-switching."})]})]}),h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mt-1.5 shrink-0"}),h.jsxs("div",{children:[h.jsx("strong",{className:"text-slate-800 dark:text-slate-100",children:"No Setup Required:"}),h.jsx("span",{className:"text-slate-600 dark:text-slate-400 ml-1",children:"Works directly in your browser—no downloads or plugins needed."})]})]})]})]})]})})]})]}):h.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-10 bg-gradient-to-br from-sky-100 to-pink-100 dark:from-slate-800 dark:to-slate-600",children:h.jsx(yb,{message:"You need to be logged in to start or join a collaborative programming session."})})},DSt=`
    [data-aos] {
        transition-duration: 0.6s;
        transition-timing-function: ease-out-cubic;
    }
    
    [data-aos="fade-up"] {
        transform: translate3d(0, 40px, 0);
        opacity: 0;
    }
    
    [data-aos="fade-down"] {
        transform: translate3d(0, -40px, 0);
        opacity: 0;
    }
    
    [data-aos="fade-left"] {
        transform: translate3d(40px, 0, 0);
        opacity: 0;
    }
    
    [data-aos="fade-right"] {
        transform: translate3d(-40px, 0, 0);
        opacity: 0;
    }
    
    [data-aos="zoom-in"] {
        transform: scale(0.8);
        opacity: 0;
    }
    
    [data-aos="flip-up"] {
        transform: perspective(400px) rotateX(80deg);
        opacity: 0;
    }
    
    [data-aos].aos-animate {
        transform: translate3d(0, 0, 0) scale(1) perspective(400px) rotateX(0deg);
        opacity: 1;
    }
`;function NSt(){const[e,t]=O.useState("Copy"),[r,i]=O.useState(!1);O.useEffect(()=>{const o=document.createElement("style");return o.type="text/css",o.innerText=DSt,document.head.appendChild(o),setTimeout(()=>{const c=document.querySelectorAll("[data-aos]"),u=new IntersectionObserver(d=>{d.forEach(f=>{if(f.isIntersecting){const m=f.target.getAttribute("data-aos-delay")||0;setTimeout(()=>{f.target.classList.add("aos-animate")},parseInt(m))}})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});c.forEach(d=>u.observe(d))},100),()=>{o.parentNode&&o.parentNode.removeChild(o)}},[]),O.useEffect(()=>{const o=()=>{const u=document.documentElement.classList,d=document.body.classList,f=document.documentElement.getAttribute("data-theme"),m=document.body.getAttribute("data-theme"),v=u.contains("dark")||d.contains("dark")||f==="dark"||m==="dark"||f==="business"||m==="business"||window.matchMedia("(prefers-color-scheme: dark)").matches;i(v)};o();const l=new MutationObserver(o);l.observe(document.documentElement,{attributes:!0,attributeFilter:["class","data-theme"]}),l.observe(document.body,{attributes:!0,attributeFilter:["class","data-theme"]});const c=window.matchMedia("(prefers-color-scheme: dark)");return c.addListener(o),()=>{l.disconnect(),c.removeListener(o)}},[]);const n=`{
  "serial_number": 31,
  "title": "Count Pairs with Given Sum",
  "difficulty": "Easy",
  "description": "Given an array of integers and a target sum, return the number of pairs of elements that add up to the target sum. Each pair should be counted only once.",
  "tags": "Array, Hashmap, Two Pointers",
  "visible_testcase": [
    {
      "input": "[1, 5, 7, -1, 5]\\n6",
      "output": "3",
      "explanation": "Pairs are: (1,5), (7,-1), and another (1,5) considering repeated 5."
    },
    {
      "input": "[1, 1, 1, 1]\\n2",
      "output": "6",
      "explanation": "All 1s form 6 unique pairs with sum 2."
    },
    {
      "input": "[1, 2, 3, 4, 5]\\n9",
      "output": "1",
      "explanation": "Only one pair: (4,5)."
    }
  ],
  "hidden_testcase": [
    {
      "input": "[3, 3, 3, 3]\\n6",
      "output": "6"
    },
    {
      "input": "[0, -1, 2, -3, 1]\\n-2",
      "output": "1"
    },
    {
      "input": "[10, 12, 10, 15, -1, 7, 6, 5]\\n16",
      "output": "3"
    },
    {
      "input": "[]\\n5",
      "output": "0"
    },
    {
      "input": "[1]\\n2",
      "output": "0"
    }
  ],
  "start_code": [
    {
      "language": "python",
      "initial_code": "from typing import List\\nimport json\\n\\ndef count_pairs_with_sum(arr: List[int], target: int) -> int:\\n    # Your code here\\n    return 0\\n\\ntry:\\n    arr = json.loads(input().strip())\\n    target = int(input().strip())\\n    result = count_pairs_with_sum(arr, target)\\n    print(result)\\nexcept Exception as e:\\n    print(0)"
    },
    {
      "language": "c++",
      "initial_code": "#include <iostream>\\n#include <vector>\\n#include <unordered_map>\\n#include <sstream>\\n#include <string>\\nusing namespace std;\\n\\nint countPairsWithSum(vector<int>& arr, int target) {\\n    // Your code here\\n    return 0;\\n}\\n\\nvector<int> parseArray(string s) {\\n    vector<int> arr;\\n    s.erase(0, 1); // remove '['\\n    s.erase(s.size() - 1); // remove ']'\\n    if (s.empty()) return arr;\\n    \\n    stringstream ss(s);\\n    string item;\\n    while (getline(ss, item, ',')) {\\n        arr.push_back(stoi(item));\\n    }\\n    return arr;\\n}\\n\\nint main() {\\n    string line;\\n    getline(cin, line);\\n    vector<int> arr = parseArray(line);\\n    \\n    int target;\\n    cin >> target;\\n    \\n    cout << countPairsWithSum(arr, target) << endl;\\n    return 0;\\n}"
    },
    {
      "language": "java",
      "initial_code": "import java.util.*;\\n\\npublic class Main {\\n    public static int countPairsWithSum(int[] arr, int target) {\\n        // Your code here\\n        return 0;\\n    }\\n\\n    public static void main(String[] args) {\\n        Scanner sc = new Scanner(System.in);\\n        String line = sc.nextLine().trim();\\n        \\n        // Parse array\\n        int[] arr;\\n        if (line.equals(\\"[]\\")) {\\n            arr = new int[0];\\n        } else {\\n            line = line.substring(1, line.length() - 1); // remove brackets\\n            String[] parts = line.split(\\",\\");\\n            arr = new int[parts.length];\\n            for (int i = 0; i < parts.length; i++) {\\n                arr[i] = Integer.parseInt(parts[i].trim());\\n            }\\n        }\\n        \\n        int target = sc.nextInt();\\n        System.out.println(countPairsWithSum(arr, target));\\n    }\\n}"
    },
    {
      "language": "javascript",
      "initial_code": "function countPairsWithSum(arr, target) {\\n    // Your code here\\n    return 0;\\n}\\n\\nconst readline = require(\\"readline\\");\\nconst rl = readline.createInterface({ input: process.stdin, output: process.stdout });\\n\\nlet input = [];\\nrl.on(\\"line\\", function (line) { input.push(line.trim()); });\\nrl.on(\\"close\\", function () {\\n    try {\\n        const arr = JSON.parse(input[0]);\\n        const target = parseInt(input[1]);\\n        console.log(countPairsWithSum(arr, target));\\n    } catch (e) {\\n        console.log(0);\\n    }\\n});"
    }
  ],
  "problem_solution": [
    {
      "language": "python",
      "complete_code": "from typing import List\\nimport json\\n\\ndef count_pairs_with_sum(arr: List[int], target: int) -> int:\\n    if len(arr) < 2:\\n        return 0\\n    \\n    freq = {}\\n    count = 0\\n    \\n    for num in arr:\\n        complement = target - num\\n        if complement in freq:\\n            count += freq[complement]\\n        freq[num] = freq.get(num, 0) + 1\\n    \\n    return count\\n\\ntry:\\n    arr = json.loads(input().strip())\\n    target = int(input().strip())\\n    result = count_pairs_with_sum(arr, target)\\n    print(result)\\nexcept Exception as e:\\n    print(0)"
    },
    {
      "language": "c++",
      "complete_code": "#include <iostream>\\n#include <vector>\\n#include <unordered_map>\\n#include <sstream>\\n#include <string>\\nusing namespace std;\\n\\nint countPairsWithSum(vector<int>& arr, int target) {\\n    if (arr.size() < 2) return 0;\\n    \\n    unordered_map<int, int> freq;\\n    int count = 0;\\n    \\n    for (int num : arr) {\\n        int complement = target - num;\\n        if (freq.find(complement) != freq.end()) {\\n            count += freq[complement];\\n        }\\n        freq[num]++;\\n    }\\n    \\n    return count;\\n}\\n\\nvector<int> parseArray(string s) {\\n    vector<int> arr;\\n    s.erase(0, 1); // remove '['\\n    s.erase(s.size() - 1); // remove ']'\\n    if (s.empty()) return arr;\\n    \\n    stringstream ss(s);\\n    string item;\\n    while (getline(ss, item, ',')) {\\n        arr.push_back(stoi(item));\\n    }\\n    return arr;\\n}\\n\\nint main() {\\n    string line;\\n    getline(cin, line);\\n    vector<int> arr = parseArray(line);\\n    \\n    int target;\\n    cin >> target;\\n    \\n    cout << countPairsWithSum(arr, target) << endl;\\n    return 0;\\n}"
    },
    {
      "language": "java",
      "complete_code": "import java.util.*;\\n\\npublic class Main {\\n    public static int countPairsWithSum(int[] arr, int target) {\\n        if (arr.length < 2) return 0;\\n        \\n        Map<Integer, Integer> freq = new HashMap<>();\\n        int count = 0;\\n        \\n        for (int num : arr) {\\n            int complement = target - num;\\n            count += freq.getOrDefault(complement, 0);\\n            freq.put(num, freq.getOrDefault(num, 0) + 1);\\n        }\\n        \\n        return count;\\n    }\\n\\n    public static void main(String[] args) {\\n        Scanner sc = new Scanner(System.in);\\n        String line = sc.nextLine().trim();\\n        \\n        // Parse array\\n        int[] arr;\\n        if (line.equals(\\"[]\\")) {\\n            arr = new int[0];\\n        } else {\\n            line = line.substring(1, line.length() - 1); // remove brackets\\n            String[] parts = line.split(\\",\\");\\n            arr = new int[parts.length];\\n            for (int i = 0; i < parts.length; i++) {\\n                arr[i] = Integer.parseInt(parts[i].trim());\\n            }\\n        }\\n        \\n        int target = sc.nextInt();\\n        System.out.println(countPairsWithSum(arr, target));\\n    }\\n}"
    },
    {
      "language": "javascript",
      "complete_code": "function countPairsWithSum(arr, target) {\\n    if (arr.length < 2) return 0;\\n    \\n    const freq = {};\\n    let count = 0;\\n    \\n    for (let num of arr) {\\n        const complement = target - num;\\n        count += freq[complement] || 0;\\n        freq[num] = (freq[num] || 0) + 1;\\n    }\\n    \\n    return count;\\n}\\n\\nconst readline = require(\\"readline\\");\\nconst rl = readline.createInterface({ input: process.stdin, output: process.stdout });\\n\\nlet input = [];\\nrl.on(\\"line\\", function (line) { input.push(line.trim()); });\\nrl.on(\\"close\\", function () {\\n    try {\\n        const arr = JSON.parse(input[0]);\\n        const target = parseInt(input[1]);\\n        console.log(countPairsWithSum(arr, target));\\n    } catch (e) {\\n        console.log(0);\\n    }\\n});"
    }
  ]
}`,s=()=>{const o=new Blob([n],{type:"application/json;charset=utf-8"}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l,c.setAttribute("download","problem_format_example.json"),document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l)},a=()=>{navigator.clipboard.writeText(n).then(()=>{t("Copied!"),setTimeout(()=>t("Copy"),3e3)}).catch(o=>{console.error("Failed to copy text: ",o),t("Failed!"),setTimeout(()=>t("Copy"),3e3)})};return h.jsxs("div",{className:`min-h-screen transition-all duration-500 ${r?"bg-gray-900 text-white":"bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 text-gray-900"}`,children:[h.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[h.jsx("div",{className:"absolute inset-0 bg-gray-900"}),h.jsx("div",{className:"absolute inset-0 bg-gray-900"}),h.jsx("div",{className:`absolute top-20 left-20 w-2 h-2 rounded-full ${r?"bg-purple-400":"bg-blue-400"} animate-pulse`}),h.jsx("div",{className:`absolute top-40 right-32 w-1 h-1 rounded-full ${r?"bg-blue-400":"bg-purple-400"} animate-bounce`}),h.jsx("div",{className:`absolute bottom-32 left-40 w-3 h-3 rounded-full ${r?"bg-pink-400":"bg-indigo-400"} animate-pulse`})]}),h.jsxs("div",{className:"relative z-10 container mx-auto px-4 py-8 lg:px-8",children:[h.jsxs("header",{className:"text-center mb-16 pt-8",children:[h.jsxs("div",{className:"flex justify-center items-center gap-3 mb-6","data-aos":"fade-down","data-aos-delay":"100",children:[h.jsx("div",{className:`p-3 rounded-2xl ${r?"bg-gradient-to-r from-purple-600 to-pink-600":"bg-gradient-to-r from-blue-500 to-purple-600"}`,children:h.jsx(Lz,{className:"w-8 h-8 text-white"})}),h.jsx(dS,{className:`w-6 h-6 ${r?"text-purple-400":"text-blue-500"} animate-pulse`})]}),h.jsx("h1",{className:`text-5xl md:text-7xl font-black mb-6 leading-tight ${r?"bg-gradient-to-r from-purple-400 via-pink-400 to-blue-400 bg-clip-text text-transparent":"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 bg-clip-text text-transparent"}`,"data-aos":"fade-up","data-aos-delay":"200",children:"Problem JSON Format"}),h.jsxs("p",{className:`text-xl md:text-2xl font-medium max-w-2xl mx-auto ${r?"text-gray-300":"text-gray-600"}`,"data-aos":"fade-up","data-aos-delay":"300",children:["Perfect structure for your ",h.jsx("span",{className:`font-bold ${r?"text-purple-400":"text-blue-600"}`,children:"Quick Upload"})," feature"]}),h.jsx("div",{className:"flex flex-wrap justify-center gap-3 mt-8","data-aos":"fade-up","data-aos-delay":"400",children:["Valid JSON","Copy Ready","Download Ready"].map((o,l)=>h.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-medium ${r?"bg-gray-800 text-purple-300 border border-purple-400/30":"bg-white text-blue-600 shadow-md border border-blue-200"}`,"data-aos":"zoom-in","data-aos-delay":500+l*100,children:o},o))})]}),h.jsx("div",{className:"max-w-6xl mx-auto",children:h.jsxs("div",{className:`rounded-3xl shadow-2xl overflow-hidden border transition-all duration-300 ${r?"bg-gray-800/50 backdrop-blur-xl border-gray-700/50":"bg-white/80 backdrop-blur-xl border-gray-200/50"}`,"data-aos":"fade-up","data-aos-delay":"600",children:[h.jsx("div",{className:`px-8 py-6 border-b ${r?"border-gray-700/50":"border-gray-200/50"}`,"data-aos":"fade-right","data-aos-delay":"700",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(qat,{className:`w-6 h-6 ${r?"text-purple-400":"text-blue-500"}`}),h.jsx("h2",{className:`text-2xl font-bold ${r?"text-white":"text-gray-900"}`,children:"JSON Structure"})]}),h.jsxs("div",{className:"flex items-center gap-3","data-aos":"fade-left","data-aos-delay":"800",children:[h.jsxs("button",{onClick:a,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all duration-200 transform hover:scale-105 ${e==="Copied!"?r?"bg-green-600 hover:bg-green-500 text-white":"bg-green-500 hover:bg-green-600 text-white":r?"bg-gray-700 hover:bg-gray-600 text-gray-200":"bg-gray-100 hover:bg-gray-200 text-gray-700"}`,children:[e==="Copied!"?h.jsx(sm,{className:"w-4 h-4"}):h.jsx(ID,{className:"w-4 h-4"}),e]}),h.jsxs("button",{onClick:s,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all duration-200 transform hover:scale-105 ${r?"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white":"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white"} shadow-lg`,children:[h.jsx(Zat,{className:"w-4 h-4"}),"Download JSON"]})]})]})}),h.jsx("div",{className:`p-8 ${r?"bg-gray-900/50":"bg-gray-50/50"}`,"data-aos":"flip-up","data-aos-delay":"900",children:h.jsxs("div",{className:`rounded-2xl overflow-hidden border ${r?"border-gray-700":"border-gray-300"}`,children:[h.jsxs("div",{className:`flex items-center justify-between px-6 py-4 ${r?"bg-gray-800":"bg-gray-100"}`,children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400"}),h.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-400"}),h.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400"})]}),h.jsx("span",{className:`text-sm font-medium ml-4 ${r?"text-gray-300":"text-gray-600"}`,children:"problem_format_example.json"})]}),h.jsx("div",{className:`text-xs px-3 py-1 rounded-full ${r?"bg-purple-600 text-white":"bg-blue-100 text-blue-700"}`,children:"JSON"})]}),h.jsx("div",{className:`overflow-auto ${r?"bg-gray-900":"bg-white"}`,style:{maxHeight:"70vh"},children:h.jsx("pre",{className:`p-6 text-sm leading-relaxed whitespace-pre font-mono ${r?"text-gray-100":"text-gray-800"}`,style:{whiteSpace:"pre",wordWrap:"normal",overflowWrap:"normal"},children:n})})]})}),h.jsx("div",{className:`px-8 py-6 border-t ${r?"border-gray-700/50":"border-gray-200/50"}`,"data-aos":"fade-up","data-aos-delay":"1000",children:h.jsx("div",{className:"flex flex-wrap gap-6 text-sm",children:[{text:"Valid JSON Format",color:"green"},{text:"Ready for Quick Upload",color:"blue"},{text:"Complete Example Included",color:"purple"}].map((o,l)=>h.jsxs("div",{className:"flex items-center gap-2","data-aos":"zoom-in","data-aos-delay":1100+l*100,children:[h.jsx("div",{className:`w-2 h-2 rounded-full ${o.color==="green"?r?"bg-green-400":"bg-green-500":o.color==="blue"?r?"bg-blue-400":"bg-blue-500":r?"bg-purple-400":"bg-purple-500"}`}),h.jsx("span",{className:r?"text-gray-300":"text-gray-600",children:o.text})]},o.text))})})]})})]})]})}function kSt(){const e=g3(),{user:t,is_authenticated:r,loading:i}=ho(n=>n.auth);return O.useEffect(()=>{e(Dy())},[e]),i?h.jsx("div",{className:"flex justify-center items-center h-screen p-16",children:h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"w-16 h-16 border-4 border-primary/20 border-t-primary rounded-full animate-spin"}),h.jsx("div",{className:"absolute top-2 left-2 w-12 h-12 border-4 border-purple-500/20 border-t-purple-500 rounded-full animate-spin animation-delay-75"})]})}):h.jsx(h.Fragment,{children:h.jsxs(nxe,{children:[h.jsxs(oi,{element:h.jsx(Ilt,{}),children:[h.jsx(oi,{path:"/",element:h.jsx(_qe,{})}),h.jsx(oi,{path:"/login",element:r?h.jsx(dv,{to:"/"}):h.jsx(Qet,{})}),h.jsx(oi,{path:"/signup",element:r?h.jsx(dv,{to:"/"}):h.jsx(Jet,{})}),h.jsx(oi,{path:"/problems",element:h.jsx(zlt,{})}),h.jsx(oi,{path:"/tscassistant",element:h.jsx(hwt,{})}),h.jsx(oi,{path:"/profile",element:h.jsx(i_t,{})}),h.jsx(oi,{path:"/settings/set-password",element:r?h.jsx(n_t,{}):h.jsx(dv,{to:"/login"})}),h.jsx(oi,{path:"/settings/change-password",element:r?h.jsx(vSt,{}):h.jsx(dv,{to:"/login"})}),h.jsx(oi,{path:"/discussion",element:h.jsx(p_t,{})}),h.jsx(oi,{path:"/question/:id",element:h.jsx(w_t,{})}),h.jsx(oi,{path:"/ask-question",element:h.jsx(mSt,{})}),h.jsx(oi,{path:"/contest",element:h.jsx(xSt,{})}),h.jsx(oi,{path:"/contest/:contestId/arena",element:h.jsx(CSt,{})}),h.jsx(oi,{path:"/contest/:contestId/results",element:h.jsx(MSt,{})}),h.jsx(oi,{path:"/pair-mode",element:h.jsx(PSt,{})})]}),h.jsx(oi,{path:"/problems/:problemId",element:h.jsx(nj,{})}),h.jsx(oi,{path:"/problem/:problemId/session/:sessionId",element:h.jsx(nj,{})}),h.jsx(oi,{path:"/problem/potd",element:h.jsx(nj,{})}),h.jsxs(oi,{element:r&&t?.role==="admin"?h.jsx(Blt,{}):h.jsx(dv,{to:"/"}),children:[h.jsx(oi,{path:"/admin",element:h.jsx(Flt,{})}),h.jsx(oi,{path:"/admin/problems/create",element:h.jsx(qct,{})}),h.jsx(oi,{path:"/admin/update",element:h.jsx(Yct,{})}),h.jsx(oi,{path:"/edit-problem/:problemId",element:h.jsx(Ept,{})}),h.jsx(oi,{path:"/admin/problems/delete",element:h.jsx(Apt,{})}),h.jsx(oi,{path:"/admin/video",element:h.jsx(pwt,{})}),h.jsx(oi,{path:"/admin/video/upload/:problemId",element:h.jsx(mwt,{})}),h.jsx(oi,{path:"/admin/users",element:h.jsx(Mpt,{})}),h.jsx(oi,{path:"/admin/contest",element:h.jsx(wSt,{})}),h.jsx(oi,{path:"/admin/contests/create",element:h.jsx(SSt,{})}),h.jsx(oi,{path:"/admin/contests/edit/:contestId",element:h.jsx(ASt,{})}),h.jsx(oi,{path:"/admin/problem/json-format",element:h.jsx(NSt,{})})]}),h.jsx(oi,{path:"/payment",element:r?h.jsx(fwt,{}):h.jsx(dv,{to:"/login"})})]})})}var RSt=(e,t,r,i,n,s,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(m){(Array.isArray(e)?e:[e]).forEach(v=>{let y=v==="class",x=y&&s?n.map(w=>s[w]||w):n;y?(l.classList.remove(...x),l.classList.add(s&&s[m]?s[m]:m)):l.setAttribute(v,m)}),d(m)}function d(m){o&&c.includes(m)&&(l.style.colorScheme=m)}function f(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(i)u(i);else try{let m=localStorage.getItem(t)||r,v=a&&m==="system"?f():m;u(v)}catch{}},$te=["light","dark"],D0e="(prefers-color-scheme: dark)",ISt=typeof window>"u",N0e=O.createContext(void 0),OSt=e=>O.useContext(N0e)?O.createElement(O.Fragment,null,e.children):O.createElement(LSt,{...e}),jSt=["light","dark"],LSt=({forcedTheme:e,disableTransitionOnChange:t=!1,enableSystem:r=!0,enableColorScheme:i=!0,storageKey:n="theme",themes:s=jSt,defaultTheme:a=r?"system":"light",attribute:o="data-theme",value:l,children:c,nonce:u,scriptProps:d})=>{let[f,m]=O.useState(()=>BSt(n,a)),[v,y]=O.useState(()=>f==="system"?cj():f),x=l?Object.values(l):s,w=O.useCallback(M=>{let C=M;if(!C)return;M==="system"&&r&&(C=cj());let T=l?l[C]:C,E=t?FSt(u):null,N=document.documentElement,D=I=>{I==="class"?(N.classList.remove(...x),T&&N.classList.add(T)):I.startsWith("data-")&&(T?N.setAttribute(I,T):N.removeAttribute(I))};if(Array.isArray(o)?o.forEach(D):D(o),i){let I=$te.includes(a)?a:null,j=$te.includes(C)?C:I;N.style.colorScheme=j}E?.()},[u]),_=O.useCallback(M=>{let C=typeof M=="function"?M(f):M;m(C);try{localStorage.setItem(n,C)}catch{}},[f]),S=O.useCallback(M=>{let C=cj(M);y(C),f==="system"&&r&&!e&&w("system")},[f,e]);O.useEffect(()=>{let M=window.matchMedia(D0e);return M.addListener(S),S(M),()=>M.removeListener(S)},[S]),O.useEffect(()=>{let M=C=>{C.key===n&&(C.newValue?m(C.newValue):_(a))};return window.addEventListener("storage",M),()=>window.removeEventListener("storage",M)},[_]),O.useEffect(()=>{w(e??f)},[e,f]);let P=O.useMemo(()=>({theme:f,setTheme:_,forcedTheme:e,resolvedTheme:f==="system"?v:f,themes:r?[...s,"system"]:s,systemTheme:r?v:void 0}),[f,_,e,v,r,s]);return O.createElement(N0e.Provider,{value:P},O.createElement(zSt,{forcedTheme:e,storageKey:n,attribute:o,enableSystem:r,enableColorScheme:i,defaultTheme:a,value:l,themes:s,nonce:u,scriptProps:d}),c)},zSt=O.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:i,enableColorScheme:n,defaultTheme:s,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([r,t,s,e,o,a,i,n]).slice(1,-1);return O.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${RSt.toString()})(${u})`}})}),BSt=(e,t)=>{if(ISt)return;let r;try{r=localStorage.getItem(e)||void 0}catch{}return r||t},FSt=e=>{let t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},cj=e=>(e||(e=window.matchMedia(D0e)),e.matches?"dark":"light");dye.createRoot(document.getElementById("root")).render(h.jsx(O.StrictMode,{children:h.jsx(Jxe,{store:Mwe,children:h.jsx(Mxe,{children:h.jsx(OSt,{attribute:"class",children:h.jsx(kSt,{})})})})}));export{FE as c,d0 as g};
